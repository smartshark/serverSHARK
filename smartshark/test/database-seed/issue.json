[
{ "_id" : { "$oid" : "5b7d4fe35f627d6b05868dd0" }, "external_id" : "ZOOKEEPER-146", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe35f627d6b05868dd1" }, "external_id" : "ZOOKEEPER-390", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d65f627d6b0586da5b" }, "external_id" : "ZOOKEEPER-1730", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c045f627d846d496d8f" }, "external_id" : "ZOOKEEPER-1783", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c065f627d846d496ddf" }, "external_id" : "ZOOKEEPER-1833", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de65f627d84c8d6bd78" }, "external_id" : "VELOCITY-671", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Undefined macro in block form causes NPE", "desc" : "And undefined macro such as:\n\n#@foo()#end\n\nCauses an NPE\n\n\n", "created_at" : { "$date" : "2009-01-20T15:03:03.557+0000" }, "updated_at" : { "$date" : "2009-01-21T16:49:45.930+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dec5f627d84c8d6bde7" }, "external_id" : "VELOCITY-599", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904def5f627d84c8d6be20" }, "external_id" : "VELOCITY-725", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Properties initializing error", "created_at" : { "$date" : "2009-06-05T14:41:02.060+0000" }, "updated_at" : { "$date" : "2009-06-08T12:31:31.939+0000" }, "creator_id" : { "$oid" : "5b7d3715e9214a0d1608d743" }, "reporter_id" : { "$oid" : "5b7d3715e9214a0d1608d743" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904edb5f627d84c8d6cd85" }, "external_id" : "AVRO-785", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5f5f627d6b058682f2" }, "external_id" : "ZOOKEEPER-126", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddd5f627d84c8d6bc8f" }, "external_id" : "VELOCITY-652", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de55f627d84c8d6bd6c" }, "external_id" : "VELOCITY-454", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c035f627d846d496d63" }, "external_id" : "INFRA-3228", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb65f627d84c8d6cad1" }, "external_id" : "VELOCITY-871", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec15f627d84c8d6cb93" }, "external_id" : "VELOCITY-817", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Dynamic Templates with Caching", "desc" : "I thought I would share the following code with the Apache Velocity community.\n\n\nProblem Description:  I wanted to use Dynamic Templates though I found the following had massive performance implications.\n\n{code:title=Velocity Call Snippet|borderStyle=solid}\nString template = \"message.to:  $\\{message.to} \";\nStringWriter velocityWriter = new StringWriter();\nvelocityEngine.evaluate( velocityContext, velocityWriter, \"LOG\", template );\nreturn velocityWriter.toString();\n{code}\n\n\nAs such, I needed an alternate solution and guessed that if I could cache the Velocity templates used I could see big performance gains.\n\nI initially looked to the org.apache.velocity.runtime.resource.loader.StringResourceLoader class to solve my problems.   The StringResourceLoader class requires an instance of the StringResourceRepository class, and the only implementation of StringResourceRepository is StringResourceRepositoryImpl.  Unfortunately, since the number of unique templates will grow over time, in time the StringResourceRepositoryImpl.resources Map will cause an out of memory error.\n\nWhy doesn't StringResourceRepositoryImpl use a cache with a maximum size?  Is a cache even needed as the Velocity ResourceCacheImpl will cache Templates?\n\n+++++++++++++++++++++++++++++++++++++\nIn the end I settled on the following solution.  From my tests using YourKit Java Profiler I invoked the static Velocity wrapping method 100,000 times, and discovered a performance difference of around 75 fold (146,937ms vs 1,981ms).\n\nBelow is my solution.  Feedback appreciated.\n\n+++++++++++++++++++++++++++++++++++++ \n\n\n{code:title=Velocity Engine Setup Snippet|borderStyle=solid}\nProperties p = new Properties();\n\np.setProperty( RuntimeConstants.INPUT_ENCODING, DEFAULT_ENCODING );\np.setProperty( RuntimeConstants.OUTPUT_ENCODING, DEFAULT_ENCODING );\n\np.setProperty( RuntimeConstants.RESOURCE_MANAGER_CLASS,\n       \"org.apache.velocity.runtime.resource.ResourceManagerImpl\" );\np.setProperty( RuntimeConstants.RESOURCE_MANAGER_CACHE_CLASS,\n       \"org.apache.velocity.runtime.resource.ResourceCacheImpl\" );\np.setProperty( RuntimeConstants.RESOURCE_MANAGER_DEFAULTCACHE_SIZE, \"100\" );\n\np.setProperty( RuntimeConstants.RESOURCE_LOADER, \"string\" );\np.setProperty( \"string.resource.loader.class\",\n       \"custom.SimpleStringResourceLoader\" );\np.setProperty( \"string.resource.loader.encoding\", DEFAULT_ENCODING );\np.setProperty( \"string.resource.loader.cache\", Boolean.TRUE.toString() );\np.setProperty( \"string.resource.loader.modificationCheckInterval\", \"-1\" );\n\nVelocityEngine engine = new VelocityEngine( p );\nengine.init();\n{code}\n\n\n{code:title=Velocity Call Snippet|borderStyle=solid}\nString template = \"message.to:  ${message.to} \";\nStringWriter velocityWriter = new StringWriter();\nTemplate veTemplate = velocityEngine.getTemplate( template );\nveTemplate.merge( velocityContext, velocityWriter );\nreturn velocityWriter.toString();\n{code}\n\n\n{code:title=Velocity Supporting Class Snippet|borderStyle=solid}\n\npackage custom;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.InputStream;\nimport java.io.UnsupportedEncodingException;\nimport java.util.concurrent.atomic.AtomicLong;\n\nimport org.apache.commons.collections.ExtendedProperties;\nimport org.apache.velocity.exception.VelocityException;\nimport org.apache.velocity.runtime.resource.Resource;\nimport org.apache.velocity.runtime.resource.loader.ResourceLoader;\nimport org.apache.velocity.runtime.resource.util.StringResource;\n\npublic class SimpleStringResourceLoader extends ResourceLoader\n{\n\n    protected static int classMetricsLevel;\n    protected static AtomicLong totalClassInstancesCreatedCount;\n    protected static AtomicLong totalStringsGeneratedCount;\n\n    static {\n        classMetricsLevel = 1;\n        totalClassInstancesCreatedCount = new AtomicLong();\n        totalStringsGeneratedCount = new AtomicLong();\n    }\n\n\n    protected String encoding;\n\n\n    public SimpleStringResourceLoader()\n    {\n\n        if ( classMetricsLevel > 0 )\n        {\n            totalClassInstancesCreatedCount.incrementAndGet();\n        }\n\n        this.encoding = \"UTF-8\";\n    }\n\n    @Override\n    public void init( ExtendedProperties paramExtendedProperties )\n    {\n        String paramEncoding = paramExtendedProperties.getString( \"encoding\" );\n\n        if ( null != encoding && encoding.trim().length() > 0 )\n        {\n            this.encoding = paramEncoding;\n        }\n    }\n\n    @Override\n    public InputStream getResourceStream( String contents )\n    {\n        if ( classMetricsLevel > 1 )\n        {\n            totalStringsGeneratedCount.incrementAndGet();\n        }\n\n        StringResource resource = new StringResource( contents, encoding );\n\n        byte[] byteArray = null;\n        try\n        {\n            byteArray = resource.getBody().getBytes( resource.getEncoding() );\n            return new ByteArrayInputStream( byteArray );\n        }\n        catch ( UnsupportedEncodingException ue )\n        {\n            throw new VelocityException( \"Failed to convert contents to String \"\n                    + resource.getEncoding(), ue );\n        }\n\n    }\n\n    @SuppressWarnings( \"unused\" )\n    @Override\n    public boolean isSourceModified( Resource paramResource )\n    {\n        return false;\n    }\n\n    @SuppressWarnings( \"unused\" )\n    @Override\n    public long getLastModified( Resource paramResource )\n    {\n        return 0;\n    }\n\n\n    public String getEncoding()\n    {\n        return encoding;\n    }\n\n    public void setEncoding( String encoding )\n    {\n        this.encoding = encoding;\n    }\n\n\n    public static int getClassMetricsLevel()\n    {\n        return classMetricsLevel;\n    }\n\n    public static void setClassMetricsLevel( int classMetricsLevel )\n    {\n        SimpleStringResourceLoader.classMetricsLevel = classMetricsLevel;\n    }\n\n    public static void setTotalClassInstancesCreatedCount( long counterValue )\n    {\n        SimpleStringResourceLoader.totalClassInstancesCreatedCount.getAndSet( counterValue );\n    }\n\n    public static long getTotalClassInstancesCreatedCount()\n    {\n        return SimpleStringResourceLoader.totalClassInstancesCreatedCount.get();\n    }\n\n\n    public static void setTotalStringsGeneratedCount( long counterValue )\n    {\n        SimpleStringResourceLoader.totalStringsGeneratedCount.getAndSet( counterValue );\n    }\n\n    public static long getTotalStringsGeneratedCount()\n    {\n        return SimpleStringResourceLoader.totalStringsGeneratedCount.get();\n    }\n\n    @Override\n    public String toString()\n    {\n        return \"SimpleStringResourceLoader [encoding=\" + encoding + \"]\";\n    }\n\n}\n{code}\n\n", "created_at" : { "$date" : "2012-02-10T05:48:15.026+0000" }, "updated_at" : { "$date" : "2017-05-18T20:46:07.392+0000" }, "creator_id" : { "$oid" : "5b7d38dae9214a0d1608d7ed" }, "reporter_id" : { "$oid" : "5b7d38dae9214a0d1608d7ed" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "performance" ], "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 7200 },
{ "_id" : { "$oid" : "5b904ed65f627d84c8d6cd1a" }, "external_id" : "VELOCITY-768", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "2.0" ], "components" : [ "Build" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ed65f627d84c8d6cd1b" }, "effect" : "relates to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d38ece9214a0d1608d7f3" }, "desc" : "Trying to use the Velocity 1.7-beta1 JAR in our OSGi container (Felix running in Atlassian Confluence), we ran into dependency problems because all the dependencies of Velocity are marked as mandatory.\n\nAs you would know, Velocity has a logging abstraction which allows different logging frameworks to be used. Likewise, you don't need the servlet API to use Velocity. However, these dependencies are marked as required in the new OSGi manifest added in VELOCITY-694. This causes the bundle to fail to start because the dependencies are missing.\n\nFrom our testing, we could use Velocity in our application just fine with following imports changed to be optional:\n\n    * com.werken.xpath\n    * javax.servlet\n    * javax.servlet.http\n    * org.apache.commons.logging\n    * org.apache.log\n    * org.apache.log.format\n    * org.apache.log.output.io\n    * org.apache.log4j\n    * org.apache.oro.text.perl\n    * org.apache.tools.ant\n    * org.apache.tools.ant.taskdefs\n    * org.jdom\n    * org.jdom.input\n    * org.jdom.output\n\nThat means changing the current Import-Package declaration from this:\n\nImport-Package: com.werken.xpath,\n javax.naming,\n javax.servlet,\n javax.servlet.http,\n javax.sql,\n org.apache.commons.collections,\n org.apache.commons.collections.map,\n org.apache.commons.lang,\n org.apache.commons.lang.builder,\n org.apache.commons.lang.text,\n org.apache.commons.logging,\n org.apache.log,\n org.apache.log.format,\n org.apache.log.output.io,\n org.apache.log4j,\n org.apache.oro.text.perl,\n org.apache.tools.ant,\n org.apache.tools.ant.taskdefs,\n org.jdom,\n org.jdom.input,\n org.jdom.output,\n org.xml.sax\n\nto this:\n\nImport-Package: com.werken.xpath;resolution:=optional,\n javax.naming,\n javax.servlet;resolution:=optional,\n javax.servlet.http;resolution:=optional,\n javax.sql,\n org.apache.commons.collections,\n org.apache.commons.collections.map,\n org.apache.commons.lang,\n org.apache.commons.lang.builder,\n org.apache.commons.lang.text,\n org.apache.commons.logging;resolution:=optional,\n org.apache.log;resolution:=optional,\n org.apache.log.format;resolution:=optional,\n org.apache.log.output.io;resolution:=optional,\n org.apache.log4j;resolution:=optional,\n org.apache.oro.text.perl;resolution:=optional,\n org.apache.tools.ant;resolution:=optional,\n org.apache.tools.ant.taskdefs;resolution:=optional,\n org.jdom;resolution:=optional,\n org.jdom.input;resolution:=optional,\n org.jdom.output;resolution:=optional,\n org.xml.sax\n\nI'll prepare a patch against trunk and attach it shortly.\n", "reporter_id" : { "$oid" : "5b7d38ece9214a0d1608d7f3" }, "title" : "Mark optional dependencies as optional in OSGi bundle manifest", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:03.275+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2010-06-18T00:32:02.361+0000" } },
{ "_id" : { "$oid" : "5b904edb5f627d84c8d6cd86" }, "external_id" : "VELOCITY-720", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Suppress startup error message if macro library not found", "desc" : "\nEver since upgrading to Velocity 1.6.2 I get a stack trace when starting up due to a missing macro library.  The stack trace in particular makes for a very noisy log.  I suggest we do not print a stacktrace for a missing macro library at startup.\n\n Here's my settings\n\n       VelocityEngine ve = new VelocityEngine();\n\n       ve.setProperty(\"resource.loader\", \"class\");\n       ve.setProperty(\"class.resource.loader.class\", \"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\");\n       ve.setProperty(\"class.resource.loader.cache\", \"false\");\n\n       ve.setProperty(\"runtime.Log.invalid.references \", \"false\");\n       ve.setProperty(\"resource.manager.logwhenfound\", \"false\");\n       ve.setProperty(\"runtime.log.logsystem.class\", \"org.apache.velocity.runtime.log.SimpleLog4JLogSystem\");\n       ve.setProperty(\"runtime.log.logsystem.log4j.category\", \"com.forio.Velocity\");\n\nAnd here's the log report\n\n2009-05-26 23:46:58 DEBUG Velocimacro : \"velocimacro.library\" is not set.  Trying default library: VM_global_library.vm\n2009-05-26 23:46:58 DEBUG Could not load resource 'VM_global_library.vm' from ResourceLoader org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader:\n2009-05-26 23:46:58 DEBUG\norg.apache.velocity.exception.ResourceNotFoundException:\nClasspathResourceLoader Error: cannot find resource VM_global_library.vm\n       at org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader.getResourceStream(ClasspathResourceLoader.java:131)\n       at org.apache.velocity.runtime.resource.loader.ResourceLoader.resourceExists(ResourceLoader.java:224)\n       at org.apache.velocity.runtime.resource.ResourceManagerImpl.getLoaderForResource(ResourceManagerImpl.java:641)\n       at org.apache.velocity.runtime.resource.ResourceManagerImpl.getLoaderNameForResource(ResourceManagerImpl.java:624)\n       at org.apache.velocity.runtime.RuntimeInstance.getLoaderNameForResource(RuntimeInstance.java:1464)\n       at org.apache.velocity.runtime.VelocimacroFactory.initVelocimacro(VelocimacroFactory.java:159)\n       at org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:261)\n       at org.apache.velocity.app.VelocityEngine.init(VelocityEngine.java:107)", "created_at" : { "$date" : "2009-05-27T18:03:26.859+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:04.031+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904edb5f627d84c8d6cd85" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904eac5f627d84c8d6ca13" }, "external_id" : "VELOCITY-689", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5", "1.6.1", "1.6" ], "fix_versions" : [ "2.0", "1.7", "1.6.2" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eac5f627d84c8d6ca14" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "desc" : "Hi devs,\n   when we upgrade to velocity1.6.1. But the process failed. we found a\ncritical bug in velocity1.6.1 . I have mock the bug in details:\n\n   First step:\n\npublic interface ITestBean2{\n\n    String getName();\n}\n\npublic interface ITestBean extends ITestBean2 {\n\n}\n\nprivate static  class TestBean implements ITestBean {\n       private String name = \"test bean method name\";\n       public String getName() {\n           return name;\n       }\n}\n\n  then  set up velocity excute template code:\n\n  context.put(\"testBean\", new TestBean());\n  System.out.println(evaluate(\"$testBean.getName()\"));\n\n  We found $testBean.getName() can not be rendered.The template can be\nrendered in version1.4.  Then I debug several hours(I never read velocity\ncode before), we found a bug in class\norg.apache.velocity.util.introspection.ClassMap::createMethodCache() .  Code\n\"classToReflect.getInterfaces() \" is not correct used, Class.getInterfaces()\nCan *ONLY* get parent interfaces,  it  can not get a super super interface.\nSo Code \"createMethodCache()\" missed a interface check.\n\nLeon Liu\n================================================\n private MethodCache createMethodCache()\n   {\n       MethodCache methodCache = new MethodCache(log);\n       for (Class classToReflect = getCachedClass(); classToReflect != null\n; classToReflect = classToReflect.getSuperclass())\n       {\n           if (Modifier.isPublic(classToReflect.getModifiers()))\n           {\n               populateMethodCacheWith(methodCache, classToReflect);\n           }\n           *Class [] interfaces = classToReflect.getInterfaces();*\n           for (int i = 0; i < interfaces.length; i++)\n           {\n               if (Modifier.isPublic(interfaces[i].getModifiers()))\n               {\n                   populateMethodCacheWith(methodCache, interfaces[i]);\n               }\n           }\n       }\n       return methodCache;\n   }", "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "title" : "ClassMap misses super interfaces", "priority" : "Minor", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:06.144+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2009-02-05T16:21:51.868+0000" } },
{ "_id" : { "$oid" : "5b904eb45f627d84c8d6ca9a" }, "external_id" : "VELOCITY-786", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.6.4" ], "components" : [ "Engine" ], "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eb45f627d84c8d6ca9b" }, "effect" : "duplicates", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d398fe9214a0d1608d82d" }, "desc" : "While evaluating template with Velocity I am affecting:\n\njava.lang.NullPointerException\n\torg.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1103)\n\torg.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1086)\n\torg.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1199)\n\torg.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1165)\n\torg.apache.velocity.app.Velocity.evaluate(Velocity.java:191)\n\tpl.pollub.cafe.zeusx.modules.report.ReportController.generateWorkersSchedule(ReportController.java:300)\n\tsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tjava.lang.reflect.Method.invoke(Method.java:597)\n\torg.springframework.web.bind.annotation.support.HandlerMethodInvoker.doInvokeMethod(HandlerMethodInvoker.java:421)\n\torg.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:136)\n\torg.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:326)\n\torg.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:313)\n\torg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)\n\torg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)\n\torg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n\tpl.pollub.cafe.zeusx.commons.spring.FlashScopeFilter.doFilterInternal(FlashScopeFilter.java:33)\n\torg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n\torg.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:96)\n\torg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n\nexception.\n\nCode which is being executed:\ntry {\n\t\t\tVelocity.init();\n\t\t} catch (Exception e1) {\n\t\t\te1.printStackTrace();\n\t\t}\n\nthen\n\ntry {\n\t\t\tVelocity.evaluate( context, writer, \"string\", template.getSzablon());\n\t\t} catch (ParseErrorException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (MethodInvocationException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (ResourceNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\nThis code does not on production server, but works on development machines. I have tried using VelocityEngine instetad of Velocity Signleton but no luck.\n\nI also tried initializing Velocity during servlet startup but nothing changed. Any help appreciated :-)", "reporter_id" : { "$oid" : "5b7d398fe9214a0d1608d82d" }, "title" : "NullPointerException while evaluating template", "priority" : "Major", "status" : "Closed", "environment" : "FreeBSD 8.0, Java(TM) SE Runtime Environment (build 1.6.0_03-p4-root_19_oct_2010_22_21-b00), Apache Tomcat/6.0.29, Spring 2.5", "updated_at" : { "$date" : "2018-01-07T15:41:10.538+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2010-11-03T09:57:30.760+0000" } },
{ "_id" : { "$oid" : "5b904ee95f627d84c8d6cecd" }, "external_id" : "VELOCITY-704", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VTL Simplicity - \"Control\" objects", "desc" : "In the discussion for VELOCITY-680, Claude suggested the addition of what i'm calling \"control\" objects as a solution.   These would have the same name as the block directive or macro to which they belong.    At a minimum, these would provide get(key), set(key, value) and stop() methods to control the reference scoping and execution of the block to which they belong.   Directives could extend the basic control object to provide additional functions, such as index() and hasNext() for #foreach.   Here's some examples:\n\n#foreach( $user in $users )\n$user#if( $foreach.hasNext ), #end\n#if( $foreach.count > 10 ) $foreach.stop() #end\n#end\n\n#macro( foo $bar )\nblah blah #if( $bar == 'bar' ) $foo.stop() #end\n#set( $foo.woogie = 'woogie' )\n$foo.woogie\n#end\n\n#foreach( $item in $list )\n  #set( $outer = $foreach )\n  #foreach( $attr in $item.attributes )\n    #if ( $attr == $null ) $outer.stop()#end\n  #end\n#end\n\n------foo.vm---------\nblah blah $template.stop() blah\n------------------------\n\n#define( $foo )\nblah blah $define.stop() blah\n#end\n\nThis could allow us to greatly simplify all sorts of things.  We could remove the #break, #stop and #return directives.  We would no longer need to have \"local\" contexts for foreach loops or macros; instead users could set and get local variables directly in the provided namespace.   All else would be global.   This may even cut down our internal code complexity a fair bit.  It'll certainly obviate the need for several configuration properties and internal contexts.  Everything becomes much more explicit, obvious and robust.   I also don't think it looks ugly. :)\n\nWe would, of course, have to make sure that the StopExceptions thrown by stop() aren't wrapped into MethodInvocationExceptions.  We'd have to make the directives clean up their control when done rendering, and if they're nested in a directive of the same type, then they should save and restore the reference to the parent control.   We'd also have to figure out a good default name to give the control objects for the top-level control object, and whether it would be different than the name of the control object used during a #parse call.  $template?  $parse?  $velocity?  If we wanted to use $template--which i think works well for both top-level and #parse--then we'd probably have to make it configurable, since that's likely to conflict.   And if we make that configurable, i suppose we may as well make it configurable for the others too.\n\nI'm struggling to think of any real downside to this.  Most of the replaced features (implicit macro localscope, #stop, #break, $velocityHasNext) are either not default behavior or are new features.  I'd wager that most people would only have to change $velocityCount to $foreach.count.  Even that's no big deal, since this would be for a major version change.  , The worst i can think of is the fact that for a couple of these controls it would mean a few more keystrokes.  Considering all the gains in extensibility, explicitness and simplification (for us and users), i think it's worth a few keystrokes.\n\nWhat do you guys think?", "created_at" : { "$date" : "2009-02-18T20:54:55.899+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:10.801+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f4c5f627d6b05868124" }, "external_id" : "ZOOKEEPER-27", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d500f5f627d6b05869229" }, "external_id" : "ZOOKEEPER-388", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502b5f627d6b05869506" }, "external_id" : "HBASE-1449", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ea5f627d6b0586c3d5" }, "external_id" : "ZOOKEEPER-1205", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c035f627d846d496d62" }, "external_id" : "AVRO-319", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" }, "external_id" : "VELOCITY-470", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "components" : [ "Website" ], "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "desc" : "Do the necessary steps to move us to TLP.", "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "title" : "Set up Velocity TLP web site and move there.", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2007-03-08T00:12:32.890+0000" }, "issue_type" : "Task", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2006-10-29T20:52:21.000+0000" } },
{ "_id" : { "$oid" : "5b904d695f627d84c8d6b2fe" }, "external_id" : "VELOCITY-425", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "wrapped exceptions should have causes", "desc" : "When an exception is wrapped, the cause should be set.", "created_at" : { "$date" : "2005-11-29T04:17:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:22.666+0000" }, "creator_id" : { "$oid" : "5b7d3554e9214a0d1608d68f" }, "reporter_id" : { "$oid" : "5b7d3554e9214a0d1608d68f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d6b5f627d84c8d6b320" }, "external_id" : "VELOCITY-479", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Make the Jakarta site .htaccess change in svn to redirect to the new tlp", "created_at" : { "$date" : "2006-11-11T00:23:59.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:23.308+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6b5f627d84c8d6b329" }, "external_id" : "VELOCITY-478", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Move the site from Jakarta", "created_at" : { "$date" : "2006-11-11T00:23:33.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:23.078+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6c5f627d84c8d6b332" }, "external_id" : "VELOCITY-484", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Repair Gump to send notifications to the right email address", "created_at" : { "$date" : "2006-11-11T00:26:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:23.919+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6d5f627d84c8d6b33b" }, "external_id" : "VELOCITY-481", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove velocity from Jakarta site", "created_at" : { "$date" : "2006-11-11T00:24:29.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:23.756+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6d5f627d84c8d6b345" }, "external_id" : "VELOCITY-480", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Move SVN", "created_at" : { "$date" : "2006-11-11T00:24:16.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:23.482+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6e5f627d84c8d6b354" }, "external_id" : "VELOCITY-505", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "List new mailing lists on web site", "created_at" : { "$date" : "2006-12-03T14:37:20.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:24.873+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6f5f627d84c8d6b35e" }, "external_id" : "VELOCITY-490", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Create new JIRA group", "created_at" : { "$date" : "2006-11-11T00:28:36.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:24.731+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d6f5f627d84c8d6b36e" }, "external_id" : "VELOCITY-489", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update committee-info.txt", "created_at" : { "$date" : "2006-11-11T00:28:12.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:24.470+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d705f627d84c8d6b375" }, "external_id" : "VELOCITY-488", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add Henning to list of chairs", "created_at" : { "$date" : "2006-11-11T00:27:58.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:24.324+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d715f627d84c8d6b37c" }, "external_id" : "VELOCITY-485", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update JIRA to send notifications to velocity-commits", "created_at" : { "$date" : "2006-11-11T00:27:00.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:24.084+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d715f627d84c8d6b384" }, "external_id" : "VELOCITY-506", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Create new Velocity download page", "created_at" : { "$date" : "2006-12-03T14:40:12.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:25.047+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904dac5f627d84c8d6b8dd" }, "external_id" : "VELOCITY-530", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NoClassDefFound Error at Jboss 4.0.3 server startup", "desc" : "I was working on upgrading from Jboss-3.2.3 to Jboss-4.0.5. I got a  NoClassDefFound exception when I start my server while deploying EJBs  which have velocity classes in them. The jar has the Velocity jars   and this works for Jboss-3.2.3 but does not work for Jboss-4.0.5.The  error I get is below. I fixed the error by moving the velocity jars to the root of the jar from the original META-INF/lib directory.\n\n>\n> java.lang.NoClassDefFoundError: org/apache/velocity/context/Context\n>         at java.lang.Class.getDeclaredMethods0(Native Method)\n>         at java.lang.Class.privateGetDeclaredMethods(Class.java:1655)\n>         at java.lang.Class.privateGetPublicMethods(Class.java:1778)\n>         at java.lang.Class.getMethods(Class.java:832)\n>         at\n> org.jboss.verifier.strategy.AbstractVerifier.hasEJBCreateMethod(Abstra\n> ct\n> Verifier.java:687)\n>         at\n> org.jboss.verifier.strategy.EJBVerifier20.verifySessionBean(EJBVerifie\n> r2\n> 0.java:848)\n>         at\n> org.jboss.verifier.strategy.EJBVerifier20.checkSession(EJBVerifier20.j\n> av\n> a:78)\n>         at org.jboss.verifier.BeanVerifier.verify(BeanVerifier.java:181)\n>         at org.jboss.ejb.EJBDeployer.create(EJBDeployer.java:594)\n>         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>         at\n> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.j\n> av\n> a:39)\n>         at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccess\n> or\n> Impl.java:25)\n>         at java.lang.reflect.Method.invoke(Method.java:324)\n>         at\n> org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.\n> java:155)\n>         at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)\n>         at\n> org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.\n> java:133)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMB\n> ea\n> nOperationInterceptor.java:142)\n>         at\n> org.jboss.mx.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.\n> ja\n> va:97)\n>         at\n> org.jboss.system.InterceptorServiceMBeanSupport.invokeNext(Interceptor\n> Se\n> rviceMBeanSupport.java:238)\n>         at\n> org.jboss.ws.integration.jboss.DeployerInterceptor.create(DeployerInte\n> rc\n> eptor.java:74)\n>         at\n> org.jboss.ws.integration.jboss.DeployerInterceptorEJB.create(DeployerI\n> nt\n> erceptorEJB.java:44)\n>         at\n> org.jboss.deployment.SubDeployerInterceptorSupport$XMBeanInterceptor.c\n> re\n> ate(SubDeployerInterceptorSupport.java:180)\n>         at\n> org.jboss.deployment.SubDeployerInterceptor.invoke(SubDeployerIntercep\n> to\n> r.java:91)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.j\n> av\n> a:264)\n>         at\n> org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)\n>         at\n> org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)\n>         at $Proxy26.create(Unknown Source)\n>         at\n> org.jboss.deployment.MainDeployer.create(MainDeployer.java:969)\n>         at\n> org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:818)\n>         at\n> org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)\n>         at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)\n>         at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccess\n> or\n> Impl.java:25)\n>         at java.lang.reflect.Method.invoke(Method.java:324)\n>         at\n> org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.\n> java:155)\n>         at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)\n>         at\n> org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.\n> java:133)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMB\n> ea\n> nOperationInterceptor.java:142)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.j\n> av\n> a:264)\n>         at\n> org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)\n>         at\n> org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)\n>         at $Proxy8.deploy(Unknown Source)\n>         at\n> org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeployment\n> Sc\n> anner.java:421)\n>         at\n> org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentSc\n> an\n> ner.java:634)\n>         at\n> org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.d\n> oS\n> can(AbstractDeploymentScanner.java:263)\n>         at\n> org.jboss.deployment.scanner.AbstractDeploymentScanner.startService(Ab\n> st\n> ractDeploymentScanner.java:336)\n>         at\n> org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSu\n> pp\n> ort.java:289)\n>         at\n> org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBe\n> an\n> Support.java:245)\n>         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>         at\n> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.j\n> av\n> a:39)\n>         at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccess\n> or\n> Impl.java:25)\n>         at java.lang.reflect.Method.invoke(Method.java:324)\n>         at\n> org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.\n> java:155)\n>         at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)\n>         at\n> org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.j\n> av\n> a:264)\n>         at\n> org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)\n>         at\n> org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceControll\n> er\n> .java:978)\n>         at $Proxy0.start(Unknown Source)\n>         at\n> org.jboss.system.ServiceController.start(ServiceController.java:417)\n>         at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)\n>         at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccess\n> or\n> Impl.java:25)\n>         at java.lang.reflect.Method.invoke(Method.java:324)\n>         at\n> org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.\n> java:155)\n>         at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)\n>         at\n> org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.j\n> av\n> a:264)\n>         at\n> org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)\n>         at\n> org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)\n>         at $Proxy4.start(Unknown Source)\n>         at org.jboss.deployment.SARDeployer.start(SARDeployer.java:302)\n>         at\n> org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)\n>         at\n> org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)\n>         at\n> org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)\n>         at\n> org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:766)\n>         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n>         at\n> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.j\n> av\n> a:39)\n>         at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccess\n> or\n> Impl.java:25)\n>         at java.lang.reflect.Method.invoke(Method.java:324)\n>         at\n> org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.\n> java:155)\n>         at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)\n>         at\n> org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.\n> java:133)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMB\n> ea\n> nOperationInterceptor.java:142)\n>         at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)\n>         at\n> org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.j\n> av\n> a:264)\n>         at\n> org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)\n>         at\n> org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)\n>         at $Proxy5.deploy(Unknown Source)\n>         at\n> org.jboss.system.server.ServerImpl.doStart(ServerImpl.java:482)\n>         at org.jboss.system.server.ServerImpl.start(ServerImpl.java:362)\n>         at org.jboss.Main.boot(Main.java:200)\n>         at org.jboss.Main$1.run(Main.java:490)\n>         at java.lang.Thread.run(Thread.java:534)\n> 16:22:06,568 ERROR [MainDeployer] Could not create deployment:\n> file:/C:/jboss-4.0.5.GA/server/rrt/deploy/rrt_common_ejb.jar\n> org.jboss.deployment.DeploymentException: Verification of Enterprise \n> Beans failed, see above for error messages.\n>         at org.jboss.ejb.EJBDeployer.create(EJBDeployer.java:610)\n", "created_at" : { "$date" : "2007-03-20T21:39:41.980+0000" }, "updated_at" : { "$date" : "2008-08-20T22:28:21.539+0000" }, "creator_id" : { "$oid" : "5b7d3687e9214a0d1608d71c" }, "reporter_id" : { "$oid" : "5b7d3687e9214a0d1608d71c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4", "1.5", "1.3.1" ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Jboss 4.0.3, Windows xp" },
{ "_id" : { "$oid" : "5b904df25f627d84c8d6be51" }, "external_id" : "VELOCITY-586", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add debugging hooks to #parse", "desc" : "When you have a page that is made up of a complex web of templates and #parsed includes, it is critical to be able to quickly see what parts of the page are really in what file.\n\nTo do this, I've hacked #parse to inject debugging information into the template when a 'debug mode' is engaged.  This debug mode is engaged via a URL parameter.\n\nI also inject this information in the VVS right before the main template is rendered.  In this way, you can create a debug overlay on top of the page in your browser that shows you where each piece of text is coming from.\n\nI think this probably could better be implemented using hooks, so that a user could trigger when the debug information was being injected.\n\nI also suggest that the name of the current template, it's resource loader, etc. be passed into the context, so it can be used to see what template is where and what loader it came from.\n\nFinally, if there could be a way to conditionally prepend or append a template to each merged or #parse template, that could also help.\n\nThanks!!!\n\npackage org.apache.velocity.runtime.directive;\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.    \n */\n\nimport java.io.IOException;\nimport java.io.Writer;\n\nimport javax.servlet.http.HttpSession;\n\nimport org.apache.velocity.Template;\nimport org.apache.velocity.app.event.EventHandlerUtil;\nimport org.apache.velocity.context.InternalContextAdapter;\nimport org.apache.velocity.exception.MethodInvocationException;\nimport org.apache.velocity.exception.ParseErrorException;\nimport org.apache.velocity.exception.ResourceNotFoundException;\nimport org.apache.velocity.runtime.RuntimeConstants;\nimport org.apache.velocity.runtime.parser.node.Node;\nimport org.apache.velocity.runtime.parser.node.SimpleNode;\n\nimport com.qwest.velocity.VelocityConstants;\n\n/**\n * Pluggable directive that handles the <code>#parse()</code> statement in VTL.\n * \n * <pre>\n *  Notes:\n *  -----\n *   1) The parsed source material can only come from somewhere in\n *     the TemplateRoot tree for security reasons. There is no way\n *     around this.  If you want to include content from elsewhere on\n *     your disk, use a link from somwhere under Template Root to that\n *     content.\n * \n *   2) There is a limited parse depth.  It is set as a property\n *     &quot;parse_directive.maxdepth = 10&quot;  for example.  There is a 20 iteration\n *     safety in the event that the parameter isn't set.\n * </pre>\n * \n * @author <a href=\"mailto:geirm@optonline.net\">Geir Magnusson Jr.</a>\n * @author <a href=\"mailto:jvanzyl@apache.org\">Jason van Zyl</a>\n * @author <a href=\"mailto:Christoph.Reck@dlr.de\">Christoph Reck</a>\n * @version $Id: Parse.java 463298 2006-10-12 16:10:32Z henning $\n */\npublic class Parse extends InputBase {\n\t/**\n\t * Return name of this directive.\n\t * \n\t * @return The name of this directive.\n\t */\n\tpublic String getName() {\n\t\treturn \"parse\";\n\t}\n\n\t/**\n\t * Return type of this directive.\n\t * \n\t * @return The type of this directive.\n\t */\n\tpublic int getType() {\n\t\treturn LINE;\n\t}\n\n\t/**\n\t * iterates through the argument list and renders every argument that is appropriate. Any non appropriate arguments are logged, but render() continues.\n\t * \n\t * @param context\n\t * @param writer\n\t * @param node\n\t * @return True if the directive rendered successfully.\n\t * @throws IOException\n\t * @throws ResourceNotFoundException\n\t * @throws ParseErrorException\n\t * @throws MethodInvocationException\n\t */\n\tpublic boolean render(InternalContextAdapter context, Writer writer, Node node) throws IOException, ResourceNotFoundException, ParseErrorException, MethodInvocationException {\n\t\t/*\n\t\t * if rendering is no longer allowed (after a stop), we can safely skip execution of all the parse directives.\n\t\t */\n\t\tif (!context.getAllowRendering()) {\n\t\t\treturn true;\n\t\t}\n\n\t\t/*\n\t\t * did we get an argument?\n\t\t */\n\t\tif (node.jjtGetChild(0) == null) {\n\t\t\trsvc.getLog().error(\"Portal #parse() null argument\");\n\t\t\treturn false;\n\t\t}\n\n\t\t/*\n\t\t * does it have a value? If you have a null reference, then no.\n\t\t */\n\t\tObject value = node.jjtGetChild(0).value(context);\n\n\t\tif (value == null) {\n\t\t\trsvc.getLog().error(\"Portal #parse() null argument\");\n\t\t\treturn false;\n\t\t}\n\n\t\t/*\n\t\t * get the path\n\t\t */\n\t\tString sourcearg = value.toString();\n\n\t\t/*\n\t\t * check to see if the argument will be changed by the event cartridge\n\t\t */\n\n\t\tString arg = EventHandlerUtil.includeEvent(rsvc, context, sourcearg, context.getCurrentTemplateName(), getName());\n\n\t\t/*\n\t\t * a null return value from the event cartridge indicates we should not input a resource.\n\t\t */\n\t\tboolean blockinput = false;\n\t\tif (arg == null)\n\t\t\tblockinput = true;\n\n\t\t/*\n\t\t * see if we have exceeded the configured depth. If it isn't configured, put a stop at 20 just in case.\n\t\t */\n\n\t\tObject[] templateStack = context.getTemplateNameStack();\n\n\t\tif (templateStack.length >= rsvc.getInt(RuntimeConstants.PARSE_DIRECTIVE_MAXDEPTH, 20)) {\n\t\t\tStringBuffer path = new StringBuffer();\n\n\t\t\tfor (int i = 0; i < templateStack.length; ++i) {\n\t\t\t\tpath.append(\" > \" + templateStack[i]);\n\t\t\t}\n\n\t\t\trsvc.getLog().error(\"Portal #parse: Max recursion depth reached (\" + templateStack.length + ')' + \" File stack:\" + path);\n\t\t\treturn false;\n\t\t}\n\n\t\t/*\n\t\t * now use the Runtime resource loader to get the template\n\t\t */\n\n\t\tTemplate t = null;\n\n\t\ttry {\n\t\t\tif (!blockinput)\n\t\t\t\tt = rsvc.getTemplate(arg, getInputEncoding(context));\n\t\t} catch (ResourceNotFoundException rnfe) {\n\t\t\t/*\n\t\t\t * the arg wasn't found. Note it and throw\n\t\t\t */\n\t\t\trsvc.getLog().error(\"Portal #parse(): cannot find template '\" + arg + \"', called from template \" + context.getCurrentTemplateName() + \" at (\" + getLine() + \", \" + getColumn() + \")\");\n\t\t\tthrow rnfe;\n\t\t} catch (ParseErrorException pee) {\n\t\t\t/*\n\t\t\t * the arg was found, but didn't parse - syntax error note it and throw\n\t\t\t */\n\n\t\t\trsvc.getLog().error(\n\t\t\t\t\t\"Portal #parse(): syntax error in #parse()-ed template '\" + arg + \"', called from template \" + context.getCurrentTemplateName() + \" at (\" + getLine() + \", \" + getColumn() + \")\");\n\n\t\t\tthrow pee;\n\t\t}\n\t\t/**\n\t\t * pass through application level runtime exceptions\n\t\t */\n\t\tcatch (RuntimeException e) {\n\t\t\tthrow e;\n\t\t} catch (Exception e) {\n\t\t\trsvc.getLog().error(\"Portal #parse() : arg = \" + arg + '.', e);\n\t\t\treturn false;\n\t\t}\n\n\t\t/*\n\t\t * and render it\n\t\t */\n\t\ttry {\n\t\t\tif (rsvc.getLog().isDebugEnabled()) {\n\t\t\t\trsvc.getLog().debug(\"*** Portal #Parse Template Path: \" + t.getName());\n\t\t\t}\n\t\t\t\n\t\t\t/* Save the name of the main template before resetting templateName for this include */\n\t\t\tString mainTemplateName = \"\";\n\t\t\tif (context.get(VelocityConstants.TEMPLATE_NAME_VAR) != null) {\n\t\t\t\tmainTemplateName = context.get(VelocityConstants.TEMPLATE_NAME_VAR).toString();\n\t\t\t}\n\n\t\t\t/* Set the name of the current template in the context for general use */\n\t\t\tcontext.put(VelocityConstants.TEMPLATE_NAME_VAR, t.getName());\n\n\t\t\t/* Check various places to see if debug mode is enabled */\n\t\t\tboolean debugMode = false;\n\t\t\t/* This supports PortalVelocityViewServlet */\n\t\t\tif (context.get(VelocityConstants.DEBUG_ATTRIBUTE) != null) {\n\t\t\t\tdebugMode = true;\n\t\t\t}\n\t\t\t/* This supports qcms.getMessage() */\n\t\t\tif (context.get(\"session\") != null) {\n\t\t\t\tHttpSession session = (HttpSession) context.get(\"session\");\n\t\t\t\tif (session.getAttribute(\"qCmsDebugger\") != null) {\n\t\t\t\t\tdebugMode = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Print Debug start output to browser if debug mode is on */\n\t\t\tif (debugMode) {\n\t\t\t\tTemplate startTemplate = rsvc.getTemplate(VelocityConstants.DEBUG_OUTLINE_START_TEMPLATE, getInputEncoding(context));\n\t\t\t\tstartTemplate.merge(context, writer);\n\t\t\t\tTemplate nameTemplate = rsvc.getTemplate(VelocityConstants.DEBUG_NAME_TEMPLATE, getInputEncoding(context));\n\t\t\t\tnameTemplate.merge(context, writer);\n\t\t\t}\n\t\t\t\n\t\t\tif (!blockinput) {\n\t\t\t\tcontext.pushCurrentTemplateName(arg);\n\t\t\t\t((SimpleNode) t.getData()).render(context, writer);\n\t\t\t}\n\t\t\t\n\t\t\t/* Print Debug end output to browser if debug mode is on */\n\t\t\tif (debugMode) {\n\t\t\t\tTemplate endTemplate = rsvc.getTemplate(VelocityConstants.DEBUG_OUTLINE_END_TEMPLATE, getInputEncoding(context));\n\t\t\t\tendTemplate.merge(context, writer);\n\t\t\t}\n\n\t\t\t/* Restore the templateName variable to match the main template name */\n\t\t\tcontext.put(VelocityConstants.TEMPLATE_NAME_VAR, mainTemplateName);\n\t\t}\n\n\t\t/*\n\t\t * if it's a MIE, it came from the render.... throw it...\n\t\t */\n\t\tcatch (MethodInvocationException e) {\n\t\t\tthrow e;\n\t\t}\n\n\t\t/**\n\t\t * pass through application level runtime exceptions\n\t\t */\n\t\tcatch (RuntimeException e) {\n\t\t\tthrow e;\n\t\t}\n\n\t\tcatch (Exception e) {\n\t\t\trsvc.getLog().error(\"Portal #parse: Exception rendering #parse(\" + arg + ')', e);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tif (!blockinput)\n\t\t\t\tcontext.popCurrentTemplateName();\n\t\t}\n\n\t\t/*\n\t\t * note - a blocked input is still a successful operation as this is expected behavior.\n\t\t */\n\n\t\treturn true;\n\t}\n\n}\n", "created_at" : { "$date" : "2008-01-30T17:27:16.010+0000" }, "updated_at" : { "$date" : "2009-11-03T03:09:46.746+0000" }, "creator_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "reporter_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e3b5f627d84c8d6c31e" }, "external_id" : "VELOCITY-141", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "can't assign a velocity reference to the return value of a method when the value is null", "desc" : "I understand this is not a bug, and that it is a documented feature, but I fail \nto see the logic behind preventing the template designer from assigning a \nreference to the return value of a method when that method returns null.  It \ncan easily lead to unexpected results unless great care is taken, and it \nprevents the use of temporary references within foreach loops.  This behavior \nis contrary to that of all other templating languages I've seen and there is \nnot even an adequate explanation for it.", "created_at" : { "$date" : "2003-02-14T04:47:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:02.876+0000" }, "creator_id" : { "$oid" : "5b7d37bae9214a0d1608d790" }, "reporter_id" : { "$oid" : "5b7d37bae9214a0d1608d790" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e3d5f627d84c8d6c331" }, "external_id" : "VELOCITY-302", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityViewServlet+ClasspathResourceLoader doesn't work with jars+Tomcat", "desc" : "When you configure VelocityViewServlet to use ClasspathResourceLoader, it fails \nto load templates in jar files on Tomcat.\n\nVelocityViewServlet tries to load templates with a \"/\" leading the path, while \njava.util.jar.JarFile#getJarEntry() returns null for such value.  In order to \nmake this work, the leading \"/\" must be trimmed.\n\nThere are two places for a possible fix:\n\n1. VelocityViewServlet#handleRequest()\n2. ClasspathResourceLoader#getResourceStream()\n\nI don't know which is the right fix, but I'll post patches for both.", "created_at" : { "$date" : "2004-10-13T20:03:27.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:03.577+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e3f5f627d84c8d6c358" }, "external_id" : "VELOCITY-198", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "servlet_example2", "desc" : "The instructions in the Classloader section has the following sentence.\n\n- place a copy of velocity.properties.classloader, but rename to be \nvelocity.properties\n\nWhere does it get copied to? (\"rename to\"  would be better as \"rename it to\") \nbut we can live with poor English if the information is complete.\n\nThe FileResourceLoader has the same incomplete sentence.", "created_at" : { "$date" : "2003-08-15T00:49:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:04.619+0000" }, "creator_id" : { "$oid" : "5b7d37bee9214a0d1608d792" }, "reporter_id" : { "$oid" : "5b7d37bee9214a0d1608d792" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e425f627d84c8d6c385" }, "external_id" : "VELOCITY-295", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity doesn't do arithmetics with java.lang.Long", "desc" : "If I put a java.lang.Long value into velocity context and try to do\narithmetics ('#set ($result = $long_value + 1)') with it, I get an \nundefined value. If I convert that value into java.lang.Integer and \nput Integer into context, simple arithmetic operations work well.\n\nIs this a bug, or is this intended operation? I really need operations\non Long values in velocity templates. I could write support for this\nmyself, but I want feedback before doing it.\n\nP.S. I also checked other classes, like java.lang.Double, java.lang.Float- they\ndon't work either.\n\nP.P.S. I also checked this on Velocity v1.3, same results.\n\nTeofilis Martisius", "created_at" : { "$date" : "2004-09-21T17:23:57.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:05.876+0000" }, "creator_id" : { "$oid" : "5b7d37c2e9214a0d1608d796" }, "reporter_id" : { "$oid" : "5b7d37c2e9214a0d1608d796" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e425f627d84c8d6c38e" }, "external_id" : "VELOCITY-176", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DataSourceResourceLoader throws null pointer exception", "desc" : "Hi,\n\nI am trying  to use DB (Oracle) as a storage for my templates, but using\norg.apache.velocity.runtime.resource.loader.DataSourceResourceLoader class I am \ngetting consistently null pointer exception.\n\nI was able to debug it and it seems that this could be the fix for this problem:\nchange getResourceStream function to return StringBufferInputStream(strField), \nwhere strField is: String strField = rs.getString(templateColumn);\n(not  BufferedInputStream(rs.getAsciiStream(templateColumn)) )\n\nNote: this also will require import java.io.*;\n\nPlease see the modified class below.\n\nPlease let me know if this change make sense or is there something else I \nshould do to avoid this problem.\n\nThanks.\n\n\n\npackage org.apache.velocity.runtime.resource.loader;\nimport java.io.*;\n\n/*\n * The Apache Software License, Version 1.1\n *\n * Copyright (c) 2001-2002 The Apache Software Foundation.  All rights\n * reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in\n *    the documentation and/or other materials provided with the\n *    distribution.\n *\n * 3. The end-user documentation included with the redistribution, if\n *    any, must include the following acknowlegement:\n *       \"This product includes software developed by the\n *        Apache Software Foundation (http://www.apache.org/).\"\n *    Alternately, this acknowlegement may appear in the software itself,\n *    if and wherever such third-party acknowlegements normally appear.\n *\n * 4. The names \"The Jakarta Project\", \"Velocity\", and \"Apache Software\n *    Foundation\" must not be used to endorse or promote products derived\n *    from this software without prior written permission. For written\n *    permission, please contact apache@apache.org.\n *\n * 5. Products derived from this software may not be called \"Apache\"\n *    nor may \"Apache\" appear in their names without prior written\n *    permission of the Apache Group.\n *\n * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n * SUCH DAMAGE.\n * ====================================================================\n *\n * This software consists of voluntary contributions made by many\n * individuals on behalf of the Apache Software Foundation.  For more\n * information on the Apache Software Foundation, please see\n * <http://www.apache.org/>.\n */\n\nimport java.io.InputStream;\nimport java.io.BufferedInputStream;\nimport java.util.Hashtable;\n\nimport javax.sql.DataSource;\nimport javax.naming.InitialContext;\n\nimport org.apache.velocity.runtime.Runtime;\nimport org.apache.velocity.runtime.resource.Resource;\n\nimport org.apache.velocity.exception.ResourceNotFoundException;\n\nimport org.apache.commons.collections.ExtendedProperties;\nimport java.sql.Connection;\nimport java.sql.ResultSet;\nimport java.sql.Statement;\nimport java.sql.SQLException;\n\n/**\n * This is a simple template file loader that loads templates\n * from a DataSource instead of plain files.\n *\n * It can be configured with a datasource name, a table name,\n * id column (name), content column (the template body) and a\n * datetime column (for last modification info).\n * <br>\n * <br>\n * Example configuration snippet for velocity.properties:\n * <br>\n * <br>\n * resource.loader = file, ds <br>\n * <br>\n * ds.resource.loader.public.name = DataSource <br>\n * ds.resource.loader.description = Velocity DataSource Resource Loader <br>\n * ds.resource.loader.class = \norg.apache.velocity.runtime.resource.loader.DataSourceResourceLoader <br>\n * ds.resource.loader.resource.datasource = java:comp/env/jdbc/Velocity <br>\n * ds.resource.loader.resource.table = tb_velocity_template <br>\n * ds.resource.loader.resource.keycolumn = id_template <br>\n * ds.resource.loader.resource.templatecolumn = template_definition <br>\n * ds.resource.loader.resource.timestampcolumn = template_timestamp <br>\n * ds.resource.loader.cache = false <br>\n * ds.resource.loader.modificationCheckInterval = 60 <br>\n * <br>\n * Example WEB-INF/web.xml: <br>\n * <br>\n *\t<resource-ref> <br>\n *\t <description>Velocity template DataSource</description> <br>\n *\t <res-ref-name>jdbc/Velocity</res-ref-name> <br>\n *\t <res-type>javax.sql.DataSource</res-type> <br>\n *\t <res-auth>Container</res-auth> <br>\n *\t</resource-ref> <br>\n * <br>\n *  <br>\n * and Tomcat 4 server.xml file: <br>\n *  [...] <br>\n *  <Context path=\"/exampleVelocity\" docBase=\"exampleVelocity\" debug=\"0\"> <br>\n *  [...] <br>\n *   <ResourceParams name=\"jdbc/Velocity\"> <br>\n *    <parameter> <br>\n *      <name>driverClassName</name> <br>\n *      <value>org.hsql.jdbcDriver</value> <br>\n *    </parameter> <br>\n *    <parameter> <br>\n *     <name>driverName</name> <br>\n *     <value>jdbc:HypersonicSQL:database</value> <br>\n *    </parameter> <br>\n *    <parameter> <br>\n *     <name>user</name> <br>\n *     <value>database_username</value> <br>\n *    </parameter> <br>\n *    <parameter> <br>\n *     <name>password</name> <br>\n *     <value>database_password</value> <br>\n *    </parameter> <br>\n *   </ResourceParams> <br>\n *  [...] <br>\n *  </Context> <br>\n *  [...] <br>\n * <br>\n *  Example sql script:<br>\n *  CREATE TABLE tb_velocity_template ( <br>\n *\tid_template varchar (40) NOT NULL , <br>\n *\ttemplate_definition text (16) NOT NULL , <br>\n *\ttemplate_timestamp datetime NOT NULL  <br>\n *\t) <br>\n *\n * @author <a href=\"mailto:david.kinnvall@alertir.com\">David Kinnvall</a>\n * @author <a href=\"mailto:paulo.gaspar@krankikom.de\">Paulo Gaspar</a>\n * @author <a href=\"mailto:lachiewicz@plusnet.pl\">Sylwester Lachiewicz</a>\n * @version $Id: DataSourceResourceLoader.java,v 1.8 2002/02/10 18:46:58 geirm \nExp $\n */\npublic class DataSourceResourceLoader extends ResourceLoader\n{\n     private String dataSourceName;\n     private String tableName;\n     private String keyColumn;\n     private String templateColumn;\n     private String timestampColumn;\n     private InitialContext ctx;\n     private DataSource dataSource;\n\n     public void init( ExtendedProperties configuration)\n     {\n         dataSourceName  = configuration.getString(\"resource.datasource\");\n         tableName       = configuration.getString(\"resource.table\");\n         keyColumn       = configuration.getString(\"resource.keycolumn\");\n         templateColumn  = configuration.getString(\"resource.templatecolumn\");\n         timestampColumn = configuration.getString(\"resource.timestampcolumn\");\n\n         Runtime.info(\"Resources Loaded From: \" + dataSourceName + \"/\" + \ntableName);\n         Runtime.info( \"Resource Loader using columns: \" + keyColumn + \", \"\n                       + templateColumn + \" and \" + timestampColumn);\n         Runtime.info(\"Resource Loader Initalized.\");\n     }\n\n     public boolean isSourceModified(Resource resource)\n     {\n         return (resource.getLastModified() !=\n                 readLastModified(resource, \"checking timestamp\"));\n     }\n\n     public long getLastModified(Resource resource)\n     {\n         return readLastModified(resource, \"getting timestamp\");\n     }\n\n     /**\n      * Get an InputStream so that the Runtime can build a\n      * template with it.\n      *\n      *  @param name name of template\n      *  @return InputStream containing template\n      */\n     public synchronized InputStream getResourceStream( String name )\n         throws ResourceNotFoundException\n     {\n         if (name == null || name.length() == 0)\n         {\n             throw new ResourceNotFoundException (\"Need to specify a template \nname!\");\n         }\n\n         try\n         {\n             Connection conn = openDbConnection();\n\n             try\n             {\n                 ResultSet rs = readData(conn, templateColumn, name);\n\n                try {\n                    if (rs.next()) {\n                        String strField = rs.getString(templateColumn);\n                         return new\n                                StringBufferInputStream(strField);\n                        //return new\n                        //    BufferedInputStream(rs.getAsciiStream\n(templateColumn));\n                     }\n                     else\n                     {\n                         String msg = \"DataSourceResourceLoader Error: cannot \nfind resource \"\n                             + name;\n                         Runtime.error(msg );\n\n                         throw new ResourceNotFoundException (msg);\n                     }\n                 }\n                 finally\n                 {\n                     rs.close();\n                 }\n             }\n             finally\n             {\n                 closeDbConnection(conn);\n             }\n         }\n         catch(Exception e)\n         {\n             String msg =  \"DataSourceResourceLoader Error: database problem \ntrying to load resource \"\n                 + name + \": \" + e.toString();\n\n             Runtime.error( msg );\n\n             throw new ResourceNotFoundException (msg);\n\n         }\n\n     }\n\n    /**\n     *  Fetches the last modification time of the resource\n     *\n     *  @param resource Resource object we are finding timestamp of\n     *  @param i_operation string for logging, indicating caller's intention\n     *\n     *  @return timestamp as long\n     */\n     private long readLastModified(Resource resource, String i_operation)\n     {\n         /*\n          *  get the template name from the resource\n          */\n\n         String name = resource.getName();\n         try\n         {\n             Connection conn = openDbConnection();\n\n             try\n             {\n                 ResultSet rs = readData(conn, timestampColumn, name);\n                 try\n                 {\n                     if (rs.next())\n                     {\n\t                     return rs.getTimestamp(timestampColumn).getTime();\n                     }\n                     else\n                     {\n                         Runtime.error(\"DataSourceResourceLoader Error: while \"\n                                       + i_operation\n                                       + \" could not find resource \" + name);\n                     }\n                 }\n                 finally\n                 {\n                     rs.close();\n                 }\n             }\n             finally\n             {\n                 closeDbConnection(conn);\n             }\n         }\n         catch(Exception e)\n         {\n             Runtime.error( \"DataSourceResourceLoader Error: error while \"\n                 + i_operation + \" when trying to load resource \"\n                 + name + \": \" + e.toString() );\n         }\n         return 0;\n     }\n\n    /**\n     *   gets connection to the datasource specified through the configuration\n     *  parameters.\n     *\n     *  @return connection\n     */\n     private Connection openDbConnection()\n         throws Exception\n    {\n         if(ctx == null)\n         {\n             ctx = new InitialContext();\n         }\n\n         if(dataSource == null)\n         {\n             dataSource = (DataSource)ctx.lookup(dataSourceName);\n         }\n\n         return dataSource.getConnection();\n     }\n\n    /**\n     *  Closes connection to the datasource\n     */\n     private void closeDbConnection(Connection conn)\n     {\n         try\n         {\n             conn.close();\n         }\n         catch (Exception e)\n         {\n             Runtime.info(\n                 \"DataSourceResourceLoader Quirk: problem when closing \nconnection: \"\n                 + e.toString());\n         }\n     }\n\n    /**\n     *  Reads the data from the datasource.  It simply does the following \nquery :\n     *  <br>\n     *   SELECT <i>columnNames</i> FROM <i>tableName</i> WHERE <i>keyColumn</i>\n     *      = '<i>templateName</i>'\n     *  <br>\n     *  where <i>keyColumn</i> is a class member set in init()\n     *\n     *  @param conn connection to datasource\n     *  @param columnNames columns to fetch from datasource\n     *  @param templateName name of template to fetch\n     *  @return result set from query\n     */\n     private ResultSet readData(Connection conn, String columnNames, String \ntemplateName)\n         throws SQLException\n     {\n         Statement stmt = conn.createStatement();\n\n         String sql = \"SELECT \" + columnNames\n                      + \" FROM \" + tableName\n                      + \" WHERE \" + keyColumn + \" = '\" + templateName + \"'\";\n\n         return stmt.executeQuery(sql);\n     }\n}", "created_at" : { "$date" : "2003-04-30T03:12:29.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:05.196+0000" }, "creator_id" : { "$oid" : "5b7d37c3e9214a0d1608d797" }, "reporter_id" : { "$oid" : "5b7d37c3e9214a0d1608d797" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e435f627d84c8d6c399" }, "external_id" : "VELOCITY-172", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Correct image size for Velocity Tools - Generic Tools PNG", "desc" : "Hmm... can you patch a binary? :-) \nI'll attach the revised image, but is it easier to just grab it from the URL \nabove?\nTimo", "created_at" : { "$date" : "2003-04-26T23:12:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:05.371+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e445f627d84c8d6c3a1" }, "external_id" : "VELOCITY-171", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add target to build.xml to create doc tarball", "desc" : "Tiny little patch for build.xml to add in a 'tardocs' target which builds a \ncompressed tarball for the docs/xdocs trees. This is just an interim \nconvenience so that the docs can be easily published to a web server until the \njakarta publishing process is figured out. \n\nTimo\n\n\nIndex: build.xml\n===================================================================\nRCS file: /home/cvspublic/jakarta-velocity-tools/build.xml,v\nretrieving revision 1.13\ndiff -u -r1.13 build.xml\n--- build.xml   26 Apr 2003 01:31:01 -0000      1.13\n+++ build.xml   26 Apr 2003 15:55:55 -0000\n@@ -280,5 +280,17 @@\n   </target>\n\n\n+  <!-- ================================================================== -->\n+  <!-- TAR  A L L  D O C S                                                -->\n+  <!-- ================================================================== -->\n+  <target name=\"tardocs\"\n+    description=\"Combine all xdocs and docs into a tar ball.\">\n+\n+        <tar destfile=\"${basedir}/docs.tar.gz\"\n+        basedir=\"${basedir}\"\n+        includes=\"docs/**,xdocs/**\"\n+        compression=\"gzip\"\n+        />\n+        </target>\n\n </project>", "created_at" : { "$date" : "2003-04-26T23:01:27.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:05.028+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e445f627d84c8d6c3a9" }, "external_id" : "VELOCITY-307", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Building Velocity with Maven", "desc" : "Currently, Velocity does not build with the released version of Maven (1.0).\n\nWhat I did:\n  http://www.mail-archive.com/velocity-dev@jakarta.apache.org/msg10534.html", "created_at" : { "$date" : "2004-10-25T09:54:45.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:06.468+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e455f627d84c8d6c3b8" }, "external_id" : "VELOCITY-330", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The encoding cannot be specified in Generator#parse(...). The spelling of a parameter is wrong.", "desc" : "\"template encoding\" cannot be specified in\norg.apache.velocity.texen.Generator#parse(String, String, String, String,\nString, Object).\nThe spelling of a parameter \"intputEncoding\" is wrong.\n\n--\npublic String parse (String inputTemplate, \n                     String intputEncoding,\n                     String outputFile,\n                     String outputEncoding,\n                     String objectID,\n                     Object object)\nthrows Exception\n{\n        if (objectID != null && object != null)\n        {\n            controlContext.put(objectID, object);\n        }            \n        \n        Template template = getTemplate(inputTemplate, inputEncoding != null ?\ninputEncoding : this.inputEncoding);\n\n&#65381;&#65381;&#65381;", "created_at" : { "$date" : "2004-12-21T12:47:52.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:06.845+0000" }, "creator_id" : { "$oid" : "5b7d37c6e9214a0d1608d798" }, "reporter_id" : { "$oid" : "5b7d37c6e9214a0d1608d798" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Texen" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e465f627d84c8d6c3c0" }, "external_id" : "VELOCITY-202", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unclear description of DataSourceResourceLoader", "desc" : "Section 12 of the Developer Guide states \"To build this loader, please \ndownload the J2EE distribution, move the j2ee.jar into the build/lib \ndirectory...\" \n\nThe J2EE distribution of what? The j2eesdk does not appear to include a \nj2ee.jar file, and I can find no J2EE distribution of Velocity in the download \ntree. Where does one download this jar file from? I need the database resource \nloader and my project is stalled until I can add this functionality.", "created_at" : { "$date" : "2003-09-04T06:41:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:06.230+0000" }, "creator_id" : { "$oid" : "5b7d37c7e9214a0d1608d799" }, "reporter_id" : { "$oid" : "5b7d37c7e9214a0d1608d799" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e465f627d84c8d6c3cc" }, "external_id" : "VELOCITY-58", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "init( {java.util.Properties} ) fails to set Velocity & VelocityEngine properties", "desc" : "On 1.2 and 1.3rc-1 in Tomcat4 using JDK1.4 in a servlet, trying to call \nVelocity.init and VelocityEngine.init with a Properties object as a parameter \ncauses the following symptom when getTemplate is called called:\n\norg.apache.velocity.exception.ResourceNotFoundException: Unable to find \nresource 'example.vm'\n\n\nAFAIK, in 1.2 this happens as VelocityEngine.init()\ncalls \nRuntimeInstance.init()\ncalls\nRuntimeInstance.initializeProperties()\nand fails to find any resourceloaders and generates NullPointerException. \nTemplate.getTemplate then can't find a resourceloader to load the template.\n\nHaven't follwed up with 1.3rc-1 as of yet.", "created_at" : { "$date" : "2002-03-31T11:13:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:06.057+0000" }, "creator_id" : { "$oid" : "5b7d37c8e9214a0d1608d79b" }, "reporter_id" : { "$oid" : "5b7d37c8e9214a0d1608d79b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e475f627d84c8d6c3e2" }, "external_id" : "VELOCITY-601", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e475f627d84c8d6c3e3" }, "external_id" : "VELOCITY-287", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "escapping when { used doesn't work", "desc" : "I am trying to escape\n\n\\${request.$var.name}\n\n$var.name is defined.\n\nThe system fails with then error:\nException in thread \"main\" org.apache.velocity.exception.ParseErrorException:\nEncountered \".\" at line 14, column 39.\nWas expecting one of:\n    \"}\" ...\n    <DOT> ...\n    \n\tat org.apache.velocity.Template.process(Template.java:141)\n\nwhere column 39 is . after the request\n\n\nThe desired result is:\n${result.xyz}\n\nwhere $var.name is set too xyz", "created_at" : { "$date" : "2004-07-31T23:19:20.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:07.044+0000" }, "creator_id" : { "$oid" : "5b7d37cce9214a0d1608d79e" }, "reporter_id" : { "$oid" : "5b7d37cce9214a0d1608d79e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e475f627d84c8d6c3e2" }, "effect" : "is cloned by", "type" : "Cloners" } ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e485f627d84c8d6c3f0" }, "external_id" : "VELOCITY-52", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ContentResource.process does not close the input stream", "desc" : "Seems to me that the author has forgotten finally{reader.close();} in \nContentResource.process(). 1.4 Nightly 22/03.", "created_at" : { "$date" : "2002-03-24T02:03:02.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:07.762+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e495f627d84c8d6c3f8" }, "external_id" : "VELOCITY-51", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Logical not operator works wrongly in #set", "desc" : "Logical not produces bad results in #set-s while it works fine in #if-s (!?).\nComments in the \nexample shows what 1.3 Nightly 22/03 will print. 1.2 Stable produces null-sets. (Note that \nbugzilla don't offer version 1.3-rc1.)\n\n  #set($x = !true)\n  $x ## true (wrong)\n  #set($y = \ntrue)\n  #set($x = !$y)\n  $x ## true (wrong)\n\n  #set($y = false)\n  #set($x = !false)\n  $x ## false \n(wrong)\n  #set($x = !$y)\n  $x ## false (wrong)\n\n  #set($x = !'foo')\n  $x ## false (good)\n  \n#set($y = 'foo')\n  #set($x = !$y)\n  $x ## true (wrong)\n\n  #set($x = !1)\n  $x ## false (good)\n  \n#set($y = 1)\n  #set($x = !$y)\n  $x ## true (wrong)\n\n(Please ingnore false line breaks inserted \nby bugzilla)", "created_at" : { "$date" : "2002-03-23T19:57:58.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:07.581+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e495f627d84c8d6c400" }, "external_id" : "VELOCITY-106", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "newline following #end unexpectedly stripped", "desc" : "newlines occuring after #end statements are being stripped by the parser (could\nthis be intentional?). I'm attaching the example template & result because it's\nlong lines end up wrapping around in this text box.", "created_at" : { "$date" : "2002-09-27T06:08:00.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:07.405+0000" }, "creator_id" : { "$oid" : "5b7d37d1e9214a0d1608d7a0" }, "reporter_id" : { "$oid" : "5b7d37d1e9214a0d1608d7a0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e4a5f627d84c8d6c40c" }, "external_id" : "VELOCITY-387", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Change legacy HashTable and Vector instances to Map and List (resourceloader)", "desc" : "From: Mailmur\norg\\apache\\velocity\\runtime\\resource\\loader\\FileResourceLoader.java\nThis class uses Vector and Hashtable instances to store cached paths values.\nShould this and other classes be converted to use ArrayList and HashMap\ninstances? I think ArrayList+Hashmap give better runtime performance.\n\nFrom: Will\nThanks for catching this.  Better yet, good modern practice would also be to\ndeclare the variables as List and Map. If you'd care to issue a bug report at\nhttp://issues.apache.org (use BugZilla until we switch to JIRA) this can get\ntracked.  If you're feeling ambitious, download svn, get the source and create a\npatch.  If \"ant test\" passes I'll commit it straight away.\n\nSlight offtopic, see enhancement: #21582\nIt uses hashmap and arraylist as an internal members.\n\nI (mailmur) could fix this, but first I must install Subversion client and study\ncreating a patch first. Never done both before. Will keep you posted.", "created_at" : { "$date" : "2005-06-30T14:50:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:08.570+0000" }, "creator_id" : { "$oid" : "5b7d35d8e9214a0d1608d6c5" }, "reporter_id" : { "$oid" : "5b7d35d8e9214a0d1608d6c5" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e4b5f627d84c8d6c41a" }, "external_id" : "VELOCITY-279", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[VelocityTools] tools/xdocs/view/velservlet.xml has wrong title", "desc" : "velservlet.xml has \"Velocity View For Struts\" as a title, but \nit should be \"VelocityServlet\" (or like one).", "created_at" : { "$date" : "2004-07-12T00:06:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:08.167+0000" }, "creator_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "reporter_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e4b5f627d84c8d6c421" }, "external_id" : "VELOCITY-289", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "unable to download source distribution (wrong url)", "desc" : "When I try to download the source distribution from\nhttp://jakarta.apache.org/site/sourceindex.cgi\n\nI always get the binary distribution \nhttp://apache.scarlet.be/jakarta/velocity/binaries/velocity-1.4/velocity-1.4.zip", "created_at" : { "$date" : "2004-08-23T15:49:16.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:08.352+0000" }, "creator_id" : { "$oid" : "5b7d37d4e9214a0d1608d7a1" }, "reporter_id" : { "$oid" : "5b7d37d4e9214a0d1608d7a1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e4c5f627d84c8d6c42b" }, "external_id" : "VELOCITY-130", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Class name Capitalization typo", "desc" : "In the category \"Existing Log4j Category\", under point 2, is \"Configure \nVelocity to use the SimpleLog4jLogSystem class\".  \n\nSimpleLog4jLogSystem should be SimpleLog4JLogSystem...\n\n(Notice the J in Log4J).\n\nWhen I copied pasted that into my configuration, it failed, and obviously \nfailed.", "created_at" : { "$date" : "2003-01-25T02:57:27.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:08.002+0000" }, "creator_id" : { "$oid" : "5b7d37d6e9214a0d1608d7a2" }, "reporter_id" : { "$oid" : "5b7d37d6e9214a0d1608d7a2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e4d5f627d84c8d6c433" }, "external_id" : "VELOCITY-99", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NullPointerException thrown when using == instead of = in #set directive", "desc" : "When using == instead of = inside a #set directive a NullPointerException is\nthrown.  For example,\n\n#set($dave == \"aCoolGuy\")\n\nwill cause an NPE to be thrown.  The syntax is obviously wrong, but Velocity\nshould give a helpful error message, or at least some kind of error message\nrather than throwing an NPE.\n\nThe relevant portion of the stack trace has been included below:\njava.lang.NullPointerException\n\tat\norg.apache.velocity.runtime.parser.node.ASTSetDirective.render(ASTSetDirective.java:135)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:271)\n\tat org.apache.velocity.app.VelocityEngine.evaluate(VelocityEngine.java:358)\n\tat org.apache.velocity.app.VelocityEngine.evaluate(VelocityEngine.java:252)", "created_at" : { "$date" : "2002-07-26T23:35:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:08.747+0000" }, "creator_id" : { "$oid" : "5b7d37dbe9214a0d1608d7a3" }, "reporter_id" : { "$oid" : "5b7d37dbe9214a0d1608d7a3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e4d5f627d84c8d6c43d" }, "external_id" : "VELOCITY-342", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Texen example does not work", "desc" : "The Texen example at\n   http://jakarta.apache.org/velocity/texen.html\ndoes not work.\n\nIn Control.vm, to create the output file name, $stringutils.concat\n([$planet, \".html\"]) is being used, but StringUtils is set to the Context \nas \"strings\".\n\nThe correct template shoud read:  $strings.concat([$planet, \".html\"])", "created_at" : { "$date" : "2005-01-23T21:27:52.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:09.407+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Texen" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e4e5f627d84c8d6c446" }, "external_id" : "VELOCITY-269", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Border not supported in region-body ?", "desc" : "I am not able to create borders for body, header or footer. Here is the code I \nam using.\n\n    <fo:simple-page-master master-name=\"first\" \n                           page-height=\"19.4cm\" \n                           page-width=\"27.1cm\" \n                           margin-top=\"0.5cm\" \n                           margin-bottom=\"0.5cm\" \n                           margin-left=\"0.5cm\" \n                           margin-right=\"0.5cm\">\n      <fo:region-body margin-top=\"1cm\" margin-bottom=\"1cm\" border=\"thin silver \nridge\"/>\n      <fo:region-before extent=\"1cm\" background-color=\"#FFFFFF\" border=\"thin \nsilver ridge\"/>\n      <fo:region-after extent=\"10mm\" background-color=\"#FFFFFF\" border=\"thin \nsilver ridge\"/>\n    </fo:simple-page-master>\n\nWhen I tried to add boder to the block, it WORKED !!! Is border for \nbody/header/footer not supported.", "created_at" : { "$date" : "2004-05-19T12:26:16.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:09.223+0000" }, "creator_id" : { "$oid" : "5b7d37dde9214a0d1608d7a4" }, "reporter_id" : { "$oid" : "5b7d37dde9214a0d1608d7a4" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e4f5f627d84c8d6c44e" }, "external_id" : "VELOCITY-249", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] fixed two mistakes in user-guide.xml", "desc" : "In \"Escaping VTL Directives\" section.", "created_at" : { "$date" : "2004-01-29T19:08:47.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:09.670+0000" }, "creator_id" : { "$oid" : "5b7d37dde9214a0d1608d7a5" }, "reporter_id" : { "$oid" : "5b7d37dde9214a0d1608d7a5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e4f5f627d84c8d6c459" }, "external_id" : "VELOCITY-35", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "error in parsing white space between #elseif and condition", "desc" : "the following statement produces an error:\n\n#if(!$class.primitive)item#elseif\n   ($class.name == \"char\")new Character(item)#end\n#end\n\n[Generator.main]org.apache.velocity.exception.ParseErrorException: Encountered\n\"\\r\\n\" at line 3, column 34.\nWas expecting one of:\n    \"(\" ...\n    <WHITESPACE> ...\n    \norg.apache.velocity.exception.ParseErrorException: Encountered \"\\r\\n\" at line 3,\ncolumn 34.\nWas expecting one of:\n    \"(\" ...\n    <WHITESPACE> ...\n\nI would assume \"\\r\\n\" is WHITESPACE", "created_at" : { "$date" : "2002-01-31T17:39:33.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:09.003+0000" }, "creator_id" : { "$oid" : "5b7d37dee9214a0d1608d7a6" }, "reporter_id" : { "$oid" : "5b7d37dee9214a0d1608d7a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e505f627d84c8d6c461" }, "external_id" : "VELOCITY-133", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity-Tools / StrutsUtil patch", "desc" : "Add method to return the name used for \"global\" errors.\n\n    /**\n     * Returns the default \"GLOBAL\" category name that can be used with\n     * messages that are not associated with a particular property.\n     */\n    static String getGlobalErrorName()\n    {\n        return org.apache.struts.action.ActionErrors.GLOBAL_ERROR;\n    }", "created_at" : { "$date" : "2003-02-04T08:10:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:09.871+0000" }, "creator_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "reporter_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e515f627d84c8d6c46e" }, "external_id" : "VELOCITY-312", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "inconsistency in #(template|resource)Exists() in Velocity and VelocityEngine", "desc" : "Velocity#templateExists(String) has been deprecated with the replacement of \n#resourceExists(String).  Why shouldn't VelocityEngine also do that?", "created_at" : { "$date" : "2004-11-08T15:44:04.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:10.550+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e515f627d84c8d6c478" }, "external_id" : "VELOCITY-344", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Some files have wrong line endings in the SVN repository.", "desc" : "Some files have wrong file endings in the SVN repository.\n\nSee here for details:\nhttp://mail-archives.apache.org/eyebrowse/ReadMsg?listName=velocity-\ndev@jakarta.apache.org&msgNo=11309", "created_at" : { "$date" : "2005-01-23T21:50:36.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:10.899+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e525f627d84c8d6c485" }, "external_id" : "VELOCITY-265", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "veltag is not included in the distribution as stated on the homepage", "desc" : "According to http://jakarta.apache.org/velocity/veltag.html veltag can be found\nin the distribution in the /contrib/temporary/veltag. Not so in release 1.4.\n\nI got hold of it by checking out velocity from CVS. Perhaps this should be\nrecommended on the page.", "created_at" : { "$date" : "2004-04-23T00:03:00.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:10.310+0000" }, "creator_id" : { "$oid" : "5b7d37e2e9214a0d1608d7a7" }, "reporter_id" : { "$oid" : "5b7d37e2e9214a0d1608d7a7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e535f627d84c8d6c48f" }, "external_id" : "VELOCITY-49", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Assignment operator in #if condition results in false", "desc" : "The code bellow will print No always. IMO it should be a parse error, especially as it is a frequent \nmistake to accidentally exchage == and =. (Or should print Yes because x = z as an expression is \ntraditionally z, but then the assigment should be done which is not a good idea.)\n\n  #if($foo = \n'xxx') Yes #else No #end\n\nTried with 1.2 Stable and 1.3 Nightly 22/03", "created_at" : { "$date" : "2002-03-23T17:33:15.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:10.726+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e535f627d84c8d6c49a" }, "external_id" : "VELOCITY-161", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Object reference remains in SimplePool after sucessful get()", "desc" : "When using get() to checkout an object from the \norg.apache.velocity.util.SimplePool, the reference remains in the SimplePool \nand will only get released if the pool grows again to the peak level. The get\n() operation could be easily modified to place a null value in the object \narray location where the pooled item was removed so that if the object is not \nreturned to the pool (for whatever reason including exceptions), the reference \nto the object does not remain in the pool until replaced in the stack-based \ndesign of the SimplePool. It's just good pool management for a reusable class. \n\nThis became obvious when exceptions occured with the VelocityServlet \nmergeTemplate() and objects were not returned to the pool. Memory profiling \nshowed references to VelocityWriter objects in the pool that were not released \nuntil activity increased to replace the reference in the SimplePool object \narray (and the memory could then be reclaimed).", "created_at" : { "$date" : "2003-04-16T02:00:57.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:10.129+0000" }, "creator_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "reporter_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e545f627d84c8d6c4a6" }, "external_id" : "VELOCITY-27", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "html documentation not printable (witdth too large)", "desc" : "Unfortunately, the html documentation, e.g. the developer's guide, is not \nprintable in a proper way: Because of the HTML-formatting the width of the page \nis too large and the borders are cut off, with both Netscape and \nInternetExplorer, and even with font size decreased to the minimum.", "created_at" : { "$date" : "2001-11-07T14:02:36.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:11.353+0000" }, "creator_id" : { "$oid" : "5b7d37e5e9214a0d1608d7a8" }, "reporter_id" : { "$oid" : "5b7d37e5e9214a0d1608d7a8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e555f627d84c8d6c4b8" }, "external_id" : "VELOCITY-112", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Exception while running the Velocity code", "desc" : "I downloaded the build source for Velocity version 1.3-rc1. Imported and ran \nthe sorce in IBM Visual age for Java \n\nHere is the sample code i tried to run............\n\ntry{\n\t\tVelocityEngine ve = new VelocityEngine();\n\t \tve.init(); \n\n\t\t/*  next, get the Template  */\n\n\t\tTemplate t = ve.getTemplate(\"C:\\\\helloworld.vm\");\n\n\t\t/*  create a context and add data */\n\n\t\tVelocityContext context = new VelocityContext();\n\n\t\tcontext.put(\"name\", \"World\");\n\n\t\t/* now render the template into a StringWriter */\n\n\t\tStringWriter writer = new StringWriter();\n\n\t\tt.merge( context, writer );\n\t\t/* show the World */\n\t\treturn ( writer.toString() );\n\t}\n\tcatch (Exception e){\n\t\tSystem.out.println(\"Got a error\" + e.toString());\n\t\treturn (\"the error was found\");\n\t}\n\n\n\nIt returned a \"org.apache.velocity.ResourceNotFoundException\". \n\nCan u tell me  way to get around the problem.", "created_at" : { "$date" : "2002-10-24T19:27:30.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:11.533+0000" }, "creator_id" : { "$oid" : "5b7d37e7e9214a0d1608d7aa" }, "reporter_id" : { "$oid" : "5b7d37e7e9214a0d1608d7aa" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e565f627d84c8d6c4c1" }, "external_id" : "VELOCITY-110", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Runtime Compile Error", "desc" : "I downloaded the build source for Velocity version 1.3-rc1. Imported and ran \nthe sorce in IBM Visual age for Java (only .class files ofcourse). Here is the \nsimple program that i wrote for initial testing of the velocity Engine:\n\npublic String doSomething() {\n\t\n\ttry{\n\t\tVelocityEngine ve = new VelocityEngine();\n\t \tve.init(); \n\n\t\tTemplate t = ve.getTemplate( \"helloworld.vm\" );\n\t\tVelocityContext context = new VelocityContext();\n\t\tcontext.put(\"name\", \"World\");\n\t\tStringWriter writer = new StringWriter();\n\t\tt.merge( context, writer );\n\t\treturn ( writer.toString() );\n\t}\n\tcatch (Exception e){\n\t\tSystem.out.println(\"Got a error\" + e.toString());\n\t\treturn (\"the error was found\");\n\t}\n}\n\n\nDuring runtime got the error:\njava.lang.NoSuchFieldError.\n\nThe error was thrown on the line where i call the constructor;\nVelocityEngine ve = new VelocityEngine();\n\n\nPlease do advise as to what should i do to get the VElocity Engine up and \nrunning ?????", "created_at" : { "$date" : "2002-10-23T18:37:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:11.161+0000" }, "creator_id" : { "$oid" : "5b7d37e7e9214a0d1608d7aa" }, "reporter_id" : { "$oid" : "5b7d37e7e9214a0d1608d7aa" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e565f627d84c8d6c4ca" }, "external_id" : "VELOCITY-310", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Exceptions thrown during Servlet template merging", "desc" : "My servlet extends VelocityServlet and returns a valid template reference in \nthe handler. The template references a method which does some DB access. If I \nturn off the DB and run the app, I have two issues:\n\n1/ I don't get the exception. I can work around this by providing my own error\n() handler to deal with it, work out whether the exception has been logged etc \nand return some error HTML. Messy but hey, Velocity is free.\n\n2/ Oh dear. It seems the template merging flushes out what it has processed so \nfar before re-throwing the exception. I dont want this. If an error occurs \nduring parsing, I want the user to see an error message, not half a template !!\n\nHope I haven't missed anything obvious, but how do I do this ?\n\nNOTE\nI quite like Velocity and managed to integrate my own Logger (although it would \nhave been easier if the authors had used the Apache commons Logging stuff). \nThis is better than FreeMarker.", "created_at" : { "$date" : "2004-11-03T07:11:00.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:12.610+0000" }, "creator_id" : { "$oid" : "5b7d37e8e9214a0d1608d7ab" }, "reporter_id" : { "$oid" : "5b7d37e8e9214a0d1608d7ab" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e575f627d84c8d6c4d2" }, "external_id" : "VELOCITY-243", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No call to test case IntrospectorTestCase3.java", "desc" : "Happened to notice that the test case \"IntrospectorTestCase3.java\" is never \nchecked with ant test.\n\nInserting this should solve it.  (also adding test-introspect3 to the test \ntarget). And yes, the test works with CVS head.\n\n  <target name=\"test-introspect3\">\n    <echo message=\"Running Introspector3 tests...\"/>\n    <java classname=\"${velocity.test.runner}\" fork=\"yes\" \nfailonerror=\"${testbed.failonerror}\">\n      <arg value=\"org.apache.velocity.test.IntrospectorTestCase3\"/>\n      <classpath>\n        <path refid=\"classpath\"/>\n      </classpath>\n    </java>\n  </target>", "created_at" : { "$date" : "2004-01-05T04:24:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:12.996+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e595f627d84c8d6c4f4" }, "external_id" : "VELOCITY-246", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Broken link to MessageTool doc in Tools Index", "desc" : "http://jakarta.apache.org/velocity/tools/index.html\n\n\"Look at the Struts __MessageTool__ for a good example of the new documentation\nformat.\"\n\nLink there goes to a 404. \nhttp://jakarta.apache.org/velocity/struts/MessageTool.html\n\nCorrect link might be:\nhttp://jakarta.apache.org/velocity/tools/struts/MessageTool.html", "created_at" : { "$date" : "2004-01-07T01:21:41.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:12.033+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e5a5f627d84c8d6c509" }, "external_id" : "VELOCITY-343", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Link to nightly snapshots.", "desc" : "Restart nightly snapshots.\n\nSee here for details:\nhttp://mail-archives.apache.org/eyebrowse/BrowseList?listName=velocity-\ndev@jakarta.apache.org&by=thread&from=945779", "created_at" : { "$date" : "2005-01-23T21:46:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:13.394+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e5b5f627d84c8d6c515" }, "external_id" : "VELOCITY-65", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Iterator warnings sometimes inappropriate", "desc" : "There are a lot of warnings about Iterators in #foreach directives.  But \nsometimes the warnings don't apply.  Isn't it safe if you just do:\n\n#foreach($foo in $listOfFoos.elements())\n...\n#end\n\nI think the only time a warning should be generated is if you #set a variable \nto an iterator or if you pass the Iterator to a method. (any others?)", "created_at" : { "$date" : "2002-04-12T00:43:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:13.785+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e5c5f627d84c8d6c51e" }, "external_id" : "VELOCITY-20", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Loosen requirements on variable names with formal names", "desc" : "The current syntax only allows letters, numbers, dash, and underscore. I would \nlike to use . as a separator and would like to allow + as well. I understand \nhow this would be a problem using the normal notation, because you may want \nthe . to indicate a field of the object. But there should be no problem if the \nvariable name is specifed using the formal notation. I propose allowing more \ncharacters in a variable name when using formal notation. So I could have \nthings like:\n\nclass ${c++.class.name}", "created_at" : { "$date" : "2001-10-21T23:02:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:13.204+0000" }, "creator_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "reporter_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e5c5f627d84c8d6c52a" }, "external_id" : "VELOCITY-175", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#macro name is displayed in the browser.", "desc" : "Hi,\nI was wandering if someone has reported this problem.\nThis error occurs when stress-testing applications developed with Velocity.\nWhen I test with around 25 browser instances (or more) often I get:\n#menuitem#menuitem  (menuitem is the name of the macro) being displayed in the \nrendered page instead of the macro being executed.\n\nThe macro is:\n=============================================================\n#macro (menuItem $action $url $description)\n\n      #if($action==-1)\n        #set($actionOK=true)\n      #else\n        #if($debtorAccount)\n          #set($actionOK=$accessControl.canPerformAction($action, $user, \n$clientAccount, $debtorAccount))\n        #else\n          #if($clientAccount)\n            #set($actionOK=$accessControl.canPerformAction($action, $user, \n$clientAccount))\n          #else\n            #set($actionOK=$accessControl.canPerformAction($action, $user ))\n          #end\n        #end\n      #end\n=============================================================\nI call this macro to build a menu page. The macro would call a method on an \nobject (stored on a \u0093session\u0094 level using AbstractContext). The macro is called \nlike this:\n#menuItem(-1 \"./signOff\" $lClientMenu_LogOffLit)\n\nCould you please suggest any fixes or workaround?\n\nThank you in advance,\nPlamen Koychev\nSoftware Developer", "created_at" : { "$date" : "2003-04-29T17:14:43.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:13.968+0000" }, "creator_id" : { "$oid" : "5b7d37f0e9214a0d1608d7ae" }, "reporter_id" : { "$oid" : "5b7d37f0e9214a0d1608d7ae" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e5d5f627d84c8d6c533" }, "external_id" : "VELOCITY-118", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "java.util.Enumeration  not supported", "desc" : "Interfaces:\npublic class StringTokenizer extends Object implements Enumeration\n\nController:\nctx.put(\"enum\", new java.util.StringTokenizer(\"A B C\"));\n\nTemplate:\n<HTML>\n<BODY>\n#foreach ($item in enum)\n<P>$item\n#end\n</BODY>\n</HTML>\n\nResult:\n<HTML>\n<BODY>\n</BODY>\n</HTML>", "created_at" : { "$date" : "2002-12-10T20:36:05.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:13.589+0000" }, "creator_id" : { "$oid" : "5b7d37f1e9214a0d1608d7af" }, "reporter_id" : { "$oid" : "5b7d37f1e9214a0d1608d7af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e5d5f627d84c8d6c53a" }, "external_id" : "VELOCITY-303", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No link to Wiki page.", "desc" : "This is no link to the Wiki page in the Velocity documentation.\nThe documentation:\n  http://jakarta.apache.org/velocity/\nThe Wiki page:\n  http://wiki.apache.org/jakarta-velocity/", "created_at" : { "$date" : "2004-10-14T14:24:04.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:14.820+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e5e5f627d84c8d6c544" }, "external_id" : "VELOCITY-53", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong comment in ResourceManagerImpl.java", "desc" : "In ResourceManagerImpl.java and ResourceManager.java the javadoc comment of \ninitialize():\n\"assembleSourceInitializers\" should be \n\"assembleResourceLoaderInitializers\". And perhaps it is not required to call it (but it's OK to \ncall it anyway) as initialize calls it automatically.", "created_at" : { "$date" : "2002-03-24T02:08:48.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:14.380+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e5f5f627d84c8d6c54b" }, "external_id" : "VELOCITY-57", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parser.DirectiveArg dies on integer literal vm parameters", "desc" : "The template below will die with java.lang.Error \"Missing return statement in function\" at \norg.apache.velocity.runtime.parser.Parser.DirectiveArg(Parser.java:575):\n\n#macro(x \n$a)\n[$a]\n#end\n\n#x(1)\n\nWill not die if you replace the last line with \n#x('foo').\n\nTried with 1.4 nightly 25/03/2002", "created_at" : { "$date" : "2002-03-26T06:32:19.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:14.168+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e5f5f627d84c8d6c553" }, "external_id" : "VELOCITY-188", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "AnakiaTask does not store templatePath if props file found.", "desc" : "The Javadoc for templatePath says that it overrides the setting in the \nvelocity.properties file. The anakia.html file says the same in the \"How does \nit work section\"\n\nHowever, the value of the templatePath is only stored in the velocity \nproperties if the velocity.properties file has *not* been found, so rather \nthan overriding the value in velocity.properties, it is the other way round - \ntemplatePath is over-ridden by velocity.properties.", "created_at" : { "$date" : "2003-06-30T05:20:19.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:14.577+0000" }, "creator_id" : { "$oid" : "5b7d37f4e9214a0d1608d7b0" }, "reporter_id" : { "$oid" : "5b7d37f4e9214a0d1608d7b0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e605f627d84c8d6c562" }, "external_id" : "VELOCITY-34", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "StringUtils chop function crashes if string too short.", "desc" : "The chop function in org.apache.velocity.util.StringUtils.java, crashes (throws \nArrayOutOfBoundsException) when passed a string of length 1 (where EOL length \nis 2). The test for EOL should include a check that the string is long enough \nto check for the EOL.", "created_at" : { "$date" : "2002-01-18T13:45:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:15.885+0000" }, "creator_id" : { "$oid" : "5b7d37f5e9214a0d1608d7b1" }, "reporter_id" : { "$oid" : "5b7d37f5e9214a0d1608d7b1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e615f627d84c8d6c56b" }, "external_id" : "VELOCITY-32", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "com/werken/xpath/XPath not found", "desc" : "test-anakia:\n     [echo] Running Anakia tests...\n   [anakia] Transforming into: /usr/local/jakarta/velocity-1.2/test/anakia/\nresults\n   [anakia] Input:  index.xml\n   [anakia] org.apache.velocity.exception.MethodInvocationException: \nInvocation of method 'applyTo' in  class \norg.apache.velocity.anakia.XPathTool threw exception class \njava.lang.NoClassDefFoundError : com/werken/xpath/XPath\n   [anakia]     at java.lang.Throwable.<init>(Throwable.java:96)\n   [anakia]     at java.lang.Exception.<init>(Exception.java:44)\n   [anakia]     at org.apache.velocity.exception.VelocityException.<init>\n(VelocityException.java:68)\n   [anakia]     at org.apache.velocity.exception.MethodInvocationException.<\ninit>(MethodInvocationException.java:84)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.ASTMethod.execute(ASTMethod.j\nava:308)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.ASTReference.execute(ASTRefer\nence.java:202)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.ASTReference.value(ASTRefere\nnce.java:345)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.ASTSetDirective.render(ASTSetD\nirective.java:135)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNod\ne.java:271)\n   [anakia]     at \norg.apache.velocity.runtime.directive.VelocimacroProxy.render(Velocimacr\noProxy.java:215)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirectiv\ne.java:153)\n   [anakia]     at \norg.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNod\ne.java:271)\n   [anakia]     at org.apache.velocity.Template.merge(Template.java:296)\n   [anakia]     at \norg.apache.velocity.anakia.AnakiaTask.process(AnakiaTask.java:408)\n   [anakia]     at \norg.apache.velocity.anakia.AnakiaTask.execute(AnakiaTask.java:333)\n   [anakia]     at \norg.apache.tools.ant.UnknownElement.execute(UnknownElement.java:10\n4)\n   [anakia]     at org.apache.tools.ant.Task.perform(Task.java:217)\n   [anakia]     at org.apache.tools.ant.Target.execute(Target.java:184)\n   [anakia]     at org.apache.tools.ant.Target.performTasks(Target.java:202)\n   [anakia]     at \norg.apache.tools.ant.Project.executeTarget(Project.java:601)\n   [anakia]     at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:266)\n   [anakia]     at org.apache.tools.ant.Task.perform(Task.java:217)\n   [anakia]     at org.apache.tools.ant.Target.execute(Target.java:184)\n   [anakia]     at org.apache.tools.ant.Target.performTasks(Target.java:202)\n   [anakia]     at \norg.apache.tools.ant.Project.executeTarget(Project.java:601)\n   [anakia]     at \norg.apache.tools.ant.Project.executeTargets(Project.java:560)\n   [anakia]     at org.apache.tools.ant.Main.runBuild(Main.java:454)\n   [anakia]     at org.apache.tools.ant.Main.start(Main.java:153)\n   [anakia]     at org.apache.tools.ant.Main.main(Main.java:176)\n     [java] .Passed!\n     [java] \n     [java] Time: 0.028\n     [java] \n     [java] OK (1 tests)\n     [java]", "created_at" : { "$date" : "2002-01-14T21:04:30.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:15.030+0000" }, "creator_id" : { "$oid" : "5b7d3756e9214a0d1608d761" }, "reporter_id" : { "$oid" : "5b7d3756e9214a0d1608d761" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e615f627d84c8d6c577" }, "external_id" : "VELOCITY-319", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Website JavaDoc goes to 1.3.1 instead of 1.4", "desc" : "The \"JavaDoc\" link under \"Docs\" on the left side of the Velocity homepage points\nto the documentation for Velocity 1.3.1 instead of Velocity 1.4.  I downloaded\nthe binary distribution of 1.4 and the documentation is the correct version in\nthe distribution.  It looks like the website just needs to be updated.", "created_at" : { "$date" : "2004-11-20T03:11:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:16.559+0000" }, "creator_id" : { "$oid" : "5b7d37f7e9214a0d1608d7b2" }, "reporter_id" : { "$oid" : "5b7d37f7e9214a0d1608d7b2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e625f627d84c8d6c581" }, "external_id" : "VELOCITY-178", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "res.setContentType(application/vnd.ms-excel)", "desc" : "Velocity servlet is not recoganizing the res.setContentType(application/vnd.ms-\nexcel) to open excel files.", "created_at" : { "$date" : "2003-05-06T10:42:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:16.732+0000" }, "creator_id" : { "$oid" : "5b7d37f7e9214a0d1608d7b3" }, "reporter_id" : { "$oid" : "5b7d37f7e9214a0d1608d7b3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904e635f627d84c8d6c58a" }, "external_id" : "VELOCITY-38", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problems with recursive macro calling when using #set with \"\" (doublequotes)", "desc" : "Because of use of #set statements of this kind:\n#set($test = \"blah blah $value\")\nmacros are not being called.\nIt looks like they were not defined.\nOutput looks like this:\n#testMacro", "created_at" : { "$date" : "2002-02-19T23:59:16.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:16.104+0000" }, "creator_id" : { "$oid" : "5b7d37f8e9214a0d1608d7b4" }, "reporter_id" : { "$oid" : "5b7d37f8e9214a0d1608d7b4" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e635f627d84c8d6c596" }, "external_id" : "VELOCITY-9", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't print the Velocity manuals", "desc" : "The Velocity User's manual at http://jakarta.apache.org/velocity/user-\nguide.html and the Developer manual at \nhttp://jakarta.apache.org/velocity/developer-guide.html (and possibly other \ndocuments) are very non printer friendly and are virtually impossible to print \n(at least with my configuration: IE 5, Windows NT4,  and HP laser 6L).\n\n\nThere are two problems:\n\n1. The left margin that is used for the table of content is very wide and\nis wasted on most of the pages. \n\n2. (More important) the body text is in a fixed width table that is wider than \nthe page width. This results in a significant portion of each line not showing \non the printed page.\n\nPlease have a printer friendly version of the documents.\n\nThanks,\n\nTal", "created_at" : { "$date" : "2001-07-09T00:09:56.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:16.308+0000" }, "creator_id" : { "$oid" : "5b7d37f9e9214a0d1608d7b5" }, "reporter_id" : { "$oid" : "5b7d37f9e9214a0d1608d7b5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e645f627d84c8d6c59e" }, "external_id" : "VELOCITY-258", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "TexenTask needs license update", "desc" : "Hi,\n\nWhile randomly browing the source tree, I noticed that the following file had \nthe old Apache license.\n\norg.apache.velocity.texen.ant.TexenTask\n\nWILL", "created_at" : { "$date" : "2004-04-13T08:41:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:17.785+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e655f627d84c8d6c5a7" }, "external_id" : "VELOCITY-59", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Behaviour calling a method in the .vm where the method expects a float", "desc" : "The menthod in an object, lets call it TObject, in the context is defined:\n\n    public void setSize( float size );\n\nin the .vm, the code:\n\n    #set( $size = 99 )\n    $TObject.setSize( $size )\n\nwill produce this output from mergeTemplate:\n\n    $TObject.setSize( $size )\n\nrather than set the property. However if you define the method thus:\n\n    public void setSize( int size );\n\nall work well, setting the property rather than outputing the text of the call.\n\nThanks!", "created_at" : { "$date" : "2002-04-02T06:55:13.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:17.610+0000" }, "creator_id" : { "$oid" : "5b7d37c8e9214a0d1608d79b" }, "reporter_id" : { "$oid" : "5b7d37c8e9214a0d1608d79b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e655f627d84c8d6c5b2" }, "external_id" : "VELOCITY-218", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#stop in conditions is not working", "desc" : "Hello, I think, that this should work, but velocity throws parse error.\n\n#if(1 == 1)\n  #stop\n#end\n\nI think, that the problem is in #stop statement, that velocity doesn't recognize it.", "created_at" : { "$date" : "2003-10-29T03:19:55.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:18.005+0000" }, "creator_id" : { "$oid" : "5b7d37fce9214a0d1608d7b6" }, "reporter_id" : { "$oid" : "5b7d37fce9214a0d1608d7b6" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e665f627d84c8d6c5c8" }, "external_id" : "VELOCITY-124", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocity.properties file no longer exists", "desc" : "I got jakarta-site2 and it appears that the documentation as per the above URL\nis out of date: The file you mention no longer exists?", "created_at" : { "$date" : "2003-01-10T17:41:36.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:18.211+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e675f627d84c8d6c5d0" }, "external_id" : "VELOCITY-356", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "AnakiaJDOMFactory is extended illegal class", "desc" : "I can't use AnakiaJDOMFactory.\n\nIf I write 'JDOMFactory factory = new AnakiaJDOMFactory();', Eclipse say Problems.\nThe description is 'The type org.jdom.input.DefaultJDOMFactory cannot be\nresolved. It is indirectly referenced from required .class files'.\n\nI found the problem that AnakiaJDOMFactory is extended illegal class -\norg.jdom.input.DefaultJDOMFactory.\nThe package of DefaultJDOMFactory of JDOM 1.0 is not org.jdom.input but org.jdom.\n\nPerhaps, I think that it can compile AnakiaJDOMFactory with the problem since\nthe jar file of old JDOM is in your environment to find DefaultJDOMFactory from\nthe old jar. \nI temporarily make the following classes and have evaded this problem. \n\npackage org.jdom.input;\npublic class DefaultJDOMFactory extends org.jdom.DefaultJDOMFactory {\n}\n\nI wishe that this problem be corrected early.", "created_at" : { "$date" : "2005-02-18T11:51:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:19.876+0000" }, "creator_id" : { "$oid" : "5b7d37fde9214a0d1608d7b7" }, "reporter_id" : { "$oid" : "5b7d37fde9214a0d1608d7b7" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e675f627d84c8d6c5d8" }, "external_id" : "VELOCITY-42", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "REALLY REALLY small typo", "desc" : "In sample.vm, width is misspelled as widht for table.", "created_at" : { "$date" : "2002-03-09T06:18:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:19.448+0000" }, "creator_id" : { "$oid" : "5b7d37fee9214a0d1608d7b8" }, "reporter_id" : { "$oid" : "5b7d37fee9214a0d1608d7b8" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e685f627d84c8d6c5e0" }, "external_id" : "VELOCITY-67", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "continue", "desc" : " ", "created_at" : { "$date" : "2002-04-18T22:14:29.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:19.227+0000" }, "creator_id" : { "$oid" : "5b7d37ffe9214a0d1608d7b9" }, "reporter_id" : { "$oid" : "5b7d37ffe9214a0d1608d7b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e685f627d84c8d6c5e8" }, "external_id" : "VELOCITY-21", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Why is Context orthogonal to the Collections API", "desc" : "I have a set of mappings that I loaded into a java.util.Properties object that \nI need to use in my template rendering. For some reason you have this Context \ninterface which is little more than a renamed java.util.Map. Why do you have \nyour own separate implementations for what should just be standard collections \nclasses? In order to make those properties available, I end up having to create \na context and copy the settings from the Properties object one, by, one. Why \nnot just use Map instead of Context?", "created_at" : { "$date" : "2001-10-21T23:06:07.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:19.695+0000" }, "creator_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "reporter_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e695f627d84c8d6c5fa" }, "external_id" : "VELOCITY-54", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Comparsion operators don't work in #set-s", "desc" : "Comparsion operators don't work in #set-s, but work in #if-s (!?).\nEg. the following #set-s will be \n\"null set\"-s. They should set variables to true. Or it should be a parse error.\n  #set($x = (3 == \n3))\n  #set($y = (1 < 2))\n\n(Please ignore possible false linebreaks...)", "created_at" : { "$date" : "2002-03-24T02:12:07.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:27.825+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e6a5f627d84c8d6c604" }, "external_id" : "VELOCITY-55", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Improving the Velocity Context interface", "desc" : "Let me start by saying that I think Velocity is a great product that nearly \nevery application can use.  I've written a framework similar to Velocity, and \nhave been using it for some time now.  I'm glad to see there are so many \nsimilarities - it really reinforces that what I'm doing might actually be \nacceptable by the open-source community.  Maybe what I have learned while \ndeveloping and implementing my template engine might offer something to your \ninitiative.  At any rate, here goes...\n\nRemoving the put, remove, and getKeys methods from the Context interface will \nmake it easier to implement, while limiting the responsibility of the Context \nto the absolute minimum.  There's no sense in forcing a Context to provide \nmutator methods when it might not need (or want) to.  I suggest putting that \nfunctionality in a more specialized implementation of Context.  Can't the \ntemplate merge a context with itself using only the get and containsKey methods?\n\nThanks for listening - I hope this is useful in some way.  If possible, please \nlet me know what you think.\n\nBest Regards,\nMatt Nicolls", "created_at" : { "$date" : "2002-03-26T02:35:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:28.199+0000" }, "creator_id" : { "$oid" : "5b7d3748e9214a0d1608d758" }, "reporter_id" : { "$oid" : "5b7d3748e9214a0d1608d758" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e6a5f627d84c8d6c60b" }, "external_id" : "VELOCITY-31", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity should provide an interface for explicit property retreival", "desc" : "I think that there should be an interface with a method of something like\n\nObject \ngetVelocityProperty(String key);\n\nthat will provide for a way to manually determine what \nobject to retrieve with a given property name. Currently, there is no good way to access hashtable-\nlike structures without resorting to what essentially amounts to putting java code into the \ntemplate. (i.e. \"$hash.get($key)\")...\n\nVelocity should allow developers to implement an \ninterface to get more control of velocity engine rendering, so that when the template calls for \n$obj.property, a check is made to see if an object is an instance of that interface. If not, the \nstandard algorithm should be used to determine if this object has a getProperty() method. But if \nthe object does implement the interface, Velocity would call \ngetVelocityProperty(\"property\") on it, and it would be up to the programmer to provide proper \nlogic to return the property. (in a Hashtable wrapper, the method would contain one line: \n\n\nreturn hash.get(key);\n\nThis will not only give the programmer more control and force \nthem to pur less Java code into the template, but would also enable the developer to optimize the \nmost frequently accessed types of objects for performance as it will reduce the need to perform \nreflection lookups.", "created_at" : { "$date" : "2001-12-07T17:24:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:28.624+0000" }, "creator_id" : { "$oid" : "5b7d3806e9214a0d1608d7ba" }, "reporter_id" : { "$oid" : "5b7d3806e9214a0d1608d7ba" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e6b5f627d84c8d6c613" }, "external_id" : "VELOCITY-19", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "SimpleNode setFirstToken() has obvious typo", "desc" : "./src/java/org/apache/velocity/runtime/parser/node/SimpleNode.java\nLine 105-108:\n\n    public void setFirstToken(Token t)\n    {\n        this.first = first;\n    }\n\nShould read: this.first = t;\n\nI have no idea if this affects anything.", "created_at" : { "$date" : "2001-10-18T05:13:38.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:28.415+0000" }, "creator_id" : { "$oid" : "5b7d3807e9214a0d1608d7bb" }, "reporter_id" : { "$oid" : "5b7d3807e9214a0d1608d7bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e6b5f627d84c8d6c61d" }, "external_id" : "VELOCITY-128", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocity should have a \"clearAllReferences\"", "desc" : "velocity should have a \"clearAllReferences\" option to eliminate unreplaced \ntemplate references.\ne.g. \nVelocityEngine ve = new VelocityEngine();\nString templateString = \"$a$b\";\nve.setProperty( \"clearAllReferences\", \"true\"); //<==new request\nVelocityContext context = new VelocityContext();\ncontext.put(\"a\", \"A\");\nve.evaluate( context, writer, \"mystring\", templateString );\n//writer == \"A\", note $b disappears.\n//if we want $b not to disappear, either \"clearAllReferences\" to \"false\", or \n//use templateString = \"$a$$b\";", "created_at" : { "$date" : "2003-01-19T23:27:21.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:28.034+0000" }, "creator_id" : { "$oid" : "5b7d3808e9214a0d1608d7bc" }, "reporter_id" : { "$oid" : "5b7d3808e9214a0d1608d7bc" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e6c5f627d84c8d6c626" }, "external_id" : "VELOCITY-111", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Macro names can't start with 'set'", "desc" : "I created a velocity macro called setDAOFromPrimitive and called it from a .vm \ntemplate file.\n\n----------\n#macro ( setDAOFromPrimitive $vmdao $vmcol $vmprim )\n  ## ...\n#end\n\n## ...\n\n#setDAOFromPrimitive (\"m_dao\" $col $ptype)\n--------\n\nParsing the template using velocity generates the following error:\n\n---\n2002-10-23 17:45:00,684 - ResourceManager.getResource() parse exception: \norg.apache.velocity.exception.ParseErrorException: \nEncountered \"DAOFromPrimitive\" at line 205, column 11.\nWas expecting one of:\n    \"(\" ...\n    <WHITESPACE> ...\n---\n\nIt seems velocity treats any instance of \"#set\" as a property assignment, even \nif the name contains more characters. The workaround is to change the macro \nname.\n\nBTW I'm using the velocity-1.3.jar that ships with torque-3.0-b4.", "created_at" : { "$date" : "2002-10-24T05:00:28.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:28.802+0000" }, "creator_id" : { "$oid" : "5b7d3809e9214a0d1608d7bd" }, "reporter_id" : { "$oid" : "5b7d3809e9214a0d1608d7bd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e6d5f627d84c8d6c62e" }, "external_id" : "VELOCITY-339", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't controll the output flushing.", "desc" : "It seems that When applying a template the output is buffered before it is \ndirected to the given writer. That can be a problem if the output is very big \nand should be directed to a file.\nHere is a program to demonstrate the problem:\n\nimport java.io.*;\n\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.Template;\nimport org.apache.velocity.app.Velocity;\nimport org.apache.velocity.exception.ResourceNotFoundException;\nimport org.apache.velocity.exception.ParseErrorException;\nimport org.apache.velocity.exception.MethodInvocationException;\n\npublic class Test\n{\n\tpublic static void main(String st[]) throws Exception\n\t{\n\t\tObj[] objArray = new Obj[50];\n\t\tfor (int i = 0; i < 50; i++)\n\t\t\tobjArray[i] = new Obj(\"name_\" + i);\n\n\t\tVelocity.init();\n\t\tVelocityContext context = new VelocityContext();\n\t\tcontext.put( \"objArray\", java.util.Arrays.asList(objArray) );\n\t\t//Template template = Velocity.getTemplate(\"test.vtl\");\n\t\t//PrintWriter sw = new PrintWriter(new FileWriter\n(\"output.txt\"));\n\t\t//org.apache.velocity.io.VelocityWriter sw = new \norg.apache.velocity.io.VelocityWriter(new OutputStreamWriter(System.out), 10, \ntrue);\n\t\t//template.merge( context, sw );\n\n\t\tString myStr = \"<html>\\n\" + \n\t\t\t\t\t\t\"<body>\\n\" + \n\t\t\t\t\t\t\"#foreach( $key in $objArray )\n\\n\" + \n\t\t\t\t\t\t\"    <li>$key.name</li>\\n\" + \n\t\t\t\t\t\t\"#end\\n\" + \n\t\t\t\t\t\t\"</body>\\n\" + \n\t\t\t\t\t\t\"</html>\\n\";\n\t\tWriter w = new PrintWriter(new OutputStreamWriter(System.out), \ntrue);\n\t\tVelocity.evaluate(context, w, \"my-log-tag\", myStr);\n\t\tw.flush();\n\t\t//sw.close();\n\t}\n}", "created_at" : { "$date" : "2005-01-20T00:32:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:29.063+0000" }, "creator_id" : { "$oid" : "5b7d380ae9214a0d1608d7bf" }, "reporter_id" : { "$oid" : "5b7d380ae9214a0d1608d7bf" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e6d5f627d84c8d6c637" }, "external_id" : "VELOCITY-36", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Minor typo in documentation (\"Velocimacros\" section)", "desc" : "File: user-guide.xml [version 1.59, Last Updated Thu Jan 10 19:33:34 2002]\nSection: Velocimacros -- Velocimacro Properties\n\nTypo: \"Node that these are also...\"\nFix:  \"Note that these are also...\"\n\nThanks,\nKevin Hammond", "created_at" : { "$date" : "2002-02-19T03:24:38.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:29.868+0000" }, "creator_id" : { "$oid" : "5b7d3777e9214a0d1608d775" }, "reporter_id" : { "$oid" : "5b7d3777e9214a0d1608d775" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e6e5f627d84c8d6c63f" }, "external_id" : "VELOCITY-228", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "floating point number capability", "desc" : "This patch adds floating point capability to VTL.  It's based on code mainly \nwritten by Peter Romianowski with a supporting role from myself.  I'm putting \nthis in Bugzilla as much of this code was shared over the mailing lists in \nfragments this summer and is difficult to access.  This issue can serve \ninstead as a repository for the latest pre-CVS committed version.\n\nIncluded is the following:\n-- ability to enter literal numbers in the form of integers or floating point \nnumbers\n-- all math and comparison functions work with floating point numbers\n-- arbitrary objects that implement the interface TemplateNumber are treated \nas numbers in arithmetic or comparison\n-- method calls with numbers, as shown in TestNumberMethodCalls.java\n\nKnown Issues:\n-- an object implementing TemplateNumber cannot be used as an numerical \nargument in a method call.\n\nWith regards to the last point, please see recently-posted discussion on the \nvelocity-dev list.\n\nThe patch is done against CVS head (1.5 dev, after the map patch).  I've \nincluded all parser files.  It's not necessary, but you may want to re-run \njjtree and javacc to regenerate Parser.java, etc if you have a customized \nParser.jj.", "created_at" : { "$date" : "2003-11-19T01:22:25.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:29.470+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e6f5f627d84c8d6c65d" }, "external_id" : "VELOCITY-376", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RFE: anchor support for (sub)sections in site.vsl.", "desc" : "An enhancement proposal:\nAdd the ability to specify the anchor for (sub)sections in site.vsl.\n\nThe problem arises when anchor names have spaces in them.  With my IE,\neven though clicking on the link to anchors on the same page jumps\nthere, putting the link on a new IE shows only the top of the page.", "created_at" : { "$date" : "2005-04-27T06:03:16.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:30.798+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e705f627d84c8d6c66a" }, "external_id" : "VELOCITY-250", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "typo in User Guide", "desc" : "In the last block of the \"Advanced Issues: Escaping and !\" section\n\n\\$foo\n\\$!foo\n\\$!{foo}\n\\bar\n\nshould be\n\n$foo\n$!foo\n$!{foo}\n\\bar", "created_at" : { "$date" : "2004-01-30T11:19:05.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:30.301+0000" }, "creator_id" : { "$oid" : "5b7d37dde9214a0d1608d7a5" }, "reporter_id" : { "$oid" : "5b7d37dde9214a0d1608d7a5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e705f627d84c8d6c673" }, "external_id" : "VELOCITY-60", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "error in event notification", "desc" : "My ReferenceInsertionEventHandler implementation is notified about \"quiet \nreference\" insertion, but the reference name is empty (the first parameter of \nthe referenceInsert() method) so I cannot handle the event properly. I guess \nthe bug is located in ASTReference.", "created_at" : { "$date" : "2002-04-02T20:36:20.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:30.505+0000" }, "creator_id" : { "$oid" : "5b7d381ae9214a0d1608d7c0" }, "reporter_id" : { "$oid" : "5b7d381ae9214a0d1608d7c0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e715f627d84c8d6c67b" }, "external_id" : "VELOCITY-28", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "patch for Win* examples .bat files", "desc" : "Hello, because WinNT cmd.exe by default expands variable on reading,\nnot when it is executed, construction like\n        for %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\nwill just set VELCP variable to the last file found.\nso i suggest next patch to apply:\ndiff -rwuP ori/anakia/build/build.bat new/anakia/build/build.bat\n--- ori/anakia/build/build.bat  Thu Jan  1 00:00:00 1970\n+++ new/anakia/build/build.bat  Thu Nov  8 08:01:34 2001\n@@ -0,0 +1,26 @@\n+REM\n+REM  Thanks to Peter Donald <donaldp@apache.org>\n+REM  for providing this and lcp.bat, so we don't\n+REM  have to hunt down a win32 box :)\n+REM\n+\n+if \"%JAVA_HOME%\" == \"\" goto javahomeerror\n+\n+set ANT_HOME=..\\..\\..\\bin\n+\n+set LOCALCLASSPATH=\n+for %%i in (..\\..\\..\\build\\lib\\*.jar) do call lcp.bat %%i\n+for %%i in (..\\..\\..\\bin\\*.jar) do call lcp.bat %%i\n+\n+echo %LOCALCLASSPATH%\n+\n+%JAVA_HOME%\\bin\\java.exe -classpath \"%LOCALCLASSPATH%\" org.apache.tools.ant.Mai\nn -Dant.home=%ANT_HOME% %1 %2 %3 %4 %5 %6 %7 %8 %9\n+\n+goto end\n+\n+:javahomeerror\n+echo \"ERROR: JAVA_HOME not found in your environment.\"\n+echo \"Please, set the JAVA_HOME variable in your environment to match the\"\n+echo \"location of the Java Virtual Machine you want to use.\"\n+\n+:end\ndiff -rwuP ori/anakia/build/lcp.bat new/anakia/build/lcp.bat\n--- ori/anakia/build/lcp.bat    Thu Jan  1 00:00:00 1970\n+++ new/anakia/build/lcp.bat    Thu Nov  8 08:01:34 2001\n@@ -0,0 +1,2 @@\n+set LOCALCLASSPATH=%LOCALCLASSPATH%;%1\n+\ndiff -rwuP ori/app_example1/example.bat new/app_example1/example.bat\n--- ori/app_example1/example.bat        Thu Nov  8 08:01:34 2001\n+++ new/app_example1/example.bat        Sun Nov 18 11:22:57 2001\n@@ -1,7 +1,9 @@\n @echo off\n\n set VELCP=.\n-for %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\n+for %%i in (..\\..\\bin\\*.jar) do call ..\\cpappend.bat %%i\n+\n+for %%i in (..\\..\\build\\lib\\*.jar) do  call ..\\cpappend.bat %%i\n\n echo Using classpath:  %VELCP%\n\ndiff -rwuP ori/app_example2/example2.bat new/app_example2/example2.bat\n--- ori/app_example2/example2.bat       Thu Nov  8 08:01:34 2001\n+++ new/app_example2/example2.bat       Sun Nov 18 11:24:36 2001\n@@ -1,7 +1,9 @@\n @echo off\n\n set VELCP=.\n-for %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\n+for %%i in (..\\..\\bin\\*.jar) do call ..\\cpappend.bat %%i\n+\n+for %%i in (..\\..\\build\\lib\\*.jar) do  call ..\\cpappend.bat %%i\n\n echo Using classpath:  %VELCP%\n\ndiff -rwuP ori/cpappend.bat new/cpappend.bat\n--- ori/cpappend.bat    Thu Jan  1 00:00:00 1970\n+++ new/cpappend.bat    Sun Nov 18 11:18:04 2001\n@@ -0,0 +1 @@\n+set VELCP=%VELCP%;%1\ndiff -rwuP ori/logger_example/logger_example.bat new/logger_example/logger_examp\nle.bat\n--- ori/logger_example/logger_example.bat       Thu Nov  8 08:01:34 2001\n+++ new/logger_example/logger_example.bat       Sun Nov 18 11:22:34 2001\n@@ -1,7 +1,9 @@\n @echo off\n\n set VELCP=.\n-for %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\n+for %%i in (..\\..\\bin\\*.jar) do call ..\\cpappend.bat %%i\n+\n+for %%i in (..\\..\\build\\lib\\*.jar) do  call ..\\cpappend.bat %%i\n\n echo Using classpath:  %VELCP%\n\ndiff -rwuP ori/xmlapp_example/xmlapp_example.bat new/xmlapp_example/xmlapp_examp\nle.bat\n--- ori/xmlapp_example/xmlapp_example.bat       Thu Nov  8 08:01:34 2001\n+++ new/xmlapp_example/xmlapp_example.bat       Sun Nov 18 11:22:03 2001\n@@ -1,9 +1,9 @@\n @echo off\n\n set VELCP=.\n-for %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\n+for %%i in (..\\..\\build\\lib\\*.jar) do  call ..\\cpappend.bat %%i\n\n echo Using classpath:  %VELCP%", "created_at" : { "$date" : "2001-11-19T05:45:09.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:30.125+0000" }, "creator_id" : { "$oid" : "5b7d381ee9214a0d1608d7c1" }, "reporter_id" : { "$oid" : "5b7d381ee9214a0d1608d7c1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e725f627d84c8d6c683" }, "external_id" : "VELOCITY-184", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "new document: \"Building a Robust and Secure Web Application With Velocity\"", "desc" : "Any time you build a web application, it your responsibility as a web \ndeveloper to ensure that the application does what it is supposed to do, fails \ngracefully in case of an error, keeps users from gaining access to data they \nare not supposed to view, and prevents malicious users from interfering with \nthe operation of the application. \n\nWhile a detailed discussion of how to build a robust web application is an \noverly complex topic, this short paper touches on several issues that are \ncommon in a Velocity-based web application. The paper is written from the \nperspective of a Velocity developer, who interacts with a group of HTML \ntemplate designers and a larger pool of end users. \n\nTopics\n1) How Velocity Helps the Developer Create a Robust App \n2) Velocity-Specific Issues Regarding Robustness and Security \n3) Best Practices In Building A Secure, Robust Velocity Web Application \n   a) Review all context references for unwanted methods. \n   b) Encode HTML special characters to avoid cross-scripting vulnerabilities. \n   c) Use an up-to-date and properly configured app server. \n   d) Configure Velocity for production use. \n4) Working with Untrusted HTML Template Designers", "created_at" : { "$date" : "2003-06-13T00:38:37.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:31.348+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e725f627d84c8d6c68c" }, "external_id" : "VELOCITY-48", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#macro silently does nothing if the macro name is a reference", "desc" : "IMO the code below should either define foo or throw a parse error:\n\n  #set($x = 'foo')\n  \n#macro($x)\n  bar\n  #end\n\nTried with 1.2 Stable and 1.3 Nightly 22/03", "created_at" : { "$date" : "2002-03-23T17:20:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:31.943+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e735f627d84c8d6c694" }, "external_id" : "VELOCITY-30", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The control.vm has one line bug", "desc" : "at page http://jakarta.apache.org/velocity/texen.html\nin Control.vm file the 14 line \n    #set ($outputFile = strings.concat([$planet, \".html\"]))\n\nshould change to \n\n    #set ($outputFile = $planet.concat(\".html\"))\n\nhai", "created_at" : { "$date" : "2001-11-29T16:57:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:31.137+0000" }, "creator_id" : { "$oid" : "5b7d3822e9214a0d1608d7c2" }, "reporter_id" : { "$oid" : "5b7d3822e9214a0d1608d7c2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e745f627d84c8d6c69b" }, "external_id" : "VELOCITY-150", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Memory leak in resource loader", "desc" : "I am using Velocity in a J2EE application. I had problems with my application\nleaking memory. I have traced this back to Velocity. I have made a little simple\nJUnit test, which demonstrates this memory leak. It seems that every time you\ninstantiate a Velocity Engine with a resource loader it leaks about 1.5 Kb of\nheap memory. If I do not include the setup of the resource loader from\nproperties, there is no leak.\nI found this in Velocity 1.3, but I have tried the same test with a cvs checkout\nof Velocity from 4th of marts 2003, and it showed the same problem. If I let the\ntest run with a max heap size of 64Mb, it will fail with OutOfMemoryError\nexception after about 34.000 iterations.\nI have attached the JUnit.\n\nCheers, Kim Madsen \n\n\nBelow follows my unit test\n________________________________________________________________________\npackage com.inceptor.rt;\n\nimport com.inceptor.base.ExceptionBase;\nimport com.inceptor.service.DiagnosticsFact;\nimport com.inceptor.service.DiagnosticsIf;\nimport com.inceptor.util.Test;\nimport com.inceptor.util.TestSuite;\nimport com.inceptor.util.TestCaseJUnit;\nimport com.inceptor.util.Various;\n\nimport java.io.StringWriter;\nimport java.util.Properties;\n\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.Template;\nimport org.apache.velocity.app.VelocityEngine;\n\n/** Servlet used to test <code>rt/Servlet</code> functionality.\n *\n * \n * @version $Id: VelocityMemorySimple.java,v 1.3 2003/02/28 17:28:52 kim Exp $\n */\npublic class VelocityMemorySimple\n    extends TestCaseJUnit {\n\n    private static final DiagnosticsIf diag =\n\tDiagnosticsFact.instance(VelocityMemorySimple.class);\n\n    private static final int ROWS_BETWEEN_DISPLAY = 1000;\n    private static final int ROWS_TO_ITERATE = 50000 * ROWS_BETWEEN_DISPLAY;\n    \n    private static long lastTime = -1;\n\n    public VelocityMemorySimple(String name) throws ExceptionBase {\n\tsuper(name);\n    }\n\n    ///////////////////////////////////////////////////////////////////\n\n    private void showInfo(long rowsInserted)\n\tthrows Exception {\n\n\tif (rowsInserted==0) {\n\t    System.gc();\n\t    lastTime = System.currentTimeMillis();\n\t}\n\t\n\tif (rowsInserted%ROWS_BETWEEN_DISPLAY == 0) {\n\t    long nowTime = System.currentTimeMillis();\n\t    System.gc();\n\t    diag.info(\"Ite=\" + rowsInserted\n\t\t      + \" Mem free =\" \n\t\t      + java.lang.Runtime.getRuntime().freeMemory()\n\t\t      + \" Mem total=\" \n\t\t      + java.lang.Runtime.getRuntime().totalMemory()\n\t\t      + \" Ite/sec.=\"  \n\t\t      + ((double) 1000*ROWS_BETWEEN_DISPLAY)/(nowTime-lastTime)\n\t\t      );\n\t    lastTime = nowTime;\n\t}\n    }\n\n    public void testMemory()\n\tthrows Exception {\n\n\ttry {\n\t    Properties p = new Properties();\n\t\n\t    p.setProperty(\"runtime.log.logsystem.class\",\n\t\t\t  \"org.apache.velocity.runtime.log.SimpleLog4JLogSystem\");\n\t    p.setProperty(\"runtime.log.logsystem.log4j.category\", \"VELOCITY\");\n\t\n\t    p.setProperty(\"resource.manager.logwhenfound\", \"true\");\n\n\t    p.setProperty(\"velocimacro.library\", \"\");\n\n\t    p.setProperty(\"resource.loader\",\n\t\t\t  \"datasourceglobal, datasourcecustom\");\n\t    \n\t    p.setProperty(\"datasourceglobal.resource.description\",\n\t\t\t  \"Load Templates From java:ExcediaDB Global Resources\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.class\",\n\t\t\t  \"org.apache.velocity.runtime.resource.loader.DataSourceResourceLoader\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.datasource\",\n\t\t\t  \"java:ExcediaDB\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.table\",\n\t\t\t  \"RESOURCEGLOBALS\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.keycolumn\",\n\t\t\t  \"NAMESTR\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.templatecolumn\",\n\t\t\t  \"CONTENTCHARACTER\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.timestampcolumn\",\n\t\t\t  \"MODIFICATIONTIME\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource.cache\",\n\t\t\t  \"true\");\n\t    p.setProperty(\"datasourceglobal.resource.loader.resource\",\n\t\t\t  \"6\");\n\t    \n\t    p.setProperty(\"datasourcecustom.resource.description\",\n\t\t\t  \"Load Templates From java:ExcediaDB Custom Resources\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.class\",\n\t\t\t  \"org.apache.velocity.runtime.resource.loader.DataSourceResourceLoader\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.datasource\",\n\t\t\t  \"java:ExcediaDB\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.table\",\n\t\t\t  \"RESOURCECUSTOMS\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.keycolumn\",\n\t\t\t  \"NAMESTR\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.templatecolumn\",\n\t\t\t  \"CONTENTCHARACTER\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.timestampcolumn\",\n\t\t\t  \"MODIFICATIONTIME\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource.cache\",\n\t\t\t  \"true\");\n\t    p.setProperty(\"datasourcecustom.resource.loader.resource\",\n\t\t\t  \"6\");\n\t    VelocityContext context = null;\n\t    StringWriter sw = null;\n\t    VelocityEngine ve = null;\n\n\n\t    for (int i=0; i<=ROWS_TO_ITERATE; i++) {\n\t\tshowInfo(i);\n\n\t\tve = new VelocityEngine();\n\t\tve.init(p);\n\t    }\n\t} catch (OutOfMemoryError e) {\n\t    diag.error(e);\n\t    throw e;\n\t}\n    }\n\n    public static Test suite() throws Exception {\n\n\tdiag.debug(\"Setup test suite\");\n\tTestSuite suite = new TestSuite();\n\n\tsuite.addTest(new VelocityMemorySimple(\"testMemory\"));\n\n\treturn suite;\n    }\n}", "created_at" : { "$date" : "2003-03-10T18:54:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:31.557+0000" }, "creator_id" : { "$oid" : "5b7d3823e9214a0d1608d7c3" }, "reporter_id" : { "$oid" : "5b7d3823e9214a0d1608d7c3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e745f627d84c8d6c6ab" }, "external_id" : "VELOCITY-299", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "template not found under tomcat5 (wrong path)", "desc" : "velocity can't find templates under tomcat5. after every try (including the\nvelocity-examples) u'll get the following error-msg:\n\n\"template not found org.apache.velocity.exception.ResourceNotFoundException:\nUnable to find resource 'mytemplate.vm'\"\n\nafter debugging the code i found some additional infos:\n\nthe bug will be produced in the class \"FileResourceLoader\". This class use the\nvariable \"paths\" which will not be correctly initialized. It contains always a\n\".\" as value insteed of the path to the actual webapp-directory. in the function\n\"FileResourceLoader.findTemplate()\" will this produce a wrong path to the template.\n\nex.\n-----------------------------------------------------------\nprivate InputStream findTemplate(String path, String template){\n...\nFile file = new File(path, template);  // here comes the error!\nString s = file.getAbsolutePath();     // maybe u add this line - it's better\nfor debugging (... and/or adding this to the log)\n        \nif (file.canRead())\n   return new BufferedInputStream(new FileInputStream(s));\nelse\n   return null;\n...\n}\n-----------------------------------------------------------\n\ncause the variable \"path\" contains \".\" the file will show to the\nworking-directory of tomcat5 (ex: \"[tomcat5]/bin/\") and not to the webapp-directory", "created_at" : { "$date" : "2004-10-08T01:12:52.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:32.162+0000" }, "creator_id" : { "$oid" : "5b7d3824e9214a0d1608d7c4" }, "reporter_id" : { "$oid" : "5b7d3824e9214a0d1608d7c4" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e755f627d84c8d6c6b6" }, "external_id" : "VELOCITY-68", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ClassLoader can be null", "desc" : "(Actually 1.3-rc1 but Bugzilla has no entry for it)\n\nRuntimeInstance.java line 291:\nAccording to the docs, Class.getClassLoader() can return null.\n(and it does when velocity.jar is put in the common/lib directory)\n\nMaybe should use the static getResourceAsStream() instead.", "created_at" : { "$date" : "2002-04-19T00:12:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:32.369+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e765f627d84c8d6c6c2" }, "external_id" : "VELOCITY-23", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add handling of primitive arrays with foreach", "desc" : "It would be really nice if you added support for primitive arrays with foreach. \nYou currently handle arrays of objects by creating an iterator for the array \nwhen invoking foreach on it. Why not do the same thing with primitive arrays.\n\nI know you will probably tell me that I can always create my own wrapper around \nthe array, but that has its problems.\n\nI can create my own Iterator wrapper and add it to the context, but what if I \nneed to use that data in multiple foreach statements? I can't use the same \niterator more than once.\n\nI could create a Collection wrapper for the array, but that is a lot of extra \nwork. I don't need the entire collection interface I just want you to iterate \nover the array.\n\nI could create another array creating wrappers for each item (e.g. if I have a \nbyte[] create a Byte[]), but that is horribly inefficient for arrays of any \nsize.\n\nSo the best solution is for Velocity to create an iterator on demand.\n\nIt really is not difficult to actually achieve. You already have the \nArrayIterator class for iterating over arrays of Object. It is easily modified \nto work with any array. Or you can create a separate iterator for primitive \narrays.\n\nTo see how to do that here is the source for the PrimitiveArrayIterator from \nWebMacro which you can compare to your ArrayIterator:\n\nfinal public class PrimitiveArrayIterator implements Iterator\n{\n   private final Object a;\n   private int _size;\n   private int pos;\n\n   public PrimitiveArrayIterator(Object array) \n   {\n      if (!array.getClass().isArray()) \n        throw new IllegalArgumentException(array.getClass().getName() \n          + \" is not an array.\");\n      this.a = array;\n      _size = java.lang.reflect.Array.getLength(a);\n      pos = 0;\n   }\n\n   /**\n     * Return true if we have not yet reached the end of the enumeration\n     */\n   final public boolean hasNext() \n   {\n      return (pos < _size);\n   }\n\n   /**\n     * Advance the iterator and return the next value. Return null if we\n     * reach the end of the enumeration.\n     */\n   final public Object next() throws NoSuchElementException\n   {\n      if (pos < _size) {\n         return java.lang.reflect.Array.get(a, pos++);\n      } else {\n         throw new NoSuchElementException(\"Advanced beyond end of array\");\n      }\n   }\n   final public void remove() throws UnsupportedOperationException\n   {\n      throw new UnsupportedOperationException();\n   }\n}\n\nIf you changed your ArrayIterator to work with any type of array then all you \nhave to change is instead of this in ForEach.java:\n\n    if( listObject instanceof Object[] )\n\nYou would have:\n\n    if( listObject.getClass().isArray() )\n\nAnd you would not have the cast when creating the ArrayIterator further down.\n\nBy the way, while looking at this I noticed that Context.java has an unused \nimport of ArrayIterator.", "created_at" : { "$date" : "2001-10-23T17:31:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:32.966+0000" }, "creator_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "reporter_id" : { "$oid" : "5b7d37efe9214a0d1608d7ad" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e765f627d84c8d6c6cf" }, "external_id" : "VELOCITY-173", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Tools - LayoutServlet Example and Build.xml patch", "desc" : "This isn't perfect, but it's a possible start. I will include a zip with a \nbare bones layout example, setup in the same fashion as the examples/simple \nand examples/struts. I also created a patch for build.xml to include this new \nexample.\n\nCheers,\nTimo\n\n\nIndex: build.xml\n===================================================================\nRCS file: /home/cvspublic/jakarta-velocity-tools/build.xml,v\nretrieving revision 1.14\ndiff -u -r1.14 build.xml\n--- build.xml   26 Apr 2003 16:50:16 -0000      1.14\n+++ build.xml   28 Apr 2003 21:13:45 -0000\n@@ -78,9 +78,11 @@\n     <!-- Clean example applications  -->\n     <ant dir=\"${examples.home}/simple\" target=\"clean\" inheritAll=\"false\"/>\n     <ant dir=\"${examples.home}/struts\" target=\"clean\" inheritAll=\"false\"/>\n+    <ant dir=\"${examples.home}/layout\" target=\"clean\" inheritAll=\"false\"/>\n     <delete>\n       <fileset dir=\"${examples.home}/simple/WEB-INF/lib\" includes=\"*.jar\"/>\n       <fileset dir=\"${examples.home}/struts/WEB-INF/lib\" includes=\"*.jar\"/>\n+      <fileset dir=\"${examples.home}/layout/WEB-INF/lib\" includes=\"*.jar\"/>\n     </delete>\n     <delete>\n       <fileset dir=\"${examples.home}\" includes=\"*.war\"/>\n@@ -233,7 +235,7 @@\n\n   <!-- Build all example applications -->\n   <target name=\"examples\"\n-          depends=\"example.simple,example.struts\"\n+          depends=\"example.simple,example.struts,example.layout\"\n           description=\"Compiles and jars all example applications.\"/>\n\n\n@@ -291,6 +293,28 @@\n     <ant dir=\"${examples.home}/struts\" target=\"all\" inheritAll=\"false\"/>\n   </target>\n\n+  <!-- Build VelocityView - Layout application -->\n+  <target name=\"example.layout\" depends=\"jar.view\"\n+          description=\"Compiles and jars the VelocityView Layout example \napplic\nation.\">\n+\n+    <property name=\"layout.lib\" value=\"${examples.home}/layout/WEB-INF/lib\"/>\n+\n+    <!-- Clean up any past build -->\n+    <delete file=\"${examples.home}/layout.war\"/>\n+    <delete>\n+      <fileset dir=\"${layout.lib}\" includes=\"velocity-tools*.jar\"/>\n+    </delete>\n+\n+    <!-- Assemble and build the layout example -->\n+    <copy todir=\"${layout.lib}\" file=\"${dist.dir}/${view.name}.jar\"/>\n+    <copy todir=\"${layout.lib}\" file=\"${commons-beanutils.jar}\"/>\n+    <copy todir=\"${layout.lib}\" file=\"${commons-collections.jar}\"/>\n+    <copy todir=\"${layout.lib}\" file=\"${commons-digester.jar}\"/>\n+    <copy todir=\"${layout.lib}\" file=\"${dom4j.jar}\"/>\n+    <copy todir=\"${layout.lib}\" file=\"${velocity.jar}\"/>\n+\n+    <ant dir=\"${examples.home}/layout\" target=\"war\" inheritAll=\"false\"/>\n+  </target>\n\n\n </project>", "created_at" : { "$date" : "2003-04-29T04:17:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:32.556+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e775f627d84c8d6c6d8" }, "external_id" : "VELOCITY-135", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity-Tools / ErrorTools doc patch", "desc" : "// Document new error tools methods \n\n    <section name=\"getGlobal()\">\n        <method name=\"getGlobal()\">\n            <abstract>\n                Returns the name of the global error property.\n             </abstract>\n             <signature>\n                String getGlobal()\n             </signature>\n             <returns>\n                The name of the global error property.\n             </returns>\n             <description>\n                <p>This method can be used to retrieve whatever \"global errors\"\n                that have been placed in the queue. This is especially useful \n                if other messasges are being placed next to their instant \n                properties, and you need to retrieve the rest for general\n                display.</p>\n              </description>\n        </method>\n    </section>\n\n    <section name=\"getErrors()\">\n        <method name=\"getErrors()\">\n            <abstract>\n                Returns the ActionErrors object.\n             </abstract>\n             <signature>\n                ActionErrors getErrors()\n             </signature>\n             <returns>\n                The ActionErrors object underlying this request.\n             </returns>\n             <description>\n                <p>This method is mainly useful for \"snooping\" into a \n                request and listing all the properties contained within \n                the ActionError object.</p>\n              </description>\n        </method>\n    </section>", "created_at" : { "$date" : "2003-02-04T08:16:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:32.765+0000" }, "creator_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "reporter_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e785f627d84c8d6c6e2" }, "external_id" : "VELOCITY-263", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "LogManager.createLogSystem does not use contextClassLoader", "desc" : "We use velocity-1.4 as part of a web application; it processes\ntemplates that are served to clients as html files.  The servlet\ncontainer used is tomcat 5.0.18.  Things are laid out like this:\n\n  * CATALINA_HOME/shared/lib/velocity.jar\n    (along with other third-party libraries)\n\nOur class files:\n\n  * CATALINA_HOME/webapps/<context>/WEB-INF/classes\n  * CATALINA_HOME/webapps/<context>/WEB-INF/lib\n\nRecently, we attempted to add our own logging class\n(implements org.apache.velocity.runtime.log.LogSystem).  In doing so,\nI believe I have discovered a bug in velocity's LogManager class.\n\nOur logger is com.r9.nucleus.velocity.Logger\n\n  runtime.log.logsystem.class=com.r9.nucleus.velocity.Logger\n\ncom.r9.nucleus.velocity.Logger lives in a jar in WEB-INF/lib.\n\nA servlet (in the same jar file) can locate, instantiate, and use this\nclass directly.  However, when velocity attempts to use it, we get\nthis:\n\n   java.lang.ClassNotFoundException: com.r9.nucleus.velocity.Logger\n        at org.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader.java:891)\n        at org.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader.java:756)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:302)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:141)\n        at org.apache.velocity.runtime.log.LogManager.createLogSystem(LogManager.java:123)\n        at org.apache.velocity.runtime.RuntimeInstance.initializeLogger(RuntimeInstance.java:553)\n        at org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:226)\n        at org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:461)\n        at org.apache.velocity.app.VelocityEngine.init(VelocityEngine.java:106)\n        at com.r9.nucleus.velocity.VelocityUtils.createVelocityEngine(VelocityUtils.java:83)\n        at com.r9.seeker.template.FormTemplate.getEngine(FormTemplate.java:519)\n        at com.r9.seeker.template.FormTemplate.parse(FormTemplate.java:99)\n        at com.r9.seeker.scrape.AirScraper.populateAndParseTemplate(AirScraper.java:200)\n        at com.r9.seeker.scrape.AirScraper.retrieveResultsPage(AirScraper.java:174)\n        at com.r9.seeker.scrape.AirScraper.specificSearch(AirScraper.java:104)\n        at com.r9.seeker.core.MultiSearcher.search(MultiSearcher.java:167)\n        at com.r9.seeker.core.SearchThreadPool$RunnableSearch.run(SearchThreadPool.java:82)\n        at EDU.oswego.cs.dl.util.concurrent.PooledExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Thread.java:534)\n\n\nHere is the relevant section of LogManager.createLogSystem (w/line\nnumbers).\n\n\n   107\t        /*\n   108\t         *  now run through the list, trying each.  It's ok to \n   109\t         *  fail with a class not found, as we do this to also\n   110\t         *  search out a default simple file logger\n   111\t         */\n   112\t\n   113\t        for( Iterator ii = classes.iterator(); ii.hasNext(); )\n   114\t        {\n   115\t            String claz = (String) ii.next();\n   116\t\n   117\t            if (claz != null && claz.length() > 0 )\n   118\t            {\n   119\t                rsvc.info(\"Trying to use logger class \" + claz );\n   120\t          \n   121\t                try\n   122\t                {\n   123\t>>> HERE >>>        o = Class.forName( claz ).newInstance();\n   124\t\n   125\t                    if ( o instanceof LogSystem )\n   126\t                    {\n   127\t                        ((LogSystem) o).init( rsvc );\n   128\t\n   129\t                        rsvc.info(\"Using logger class \" + claz );\n   130\t\n   131\t                        return (LogSystem) o;\n   132\t                    }\n   133\t                    else\n   134\t                    {\n   135\t                        rsvc.error(\"The specifid logger class \" + claz + \n   136\t                                   \" isn't a valid LogSystem\");\n   137\t                    }\n   138\t                }\n   139\t                catch( NoClassDefFoundError ncdfe )\n   140\t                {\n   141\t                    rsvc.debug(\"Couldn't find class \" + claz \n   142\t                               + \" or necessary supporting classes in \"\n   143\t                               + \"classpath. Exception : \" + ncdfe);\n   144\t                }\n   145\t            }\n   146\t        }\n\n\nThis is what appears to be happening:\n\n - velocity.jar is loaded by tomcat's shared loader.\n\n - a servlet can instantiate and use our Logger class directly; they\n   both fall under the same tomcat WebAppClassLoader.\n\n - LogManager fails because it's using Class.forName() - attempting to\n   use the Shared classloader that loaded velocity.jar.  This\n   classloader cannot has no visibility into the webapp classloader\n   repository.\n\n\nWould it be possible to consider changing this:\n\n   123\t>>> HERE >>>        o = Class.forName( claz ).newInstance();\n\n\nto something like:\n\n   ClassLoader loader = Thread.currentThread().getContextClassLoader();\n   if (loader == null) {\n      loader = getClass().getClassLoader();\n   }\n\n   o = Class.forName(claz, true, loader).newInstance();\n\n\nThis should allow LogManager to have the same class visibility as the\nexecuting servlet thread.", "created_at" : { "$date" : "2004-10-15T02:32:15.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:33.352+0000" }, "creator_id" : { "$oid" : "5b7d382ae9214a0d1608d7c5" }, "reporter_id" : { "$oid" : "5b7d382ae9214a0d1608d7c5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e785f627d84c8d6c6ec" }, "external_id" : "VELOCITY-288", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "variables not resetting if set to null", "desc" : "In a loop over values in an array a variable is set to a non-null value. When \na subsequent value is null, the initial variable retains the previous value \nrather than being set to null.\n\nExample:\n\n#set ($array = [ \"hello\", $null, \"tomorrow\" ])\n#foreach ($item in $array)\n   #set ($text = $item)\n   <pre>\n   array: $item\n   text: $text\n   </pre>\n#end\n\nFor this code, the output is:\n\narray: hello\ntext: hello\n\narray: hello\ntext: hello\n\t\narray: tomorrow\ntext: tomorrow\n\n\nHowever, the output *should* be:\n\narray: hello\ntext: hello\n\narray: $item\ntext: $text\n\t\narray: tomorrow\ntext: tomorrow", "created_at" : { "$date" : "2004-08-17T00:03:53.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:33.560+0000" }, "creator_id" : { "$oid" : "5b7d382be9214a0d1608d7c7" }, "reporter_id" : { "$oid" : "5b7d382be9214a0d1608d7c7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7a5f627d84c8d6c6f5" }, "external_id" : "VELOCITY-197", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "web.xml missing from servlet_example1", "desc" : "There is no mention of a need for a web.xml in the README.TXT and there is no \nweb.xml included in the example.\nI have only rated this as normal severity but it completly holds up anyone \ntrying to get started. You can raise this higher to reflect the actual impact \non new developers.", "created_at" : { "$date" : "2003-08-15T00:45:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:33.761+0000" }, "creator_id" : { "$oid" : "5b7d37bee9214a0d1608d792" }, "reporter_id" : { "$oid" : "5b7d37bee9214a0d1608d792" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7a5f627d84c8d6c6fd" }, "external_id" : "VELOCITY-117", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "modificationCheckInterval is documented with wrong units", "desc" : "The javadoc for org.apache.velocity.runtime.resource.Resource reports that \nmodificationCheckInterval is in milliseconds and that \nsetModificationCheckInterval takes an interval in minutes.  Neither is \ncorrect.  The truth appears to be that this value is interpreted as seconds.\n\n~chuck", "created_at" : { "$date" : "2002-12-05T00:00:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:33.957+0000" }, "creator_id" : { "$oid" : "5b7d382fe9214a0d1608d7c8" }, "reporter_id" : { "$oid" : "5b7d382fe9214a0d1608d7c8" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7b5f627d84c8d6c705" }, "external_id" : "VELOCITY-247", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Some JSLT references are invalid VTL references. Scaping is not the solution.", "desc" : "For example... if you write <c:when test=\"${empty sessionScope.firstName}\"> in a\nvelocity template... you'll get a Velocity parse exception because of blank\nspace... and if you write <c:when test=\"\\$\\{empty sessionScope.firstName}\">\nVelocity just leaves it the same... so you must remove the backslash later,\nwhich is not very comfortable. It's needed a way for scaping an invalid VTL\nreference.\n\nSorry for my english... and sorry again if it's a already known problem.", "created_at" : { "$date" : "2004-01-09T01:39:35.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:34.784+0000" }, "creator_id" : { "$oid" : "5b7d3831e9214a0d1608d7c9" }, "reporter_id" : { "$oid" : "5b7d3831e9214a0d1608d7c9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7c5f627d84c8d6c710" }, "external_id" : "VELOCITY-66", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Example.bat files set classpath incorrectly.", "desc" : "The batch files to run the examples on Win32 systems include the following:\n\nset VELCP=.\nfor %%i in (..\\..\\bin\\*.jar) do set VELCP=%VELCP%;%%i\nfor %%i in (..\\..\\build\\lib\\*.jar) do set VELCP=%VELCP%;%%i\n\nUnfortunately %VELCP% in the for statements gets evaluated when the command is\ninitially parsed.  Thus if ..\\..\\bin\\*.jar containd a.jar, b.jar, c.jar the \nfirst for would expand to:\n  set VELCP=.;a.jar\n  set VELCP=.;b.jar\n  set VELCP=.;c.jar\na.jar and b.jar are lost.\n---\nworkaround:\nfor %%i in (..\\..\\bin\\*.jar) do call appendVELCP %%i\n\nFile appendVELCP.bat:\nset VELCP=%VELCP%;%1\n---\nIt ain't pretty, but it works.\nPS: I couldn't figure out which Component this is.  I guess source is close(?)", "created_at" : { "$date" : "2002-04-17T01:58:42.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:34.581+0000" }, "creator_id" : { "$oid" : "5b7d3832e9214a0d1608d7ca" }, "reporter_id" : { "$oid" : "5b7d3832e9214a0d1608d7ca" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e7c5f627d84c8d6c719" }, "external_id" : "VELOCITY-4", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macros from separate templates conflict", "desc" : "We have two templates, which each parse a third template (called style.vm) \nwhich we put in the top of every template we create.\n\nstyle.vm has some basic variables declared in there to define colours and other \nsuch layout-related things, nothing major. No macros.\n\nThe two templates, however, have more code including macros.\n\nWhat I've noticed is that these two templates can't declare macros with the \nsame names. In other words, if I create a macro in one of them with a certain \nname, ex VELOC, then I can't create a macro VELOC in the other template, \nbecause it'll do what the first one does. My impression, though, is that these \ntemplates should have their own namespace because they don't include each \nother. They do, however, include the common \"style.vm\" I mentioned, which might \nbe the issue.\n\nThis one showed up because we did in fact create two different macros (in two \ntemplates that have nothing to do with each other) of the same name, and one of \nthem was showing the wrong information. Changing the macro name fixed the \nproblem as a workaround, but managing this when we're planning to have hundreds \nof templates is not an option. Each template should have its own macro \nnamespace to prevent conflicts like this.", "created_at" : { "$date" : "2001-05-01T15:48:23.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:34.184+0000" }, "creator_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "reporter_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e7d5f627d84c8d6c721" }, "external_id" : "VELOCITY-155", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fixed deprecation warning for URLEncoder.encode(String) method.", "desc" : "D:\\java\\jakarta-velocity-\ntools\\src\\java\\org\\apache\\velocity\\tools\\view\\tools>cvs\n diff -u -r1.3 LinkTool.java\nIndex: LinkTool.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-velocity-\ntools/src/java/org/apache/velocity/to\nols/view/tools/LinkTool.java,v\nretrieving revision 1.3\ndiff -u -r1.3 LinkTool.java\n--- LinkTool.java       22 Mar 2003 20:33:09 -0000      1.3\n+++ LinkTool.java       24 Mar 2003 23:33:01 -0000\n@@ -57,6 +57,7 @@\n\n import java.net.URLEncoder;\n import java.util.ArrayList;\n+import java.io.UnsupportedEncodingException;\n\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n@@ -474,9 +475,14 @@\n         public String toString()\n         {\n             StringBuffer out = new StringBuffer();\n-            out.append(URLEncoder.encode(key));\n-            out.append('=');\n-            out.append(URLEncoder.encode(String.valueOf(value)));\n+            String encoding = response.getCharacterEncoding();\n+            try {\n+                out.append(URLEncoder.encode(key, encoding));\n+                out.append('=');\n+                out.append(URLEncoder.encode(String.valueOf(value),encoding));\n+            } catch (UnsupportedEncodingException e) {\n+                out.append(\"UnsupportedEncoding \" + e.getMessage());\n+            }\n             return out.toString();\n         }\n     }", "created_at" : { "$date" : "2003-03-25T07:38:42.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:34.995+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e7d5f627d84c8d6c72a" }, "external_id" : "VELOCITY-119", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity resource problems using Jboss-3.0.4_Tomcat-4.0.6 bundle", "desc" : "I am using the velocity-tools (0.6) and Struts (1.02) to build an application \nthat will run in JBoss.  I subclassed VelocityViewServlet to perform some \nspecific startup functions.  JBoss does not unpack WARs and some references \nwere returning java.io.FileNotFound errors.\nI tracked the problem to VelocityServlet.loadConfiguration(ServletConfig \nconfig).  The following worked for me:\n\nI changed this code fragment from this\n\n        Properties p = new Properties();\n        \n        if ( propsFile != null )\n        {\n            String realPath = getServletContext().getRealPath(propsFile);\n        \n            if ( realPath != null )\n            {\n                propsFile = realPath;\n            }\n\n            p.load( new FileInputStream(propsFile) );\n        }\n\n        return p;\n\nto this\n\n        Properties p = new Properties();\n        \n        if ( propsFile != null )\n        {\n        \tInputStream is = getClass().getClassLoader().getResourceAsStream\n( propsFile );\n           \tp.load( is );\n        }\n\n        return p;\n\nNo other external settings/configurations worked until this change was made.", "created_at" : { "$date" : "2002-12-20T06:28:29.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:34.408+0000" }, "creator_id" : { "$oid" : "5b7d383be9214a0d1608d7cc" }, "reporter_id" : { "$oid" : "5b7d383be9214a0d1608d7cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e7e5f627d84c8d6c732" }, "external_id" : "VELOCITY-385", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Source Code not  JDK1.5 compatible", "desc" : "Since velocity uses enum as variables, it can not be compiled with JDK1.5\n\nPlease, apply the attached patch to fix it.", "created_at" : { "$date" : "2005-06-25T15:13:09.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:35.927+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7f5f627d84c8d6c73d" }, "external_id" : "VELOCITY-69", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macros cannot begin with \"set\"", "desc" : "I can define a macro that begins with \"set\" -- like #macro(setFooBar) -- but if \nI try to invoke it, I get a ParseException.  This is a probably a result of \nspecial whitespace-handling for the #set directive.", "created_at" : { "$date" : "2002-04-25T22:00:36.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:35.340+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e7f5f627d84c8d6c746" }, "external_id" : "VELOCITY-220", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RFE: Using JDK 1.4 LinkedHashMap instead of commons LRUMap", "desc" : "In release target 1.5 you mention switching to jakarta-commons LRUMap for caching.\n\nVelocity should decrease its dependency on 3rd-party jars, not increase them! Use JDK1.4 \njava.util.LinkedHashMap instead!\n\nSince 1.4 has been out for months, and you are just now releasing RC1 of Velocity 1.4, by the time \nyou get Velocity 1.5 out the door you shouldn't have to worry about development on pre-1.4 JDKs.\n\nWe love Velocity, but hate the many other Jakarta projects that rely on so many 3rd-party jars \n(beanutils, collections, logging, lang, etc.) that have a tendency to cause version conflicts with \nlibraries in use in a project.", "created_at" : { "$date" : "2003-10-30T04:18:47.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:35.751+0000" }, "creator_id" : { "$oid" : "5b7d37a3e9214a0d1608d785" }, "reporter_id" : { "$oid" : "5b7d37a3e9214a0d1608d785" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e805f627d84c8d6c751" }, "external_id" : "VELOCITY-121", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "test output looks different than install.html", "desc" : "apparently, it is now 39 tests and no longer  38\n<<     [java] Adding TemplateTestCase : settest\n     [java] .......................................\n     [java] Time: 1.652\n\n     [java] OK (39 tests)>>\nalso, I would add some\n<...>\nsince the output ends with:\n<<     [java] .\n     [java] Time: 0.02\n\n     [java] OK (1 tests)\n\n\ntest-parser:\n     [echo] Running special parser tests...\n     [java] ...Caught pee!\n\n     [java] Time: 0.962\n\n     [java] OK (3 tests)\n\n\ntest-all:\n\nBUILD SUCCESSFUL\nTotal time: 32 seconds>>", "created_at" : { "$date" : "2003-01-10T14:50:07.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:35.539+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e815f627d84c8d6c75c" }, "external_id" : "VELOCITY-300", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "second Case Substitution example in the user guide doesn't work", "desc" : "The second example,\n\n$data.getUser(\"jon\")\n## is the same as\n$data.User(\"jon\")\n\nis not correct.  The following:\n\n## Let's say that $data.getUser(\"jon\") returns \"Doe\".\n$data.getUser(\"jon\")\n## is the same as\n$data.User(\"jon\")\n\nproduces:\n\nDoe\n$data.User(\"jon\")\n\nand not the expected:\n\nDoe\nDoe\n\nIt should be removed from the User Guide to avoid confusion.", "created_at" : { "$date" : "2004-10-10T06:17:37.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:36.850+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e815f627d84c8d6c768" }, "external_id" : "VELOCITY-167", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "LogSystem NPE s", "desc" : "Unfortunately, the used LogSystem is unstable.\n1) SimpleLog4JSystems:\n   - if runtime.log.logsystem.log4j.category is not set (default), the cast to\n     string throws an NPE, when trying to init(), i.e. obtain the categoryname.\n   - so first fix could be:\n--\nObject categoryname = o rsvc.getProperty(\"runtime.log.logsystem.log4j.category\");\n\n        if ( categoryname != null )\n        {\n            logger = Logger.getLogger( categoryname.toString() );\n            ...\n---\n   - if null, same issue applies to the logfile stuff\n   - furthermore internalInit( logfile ) would throw an NPE from\n     java.io.FileOutputStream.<init>\n   - finally a log is there, but uninitialized (i.e. useless) and\n   - a misleading \"PANIC: ...\" message is thrown to stdout\n\nalmost the same counts for the Log4JLogSystem as well as the AvalonLogSystem ...", "created_at" : { "$date" : "2003-04-18T09:41:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:36.627+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e825f627d84c8d6c773" }, "external_id" : "VELOCITY-388", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Rename enum variables for JDK5 compatability", "desc" : "As a new velocity user the first thing I did was to build the examples. This\nresulted in errors due to the combination of JDK5 on my machine and enam\nvariables in example code.\nenum variables should be renamed to some other name.\nFor the time being I shall revert to an earlier JDK.", "created_at" : { "$date" : "2005-07-04T21:54:12.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:37.244+0000" }, "creator_id" : { "$oid" : "5b7d3690e9214a0d1608d71f" }, "reporter_id" : { "$oid" : "5b7d3690e9214a0d1608d71f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e825f627d84c8d6c77c" }, "external_id" : "VELOCITY-296", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "the HttpServletRequest object in VelocityServlet.doPost() does not  contain POSTed parameters", "desc" : "The HttpServletRequest object in VelocityServlet.doPost() does not contain\nPOSTed parameters if the form was submitted specifying an encoding type.\n\nif the .html form has:\n\n<form method=\"post\" action=\"http://127.0.0.1\">\n...a bunch of <input> tags...\n</form>\n\nthen in org.apache.velocity.servlet.VelocityServlet.doPost() you can do\nrequest.getParameterNames() and all parameter names are retrieved, but if the \n.html form has:\n\n<form method=\"post\" action=\"http://127.0.0.1\" enctype=\"multipart/form-data\">\n...a bunch of <input> tags...\n</form>\n\nthen in org.apache.velocity.servlet.VelocityServlet.doPost() a call to\nrequest.getParameterNames() returns null.\n\nThe problem happens much earlier really but this is the symptom I experience.", "created_at" : { "$date" : "2004-10-01T01:33:20.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:37.801+0000" }, "creator_id" : { "$oid" : "5b7d3880e9214a0d1608d7cd" }, "reporter_id" : { "$oid" : "5b7d3880e9214a0d1608d7cd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e835f627d84c8d6c785" }, "external_id" : "VELOCITY-39", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "obscure parsing/rendering error", "desc" : "here's a weird one for you... (this is with velocity-1.3-dev)\n\n$bar##\n#set( $foo = \"foo\" )\n$foo\n\nrenders as\n\n$bar#set( $foo = \"foo\" ) $foo\n\nand\n\n$bar#*\n*##set( $foo = \"foo\" )\n$foo\n\nrenders as\n\n$bar#set( $foo = \"foo\" ) $foo\n\nfore some reason, the parser doesn't catch the #set directive in these \nsituations.  in both cases, removing the $bar reference right\nbefore the comment, or adding an extra new-line between the comment end and\nthe #set directive will cause the template to render correctly.  funky, eh?", "created_at" : { "$date" : "2002-02-22T07:42:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:37.626+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e845f627d84c8d6c78d" }, "external_id" : "VELOCITY-158", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[Velocity-Tools] Fixed typo", "desc" : "I found typo in index.xml and struts-index.xml.", "created_at" : { "$date" : "2003-03-29T22:36:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:37.420+0000" }, "creator_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "reporter_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e845f627d84c8d6c798" }, "external_id" : "VELOCITY-290", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The source distribution is missing...", "desc" : "Hi,\n\nI tried to download the source distribution from \n  http://nagoya.apache.org/mirror/jakarta/velocity/source/ \nbut the directory is empty.\nIf you go to \"Download - Source Code - Velocity\"  it gives you the Binary \ndistribution.\n\nCheers\n JD", "created_at" : { "$date" : "2004-08-24T22:44:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:38.318+0000" }, "creator_id" : { "$oid" : "5b7d3883e9214a0d1608d7ce" }, "reporter_id" : { "$oid" : "5b7d3883e9214a0d1608d7ce" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e855f627d84c8d6c7a1" }, "external_id" : "VELOCITY-73", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[VELTOOLS] the view example uses 'contextkey' instead of 'key'", "desc" : "The file view/examples/simple/WEB-INF/toolbox.xml uses the \ndeprecated 'contextkey' instead of just 'key'.\n\nNot very dramatic, but when using the example to build a new toolbox.xml, it \ngenerates a NullPointerException in ServletToolboxManager with no stacktrace, \nand one has to dig out a little bit to find why.", "created_at" : { "$date" : "2002-05-07T05:42:37.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:38.502+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e865f627d84c8d6c7a9" }, "external_id" : "VELOCITY-44", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Escaping backslash, strange results with backslash series", "desc" : "Input (template):\n\n  \\\n  \\\\\n  \\\\\\\n  \\\\\\\\\n  \\\\\\\\\\\n  \\\\\\\\\\\\\n\nOutput:\n\n  \\\n  \\\\\n  \\\\\\\n  \\\\\n  \n\\\\\\\n  \\\\\n\nI have tried it with 1.2 Stable and 1.3 Nightly 22/03.\n\nPerhaps originally two \nbackslashes in the template should produce one backslash in the output?", "created_at" : { "$date" : "2002-03-23T08:09:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:38.711+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e865f627d84c8d6c7b2" }, "external_id" : "VELOCITY-10", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "wish for comfortable template loading", "desc" : "Dear developers,\n\nin the \"Multiple Template Path Configuration\" section of the Dev-Documentation\nit says one can define several template-dir's if listed like this in \nvelocity.properties:\nfile.resource.loader.path = /opt/directory1, /opt/directory2, /opt/dir2/dir3\n\nWouldn't it be nice if we had a wildcard which would be standing for all sub \ndirectories ?!!\nThe use of this feature could look like this for example:\nfile.resource.loader.path = /opt/**\n\nAnd thus noone (who likes his templates to be nicely ordered) would have to list \ntwenty-something dir's on this line of velocity.properties ...\n\nBest regards.\nJoerg Buchberger", "created_at" : { "$date" : "2001-08-02T15:03:43.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:38.925+0000" }, "creator_id" : { "$oid" : "5b7d3888e9214a0d1608d7cf" }, "reporter_id" : { "$oid" : "5b7d3888e9214a0d1608d7cf" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e875f627d84c8d6c7bc" }, "external_id" : "VELOCITY-152", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Map creation syntax for VTL code", "desc" : "James Taylor <mailto:jtaylor@apache.org> has implemented java.util.Map creation\nVTL syntax against both Velocity 1.4 and 1.3.  Geir and I feel that this change\nshould go into Velocity 1.5, pending a bit more discussion of the syntax.", "created_at" : { "$date" : "2003-03-11T03:49:24.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:38.117+0000" }, "creator_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "reporter_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e875f627d84c8d6c7c5" }, "external_id" : "VELOCITY-349", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "apache mail archive - velocity error processing template", "desc" : "I got the following exception when trying to open\nhttp://mail-archives.apache.org/eyebrowse/ReadMsg?listName=commons-dev@jakarta.apache.org&msgNo=64482\n\n\n\nVelocityServlet: Error processing the template\n\nnull: Got error 127 from table handler\norg.apache.velocity.exception.VelocityException: null: Got error 127 from table\nhandler\n\tat org.tigris.eyebrowse.servlets.EyebrowseServlet.handleRequest(Unknown Source)\n\tat org.apache.velocity.servlet.VelocityServlet.doRequest(VelocityServlet.java:396)\n\tat org.tigris.eyebrowse.servlets.EyebrowseServlet.doRequest(Unknown Source)\n\tat org.apache.velocity.servlet.VelocityServlet.doGet(VelocityServlet.java:355)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2416)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:601)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:534)", "created_at" : { "$date" : "2005-01-31T17:41:51.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:39.688+0000" }, "creator_id" : { "$oid" : "5b7d388ce9214a0d1608d7d0" }, "reporter_id" : { "$oid" : "5b7d388ce9214a0d1608d7d0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e885f627d84c8d6c7cf" }, "external_id" : "VELOCITY-180", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "new event handler for input directives (#parse, #include)", "desc" : "I've created a simple but flexible new event handler that is called by the \n#parse and #include directive.  This event handler takes as an argument the \nresource path argument for #parse or #include, and returns a modified path \nindicating the resource to actually be returned.  If the event handler returns \nnull, no page is included.\n\nThis has many uses.  A few examples.\n-- Relative path.  All #include/#parse directives can be forced to refer to a \ndirectory relative to the current template\n \n-- Security.  A page can be restricted to only be able to refer to a \nparticular group of pages.\n \n-- Localization.  Templates can include pages for a particular language or \nregion, and the app can switch those pages to refer to a different language or \nregion as appropriate.\n \nThis patch is 100% backwards compatible with existing templates and code.\n\nPersonally, I have urgent need of this feature.  My web app allows numerous \n(untrusted) users to upload templates into a common web space (each user has \ntheir own directory).  A major problem was that users could access other \nuser's pages with #parse and #include.  In just a few lines of code, I've \nimplemented a security-oriented implementation of this event handler to allow \neach user to only be able to include their own set of pages.  Without this \nevent handler, I was not able to figure out a straight forward solution to \nthis problem.\n \nAs a side note, I believe this presents an elegant way to solve this problem \nas well (allowing the developer to force paths to be relative to the template).\n \nhttp://www.mail-archive.com/velocity-dev@jakarta.apache.org/msg07223.html\n \n\nBest, WILL\n \nP.S.  If this approach is acceptable to the committers, I'll go ahead and \ncreate test cases and documentation in relatively short order.  I've already \nbuilt some informal test code.  I can't run \"ant test\" completely as it fails \n(on the encoding test), even without the patch, but it ran fine up until that \npoint.", "created_at" : { "$date" : "2003-05-30T05:21:47.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:39.119+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e895f627d84c8d6c7df" }, "external_id" : "VELOCITY-63", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Should not discard stack traces", "desc" : "There are a few catch {} blocks in Velocity where it discards stack traces \nwithout logging them, which hinders debugging.  (Example: VelocityServlet.java, \ninitVelocity() method).  We should log all exceptions that are not rethrown.", "created_at" : { "$date" : "2002-04-10T22:07:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:39.965+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e895f627d84c8d6c7e7" }, "external_id" : "VELOCITY-5", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Null AST error when calling a macro from within another macro", "desc" : "Contact me for a better example if necessary, but it should be simple to \nreproduce. If not, I can create one for you.\n\nSimply put, everything works fine in the default setup. I can call velocimacros \nrecursively and it's all great.\n\nSuppose, however, that in a particular framework, it was necessary to define \nallow.inline.local.scope = true, because in this case we don't want everything \nto be global.\n\nThe call to a macro defined inline works correctly. However, if that macro, in \nturn, wants to call another inline macro, I get this error:\n\n[error] VM error : nameOfMacro. Null AST\n\nLooks like it's an issue with defining what is local scope. There should be the \ncapability to have everything declared inline in a template to be able to call \neverything in that template.\n\nSo my code looks something like this:\n\n--myexample.vm--\n\n#macro( drawItem $item )\n  <!-- drawing item -->\n#end\n\n#macro( drawBundle $bundledraw )\n  <!-- drawing a bundle -->\n  #set( $bundleitems = $bundledraw.getItems() )\n  #foreach( $bundleitem in $bundleitems )\n    #drawItem( $bundleitem )\n  #end\n#end\n\n#macro( drawContainer $contdraw )\n  #set( $contitems = $contdraw.getItems() )\n  #foreach( $contitem in $contitems )\n    #if( ${utility.isItem( ${contitem} )} )\n      #drawItem( $contitem )\n    #elseif( ${utility.isBundle( ${contitem} )} )\n      #drawBundle( $contitem )\n    #else\n      <!-- invalid item -->\n    #end\n  #end\n#end\n\n#drawContainer( $container )\n\n--end test.vm--\n\nIn the default velocity configuration, everything works as expected. The call \nmakes it from drawContainer to end up eventually calling drawItem. When \nallow.inline.local.scope = true, however, the calls would break within \ndrawContainer, with drawItem and drawBundle generating the Null AST errors.\n\nI'm assuming that \"local scope\" means what I think it means - that everything \nin a template should behave the same way as it would have if localscope were \nfalse. The difference, of course, should only be that drawContainer, drawItem \nand drawBundle are only available within this template, and not seen anywhere \nelse.\n\nI hope this helps somewhat. Again, contact me if you need a better example. \nThanks (btw: Velocity rocks! I love it!)", "created_at" : { "$date" : "2001-05-22T19:04:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:39.391+0000" }, "creator_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "reporter_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e8a5f627d84c8d6c7f7" }, "external_id" : "VELOCITY-380", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "\"Formal\" directive notation", "desc" : "Unless it's something I have to enable (and I've seen no mention of that in any\ndocumentation), I don't believe using curly brackets to surround directives\nactually works.  According to\nhttp://jakarta.apache.org/velocity/user-guide.html#Directives \"Like references,\nthe name of the directive may be bracketed by a { and a } symbol.\"  I tried the\nexample in that section:\n\n## First, a bit I added:\n#set( $a = 1 )\n## The actual example line:\n#if($a==1)true enough#{else}no way!#end\n\nThe output of this is, unexpectedly:\n\ntrue enough#{else}no way!\n\nAnd if $a is set to 2 (for example), there is no output at all because the\n#{else} is not spotted.", "created_at" : { "$date" : "2005-05-20T23:53:58.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:40.954+0000" }, "creator_id" : { "$oid" : "5b7d3892e9214a0d1608d7d1" }, "reporter_id" : { "$oid" : "5b7d3892e9214a0d1608d7d1" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e8b5f627d84c8d6c7ff" }, "external_id" : "VELOCITY-221", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[patch] allow multi-line directives", "desc" : "I'd like to allow all directives be able to stretch across multiple lines.  An \nexample might be:\n\n#set ($a = \n  10)\n  \nor\n\n#if( $biglongreference ==\n       \"very big long string\")\n\nThe rationale for this is that newlines are sometimes silently inserted by web \ndesign applications into arbitrary HTML.  For example, many of our users work \nwith Macromedia DreamWeaver.  DreamWeaver is not aware of VTL, and treats it \nlike ordinary text.  A user might type VTL in the \"HTML\" mode of DreamWeaver, \nonly to see the VTL reformatted as paragraphed text after \nediting/saving/reloading.  This means that a web page with VTL might work fine \none day, and then break after the page is loaded/saved by the tool.  This can \nbe highly confusing, especially to the less technical template writers who \nmight be using the web design program in the first place.\n\nIn addition (although this is a less important reason), most scripting \nlanguages permit newlines within control statements.\n\nA couple of notes about this bug report and patch.\n\n(1) It's 100% backwards compatible, and passes \"ant test\"\n(2) The change is simple (despite the long patch).  I simply replaced most \nreferences to <WHITESPACE> in Parser.jjt with <WHITESPACE_NEWLINE>\n(3) This is a completely separate issue from any debates over gobbling \nwhitespace (Bug# 7940) or allowing multiline literals (Bug # 17803).\n(4) Whitespace gobbling rules at start/end of directive remain the same. (I \nthink this should be addressed separately).", "created_at" : { "$date" : "2003-11-03T12:23:24.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:40.740+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e8b5f627d84c8d6c80e" }, "external_id" : "VELOCITY-45", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Comment directly after $ will hide the $", "desc" : "Input:\n  $##\n  foo\n  $#**#bar\n\nOutput:\n  foo\n  bar\n\nTried with 1.2 Stable and 1.3 Nightly \n22/03. Note that 1.2 does trigger the ReferenceInsertion event too.", "created_at" : { "$date" : "2002-03-23T16:59:23.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:40.540+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e8c5f627d84c8d6c815" }, "external_id" : "VELOCITY-90", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Break / return statement", "desc" : "Please answer this as soon as possible: how do i break from a loop / return a \nvalue from a macro based on some condition\n\nPlease have a look at this code\n\n#macro ( countTabbedSection $position )\nposition = $position\n#set ($loopend = $alSections.size() - 1)\n#foreach ($count in [$position..$loopend])\n #set( $sectiondataobject = $alSections.get($count) )\n #if ($sectiondataobject.getIsTabbed()==1)\n sectiondataobject.getIsTabbed() = $sectiondataobject.getIsTabbed()\n #else\n  ## i want to break this loop here\n #end\n#end\n#end ## end of macro\n\n\n#set( $count = 0 )\n#foreach ($sectiondataobject in $alSections)\n #countTabbedSection( $count )\n #set( $count=$count+1 )\n#end\n\n \n\nThanks", "created_at" : { "$date" : "2002-07-19T11:13:24.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:40.357+0000" }, "creator_id" : { "$oid" : "5b7d3896e9214a0d1608d7d2" }, "reporter_id" : { "$oid" : "5b7d3896e9214a0d1608d7d2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904e8d5f627d84c8d6c81d" }, "external_id" : "VELOCITY-94", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "!= operator missing from documentation", "desc" : "Velocity allows the != operator to be used, but the documentation\ndoes not mention it.  (I could not find it in the user's guide,\nthe developer's guide, or the VTL reference guide.)  There seems\nto be a list of operators in the VTL guide in the section on\n#if, but != is not there.", "created_at" : { "$date" : "2002-07-23T06:01:56.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:40.147+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904e8d5f627d84c8d6c828" }, "external_id" : "VELOCITY-26", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Typo", "desc" : "In the Examples folders, under servlet_example1, file sample.vm, typo on line \n8: \"widht\"\n\n\n<table cellspacing=\"0\" cellpadding=\"5\" widht=\"100%\">", "created_at" : { "$date" : "2001-11-05T21:58:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:41.348+0000" }, "creator_id" : { "$oid" : "5b7d3898e9214a0d1608d7d3" }, "reporter_id" : { "$oid" : "5b7d3898e9214a0d1608d7d3" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e8e5f627d84c8d6c82f" }, "external_id" : "VELOCITY-156", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[VELTOOLS][PATCH] Avoid dummy tools creation in ViewToolInfo constructor", "desc" : "This patch avoid a dummy tools creation in ViewToolInfo constructor, made only \nto know if the tool was a ViewTool.\n\nThe proper way of doing this is to use the Class.isAssignableFrom method, \nwithout creating any dummy instance just to use instanceof.\n\nCloD", "created_at" : { "$date" : "2003-03-26T06:35:26.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:41.138+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e8f5f627d84c8d6c83b" }, "external_id" : "VELOCITY-196", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ClasspathResourceLoader uses wrong ClassLoader", "desc" : "I see the following problems with ClasspathResourceLoader:\n\n1. It loads templates using the ClassLoader it was loaded in, which in many\ncases will be the top-level or a high-level ClassLoader within an appserver\n2. Individual applications within the server almost always are given their own\ncontextual ClassLoader. In Tomcat, for example, each webapp has its own loader.\n3. Each webapp should be able to package templates in jars to be put in\nWEB-INF/lib and have Velocity load them correctly.\n4. Each webapp should not have to put velocity-xxx.jar in their WEB-INF/lib to\nbe able to use Velocity.\n5. Therefore, Velocity should be able to load templates using the contextual\nClassLoader appropriate for the *caller*\n\nClasspathResourceLoader uses getClass().getClassLoader() to look for templates.\nIf Velocity is loaded at the system or server level, and a webapp hopes to use\nthis method to load its own jarred templates, it will fail as it did for me.\n\nThe fix is terribly simple, and I think it makes sense to apply it directly to\nClasspathResourceLoader, or at least provide a ThreadContextResourceLoader, as I\nhave done:\n\nIn ClasspathResourceLoader.getResourceStream(), change:\n\nClassLoader classLoader = this.getClass().getClassLoader();\n\nto:\n\nClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n\nThis will cause the resource loading to look first at the caller's level\n(webapp) and if not found, move up the ClassLoader chain. I believe this is the\nappropriate way to handle loading templates as resources. From the documentation\nfor getContextClassLoader():\n\n...\n     * Returns the context ClassLoader for this Thread. The context\n     * ClassLoader is provided by the creator of the thread for use\n     * by code running in this thread when loading classes and resources.\n     * If not set, the default is the ClassLoader context of the parent\n     * Thread. The context ClassLoader of the primordial thread is\n     * typically set to the class loader used to load the application.\n...\n\nThe resource should be loaded from the ClassLoader that the creator of the\ncalling thread intended...not from the classloader that loaded Velocity. Also\nkeep in mind this change would not break loading from the system classpath...it\nwould just include contextual ClassLoaders in the lookup process.\n\nI will look into creating a patch if it would be useful, but it's a one-line fix.", "created_at" : { "$date" : "2003-08-14T21:14:21.000+0000" }, "updated_at" : { "$date" : "2011-02-24T01:00:30.763+0000" }, "creator_id" : { "$oid" : "5b7d389ae9214a0d1608d7d4" }, "reporter_id" : { "$oid" : "5b7d389ae9214a0d1608d7d4" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e905f627d84c8d6c851" }, "external_id" : "VELOCITY-805", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unable to convert instances of two separate enums on a Velocity Template", "desc" : "I am unable to utilize the valueOf method on two separate instances of an enum - which share the same name.  The issue is that when the second valueOf method is called, it is invoked on the first enum which is accessed in the template.\n\nThis can be tested by creating two enums with the same name in two separate classes.  Place these onto the context, and then try to utilize the valueOf method and you'll receive a stack trace stating that no value exists.  For example create two separate classes with an inner enum which both have the same name.  Add each enum onto the context, and then in a template attempt to access them in the following way: $enum1.valueOf(\"VAL1\") $enum2.valueOf(\"SOME_OTHER_VAL\").  This will not work.  Luckily you are able to do the following as a workaround: $enum1.valueOf($enum1, \"VAL1\") $enum2.valueOf($enum2, \"SOME_OTHER_VAL\")\n\nStack trace below:\njava.lang.IllegalArgumentException: No enum const class org.velocity.testing.domain.User$Actions.MODIFY_NAME\n\tjava.lang.Enum.valueOf(Enum.java:196)\n\torg.velocity.testing.domain.User$Actions.valueOf(User.java:1)\n\tsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tjava.lang.reflect.Method.invoke(Method.java:597)\n\torg.apache.velocity.util.introspection.UberspectImpl$VelMethodImpl.doInvoke(UberspectImpl.java:395)\n\torg.apache.velocity.util.introspection.UberspectImpl$VelMethodImpl.invoke(UberspectImpl.java:384)\n\torg.apache.velocity.runtime.parser.node.ASTMethod.execute(ASTMethod.java:173)\n\torg.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:280)\n\torg.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:369)\n\torg.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:342)\n\torg.apache.velocity.Template.merge(Template.java:356)\n\torg.apache.velocity.Template.merge(Template.java:260)\n\torg.springframework.web.servlet.view.velocity.VelocityLayoutView.renderScreenContent(VelocityLayoutView.java:180)\n\torg.springframework.web.servlet.view.velocity.VelocityLayoutView.doRender(VelocityLayoutView.java:150)\n\torg.springframework.web.servlet.view.velocity.VelocityView.renderMergedTemplateModel(VelocityView.java:291)\n\torg.springframework.web.servlet.view.AbstractTemplateView.renderMergedOutputModel(AbstractTemplateView.java:167)\n\torg.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)\n\torg.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1047)\n\torg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:817)\n\torg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)\n\torg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:617)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:717)", "created_at" : { "$date" : "2011-06-30T15:05:31.542+0000" }, "updated_at" : { "$date" : "2011-06-30T15:11:38.786+0000" }, "creator_id" : { "$oid" : "5b7d389ce9214a0d1608d7d7" }, "reporter_id" : { "$oid" : "5b7d389ce9214a0d1608d7d7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Tomcat 6, Spring 3.0.4" },
{ "_id" : { "$oid" : "5b904e905f627d84c8d6c855" }, "external_id" : "VELOCITY-803", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "EOF exception when last line is commented out and has no new line at end", "desc" : "Lexical error,   Encountered: <EOF> after : \"\" at internal/application/resource/93A720B90BB6C25703701E67D0DA75220B7D2FFC/greetingsFromTimbuktu/showComments.vm[line 2, column 51]\norg.apache.velocity.exception.ParseErrorException: Lexical error,   Encountered: <EOF> after : \"\" at internal/application/resource/93A720B90BB6C25703701E67D0DA75220B7D2FFC/greetingsFromTimbuktu/showComments.vm[line 2, column 51]\n\nThis Bug seems to be the same as VELOCITY-272\n\nThis is my vm-code:\n\nHello World\n##################################################", "created_at" : { "$date" : "2011-05-23T10:57:11.261+0000" }, "updated_at" : { "$date" : "2011-09-03T19:52:12.863+0000" }, "creator_id" : { "$oid" : "5b7d38a0e9214a0d1608d7d8" }, "reporter_id" : { "$oid" : "5b7d38a0e9214a0d1608d7d8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e915f627d84c8d6c85b" }, "external_id" : "VELOCITY-777", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ParseErrorException line-/columnNumber properties not set", "desc" : "import java.io.StringReader;\nimport java.io.StringWriter;\n\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.app.Velocity;\nimport org.apache.velocity.exception.ParseErrorException;\n\n\npublic class VelErrTest {\n\n    public static void main(String[] args) throws Exception {\n        String template = \"hello\\n\\nFoo bar #blah(foo.bar.baz)\";\n        VelocityContext ctx = new VelocityContext();\n        StringWriter out = new StringWriter(100);\n        try {\n            Velocity.evaluate(ctx, out, \"test\", new StringReader(template));\n            System.out.println(out.toString());\n        } catch (ParseErrorException pex) {\n            System.out.println(\"ParseErrorException: \"+ pex.getMessage());\n            System.out.println(\" ..at: \" + pex.getLineNumber() + \", \" + pex.getColumnNumber());\n        }\n    }\n\n}\n\n\n\n...outputs:\n\nParseErrorException: Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 3, column 19.  Encountered: \"b\" (98), after : \".\"\n ..at: -1, -1\n\ni.e. the getLineNumber(), getColumnNumber() fields are (-1,-1) rather than (3,19).\n", "created_at" : { "$date" : "2010-09-23T13:00:33.062+0000" }, "updated_at" : { "$date" : "2011-09-03T20:29:51.305+0000" }, "creator_id" : { "$oid" : "5b7d38a2e9214a0d1608d7d9" }, "reporter_id" : { "$oid" : "5b7d38a2e9214a0d1608d7d9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Velocity 1.6.4" },
{ "_id" : { "$oid" : "5b904e915f627d84c8d6c863" }, "external_id" : "VELOCITY-741", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Please upload sources jar for 1.5 to Maven central repository", "created_at" : { "$date" : "2009-10-28T12:58:03.901+0000" }, "updated_at" : { "$date" : "2012-03-07T16:48:49.569+0000" }, "creator_id" : { "$oid" : "5b7d38b0e9214a0d1608d7db" }, "reporter_id" : { "$oid" : "5b7d38b0e9214a0d1608d7db" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e925f627d84c8d6c869" }, "external_id" : "VELOCITY-735", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e925f627d84c8d6c86a" }, "external_id" : "VELOCITY-765", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Consider adding JSR-223 factory & engine to Velocity", "desc" : "JSR-223 is a standard scripting interface (javax.script) which is included in Java 1.6+ (and available on Java 1.4/1.5 by using Jakarta BSF3).\n\nConsider including an implementation of the factory and engine for Velocity.\n\n", "created_at" : { "$date" : "2010-05-24T16:45:33.046+0000" }, "updated_at" : { "$date" : "2012-03-22T16:38:34.679+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e925f627d84c8d6c869" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b904e935f627d84c8d6c873" }, "external_id" : "VELOCITY-822", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "I am getting bellow error message in Velocity. Please suggest to resolve this issue:", "created_at" : { "$date" : "2012-04-20T13:04:06.095+0000" }, "updated_at" : { "$date" : "2012-04-24T13:45:45.841+0000" }, "creator_id" : { "$oid" : "5b7d38b1e9214a0d1608d7dd" }, "reporter_id" : { "$oid" : "5b7d38b1e9214a0d1608d7dd" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e935f627d84c8d6c878" }, "external_id" : "VELOCITY-823", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "I am getting bellow error message in Velocity. Please suggest to resolve this issue: 2012-04-20 18:42:06,810 [http-8080-Processor24] ERROR velocity - RHS of #set statement is null. Context will not be modified. com/cisco/ea/ui/template/vm/core/compat_init", "created_at" : { "$date" : "2012-04-20T13:14:00.675+0000" }, "updated_at" : { "$date" : "2012-04-24T14:01:30.523+0000" }, "creator_id" : { "$oid" : "5b7d38b1e9214a0d1608d7dd" }, "reporter_id" : { "$oid" : "5b7d38b1e9214a0d1608d7dd" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e945f627d84c8d6c87e" }, "external_id" : "VELOCITY-496", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow periods in references secondary keys.", "desc" : "This is a quite prospective proposal that emerged from a discussion in a VelocityTools JIRA issue (https://issues.apache.org/jira/browse/VELTOOLS-69).\n\nIts goal is to have the short syntax $map.foo.bar chek the existence of $map.get(\"foo.bar\") when $map.foo is null.\n\nBackward compatibility is 99%, since it only breaks templates that rely on $map.foo.bar being an invalid reference while having foo.bar as key in map.\n\nThe implementation doesn't look obvious, and we must ensure that there are no other side effects, yet this behaviour can be quite usefull when dealing with HTML field names that contain a period.\n", "created_at" : { "$date" : "2006-11-16T09:34:12.000+0000" }, "updated_at" : { "$date" : "2012-04-25T11:28:13.022+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e955f627d84c8d6c88d" }, "external_id" : "VELOCITY-712", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Context clone() method doesn't do a deep cloning as mentioned in the javadoc", "desc" : "Looking at the code it does:\n\n{noformat}\n    public Object clone()\n    {\n        VelocityContext clone = null;\n        try\n        {\n            clone = (VelocityContext) super.clone();\n            clone.context = new HashMap(context);\n        }\n        catch (CloneNotSupportedException ignored)\n        {\n        }\n        return clone;\n    }\n{noformat}\n\nnew HashMap() will not perform deep cloning but only shallow cloning.\n", "created_at" : { "$date" : "2009-03-11T10:02:28.598+0000" }, "updated_at" : { "$date" : "2012-04-25T11:32:10.284+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e955f627d84c8d6c89a" }, "external_id" : "VELOCITY-715", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Leaked object in FileResourceLoader#templatePaths", "desc" : " org.apache.velocity.runtime.resource.loader.FileResourceLoader#templatePaths has stored templatename and real file path permanently.So if VelocityEngine#getTemplate(String) has called by too many files, #templatePaths have been enlarged. \n\nBellow my test results.\n----------------------------------------\n2009-05-08 19:16:54,571 INFO  [FileResourceLoaderLeakedObjectTest] count: 000,000 total: 002,696,488\n2009-05-08 19:19:23,381 INFO  [FileResourceLoaderLeakedObjectTest] count: 065,536 total: 014,689,896\n2009-05-08 19:22:03,782 INFO  [FileResourceLoaderLeakedObjectTest] count: 131,072 total: 025,374,944\n2009-05-08 19:24:14,756 INFO  [FileResourceLoaderLeakedObjectTest] count: 196,608 total: 036,282,696\n2009-05-08 19:26:37,864 INFO  [FileResourceLoaderLeakedObjectTest] count: 262,144 total: 046,776,168\n2009-05-08 19:28:55,090 INFO  [FileResourceLoaderLeakedObjectTest] count: 327,680 total: 057,119,560\n2009-05-08 19:31:37,524 INFO  [FileResourceLoaderLeakedObjectTest] count: 393,216 total: 069,858,824\n2009-05-08 19:34:10,425 INFO  [FileResourceLoaderLeakedObjectTest] count: 458,752 total: 080,019,920\n2009-05-08 19:36:52,788 INFO  [FileResourceLoaderLeakedObjectTest] count: 524,288 total: 090,093,168\n2009-05-08 19:39:13,662 INFO  [FileResourceLoaderLeakedObjectTest] count: 589,824 total: 097,385,776\n2009-05-08 19:41:54,621 INFO  [FileResourceLoaderLeakedObjectTest] count: 655,360 total: 107,387,792\n2009-05-08 19:44:31,601 INFO  [FileResourceLoaderLeakedObjectTest] count: 720,896 total: 117,451,912\n2009-05-08 19:47:08,890 INFO  [FileResourceLoaderLeakedObjectTest] count: 786,432 total: 137,151,792\n2009-05-08 19:49:44,924 INFO  [FileResourceLoaderLeakedObjectTest] count: 851,968 total: 147,277,856\n\n", "created_at" : { "$date" : "2009-05-08T12:00:01.208+0000" }, "updated_at" : { "$date" : "2012-04-25T11:36:58.796+0000" }, "creator_id" : { "$oid" : "5b7d38b4e9214a0d1608d7de" }, "reporter_id" : { "$oid" : "5b7d38b4e9214a0d1608d7de" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e965f627d84c8d6c8ad" }, "external_id" : "VELOCITY-821", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "recursive call in velocity macro", "desc" : "template merge object : java.util.Map mergeObj \n\nMap node3 = new HashMap();\nnode3.put(\"cds_ip\", \"5\");\nnode3.put(\"ls_ip\", \"6\");\n\t\t\nMap node2 = new HashMap();\nnode2.put(\"cds_ip\", \"3\");\nnode2.put(\"ls_ip\", \"4\");\nnode2.put(\"test_node\", node3);\n\t\t\nMap node1 = new HashMap();\nnode1.put(\"cds_ip\", \"1\");\nnode1.put(\"ls_ip\", \"2\");\nnode1.put(\"test_node\", node2);\n\nMap node = new HashMap();\nnode.put('test_node', node1);\n\nMap mergeObj = new HashMap();\nmergeObj .put(\"rootName\", \"root\");\nmergeObj.put(\"response\", node);\n\nFor example, with the following template:\n\n#macro(recursive $col)\n\t#foreach($key in $col.keySet())\n\t\t#set($type = $col.get(\"$key\").class.getName())\n\t\t#if($type.lastIndexOf(\"Map\") > -1)\n\t\t\t<$key>\n\t\t\t#set($map = $col.get(\"$key\"))\n\t\t\t#recursive($map)\n\t\t\t</$key>\n\t\t#elseif($type.lastIndexOf(\"List\") > -1)\n\t\t\t#foreach($obj in $col.get(\"$key\"))\n\t\t\t<$key>\n\t\t\t#recursive($obj)\n\t\t\t</$key>\n\t\t\t#end\n\t\t#else\n\t\t\t<$key\">$col.get(\"$key\")</$key>\n\t\t#end\n\t#end\n#end\n<?xml version='1.0' encoding='utf-8'?>\t\t\n<$rootName>\n\t<response>\n\t#recursive($response)\n\t</response>\n</$rootName>\n\nThis call works as expected String:\n<?xml version='1.0' encoding='utf-8'?>\t\t\n<root>\n<response>\n  <test_node>\n      <cds_ip>1</cds_ip>\n      <ls_ip>2</ls_ip>\n      <test_node>\n          <cds_ip>3</cds_ip>\n          <ls_ip>4</ls_ip>\n          <test_node>\n              <cds_ip>5</cds_ip>\n              <ls_ip>6</ls_ip>\n          </test_node>\n      </test_node>\n  </test_node>\n</response>\n</root>\n\nThis call works as result String:\n<root>\n<response>\n  <test_node>\n      <cds_ip>1</cds_ip>\n      <test_node>\n          <cds_ip>3</cds_ip>\n          <test_node>\n              <cds_ip>5</cds_ip>\n              <ls_ip>6</ls_ip>\n          </test_node>\n          <ls_ip>6</ls_ip>\n      </test_node>\n      <ls_ip>6</ls_ip>\n  </test_node>\n</response>\n</root>\n\nmodify macro :\n#macro(recursive $col)\n\t#foreach($key in $col.keySet())\n\t\t#set($type = $col.get(\"$key\").class.getName())\n\t\t#if($type.lastIndexOf(\"Map\") < 0 && $type.lastIndexOf(\"List\") < 0)\n\t\t\t<$key\">$col.get(\"$key\")</$key>\n\t\t#end\n\t#end\n\t#foreach($key in $col.keySet())\n\t\t#set($type = $col.get(\"$key\").class.getName())\n\t\t#if($type.lastIndexOf(\"Map\") > -1)\n\t\t\t<$key>\n\t\t\t#set($map = $col.get(\"$key\"))\n\t\t\t#recursive($map)\n\t\t\t</$key>\n\t\t#elseif($type.lastIndexOf(\"List\") > -1)\n\t\t\t#foreach($obj in $col.get(\"$key\"))\n\t\t\t<$key>\n\t\t\t#recursive($obj)\n\t\t\t</$key>\n\t\t\t#end\n\t\t#end\n\t#end\n#end\n\n---I get expected result String after modified macro\n-- however modify macro have a problem\n-- It excute two times loopping\n-- Do velocity support recursive macro's ?", "created_at" : { "$date" : "2012-03-27T00:42:10.371+0000" }, "updated_at" : { "$date" : "2012-04-26T12:59:03.015+0000" }, "creator_id" : { "$oid" : "5b7d38b5e9214a0d1608d7df" }, "reporter_id" : { "$oid" : "5b7d38b5e9214a0d1608d7df" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [ "bug", "macro", "recursive" ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dba5f627d84c8d6ba19" }, "external_id" : "VELOCITY-191", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba18" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba1a" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d35d8e9214a0d1608d6c5" }, "desc" : "[copypaste from velocity-user mailing list]\nDate: Mon, 14 Jul 2003 01:52:11 -0700 (PDT)\nFrom: mailmur <mailmur@yahoo.com>\nSubject: UnicodeFileResourceLoader to support Win2k Notepad UTF-8 files\nContent-Type: text/plain; charset=us-ascii\n\nI discovered, that files saved with Win2k Notepad UTF-8 format always generated \nan extra ? character at the start of ISO-8859-1 output text. \n\nThis was due to lack of UTF8 BOM mark support in \nInputStreamReader/OutputStreamWriter classes.\n\nI then created a inputstream implementation to skip BOM mark to overcome this \nbug.\n\nPlease, find here a source + testprogram to see it for yourself. I created \nUnicodeFileResourceLoader to make all this transparent.\nhttp://koti.mbnet.fi/akini/java/unicodereader/\n\nI dont know what is the proper procedure to add this to Velocity core (if you \nfind this useful), but here it is. Feel free to change class package. Or is \nthis even the right list to announce such addition....\n\nHere is a link to Sun bugparade about the UTF-8 BOM problem: \nhttp://developer.java.sun.com/developer/bugParade/bugs/4508058.html", "reporter_id" : { "$oid" : "5b7d35d8e9214a0d1608d6c5" }, "title" : "UnicodeFileResourceLoader for Win2k Notepad UTF-8 files", "priority" : "Minor", "status" : "Closed", "environment" : "Operating System: All\nPlatform: All", "updated_at" : { "$date" : "2012-06-06T10:52:12.909+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2003-07-15T02:35:36.000+0000" } },
{ "_id" : { "$oid" : "5b904e985f627d84c8d6c8d5" }, "external_id" : "VELOCITY-775", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Hanging in jj_scan_token", "desc" : "I have the same issue as reported in VELOCITY-562, velocity hangs in method Parser.jj_scan_token().  I can reproduce it by running heavy load on my application for a few hours.\n\nCurrently running 1.6.3, I looked at the issues fixed in 1.6.4, VELOCITY-718 seems not related, but I will now upgrade to 1.6.4 and see if the same happens again.\n\nThe application is using velocity in up to 3 threads simultaneously, nothing is shared between threads, relevant stack traces from a thread dump are as follows, one thread is currently not inside velocity at all:\n\n\"1334671070@qtp-2060763463-85\" prio=6 tid=0x00000000181c5800 nid=0x6004 runnable [0x00000000110dd000]\n   java.lang.Thread.State: RUNNABLE\n\tat org.apache.velocity.runtime.parser.Parser.jj_scan_token(Parser.java:3340)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_56(Parser.java:2768)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_29(Parser.java:3000)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_8(Parser.java:2834)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_7(Parser.java:2878)\n\tat org.apache.velocity.runtime.parser.Parser.jj_2_7(Parser.java:2560)\n\tat org.apache.velocity.runtime.parser.Parser.Reference(Parser.java:1317)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:354)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1530)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:346)\n\tat org.apache.velocity.runtime.parser.Parser.Directive(Parser.java:888)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:373)\n\tat org.apache.velocity.runtime.parser.Parser.process(Parser.java:311)\n\tat org.apache.velocity.runtime.parser.Parser.parse(Parser.java:105)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1131)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1086)\n\tat org.apache.velocity.Template.process(Template.java:124)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:446)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:354)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1400)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:198)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\n\"1946923020@qtp-2060763463-4\" prio=6 tid=0x000000000c6dc000 nid=0x48a4 runnable [0x0000000013bcd000]\n   java.lang.Thread.State: RUNNABLE\n\tat org.apache.velocity.runtime.parser.Parser.jj_scan_token(Parser.java:3340)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_56(Parser.java:2768)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_29(Parser.java:3000)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_8(Parser.java:2834)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_7(Parser.java:2878)\n\tat org.apache.velocity.runtime.parser.Parser.jj_2_7(Parser.java:2560)\n\tat org.apache.velocity.runtime.parser.Parser.Reference(Parser.java:1317)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:354)\n\tat org.apache.velocity.runtime.parser.Parser.Directive(Parser.java:888)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:373)\n\tat org.apache.velocity.runtime.parser.Parser.process(Parser.java:311)\n\tat org.apache.velocity.runtime.parser.Parser.parse(Parser.java:105)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1131)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1086)\n\tat org.apache.velocity.Template.process(Template.java:124)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:446)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:354)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1400)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1380)\n\tat org.apache.velocity.runtime.VelocimacroFactory.initVelocimacro(VelocimacroFactory.java:202)\n\t- locked <0x00000000cd74bae8> (a org.apache.velocity.runtime.VelocimacroFactory)\n\tat org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:261)\n\t- locked <0x00000000cd950eb8> (a org.apache.velocity.runtime.RuntimeInstance)\n\tat org.apache.velocity.app.VelocityEngine.init(VelocityEngine.java:107)\n", "created_at" : { "$date" : "2010-08-27T07:57:07.619+0000" }, "updated_at" : { "$date" : "2012-09-12T16:45:52.525+0000" }, "creator_id" : { "$oid" : "5b7d38b7e9214a0d1608d7e1" }, "reporter_id" : { "$oid" : "5b7d38b7e9214a0d1608d7e1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e985f627d84c8d6c8d4" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "Velocity 1.6.3" },
{ "_id" : { "$oid" : "5b904e985f627d84c8d6c8dd" }, "external_id" : "VELOCITY-801", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.7 uses string interning", "desc" : "String interning consumes memory that cannot be reclaimed by the java runtime even if the velocity runtime singleton is being discarded.\n\nThis is an issue for server applications that use Velocity (e.g. we have a software product that may use tens of thousands of Velocity files to create content dynamically).", "created_at" : { "$date" : "2011-04-29T13:43:14.303+0000" }, "updated_at" : { "$date" : "2012-09-18T21:53:59.832+0000" }, "creator_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "reporter_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.7.x" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "n.a." },
{ "_id" : { "$oid" : "5b904e995f627d84c8d6c8e9" }, "external_id" : "VELOCITY-810", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parse Error Exception when using \"#execute(...)\" in template file - Velocity 1.6 and 1.7", "desc" : "The following lines in a .vm file trigger a ParseErrorException : Lexical error \n\n   /* (non-Javadoc)\n    * @see org.objectweb.telosys.service.ScreenService#execute(org.objectweb.telosys.screen.env.ScreenSession, org.objectweb.telosys.service.ServiceRequest, org.objectweb.telosys.service.ServiceResponse)\n    */\n   public View execute(ScreenSession screenSession, ServiceRequest request, ServiceResponse response) throws TelosysException\n   {\n   } \n\nThis template is used for Java code generation. It was working fine before Velocity 1.6\n\nThe problem cause seams to be \"#execute()\"  ( considered as a macro ? )\nWhen adding a Backslash before # the error doesn't occur\n", "created_at" : { "$date" : "2011-09-07T16:14:33.471+0000" }, "updated_at" : { "$date" : "2013-02-21T14:35:32.046+0000" }, "creator_id" : { "$oid" : "5b7d38b9e9214a0d1608d7e3" }, "reporter_id" : { "$oid" : "5b7d38b9e9214a0d1608d7e3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Java 1.5" },
{ "_id" : { "$oid" : "5b904e9a5f627d84c8d6c8ee" }, "external_id" : "VELOCITY-839", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error shown when parsing template", "desc" : "this piece of code generates a parsing error:\n\n#TM (10:15)\n\nthis is the error:\nEncountered \":\" at tst1[line 1, column 8] Was expecting one of: <RPAREN> ... <WHITESPACE> ... <WHITESPACE> ...\n\nDoes exist any way to ignore the error? any configuration file or some setting in the code?", "created_at" : { "$date" : "2013-02-15T17:16:39.390+0000" }, "updated_at" : { "$date" : "2013-02-21T19:02:52.491+0000" }, "creator_id" : { "$oid" : "5b7d38bae9214a0d1608d7e4" }, "reporter_id" : { "$oid" : "5b7d38bae9214a0d1608d7e4" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e9b5f627d84c8d6c8fa" }, "external_id" : "VELOCITY-840", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong version of the exported packages", "desc" : "When I try to install velocity-1.7.jar into Apache Karaf container it exports packages with wrong version:\n\nkaraf@trun> exports | grep -i velocity\n   216 org.apache.velocity; version=\"0.0.0\"    \n   216 org.apache.velocity.anakia; version=\"0.0.0\"\n   216 org.apache.velocity.app; version=\"0.0.0\"\n   216 org.apache.velocity.app.event; version=\"0.0.0\"\n   216 org.apache.velocity.app.event.implement; version=\"0.0.0\"\n   216 org.apache.velocity.app.tools; version=\"0.0.0\"\n   216 org.apache.velocity.context; version=\"0.0.0\"\n   216 org.apache.velocity.convert; version=\"0.0.0\"\n   216 org.apache.velocity.exception; version=\"0.0.0\"\n   216 org.apache.velocity.io; version=\"0.0.0\" \n   216 org.apache.velocity.runtime; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.defaults; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.directive; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.log; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.parser; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.parser.node; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.resource; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.resource.loader; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.resource.util; version=\"0.0.0\"\n   216 org.apache.velocity.runtime.visitor; version=\"0.0.0\"\n   216 org.apache.velocity.servlet; version=\"0.0.0\"\n   216 org.apache.velocity.texen; version=\"0.0.0\"\n   216 org.apache.velocity.texen.ant; version=\"0.0.0\"\n   216 org.apache.velocity.texen.defaults; version=\"0.0.0\"\n   216 org.apache.velocity.texen.util; version=\"0.0.0\"\n   216 org.apache.velocity.util; version=\"0.0.0\"\n   216 org.apache.velocity.util.introspection; version=\"0.0.0\"\n\nIt caused exception while installing bundles which depends on velocity bundle:\n\nReason: Missing Constraint: Import-Package: org.apache.velocity.app; version=\"[1.7.0,2.0.0)\"\n", "created_at" : { "$date" : "2013-02-27T20:39:12.459+0000" }, "updated_at" : { "$date" : "2013-02-27T20:41:51.725+0000" }, "creator_id" : { "$oid" : "5b7d38c0e9214a0d1608d7e5" }, "reporter_id" : { "$oid" : "5b7d38c0e9214a0d1608d7e5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "Exported-Packages", "OSGi," ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Apache Karaf 2.2.10" },
{ "_id" : { "$oid" : "5b904e9b5f627d84c8d6c8ff" }, "external_id" : "COLLECTIONS-113", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e9b5f627d84c8d6c900" }, "external_id" : "VELOCITY-333", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RuntimeInstance.init(Properties p) doesn't inherit defaults", "desc" : "A bug in ExtendedProperties causes RuntimeInstance.init(Properties p) to not \ninherit the defaults set to the Properties.\n\nThe bug:\n   http://issues.apache.org/bugzilla/show_bug.cgi?id=32204\n   (Please vote if you think this bug is significant)\n\nDiscussion of the effect on Velocity:\n   http://mail-archives.apache.org/eyebrowse/BrowseList?listName=velocity-\nuser@jakarta.apache.org&by=thread&from=936222\n\nOnce the bug in commons-collections is fixed, the new version must to put in \nthe Velocity dependencies.", "created_at" : { "$date" : "2005-01-09T23:20:43.000+0000" }, "updated_at" : { "$date" : "2013-05-02T02:28:36.353+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e9b5f627d84c8d6c8ff" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e9c5f627d84c8d6c90c" }, "external_id" : "COM-1715", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e9c5f627d84c8d6c90e" }, "external_id" : "COLLECTIONS-126", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e9c5f627d84c8d6c911" }, "external_id" : "COLLECTIONS-92", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e9c5f627d84c8d6c91d" }, "external_id" : "VELOCITY-434", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Commons pool implementation of the parser pool", "desc" : "Now that with [Velocity-433] we can swap out the parser pool, here is a parser pool that uses commons-pool (http://jakarta.apache.org/commons/pool/).\n\nIt is very primitive configuration and uses the same configuration name (parser.pool.size) for maximum number of elements in the pool.  It is also configured to grow when the maximum number is exhausted, which means that it scales the same way as the original parser, while actually providing some better pool support.\n\nOne of the nicest parts about this is that you can set your maximum instances to 0 and still get great performance.  The first time you need a parser, it will still add one even though the max is reached (since grow when exhausted is set).  Assuming the second time you need a parser is within a few seconds, that first instance is still there.\n\nHere is some sample code of how to use it your app.\n\nProperties configuration = new Properties();\nconfiguration.put(\"parser.pool.class\", \"com.lokitech.util.pool.CommonsParserPool\");\nconfiguration.put(\"parser.pool.size\", \"0\");\nVelocity.init(configuration);\n\nSince Velocity does not have an existing dependency on commons pool, I'm not sure this code will get packaged into the main distribution.  This code is licensed using ASL 2.0, so please reuse however you want as long as attribution is kept per the license.", "created_at" : { "$date" : "2006-03-05T06:26:20.000+0000" }, "updated_at" : { "$date" : "2013-05-02T02:28:57.240+0000" }, "creator_id" : { "$oid" : "5b7d38c2e9214a0d1608d7e6" }, "reporter_id" : { "$oid" : "5b7d38c2e9214a0d1608d7e6" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e9c5f627d84c8d6c91c" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b904e9c5f627d84c8d6c91c" }, "external_id" : "VELOCITY-433", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e9c5f627d84c8d6c91d" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "creator_id" : { "$oid" : "5b7d38c2e9214a0d1608d7e6" }, "desc" : "You cannot configure a class that does parser pooling, which makes it hard to balance between the # of instances to pool and the amount of heap space you're committing to velocity.\n\nThis patch refactors the parser pooling logic so that it behaves with a typical pool and parser factory concept.  The existing pool implementation class is left untouched and is wrapped by the new default class that implements the new ParserPool interface.\n\nBehavior and benchmark appears consistent.  Tried to format code correctly, but probably missed some spots.  One patch file and 2 new java files.  Will attach shortly.", "reporter_id" : { "$oid" : "5b7d38c2e9214a0d1608d7e6" }, "title" : "Replace parser pool", "priority" : "Minor", "status" : "Closed", "environment" : "", "updated_at" : { "$date" : "2013-05-02T02:28:57.245+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2006-03-05T05:57:29.000+0000" } },
{ "_id" : { "$oid" : "5b904e9e5f627d84c8d6c94a" }, "external_id" : "VELOCITY-612", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Support for #break directive inside foreach loops (includes a patch)", "desc" : "Here's a small patch that adds support for #break directive that can be used to break foreach-loops.\n\nCatch: #break does not verify that it is inside a foreach loop. If it is not, a RuntimeException of type BreakException is thrown during rendering and not caught properly. Testcases are also quite laughable but the directive seems to work OK.", "created_at" : { "$date" : "2008-08-17T17:17:06.236+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:16.196+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e9e5f627d84c8d6c949" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b904e9e5f627d84c8d6c949" }, "external_id" : "VELOCITY-531", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e9e5f627d84c8d6c94a" }, "effect" : "depends upon", "type" : "Dependent" } ], "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "desc" : "Look into the wishlist at http://www.oreillynet.com/onjava/blog/2007/03/velocity_15.html", "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "title" : "Some user feedback / wishes from the O'Reilly blog", "priority" : "Major", "status" : "Resolved", "updated_at" : { "$date" : "2013-05-02T02:29:16.192+0000" }, "issue_type" : "Wish", "resolution" : "Fixed", "created_at" : { "$date" : "2007-03-23T07:52:16.049+0000" } },
{ "_id" : { "$oid" : "5b904e9f5f627d84c8d6c965" }, "external_id" : "VELOCITY-848", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Please update DOAP to use full ASF name", "desc" : "The DOAP currently has\n\n<name>Anakia</name>\n\nThis should please be updated to\n\n<name>Apache Anakia</name>\n\nThanks!", "created_at" : { "$date" : "2014-04-11T01:02:07.254+0000" }, "updated_at" : { "$date" : "2014-04-29T16:08:07.571+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "http://svn.apache.org/repos/asf/velocity/site/site/doap_anakia.rdf" },
{ "_id" : { "$oid" : "5b904ea05f627d84c8d6c96d" }, "external_id" : "VELOCITY-851", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "refreshResource does not add resource to cache when using multiple resource loaders", "desc" : "The issue is seen when you have multiple resource loaders configured and and template can be loaded by a higher priority resource loader.\n\nThe resource is loaded by loadResource but it is never added to the globalCache (see ResourceManagerImpl.java).\n\nFor example if (see ResourceLoader.java):\nmodificationCheckInterval = 60\nisCachingOn = true \n\nWhen a change is detected by a higher priority resource loader it is loaded correctly the next time resource.requiresChecking() is true but it is never added to the globalCache or the existing entry in the cache is not evicted this causes the next request to use the resource from the cache which contains the template from a lower priority resource loader.\n\nThe expected result would be that the higher priority template is added to the globalCache and is used in subsequent requests.", "created_at" : { "$date" : "2014-07-08T23:09:34.416+0000" }, "updated_at" : { "$date" : "2014-07-08T23:13:15.556+0000" }, "creator_id" : { "$oid" : "5b7d38d1e9214a0d1608d7e7" }, "reporter_id" : { "$oid" : "5b7d38d1e9214a0d1608d7e7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea05f627d84c8d6c970" }, "external_id" : "VELOCITY-852", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NPE at org.apache.velocity.runtime.parser.node.SimpleNode.jjtGetChild(SimpleNode.java:183)", "created_at" : { "$date" : "2014-08-28T14:44:37.236+0000" }, "updated_at" : { "$date" : "2014-09-01T08:59:51.021+0000" }, "creator_id" : { "$oid" : "5b7d38d1e9214a0d1608d7e8" }, "reporter_id" : { "$oid" : "5b7d38d1e9214a0d1608d7e8" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea15f627d84c8d6c974" }, "external_id" : "VELOCITY-855", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Only first static class in context available", "desc" : "java :-\n\nBoth classes are in the .\n\nVelocityContext velocityContext = new VelocityContext();\n    // Utility objects\n    velocityContext.put(\"elementKind\", javax.lang.model.element.ElementKind.class);\n    velocityContext.put(\"typeKind\", javax.lang.model.type.TypeKind.class);\n\ntemplate.vm :-\n\n$elementKind.valueOf(\"ENUM\")\n$typeKind.valueOf(\"DECLARED\")\n\nThe second call fails. Commenting either works.", "created_at" : { "$date" : "2015-02-01T19:01:30.466+0000" }, "updated_at" : { "$date" : "2015-02-01T19:01:30.466+0000" }, "creator_id" : { "$oid" : "5b7d38d2e9214a0d1608d7e9" }, "reporter_id" : { "$oid" : "5b7d38d2e9214a0d1608d7e9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "JDK 1.8.0_25\nWindows\nMaven 3.2.1" },
{ "_id" : { "$oid" : "5b904ea25f627d84c8d6c976" }, "external_id" : "VELOCITY-858", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Class org.apache.velocity.util.introspection.UberspectImpl can not access a member of class com.google.common.collect.Iterables$8 with modifiers \"public\"", "desc" : "Probably related issue:\nhttps://issues.apache.org/jira/browse/VELOCITY-579\n\nI am passing result of guava's Iterables.transform() to velocity.\nAttempt to iterate over it throws access exception, as UberspectImpl tries to access method iterator on object's class\n\n           Class type = obj.getClass();\n...\n          Method iter = type.getMethod(\"iterator\", null);\n\n\nProblem is, that while iterator() method is public, class com.google.common.collect.Iterables$8 is private, so velocity can't access it's method through reflection.\n\nI suggest call Iterable::iterator() for classes implementing Iterable, instead of trying to access method through reflection, as you already do for Collection implementations.\n\nBasically, replace (in UberspectImpl::getIterator(Object, Info))\n\nelse if (obj instanceof Collection)\n        {\n            return ((Collection) obj).iterator();\n        }\n\nwith\n\nelse if (obj instanceof Iterable)\n        {\n            return ((Iterable) obj).iterator();\n        }", "created_at" : { "$date" : "2015-03-27T11:31:31.246+0000" }, "updated_at" : { "$date" : "2015-03-27T11:34:57.256+0000" }, "creator_id" : { "$oid" : "5b7d38d3e9214a0d1608d7ea" }, "reporter_id" : { "$oid" : "5b7d38d3e9214a0d1608d7ea" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Java 8, guava" },
{ "_id" : { "$oid" : "5b904ea25f627d84c8d6c97a" }, "external_id" : "VELOCITY-854", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problem Creating a Default description", "desc" : "Hi Experts\n\nI have an issue with creating a default description based on Issue Type and Based on what Option is selected from the Custom Field. (Single Select List)\n\nNot sure whether I am working on this correctly but I will explain what I expecting first.\n\nFor Issue Type: Service Request I have a Custom Field Called Request Type (3 Options are available) For each of these 3 options when one is selected I would like a different Description to display. Currently it doesn't actually change the description based on Custom Field\n\nThis is my code what I have placed in /opt/jira/atlassian-jira/WEB-INF/classes/templates/jira/issue/field/description_edit.vm\n\n{noformat}\n#disable_html_escaping()\n#customControlHeader ($action $field.id $i18n.getText($field.nameKey) $fieldLayoutItem.required $displayParameters $auiparams)\n## setup some additional parameters\n$!rendererParams.put(\"class\", \"long-field\")\n$!rendererParams.put(\"rows\", \"12\")\n$!rendererParams.put(\"wrap\", \"virtual\")\n\n#if ($mentionable)\n    $!rendererParams.put(\"mentionable\", true)\n    #if ($issue.project.key && $issue.project.key != \"\")\n        $!rendererParams.put(\"data-projectkey\", \"$!issue.project.key\")\n    #end\n    #if ($issue.key && $issue.key != \"\")\n        $!rendererParams.put(\"data-issuekey\", \"$!issue.key\")\n    #end\n#end\n\n##===============================\nSTART CUSTOMIZATION\n\n## SET INCIDENT\n#if (($issue.key == $null) && ($issue.getIssueTypeObject().getName() == \"Incident\"))\n        #set ($description = 'h6. Steps to Reproduce\n                # Navigate to ...\n                # Click on ...\n                \\\n                h6. Expected Results\n                \\\n                h6. Actual Results\n                \\\n                h6. Other Information (Browser, Browser Version, Environment)')\n        #set ($description = $description.replace('\\',''))\n\n\n## SET SERVICE REQUEST 'NONE'\n#elseif ((($issue.key == $null) && ($issue.getIssueTypeObject().getName() == \"Service Request\"))\n        *($ComponentAccessor.getCustomFieldManager().getCustomFieldObjectByValue(\"customfield_11504\")));\n                #if ($getcustomfieldObjectByValue == \"customfield_11504\").getOptionbyName == \"Enhancement\")\n                        #set ($description = 'Please select a Request Type')\n                #set ($description = $description.replace('\\',''))\n\n\n## SET SERVICE REQUEST 'DEPLOYMENT'\n        #elseif ($getcustomfieldObjectByValue == \"customfield_11504\").getOptionbyName == \"Deployment\")\n                #set ($description = 'h6. Name of System -\n                \\\n                h6. Environment -\n                \\\n                h6. Expected Delivery Date / Time -')\n        #set ($description = $description.replace('\\',''))\n\n## SET SERVICE REQUEST 'NEW ACCOUNT'\n        #elseif ($getcustomfieldObjectByValue == \"customfield_11504\").getOptionbyName == \"New Account\")\n                #set ($description = 'h6. Are you requesting for a new account to be set up?\n                \\\n                h6. Name of System -\n                \\\n                h6. Name of New User -\n                \\\n                h6. Contact Information (Email Address, Contact Number) -')\n        #set ($description = $description.replace('\\',''))\n        #end\n\n\n## SET CHANGE REQUEST\n#if (($issue.key == $null) && ($issue.getIssueTypeObject().getName() == \"Change Request\"))\n                #set ($description = 'h6. Change Logs\n                \\\n                h6. Deployment Script\n                \\\n                h6. Deployment Verification\n                \\\n                h6. Roll Back Plan')\n        #set ($description = $description.replace('\\',''))\n#end\n\n\n## END CUSTOMIZATION\n## =======================================\n\n## let the renderer display the edit component\n$rendererDescriptor.getEditVM($!description, $!issue.key, $!fieldLayoutItem.rendererType, $!field.id, $field.name, $rendererParams, false)\n#customControlFooter ($action $field.id $fieldLayoutItem.getFieldDescription() $displayParameters $auiparams)\n{noformat}\n\nI receive this error\n\n{noformat}\nAn error occurred whilst rendering this message. Please contact the administrators, and inform them of this bug. Details: ------- org.apache.velocity.exception.ParseErrorException: Encountered \"<EOF>\" at templates/jira/issue/field/description-edit.vm[line 80, column 110] Was expecting one of: \"(\" ... <RPAREN> ... <ESCAPE_DIRECTIVE> ... <SET_DIRECTIVE> ... \"##\" ... \"\\\\\\\\\" ... \"\\\\\" ... <TEXT> ... \"*#\" ... \"*#\" ... <STRING_LITERAL> ... <END> ... <IF_DIRECTIVE> ... <ELSEIF_DIRECTIVE> ... <ELSE_DIRECTIVE> ... <STOP_DIRECTIVE> ... <INTEGER_LITERAL> ... <FLOATING_POINT_LITERAL> ... <WORD> ... <BRACKETED_WORD> ... <IDENTIFIER> ... <DOT> ... \"{\" ... \"}\" ... at org.apache.velocity.Template.process(Template.java:141) at \n{noformat}\nFor incident and Change request these actually do change the description and these will not need to be changed or modified in anyway\n\nAny help would be appreciated as I am unsure whether this will work regardless of the error.\n\nRegards\n\nBrian", "created_at" : { "$date" : "2014-12-08T16:22:15.979+0000" }, "updated_at" : { "$date" : "2015-05-31T15:35:04.833+0000" }, "creator_id" : { "$oid" : "5b7d38d4e9214a0d1608d7eb" }, "reporter_id" : { "$oid" : "5b7d38d4e9214a0d1608d7eb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea35f627d84c8d6c985" }, "external_id" : "VELOCITY-860", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea35f627d84c8d6c986" }, "external_id" : "VELOCITY-847", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ANT build.xml can't download dependencies anymore.", "desc" : "The ANT build.xml can't download the dependencies anymore.", "created_at" : { "$date" : "2013-11-20T22:20:00.573+0000" }, "updated_at" : { "$date" : "2015-05-31T15:36:46.038+0000" }, "creator_id" : { "$oid" : "5b7d38d4e9214a0d1608d7ec" }, "reporter_id" : { "$oid" : "5b7d38d4e9214a0d1608d7ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7.x" ], "components" : [ "Engine", "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904ea35f627d84c8d6c985" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b904ea45f627d84c8d6c990" }, "external_id" : "VELOCITY-864", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Download and install Apache Rat task in preparation target for \"ant rat\"", "desc" : "Download and install the Apache Rat task in preparation target for \"ant rat\" instead of making the end-user do so.\n\nI'm not entirely certain if this works in other versions of ant, but it does work in ant 1.9.4 and is described in the rat documentation as \"the traditional way\"\n\n", "created_at" : { "$date" : "2015-05-30T04:22:19.582+0000" }, "updated_at" : { "$date" : "2015-06-03T03:20:44.328+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.x" ], "assignee_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea45f627d84c8d6c99f" }, "external_id" : "VELOCITY-861", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Improve parser modification and build documentation", "desc" : "Removed .../parser/build.sh as this functionality is an out-of-date version of what is found in the main ant build script \"parser\" task.\n\nAdded a license header and updated the portions of the build-and-modify-parser readme found in src/java/org/apache/velocity/runtime/parser/BUILD_README.txt.\n\nMoved improved src/java/org/apache/velocity/runtime/parser/BUILD_README.txt to build/BUILD_PARSER_README.txt as it is not obvious to go looking for documentation in src/java/org/apache/velocity/runtime/parser when you are modifying \"src/parser\" and running \"build/build.xml\"\n\nReplaced previous src/java/org/apache/velocity/runtime/parser/BUILD_README.txt with a simplified version that warns about directly modifying files here and points back to build/BUILD_PARSER_README.txt.\n", "created_at" : { "$date" : "2015-05-29T13:49:16.989+0000" }, "updated_at" : { "$date" : "2015-06-03T03:21:39.018+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Build", "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.x" ], "assignee_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea55f627d84c8d6c9ac" }, "external_id" : "VELOCITY-846", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Create a branch out of the 1.7 tag.", "desc" : "Please create a 1.7.x branch out of the 1.7 tag for the Velocity Engine, since there isn't any, but the trunk was already merged with 2.x changes.\n\nThis would allow us to send you patches easier.\n\nThanks in advance.", "created_at" : { "$date" : "2013-11-17T00:59:38.636+0000" }, "updated_at" : { "$date" : "2015-06-03T03:35:41.764+0000" }, "creator_id" : { "$oid" : "5b7d38d4e9214a0d1608d7ec" }, "reporter_id" : { "$oid" : "5b7d38d4e9214a0d1608d7ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine", "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7.x" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ea55f627d84c8d6c9ab" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b904ea65f627d84c8d6c9b4" }, "external_id" : "VELOCITY-818", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Case-insensitive matching ${object.methodName} == ${object.methodname} == ${object.methodName}", "desc" : "\nI thought I would share the following code with the Apache Velocity community. \n\nCurrently there is no easy way for Velocity to do a case-insensitive match on a property or method.  Below is my implementation to achieve this.\n\nVelocityContext velocityContext = new VelocityContext();\n{\n    context.put( \"aNumericValue\", \"1234567890\" );\n}\n\n\n| If String template =                 | Then String evaluatedTemplate =  |\n| ${aNumericValue}                     | 1234567890                       |\n| ${anumericvalue}                     | 1234567890                       |\n| ${anumericValue}                     | 1234567890                       |\n| ${aNumericvalue}                     | 1234567890                       |\n| ${aNumericValue.toString()}          | 1234567890                       |\n| ${anumericvalue.tostring()}          | 1234567890                       |\n\n\n\n-- Setup Snippet -- \nProperties p = new Properties();\n\np.setProperty( RuntimeConstants.INPUT_ENCODING, DEFAULT_ENCODING );\np.setProperty( RuntimeConstants.OUTPUT_ENCODING, DEFAULT_ENCODING ); \n\np.setProperty( RuntimeConstants.UBERSPECT_CLASSNAME,\n               \"custom.CustomSecureUberspector\" ); //$NON-NLS-1$\n\t       \nVelocityEngine engine = new VelocityEngine( p );\nengine.init(); \n\nRuntimeInstance ri = new RuntimeInstance();\nri.init( p );\nuberspector = (CustomSecureUberspector)ri.getUberspect();\n\n\n-- Setup Snippet -- \n\n\n-- Call Snippet -- \nVelocityContext velocityContext = new VelocityContext();\n{\n    context.put( \"aNumericValue\", \"1234567890\" );\n}\n\nEventCartridge eventCartridge = new EventCartridge();\neventCartridge.addEventHandler( new SloppyNameReferenceEventHandler( uberspector ) );\neventCartridge.addEventHandler( new NullValueReferenceInsertionEventHandler() );\neventCartridge.attachToContext( velocityContext );\n\nString template = \"${aNumericvalue}\";\nStringWriter velocityWriter = new StringWriter();\nvelocityEngine.evaluate( velocityContext, velocityWriter, \"LOG\", template );\nString evaluatedTemplate = velocityWriter.toString(); \n\n-- Call Snippet -- \n\n\n-- Supporting Classes Snippet -- \n\npackage custom;\n\nimport org.apache.velocity.util.introspection.SecureIntrospectorImpl;\nimport org.apache.velocity.util.introspection.SecureUberspector;\n\npublic class CustomSecureUberspector extends SecureUberspector\n{\n    public SecureIntrospectorImpl getSecureIntrospector()\n    {\n        return (SecureIntrospectorImpl)introspector;\n    }\n}\n\npackage custom;\n\nimport java.lang.reflect.Method;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.apache.velocity.app.event.InvalidReferenceEventHandler;\nimport org.apache.velocity.context.Context;\nimport org.apache.velocity.util.introspection.Info;\nimport org.apache.velocity.util.introspection.SecureIntrospectorImpl;\n\nimport custom.CustomSecureUberspector;\n\n@SuppressWarnings( { \"unused\" } )\npublic class SloppyNameReferenceEventHandler implements InvalidReferenceEventHandler\n{\n\n    protected CustomSecureUberspector uberspector;\n\n    public SloppyNameReferenceEventHandler( CustomSecureUberspector uberspector )\n    {\n        this.uberspector = uberspector;\n    }\n\n    @Override\n    public Object invalidGetMethod( Context context, String reference, Object object, String property, Info info )\n    {\n\n        try\n        {\n            return callMethod( object, property );\n\n        }\n        catch ( Exception e )\n        {\n            return null;\n        }\n\n    }\n\n\n    @Override\n    public boolean invalidSetMethod( Context context, String leftReference, String rightReference, Info info )\n    {\n        // Do nothing\n\n        return false;\n    }\n\n\n    @Override\n    public Object invalidMethod( Context context, String reference, Object object, String method, Info info )\n    {\n\n        try\n        {\n            return callMethod( object, method );\n        }\n        catch ( Exception e )\n        {\n            return null;\n        }\n\n    }\n\n    protected Object callMethod( Object object, String method )\n        throws Exception\n    {\n        if ( null == object || null == method )\n        {\n            return null;\n        }\n\n        List<String> possibleMethodMatches = findCaseInsensitiveMethodsForObject( object, method, \"get\" + method ); //$NON-NLS-1$\n\n        SecureIntrospectorImpl secureIntrospectorImpl = uberspector.getSecureIntrospector();\n\n        for ( String possibleMethodMatch : possibleMethodMatches )\n        {\n            if ( secureIntrospectorImpl.checkObjectExecutePermission( object.getClass(), possibleMethodMatch ) )\n            {\n                Method[] objectMethods = object.getClass().getMethods();\n                for ( int i = 0; i < objectMethods.length; i++ )\n                {\n                    if ( possibleMethodMatch.equals( objectMethods[i].getName() ) )\n                    {\n                        return objectMethods[i].invoke( object );\n                    }\n                }\n            }\n        }\n\n        return null;\n    }\n\n    @SuppressWarnings( \"static-method\" )\n    protected List<String> findCaseInsensitiveMethodsForObject( Object object, String ... methodNames )\n    {\n        List<String> methodMatches = new ArrayList<String>();\n\n        Method[] methods = object.getClass().getMethods();\n        for ( int i = 0; i < methods.length; i++ )\n        {\n\n            String objectMethodName = methods[i].getName();\n            String objectMethodNameInLowerCase = objectMethodName.toLowerCase();\n\n            for ( int j = 0; j < methodNames.length; j++ )\n            {\n                if ( objectMethodNameInLowerCase.equals( methodNames[j].toLowerCase() ) )\n                {\n                    methodMatches.add( objectMethodName );\n                }\n            }\n\n        }\n\n        return methodMatches;\n    }\n\n}\n\n\n    \npackage custom;\n\nimport org.apache.velocity.app.event.ReferenceInsertionEventHandler;\n\npublic class NullValueReferenceInsertionEventHandler implements ReferenceInsertionEventHandler\n{\n\n    @Override\n    public Object referenceInsert( String reference, Object value )\n    {\n\n        if ( null == value )\n        {\n        return String.valueOf( reference );\n        }\n\n        return value;\n\n    }\n}\n\n-- Supporting Classes Snippet -- \n", "created_at" : { "$date" : "2012-02-10T16:43:20.960+0000" }, "updated_at" : { "$date" : "2015-06-03T03:37:50.449+0000" }, "creator_id" : { "$oid" : "5b7d38dae9214a0d1608d7ed" }, "reporter_id" : { "$oid" : "5b7d38dae9214a0d1608d7ed" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "api-change" ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b904ea65f627d84c8d6c9ba" }, "external_id" : "VELOCITY-862", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Rebuilding parser using javacc 4.1 loses Node import", "desc" : "JavaCC 4.2 loses the \"org.apache.velocity.runtime.parser.node.Node\" import for JJTParserState.java when rebuilding the parser.\n\nAdding nodepackage=\"org.apache.velocity.runtime.parser.node\" to the jjtree ant task in the build script will add the following import automatically which is better than no import or manually adding the import later:\n\nimport org.apache.velocity.runtime.parser.*;\n\n\n\n", "created_at" : { "$date" : "2015-05-29T13:56:31.935+0000" }, "updated_at" : { "$date" : "2015-06-03T15:25:26.264+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Reopened", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "fix_versions" : [ "1.x" ], "assignee_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea75f627d84c8d6c9d3" }, "external_id" : "VELOCITY-859", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Syntax error in DOAP file release section", "desc" : "DOAP files can contain details of multiple release Versions, however each must be listed in a separate release section, for example:\n\n<release>\n      <Version>\n        <name>Apache XYZ</name>\n        <created>2015-02-16</created>\n        <revision>1.6.2</revision>\n      </Version>\n</release>\n<release>\n      <Version>\n        <name>Apache XYZ</name>\n        <created>2014-09-24</created>\n        <revision>1.6.1</revision>\n      </Version>\n</release>\n\nPlease can the project DOAP be corrected accordingly?\n\nThanks.", "created_at" : { "$date" : "2015-05-08T17:32:04.109+0000" }, "updated_at" : { "$date" : "2015-06-12T01:14:48.507+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_links" : [  ], "environment" : "http://svn.apache.org/repos/asf/velocity/site/site/doap_engine.rdf" },
{ "_id" : { "$oid" : "5b904ea85f627d84c8d6c9da" }, "external_id" : "VELOCITY-873", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Subtraction without spaces results in parse error", "desc" : "This works as expected:\n{noformat}\n## @noparams\n\n#set ($list = [\"a\", \"b\", \"c\"])\n#set ($num = $list.size()+1)\n<p>$num</p>\n{noformat}\n\nHowever, changing it to subtraction results in a {{ParseErrorException}}:\n{noformat}\n## @noparams\n\n#set ($list = [\"a\", \"b\", \"c\"])\n#set ($num = $list.size()-1)\n<p>$num</p>\n{noformat}\n\nThe error message given in atlassian-confluence.log:\n{noformat}\norg.apache.velocity.exception.ParseErrorException: Encountered \"-1\" at getRenderedContent[line 4, column 26]\nWas expecting one of:\n    <RPAREN> ...\n    <WHITESPACE> ...\n    \"-\" ...\n    \"+\" ...\n    \"*\" ...\n    \"/\" ...\n    \"%\" ...\n    <LOGICAL_AND> ...\n    <LOGICAL_OR> ...\n    <LOGICAL_LT> ...\n    <LOGICAL_LE> ...\n    <LOGICAL_GT> ...\n    <LOGICAL_GE> ...\n    <LOGICAL_EQUALS> ...\n    <LOGICAL_NOT_EQUALS> ...\n    <DOT> ...\n\n        at org.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1202)\n        at org.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1164)\n        at org.apache.velocity.app.VelocityEngine.evaluate(VelocityEngine.java:219)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.writeRenderedContent(VelocityUtils.java:148)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:130)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:117)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:113)\n        at com.atlassian.confluence.macro.GenericVelocityMacro.execute(GenericVelocityMacro.java:101)\n~~~snipped~~~\n{noformat}", "created_at" : { "$date" : "2016-05-09T03:46:02.565+0000" }, "updated_at" : { "$date" : "2016-05-09T08:16:49.268+0000" }, "creator_id" : { "$oid" : "5b7d38dfe9214a0d1608d7ee" }, "reporter_id" : { "$oid" : "5b7d38dfe9214a0d1608d7ee" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ea85f627d84c8d6c9d9" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "VTL in user macro in Atlassian Confluence 5.9.4" },
{ "_id" : { "$oid" : "5b904ea85f627d84c8d6c9d9" }, "external_id" : "VELOCITY-874", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904ea85f627d84c8d6c9da" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d38dfe9214a0d1608d7ee" }, "desc" : "This works as expected:\n{noformat}\n## @noparams\n\n#set ($n = 5)\n#set ($m = $n+1)\n<p>$m</p>\n{noformat}\n\nOutput: {{<p>6</p>}}\n\nHowever, subtraction doesn't work:\n{noformat}\n## @noparams\n\n#set ($n = 5)\n#set ($m = $n-1)\n<p>$m</p>\n{noformat}\n\nOutput: {{<p>$m</p>}}\n\nFrom [SO Q&A #15448108|http://stackoverflow.com/questions/15448108/subtraction-is-not-working-with-velocity-template], it appears that this behavior is due to the parser treating the hyphen/dash/minus-sign as part of the identifier, but certainly an exception should be made for when the \"identifier\" ends with only digits and/or hyphens.\n\nAnother case:\n{noformat}\n## @noparams\n\n#set ($n = 5)\n#set ($m = $n- 1)\n<p>$m</p>\n{noformat}\n\nIn this case we get an all too familiar {{ParseErrorException}}:\n{noformat}\norg.apache.velocity.exception.ParseErrorException: Encountered \"1\" at getRenderedContent[line 4, column 16]\nWas expecting one of:\n    <RPAREN> ...\n    \"-\" ...\n    \"+\" ...\n    \"*\" ...\n    \"/\" ...\n    \"%\" ...\n    <LOGICAL_AND> ...\n    <LOGICAL_OR> ...\n    <LOGICAL_LT> ...\n    <LOGICAL_LE> ...\n    <LOGICAL_GT> ...\n    <LOGICAL_GE> ...\n    <LOGICAL_EQUALS> ...\n    <LOGICAL_NOT_EQUALS> ...\n\n        at org.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1202)\n        at org.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1164)\n        at org.apache.velocity.app.VelocityEngine.evaluate(VelocityEngine.java:219)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.writeRenderedContent(VelocityUtils.java:148)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:130)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:117)\n        at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedContent(VelocityUtils.java:113)\n        at com.atlassian.confluence.macro.GenericVelocityMacro.execute(GenericVelocityMacro.java:101)\n~~~snipped~~~\n{noformat}\n\nThis bug is related to (or possibly the same as) [bug 873|http://issues.apache.org/jira/browse/VELOCITY-873].", "reporter_id" : { "$oid" : "5b7d38dfe9214a0d1608d7ee" }, "title" : "Subtraction doesn't work as expected", "priority" : "Major", "status" : "Resolved", "environment" : "VTL in user macro in Atlassian Confluence 5.9.4", "updated_at" : { "$date" : "2016-05-09T08:18:24.693+0000" }, "issue_type" : "Bug", "resolution" : "Duplicate", "created_at" : { "$date" : "2016-05-09T03:58:51.557+0000" } },
{ "_id" : { "$oid" : "5b904ea95f627d84c8d6c9ec" }, "external_id" : "VELOCITY-809", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RuntimeInstance returns template with incorrect encoding (if not specified) when not initialized before", "desc" : "RuntimeInstance has \n\npublic Template getTemplate(String name)\n        throws ResourceNotFoundException, ParseErrorException\n{\n        return getTemplate(name, getDefaultEncoding());\n}\n\nso if RuntimeInstance was not initialized before this method was called then it provides default encoding (ENCODING_DEFAULT = \"ISO-8859-1\") for getDefaultEncoding() instead of those that was set using\n\n.setProperty(RuntimeConstants.INPUT_ENCODING, \"UTF-8\")\n\nand Template contents incorrectly loaded.\n\nThis is so because initialization is done one step after a call of getDefaultEncoding() inside method\n\npublic Template getTemplate(String name, String  encoding)\n        throws ResourceNotFoundException, ParseErrorException\n{\n        requireInitialization();\n\n        return (Template)\n                resourceManager.getResource(name,\n                    ResourceManager.RESOURCE_TEMPLATE, encoding);\n}\n\nSolution is to add requireInitialization(); before  return getTemplate(name, getDefaultEncoding()); line in the first method.\nOR\naccept encoding == null in the second method:\n\npublic Template getTemplate(String name)\n        throws ResourceNotFoundException, ParseErrorException\n{\n        return getTemplate(name, null);\n}\n\npublic Template getTemplate(String name, String  encoding)\n        throws ResourceNotFoundException, ParseErrorException\n{\n        requireInitialization();\n\n        if (encoding == null)\n                encoding = getDefaultEncoding();\n\n        return (Template)\n                resourceManager.getResource(name,\n                    ResourceManager.RESOURCE_TEMPLATE, encoding);\n}", "created_at" : { "$date" : "2011-08-16T11:40:06.128+0000" }, "updated_at" : { "$date" : "2016-07-15T07:48:50.196+0000" }, "creator_id" : { "$oid" : "5b7d38e5e9214a0d1608d7ef" }, "reporter_id" : { "$oid" : "5b7d38e5e9214a0d1608d7ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eaa5f627d84c8d6c9f1" }, "external_id" : "VELOCITY-716", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Configuring VelocityEngine used by DVSL", "desc" : "From the DVSL code we read that only the following VelocityEngine configuration parameters are supported:\n\n     *  <li>VM_LIBRARY</li>\n     *  <li>FILE_RESOURCE_LOADER_PATH</li>\n     *  <li>RUNTIME_LOG</li>\n     *  <li>RUNTIME_LOG_LOGSYSTEM</li>\n     *  <li>RUNTIME_LOG_LOGSYSTEM_CLASS</li>\n\nWhich means, among other things, that there are no posibility to use ResourceLoader other than default FileSystem. We use DVSL in web application, so filesystem is not the most confinient source of resources for us. Why cannot I use ClasspathResourceLoader?", "created_at" : { "$date" : "2009-05-14T18:49:58.724+0000" }, "updated_at" : { "$date" : "2016-07-15T13:45:25.279+0000" }, "creator_id" : { "$oid" : "5b7d38e6e9214a0d1608d7f0" }, "reporter_id" : { "$oid" : "5b7d38e6e9214a0d1608d7f0" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eaa5f627d84c8d6c9f9" }, "external_id" : "VELOCITY-739", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Do not throw exception for quiet references in strict reference checking mode", "desc" : "I used strict reference checking for the first time and discovered that it throws exceptions even for quiet references.\n\n<input class=\"signupInput\" type=\"text\" id=\"StxtFirstNames\"\nname=\"firstName\" value=\"$!user.firstName\"/>\n\norg.apache.velocity.exception.MethodInvocationException: Variable\n$user has not been set at layout/slide_login.vm[line 13, column 117]\n\nThis doesn't make sense to me.  If a template author designates a reference as quiet, it's explicitly not an error.  We're preventing the use of this convenient feature.\n\nIt's not a hard change to fix this.  Does it break backwards compatibility if we change this?\n\nIncidentally, there's an identical problem for InvalidReferenceEventHandler.  I'll file a separate issue.", "created_at" : { "$date" : "2009-10-16T17:17:43.118+0000" }, "updated_at" : { "$date" : "2016-07-15T15:32:24.412+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eaa5f627d84c8d6c9f8" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904eab5f627d84c8d6ca07" }, "external_id" : "VELOCITY-736", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eab5f627d84c8d6ca08" }, "external_id" : "VELOCITY-745", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Modify ClassMap.java to use getMethods() rather than get getDeclaredMethods()", "desc" : "The code that recurses up the super classes to find all public methods using getDeclaredMethods() is now redundant and can be replaced with a single call to getMethods() - this intrinsically provides all inherited public methods.", "created_at" : { "$date" : "2009-11-19T22:49:16.241+0000" }, "updated_at" : { "$date" : "2016-07-15T15:53:49.543+0000" }, "creator_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "reporter_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eab5f627d84c8d6ca07" }, "effect" : "incorporates", "type" : "Incorporates" } ], "environment" : "All" },
{ "_id" : { "$oid" : "5b904eac5f627d84c8d6ca14" }, "external_id" : "VELOCITY-761", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can not reference a property declared in a super-interface and implemented in a non-public class", "desc" : "Consider the following:\n\npublic interface MyUser extends java.security.Principal { \n     String getEmailAddress();\n }\n\nclass MyUserImpl implements MyUser {\n    public String getName() { ... }\n    public String getEmailAddress() { ... }\n}\n\nIf I put a MyUserImpl in my Velocity context, $user.emailAddress will resolve, but $user.name will not.\n\nThis is a problem with ClassMap#createMethodCache(). It ignores methods declared on the MyUserImpl class because the class is non-public, and it only looks up one level in the Interface hierarchy for methods defined on interfaces: so it will go up as far as the MyUser interface but not as far as the Principal interface.\n", "created_at" : { "$date" : "2010-05-12T05:36:47.812+0000" }, "updated_at" : { "$date" : "2016-07-17T07:59:22.845+0000" }, "creator_id" : { "$oid" : "5b7d38ece9214a0d1608d7f2" }, "reporter_id" : { "$oid" : "5b7d38ece9214a0d1608d7f2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.3" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Bug", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eac5f627d84c8d6ca13" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b904eac5f627d84c8d6ca2b" }, "external_id" : "VELOCITY-782", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "UNC Path support for Velocity", "desc" : "Add UNC Path support for the getTemplate function:\n\nHere an extract of the Hibiscus log file:\n...\n[Mon Oct 18 18:23:16 CEST 2010][INFO][de.willuhn.jameica.gui.internal.parts.BackgroundTaskMonitor.check] creating progress monitor for GUI\n[Mon Oct 18 18:23:16 CEST 2010][INFO][de.willuhn.jameica.gui.internal.parts.BackgroundTaskMonitor$2.run] activating progress monitor\n[Mon Oct 18 18:23:16 CEST 2010][INFO][de.willuhn.boot.BootLoader.resolve]   init service de.willuhn.jameica.services.VelocityService\n[Mon Oct 18 18:23:16 CEST 2010][INFO][de.willuhn.boot.BootLoader.resolve] used time to init de.willuhn.jameica.services.VelocityService: 285 millis\n[Mon Oct 18 18:23:16 CEST 2010][ERROR][de.willuhn.jameica.services.VelocityService$VelocityLogger.log] ResourceManager : unable to find resource 'de.willuhn.jameica.hbci.rmi.Umsatz.csv.vm' in any resource loader.\n[Mon Oct 18 18:23:16 CEST 2010][ERROR][de.willuhn.jameica.hbci.io.VelocityExporter.doExport] error while writing into export file\norg.apache.velocity.exception.ResourceNotFoundException: Unable to find resource 'de.willuhn.jameica.hbci.rmi.Umsatz.csv.vm'\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:452)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:335)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1102)\n\tat org.apache.velocity.app.VelocityEngine.getTemplate(VelocityEngine.java:549)\n\tat de.willuhn.jameica.hbci.io.VelocityExporter.doExport(VelocityExporter.java:107)\n\tat de.willuhn.jameica.hbci.gui.dialogs.ExportDialog$3.run(ExportDialog.java:193)\n\tat de.willuhn.jameica.gui.GUI$6.run(GUI.java:912)\n[Mon Oct 18 18:23:16 CEST 2010][ERROR][de.willuhn.jameica.messaging.LogMessageConsumer.handleMessage] Fehler beim Schreiben in die Export-Datei\n...", "created_at" : { "$date" : "2010-10-21T13:54:46.131+0000" }, "updated_at" : { "$date" : "2016-07-17T08:07:54.243+0000" }, "creator_id" : { "$oid" : "5b7d38ede9214a0d1608d7f5" }, "reporter_id" : { "$oid" : "5b7d38ede9214a0d1608d7f5" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Jameica 1.10 + Hibiscus 1.12\nWindows 7 Ultimate x64\nWHS" },
{ "_id" : { "$oid" : "5b904ead5f627d84c8d6ca38" }, "external_id" : "VELOCITY-808", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Proposal to add ability to pass variables to #parse()", "desc" : "I think it would be very useful to be able to pass variables to #parse(), just like to #macro():\n\n#parse(\"tpl.vm\" $var1 $var2 $var3)\n\nThis would add $var's to a local scope of \"tpl.vm\".\n\nCurrent approach of adding vars to a parent template above pollutes global namespace.", "created_at" : { "$date" : "2011-08-02T17:01:20.895+0000" }, "updated_at" : { "$date" : "2016-07-17T11:25:11.931+0000" }, "creator_id" : { "$oid" : "5b7d38efe9214a0d1608d7f6" }, "reporter_id" : { "$oid" : "5b7d38efe9214a0d1608d7f6" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "parse" ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ea55f627d84c8d6c9ab" }, "external_id" : "VELOCITY-816", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "fix_versions" : [ "1.7.x" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ea55f627d84c8d6c9ac" }, "effect" : "depends upon", "type" : "Dependent" } ], "creator_id" : { "$oid" : "5b7d38fde9214a0d1608d7f7" }, "reporter_id" : { "$oid" : "5b7d38fde9214a0d1608d7f7" }, "title" : "Upgrade commons-lang from 2.4 to 2.6 for Velocity 1.x.", "priority" : "Major", "status" : "Reopened", "updated_at" : { "$date" : "2016-07-18T12:21:21.046+0000" }, "issue_type" : "Improvement", "created_at" : { "$date" : "2012-01-26T18:28:13.110+0000" }, "assignee_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" } },
{ "_id" : { "$oid" : "5b904eae5f627d84c8d6ca56" }, "external_id" : "VELOCITY-800", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Subsequent invalid references cannot be resolved by InvalidReferenceEventHandler.invalidGetMethod", "desc" : "If $foo is a java.lang.String and a template tried to do $foo.bar, one can use an InvalidReferenceEventHandler to resolve bar into a value. However, if the template tries to do $foo.bar.baz, the last part cannot be resolved using an InvalidReferenceEventHandler. I'll attach an example test case.", "created_at" : { "$date" : "2011-04-15T12:17:20.876+0000" }, "updated_at" : { "$date" : "2016-07-18T20:21:21.942+0000" }, "creator_id" : { "$oid" : "5b7d3902e9214a0d1608d7f9" }, "reporter_id" : { "$oid" : "5b7d3902e9214a0d1608d7f9" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "method", "reference", "resolve", "invalid", "event" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eaf5f627d84c8d6ca5c" }, "external_id" : "VELOCITY-806", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't access map values when get(Object key) is overriden", "desc" : "I try to add a java.util.Map instance to Velocity context and access its values from a template, for example: ${map.get(\"someKey\")}\nIt doesn't work if use my own implementation of Map.get(Object key). It doesn't matter whether I implement Map from scratch, or subclass HashMap and override the get(Object key) metho. The get method is never called and the engine output is: ${map.get(\"someKey\")}. \n\nIt does work if I use my own subclass of HashMap without overriding the get(Object key) method.\nIt does work if I use my own implementation of Map with the get(String key) method added: the get(String key) is called instead of get(Object key).\nIt does work if I use my class that doesn't implement Map, but has a get(Object key) method.\n\nMore discussion of this on Velocity-User mailing list: http://old.nabble.com/Can%27t-acces-map-values-when-get%28%29-is-overriden-td31955214.html", "created_at" : { "$date" : "2011-07-01T08:48:13.748+0000" }, "updated_at" : { "$date" : "2016-07-18T20:36:52.320+0000" }, "creator_id" : { "$oid" : "5b7d3903e9214a0d1608d7fb" }, "reporter_id" : { "$oid" : "5b7d3903e9214a0d1608d7fb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb05f627d84c8d6ca64" }, "external_id" : "VELOCITY-828", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Bad links on web site", "desc" : "http://velocity.apache.org/how-it-works.html#Project Guidelines has links to the defunct Jakarta pages.", "created_at" : { "$date" : "2012-05-28T13:23:20.671+0000" }, "updated_at" : { "$date" : "2016-07-20T15:52:14.063+0000" }, "creator_id" : { "$oid" : "5b7d3904e9214a0d1608d7fc" }, "reporter_id" : { "$oid" : "5b7d3904e9214a0d1608d7fc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb05f627d84c8d6ca6a" }, "external_id" : "VELOCITY-826", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "OutOfMemoryError using #parse and resource.loader.cache off", "desc" : "I was testing a template collection that uses #parse inside some #foreach, which worked all fine inside eclipse but crashed when used in the stand-alone application running with a low heap setting with an OutOfMemoryError: Java heap space. I was able overcome this by setting the <loader>.resource.loader.cache to  \"true\".\n\nStill I wanted to let you know about this as it may be an indicator of a resource management issue of sorts anyway. The parsed resource is constant, with caching off it gets reported as found and loaded by the ResourceManager for each iteration (some 6000 times in the example). I understand that without caching it gets loaded every time, but why do the  previously loaded instances keep occupying memory? \n\nWhen published on teh dev mailing list, it was suggested to file this bug report.", "created_at" : { "$date" : "2012-05-23T19:33:43.924+0000" }, "updated_at" : { "$date" : "2016-07-20T16:32:59.635+0000" }, "creator_id" : { "$oid" : "5b7d3905e9214a0d1608d7fd" }, "reporter_id" : { "$oid" : "5b7d3905e9214a0d1608d7fd" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ], "environment" : "Windows, Java 1.6, low heap (-Xmx10m)" },
{ "_id" : { "$oid" : "5b904eb15f627d84c8d6ca79" }, "external_id" : "VELOCITY-835", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Macro Stack Traces Patch", "desc" : "Hey guys I made a patch to Velocity 1.7 to enable you to print out velocity stack traces. If you dump a stack trace in a Java function that was called from a velocity file, you usually see a bunch of calls to velocity parser functions like this in the Java stack trace:\n\n...\n        at org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:209)\n        at org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:280)\n        at org.apache.velocity.runtime.parser.node.ASTReference.evaluate(ASTReference.java:530)\n        at org.apache.velocity.runtime.parser.node.ASTExpression.evaluate(ASTExpression.java:62)\n        at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:85)\n        at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n        at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:87)\n        at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n        at org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:216)\n        at org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:312)\n        at org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:230)\n        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:207)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:342)\n        at org.apache.velocity.runtime.parser.node.ASTStringLiteral.value(ASTStringLiteral.java:330)\n...\n\nThe velocity stack trace created by this patches is much more informative:\n\nVelocity Stack Trace: Invocation of method 'getAvatarUrl' in class Member\n        at avatarUrl called at common/Macros.vm[line 426, column 29]\n        at simpleAvatarUrl called at common/Macros.vm[line 487, column 22]\n        at drawSimpleImage called at common/Macros.vm[line 487, column 3]\n        at simpleMemberAvatar called at site/photo_pane.vm[line 153, column 32]\n        at displayAvatarImage called at site/photo_pane.vm[line 162, column 3]\n\nThis sort of stack trace is very useful when debugging code and trying to figure out which sequence of macros called into the currently executing Java code that dumped out the Java stack trace. Please consider adding something like this to a future release of Velocity - it would be very useful!\n\nThanks,\nLuke", "created_at" : { "$date" : "2012-10-02T14:29:10.404+0000" }, "updated_at" : { "$date" : "2016-07-21T22:45:05.365+0000" }, "creator_id" : { "$oid" : "5b7d3906e9214a0d1608d7fe" }, "reporter_id" : { "$oid" : "5b7d3906e9214a0d1608d7fe" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "patch" ], "fix_versions" : [ "1.7.x" ], "issue_links" : [  ], "original_time_estimate" : 7200 },
{ "_id" : { "$oid" : "5b904eb15f627d84c8d6ca7e" }, "external_id" : "VELOCITY-837", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Arguments to InvalidReferenceEventHandler.invalidMethod are falsely ignored", "desc" : "The arguments to a method that is handled by InvalidReferenceEventHandler.invalidMethod are ignored. \nExample: $someObject.myOwnMethod(\"with\", \"some\", \"arguments\")\nThe arguments are ignored, as per ASTReference.java#306-308 [current HEAD revision]:\n    String methodName = ((ASTMethod) jjtGetChild(failedChild)).getMethodName();\n    result = EventHandlerUtil.invalidMethod(rsvc, context, name.toString(), previousResult, methodName, uberInfo);\nThis method fails to include the arguments of the current ASTMethod.", "created_at" : { "$date" : "2012-11-28T09:09:03.711+0000" }, "updated_at" : { "$date" : "2016-07-22T05:49:24.504+0000" }, "creator_id" : { "$oid" : "5b7d3902e9214a0d1608d7fa" }, "reporter_id" : { "$oid" : "5b7d3902e9214a0d1608d7fa" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb25f627d84c8d6ca86" }, "external_id" : "VELOCITY-838", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ForEach (Iteration) issue after upgrading from 1.5 to 1.7", "desc" : "After, upgrading to velocity engine `1.7` from `1.5` an issue occurs which was not with 1.5. To explain the issue I would have to show a code snippet:\n\n    #foreach($someVariable in $someCollection)\n     #foreach($anotherVariable in $someVariable.$anotherCollection)\n       $anotherVariable.someAttribute ## This expression print in the browser as is\n       ## but if I do this way\n       $anotherVariable.get(\"someAttribute\") ## works fine!\n     #end\n    #end\n\nThis is happening after the upgrade (which is in `1.7`) and if I rollback the upgrade (move back to `1.5`) then I don't have to it in other way which I mention in above code snippet.\n", "created_at" : { "$date" : "2012-12-20T14:08:12.843+0000" }, "updated_at" : { "$date" : "2016-07-22T06:19:40.331+0000" }, "creator_id" : { "$oid" : "5b7d3908e9214a0d1608d7ff" }, "reporter_id" : { "$oid" : "5b7d3908e9214a0d1608d7ff" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ], "environment" : "Tomcat 6, JDK 1.6" },
{ "_id" : { "$oid" : "5b904eb35f627d84c8d6ca8d" }, "external_id" : "VELOCITY-842", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Could I export excel report that having excel chart by velocity?", "desc" : "hello \n\nCould I export excel report that having excel chart by velocity?", "created_at" : { "$date" : "2013-05-24T01:20:33.678+0000" }, "updated_at" : { "$date" : "2016-07-22T06:22:24.532+0000" }, "creator_id" : { "$oid" : "5b7d3909e9214a0d1608d800" }, "reporter_id" : { "$oid" : "5b7d3909e9214a0d1608d800" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb35f627d84c8d6ca93" }, "external_id" : "VELOCITY-877", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Access to critical fields/methods allows execution of arbitrary code ('Template Injection')", "desc" : "It is possible to reference certain fields/methods, which eventually allow the execution of arbitrary methods.\n\nFor example, by utilizing the '{{class}}' field or '{{getClass()}}' method of any variable, it is possible to get the variable's class object. This can be extended to get arbitrary class objects and execute arbitrary methods.\n\nFor example, the following statement results in the execution of the '{{xterm}}':\n{code}\n$var.class.class.forName('java.lang.Runtime').getRuntime().exec('xterm').waitFor()\n{code}\n\nAs a standalone:\n\n{code:java}\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.app.Velocity;\nimport org.apache.velocity.context.Context;\n\npublic class VelocityTest {\n\n\tpublic static void main(String[] args) {\n\t\tContext context = new VelocityContext();\n\t\tcontext.put(\"var\", \"foo\");\n\t\tString instring = \"$var.class.class.forName('java.lang.Runtime').getRuntime().exec('xterm').waitFor()\";\n\t\tVelocity.evaluate(context, null, \"templateName\", instring);\n\t}\n\n}\n{code}\n\nThis issue has already been made public in the past by James Kettle in August 2015 (see http://blog.portswigger.net/2015/08/server-side-template-injection.html#Velocity) and via CVE-2015-5603 (see https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5603) and possibly others.", "created_at" : { "$date" : "2016-08-15T15:26:09.436+0000" }, "updated_at" : { "$date" : "2016-08-15T15:39:09.241+0000" }, "creator_id" : { "$oid" : "5b7d390ae9214a0d1608d801" }, "reporter_id" : { "$oid" : "5b7d390ae9214a0d1608d801" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "security" ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb45f627d84c8d6ca9b" }, "external_id" : "VELOCITY-750", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "org.apache.velocity.runtime.RuntimeInstance initialization is not ThreadSafe", "desc" : "Two threads call Velocity.evaluate() method.\nCall RuntimeInstance.parse() and requireInitialization() method.\nOne thread trying make initialization, set \"initializing\" to true and the other thread does not wait until initialization is done and go on.\nAt next line Parser parser = (Parser) parserPool.get() is NullPointerException thrown.\n", "created_at" : { "$date" : "2009-12-23T11:12:17.606+0000" }, "updated_at" : { "$date" : "2016-11-07T09:12:30.994+0000" }, "creator_id" : { "$oid" : "5b7d390be9214a0d1608d802" }, "reporter_id" : { "$oid" : "5b7d390be9214a0d1608d802" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.x", "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7", "1.6.x" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eb45f627d84c8d6ca9a" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Vista, Java 1.6" },
{ "_id" : { "$oid" : "5b904dd35f627d84c8d6bbdf" }, "external_id" : "VELOCITY-621", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Engine" ], "fix_versions" : [ "2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dd35f627d84c8d6bbe1" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d390ee9214a0d1608d803" }, "desc" : "I know that it has been discussed one year ago in  VELOCITY-392\n\nbut there is need for at least a workaround for people who are forced to use slf4j.\nFor example other frameworks did already switch like Hibernate.\nSo there is now definitely need for something to enable Velocity to run without errors in a environment with log4j-over-slf4j. ", "reporter_id" : { "$oid" : "5b7d390ee9214a0d1608d803" }, "title" : "Update to SLF4J or workaround?", "priority" : "Major", "status" : "Closed", "original_time_estimate" : 0, "updated_at" : { "$date" : "2016-11-07T09:12:31.481+0000" }, "issue_type" : "New Feature", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "created_at" : { "$date" : "2008-10-07T16:13:54.012+0000" } },
{ "_id" : { "$oid" : "5b904eb55f627d84c8d6cac3" }, "external_id" : "VELOCITY-787", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Write to multiple files, controlled by template directives", "desc" : "For some purposes, such as code generation, it would be very desirable to output to multiple files from the same context. For example, to generate code for a C++ class, two files must be generated - a header and implementation file. Rendering could be driven by the same context in both cases, which would desribe the class name, method signatures, etc. Currently this must be done by running the engine twice - once with a header template and again with an implementation file template.\n\nFurthermore, it would desirable to determine the output file names during rendering, based on a combination of template directives and data in the context. To use the code generation example, the header and implementation file names would be determined by the name of the class to be generated.\n\nThis is not possible with the current method signature of Directive: \n    public boolean render(InternalContextAdapter context, Writer writer, Node node) \nAn output directive would want to change the writer to a different instance of FileWriter, for instance. But since Java passes object references by value, the writer object cannot be replaced.\n\nThe proposal is to provide a method to install a new instance of Writer during rendering of a template. This would support both writing multiple outputs in one run of the engine as well as controlling the file names of the outputs.", "created_at" : { "$date" : "2010-11-05T14:54:50.935+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:00.018+0000" }, "creator_id" : { "$oid" : "5b7d3910e9214a0d1608d804" }, "reporter_id" : { "$oid" : "5b7d3910e9214a0d1608d804" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "All environments" },
{ "_id" : { "$oid" : "5b904eb65f627d84c8d6cad2" }, "external_id" : "VELOCITY-870", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Exception displayed when trying to loop over an Iterable private class", "desc" : "Specifically I got the following failure (see also https://java.net/jira/browse/TRUEVFS-158):\n\n{noformat}\n...\nCaused by: java.lang.IllegalAccessException: Class org.apache.velocity.util.introspection.UberspectImpl can not access a member of class net.java.truevfs.access.TFileSystem$Stream with modifiers \"public\"\nat sun.reflect.Reflection.ensureMemberAccess(Reflection.java:109)\nat java.lang.reflect.AccessibleObject.slowCheckMemberAccess(AccessibleObject.java:261)\nat java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:253)\nat java.lang.reflect.Method.invoke(Method.java:599)\nat org.apache.velocity.util.introspection.UberspectImpl.getIterator(UberspectImpl.java:158)\n{noformat}\n\nThe problem as I understand it is that TrueVFS returns a private class and Velocity shouldn't try to call iterator() on it since it's private.\n\nRight now the UberspectImpl code does this:\n\n{code}\n            Class type = obj.getClass();\n            try\n            {\n                Method iter = type.getMethod(\"iterator\", null);\n                Class returns = iter.getReturnType();\n                if (Iterator.class.isAssignableFrom(returns))\n                {\n                    try\n                    {\n                        return (Iterator)iter.invoke(obj, null);\n...\n{code}\n\nInstead, it could continue to do this but if the method is private then it could also fallback to something like the following:\n\n{code}\nClass type = Iterable.class;\nif (obj instanceof Iterable) {\n  Method iter = type.getMethod(\"iterator\", null);\n  return (Iterator) iter.invoke(obj, null);\n}\n{code}\n", "created_at" : { "$date" : "2015-12-04T12:43:34.728+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:09.392+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.x", "2.0", "1.7.x" ], "assignee_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904eb65f627d84c8d6cad1" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904eb75f627d84c8d6cade" }, "external_id" : "VELOCITY-824", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong pom in velocity trunk", "desc" : "The current velocity trunk points to the wrong velocity master version pom. ", "created_at" : { "$date" : "2012-05-05T16:44:53.213+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:12.497+0000" }, "creator_id" : { "$oid" : "5b7d3915e9214a0d1608d805" }, "reporter_id" : { "$oid" : "5b7d3915e9214a0d1608d805" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0" ], "assignee_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_links" : [  ], "environment" : "Linux, velocity trunk" },
{ "_id" : { "$oid" : "5b904eb75f627d84c8d6cae8" }, "external_id" : "VELOCITY-788", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update Velocity docs to reflect changes to structure of Velocity 2.0", "desc" : "Velocity packages projects, in this case Velocity Engine, changed structure a lot after refactoring to use Maven as a build tool.\nThe site should be updated to guide the user to use the best dependency/jar.", "created_at" : { "$date" : "2010-11-24T15:30:56.835+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:20.608+0000" }, "creator_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "reporter_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0" ], "assignee_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_links" : [  ], "original_time_estimate" : 0 },
{ "_id" : { "$oid" : "5b904eb85f627d84c8d6caf4" }, "external_id" : "VELOCITY-650", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Context should implement java.util.Map", "desc" : "The VelocityContext object should implement the java.util.Map interface.\n\n", "created_at" : { "$date" : "2008-12-02T09:29:12.016+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:23.135+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eb95f627d84c8d6cb00" }, "external_id" : "VELOCITY-702", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "fileloader in front of a classpath loader doesn't respond to runtime addition of template", "desc" : "I'm using a file resource loader followed by a classpath resource loader.  I want the templates in the file location to override the templates on the classpath.  This works partially.  If a template with the same name is in both locations, it definitely picks up the one in the file system.  If I remove the filesystem template, during run time, the template on the classpath is then found.  So far, so good.  If I then, however, try to put the template back in the file system location, it is NOT picked up.\n\nNote, this is all during run time.  If I restart my app ( a web application -- not using the velocity servlet ), the filesystem template is again picked up.\n\n\nHere is my configuration:\n\n#resource.loader=class\n resource.loader=file, class\n\n# File resource loader information\n#\nfile.resource.loader.description=Velocity File Resource Loader\nfile.resource.loader.class=org.apache.velocity.runtime.resource.loader.FileResourceLoader\nfile.resource.loader.cache=true\nfile.resource.loader.modificationCheckInterval=1\nfile.resource.loader.path=/home/readyportal/Desktop/machineOneWorkspaces/bipSpace/BIP/src/wego/velocity/templates/\n\n#file.resource.loader.path=/home/readyportal/ReadyPortal/conf/velocity/templates/\n\n#\n# Class resource loader information\n#\nclass.resource.loader.description=Velocity Classpath Resource Loader\nclass.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\nclass.resource.loader.cache=true\nclass.resource.loader.modificationCheckInterval=1\n\n\nOther notes:\n\nIf I turn the caching off on the classpath resource loader ( i.e.\nchange only the class.resource.loader.cache to false in the above\nconfig ), everything works at runtime.\n\n", "created_at" : { "$date" : "2009-02-18T00:37:54.171+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:23.681+0000" }, "creator_id" : { "$oid" : "5b7d391ae9214a0d1608d806" }, "reporter_id" : { "$oid" : "5b7d391ae9214a0d1608d806" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7", "1.6.2" ], "issue_links" : [  ], "environment" : "Linux, Sun Java 1.5" },
{ "_id" : { "$oid" : "5b904eb95f627d84c8d6cb0b" }, "external_id" : "VELOCITY-701", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "migrating from 1.4 to 1.6.1 iteration over a List no longer works", "desc" : "I have a template that references a List returned by a method on an Enum.  The method is defined as an abstract member of the enum.  This used to work on 1.4, but doesn't work on 1.6.1  I'm able to get it to work on 1.6.1 by changing the abstract method to a regular method of the Enum, which is then overridden by each instance of the enum.  Here's the code that doesn't work.  \n\nAgain, it seems to be the abstract modifier, becuase if I change that method to something like\n\npublic List getMyList() { return new ArrayList(); }\n\nAnd then just override it in my enum instances, everything works fine.  \n\n\npublic enum Thing {\n\n           NUMBER_ONE(  ){\n                       public List<String> getInnerThings() {\n                               //initialize innerThings if this is first time\n                               if ( this.innerThings == null ) {\n                                       innerThings = new ArrayList<String>();\n                                       innerThings.add( \"blah blah\" );\n                                       innerThings.add(\"blah blah\"  );\n\n                               }\n                               return innerThings;\n                       }\n               },\n                NUMBER_TWO(  ){\n                       public List<String> getinnerThings() {\n                               //initialize innerThings if this is first time\n                               if ( this.innerThings == null ) {\n                                       innerThings = new ArrayList<String>();\n                                       innerThings.add( \"blah blah\" );\n                                       innerThings.add(\"blah blah\"  );\n\n                               }\n                               return innerThings;\n\n                       }\n               },\n                NUMBER_THREE(  ){\n                       public List<String> getinnerThings() {\n                               if ( this.innerThings == null ) {\n                                       innerThings = new ArrayList<String>();\n                                       innerThings.add( \"blah blah\" );\n                                       innerThings.add(\"blah blah\"  );\n\n                               }\n                               return innerThings;\n\n                       }\n               };\n\n\n       List<String> innerThings;\n\n       //This was an abstract method, but Velocity 1.6 quite working with it.\n       public abstract List<String> getinnerThings();\n\n\n}", "created_at" : { "$date" : "2009-02-18T00:34:42.247+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:24.124+0000" }, "creator_id" : { "$oid" : "5b7d391ae9214a0d1608d806" }, "reporter_id" : { "$oid" : "5b7d391ae9214a0d1608d806" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7", "1.6.2" ], "issue_links" : [  ], "environment" : "Linux, Sun Java 1.5" },
{ "_id" : { "$oid" : "5b904eba5f627d84c8d6cb1b" }, "external_id" : "VELOCITY-691", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Change context event handling for better efficiency.", "desc" : "Change Context Event handling API so that The Context EventCartridge is initialized with the global EvenCartridge.  Then during rendering only the Context EventCartridge needs to be checked instead of potentially two.  Additionally, add addEventHandler method to the Velocity context to simply add an EventHandler to the existing EventCartridge.  Doing this would also initialize  the handler.  VelocityContext.setEventCartridge will replace the existing EventCartrige which means that global event handlers will also be replaced.\n\nThis change provides much faster event handling processing, and provides greater flexibility at the context level of controlling event handling.\n\n", "created_at" : { "$date" : "2009-02-10T10:53:35.213+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:30.232+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ebb5f627d84c8d6cb23" }, "external_id" : "VELOCITY-790", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ebb5f627d84c8d6cb24" }, "external_id" : "VELOCITY-789", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Reorganize dependencies in Velocity Engine Core", "desc" : "Currently Velocity Engine core depends on:\nCommons Lang\nCommons Collections\nAvalon LogKit\nApache Jakarta ORO\n\nLogKit and ORO should be removed, as they are obsolete. Commons Lang and Collections should be replaced or shaded.", "created_at" : { "$date" : "2010-11-29T13:53:42.952+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:34.123+0000" }, "creator_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "reporter_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0" ], "assignee_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904ebb5f627d84c8d6cb23" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904ebb5f627d84c8d6cb3b" }, "external_id" : "VELOCITY-784", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "troubles with backslash escaping", "desc" : "Is backslash escaping supposed to work inside string literals? I'm not sure it ever worked.\n\n#set($char = \"\\'\") $char ## => displays \\'\n##set($char = '\\'') $char ## => parser fails\n##set($char = \"\\\"\") $char ## => parser fails\n#set($char = \"\\\\\") $char ## => displays \\\\\n\n", "created_at" : { "$date" : "2010-10-27T15:44:34.473+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:39.763+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "any" },
{ "_id" : { "$oid" : "5b904ebd5f627d84c8d6cb43" }, "external_id" : "VELOCITY-791", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provided links towards subproject links", "desc" : "All the links towards project specific documentation pages should be permalinks, and not links involving version number (or development branch). We lack links towards last released versions.\n\n\n", "created_at" : { "$date" : "2010-12-26T21:53:36.682+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:43.171+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b904ebd5f627d84c8d6cb4d" }, "external_id" : "VELOCITY-781", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Generate code with JavaCC Maven plugin", "desc" : "Currently the JavaCC generated classes are generated and then committed.\nThey should be generated at build time and *not committed* using JavaCC Maven Plugin.", "created_at" : { "$date" : "2010-10-04T13:35:21.023+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:47.799+0000" }, "creator_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "reporter_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ebe5f627d84c8d6cb58" }, "external_id" : "VELOCITY-690", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Do not require block directive to have parenthesis", "desc" : "Block directives are currently required by the parser to contain parenthesis, which includes block macros. So\n\n#@foo \n#end\n\nis not allowed, and neither are custom block directives.  Removing this requirement makes the syntax consistent with line directives.\n\n", "created_at" : { "$date" : "2009-02-08T09:18:00.481+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:47.320+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ebf5f627d84c8d6cb60" }, "external_id" : "VELOCITY-695", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add comments for directive parameters", "desc" : "Add comments for Macro definitions so this type of thing is possible:\n\n#macro(foo        ## This is a comment about foo\n               $bar     ## This is the bar parameter\n                            ## It has man uses\n               $bar2  ## Another param\n              ) \n#end\n", "created_at" : { "$date" : "2009-02-15T14:27:54.428+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:50.356+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ebf5f627d84c8d6cb6d" }, "external_id" : "VELOCITY-696", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add index parameter to #foreach directive to define an index variable", "desc" : "Allow the following:\n\n#foreach($user in $users index $i)\n#end\n\nSo that $i holds the current index number of the iteration.  This is similar in functionality to the implicitly defined index variable, except this is more explicit.", "created_at" : { "$date" : "2009-02-15T15:14:12.007+0000" }, "updated_at" : { "$date" : "2016-11-07T09:13:51.626+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dba5f627d84c8d6ba18" }, "external_id" : "VELOCITY-451", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba19" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba1a" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dec5f627d84c8d6bde8" }, "effect" : "relates to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "desc" : "See http://koti.mbnet.fi/akini/java/unicodereader/ for a description of the problem and some example code.", "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "title" : "Do some investigation into UTF-16 and InputStream / Reader interfaces", "priority" : "Minor", "status" : "Resolved", "updated_at" : { "$date" : "2016-11-07T09:13:57.466+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2006-08-28T21:48:45.000+0000" } },
{ "_id" : { "$oid" : "5b904ec15f627d84c8d6cb8a" }, "external_id" : "VELOCITY-878", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "commons collections is required at run time", "desc" : "The Velocity upgrading page states that commons-lang, commons-collections and commons-logging aren't needed any more at runtime.\nHowever, commons collections is still required.  Here is the error received when using the latese version (4.1) of commons-collections jar:\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/commons/collections/ExtendedProperties\n\tat org.apache.velocity.runtime.RuntimeInstance.<init>(RuntimeInstance.java:175)\n\tat org.apache.velocity.app.VelocityEngine.<init>(VelocityEngine.java:60)\n...\n...\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.collections.ExtendedProperties\n\tat java.net.URLClassLoader.findClass(Unknown Source)\n\tat java.lang.ClassLoader.loadClass(Unknown Source)\n ", "created_at" : { "$date" : "2016-12-08T16:37:58.153+0000" }, "updated_at" : { "$date" : "2016-12-09T14:10:54.497+0000" }, "creator_id" : { "$oid" : "5b7d3928e9214a0d1608d808" }, "reporter_id" : { "$oid" : "5b7d3928e9214a0d1608d808" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec25f627d84c8d6cb9a" }, "external_id" : "VELOCITY-881", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Even handler didn't work when the reference appear in #if statement", "desc" : "My code like:\n----------------------------------------------------------------\npublic static void main(String[] args) {\n\n        VelocityEngine ve = new VelocityEngine();\n        ve.setProperty(Velocity.RESOURCE_LOADER, \"class\");\n        ve.setProperty(\"class.resource.loader.class\",\n                \"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\");\n        try {\n            ve.init();\n            Template tp = ve.getTemplate(\"my-template.xml\");\n\n            Context context = new VelocityContext();\n\n            // add my event handler\n            Map map = new HashMap<>();\n            map.put(\"deploy.domain\", \"offline\");\n            map.put(\"deploy_domain\", \"offline\");\n            map.put(\"provider.version\", \"1.0.0\");\n            map.put(\"provider_version\", \"1.0.0\");\n\n            EventCartridge eventCartridge = new EventCartridge();\n            eventCartridge.addEventHandler(new MyReferenceInsertionHandler(map));\n            eventCartridge.attachToContext(context);\n\n            StringWriter writer = new StringWriter();\n\n            tp.merge(context, writer);\n            System.out.println(writer.toString());\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n----------------------------------------------------------------\n\nMy template file to be converted by velocity like:\n----------------------------------------------------------------\n\n#if(${deploy.domain}=='testString')\n\t<bean class=\"MY_CLASS1\">\n\t\t<property name=\"MY_PROPERTY_NAME1\">\n\t\t\t<value>aaa</value>\n\t\t</property>\n\t</bean>\n#end \n\n<bean class=\"MY_CLASS2\">\n\t<property name=\"MY_PROPERTY_NAME2\">\n\t\t<value>${provider.version}</value>\n\t</property>\n</bean>\n\n----------------------------------------------\n\nMy got the output in fact:\n----------------------------------------------\n\n<bean class=\"MY_CLASS2\">\n<property name=\"MY_PROPERTY_NAME2\">\n\t<value>1.0.0</value>\n</property>\n</bean>\n----------------------------------------------\n\nMy expected output:\n----------------------------------------------\n<bean class=\"MY_CLASS1\">\n\t<property name=\"MY_PROPERTY1\">\n\t\t<value>aaa</value>\n\t</property>\n</bean>\n\n<bean class=\"MY_CLASS2\">\n<property name=\"MY_PROPERTY_NAME2\">\n\t<value>1.0.0</value>\n</property>\n</bean>\n----------------------------------------------\n\nMy suggestion to fix this bug:\n\nASTReference.java\n----------------------------------------------\nThe method before change:\npublic Object value(InternalContextAdapter context)\n        throws MethodInvocationException\n    {\n        return (computableReference ? execute(null, context) : null);\n    }\n\nAfter change:\npublic Object value(InternalContextAdapter context)\n        throws MethodInvocationException\n    {\n        Object value = this.computableReference?this.execute((Object)null, context):null;\n        if(value == null && !this.escaped) {\n            // process the value by EventHandlerUtil\n            value = EventHandlerUtil.referenceInsert(this.rsvc, context, this.literal, value);\n        }\n        return value;\n    }\n----------------------------------------------\n", "created_at" : { "$date" : "2017-07-17T12:47:53.497+0000" }, "updated_at" : { "$date" : "2017-07-18T02:49:40.270+0000" }, "creator_id" : { "$oid" : "5b7d3929e9214a0d1608d80a" }, "reporter_id" : { "$oid" : "5b7d3929e9214a0d1608d80a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "easyfix" ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ], "original_time_estimate" : 7200, "environment" : "it a common case. It nothing to do with a specified environment" },
{ "_id" : { "$oid" : "5b904ec35f627d84c8d6cba2" }, "external_id" : "VELOCITY-883", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unwanted character appear when encoding special character", "desc" : "I want generate text containing temperature so I try the following command:\n\n#if ($unit.matches(\".*Celsius\"))\\\n    \\\n#end#**# $unit \\\n\nbut I get the following output: **\n\nthe charater  is always displayed Regardless of the method used. \n\n\nVelocity config:\n\n\n{code:java}\n  <bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\">\n        <property name=\"resourceLoaderPath\" value=\"/WEB-INF/velocity/\"/>\n        <property name=\"velocityProperties\">\n            <value>\n                resource.loader=class\n             class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n                RuntimeConstants.UBERSPECT_CLASSNAME=LinkingUberspector.class.getCanonicalName()\n                LinkingUberspector.UBERSPECT_ARRAY_CLASSNAMES,UberspectImpl.class.getCanonicalName()\n                input.encoding, UTF-8\n                output.encoding, UTF-8\n            </value>\n        </property>\n    </bean>\n{code}\n\n", "created_at" : { "$date" : "2017-08-09T15:07:29.117+0000" }, "updated_at" : { "$date" : "2017-08-09T15:51:24.557+0000" }, "creator_id" : { "$oid" : "5b7d392ae9214a0d1608d80b" }, "reporter_id" : { "$oid" : "5b7d392ae9214a0d1608d80b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Bug", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Spring 4, Velocity 1.7" },
{ "_id" : { "$oid" : "5b904ec35f627d84c8d6cba7" }, "external_id" : "VELOCITY-886", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Loop causes OutOfMemoryError exception", "desc" : "The following template will cause an out of memory exception. \n\n#foreach($i in [0..67000000])\n#if($i == 0)\nhi\n#end\n#end\n\nI'm not sure why this happens as it's only a loop that only produces output on the first iteration. \nThe same loop works fine if I reduce the number of iterations by 1 order of magnitude.\n\nThe engine fails hard and no output is produced.", "created_at" : { "$date" : "2017-10-06T20:22:04.858+0000" }, "updated_at" : { "$date" : "2017-10-06T20:39:59.133+0000" }, "creator_id" : { "$oid" : "5b7d392ce9214a0d1608d80c" }, "reporter_id" : { "$oid" : "5b7d392ce9214a0d1608d80c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [ "perfomance", "exception-handling" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows 7 OS. Java -Xms1024m -Xmx1024m" },
{ "_id" : { "$oid" : "5b904ec45f627d84c8d6cbac" }, "external_id" : "VELOCITY-885", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : " Velocity-tools-layout  #block()#super() ", "desc" : " Python  Jinja2(http://jinja.pocoo.org/) Jinja2  *{% block title %} Default title {% endblock %}*   *{{ super() }}*  Layout \n*default-layout.html*\n{code:html}\n<head>\n  <title>{% block title %}Default title{% endblock %}</title>\n  {% block head %}\n    <link rel=\"stylesheet\" href=\"style.css\"/>\n  {% endblock %}\n</head>\n<body>\n{% block content %} {% endblock %}\n</body>\n{code}\n\n*child.html*\n{code:html}\n{% extends \"default-layout.html\" %}\n{% block title %}User Manager{% endblock %}\n{% block head %}\n   {{ super() }}\n   <style type=\"text/css\">\n   .important {font-size:20px;font-weight:bold;}\n   </style>\n{% endblock %}\n{% block content %}\n<h2>User Manager</h2>\n...\n{% endblock %}\n{code}\n\n */*  Web \n\n Velocity-1.7.x  *#block()  #end* *#override() #end*  *#super()* \n*default-layout.html*\n{code:html}\n<head>\n  <title>#block(\"title\") Default title #end</title>\n  #block(\"head\")\n    <link rel=\"stylesheet\" href=\"style.css\"/>\n  #end\n</head>\n<body>\n$!{ screen_content }\n</body>\n{code}\n\n*child.html*\n{code:html}\n#override(\"title\") User Manager #end\n#override(\"head\") \n   #super()\n   <style type=\"text/css\">\n   .important {font-size:20px;font-weight:bold;}\n   </style>\n#end\n\n<h2>User Manager</h2>\n...\n{code}\n\n Velocity-2.x  Jinja2  blocksuper \n\n Velocity \n", "created_at" : { "$date" : "2017-08-14T09:21:31.078+0000" }, "updated_at" : { "$date" : "2017-11-02T11:33:29.246+0000" }, "creator_id" : { "$oid" : "5b7d392de9214a0d1608d80d" }, "reporter_id" : { "$oid" : "5b7d392de9214a0d1608d80d" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec45f627d84c8d6cbb8" }, "external_id" : "VELOCITY-887", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Upgrade Apache Commons Lang dependency", "desc" : "Upgrade Apache Commons Lang dependency latest 3.7 from 3.5\r\n\r\nhttps://commons.apache.org/proper/commons-lang/download_lang.cgi", "created_at" : { "$date" : "2017-11-12T14:07:33.264+0000" }, "updated_at" : { "$date" : "2017-11-13T06:41:00.655+0000" }, "creator_id" : { "$oid" : "5b7d392ee9214a0d1608d80e" }, "reporter_id" : { "$oid" : "5b7d392ee9214a0d1608d80e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "2.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec55f627d84c8d6cbbc" }, "external_id" : "VELOCITY-888", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : " Velocity 2.0 missing OSGi bundle", "desc" : "The MANIFEST.MF in velocity-engine-core-2.0.jar doesn't contain the OSGi bundle information that used to be in velocity-1.7.jar. ", "created_at" : { "$date" : "2017-11-21T16:21:52.779+0000" }, "updated_at" : { "$date" : "2017-11-22T09:27:56.502+0000" }, "creator_id" : { "$oid" : "5b7d392fe9214a0d1608d80f" }, "reporter_id" : { "$oid" : "5b7d392fe9214a0d1608d80f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec65f627d84c8d6cbc0" }, "external_id" : "VELOCITY-884", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity$#{...}XSS", "desc" : "Velocity  *{color:red}$[!]{...}{color}*  *XSS* (< > ) Web  XSS  Tools *$esp.encodeHTML($!{issue.description})*\n\n Velocity **$#{...} Web  XSS  Web \n\n Velocity-1.7  *Parser.jjt*  *$#*   *$[!]{...}* \n\n{code:html}\n<body>$#{screen_content}</body>\n\n#foreach()\n<li> $!{user.name} </li>\n#end\n{code}\n\n Velocity-2.x \n\n  Velocity \n", "created_at" : { "$date" : "2017-08-14T08:50:55.321+0000" }, "updated_at" : { "$date" : "2017-12-08T21:06:52.396+0000" }, "creator_id" : { "$oid" : "5b7d392de9214a0d1608d80d" }, "reporter_id" : { "$oid" : "5b7d392de9214a0d1608d80d" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [ "features" ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec65f627d84c8d6cbc7" }, "external_id" : "VELOCITY-865", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "I am new velocity . ", "desc" : "I am new velocity. I need explain from you. please help me please , I don't know why we need to use it.", "created_at" : { "$date" : "2015-07-20T07:55:32.358+0000" }, "updated_at" : { "$date" : "2017-12-08T21:56:31.127+0000" }, "creator_id" : { "$oid" : "5b7d3931e9214a0d1608d810" }, "reporter_id" : { "$oid" : "5b7d3931e9214a0d1608d810" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7.x" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec75f627d84c8d6cbd2" }, "external_id" : "VELOCITY-811", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Concurrency problems with rendering macros", "desc" : "When using a single instance of Velocity engine from multiple threads sometimes the macro invocation is rendered as literal (#macroName...) as opposed to rendering the macro itself.\nI looked at source code and there is at least one problem with the implementation of  VelocimacroManager.addNamespace. The code there is \"strange\" from the multi-threading point of view and puts an empty namespace into the ConcurrentHashMap before restoring it back. It should probably use \"putIfAbsent\" method instead.", "created_at" : { "$date" : "2011-09-12T17:41:18.891+0000" }, "updated_at" : { "$date" : "2017-12-08T22:11:04.485+0000" }, "creator_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "reporter_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7.x" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e045f627d84c8d6bfa0" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Oracle JVM 1.6.0_26-b03 on Ubuntu 11.04" },
{ "_id" : { "$oid" : "5b904ec85f627d84c8d6cbe7" }, "external_id" : "VELOCITY-831", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Chained contexts do not expose static classes from the contexts being chained", "desc" : "As a performance improvement, I decided to put all our static context objects into a context that would be the basis of all new contexts e.g.\n\n    private static Context chainedContext;\n    static {\n        chainedContext = Z_getDefaultVelocityContext();\n    }\n\n    private static Context Z_getDefaultVelocityContext() {\n        Context context = new VelocityContext();\n        context.put(\"TmpDir\", Common.getTemporaryDirectory());\n        context.put(\"math\", new MathTool());\n        context.put(\"number\", new NumberTool());\n        context.put(\"sort\", new SortTool());\n        context.put(\"LSQUARE_CHAR\", '[');\n        context.put(\"RSQUARE_CHAR\", ']');\n        context.put(\"LCURLY_CHAR\", '{');\n        context.put(\"RCURLY_CHAR\", '}');\n        context.put(\"DOT_CHAR\", '.');\n        context.put(\"NEWLINE\", '\\n');\n        context.put(\"HASH\", '#');\n        context.put(\"DOLLAR\", '$');\n        context.put(\"DQUOTE\", '\"');\n        context.put(\"Utils\", Common.class);\n        return context;\n    }\n\n    public static Context getVelocityContext(boolean runtimeMode) {\n        Context context = new VelocityContext(chainedContext);\n        context.put(\"Context\", context);\n        return context;\n    }\n\nThe problem is that in this configuration, $Utils is not available in the scripts.\nAll the other instantiated objects are OK.  Works fine of course if the static class is added to each outer context.\n", "created_at" : { "$date" : "2012-08-07T19:43:54.878+0000" }, "updated_at" : { "$date" : "2017-12-08T22:11:15.767+0000" }, "creator_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "reporter_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.7.x" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec85f627d84c8d6cbf3" }, "external_id" : "VELOCITY-876", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Support a Configurable EL within ${{...}} also $!{{...}} tags", "desc" : "Since Velocity2 is a Major version, why not start to support some new features?\n\nAs of Velocity 1.x you can use ${ name } to refer to object \"name\" in the context, or use $!{ name } if you want \"\" for null values.\n\nHow about using ${{ el-expression }} to evaluate and output the given \"el-expression\" in a configured el-engine with the current velocity context, same should hold for $!{{ el-expression }}.\n\nSome possible engines would be :\ncommons-el, commons-jexl, ognl, mvel\n\nif using el/jexl ${{ name }} would be mostly the same as ${ name }.\n\nusage cases:\n\nthe simple ${{ ... }} would allow more complicated expressions than present in the plain engine, especially if we look at the jexl2/3 features\n\n#if( ${{ ... }} ) -- would improve the boolean issue because the el could be used to wrap in \"a?x:y\"\n\narchitecture:\n\nthru api abstraction, almost any el could be plugged in ( even groovy.eval or jsr223 )\n\ncore engine could ship with the api and el or jexl as the reference impl, other bindings would be optional jars with thier own deps.\n\nbrain storming:\n\nhow about supporting non-outputting el/jsr223 between #{{ ... #}} tags, like:\n\n------\n#{{ /* jexl code */\nvar = [ 1,2,3,4,5,6,7 ];\n#}}\n#foreach( $n in $var )\n$n\n#end\n------\n\n", "created_at" : { "$date" : "2016-08-06T12:39:17.791+0000" }, "updated_at" : { "$date" : "2017-12-09T03:44:48.905+0000" }, "creator_id" : { "$oid" : "5b7d3936e9214a0d1608d812" }, "reporter_id" : { "$oid" : "5b7d3936e9214a0d1608d812" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [ "2.1.x" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ec95f627d84c8d6cbfd" }, "external_id" : "VELOCITY-749", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ReferenceInsertionEventHandler called \"to often\"/need more configuration settings", "desc" : "I use the EscapeXmlReference (ReferenceInsertionEventHandler implementation) in our projects to produce valid XHTML.\nBut I works not as expected in some situations:\n\nGiven the reference $test as 'Me & Co. Ltd' (for example from context) will output as \n\nMe &amp; Co. Ltd \n\ncorrectly after the EscapeXmlReference.\n\nBut if we enrich the $test reference with some other string before output (#set($test = \"* $test *\")) we got \n\n* Me &amp;amp; Co. Ltd *  \n\nand not  * Me &amp; Co. Ltd * as output!\n\nThis is because the EscapeReference handler was called two times. First on the (internal) set directive (Me & Co. Ltd -> Me &amp; Co. Ltd), second on the real output of $test to the stream (* Me &amp; Co. Ltd *->  * Me &amp;amp; Co. Ltd *). \nThe javadoc of ReferenceInsertionEventHandler says \"Reference 'Stream insertion' event handler.  Called with object  that will be inserted into stream via value.toString().\" \n\"inserted  into stream\" means to me  into the real output stream of the template merge, not into internal substreams. So I believe it's a bug or a least an unexpected behaviour because it produce unpredictable results on string operations.\n\nSo the ReferenceInsertionEventHandler needs the possibility to know if the current insertation is an internal or an real output insertation to be able to react on situations as descripted above.", "created_at" : { "$date" : "2009-12-17T11:11:30.583+0000" }, "updated_at" : { "$date" : "2018-01-07T15:32:09.797+0000" }, "creator_id" : { "$oid" : "5b7d3939e9214a0d1608d813" }, "reporter_id" : { "$oid" : "5b7d3939e9214a0d1608d813" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eca5f627d84c8d6cc0a" }, "external_id" : "VELOCITY-731", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.6 performance is degraded by introduced toString() calls", "desc" : "As part of VELOCITY-531, r686428 introduced frequent calls to toString() just to check if toString() != null. If toString() implementations are slightly complex, and very frequently executed, these calls will degrade the site performance. Are they at all necessary? What kind of object would use null as a return value for toString()? Is it possible to remove these toString() calls from the velocity code again?", "created_at" : { "$date" : "2009-08-19T16:46:55.506+0000" }, "updated_at" : { "$date" : "2018-01-07T15:33:09.134+0000" }, "creator_id" : { "$oid" : "5b7d393ae9214a0d1608d814" }, "reporter_id" : { "$oid" : "5b7d393ae9214a0d1608d814" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1", "1.6.2", "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7", "1.6.x" ], "issue_links" : [  ], "environment" : "Apache Velocity 1.6.2" },
{ "_id" : { "$oid" : "5b904ecb5f627d84c8d6cc27" }, "external_id" : "VELOCITY-717", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Engine throws an NPE using custom macro libs if the IncludeEventHandler returns null", "desc" : "The Engine throws an NPE if the IncludeEventHandler returns null.\n(using merge method with a list of macro libs)\n\n java.lang.NullPointerException\n>>        at java.util.Hashtable.get(Hashtable.java:333)\n>>        at org.apache.velocity.runtime.VelocimacroManager.getNamespace(VelocimacroManager.java:318)\n>>        at org.apache.velocity.runtime.VelocimacroManager.get(VelocimacroManager.java:215)\n>>        at org.apache.velocity.runtime.VelocimacroFactory.getVelocimacro(VelocimacroFactory.java:563)\n>>        at org.apache.velocity.runtime.RuntimeInstance.getVelocimacro(RuntimeInstance.java:1563)\n>>        at org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:218)\n>>        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n>>        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n>>        at org.apache.velocity.runtime.directive.Parse.render(Parse.java:260)\n>>        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n>>        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n>>        at org.apache.velocity.Template.merge(Template.java:328)", "created_at" : { "$date" : "2009-05-15T19:53:36.500+0000" }, "updated_at" : { "$date" : "2018-01-07T15:33:09.685+0000" }, "creator_id" : { "$oid" : "5b7d393ce9214a0d1608d816" }, "reporter_id" : { "$oid" : "5b7d393ce9214a0d1608d816" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7", "1.6.x" ], "issue_links" : [  ], "environment" : "Suse Linux" },
{ "_id" : { "$oid" : "5b904ecc5f627d84c8d6cc58" }, "external_id" : "VELOCITY-732", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "documentation file(s) are missing", "desc" : "At least 1 entry \n(docs\\user-guide.html)\nis missing in\nvelocity-1.6.2.zip & velocity-1.6.2.tar.gz,\nonline version looks OK.\n", "created_at" : { "$date" : "2009-08-22T09:17:09.473+0000" }, "updated_at" : { "$date" : "2018-01-07T15:33:10.186+0000" }, "creator_id" : { "$oid" : "5b7d394be9214a0d1608d818" }, "reporter_id" : { "$oid" : "5b7d394be9214a0d1608d818" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.x" ], "issue_links" : [  ], "original_time_estimate" : 900, "environment" : "Windows XP (no matter)" },
{ "_id" : { "$oid" : "5b904ecd5f627d84c8d6cc65" }, "external_id" : "VELOCITY-836", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Maven metadata not up-to-date", "desc" : "See http://repo1.maven.org/maven2/org/apache/velocity/velocity/maven-metadata.xml", "created_at" : { "$date" : "2012-10-17T14:28:26.750+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:56.456+0000" }, "creator_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "reporter_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ece5f627d84c8d6cc6e" }, "external_id" : "VELOCITY-737", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "StringResourceLoader JavaDoc bug", "desc" : "see Velocity JavaDoc:\nhttp://velocity.apache.org/engine/devel/apidocs/org/apache/velocity/runtime/resource/loader/StringResourceLoader.html\n\nThe line\nstring.resource.loader.repository.class = org.apache.velocity.runtime.resource.loader.StringResourceRepositoryImpl\nis in my opinion wrong.\nIt must be something like this:\n                 p.setProperty(\"string.\" + Velocity.RESOURCE_LOADER + \".repository.class\", \"org.apache.velocity.runtime.resource.util.StringResourceRepositoryImpl\");\n\nutil instead of loader !!\n\n\nMy problem is that I want to use Velocity with two files in a JAR and one file that can be anywhere in the file system. The latter is really hard to solve. So I read the file and use the StringResourceLoader.", "created_at" : { "$date" : "2009-10-14T18:32:56.846+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:56.758+0000" }, "creator_id" : { "$oid" : "5b7d394ce9214a0d1608d819" }, "reporter_id" : { "$oid" : "5b7d394ce9214a0d1608d819" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ], "environment" : "Windows XP, Eclipse 3.3, Java 5" },
{ "_id" : { "$oid" : "5b904ece5f627d84c8d6cc76" }, "external_id" : "VELOCITY-766", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Failed to initialize an instance of org.apache.velocity.runtime.log.ServletLogChute with the current runtime configuration.", "desc" : "After upgrading a web application that uses velocity from java 5 to java 6, the web application has suddenly randomly stopped working, failing suddenly when run with the following exception:\n\nFailed to initialize an instance of org.apache.velocity.runtime.log.ServletLogChute with the current runtime configuration.\n\nGoogle shows that this error has something to do with logging being broken out the box:\n\nhttp://stackoverflow.com/questions/1586133/apache-velocity-can-not-initialize\n\nReferring specifically to this comment in the code:\n\n/* If the above failed, that means either the user specified a\n * logging class that we can't find, there weren't the necessary\n * dependencies in the classpath for it, or there were the same\n * problems for the default loggers, log4j and Java1.4+.\n * Since we really don't know and we want to be sure the user knows\n * that something went wrong with the logging, let's fall back to the\n * surefire SystemLogChute. No panicking or failing to log!!\n */\n\nIt seems despite the code's best efforts, SystemLogChute is either broken or missing, and this breaks Velocity.\n\nPlease can you use a logging framework that isn't broken out the box (I do realise that most logging frameworks have been broken out the box for years, surely there is one that isn't completely useless, I live in hope).\n", "created_at" : { "$date" : "2010-05-26T21:10:57.587+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:57.796+0000" }, "creator_id" : { "$oid" : "5b7d394fe9214a0d1608d81a" }, "reporter_id" : { "$oid" : "5b7d394fe9214a0d1608d81a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ], "environment" : "java version \"1.6.0_17\"\nJava(TM) SE Runtime Environment (build 1.6.0_17-b04)\nJava HotSpot(TM) 64-Bit Server VM (build 14.3-b01, mixed mode)\n" },
{ "_id" : { "$oid" : "5b904ecf5f627d84c8d6cc81" }, "external_id" : "VELOCITY-760", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DataSourceResourceLoader doesn't close PreparedStatements", "desc" : "DataSourceResourceLoader.java contains this method:\n\n\n   private ResultSet readData(final Connection conn,\n                               final String columnNames,\n                               final String templateName) throws SQLException\n    {\n        PreparedStatement ps = conn.prepareStatement(\"SELECT \" + columnNames + \" FROM \"+ tableName + \" WHERE \" + keyColumn + \" = ?\");\n        ps.setString(1, templateName);\n        return ps.executeQuery();\n    }\n\n\nPreparedStatements created in this method never get closed, only the resultset returned may eventually be closed later which isn't sufficient for releasing all bound resources. In my project this statement leak lead to the oracle running out of open cursors (the infamous ORA-01000 error). ", "created_at" : { "$date" : "2010-04-18T12:36:28.179+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:57.041+0000" }, "creator_id" : { "$oid" : "5b7d3951e9214a0d1608d81b" }, "reporter_id" : { "$oid" : "5b7d3951e9214a0d1608d81b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ecf5f627d84c8d6cc91" }, "external_id" : "VELOCITY-759", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NullPointerException in Foreach.java - PatchAvailable", "desc" : "I checked out the code from http://svn.apache.org/repos/asf/velocity/engine/trunk/ I think this is version 1.6.x because it is listed on http://velocity.apache.org/download.cgi But I'm not sure. \n\nWhen I was playing with the Velocity Template Engine I got a NullPointerException. Maybe it is because of my unusual configuration that this exception didn't occured before to others. But in my opinion this kind of Exceptions may never occur. \n\nTo be specific, the Exception is thrown on line 225 in Foreach.java \nif (!hasNextName.equals(\"velocityHasNext\")) \nWhen the variable hasNextName equals null\nhasNextName is a deprecated config setting. It is assigned on line 210: hasNextName = rsvc.getString(RuntimeConstants.HAS_NEXT_NAME);\n\nThe included patch makes it NullPointer save: if (!\"velocityHasNext\".equals(hasNextName))\n", "created_at" : { "$date" : "2010-03-15T12:41:38.775+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:57.464+0000" }, "creator_id" : { "$oid" : "5b7d3953e9214a0d1608d81c" }, "reporter_id" : { "$oid" : "5b7d3953e9214a0d1608d81c" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed05f627d84c8d6cc9c" }, "external_id" : "VELOCITY-555", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Escape quotes in interpolated strings (both ' and \") by doubling them ('' and \"\")", "desc" : "More than a few years, the issue of escaping quotes in interpolated strings was discussed at some length.  Eventually, the list came to a consensus that we should escape them by doubling them, since this would be (or at least very nearly be) backwards compatible and provide a simple solution for this much-wanted feature.\n\nGeir had working code for this and even posted a test jar, IIRC.  So, many of us thought that this had made it into the 1.5 codebase.   But the code never got checked in and may have been lost.  Assuming Geir can't find the old code or the time to duplicate the effort, we should still try to implement this.\n\nThis issue is open to remind us of that.  If i get around to digging up links to the relevant threads, i will post those in the comments of this issue.", "created_at" : { "$date" : "2007-06-18T17:06:50.353+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:58.802+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df35f627d84c8d6be5c" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904ed15f627d84c8d6ccae" }, "external_id" : "VELOCITY-657", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "$velocityHasNext not working properly (returns true even if iterator does not have next value)", "desc" : "Using the new \"velocityHasNext\" feature in loops does not work as expected.\n\nWhen using the following excerpt:\n\n#foreach ($value in $element.values)\n $value \n #if( $velocityHasNext )\n  SEPARATOR\n #end\n#end\n\nand having $element.values as e.g. \"test1\", \"test2\", \"test3\"\n\nI get\n\ntest1 SEPARATOR test2 SEPARATOR test3 SEPARATOR\n\nbut I would expect\n\ntest1 SEPARATOR test2 SEPARATOR test3\n\nWhen looking into the source code, I see the following in org.apache.velocity.runtime.directive.Foreach.render():\n\nwhile (!maxNbrLoopsExceeded && i.hasNext())\n        {\n            // TODO: JDK 1.5+ -> Integer.valueOf()\n            put(context, counterName , new Integer(counter));\n            put(context, hasNextName, Boolean.valueOf(i.hasNext()));\n            Object value = i.next();\n            put(context, elementKey, value);\n      ....\n}\n\nIsn't this the wrong order of instructions?\n\nI would expect:\n\n            Object value = i.next();\n            put(context, hasNextName, Boolean.valueOf(i.hasNext()));\n\nSo that the $velocityHasNext variable will be filled with the \"hasNext\" of the follow-up iteration and not with the \"hasNext\" of the current iteration (which will always be true, otherwise the loop has finished before).\n\n\n\n", "created_at" : { "$date" : "2008-12-23T13:18:54.828+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:58.179+0000" }, "creator_id" : { "$oid" : "5b7d3959e9214a0d1608d81e" }, "reporter_id" : { "$oid" : "5b7d3959e9214a0d1608d81e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7", "1.6.2" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ddf5f627d84c8d6bcd0" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904ed15f627d84c8d6ccbe" }, "external_id" : "VELOCITY-742", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Easily Add/Remove/Replace Directives Without Cracking Open Velocity Jar", "desc" : "There are two use cases that I have for this issue:\n\n1) We need to turn off #include in order to parse .html files that include SSI directives:  <!--#include virtual=\"\"-->  (we always use #parse in our world, so no loss for #include going away)\n\n2) We need to supply our own version of #parse that contains the development hooks that I described in a different issue.\n\nRight now, the only crisp way to do is is to crack open the velocity .jar and make these changes, which is very risky, because future developers may upgrade to new versions of Velocity and not realize that there are customizations and/or not understand how to remake them....not to mention in a shared-classpath environment, we don't always have control over which copy of the Velocity .jar we're using.\n\nIdeally, there would be config options like this:\n\ndirective_remove (\"#parse\", \"#include\")\ndirective_add (\"#parse\", \"com.qwest.velocity.directives.Parse\")\n\nThanks!\n\nTim", "created_at" : { "$date" : "2009-11-06T14:19:47.387+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:59.378+0000" }, "creator_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "reporter_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed25f627d84c8d6ccca" }, "external_id" : "VELOCITY-653", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove redundant error message", "desc" : "The following error message is redundant, since the information is contained in the exception, and we don't want to generate more error messages then necessary.\n\n", "created_at" : { "$date" : "2008-12-09T09:44:26.538+0000" }, "updated_at" : { "$date" : "2018-01-07T15:40:59.635+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.1", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df35f627d84c8d6be5c" }, "external_id" : "VELOCITY-709", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df55f627d84c8d6be76" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904ed05f627d84c8d6cc9c" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904df55f627d84c8d6be75" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904df35f627d84c8d6be5d" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "desc" : "Given the following VTL:\n\n#set($var = \"\\\\\" )\n#set($var2 = \"${var}\")\n\nresults in the following parse error:\n\nEncountered \"${\" at test.vm[line 2, column 15]\nWas expecting one of:\n    <RPAREN> ...\n     ...\n\nthe problem is that when parsing the string literal \"\\\\\" the second double quote is escaped.  This was actually a bug that was introduced in 1.6.x, but I don't think we necessarily need to fix it in that branch.\n", "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "title" : "String literal \"\\\\\" parses incorrectly", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:40:59.098+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2009-03-05T00:35:05.868+0000" } },
{ "_id" : { "$oid" : "5b904ed35f627d84c8d6cce3" }, "external_id" : "VELOCITY-693", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "resourceExists method in FileResourceLoader returns always false if the template is not in the first directory", "desc" : "In case of a multi path resource loader the resourceExists method doesn't work if the template is not in the first directory. It returns alway false, although the resource exists.", "created_at" : { "$date" : "2009-02-12T04:32:10.221+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:00.595+0000" }, "creator_id" : { "$oid" : "5b7d393ce9214a0d1608d816" }, "reporter_id" : { "$oid" : "5b7d393ce9214a0d1608d816" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7", "1.6.2" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed45f627d84c8d6ccf0" }, "external_id" : "VELOCITY-617", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Jakarta Commons ORO at runtime", "desc" : "There is a misleading information on the dependency page(http://velocity.apache.org/engine/releases/velocity-1.5/dependencies.html , These dependencies are required to compile and run the application) about oro.\n\n\"The most common case is the integration of the Velocity runtime into your application. In this case, you must add commons-collections, commons-lang and oro to your application (and optional logging if required). If you already have one or more of these libraries in your application, you should check if you need to update their versions. \"\n\nalso\n\n\"These dependencies are required to compile and run the application\"\n\nExcept if Velocity is configured to escape references, oro is not need it at runtime, only at compile time(most of the users don't care about compile time).", "created_at" : { "$date" : "2008-09-26T13:31:49.147+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:00.123+0000" }, "creator_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "reporter_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5", "1.6" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed55f627d84c8d6cd04" }, "external_id" : "VELOCITY-654", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fix correct template name reporting, enhance error logging information", "desc" : "Fix template name reporting for #include and #parse if an exception occurs.   Error reporting in Velocity tends to use context.getTemplateName() which is intended for scoping information, and does not always provide the template name containing the node or directive that generates an error.  This adds a templateName field to the Directive object and assigns it on creation, if a template name is available.\n\nAlso added template and location info when logging errors thrown from #parse.  This compliments the pseudo-stack trace that is already logged to error for macros.  So, now a complete trace is logged to error of the macro and template layers with template name and location. Yea!\n\n", "created_at" : { "$date" : "2008-12-09T11:59:22.955+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:01.190+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.1", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed65f627d84c8d6cd1b" }, "external_id" : "VELOCITY-694", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Make Velocity OSGi-ready", "desc" : "Velocity jar should be OSGi-ready with all necessary headers in MANIFEST.MF", "created_at" : { "$date" : "2009-02-13T13:45:17.871+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:01.957+0000" }, "creator_id" : { "$oid" : "5b7d395fe9214a0d1608d821" }, "reporter_id" : { "$oid" : "5b7d395fe9214a0d1608d821" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ed65f627d84c8d6cd1a" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904ed65f627d84c8d6cd33" }, "external_id" : "VELOCITY-674", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Lots of unused imports in source code files", "desc" : "I noticed in Eclipse that several Velocity files have lots of unused imports. These could be cleaned with \"Organize imports\" feature for example. ", "created_at" : { "$date" : "2009-01-21T21:30:11.621+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:01.498+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.7", "1.6.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ed75f627d84c8d6cd40" }, "external_id" : "VELOCITY-785", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "incensistencies when escaping quotes by doubling them", "desc" : "The template:\n\n#set($double_double = \"\"\"\") ## ok\n#set($single_single = '''') ## ok\n#set($double_single = \"''\") ## strange, equals \"'\"\n#set($single_double = '\"\"') ## strange, equals '\"'\ndouble_double = $double_double\nsingle_single = $single_single\ndouble_single = $double_single\nsingle_double = $single_double\n\nrenders as:\n\"\n'\n'\n\"\n\n\nwhereas one would expect:\n\"\n'\n''\n\"\"\n\nMore readily, one would expect single quotes doubling mechanism and double quotes doubling mechanism to only be active inside single quotes and double quotes, respectively.\n", "created_at" : { "$date" : "2010-10-27T15:49:24.502+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:02.439+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "2.0" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ], "environment" : "any" },
{ "_id" : { "$oid" : "5b904eaa5f627d84c8d6c9f8" }, "external_id" : "VELOCITY-740", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904eaa5f627d84c8d6c9f9" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "desc" : "Right now the InvalidReferenceEventHandler is called for bad references whether they are quiet or not.  The reference is passed as \"$abc\" even if the template actually contains \"$!abc\".\n\nTypically, you'd want to ignore invalid references.  We should fix this to pass \"$!abc\" instead of $abc.\n\nIt's not a hard fix -- anyone mind if I change this?  Technically, it's a break in backwards compatibility but a pretty minor one.  It will still get called but with an indication the reference is quiet.\n", "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "title" : "InvalidReferenceEventHandler should get indication that a reference is quiet", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:02.767+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2009-10-16T17:20:11.150+0000" } },
{ "_id" : { "$oid" : "5b904ed95f627d84c8d6cd6c" }, "external_id" : "VELOCITY-762", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "$foreach.first and $foreach.last do not have assigned values", "desc" : "$foreach.first and $foreach.last are not getting assigned in a loop (while isFirst() and isLast() do) .\n\nTest case:\n#foreach($i in [1..3])\n    index = $foreach.index, \n    count = $foreach.count, \n    first = $foreach.isFirst() / $foreach.first,\n    last = $foreach.isLast() / $foreach.last<br/>\n#end\n\nResult:\nindex = 0, count = 1, first = true / $foreach.first, last = false / $foreach.last\nindex = 1, count = 2, first = false / $foreach.first, last = false / $foreach.last\nindex = 2, count = 3, first = false / $foreach.first, last = false / $foreach.last", "created_at" : { "$date" : "2010-05-18T20:47:39.158+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:03.018+0000" }, "creator_id" : { "$oid" : "5b7d38efe9214a0d1608d7f6" }, "reporter_id" : { "$oid" : "5b7d38efe9214a0d1608d7f6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904eda5f627d84c8d6cd78" }, "external_id" : "VELOCITY-688", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "! preceding a reference in strict mode ignores a null exception", "desc" : "Change strict mode (runtime.references.strict = true) behavior such that when Velocity attempts to render a reference that evaluates to null then throw an exception.  If the reference is preceded by '$!' as in $!foo, then simply render nothing and ignore the null value as it does for non strict mode.\n", "created_at" : { "$date" : "2009-01-31T02:29:16.784+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:03.735+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904edb5f627d84c8d6cd91" }, "external_id" : "VELOCITY-728", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NullPointerException occurs when #parse() without parameter", "desc" : "Execute this template code\n\n#parse()\n\nThe exception occurs\nCaused by: java.lang.NullPointerException\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.jjtGetChild(SimpleNode.java:177)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:131)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.runtime.RuntimeInstance.render(RuntimeInstance.java:1277)\n\tat org.apache.velocity.runtime.RuntimeInstance.evaluate(RuntimeInstance.java:1216)\n\tat org.apache.velocity.app.VelocityEngine.evaluate(VelocityEngine.java:294)\n\t... 6 more\n", "created_at" : { "$date" : "2009-06-22T09:53:06.275+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:04.339+0000" }, "creator_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "reporter_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904edc5f627d84c8d6cd9f" }, "external_id" : "VELOCITY-584", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904edc5f627d84c8d6cda0" }, "external_id" : "VELOCITY-661", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parsing errors on content inside #literal() #end block", "desc" : "I have some velocity templates that include quit some javascript. Inside the javascript a javascrip template engine is used which also uses ${varname}\nEscaping each occurance would make the code rather unreable, so to prevent velocity from parsing the javascript code, I put a #literal() around it.\n\nHowever, velocity still PARSES the contents of this block, which of course results in parsing exceptions.\n\nMy feeling with \"literal\" is that it is completely UNINTERPRETED content?\n\nThis SHOULD work:\n\n#literal()\n var myId = 'someID';\n $('#test).append($.template('<div id=\"${myId}\"></div>').apply({myId: myId}));\n#end", "created_at" : { "$date" : "2008-12-30T16:15:37.087+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:04.753+0000" }, "creator_id" : { "$oid" : "5b7d396ae9214a0d1608d826" }, "reporter_id" : { "$oid" : "5b7d396ae9214a0d1608d826" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904edc5f627d84c8d6cd9f" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "ALL" },
{ "_id" : { "$oid" : "5b904edd5f627d84c8d6cdbf" }, "external_id" : "VELOCITY-352", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Need translation of change to user's guide re: math operations", "desc" : "old text (in English): \n  <p>\n    When a division operation is performed, the result will be an\n    integer. Any remainder can be obtained by using the modulus\n    (<em>%</em>) operator.\n  </p>\n\nnew text:\n  <p>\n    When a division operation is performed between two integers, the result \nwill be an\n    integer. Any remainder can be obtained by using the modulus\n    (<em>%</em>) operator.\n  </p>\n\n\nNeed a translation into Spanish, Finnish, French", "created_at" : { "$date" : "2005-02-05T15:59:06.000+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:05.091+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7", "1.6" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904dd45f627d84c8d6bbf2" }, "external_id" : "VELOCITY-554", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dd45f627d84c8d6bbf3" }, "effect" : "is part of", "type" : "Incorporates" } ], "creator_id" : { "$oid" : "5b7d396ce9214a0d1608d827" }, "desc" : "It is really annoying when popular projects like Apache Velocity do not provide their sources and javadocs to the Maven repository.", "reporter_id" : { "$oid" : "5b7d396ce9214a0d1608d827" }, "title" : "Velocity sources and javadocs missing in the maven repository", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:05.416+0000" }, "issue_type" : "New Feature", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "created_at" : { "$date" : "2007-06-15T13:48:41.488+0000" } },
{ "_id" : { "$oid" : "5b904ddf5f627d84c8d6bcd0" }, "external_id" : "VELOCITY-658", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.6.1", "1.6" ], "components" : [ "Engine" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ed15f627d84c8d6ccae" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904ddf5f627d84c8d6bcd1" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "desc" : "With this test case:\n\nassertEvalEquals(\"test1 (a1;a2;a3)-test2 (a1;a2;a3)-test3 (a1;a2;a3)-test4 (a1;a2;a3)\", \n    \"#foreach ($value in $list)$value (#foreach ($val in $list2)$val#if( $velocityHasNext );#end#end)#if( $velocityHasNext )-#end#end\");             \n\nVelocity 1.6.1 (or current head) fails because the \"hasNext\" flag status of the outer foreach loop gets overwritten by the nested foreach loop. To fix this we need to save the status of the hasNext flag in Foreach directive just like we save the value of the counter.\n\nThis bug is related to VELOCITY-657 but is a separate bug. ", "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "title" : "$velocityHasNext does not work in nested loops", "priority" : "Minor", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:05.731+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2008-12-27T22:52:36.124+0000" } },
{ "_id" : { "$oid" : "5b904ee05f627d84c8d6ce15" }, "external_id" : "VELOCITY-758", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Include line number in message \"#parse() null argument\"", "desc" : "Assume the following scenarios:\n\nScenario A)\nA template has the following line:\n#parse(\"never-found-template.vm\")\n\nScenario B)\nA template has the following line:\n#parse($nonsense)\n\nAssume further, that neither the \"never-found-template.vm\" is present nor the variable \"$nonsense\" is set.\n\nIn scenario A) the log reports \"#parse(): cannot find template 'never-found-template.vm', called from template ... at (1, 1)\"\nIn scenario B) the log says \"#parse() null argument\"\n\nProblem:\nIn scenario B), having multiple nested #parse-Statements, it's hard to find the error finally.\n\nSugestion / Feature request:\nInclude source information and line numbers when reporting \"#parse() null argument\" - analogous to scenario A)\n\nThanks and kind regards\n\nEdy Hinzen\n", "created_at" : { "$date" : "2010-03-11T10:28:50.618+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:06.952+0000" }, "creator_id" : { "$oid" : "5b7d3971e9214a0d1608d828" }, "reporter_id" : { "$oid" : "5b7d3971e9214a0d1608d828" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ee15f627d84c8d6ce25" }, "external_id" : "VELOCITY-754", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity error with jQuery command  $.post(\"something\", \"\")", "desc" : "I'm using jQuery in an Velocity file and have discovered the common jQuery command\n\n$.post(\"someUrl\", \"\") \n\ngenerates a Velocity parsing error.\n\nEncountered \",\" at /myfile.htm [line 1, column 19] Was expecting one of:  \"(\" ...  ...  ...  ... \"##\" ... \"\\\\\\\\\" ... \"\\\\\" ...  ... \"*#\" ... \"*#\" ...  ...  ...  ...  ...  ...  ...  ...  ...  ... \"{\" ... \"}\" ... ", "created_at" : { "$date" : "2010-01-29T14:53:17.972+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:06.641+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ee15f627d84c8d6ce24" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904dfc5f627d84c8d6bf01" }, "external_id" : "VELOCITY-615", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "fix_versions" : [ "1.6.1", "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dfc5f627d84c8d6bf02" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "desc" : "Here's the scenario;  we have a framework that allows us to reload the Velocity runtime so that we can tinker with caching etc at runtime.  We normally run development with template caching turned off and deliver to the client with caching turned on.\n\nThere is a problem with inline macros (probably macro libraries too, not sure) whereby they will behave differently once they are compiled and cached then when they are interpreted at runtime.  It is all to do with the re-assignment of parameter variables within the macro.\n\nHere is a very simple example;\n\n#macro(tmpMacro $FieldNames)\n    #set($FieldNames=\"ingredient.\" + $FieldNames.replaceAll(\",\",\",ingredient.\"))\n    .....\n#end\n\n#tmpMacro(\"one,two,three\")\n\nThis works fine when the template is not cached - as soon as you turn on caching, the macro becomes unreliable.\nMy original prognosis was that we were upsetting the variable types by converting strings into lists but as you can see, that isn't the case in this example.  The problem is solved by changing the assignment to;\n\n    #set($Names=\"ingredient.\" + $FieldNames.replaceAll(\",\",\",ingredient.\"))\n\nI can appreciate that maybe this type of \"re-assignment\" of parameters might be an issue, but the real problem is the inconsistency between the cached and non-cached behaviours.\n", "reporter_id" : { "$oid" : "5b7d38ebe9214a0d1608d7f1" }, "title" : "Inconsistent macro bahaviour in cached and non-cached modes", "priority" : "Major", "status" : "Closed", "environment" : "Windows XP, Tomcat 6.x, JVM 1.6", "updated_at" : { "$date" : "2018-01-07T15:41:06.396+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2008-09-18T11:03:25.622+0000" } },
{ "_id" : { "$oid" : "5b904ee35f627d84c8d6ce53" }, "external_id" : "VELOCITY-744", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No more VM adding logs", "desc" : "org.apache.velocity.runtime.VelocimacroFactory.addVelocimacro(String, String, String[], String) add a log \"added <VMName> : source = <VMBody>\"\nThe new 1.6 method org.apache.velocity.runtime.VelocimacroFactory.addVelocimacro(String, Node, String[], String) no more log this.\n\nThe first one is used by org.apache.velocity.runtime.RuntimeInstance.addVelocimacro(String, String, String[], String) which is now deprecated for org.apache.velocity.runtime.RuntimeInstance.addVelocimacro(String, Node, String[], String) which use the new VelocimacroFactory.addVelocimacro\n\nThis logs was usefull for debug.", "created_at" : { "$date" : "2009-11-19T18:11:32.950+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:07.359+0000" }, "creator_id" : { "$oid" : "5b7d3729e9214a0d1608d74e" }, "reporter_id" : { "$oid" : "5b7d3729e9214a0d1608d74e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df75f627d84c8d6bea0" }, "external_id" : "VELOCITY-675", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df75f627d84c8d6bea1" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "desc" : "The following syntax (without #end) causes an NPE:  \"#@foo\"\n\nclass java.lang.NullPointerException\napache.velocity.runtime.parser.node.SimpleNode.jjtGetChild(SimpleNode.java:183) \norg.apache.velocity.runtime.directive.BlockMacro.init(BlockMacro.java:107) \norg.apache.velocity.runtime.parser.node.ASTDirective.init(ASTDirective.java:138) \norg.apache.velocity.runtime.parser.node.SimpleNode.init(SimpleNode.java:309) \norg.apache.velocity.Template.initDocument(Template.java:218) \norg.apache.velocity.Template.process(Template.java:126) \n", "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "title" : "#@foo causes an NPE", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:07.946+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2009-01-22T09:25:34.608+0000" } },
{ "_id" : { "$oid" : "5b904ee45f627d84c8d6ce66" }, "external_id" : "VELOCITY-730", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Property references don't work with maps that implement Map indirectly (such as Google Collections ImmutableMap)", "desc" : "If you pass a map created using Google Collections ImmutableMap into a Velocity context, and try to access its values using \"map.key\" style property syntax, it fails to resolve.\n\nI believe the problem is in MapGetExecutor:\n\nhttp://svn.apache.org/viewvc/velocity/engine/tags/1.6.1/src/java/org/apache/velocity/runtime/parser/node/MapGetExecutor.java?view=co\n\nSpecifically, this code:\n\n        Class [] interfaces = clazz.getInterfaces();\n        for (int i = 0 ; i < interfaces.length; i++)\n        {\n            if (interfaces[i].equals(Map.class))\n            {\n...\n\nThe sneaky thing about ImmutableMap is that ImmutableMap.of(...) doesn't return an instance of ImmutableMap, but one of serveral subclasses optimized for however many items are in the map. These subclasses extend ImmutableMap but do not directly implement Map, so that code above fails to recognize them.\n\nA simpler and more accurate way to tell whether the class implements Map, either directory or indirectly, is \"if (Map.class.isAssignableFrom(clazz))...\"", "created_at" : { "$date" : "2009-07-29T18:53:46.767+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:08.585+0000" }, "creator_id" : { "$oid" : "5b7d397ce9214a0d1608d829" }, "reporter_id" : { "$oid" : "5b7d397ce9214a0d1608d829" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da65f627d84c8d6b84e" }, "external_id" : "VELOCITY-583", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "components" : [ "Engine" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904da65f627d84c8d6b84f" }, "effect" : "duplicates", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b904dd65f627d84c8d6bc22" }, "effect" : "is blocked by", "type" : "Blocker" } ], "creator_id" : { "$oid" : "5b7d3984e9214a0d1608d82a" }, "desc" : "Here's the trivial example,\n\n#blockmacro(html $style)\n<html style=\"$style\">\n ${yield}\n</html>\n#end\n\n\nBlock Macro Result\n#html(\"color:red\")\n<body>Raghu</body>\n#end\n\nFull discussion on thread: http://tinyurl.com/ytq3k4", "reporter_id" : { "$oid" : "5b7d3984e9214a0d1608d82a" }, "title" : "BlockMacro support", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:08.838+0000" }, "issue_type" : "New Feature", "resolution" : "Fixed", "created_at" : { "$date" : "2008-01-25T20:20:54.404+0000" } },
{ "_id" : { "$oid" : "5b904ee65f627d84c8d6ce83" }, "external_id" : "VELOCITY-651", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.6 does not work with Struts MessageTool 1.4", "desc" : "The org.apache.velocity.tools.struts.MessageTool of VelocityTools version 1.4 contains a method signature of String get(String key, Object args[]).\n\nWith Velocity 1.5, one could use a Struts resource, such as\ntest1=this is a {0}\n\nin a Velocity template with\n$text.get('test1', ['TEST'])\n\nthat would render the text\nthis is a TEST\n\nUnfortunately, since the released version 1.6 I get the following exception: \nInvocation of method 'get' in class org.apache.velocity.tools.struts.MessageTool threw exception java.lang.IllegalArgumentException: wrong number of arguments at .. \n\nThe setting of the property runtime.references.strict has no influence.\n\n\n", "created_at" : { "$date" : "2008-12-03T11:23:25.346+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:09.992+0000" }, "creator_id" : { "$oid" : "5b7d3986e9214a0d1608d82b" }, "reporter_id" : { "$oid" : "5b7d3986e9214a0d1608d82b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.1", "1.7" ], "issue_links" : [  ], "environment" : "Velocity 1.6, Struts MessageTool 1.4, Struts 1.2.9, Java 1.6_10" },
{ "_id" : { "$oid" : "5b904ee65f627d84c8d6ce92" }, "external_id" : "VELOCITY-755", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Maps should be stored in the order they are defined", "desc" : "If you create a map with Velocity like: #set( $monkey.Map = {\"banana\" : \"good\", \"roast beef\" : \"bad\"}) the elements are not stored in the order they are defined. So I think a HashMap implemention is used for the map creation. It would be great if you switch over to a LinkedHashMap implementation, because you get a lot of benefits if you are heavy maps in your templates and the order is important.", "created_at" : { "$date" : "2010-02-28T15:30:44.648+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:09.396+0000" }, "creator_id" : { "$oid" : "5b7d398be9214a0d1608d82c" }, "reporter_id" : { "$oid" : "5b7d398be9214a0d1608d82c" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ee75f627d84c8d6ce9d" }, "external_id" : "VELOCITY-686", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "BlockMacro renders $bodyContent on #set", "desc" : "Given the following VTL:\n\n#macro(foo)#set($x = $bodyContent)#end\n#@foo()bar#end\n\nrenders to:\n\nbar\n\nI wonder about calling render on JJTBLOCK types in the ProxyVMContext get method.  Do you think it would be better in ASTReference render?\n\nThere is an interesting use case for BlockMacros which looks something like this:\n\n#macro(escXML)$tool.escXml($bodyContent)#end\n\nThe above definition could be used to create a filter like the following:\n\n#@escXML\n  ## ... rendered stuff to be escaped\n#end\n\n$tool.escXml can intercept the writer and create a filter.  But as it stands referencing $bodyContent renders the content making this use case impractical.\n\n\n\n", "created_at" : { "$date" : "2009-01-24T10:50:21.632+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:09.705+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ee85f627d84c8d6cec3" }, "external_id" : "VELOCITY-676", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#[[##x]]# causes StringIndexOutOfBoundsException", "desc" : "The following VTL:\n\n#[[##x]]#\n\nCauses:\n\nThrew: class java.lang.StringIndexOutOfBoundsException\nMsg: String index out of range: -2\njava.lang.String.substring(String.java:1768) \norg.apache.velocity.runtime.parser.node.ASTTextblock.init(ASTTextblock.java:79) \norg.apache.velocity.runtime.parser.node.SimpleNode.init(SimpleNode.java:309) \norg.apache.velocity.Template.initDocument(Template.java:218) \norg.apache.velocity.Template.process(Template.java:126) \n\n\n", "created_at" : { "$date" : "2009-01-22T09:32:08.364+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:10.233+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ee15f627d84c8d6ce24" }, "external_id" : "VELOCITY-729", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ee15f627d84c8d6ce25" }, "effect" : "relates to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "desc" : "The following VTL:\n\n$.x\n\nrenders as:\n\n.x\n\nWhich eats the dollar sign.", "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "title" : "VTL \"$.x\" incorrectly render as \".x\"", "priority" : "Minor", "status" : "Closed", "updated_at" : { "$date" : "2018-01-07T15:41:11.958+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2009-07-13T14:35:55.845+0000" } },
{ "_id" : { "$oid" : "5b904eeb5f627d84c8d6cf06" }, "external_id" : "VELOCITY-724", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] Is junit-3.8.1.jar optional for Velocity as specified in jar dependencies?", "desc" : "When i navigate to the build directory in Velocity 1.6.2 and invoke \"ant\" then the below error is got:\nCould not create task or type of type: junit. lib\\test. \nAnt could not find the task or a class this task relies upon.\nRefer screenshot\n\nI deleted the junit-3.8.1.jar file from bin\\test-lib as it was specified to be optional, but it gets created automatically. \n\nDo we need to remove the dependency on this junit-3.8.1.jar manually? ", "created_at" : { "$date" : "2009-06-01T11:11:17.698+0000" }, "updated_at" : { "$date" : "2018-01-07T15:41:11.619+0000" }, "creator_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "reporter_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.6.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f355f627d6b05868017" }, "external_id" : "ZOOKEEPER-24", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Do Application based outstanding request throttling", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1848004&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T21:30:20.234+0000" }, "updated_at" : { "$date" : "2008-06-10T21:30:20.234+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f365f627d6b05868018" }, "external_id" : "ZOOKEEPER-35", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : " Replay logs", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1958121&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:38:04.807+0000" }, "updated_at" : { "$date" : "2008-06-10T22:38:04.807+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f365f627d6b05868019" }, "external_id" : "ZOOKEEPER-37", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "WebDAV access to ZooKeeper", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1961764&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:41:06.723+0000" }, "updated_at" : { "$date" : "2008-06-10T22:41:06.723+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f375f627d6b0586801a" }, "external_id" : "ZOOKEEPER-46", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Clients should check the latencies to the various servers and try to connect to the servers with the lowest latencies first", "desc" : "When ZooKeeper clients and servers are on the same LAN or in the same data center it really doesn't matter which ZooKeeper server they connect to. However, when the ZooKeeper cluster spans data centers, clients should try to connect to local servers first.", "created_at" : { "$date" : "2008-06-17T14:56:48.591+0000" }, "updated_at" : { "$date" : "2008-06-17T14:57:32.124+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f375f627d6b0586801d" }, "external_id" : "ZOOKEEPER-52", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Session ids on the stat cmd information", "desc" : "Currently there is not a way to correlate session ids with client connections. It would be nice if the stat command listed the session id along with the ip address. ", "created_at" : { "$date" : "2008-06-25T15:34:15.116+0000" }, "updated_at" : { "$date" : "2008-06-25T15:34:15.116+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f385f627d6b0586801e" }, "external_id" : "ZOOKEEPER-47", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "io thread still around after a EXPIRED_SESSION or AUTH_FAILED event is received", "desc" : "If a session expires, the zhandle_t becomes invalid and useless; however, the io thread keeps going.\n\ndo_io in mt_adaptor.c needs to check the return code of zookeeper_interest and zookeeper_process and get out of the loop if the handle is invalid.", "created_at" : { "$date" : "2008-06-18T21:45:37.853+0000" }, "updated_at" : { "$date" : "2008-06-27T14:57:40.440+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f395f627d6b05868024" }, "external_id" : "ZOOKEEPER-66", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add NullWatcher, a watcher that does nothing", "desc" : "I found that I was repeating this code all over the place. Here is a NullWatcher class, a Watcher that does nothing at all.", "created_at" : { "$date" : "2008-07-04T01:51:27.937+0000" }, "updated_at" : { "$date" : "2008-07-22T17:46:24.479+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f395f627d6b05868023" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f395f627d6b05868023" }, "external_id" : "ZOOKEEPER-67", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f395f627d6b05868024" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2008-07-04T01:59:44.157+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "resolution" : "Won't Fix", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "updated_at" : { "$date" : "2008-07-22T17:46:57.279+0000" }, "title" : "Add a two argument constructor to ZooKeeper that uses a NullWatcher for the default Watcher", "issue_type" : "Improvement", "desc" : "This patch adds a two argument constructor to ZooKeeper that uses a NullWatcher for the default Watcher.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d4f3a5f627d6b0586803c" }, "external_id" : "ZOOKEEPER-81", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMX module is using 1 java 6 method that has a java 5 equivalent", "desc" : "It would be nice if the jmx module compiled and ran on java 5 too.", "created_at" : { "$date" : "2008-07-18T16:16:35.652+0000" }, "updated_at" : { "$date" : "2008-07-23T21:48:44.354+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f3b5f627d6b05868058" }, "external_id" : "ZOOKEEPER-88", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "implement java.util.concurrent.locks.Lock", "desc" : "we should implement the [java.util.concurrent.locks.Lock|http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/Lock.html] to make it easier for folks to reuse the Lock and to help make the API be more natural to end users", "created_at" : { "$date" : "2008-07-24T09:29:09.757+0000" }, "updated_at" : { "$date" : "2008-07-24T20:57:27.330+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" } },
{ "_id" : { "$oid" : "5b7d4f3b5f627d6b0586805f" }, "external_id" : "ZOOKEEPER-39", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Use Watcher objects rather than boolean on read operations", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1962501&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:43:45.980+0000" }, "updated_at" : { "$date" : "2008-07-25T10:42:06.379+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f38e9214a0d1608d869" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f3b5f627d6b0586805e" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f3c5f627d6b05868072" }, "external_id" : "ZOOKEEPER-100", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Avoid extending Thread in the public ZooKeeper API", "desc" : "This was discussed in ZOOKEEPER-82\nThis would allow proper checked exceptions to get thrown when the objects are started/stopped.", "created_at" : { "$date" : "2008-07-25T17:14:53.384+0000" }, "updated_at" : { "$date" : "2008-07-25T17:14:53.384+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f3d5f627d6b05868073" }, "external_id" : "ZOOKEEPER-106", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "CancelledKeyException", "desc" : "This exception seems to be harmless, but I thought it would be a good idea to document it just in case I overlooked anything. I think it is harmless because it is thrown inside the while loop that obtains the keys ready for I/O on Factory.run(). The penalty is skipping all other keys available in the for loop that follows the select call, but since we call again select in the next interation, we don't miss much. An optimizatio, however, would be catching this exception inside the for loop to avoid the extra call to select.  \n\n{noformat}\n2008-07-24 21:09:03,894 -  ERROR - [NIOServerCxn.Factory:NIOServerCnxn$Factory@152] - FIXMSG\njava.nio.channels.CancelledKeyException\n        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n        at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:69)\n        at com.yahoo.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:136)\n2008-07-24 21:09:06,912 -  ERROR - [NIOServerCxn.Factory:NIOServerCnxn$Factory@152] - FIXMSG\njava.nio.channels.CancelledKeyException\n        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n        at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:69)\n        at com.yahoo.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:136)\n{noformat}", "created_at" : { "$date" : "2008-07-26T15:03:27.702+0000" }, "updated_at" : { "$date" : "2008-07-26T15:03:27.702+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f3d5f627d6b05868074" }, "external_id" : "ZOOKEEPER-84", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "provide a mechanism to reconnect a ZooKeeper if a client receives a SessionExpiredException", "desc" : "am about to attach a patch which adds a reconnect() method to easily re-establish a connection if a session expires - along with a toString() implementation for easier debugging", "created_at" : { "$date" : "2008-07-22T13:27:50.728+0000" }, "updated_at" : { "$date" : "2008-08-04T17:37:04.551+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f3e5f627d6b05868090" }, "external_id" : "ZOOKEEPER-91", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "provide an option for the WriteLock to also watch the locks own znode, so that if someone else deletes it then it is equivalent to calling WriteLock.unlock()", "desc" : "Most clients probably wont need this, but it could be a handy system management feature to allow the WriteLock to watch its own znode so that if someone else deletes it, it then relinquishes the lock and tries to get it back again", "created_at" : { "$date" : "2008-07-24T11:08:01.126+0000" }, "updated_at" : { "$date" : "2008-08-05T13:49:12.802+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" } },
{ "_id" : { "$oid" : "5b7d4f3f5f627d6b05868092" }, "external_id" : "ZOOKEEPER-116", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "simplify testing with quorums - quorum setup test utility code", "desc" : "pull out the quorum starting and stopping code from the quorum servers and create a utility class that allows creation of n number of quorum servers in the tests", "created_at" : { "$date" : "2008-08-08T06:25:26.416+0000" }, "updated_at" : { "$date" : "2008-08-08T06:25:26.416+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f3f5f627d6b05868093" }, "external_id" : "ZOOKEEPER-26", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "monitoring and management via JMX", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1894138&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T21:34:32.930+0000" }, "updated_at" : { "$date" : "2008-08-11T18:30:43.967+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f38e9214a0d1608d869" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f405f627d6b0586809a" }, "external_id" : "ZOOKEEPER-120", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NIOServerCnxn needs to improve shutdown() handling", "desc" : "When the NIOServerCnxn is shutdown it doesn't handle gracefully - if shutdown is called we should set internal state. In the run method we print unnecessary error messages as we don't currently know that shutdown (gracefully) was called rather than some other more serious, unexpected, condition.\n", "created_at" : { "$date" : "2008-08-12T18:27:36.621+0000" }, "updated_at" : { "$date" : "2008-08-12T18:27:36.621+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f405f627d6b0586809b" }, "external_id" : "ZOOKEEPER-13", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE during normal operations", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1946934&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:12:41.943+0000" }, "updated_at" : { "$date" : "2008-08-27T18:28:11.148+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f415f627d6b058680a3" }, "external_id" : "ZOOKEEPER-77", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE in jute toCSVString code", "desc" : "As reported by user:\n\nFrom: Martin Schaaf <ms@101tec.com>\nList-Id: <zookeeper-user.lists.sourceforge.net>\n\nFYI today I found this NPE in the logs. After this Exception an Error  \nevent was thrown.\n\njava.lang.NullPointerException\n\tat com.yahoo.jute.Utils.toCSVString(Utils.java:128)\n\tat com.yahoo.jute.CsvOutputArchive.writeString(CsvOutputArchive.java: \n95)\n\tat com.yahoo.zookeeper.proto.WatcherEvent.toString(WatcherEvent.java: \n60)\n\tat net.sf.katta.zk.ZKClient.process(ZKClient.java:404)\n\tat com.yahoo.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:264)\n", "created_at" : { "$date" : "2008-07-16T16:22:06.585+0000" }, "updated_at" : { "$date" : "2008-08-27T18:30:48.384+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "jute" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f415f627d6b058680a2" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f425f627d6b058680ae" }, "external_id" : "ZOOKEEPER-129", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Thrift proxy", "desc" : "This is a basic server that acts as a proxy between a thrift interface and ZooKeeper. It doesn't support watches, and I'm not entirely convinced the session handling makes sense, but it works for basic operations like creating, listing and deleting nodes. The patch puts the code and (basic) build file under src/contrib/thrift; the build file requires the thrift compiler to be in the path, and the thrift and zookeeper libraries in the lib dir.", "created_at" : { "$date" : "2008-08-29T17:11:36.223+0000" }, "updated_at" : { "$date" : "2008-08-29T21:01:10.255+0000" }, "creator_id" : { "$oid" : "5b7d4f42e9214a0d1608d871" }, "reporter_id" : { "$oid" : "5b7d4f42e9214a0d1608d871" }, "issue_type" : "New Feature", "priority" : "Trivial", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f425f627d6b058680b2" }, "external_id" : "ZOOKEEPER-19", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Vector of Integers with Jute", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1981288&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:22:54.301+0000" }, "updated_at" : { "$date" : "2008-09-09T21:10:28.314+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "jute" ], "labels" : [  ], "resolution" : "Later", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f435f627d6b058680ba" }, "external_id" : "ZOOKEEPER-2", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Synchronization issues in QuorumPeer and FastLeader election", "desc" : "There are a couple of cases of member variables that need to be marked volatile or surrounded in a synchronization block. A couple of examples are:\n\n* QuorumPeer state should be synchronous\n* currentVote in QuorumPeer is marked volatile, but when it's members are often accessed individually as if they were in an atomic unit. Such code should be changed to get a reference to the currentVote and they access members through that reference.\n* It looks like logicalClock in FastLeaderElection should be volatile. It should either be fixed or commented to explain why it doesn't need to be.", "created_at" : { "$date" : "2008-06-09T16:34:31.959+0000" }, "updated_at" : { "$date" : "2008-09-09T21:11:22.601+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f445f627d6b058680e3" }, "external_id" : "ZOOKEEPER-143", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Exceeding max data node size causes disconnect", "desc" : "The server will disconnect the client if the max node size is exceeded. See ZOOKEEPER-142\n\nWe should consider whether disconnect is warranted (142 has added documentation for this to the java client)\nWe should also document this in the main forrest based docs.\n", "created_at" : { "$date" : "2008-09-25T21:38:04.679+0000" }, "updated_at" : { "$date" : "2008-09-25T21:39:00.709+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f445f627d6b058680e2" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f445f627d6b058680e6" }, "external_id" : "ZOOKEEPER-163", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Things to Consider: Strengths and Limitations\"", "desc" : "I need content for the section \"Things to Consider: ZooKeeper Strengths and Limitations\" in the ZooKeeper admin guide. \n\n", "created_at" : { "$date" : "2008-10-06T14:11:23.170+0000" }, "updated_at" : { "$date" : "2008-10-06T14:11:23.170+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" } },
{ "_id" : { "$oid" : "5b7d4f455f627d6b058680e8" }, "external_id" : "ZOOKEEPER-170", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Read Operations\"", "desc" : "We need the content which describes how to a client should read data from a zookeeper node. Ideally this would have pseudo code describing any lead-up (for example resource allocation, etc),  a few lines of sample code in Java, and a few parallel lines in C. \n\nAny commentary would be highly appreciated -- anything about reading data that would not be obvious to a new ZooKeeper developer. ", "created_at" : { "$date" : "2008-10-06T15:37:41.372+0000" }, "updated_at" : { "$date" : "2008-10-06T15:38:40.604+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b7d4f465f627d6b058680eb" }, "external_id" : "ZOOKEEPER-171", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Write Operations\"", "desc" : "We need the content which describes how to a client should write data to a zookeeper node. Ideally this would have pseudo code describing any lead-up (for example resource allocation, etc),  a few lines of sample code in Java, and a few parallel lines in C. \n\nAny commentary would be highly appreciated -- anything about writing data that would not be obvious to a new ZooKeeper developer. ", "created_at" : { "$date" : "2008-10-06T15:39:53.850+0000" }, "updated_at" : { "$date" : "2008-10-06T15:39:53.850+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b7d4f465f627d6b058680ec" }, "external_id" : "ZOOKEEPER-172", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Handling Watches\"", "desc" : "We need the content which describes how client code should handle watches. Ideally this would have pseudo code describing any lead-up (for example resource allocation, etc),  a few lines of sample code in Java, and a few parallel lines in C. \n\nAny commentary would be highly appreciated -- anything about handling watches that would not be obvious to a new ZooKeeper developer. ", "created_at" : { "$date" : "2008-10-06T15:46:04.191+0000" }, "updated_at" : { "$date" : "2008-10-06T15:46:04.191+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b7d4f475f627d6b058680ed" }, "external_id" : "ZOOKEEPER-173", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Miscellaneous Operations\"", "desc" : "For lack of better term, I'm adding a section to the programmer's guide called \"Miscellaneous Operations\".  This might eventually be broken out into sections of more descriptive terms. In short, these are COMMON zookeeper programming operations that do not come under the headings of connecting, reading, writing, or watching.  \n\n(I don't think we should document uncommon or seldom used API here.)\n\n", "created_at" : { "$date" : "2008-10-06T15:50:43.174+0000" }, "updated_at" : { "$date" : "2008-10-06T15:50:43.174+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b7d4f475f627d6b058680ee" }, "external_id" : "ZOOKEEPER-174", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Sync vs Async\"", "desc" : "Some time ago, Patrick suggested a subsection of the Basic Building Blocks section of the Programmer's Guide called \"Sync vs. Async Operations.\"  I don't know if that is still on the roadmap, but I put it here in case anyone wants to provide content for me to add to the Programmer's Guide.", "created_at" : { "$date" : "2008-10-06T15:53:05.464+0000" }, "updated_at" : { "$date" : "2008-10-06T15:53:05.464+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "original_time_estimate" : 14400 },
{ "_id" : { "$oid" : "5b7d4f485f627d6b058680ef" }, "external_id" : "ZOOKEEPER-176", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "needed: docs for auth plugin developers ", "desc" : "Part of the interest in documentation related to security:\n  how to add different/new methods for integrating zk into existing auth mechanisms, etc...", "created_at" : { "$date" : "2008-10-06T15:58:39.702+0000" }, "updated_at" : { "$date" : "2008-10-06T16:05:03.684+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "external_id" : "ZOOKEEPER-160", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "created_at" : { "$date" : "2008-10-06T14:01:55.416+0000" }, "updated_at" : { "$date" : "2008-10-08T00:07:02.418+0000" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "priority" : "Major", "title" : "Admin / Ops Guide Missing Content", "issue_type" : "Bug", "desc" : "I'm adding new sections to the ZooKeeper Admin guide, but I don't have the content to fill them out. These sections are: \n- Designing a ZooKeeper Deployment\n- Provisioning\n- Things to Consider: ZooKeeper Strengths and Limitations\n- Administering\n- Monitoring\n- Logging\n- Troubleshooting\n\nI'll add a subtask for each section.  \n\nNote: If the area experts prefer, I can conduct a phone interview or email conversation or IM with them on the topic, and then write up the section so they don't have to. ", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d4f455f627d6b058680e7" }, "external_id" : "ZOOKEEPER-168", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "created_at" : { "$date" : "2008-10-06T15:24:01.414+0000" }, "updated_at" : { "$date" : "2008-10-08T18:04:39.719+0000" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "priority" : "Major", "title" : "Programmer's Guide \"Basic Operations\" section is missing content", "issue_type" : "Bug", "desc" : "There is a chapter in the ZooKeeper Programmer's Guide called: \"Building Blocks: A Guide to ZooKeeper Operations\" that currently contains no content.  The idea behind this section is document all the basic things you can do with the ZooKeeper API -- not every little detail, or even every call in the API, but the basics, like: how to connect to a server, how to read a node, how to write to a node, how to set a watch, etc. I will create a subtask for every section in this chapter.\n\nI don't mind writing up the these sections, if I can get the information, whether its' by phone, email, im, etc. ", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d4f4a5f627d6b05868105" }, "external_id" : "ZOOKEEPER-4", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Unnecessary condition check in FastLeaderElection", "desc" : " FastLeaderElection.java line 224: The part of the condition after && is not needed: This is the else branch of an if statement, where the condition is exactly the first part. Hence, the part after && *must* be true.", "created_at" : { "$date" : "2008-06-09T16:42:38.071+0000" }, "updated_at" : { "$date" : "2008-10-14T20:31:43.232+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f4a5f627d6b0586810d" }, "external_id" : "ZOOKEEPER-167", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Troubleshooting\"", "desc" : "We need the content / information / knowledge for the \"Troubleshooting\" subsection of the ZooKeeper Administrator's Guide. This is information about what to do when an existing deployment of ZooKeeper has problems. ", "created_at" : { "$date" : "2008-10-06T15:04:29.287+0000" }, "updated_at" : { "$date" : "2008-10-20T21:24:48.908+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d4f4b5f627d6b0586810f" }, "external_id" : "ZOOKEEPER-25", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FUSE for ZooKeeper", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1873981&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T21:32:30.131+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.811+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f4c5f627d6b05868126" }, "external_id" : "ZOOKEEPER-38", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "headers (version+) in log/snap files", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1961767&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:42:12.853+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.938+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f4c5f627d6b05868124" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4f4c5f627d6b05868125" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d4f4c5f627d6b05868125" }, "external_id" : "ZOOKEEPER-32", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f4c5f627d6b05868126" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2008-06-10T22:32:50.295+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.875+0000" }, "title" : "CRCs for ZooKeeper data", "issue_type" : "New Feature", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1945106&group_id=209147&atid=1008547", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f4e5f627d6b0586816f" }, "external_id" : "ZOOKEEPER-6", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "List of problem identifiers in zookeeper.h", "desc" : "Submitted on behalf of Jacob. Is is possible for us to address this in the next release? Will cause b/w compatibility issues for c client users but sounds like a good idea to fix now.\n--------\nI've attached a file with the problem identifiers. All of these\nidentifiers are unprotected by a ZOO_ (or something similar) prefix.\n\nI've also looked at zookeeper.jute.h and the names of some these structs\nare really unfortunate -- theyre sure to collide with some headers e.g.\nStat. There's also some exceptions to the consistent naming scheme --\nop_result_t, String_vector, Id_vector are the ones I noticed.\n\n-------- file -------\nThese enum constants are unprotected:\n\ntypedef enum {LOG_LEVEL_ERROR=1,LOG_LEVEL_WARN=2,LOG_LEVEL_INFO=3,LOG_LEVEL_DEBUG=4} ZooLogLevel;\n\nextern ZOOAPI const int PERM_READ;\nextern ZOOAPI const int PERM_WRITE;\nextern ZOOAPI const int PERM_CREATE;\nextern ZOOAPI const int PERM_DELETE;\nextern ZOOAPI const int PERM_ADMIN;\nextern ZOOAPI const int PERM_ALL;\n\nextern ZOOAPI struct Id ANYONE_ID_UNSAFE;\nextern ZOOAPI struct Id AUTH_IDS;\n\nextern ZOOAPI struct ACL_vector OPEN_ACL_UNSAFE;\nextern ZOOAPI struct ACL_vector READ_ACL_UNSAFE;\nextern ZOOAPI struct ACL_vector CREATOR_ALL_ACL;\n\nextern ZOOAPI const int EPHEMERAL;\nextern ZOOAPI const int SEQUENCE;\n\nextern ZOOAPI const int EXPIRED_SESSION_STATE;\nextern ZOOAPI const int AUTH_FAILED_STATE;\nextern ZOOAPI const int CONNECTING_STATE;\nextern ZOOAPI const int ASSOCIATING_STATE;\nextern ZOOAPI const int CONNECTED_STATE;\n\nextern ZOOAPI const int CREATED_EVENT;\nextern ZOOAPI const int DELETED_EVENT;\nextern ZOOAPI const int CHANGED_EVENT;\nextern ZOOAPI const int CHILD_EVENT;\nextern ZOOAPI const int SESSION_EVENT;\nextern ZOOAPI const int NOTWATCHING_EVENT;\n", "created_at" : { "$date" : "2008-06-10T20:42:02.577+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.405+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f4f5f627d6b0586817e" }, "external_id" : "ZOOKEEPER-15", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "handle failure better in build.xml:test", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1959060&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:15:39.188+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.578+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f4f5f627d6b05868184" }, "external_id" : "ZOOKEEPER-11", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ArrayList is used instead of List", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1941109&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:10:23.482+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.556+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f505f627d6b0586818a" }, "external_id" : "ZOOKEEPER-8", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Stat enchaned to include num of children and size", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1886743&group_id=209147&atid=1008544\n", "created_at" : { "$date" : "2008-06-10T21:05:10.988+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.505+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f515f627d6b058681a8" }, "external_id" : "ZOOKEEPER-7", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Use enums rather than ints for types and state", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1831408&group_id=209147&atid=1008544\n\nWould be nice to fix in 3.0 as it's a non-bw compat change, also user feedback show's confusion on state/event/missingjavadoc.\n", "created_at" : { "$date" : "2008-06-10T21:01:06.652+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.457+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f515f627d6b058681a7" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d4f525f627d6b058681b4" }, "external_id" : "ZOOKEEPER-21", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improve zk ctor/watcher (state transition) docs", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1985723&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:25:05.836+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.731+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f525f627d6b058681c1" }, "external_id" : "ZOOKEEPER-20", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Child watches are not triggered when the node is deleted", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1981340&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:23:59.634+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.697+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f515f627d6b058681a7" }, "external_id" : "ZOOKEEPER-18", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f515f627d6b058681a8" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4f535f627d6b058681c7" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-06-10T21:20:06.936+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.662+0000" }, "title" : "keeper state inconsistency", "issue_type" : "Bug", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1979772&group_id=209147&atid=1008544", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f545f627d6b058681d2" }, "external_id" : "ZOOKEEPER-17", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper_init doc needs clarification", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1967467&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:18:37.792+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.628+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f555f627d6b058681ea" }, "external_id" : "ZOOKEEPER-1", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Initial ZooKeeper code contribution from Yahoo!", "desc" : "This is a SVN dump of the ZooKeeper repository (version 175) from SourceForge.\n\nhttp://sourceforge.net/projects/zookeeper/\n", "created_at" : { "$date" : "2008-06-06T22:02:18.042+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:37.111+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f555f627d6b058681f6" }, "external_id" : "ZOOKEEPER-45", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Restructure the SVN repository after initial import", "desc" : "SVN and the ant build have to be updated after the initial import from SourceForge (see INFRA-1644) in order to get us aligned with Apache release process/collateral and some general cleanup of the repository. Please review/comment on the following:\n\nI intend to follow these steps:\n1) collapse svn hadoop/zookeeper/trunk/zookeeper/... down to hadoop/zookeeper/trunk/... (remove unnecessary zk dir  under trunk)\n\n2) change the java package prefix from com.yahoo to org.apache\n3) update the license headers in all  source files\n4) replace LICENSE file in root dir with Apache LICENSE file\n5) add attribution NOTICE file to root dir\n6) update the README file appropriately\n\n7) create a new \"src\" directory in the zk root\n8) move root \"c\" directory into src\n9) move root \"java\" directory into src\n10) create root \"docs\" directory\n11) create src/docs directory\n12) rename src/java/src to src/java/main\n13) move root \"test\" directory to src/java/test\n\n14) build.xml will be updated appropriately for all the moves. it will also be updated with apache specific targets similar to what exists in hadoop (such as building the forrest documentation).\n\nsteps 10&11 are required for zk documentation storage. src/docs is the location of all documentation in \"forrest xml\" format - the documentation source/originals (what you edit when you change the docs).  the ant script is setup to build docs (forrest) into the root docs directory. these files are also committed to svn (both docs and src/docs). later, during a release process, the files in the root docs directory are checked out onto the system hosting the apache web site and pushed to the mirrors.\n\nI'll submit patches for any changes/additions of files. However I suspect that the directory move operations in SVN will not have an accompanying patch - this \"script\" is the documentation of what will be changed (comments added for any deviation).\n", "created_at" : { "$date" : "2008-06-13T06:18:17.641+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:38.158+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f565f627d6b0586821b" }, "external_id" : "ZOOKEEPER-44", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "DataTree does not use natural sort for getChildren", "desc" : "DataTree.getChildren() performs Collection.sort() on the list of children before returning it, but Java's default comparator for Strings will sort 'lock-20' before 'lock-3' for instance. ", "created_at" : { "$date" : "2008-06-11T04:17:46.854+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:38.122+0000" }, "creator_id" : { "$oid" : "5b7d4f56e9214a0d1608d877" }, "reporter_id" : { "$oid" : "5b7d4f56e9214a0d1608d877" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f585f627d6b05868235" }, "external_id" : "ZOOKEEPER-43", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Server side of the auto reset watches patch", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1975262&group_id=209147&atid=1008546", "created_at" : { "$date" : "2008-06-10T22:51:46.051+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:38.089+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f595f627d6b05868256" }, "external_id" : "ZOOKEEPER-42", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Change LE default to Fast TCP", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1970356&group_id=209147&atid=1008546", "created_at" : { "$date" : "2008-06-10T22:50:30.843+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:38.053+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f595f627d6b05868266" }, "external_id" : "ZOOKEEPER-41", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Sample startup script", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1951806&group_id=209147&atid=1008546", "created_at" : { "$date" : "2008-06-10T22:48:50.029+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:38.007+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5a5f627d6b05868273" }, "external_id" : "ZOOKEEPER-68", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "parseACLs in ZooKeeper.java fails to parse elements of ACL, should be lastIndexOf rather than IndexOf", "desc" : "the parseACLs(String aclString) method attempts to prase ACLs from the form of scheme:id:perm into the three components, delineated by the colons.  The current version calls indexOf for both the first and second colon, receiving the same value for both and failing as if there were only one colon in the string.  I created a one-line patch to call lastIndexOf for the second colon.", "created_at" : { "$date" : "2008-07-07T22:11:14.375+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.729+0000" }, "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5a5f627d6b05868282" }, "external_id" : "ZOOKEEPER-75", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup the library directory", "desc" : "The cobertura library is GPL and must be removed from the code base. All of the X.jar files should have matching X.license files that contain their license. There is no license for junit. ", "created_at" : { "$date" : "2008-07-15T22:50:25.445+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.960+0000" }, "creator_id" : { "$oid" : "5b7d4f5ae9214a0d1608d878" }, "reporter_id" : { "$oid" : "5b7d4f5ae9214a0d1608d878" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5b5f627d6b05868294" }, "external_id" : "ZOOKEEPER-76", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Commit 677109 removed the cobertura library, but not the build targets.", "desc" : "Cobertura library removed due to licensing issues, but the code-coverage ant targets were left in.  Have deleted them and created patch.", "created_at" : { "$date" : "2008-07-16T02:30:29.367+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.999+0000" }, "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5c5f627d6b058682ab" }, "external_id" : "ZOOKEEPER-71", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Determine what to do re ZooKeeper Changelog(s)", "desc" : "This JIRA is to collect feedback and document what we will be doing re changelog file(s) in zookeeper SVN repository/release.\n\nSee ZOOKEEPER-45 for some background, summary:\n\n* suggestion was made to have single CHANGES.txt, similar to hadoop core/hbase\n   However a concern was brought up that it would be better to have 2 files - one for java code (client & server) and one for C client. This would make it easier for users to discern (C client users would see it broken out in separate file)\n\nPlease add comments/votes for what you think we should do.\n", "created_at" : { "$date" : "2008-07-08T17:05:47.529+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.793+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5c5f627d6b058682b4" }, "external_id" : "ZOOKEEPER-70", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add skeleton forrest doc structure for ZooKeeper", "desc" : "Add a skeleton forrest doc structure for ZooKeeper.\n\nDoug has suggested using hbase as a starting point.\n\nNote: I noticed that forrest doesn't work with java6, it will run with java5.\n", "created_at" : { "$date" : "2008-07-08T17:01:44.003+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.764+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5c5f627d6b058682b3" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f5d5f627d6b058682cc" }, "external_id" : "ZOOKEEPER-73", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Move ZK wiki from SourceForge to Apache", "desc" : "Move the ZK wiki content from sourceforge to apache wiki.\n\nbase Apache page is:\n\nhttp://wiki.apache.org/hadoop/ZooKeeper\n", "created_at" : { "$date" : "2008-07-08T17:30:22.356+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.912+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5d5f627d6b058682cb" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f5c5f627d6b058682b3" }, "external_id" : "ZOOKEEPER-72", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5c5f627d6b058682b4" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-07-08T17:10:47.524+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.844+0000" }, "title" : "Initial creation/setup of ZooKeeper ASF site.", "issue_type" : "Task", "desc" : "Using the output of ZOOKEEPER-70 generate the ZooKeeper apache.org site.\n\nOut structure/process is based on Hadoop's \"how to release\" document:\nhttp://wiki.apache.org/hadoop/HowToRelease", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f5e5f627d6b058682e1" }, "external_id" : "ZOOKEEPER-111", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5e5f627d6b058682e3" }, "external_id" : "ZOOKEEPER-61", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Address (remove) use of sleep(#) in client/server test cases.", "desc" : "Many of the java client/server test cases use \"sleep(x)\" during initial rendezvous. This makes the tests slow, very brittle and they tend to fail occasionally during CI (depending on load). In particular I've seen QuorumTest exhibit this.\n\nWould also be nice if we could extract the \"base\" client/server test functionality to enable re-use and make test writing easier. I started this with ClientBase in tests but could do a better job.", "created_at" : { "$date" : "2008-06-30T21:55:45.673+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.636+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5e5f627d6b058682e2" }, "effect" : "duplicates", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d4f5e5f627d6b058682e1" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f5f5f627d6b058682f4" }, "external_id" : "ZOOKEEPER-63", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Race condition in client close() operation", "desc" : "There is a race condition in the java close operation on ZooKeeper.java.\n\nClient is sending a disconnect request to the server. Server will close any open connections with the client when it receives this. If the client has not yet shutdown it's subthreads (event/send threads for example) these threads may consider the condition an error. We see this alot in the tests where the clients output error logs because they are unaware that a disconnection has been requested by the client.\n\nBen mentioned: perhaps we just have to change state to closed (on client) before sending disconnect request.\n", "created_at" : { "$date" : "2008-06-30T22:08:36.288+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.661+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5f5f627d6b058682f3" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4f5f5f627d6b058682f2" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f605f627d6b05868323" }, "external_id" : "ZOOKEEPER-58", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Race condition on ClientCnxn.java", "desc" : "There is a race condition involving the ByteByffer incomingBuffer, a field of ClientCnxn.SendThread. SendThread reads a packet in two steps: first it reads the length of the packet, followed by a read of the packet itself. Each of these steps corresponds to a call to doIO() from the main loop of run(). If there is an exception or the session times out, then it may leave incomingBuffer in an inconsistent state. \n\nThe attached patch adds code to reset incomingBuffer upon a call to SendThread.cleanup(). This method is called upon an exception on run().", "created_at" : { "$date" : "2008-06-27T15:38:34.954+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.584+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f615f627d6b0586833d" }, "external_id" : "ZOOKEEPER-55", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "build.xml failes to retrieve a release number from SVN and the ant target \"dist\" fails", "desc" : "Due to the recent directory layout change,\n1) the ant target \"svn-revision\" fails to retrieve the release number,\n2) the ant target \"dist\" fails to create the distribution package.", "created_at" : { "$date" : "2008-06-26T21:13:32.594+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.490+0000" }, "creator_id" : { "$oid" : "5b7d4f38e9214a0d1608d869" }, "reporter_id" : { "$oid" : "5b7d4f38e9214a0d1608d869" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f38e9214a0d1608d869" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f625f627d6b0586834a" }, "external_id" : "ZOOKEEPER-56", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add clover support to build.xml", "desc" : "Clover is what ASF uses for code coverage. We currently have cobertura, but need to add support for clover (keep the existing cobertura support for individual developers to use). Clover is run automatically by ASF Hudson.\n\nHadoop has support for clover in their build.xml, port their clover related targets into zookeeper build.xml\n\n", "created_at" : { "$date" : "2008-06-26T22:26:11.012+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.531+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f625f627d6b05868359" }, "external_id" : "ZOOKEEPER-53", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "tests failing on solaris.", "desc" : "tests are failing on solaris and randomly on my machine as well.", "created_at" : { "$date" : "2008-06-25T22:43:46.265+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.362+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5e5f627d6b058682e2" }, "external_id" : "ZOOKEEPER-54", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "tests" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5e5f627d6b058682e1" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4f5e5f627d6b058682e3" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-06-25T23:30:36.411+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2008-10-26T01:10:40.432+0000" }, "title" : "remove sleeps in the tests.", "issue_type" : "Bug", "desc" : "remove the sleeps in the tests. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f645f627d6b05868376" }, "external_id" : "ZOOKEEPER-115", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Potential NPE in QuorumCnxManager", "desc" : "Findbugs flagged this, notice that we are checking for null after using the reference.\n\n               if (senderWorkerMap.get(s.socket().getInetAddress()) != null) {\n                    senderWorkerMap.get(s.socket().getInetAddress()).finish();\n                }\n\n                /*\n                 * Start new worker thread with a clean state.\n                 */\n                if (s != null) {", "created_at" : { "$date" : "2008-08-07T21:10:41.986+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.957+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f645f627d6b05868385" }, "external_id" : "ZOOKEEPER-108", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "sync implementation reorders operations", "desc" : "The current implementation of sync is broken. There is a race condition that causes a follower to return operations out of order, causing clients to drop their connections to a server.\n\nI'll be attaching a patch to fix this problem shortly.", "created_at" : { "$date" : "2008-08-01T02:48:45.706+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.712+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f655f627d6b058683ad" }, "external_id" : "ZOOKEEPER-74", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f655f627d6b058683ae" }, "external_id" : "ZOOKEEPER-101", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Integrate ZooKeeper with \"violations\" feature on hudson", "desc" : "\"violations\" integrates into hudson and supports many more tools than just checkstyle.\n\nhttp://hudson.gotdns.com/wiki/display/HUDSON/Violations\nhttp://hudson.zones.apache.org/hudson/view/Hadoop/job/Hadoop-trunk/", "created_at" : { "$date" : "2008-07-25T18:27:04.304+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.352+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f655f627d6b058683ad" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f665f627d6b058683b8" }, "external_id" : "ZOOKEEPER-97", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The code generators should support an optional output directory", "desc" : "Currently the code generators (jute compiler and version gen) generate code the current directory.  If these tools are to be re-used by smart ides, ant tasks, or maven plugins, the output directory needs to be parameter to the tools.", "created_at" : { "$date" : "2008-07-25T14:27:53.850+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.311+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f675f627d6b058683c9" }, "external_id" : "ZOOKEEPER-110", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Build script relies on svnant, which is not compatible with subversion 1.5 working copies", "desc" : "The current build.xml ant script uses svnant to obtain the latest revision number from the repo, however svnant is not compatible with subversion 1.5 (http://subversion.tigris.org/svn_1.5_releasenotes.html), and so the build fails with working copies checked out by this version.  The build fails with \"this version of subversion is too old, please get a newer version...\"  This will become more apparent as svn 1.5 trickles out; I'm using a brand new dev environment with both subclipse 1.4 and svn 1.5 client, so I got bit rather quickly.\n\nThose with svn 1.5 can get the code from the trunk, but cannot do an ant build.\n\nsvnant hasn't been updated in more than a year and appears to be dead, so it may no longer be a viable tool for the ant build.", "created_at" : { "$date" : "2008-08-05T18:18:25.111+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.801+0000" }, "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [  ], "environment" : "Subversion 1.5 command line, or subclipse version 1.4.x" },
{ "_id" : { "$oid" : "5b7d4f675f627d6b058683f4" }, "external_id" : "ZOOKEEPER-109", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup of NPE and Resource issue nits found by static analysis", "desc" : "NPE/ResourceLeak cleanup for issues found during static analysis.\n", "created_at" : { "$date" : "2008-08-01T22:01:07.690+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.752+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f685f627d6b05868401" }, "external_id" : "ZOOKEEPER-93", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create Documentation for Zookeeper", "desc" : "Initial version of the documentation, migrated from source forge.  Reorganizing, expanding.  Initial goal is to port Source Forge documentation into Forrest. ", "created_at" : { "$date" : "2008-07-24T17:49:32.275+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.284+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 60, "environment" : "N/A" },
{ "_id" : { "$oid" : "5b7d4f695f627d6b05868413" }, "external_id" : "ZOOKEEPER-90", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "invoke WhenOwnerListener.whenNotOwner() when the ZK session expires and the znode is the leader", "created_at" : { "$date" : "2008-07-24T09:46:13.409+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.247+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" } },
{ "_id" : { "$oid" : "5b7d4f695f627d6b0586841d" }, "external_id" : "ZOOKEEPER-89", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "invoke WhenOwnerListener.whenNotOwner() when the ZK connection fails", "created_at" : { "$date" : "2008-07-24T09:44:27.090+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.223+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" } },
{ "_id" : { "$oid" : "5b7d4f6a5f627d6b05868425" }, "external_id" : "ZOOKEEPER-105", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper java client main loop crashes on KeeperExceptions", "desc" : "The ZooKeeper java client main loop crashes on KeeperExceptions.  They should be handled when possible.", "created_at" : { "$date" : "2008-07-26T03:27:58.323+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.624+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6b5f627d6b05868438" }, "external_id" : "ZOOKEEPER-79", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document jacob's leader election on the wiki recipes page", "desc" : "The following discussion occurred on the zookeeper-user list. We need to formalize this recipe and document on the wiki recipes page:\n\n---------------------from jacob ----------------\nAvinash\n\n \n\nThe following protocol will help you fix the observed misbehavior. As Flavio points out, you cannot rely on the order of nodes in getChildren, you must use an intrinsic property of each node to determine who is the leader. The protocol devised by Runping Qi and described here will do that.\n\n \n\nFirst of all, when you create child nodes of the node that holds the leadership bids, you must create them with the EPHEMERAL and SEQUENCE flag. ZooKeeper guarantees to give you an ephemeral node named uniquely and with a sequence number larger by at least one than any previously created node in the sequence. You provide a prefix, like \"L_\" or your own choice, and ZooKeeper creates nodes named \"L_23\", \"L_24\", etc. The sequence number starts at 0 and increases monotonously.\n\n \n\nOnce you've placed your leadership bid, you search backwards from the sequence number of *your* node to see if there are any preceding (in terms of the sequence number) nodes. When you find one, you place a watch on it and wait for it to disappear. When you get the watch notification, you search again, until you do not find a preceding node, then you know you're the leader. This protocol guarantees that there is at any time only one node that thinks it is the leader. But it does not disseminate information about who is the leader. If you want everyone to know who is the leader, you can have an additional Znode whose value is the name of the current leader (or some identifying information on how to contact the leader, etc.). Note that this cannot be done atomically, so by the time other nodes find out who the leader is, the leadership may already have passed on to a different node.\n\n \n\nFlavio\n\n \n\nMight it make sense to provide a standardized implementation of leader election in the library code in Java?\n\n \n\n--Jacob\n\n \n\nFrom: zookeeper-user-bounces@lists.sourceforge.net [mailto:zookeeper-user-bounces@lists.sourceforge.net] On Behalf Of Flavio Junqueira\nSent: Friday, July 11, 2008 1:02 AM\nTo: zookeeper-user@lists.sourceforge.net\nCc: zookeeper-user@hadoop.apache.org\nSubject: Re: [Zookeeper-user] Leader election\n\n \n\nHi Avinash, getChildren returns a list in lexicographic order, so if you are updating the children of the election node concurrently, then you may get a different first node with different clients. If you are using the sequence flag to create nodes, then you may consider stripping the prefix of the node name and using the sufix value to determine order.\n\nHope it helps.\n\n-Flavio\n\n \n\n----- Original Message ----\nFrom: Avinash Lakshman <avinash.lakshman@gmail.com>\nTo: zookeeper-user@lists.sourceforge.net\nSent: Friday, July 11, 2008 7:20:06 AM\nSubject: [Zookeeper-user] Leader election\n\nHi\n\nI am trying to elect leader among 50 nodes. There is always one odd guy who seems to think that someone else distinct from what some other nodes see as leader. Could someone please tell me what is wrong with the following code for leader election:\n\npublic void electLeader()\n        {           \n            ZooKeeper zk = StorageService.instance().getZooKeeperHandle();\n            String path = \"/Leader\";\n            try\n            {\n                String createPath = path + \"/L-\";                               \n                LeaderElector.createLock_.lock();\n                while( true )\n                {\n                    /* Get all znodes under the Leader znode */\n                    List<String> values = zk.getChildren(path, false);\n                    /*\n                     * Get the first znode and if it is the\n                     * pathCreated created above then the data\n                     * in that znode is the leader's identity.\n                    */\n                    if ( leader_ == null )\n                    {\n                        leader_ = new AtomicReference<EndPoint>( EndPoint.fromBytes( zk.getData(path + \"/\" + values.get(0), false, null) ) );\n                    }\n                    else\n                    {\n                        leader_.set( EndPoint.fromBytes( zk.getData(path + \"/\" + values .get(0), false, null) ) );\n                        /* Disseminate the state as to who the leader is. */\n                        onLeaderElection();\n                    }\n                    logger_.debug(\"Elected leader is \" + leader_ + \" @ znode \" + ( path + \"/\" + values.get(0) ) );                  \n                    Collections.sort(values);\n                    /* We need only the last portion of this znode */\n                    String[] peices = pathCreated_.split(\"/\");\n                    int index = Collections.binarySearch(values, peices[peices.length - 1]);                  \n                    if ( index > 0 )\n                    {\n                        String pathToCheck = path + \"/\" + values.get(index - 1);\n                        Stat stat = zk.exists(pathToCheck, true);\n                        if ( stat != null )\n                        {\n                            logger_.debug(\"Awaiting my turn ...\");\n                            condition_.await();\n                            logger_.debug(\"Checking to see if leader is around ...\");\n                        }\n                    }\n                    else\n                    {\n                        break;\n                    }\n                }\n            }\n            catch ( InterruptedException ex )\n            {\n                logger_.warn(LogUtil.throwableToString(ex));\n            }\n            catch ( KeeperException ex )\n            {\n                logger_.warn(LogUtil.throwableToString(ex));\n            }\n            finally\n            {\n                LeaderElector.createLock_.unlock();\n            }\n        }\n    }\n\nThanks\nAvinash\n\n \n\n\n\n-------------------------------------------------------------------------\nSponsored by: SourceForge.net Community Choice Awards: VOTE NOW!\nStudies have shown that voting for your favorite open source project,\nalong with a healthy diet, reduces your potential for chronic lameness\nand boredom. Vote Now at http://www.sourceforge.net/community/cca08\n\n\n\n_______________________________________________\nZookeeper-user mailing list\nZookeeper-user@lists.sourceforge.net\nhttps://lists.sourceforge.net/lists/listinfo/zookeeper-user\n", "created_at" : { "$date" : "2008-07-17T16:43:35.152+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.079+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4f6b5f627d6b05868437" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f6c5f627d6b0586844b" }, "external_id" : "ZOOKEEPER-117", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "threading issues in Leader election", "desc" : "Leader.lead() creates a new thread that can never terminate (short of restarting vm)\n\nnaked notifyall in lead() method - what is the condition variable? Best if set inside the sync block\n", "created_at" : { "$date" : "2008-08-11T18:04:32.229+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.999+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6c5f627d6b05868462" }, "external_id" : "ZOOKEEPER-114", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup ugly event messages in zookeeper client", "desc" : "Cleanup the event messages output by the java command line client:\n\nThe java client ZooKeeper.java has a process method in MyWatcher that prints raw event information to the console. Many new users find this confusing (esp since state changes have a null path). \n\n        public void process(WatcherEvent event) {\n            System.err.println(event.getPath() + \": \" + event.getState() + \"-\"\n                    + event.getType());\n        }\n\nIf this is a state change we should print that, if it's an event we should print that (state change doesn't have a path). Somewhere in the message we should also indicate that the client received a watch notification from the server.", "created_at" : { "$date" : "2008-08-06T23:31:08.201+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.929+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f6c5f627d6b05868461" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4f6c5f627d6b05868461" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f6d5f627d6b0586846f" }, "external_id" : "ZOOKEEPER-112", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "src/java/main ZooKeeper.java has test code embedded into it.", "desc" : "src/java/main ZooKeeper.java has a method \"public void disconnect()\" that is not part of the public api but put there for testing purposes (to test disconnection of the client from the server w/o actually shutting down the session)\n\nThis method needs to be moved out of the public api. preferably we should have a subclass in the test code itself that provides this method.\n\n", "created_at" : { "$date" : "2008-08-06T21:01:27.792+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.876+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6e5f627d6b05868484" }, "external_id" : "ZOOKEEPER-85", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "register the ZooKeeper mailing lists with nabble.com", "desc" : "Many apache projects including Hadoop register with nabble to host\nonline forums & great online archives of the mailing lists...\nhttp://www.nabble.com/Hadoop-f17066.html\nCurrently there's hadoop-core, hbase and lucene on there.\n\nI often refer to mailing list posts by nabble link; they're really\nhandy. Plus end users often prefer the forum style nabble approach to\ngetting every single email sent to a mailing list.\n\nDoes a committer on zookeeper fancy registering the ZK mailing lists\ntoo (as a child of the Hadoop list)? I'd do it myself but then I'd be\nthe owner of the forum which doesn't feel right - a committer should\nprobably do it.\n\nIts a pretty quick process, click here\nhttp://n2.nabble.com/more/MailingListRequest.jtp\n\nand fill out the details. The hardest part is knowing the mailing list\nsoftware which AFAIK is ezmlm :)", "created_at" : { "$date" : "2008-07-23T16:33:37.466+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:41.155+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6e5f627d6b0586848b" }, "external_id" : "ZOOKEEPER-128", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test coverage on async client operations needs to be improved", "desc" : "clover reports limited testing of the async client operations. need addition tests to verify this functionality.", "created_at" : { "$date" : "2008-08-28T19:42:57.444+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.294+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6f5f627d6b0586849a" }, "external_id" : "ZOOKEEPER-125", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Class not needed on FastLeaderElection", "desc" : "There is a class (ElectionResult) on both FastLeaderElection and AuthFastLeaderElection that was needed originally in LeaderElection, and it was copied and pasted unnecessarily, but it is not necessary in those classes. ", "created_at" : { "$date" : "2008-08-26T11:03:29.786+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.203+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f705f627d6b058684a8" }, "external_id" : "ZOOKEEPER-124", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "StatCallback is broken in trunk", "desc" : "StatCallback appears to be broken in trunk. I'll attach a patch for AsyncTest that triggers the behaviour.", "created_at" : { "$date" : "2008-08-25T01:00:45.638+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.171+0000" }, "creator_id" : { "$oid" : "5b7d4f56e9214a0d1608d877" }, "reporter_id" : { "$oid" : "5b7d4f56e9214a0d1608d877" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server", "java client", "tests" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f705f627d6b058684a7" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Linux corner-cube 2.6.24-19-generic #1 SMP Fri Jul 11 23:41:49 UTC 2008 i686 GNU/Linux\njava version \"1.6.0_06\"\nJava(TM) SE Runtime Environment (build 1.6.0_06-b02)\nJava HotSpot(TM) Client VM (build 10.0-b22, mixed mode, sharing)" },
{ "_id" : { "$oid" : "5b7d4f705f627d6b058684c5" }, "external_id" : "ZOOKEEPER-123", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "In two places, the wrong class is specified for the logger", "desc" : "Copy and paste strikes again.  In two logger instantiations, the wrong class is passed to the constructor.  In ClientTest.java and ClientCnxn.java", "created_at" : { "$date" : "2008-08-24T19:29:13.949+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.131+0000" }, "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "tests", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f715f627d6b058684d2" }, "external_id" : "ZOOKEEPER-130", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update build.xml to support apache release process", "desc" : "update the build process to support \"tar\" and \"binary\" targets similar in structure to hadoop-core build. this is needed as part of the 3.0.0 release process.\n", "created_at" : { "$date" : "2008-08-29T23:33:10.316+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.335+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f725f627d6b058684e3" }, "external_id" : "ZOOKEEPER-122", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE in jute's Utils.toCSVString", "desc" : "java.lang.NullPointerException\n        at org.apache.jute.Utils.toCSVString(Utils.java:128)\n        at org.apache.jute.CsvOutputArchive.writeString(CsvOutputArchive.java:94\n)\n        at org.apache.zookeeper.proto.WatcherEvent.toString(WatcherEvent.java:60\n)\n        at java.lang.String.valueOf(String.java:2827)\n        at java.lang.StringBuilder.append(StringBuilder.java:115)\n        at com.liveoffice.mailindex.watchers.SuicidalWatcher.process(SuicidalWat\ncher.java:11)\n        at org.apache.zookeeper.ZooKeeper.processWatchEvent(ZooKeeper.java:157)\n        at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:268)\n", "created_at" : { "$date" : "2008-08-19T00:05:24.976+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.100+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f535f627d6b058681c7" }, "external_id" : "ZOOKEEPER-139", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f515f627d6b058681a7" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4f6c5f627d6b05868461" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "parent_issue_id" : { "$oid" : "5b7d4f515f627d6b058681a8" }, "created_at" : { "$date" : "2008-09-11T02:36:25.283+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.970+0000" }, "title" : "Create Enums for WatcherEvent's KeeperState and EventType", "issue_type" : "Sub-task", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f705f627d6b058684a7" }, "external_id" : "ZOOKEEPER-137", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f705f627d6b058684a8" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-09-08T21:02:48.333+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.572+0000" }, "title" : "client watcher objects can lose events", "issue_type" : "Bug", "desc" : "if a single watcher (A) is registered on a single node for both a getdata and exists watch the second watch event may be lost:\n\n1) getdata(\"node\", A)\n2) setdata(\"node\"...)\n3) exists(\"node\", A)\n4) delete(\"node\"...)\n\nif watch events for 2 is processed on the client (zookeeper.java, zkwatcher) after 3 completes then the zkwatcher process event method will clear the watch and the subsequent operation's (4) event will be ignored", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f745f627d6b05868521" }, "external_id" : "ZOOKEEPER-138", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client watcher objects can lose events", "desc" : "if a single watcher (A) is registered on a single node for both a getdata and exists watch the second watch event may be lost:\n\n1) getdata(\"node\", A)\n2) setdata(\"node\"...)\n3) exists(\"node\", A)\n4) delete(\"node\"...)\n\nif watch events for 2 is processed on the client (zookeeper.java, zkwatcher) after 3 completes then the zkwatcher process event method will clear the watch and the subsequent operation's (4) event will be ignored", "created_at" : { "$date" : "2008-09-08T21:03:47.900+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.874+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f745f627d6b05868520" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d4f755f627d6b0586852d" }, "external_id" : "ZOOKEEPER-136", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "sync causes hang in all followers of quorum", "desc" : "The attached test causes all of the followers of a quorum to hang. Leader continues to function correctly.", "created_at" : { "$date" : "2008-09-05T18:27:46.086+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.542+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f765f627d6b0586854f" }, "external_id" : "ZOOKEEPER-134", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "findbugs cleanup", "desc" : "cleaned up a number of findbugs warnings, in particular:\n\n1) added @overrides appropriately\n2) import cleanups\n3) log or document many empty blocks\n4) resource cleanup (usually by adding finally blocks)\n", "created_at" : { "$date" : "2008-09-03T23:06:30.966+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.495+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f775f627d6b0586855a" }, "external_id" : "ZOOKEEPER-133", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson tests failing intermittently", "desc" : "There is a bug in the ClientTest.java unit test, timing issue in \"withWatcherObj\" test. Patch forthcoming.\n", "created_at" : { "$date" : "2008-09-03T20:46:12.674+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.461+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f775f627d6b05868567" }, "external_id" : "ZOOKEEPER-132", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create Enum to replace CreateFlag in ZooKepper.create method", "desc" : "Replace the current named constant integer in the craete method with a typesafe enum value.", "created_at" : { "$date" : "2008-09-03T03:20:00.059+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.424+0000" }, "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f515f627d6b058681a8" } },
{ "_id" : { "$oid" : "5b7d4f785f627d6b0586857b" }, "external_id" : "ZOOKEEPER-131", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Old leader election can elect a dead leader over and over again", "desc" : "I think there is a race condition that is probably easy to get into with the old leader election and a large number of servers:\n\n1) Leader dies\n2) Followers start looking for a new leader before all Followers have abandoned the Leader\n3) The Followers looking for a new leader see votes of Followers still following the (now dead) Leader and start voting for the dead Leader\n4) The dead Leader gets reelected.\n\nFor the old leader election a server should not vote for another server that is not nominating himself.", "created_at" : { "$date" : "2008-09-02T17:27:07.647+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.382+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f795f627d6b0586858e" }, "external_id" : "ZOOKEEPER-118", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "findbugs flagged switch statement in followerrequestprocessor.run()", "desc" : "followerrequestprocessor:\n\nis the case statement for SYNC supposed to fall through?\n                switch (request.type) {\n                case OpCode.sync:\n                    zks.pendingSyncs.add(request);\n                case OpCode.create:\n\nPlease update the docs/code appropriately (if correct note it with comment just after the sync case statement.\n", "created_at" : { "$date" : "2008-08-11T18:07:56.473+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:42.055+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f795f627d6b0586859b" }, "external_id" : "ZOOKEEPER-184", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "tests: An explicit include derective is needed for the usage of memcpy(), memset(), strlen(), strdup() and free() functions.", "desc" : "Some compilation environments provide implicit inclusion of certain system headers.\nBut any way it's not a reason to exploit it in platform-independent projects.\n\nTestHashtable.cc and LibCMocks.h from src/c/tests/ use those functions without including corresponding system headers.\n\nModern versions of GCC are very strict.\nYou cannot build the code like this with the help of GCC version 4.3.", "created_at" : { "$date" : "2008-10-13T11:52:48.576+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.930+0000" }, "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d4f5d5f627d6b058682cb" }, "external_id" : "ZOOKEEPER-181", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5d5f627d6b058682cc" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-10-09T15:45:23.063+0000" }, "original_time_estimate" : 172800, "priority" : "Major", "desc" : "Some Source Forge Documents did not get moved over: \n\njavaExample\nzookeeperTutorial\n(These two I will move over directly)\n \nzookeeperLogging\nzookeeperAtomicBroadcast\n(These two I will roll up into a new document: zookeeperInternals)\n\nWe can expand zookeeperInterals as new sections are needed, maybe one day morphing it into the \"complete guide for zookeeper contributers\"", "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.593+0000" }, "title" : "Some Source Forge Documents did not get moved over: javaExample, zookeeperTutorial, zookeeperInternals", "issue_type" : "Bug", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f7b5f627d6b058685c1" }, "external_id" : "ZOOKEEPER-180", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Placeholder sections needed in document for new topics that the umbrella jira discusses", "desc" : "The admin doc needs some sections so contributors can add the new topics: designing, provisioning, etc. ", "created_at" : { "$date" : "2008-10-08T00:08:52.986+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.567+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" } },
{ "_id" : { "$oid" : "5b7d4f7c5f627d6b058685d0" }, "external_id" : "ZOOKEEPER-179", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "need new sections for basic operations content", "desc" : "The zookeeperProgrammers.xml, which is the Programmer's Guide, needs new sections for each of the new topics that the JIRA talks about. For now they can be empty.", "created_at" : { "$date" : "2008-10-07T23:40:00.271+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.487+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f455f627d6b058680e7" } },
{ "_id" : { "$oid" : "5b7d4f7c5f627d6b058685dd" }, "external_id" : "ZOOKEEPER-185", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improved version of FLETest", "desc" : "FLETest sometimes fails because we don't run it along with all other parts of ZooKeeper. I'm attaching a patch that modifies the current implementation of FLETest and simulates the expected behavior of other parts of ZooKeeper when running along with them. ", "created_at" : { "$date" : "2008-10-13T23:21:08.806+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.965+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f7d5f627d6b058685ee" }, "external_id" : "ZOOKEEPER-183", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Array subscript is above array bounds in od_completion(), src/cli.c.", "desc" : "Having:\n        char buf[4096*16];\nPresent:\n        buf[sizeof(buf)]=0;\nMust be:\n        buf[sizeof(buf)-1]=0;\n", "created_at" : { "$date" : "2008-10-10T16:05:24.415+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.683+0000" }, "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d4f7e5f627d6b058685fd" }, "external_id" : "ZOOKEEPER-182", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper_init accepts empty host-port string and returns valid pointer to zhandle_t.", "desc" : "Please, add this test to src/c/tests/TestZookeeperInit.cc to reproduce this:\n\n    void testEmptyAddressString()\n    {\n        zh=zookeeper_init(\"\",0,0,0,0,0);\n        CPPUNIT_ASSERT(zh==0);\n    }\n", "created_at" : { "$date" : "2008-10-10T15:49:42.022+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.634+0000" }, "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d4f7e5f627d6b05868612" }, "external_id" : "ZOOKEEPER-178", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLE test.", "desc" : "fast leader election test failing .", "created_at" : { "$date" : "2008-10-06T20:50:15.001+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.460+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f7f5f627d6b05868629" }, "external_id" : "ZOOKEEPER-156", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update programmer guide with acl details from old wiki page", "desc" : "Need to update the programmer guide with the acl details form the old wiki page.\n\nhttp://zookeeper.wiki.sourceforge.net/ZooKeeperACLs\n\n", "created_at" : { "$date" : "2008-10-02T22:39:43.804+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.355+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f805f627d6b05868639" }, "external_id" : "ZOOKEEPER-151", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document change to server configuration", "desc" : "The patch of jira 127 changed the format of server configuration files, but it didn't change the documentation. ", "created_at" : { "$date" : "2008-10-01T20:23:05.126+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.253+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f805f627d6b0586864e" }, "external_id" : "ZOOKEEPER-147", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "This is version of the documents with most of the [tbd...] scrubbed out", "desc" : "The docs had lots of comments to myself marked [tbd..]. I scrubbed these out. I still have a list I will work from, but the [tbd]s are probably sensible to anyone else. For a few cases where it's obvious what a tbd is asking, I left in in, just in case someone else wants to take a crack at fixing them, knows the answer, etc. \n\nThe estimate below refers to how many full days I think it would take to get all the tbd's answered and put back into the document. ", "created_at" : { "$date" : "2008-09-26T03:50:35.471+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.163+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 345600 },
{ "_id" : { "$oid" : "5b7d4f815f627d6b05868667" }, "external_id" : "ZOOKEEPER-145", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "write detailed release notes for users migrating from 2.x to 3.0", "desc" : "We need to write detailed release notes that detail how c and java client API users as well as zk server administrators migrate from 2.x to 3.x zookeeper release.\n", "created_at" : { "$date" : "2008-09-25T22:43:25.011+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.127+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "c client", "java client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f815f627d6b05868666" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f6c5f627d6b05868461" }, "external_id" : "ZOOKEEPER-144", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f6c5f627d6b05868462" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4f535f627d6b058681c7" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4f6c5f627d6b05868462" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "created_at" : { "$date" : "2008-09-25T22:29:31.691+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.101+0000" }, "title" : "add tostring support for watcher event, and enums for event type/state", "issue_type" : "Improvement", "desc" : "it would be great if we had toString capability on watcher event, and enums for type/state. the logs would certainly benefit (when fixing this try to update any places where we are logging event information)", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f445f627d6b058680e2" }, "external_id" : "ZOOKEEPER-142", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f445f627d6b058680e3" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "created_at" : { "$date" : "2008-09-25T02:08:35.607+0000" }, "priority" : "Trivial", "reporter_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f51e9214a0d1608d874" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.060+0000" }, "title" : "Provide Javadoc as to the maximum size of the data byte array that may be stored within a znode", "issue_type" : "Improvement", "desc" : "Currently there is nothing in the API documentation as to the maximum size of the data in a znode.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f835f627d6b05868695" }, "external_id" : "ZOOKEEPER-159", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cover two corner cases of leader election", "desc" : "In the default implementation of leader election, there are two undesirable cases that need to be covered:\n\n1- If there is a leader elected and this leader is supported by at least  quorum of peers, then it can happen that one peer disconnects from the leader, and initiates a new leader election. As it is a new leader election, we increment the logical clock of this peer, and according to the current implementation, this peer won't accept any vote from a peer with a lower LE turn (corresponds to the value of the logical clock of the voting peer). The attached patch corrects this problem by allowing a peer to go back to a previous epoch in the case a majority votes for a leader, and the peer also receives a vote from the leader. This feature allows a peer to correct a false suspicion of the current leader;\n\n2- If a peer  advances to a new turn before others, then it may end up voting for a peer that either does not have the highest server id or the the highest zxid. The attached patch fixes this problem by resetting the vote a peer when it updates its logical clock upon receiving a notification with a higher turn value.", "created_at" : { "$date" : "2008-10-06T13:15:47.573+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.435+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f845f627d6b058686a2" }, "external_id" : "ZOOKEEPER-157", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Peer can't find existing leader", "desc" : "In the patch of JIRA 127, I forgot to set the state of a peer when this peer is looking for a leader and it receives a message from the current leader. In this patch, I have fixed this problem, and also returned to what we had previously. With this current patch, when a peer joins and there is already a leader elected, the joining peer will only recognize the new leader as the leader once it receives a confirmation from a majority. The alternative is to set the leader once we receive a message from a peer claiming to be the leader (what we have on trunk now, although broken because we don't set the state of the peer), but there could be cases in which a peer believes to be leader, although it is not the leader any longer, and the joining peer would select this false leader to be its leader. Eventually, the false leader would timeout, and both processes would select the correct leader. This small fix gets rid of such problems, though.", "created_at" : { "$date" : "2008-10-04T22:20:35.858+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.382+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f855f627d6b058686b2" }, "external_id" : "ZOOKEEPER-154", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "reliability graph diagram in overview doc needs context", "desc" : "from question on the user mailing list:\n\nthe \"Reliability in the Presence of Errors\" graph on http://hadoop.apache.org/zookeeper/docs/current/zookeeperOver.html does not list how many ZooKeeper quorum nodes are in use, or the fraction of reads/writes.\n\nben mentioned:\n\nHere is the missing text:\nTo show the behavior of the system over time as failures are injected we\nran a ZooKeeper service made up of 7 machines. We ran the same\nsaturation benchmark as before, but this time we kept the write\npercentage at a constant 30\\%, which is a conservative ratio of our\nexpected workloads.", "created_at" : { "$date" : "2008-10-02T13:20:45.391+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.291+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f855f627d6b058686b1" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f855f627d6b058686b1" }, "external_id" : "ZOOKEEPER-155", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f855f627d6b058686b2" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-10-02T13:28:03.438+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.331+0000" }, "title" : "improve \"the zookeeper project\" section of overview doc", "issue_type" : "Bug", "desc" : "In \"the zookeeper project\" section of\nhttp://hadoop.apache.org/zookeeper/docs/current/zookeeperOver.html\n\nwe should remove the hod reference (doesn't use zk) and also update the second paragraph, perhaps remove? Since we are already on the apache zk page.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f865f627d6b058686ce" }, "external_id" : "ZOOKEEPER-150", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper build broken", "desc" : "the build is broekn with ZOOKEEPER-38 checked in.", "created_at" : { "$date" : "2008-10-01T17:28:34.343+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.227+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f875f627d6b058686db" }, "external_id" : "ZOOKEEPER-140", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Deadlock in QuorumCnxManager", "desc" : "Frequently the servers deadlock in QuorumCnxManager:initiateConnection on\ns.read(msgBuffer) when reading the challenge from the peer.\n\nCalls to initiateConnection and receiveConnection are synchronized, so only one or the other can be executing at a time. This prevents two connections from opening between the same pair of servers.\n\nHowever, it seems that this leads to deadlock, as in this scenario:\n\n{noformat}\nA (initiate --> B)\nB (initiate --> C)\nC (initiate --> A)\n{noformat}\n\ninitiateConnection can only complete when receiveConnection runs on the remote peer and answers the challenge. If all servers are blocked in initiateConnection, receiveConnection never runs and leader election halts.\n", "created_at" : { "$date" : "2008-09-13T10:02:12.317+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:43.012+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f875f627d6b058686da" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4f875f627d6b058686ea" }, "external_id" : "ZOOKEEPER-199", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix log messages in persistence code", "desc" : "there are 2 log messages during server startup that are misleading:\n\n2008-10-20 16:36:41,135 - INFO  [main:FileTxnLog$FileTxnIterator@441] - EOF excepton java.io.EOFException: Failed to read\n\n\n2008-10-20 16:36:41,120 - ERROR [main:FileTxnSnapLog@114] - 2(higestZxid) >= 2(next log) for type 1\n\n\nthe first log should be DEBUG and should be changed to say something like eof reached in <file>, reading next file\n\nwhile the second log seems to indicate an error - however the server is still starting. either this is not an error, or it is an error and it's not being handled correctly.", "created_at" : { "$date" : "2008-10-20T23:59:08.321+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.543+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f885f627d6b058686f6" }, "external_id" : "ZOOKEEPER-198", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "apache license header missing from FollowerSyncRequest.java", "desc" : "add license to file & run the rat tool to verify svn", "created_at" : { "$date" : "2008-10-20T20:46:36.347+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.486+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f895f627d6b05868702" }, "external_id" : "ZOOKEEPER-197", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "create checksums for snapshots", "desc" : "ZOOKEEPER-38 added checksums for txn logs. We need to add similar checksums for snapshots.", "created_at" : { "$date" : "2008-10-20T20:29:52.349+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.273+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8a5f627d6b0586870f" }, "external_id" : "ZOOKEEPER-193", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update java example doc to compile with latest zookeeper", "desc" : "In particular the pkg structure has changed.\n", "created_at" : { "$date" : "2008-10-16T00:14:40.072+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.221+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8a5f627d6b0586871d" }, "external_id" : "ZOOKEEPER-191", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "forrest docs for upgrade.", "desc" : "As soon as ZOOKEEPER-5 gets checked in we will need forrest docs for upgrade feature - how to rollback etc. etc.. ", "created_at" : { "$date" : "2008-10-15T22:05:07.646+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.174+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8b5f627d6b0586872b" }, "external_id" : "ZOOKEEPER-187", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "CreateMode api docs missing", "desc" : "End user API docs are missing for CreateMode. (dev api docs are fine)\n\n", "created_at" : { "$date" : "2008-10-14T18:52:10.614+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.052+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "java client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f815f627d6b05868666" }, "external_id" : "ZOOKEEPER-186", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f815f627d6b05868667" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-10-14T16:34:21.218+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.013+0000" }, "title" : "add new \"releasenotes.xml\" to forrest documentation", "issue_type" : "Task", "desc" : "we need releasenotes versioned docs similar to what hadoop has (see their svn, docs, and \"howtorelease\" twiki)\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f8c5f627d6b05868746" }, "external_id" : "ZOOKEEPER-201", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "validate magic number when reading snapshot and transaction logs", "desc" : "The snapshot and transaction log files are not validating the magic numbers when read.\n\nMahadev, can you update the code and tests for this? Possible for 3.0 or wait post 3.0? (feel free to fix now or reassign version)\n\nPlease add tests for this.\n", "created_at" : { "$date" : "2008-10-21T04:55:16.770+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.615+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8d5f627d6b05868753" }, "external_id" : "ZOOKEEPER-200", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the magic number for snapshot and log must be different (currently same)", "desc" : "the magic number for the snapshot and transaction logs are currently the same - they should be different. Also the magic numbers should also be more indicative of the type of file (currently \"AK47\" for both, not very useful in determining type of file)", "created_at" : { "$date" : "2008-10-21T04:39:07.798+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.568+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8e5f627d6b05868764" }, "external_id" : "ZOOKEEPER-188", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Check that election port is present for all servers", "desc" : "Currently, if we use the default leader election, but we do not provide an election port for every server, then zookeeper servers simply crash. I'm attaching a patch to output an error message warning the user of the configuration problem. It might be a better idea to through an exception upon fatal configuration problems, but QuorumPeerConfig.parse() currently throws no exception, so we might postpone such a change  until after the 3.0.0 release.", "created_at" : { "$date" : "2008-10-14T20:08:30.912+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.077+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f8e5f627d6b0586876f" }, "external_id" : "ZOOKEEPER-190", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Reorg links to docs and navs to docs into related sections", "desc" : "Right now, on the main documentation page, and also in the left-hand nav, the docs are in a single flat list. Let's reorganize them into related groups.  Maybe, for example, something like this:\n\nOverview\n  - Overview\n  - Getting Started\n\nDeveloper Docs\n- Programmer's Guide\n- Recipes\n- Java Example\n- Barrier and Queues Tutorial\n- API\n\nAdministrtor Docs\n- Administrators Guide\n\nContributor Docs\n- Zookeeper Internals\n\nMiscellaneous\n- FAQ\n- Wiki\n- Other Information", "created_at" : { "$date" : "2008-10-14T23:42:35.097+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.148+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 7200 },
{ "_id" : { "$oid" : "5b7d4f8f5f627d6b0586877e" }, "external_id" : "ZOOKEEPER-189", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "forrest build not validated xml of input documents", "desc" : "It's possible to build the documentation without validating the XML of the source document. ", "created_at" : { "$date" : "2008-10-14T22:39:52.587+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.122+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 1800 },
{ "_id" : { "$oid" : "5b7d4f8f5f627d6b0586878b" }, "external_id" : "ZOOKEEPER-203", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix datadir typo in releasenotes", "desc" : "typo in releasenotes note on datalog/data dirs.\n", "created_at" : { "$date" : "2008-10-22T03:43:50.686+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.640+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f905f627d6b05868797" }, "external_id" : "ZOOKEEPER-194", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix terminology in zookeeperAdmin.xml", "desc" : "According to the trunk version of zookeeperAdmin.xml, a quorum is a group of servers running an instance of the zookeeper service.This terminology is not standard. We should use \"ensemble\" to denote a group of zookeeper servers, and \"quorum\" to denote a minimum subset of the ensemble necessary, for example, to commit an operation or to support a leader. In our case, a quorum is always a majority of servers of the ensemble.   ", "created_at" : { "$date" : "2008-10-16T15:32:46.085+0000" }, "updated_at" : { "$date" : "2008-10-26T01:10:44.247+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f915f627d6b058687a3" }, "external_id" : "ZOOKEEPER-113", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper.java should be interface not concrete class.", "desc" : "I think ZooKeeper class in src/java/main should be an interface rather than a concrete class. Among other OO goodness this would give us more flexibility when implementing tests on client code. Would also require something like a factory to be created, which might actually work well with another JIRA we have which is the idea to use a URI(s) rather than a host:port combination when creating zookeeper clients.\n\nUnfortunately this would have a big impact on clients as it's not b/w compatible (instantiating a new client that is).\n", "created_at" : { "$date" : "2008-08-06T21:05:36.313+0000" }, "updated_at" : { "$date" : "2008-11-25T23:56:44.739+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f915f627d6b058687ac" }, "external_id" : "ZOOKEEPER-57", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Connection times out when idle", "desc" : "I have observed several connection timeouts with one single client, during periods of inactivity. From reports of other users, it seems that others are observing a similar issue. \n\nIn my case, tickTime is 2000, and the client sets session timeout to be 10000. Client and servers are on different sites. I suspect there is something wrong with the mechanism that issues ping messages.  ", "created_at" : { "$date" : "2008-06-27T08:16:11.890+0000" }, "updated_at" : { "$date" : "2009-01-16T08:44:50.817+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f925f627d6b058687b9" }, "external_id" : "ZOOKEEPER-103", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f6b5f627d6b05868437" }, "external_id" : "ZOOKEEPER-80", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f925f627d6b058687b9" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4f6b5f627d6b05868438" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-07-17T17:37:50.657+0000" }, "updated_at" : { "$date" : "2009-01-16T19:40:53.502+0000" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "priority" : "Major", "title" : "Document process for client recipe contributions", "issue_type" : "Task", "desc" : "Per Doug's suggestion I'll use a link instead of copy/paste:\n\nhttp://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-dev/200807.mbox/%3C487F8262.9020001@yahoo-inc.com%3E\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d4f935f627d6b058687c7" }, "external_id" : "ZOOKEEPER-294", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document or change memory allocations in C API completion handling", "desc" : "The C API zookeeper_process() function, which is used in the IO thread, generally copies data into memory locations provided by the caller (for example, when handling a string completion, it uses memcpy() to copy the string data into a user-provided buffer).\n\nHowever, when handling string-list and ACL-list completions, memory is allocated by deserialize_GetChildrenResponse() and deserialize_GetACLResponse(), respectively, but not released afterward.  Instead it is passed back to the user.  This implies the user is responsible for calling deallocate_GetChildrenResponse() or deallocate_GetACLResponse(), respectively.\n\nAt a minimum, this needs to be extremely well-documented.\n\nPerhaps better, the user should be able to pass an allocation function and a parameter to be passed to it.  Then this function can called repeatedly as a callback in order to allocate the necessary memory.  However, this does assume that the user's allocation function is MT-safe; that requirement would need to be documented if this approach is taken.\n\nFor example, when using the ZooKeeper C API with the Apache Portable Runtime, one would ideally be able to use APR memory pools for such allocation requests.  To do that, the user could pass a wrapper function for apr_palloc() and a data parameter that included a private sub-pool.  The sub-pool would be MT-safe so long as it is used exclusively by the IO thread.\n\nSo, something like zoo_get_children(..., zoo_alloc_func *alloc_func, void *alloc_data).  This would obviously be a change most appropriate for a major version release, e.g., 4.0.0.", "created_at" : { "$date" : "2009-02-05T19:08:19.686+0000" }, "updated_at" : { "$date" : "2009-02-05T19:08:19.686+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f935f627d6b058687c8" }, "external_id" : "ZOOKEEPER-296", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "adopt APR-style versioning and compatibility guidelines for C API", "desc" : "Per a recent discussion on the ZooKeeper users mailing list regarding the API/ABI change introduced in 3.1.0 by ZOOKEEPER-255, I would suggest going forwards that the project adopt the versioning and compatibility guidelines of the Apache Portable Runtime (APR) project.  These are well documented here:\n\nhttp://apr.apache.org/versioning.html\n\nI'd also suggest adopting the parallel installation procedure used by APR.  This would mean that, for example, as of version 4.0.0 the ZooKeeper C library would be installed as libzookeeper_mt-4.so and the include files would be installed as zookeeper-4/zookeeper.h, etc.\n\nThe namespace cleanup I suggest in ZOOKEEPER-295 would fit well with such a change.\n\nI should also point out the (rather mysterious) intent of the GNU libtool versioning system for libraries; while many projects seem to disregard it, it does have some value:\n\nhttp://www.gnu.org/software/libtool/manual/html_node/Libtool-versioning.html", "created_at" : { "$date" : "2009-02-05T19:55:14.500+0000" }, "updated_at" : { "$date" : "2009-02-05T19:55:14.500+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f945f627d6b058687c9" }, "external_id" : "ZOOKEEPER-69", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper logo", "desc" : "I think we need a cool logo for the project. The ones I've seen so far are a little lame, and that includes the one I've created for SourceForge. If anyone on this list has an idea or knows of anyone with some art skills, plese add a commento to this Jira. ", "created_at" : { "$date" : "2008-07-08T09:15:39.989+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:48.991+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Wish", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f955f627d6b058687e6" }, "external_id" : "ZOOKEEPER-64", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "We should log system env information when intializing client/server", "desc" : "We should log system environment information (as much as possible) during both client & server initialization. This will help with debugging of customer issues.", "created_at" : { "$date" : "2008-07-02T16:30:19.494+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:48.928+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f415f627d6b058680a2" }, "external_id" : "ZOOKEEPER-16", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client", "server", "java client" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f415f627d6b058680a3" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-06-10T21:17:18.644+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-02-13T21:18:48.723+0000" }, "title" : "Need to do path validation", "issue_type" : "Bug", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1963141&group_id=209147&atid=1008544", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f965f627d6b05868826" }, "external_id" : "ZOOKEEPER-221", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "log message in ZkWatchManager.materialize missing conditional", "desc" : "the following code is missing conditional log call based on result of remove call (size > 0)\n\n    // XXX This shouldn't be needed, but just in case\n>     synchronized (existWatches) {\n>         addTo(existWatches.remove(path), result);\n>         LOG.warn(\"We are triggering an exists watch for delete! Shouldn't happen!\");\n>     }\n> ", "created_at" : { "$date" : "2008-11-12T23:21:29.647+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.995+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f965f627d6b05868825" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d4f975f627d6b05868830" }, "external_id" : "ZOOKEEPER-220", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "programming guide watches section should clarify server/clientlib role in data/child watch maint.", "desc" : "http://hadoop.apache.org/zookeeper/docs/r3.0.0/zookeeperProgrammers.html#ch_zkWatches\n\nThe server is maintaining two lists, it's not really clear in some sections that it's the server, esp as in v3 the client is also maintaining it's own list(s).\n", "created_at" : { "$date" : "2008-11-12T19:02:12.903+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.953+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "environment" : "http://hadoop.apache.org/zookeeper/docs/r3.0.0/zookeeperProgrammers.html#ch_zkWatchesonly" },
{ "_id" : { "$oid" : "5b7d4f985f627d6b05868841" }, "external_id" : "ZOOKEEPER-215", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "expand system test environment", "desc" : "Currently our system tests are lumped in with our unit tests. It would be great to have a system test environment where we could run larger scale testing. Say you have 20 hosts, and you would like to test a serving ensemble with 7 servers and 100 clients running particular operations. It should be easy to test this scenario. Additionally during the test it should be possible to simulate serving node failure, etc...\n\nI've had a brief conversation with Ben about this and he's going to take this JIRA.\n", "created_at" : { "$date" : "2008-11-05T00:57:53.162+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.795+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f985f627d6b0586883f" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4f985f627d6b05868840" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d4f995f627d6b0586885a" }, "external_id" : "ZOOKEEPER-214", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add new \"stat reset\" command to server admin port", "desc" : "A new command should be added to the server admin port (client port) that allows users to reset the stats.\n\nWe saw cases during troubleshooting where we would have liked to reset the \"min/avg/max latency\" stats, but were unable to do so (short of restarting the server).\n", "created_at" : { "$date" : "2008-11-05T00:55:26.574+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.741+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f995f627d6b05868869" }, "external_id" : "ZOOKEEPER-218", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "error in barrier recipe example code", "desc" : "Report from user Murali Vemulapati. The wiki recipe page also should be updated to handle multiple clients using the barrier on the same system (multiple processes, etc...). Currently the docs/example support only a single user of the barrier per host.\n\n------------------\n\nI believe there is a typo in the barrier example given at:\n\nhttp://hadoop.apache.org/zookeeper/docs/current/zookeeperTutorial.html\n\nWith the following fix, the program runs as expected:\n==============\n83c83\n<                 this.name = new String(InetAddress.getLocalHost().getCanonicalHostName().toString());\n---\n>                 name = new String(InetAddress.getLocalHost().getCanonicalHostName().toString());\n100c100\n<                     CreateMode.EPHEMERAL_SEQUENTIAL);\n---\n>                     CreateMode.EPHEMERAL);\n==============\nThe first change assigns the name to the instance variable 'name' of Barrier class (otherwise the 'name' instance variable will have a value of 'null'\nwhen calling zk.create to create the child node under the root barrier node).\nThe second change lets us run multiple processes on the same machine.\n\nthanks\nmurali\n\n", "created_at" : { "$date" : "2008-11-10T22:24:08.040+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.852+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f9a5f627d6b05868875" }, "external_id" : "ZOOKEEPER-219", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "events.poll timeout in watcher test too short", "desc" : "in watchertest there are some event.poll calls that have 1milli timeouts\n\n        e = localWatcher.events.poll(1, TimeUnit.MILLISECONDS);\n\nthis is showing falure in some cases under hudson (I assume when it's under load from other tests running for other proj)\n\nWe should review the poll calls and verify adequate timeouts.\n", "created_at" : { "$date" : "2008-11-11T22:01:12.233+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.927+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f9b5f627d6b05868881" }, "external_id" : "ZOOKEEPER-210", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Require Java 6", "desc" : "We should require Java 6 for release 3.1.0. At this point there is full java6 support on all major platforms (linux/windows/macosx).\nThe vast majority of ZooKeeper contributors use Java 6 when developing, and hence do run into (usually minor) back-compatibility problems.\nI believe there are also some benefits regarding JMX (updated spec support in java6) if we drop java 5.\n\nFWIW: Hadoop Core has also moved to require Java6:\nhttps://issues.apache.org/jira/browse/HADOOP-2325\n\n", "created_at" : { "$date" : "2008-10-28T01:35:17.612+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.599+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server", "java client", "documentation", "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f9b5f627d6b05868893" }, "external_id" : "ZOOKEEPER-212", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "snapshot is synchronous in 3.0", "desc" : "the snapshot in 3.0 is syunchronous. this will affect performance of the system.", "created_at" : { "$date" : "2008-10-28T21:54:57.444+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.677+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f9c5f627d6b058688a5" }, "external_id" : "ZOOKEEPER-211", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Not all Mock tests are working", "desc" : "For the 3.0 release there was a bug in the ZKMock code that prevented some tests from working. This patch fixes the bug and reenables the tests.", "created_at" : { "$date" : "2008-10-28T18:14:35.184+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.625+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Test", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f9d5f627d6b058688b4" }, "external_id" : "ZOOKEEPER-208", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper C client uses API that are not thread safe, causing crashes when multiple instances are active", "desc" : "The Zookeeper C client library uses gethostbyname and strtok, both of which are not safe to use from multiple threads.\n\nThe problem is resolved by using getaddrinfo and strtok_r in place of the older API.\n\n", "created_at" : { "$date" : "2008-10-27T05:31:11.364+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.473+0000" }, "creator_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "reporter_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d4f9e5f627d6b058688cf" }, "external_id" : "ZOOKEEPER-213", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "programmer guide C api docs are out of sync with latest zookeeper.h ", "desc" : "see\nhttp://hadoop.apache.org/zookeeper/docs/current/zookeeperProgrammers.html#Zookeeper+C+client+API\nand compare with src/c/zookeeper.h\n", "created_at" : { "$date" : "2008-10-29T06:02:37.807+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.704+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa05f627d6b058688dd" }, "external_id" : "ZOOKEEPER-205", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Error on version-info when compiling from the tarball distribution", "desc" : "When running ant with the code from the release tarball, I get the following messages and stack trace:\n\n{noformat}\nsvn-revision:\n     [exec] svn: '.' is not a working copy\n\nversion-info:\n     [java] All version-related parameters must be valid integers!\n     [java] Exception in thread \"main\" java.lang.NumberFormatException: For input string: \"\"\n     [java]     at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)\n     [java]     at java.lang.Integer.parseInt(Integer.java:468)\n     [java]     at java.lang.Integer.parseInt(Integer.java:497)\n     [java]     at org.apache.zookeeper.version.util.VerGen.main(VerGen.java:111)\n     [java] Java Result: 1\n{noformat}\n\nThis seems to be because the code is not coming from svn, so it can't find the version information.", "created_at" : { "$date" : "2008-10-22T21:46:32.175+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.402+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fa05f627d6b058688dc" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fa05f627d6b058688ed" }, "external_id" : "ZOOKEEPER-206", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "documentation  tab should contain the version number (and other small site changes)", "desc" : "Feedback from Doug Cutting on 3.0.0 documentation:\n\n - The \"Zookeeper Documentation\" tab should contain the version number.\n - \"Informal Documentation\" might better be named \"Other Documentation\".\n - The \"Other Info\" page should be removed, since it contains nothing. ", "created_at" : { "$date" : "2008-10-23T19:20:56.803+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.448+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f965f627d6b05868825" }, "external_id" : "ZOOKEEPER-204", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.0.1", "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f965f627d6b05868826" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-10-22T06:06:58.570+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.349+0000" }, "title" : "SetWatches needs to be the first message after auth messages to the server", "issue_type" : "Bug", "desc" : "When the ZooKeeper java client  makes a connection it queues a SetWatches  request. The problem is that it puts the request at the end of the outgoing requests. This means that watches for requests that were queued before the connection is made and after the disconnect may improperly get their watches triggered.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f985f627d6b0586883f" }, "external_id" : "ZOOKEEPER-149", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f985f627d6b05868841" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4f745f627d6b05868520" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-10-01T02:51:46.140+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.159+0000" }, "title" : "c interface is missing tests against java server (mock only)", "issue_type" : "Improvement", "desc" : "The c client interface has unit tests but they are against mock server implementations only. We need to add tests for the c interface against live java server.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fa35f627d6b05868927" }, "external_id" : "ZOOKEEPER-177", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "needed: docs for JMX", "desc" : "I don't know if this should be part of the logging section in the zookeeper admin guide (see JIRA ZOOKEEPER-166 )\nbut, per Patrick, \"related to security, ack, yea another doc, is the documentation of the JMX support that zk has\"", "created_at" : { "$date" : "2008-10-06T16:02:24.540+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.295+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation", "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa45f627d6b05868937" }, "external_id" : "ZOOKEEPER-161", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Designing a ZooKeeper Deployment\"", "desc" : "We should document how ops engineer should design their ZooKeeper deployments.  ", "created_at" : { "$date" : "2008-10-06T14:05:24.757+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.231+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d4fa55f627d6b0586894b" }, "external_id" : "ZOOKEEPER-135", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fat jar build target", "desc" : "For testing and experimentation purposes it would be nice to have everything in a self contained executable jar file that you can plop down on a machine and run.", "created_at" : { "$date" : "2008-09-04T15:58:19.315+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:49.112+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa65f627d6b05868969" }, "external_id" : "ZOOKEEPER-247", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix formatting of C API in ACL section of programmer guide", "desc" : "formatting of C api is wrong in acl section of prog guide", "created_at" : { "$date" : "2008-12-05T18:22:48.637+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.784+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa75f627d6b0586897a" }, "external_id" : "ZOOKEEPER-231", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Quotas in zookeeper", "desc" : "creating quota's in zookeeper so that a runaway application does not bring down the zookeeper cluster.", "created_at" : { "$date" : "2008-11-21T21:13:13.038+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.361+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fa75f627d6b05868979" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fa85f627d6b058689a8" }, "external_id" : "ZOOKEEPER-222", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "print C client log message timestamp in human readable form", "desc" : "Noticed this issue during a debugging session -- it's difficult to read/compare the timestamps from the c client.\n\nThe C client timestamp should be formatted with the same format as the JAVA log timestamps.\n\nNote: java uses ISO8601 timestamp formatting by default.\n\nPerhaps we should just bit the bullet and move to log4c? Consider this option when addressing this issue.\n", "created_at" : { "$date" : "2008-11-13T22:11:19.681+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.049+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa95f627d6b058689b4" }, "external_id" : "ZOOKEEPER-243", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add SEQUENCE flag documentation to the programming guide", "desc" : "There doesn't seem to be any docs in forrest detailing the sequence flag for node creation.\n\nIn particular we should detail how the flag works, the naming format, and also rollover (when does the number roll over to 0 again).\n", "created_at" : { "$date" : "2008-12-03T18:42:19.629+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.651+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4faa5f627d6b058689c1" }, "external_id" : "ZOOKEEPER-242", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper c tests are faliling..", "created_at" : { "$date" : "2008-12-01T18:27:59.604+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.622+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4faa5f627d6b058689c7" }, "external_id" : "ZOOKEEPER-232", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "testablezookeeper file is missing apache licence headers.", "created_at" : { "$date" : "2008-11-24T19:48:12.790+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.461+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbb5f627d6b058689d3" }, "external_id" : "ZOOKEEPER-234", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Eliminate using statics to initialize the sever.  Should allow server to be more embeddable in OSGi enviorments.", "desc" : "Patrick request I open up this in issue in this [email thread|http://n2.nabble.com/ActiveMQ-is-now-using-ZooKeeper-td1573272.html]\n\nThe main culprit I've noticed is:\n{code}\n        ServerStats.registerAsConcrete();\n{code}\n\nBut there may be others.", "created_at" : { "$date" : "2008-11-24T21:01:29.447+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.487+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbc5f627d6b058689e8" }, "external_id" : "ZOOKEEPER-226", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "exists calls fails on server if node has null data", "desc" : "An NPE will be generated on the server (and resulting in client getting MarshallingException) if exists() is called on a node with null data.\n\nworkaround is to create the node with non-null data.\n\nbe sure to update the tests for this case\n", "created_at" : { "$date" : "2008-11-18T19:27:26.721+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.174+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbd5f627d6b058689f5" }, "external_id" : "ZOOKEEPER-225", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client should log an info message in zookeeper_init detailing connection parameters", "desc" : "I've debugged a few situations where the client connection param was not set properly (even though the user swore that it was). We should log info level message during init to enable us (and user) to easier debug.", "created_at" : { "$date" : "2008-11-18T18:53:55.520+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.119+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbd5f627d6b05868a04" }, "external_id" : "ZOOKEEPER-249", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumPeer.getClientPort() always returns -1", "desc" : "This was changed in SVN 700690:\n\nhttp://svn.apache.org/viewvc/hadoop/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/QuorumPeer.java?r1=700690&r2=700689&pathrev=700690", "created_at" : { "$date" : "2008-12-08T09:10:31.923+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.905+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbe5f627d6b05868a16" }, "external_id" : "ZOOKEEPER-248", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumPeer should use Map interface instead of HashMap implementation.", "desc" : "Using HashMap directly to store quorumPeers member variable unnecessarily decides for the user what implementation of Map to use.", "created_at" : { "$date" : "2008-12-08T07:55:34.938+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.858+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fbf5f627d6b05868a28" }, "external_id" : "ZOOKEEPER-245", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update readme/quickstart to be release tar, rather than source, based", "desc" : "Owen O'Malley mentioned:\n---------\nwe need to change both the README and quick start to assume you are working with a release instead of a source tarball. Apache releases are the approved way of getting the project. Documentation that assumes they are getting source themselves doesn't reflect that. \n---------", "created_at" : { "$date" : "2008-12-04T21:08:20.010+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.714+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fa05f627d6b058688dc" }, "external_id" : "ZOOKEEPER-241", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "build" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fa05f627d6b058688dd" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-11-26T19:50:08.315+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4fc0e9214a0d1608d880" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4fc0e9214a0d1608d880" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.585+0000" }, "title" : "Build of a distro fails after clean target is run", "issue_type" : "Bug", "desc" : "When the ZooKeeper distro is downloaded, if the clean target is run, it deletes the .revision file:\n\n{quote}\nclean:\n  [delete] Deleting directory /home/foo/zookeeper-3.0.1/build\n  [delete] Deleting directory /home/foo/zookeeper-3.0.1/src/java/generated\n  [delete] Deleting directory /home/foo/zookeeper-3.0.1/src/c/generated\n  [delete] Deleting directory /home/foo/zookeeper-3.0.1/.revision\n{quote}\n\nThis causes subsequent builds in the distro to fail with:\n\n{quote}\ncompile-main:\n   [javac] Compiling 73 source files to /home/foo/zookeeper-3.0.1/build/classes\n   [javac] /home/foo/zookeeper-3.0.1/src/java/main/org/apache/zookeeper/Version.java:21: package org.apache.zookeeper.version does not exist\n   [javac] public class Version implements org.apache.zookeeper.version.Info{\n   [javac]                                                             ^\n   ...\n{quote}\n\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fc05f627d6b05868a43" }, "external_id" : "ZOOKEEPER-230", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improvements to FLE", "desc" : "I'm about to attach a patch that implements the following modifications:\n\n. Currently, if a server is on leader election and doesn't receive a notification for some amount of time t, then it sends a new set of notifications if at least one server has delivered a message from the previous set. With this patch, the amount of time a server waits for a notification before sending a new set increases exponentially;\n. I have separated connecting to servers and queuing new notification messages. Before they were all in the same message. The advantage is that now I can tell to an instance of QuorumCnxManager to try to connect to other servers without generating new notification messages;\n. I have changed the logging level of several messages on QuorumCnxManager. They were \"warn\", but they should really be either \"info\" or \"debug\". I've changed them to info.\n ", "created_at" : { "$date" : "2008-11-20T14:37:08.781+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.307+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc15f627d6b05868a62" }, "external_id" : "ZOOKEEPER-223", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "default log4j root logger configuration has neg perf impact with no benefit, change default level to INFO", "desc" : "The default log4j.properties has:\n\nlog4j.rootLogger=DEBUG, CONSOLE\n\nwhere the console appender is only outputting INFO level and above.\n\nThis is resulting in a large number of debug logs being generated, which are all filtered out by the console appender (by default there are no other appenders used)\n\nWe need to change the default rootLogger to INFO level, which will resolve this issue.\n\nUsers are free to change this of course -- most likely they would only do this when debugging an issue, and would not want to run in DEBUG in production (again, they are free to choose).\n", "created_at" : { "$date" : "2008-11-14T07:10:20.780+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.093+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc25f627d6b05868a71" }, "external_id" : "ZOOKEEPER-246", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "review error code definition in both source and docs", "desc" : "A number of users have mentioned that our use of \"calculated\" values for error codes makes it very difficult to track error reports from the logs.  In both c/java we have:\n\nint ERROR = 100\nint X_ERROR= ERROR + 1\nint Y_ERROR= ERROR + 2\netc...\n\nwhich makes it difficult to grep/search for \"101\" and find these references. A number of users have mentioned that having non-calculated values (ie X_ERROR=101) would make it easier. \n\nI personally find calculated constants like this an anti-pattern.\n\nWe should convert these values to non-calculated at a minimum, perhaps even redefine them as enums if possible.\n\nAlso documentation, esp in the c code (the names btw c and java don't match btw) is lacking. We need to beef up docs in this area.\n", "created_at" : { "$date" : "2008-12-05T00:16:48.685+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.754+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client", "java client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fc25f627d6b05868a70" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fc25f627d6b05868a85" }, "external_id" : "ZOOKEEPER-240", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Yet another npe", "desc" : "java.lang.NullPointerException\n\tat org.apache.jute.Utils.toCSVBuffer(Utils.java:234)\n\tat org.apache.jute.CsvOutputArchive.writeBuffer(CsvOutputArchive.java:101)\n\tat org.apache.zookeeper.proto.GetDataResponse.toString(GetDataResponse.java:48)\n\tat java.lang.String.valueOf(String.java:2827)\n\tat java.lang.StringBuilder.append(StringBuilder.java:115)\n\tat org.apache.zookeeper.ClientCnxn$Packet.toString(ClientCnxn.java:230)\n\tat java.lang.String.valueOf(String.java:2827)\n\tat java.lang.StringBuilder.append(StringBuilder.java:115)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:586)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:626)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:852)\n", "created_at" : { "$date" : "2008-11-26T16:26:54.095+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.515+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc35f627d6b05868a8d" }, "external_id" : "ZOOKEEPER-229", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve documentation regarding user's responsibility to cleanup datadir (snaps/logs)", "desc" : "It's not very obvious in the docs that the operator of the zk server is responsible for managing the files in the datadir:\n\nhttp://hadoop.apache.org/zookeeper/docs/r3.0.0/zookeeperAdmin.html#File+Management\n\nspecifically removing the old snaps/transactionallogs\n\nwe need to make this more obvious, perhaps call it out in the quickstart (note pointing to this document)\n\nPerhaps we should include example script and cron as well (docs)\n", "created_at" : { "$date" : "2008-11-18T21:54:48.944+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.281+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fc35f627d6b05868a8c" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4fc45f627d6b05868a9c" }, "external_id" : "ZOOKEEPER-228", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "apache header missing in DBtest", "desc" : "one of the test files is missing apache headers ... ", "created_at" : { "$date" : "2008-11-18T20:02:06.380+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.225+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc55f627d6b05868aa7" }, "external_id" : "ZOOKEEPER-227", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "gcc warning from recordio.h", "desc" : "Recent gcc compilers issue warnings when function declarations for functions with no arguments don't specific \"void\".  The attached patch fixes one such warning for create_buffer_oarchive() in recordio.h.", "created_at" : { "$date" : "2008-11-18T19:50:16.637+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:50.199+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc55f627d6b05868aba" }, "external_id" : "ZOOKEEPER-251", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NullPointerException stopping and starting Zookeeper servers", "desc" : "See the following thread for the original report:\nhttp://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/200812.mbox/browser\nSteps to reproduce:\n1) Start a replicated zookeeper service consisting of 3 zookeeper (3.0.1) servers all running on the same host (of course, all using their own ports and log directories)\n2) Create one znode in this ensemble (using the zookeeper client console, I issued 'create /node1 node1data').\n3) Stop, then restart a single zookeeper server; moving onto the next one a few seconds later. \n4) Go back to 3. After 4-5 iterations, the following should occur, with the failing server exiting:\njava.lang.NullPointerException\n        at \norg.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:447)\n        at \norg.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:358)\n        at \norg.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:333)\n        at \norg.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:250)\n        at \norg.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:102)\n        at \norg.apache.zookeeper.server.ZooKeeperServer.loadData(ZooKeeperServer.java:183)\n        at org.apache.zookeeper.server.quorum.Leader.lead(Leader.java:245)\n        at \norg.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:421)\n2008-12-08 14:14:24,880 - INFO  \n[QuorumPeer:/0:0:0:0:0:0:0:0:2183:Leader@336] - Shutdown called\njava.lang.Exception: shutdown Leader! reason: Forcing shutdown\n        at \norg.apache.zookeeper.server.quorum.Leader.shutdown(Leader.java:336)\n        at \norg.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:427)\nException in thread \"QuorumPeer:/0:0:0:0:0:0:0:0:2183\" \njava.lang.NullPointerException\n        at \norg.apache.zookeeper.server.quorum.Leader.shutdown(Leader.java:339)\n        at \norg.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:427)\n\nThe inputStream field is null, apparently because next is being called \nat line 358 even after next returns false. Having very little knowledge \nabout the implementation, I don't know if the existence of hdr.getZxid() \n >= zxid is supposed to be an invariant across all invocations of the \nserver; however the following change to FileTxnLog.java seems to make \nthe problem go away.\ndiff FileTxnLog.java /tmp/FileTxnLog.java\n358c358,359\n<                 next();\n---\n >               if (!next())\n >                   return;\n447c448,450\n<                 inputStream.close();\n---\n >               if (inputStream != null) {\n >                   inputStream.close();\n >               }\n", "created_at" : { "$date" : "2008-12-08T21:29:01.013+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.470+0000" }, "creator_id" : { "$oid" : "5b7d4fc5e9214a0d1608d881" }, "reporter_id" : { "$oid" : "5b7d4fc5e9214a0d1608d881" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "environment" : "Tested with JDK 1.5, Solaris, but I suspect it is not relevant in this case." },
{ "_id" : { "$oid" : "5b7d4fc65f627d6b05868ad5" }, "external_id" : "ZOOKEEPER-250", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "isvalidsnapshot should handle the case of 0 snapshot files better.", "desc" : "the isvalidsnapshot will fail with negative seek if 0 snapshot files exist. We should just return false in case the size of the snapshot is less than 5 bytes.", "created_at" : { "$date" : "2008-12-08T18:11:32.295+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.377+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc65f627d6b05868ae5" }, "external_id" : "ZOOKEEPER-263", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document connection host:port as comma separated list in forrest docs", "desc" : "The java API docs talk about the host:port comma separated list, however the forrest docs don't mention this. it's confusing for users, they don't know that the connection string can be a list of host:port comma separated. We should mention in the programmer guide, perhaps even in the overview/started (mention in passing and reference the prog guide for full detail).\n\nAlso the java doc should be updated, right now we have a \"see also\" in the short constructor, to make it more explicit we should copy/paste the docs.\n\nThe c client should also be updated to detail that it's a comma separated list of host:port (similar to java). Right host we just say \"host\", need to be more explicit as to the format of the string.\n", "created_at" : { "$date" : "2009-01-05T19:50:09.499+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.887+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client", "java client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc75f627d6b05868af0" }, "external_id" : "ZOOKEEPER-259", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup the logging levels used (use the correct level) and messages generated", "desc" : "Cleanup logging:\n\nmake sure logging uses the correct level, esp error and warn\n\nmake sure the messages are meaningful (esp fix \"fixmsg\" logs)\n", "created_at" : { "$date" : "2008-12-17T18:54:21.492+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.794+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc85f627d6b05868b01" }, "external_id" : "ZOOKEEPER-258", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "docs incorrectly state max client timeout as 60 seconds (it's based on server ticktime)", "desc" : "The docs incorrectly state the max client timeout as 60 seconds.\nhttp://hadoop.apache.org/zookeeper/docs/r3.0.1/zookeeperProgrammers.html#ch_zkSessions\n\nthe current server code has the following logic:\n        if (sessionTimeout < zk.tickTime * 2) {\n            sessionTimeout = zk.tickTime * 2;\n        }\n        if (sessionTimeout > zk.tickTime * 20) {\n            sessionTimeout = zk.tickTime * 20;\n        }\n\nSo really the docs should say max is 20*tickTime\n", "created_at" : { "$date" : "2008-12-16T22:50:09.224+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.765+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc85f627d6b05868b0c" }, "external_id" : "ZOOKEEPER-257", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Review logging level for WARN/ERROR log messages, some misclassified", "desc" : "Some of the WARN/ERROR log messages are incorrectly leveled (too high - many often should be INFO/DEBUG)", "created_at" : { "$date" : "2008-12-16T00:49:00.334+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.730+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc95f627d6b05868b12" }, "external_id" : "ZOOKEEPER-256", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "support use of JMX to manage log4j configuration at runtime", "desc" : "Log4j has code to support management at runtime using JMX. Need to add hooks to register the beans.\n", "created_at" : { "$date" : "2008-12-13T06:58:25.132+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.669+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fca5f627d6b05868b1f" }, "external_id" : "ZOOKEEPER-255", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zoo_set() api does not return stat datastructure.", "desc" : "the zoo_set() api does not return the stat datastructure. the java counterpart returns a stat with set api. ", "created_at" : { "$date" : "2008-12-12T23:18:21.067+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.617+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4fcae9214a0d1608d882" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fca5f627d6b05868b33" }, "external_id" : "ZOOKEEPER-254", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "there is currently no way for a user to test session expiration in their code", "desc" : "There's currently no way for a user to test session expiration in their code.\n\nWe don't  have any unit/system tests that verify our code handles session expiration properly.\n\nThere should be a way to test session expiration.\n\nI did notice that we have the ability to terminate a session using JMX mbean interface, however I'm not sure if this is useful in an automated testing context. Even if it is we should provide a wrapper for testing purposes - and add tests to our codebase which uses it.\n", "created_at" : { "$date" : "2008-12-12T21:44:22.946+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.586+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fcb5f627d6b05868b3b" }, "external_id" : "ZOOKEEPER-253", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "documentation of DataWatcher state transition is misleading regarding auto watch reset on reconnect", "desc" : "the example code has\n\n           case SyncConnected:\n               // Everything is happy. Lets kick things off\n               // again by checking the existence of the znode\n               break;\n\nthis is misleading - it should indicate that the watches are automatically reset and therefor no call to exists is necessary\n\nalso fix this in the same doc (looks like its old detail, no longer valid), indicate that autoreset will happen on reconnect.\n\nIf the client-side ZooKeeper libraries can reestablish the communication channel to ZooKeeper, DataMonitor simply kicks everything off again with the call to ZooKeeper.exists(). If it gets an event for a znode, it calls ZooKeeper.exists() to find out what has changed. \n", "created_at" : { "$date" : "2008-12-11T18:45:28.520+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.539+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc35f627d6b05868a8c" }, "external_id" : "ZOOKEEPER-252", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "server" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fc35f627d6b05868a8d" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2008-12-10T23:06:29.551+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.513+0000" }, "title" : "PurgeTxnLog is not handling the new dataDir directory structure", "issue_type" : "Bug", "desc" : "org.apache.zookeeper.server.PurgeTxnLog class has not been updated to handle the new directory structure imposed by the upgrade from v2 to v3 of ZooKeeper. In particular the dataDir now has a \"version-2\" subdirectory that stores all of the snaps/transactionallogs for version2 of the persistence layer.\n\nI also note that the documentation of this class is particularly poor. I'm working on ZOOKEEPER-229 and would like to point to the API docs for this class regarding usage but they api docs are nonexistent\n\nAlso - I think it's important for the user to be able to specify the number of \"backup\" snaps and logs that should be kept -- right now it seems we delete all but the current snaps/txlogs. Either by count or by date -- ie \"remove anything 5 days or older, with a minum of 3 most recents snaps (and accompanying txlogs)\" seems like a pretty common user case (assuming the operator is doing system backups every X days, etc...)\n\nin general this class needs some tlc - the formatting should also be cleaned up.\n\nAlso - the API docs for this and LogFormatter are not included in the build.xml \"javadoc\" target. These are user utilities so javadoc for these two classes should be included. I will fix this issue as part of ZOOKEEPER-229. I'm also updateing the forrest documention in 229 so don't worry about that either.\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fcc5f627d6b05868b59" }, "external_id" : "ZOOKEEPER-266", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "KeeperState missing javadoc for values", "desc" : "KeeperState is missing documentation of the states. Should provide some basic details and refer users to the appropriate forrest doc for more detail (most likely prog guide).", "created_at" : { "$date" : "2009-01-05T20:40:27.538+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.961+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fcd5f627d6b05868b61" }, "external_id" : "ZOOKEEPER-265", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove (deprecate) unused NoSyncConnected from KeeperState", "desc" : "deprecate NoSyncConnected in KeeperState - it's not used anywhere in the codebase.\n\nwhat about \"Unknown\"? that seems to be unused as well, deprecate it as well?\n", "created_at" : { "$date" : "2009-01-05T20:38:36.324+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.913+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fce5f627d6b05868b6e" }, "external_id" : "ZOOKEEPER-267", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "java client incorrectly generating syncdisconnected event when in disconnected state", "desc" : "The java client (and someone should also review the c client) is generating a syncdisconnected even if the client is currently in the disconnected state. We saw this with a user running the java client against a down standalone server (server not running, connection refused) - the \"syncdisconnected\" is generated by the client lib each time a connection attempt (fails) is made. Should only be generated once.", "created_at" : { "$date" : "2009-01-05T22:56:46.325+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.987+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fce5f627d6b05868b7a" }, "external_id" : "ZOOKEEPER-260", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document the recommended values for server id's", "desc" : "currently we do nto doucment the recommended values for server id's. we should document that. For some large values of server id's we might get negative session's and also might get duplicate sessions from two servers.\n", "created_at" : { "$date" : "2008-12-18T19:37:30.460+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:53.852+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fcf5f627d6b05868b89" }, "external_id" : "ZOOKEEPER-289", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add debug messages to nioserver select loop.", "desc" : "add some debug messages for any unexpected behaviour on select i/o in NIOServerCnxn.", "created_at" : { "$date" : "2009-02-03T20:14:25.612+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.500+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fc25f627d6b05868a70" }, "external_id" : "ZOOKEEPER-291", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fc25f627d6b05868a71" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-02-04T19:23:29.833+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.562+0000" }, "title" : "regression for legacy code using KeeperException.Code constants (due to 246)", "issue_type" : "Bug", "desc" : "In 246 the old constants were deprecated and replace with enum. In the process usage of the orig constants was broken for switch statements, cases require compiletime constants.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fd05f627d6b05868ba6" }, "external_id" : "ZOOKEEPER-276", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Bookkeeper contribution", "desc" : "BookKeeper is a system to reliably log streams of records. In BookKeeper, servers are \"bookies\", log streams are \"ledgers\", and each unit of a log (aka record) is a \"ledger entry\". BookKeeper is designed to be reliable; bookies, the servers that store ledgers can be byzantine, which means that some subset of the bookies can fail, corrupt data, discard data, but as long as there are enough correctly behaving servers the service as a whole behaves correctly; the meta data for BookKeeper is stored in ZooKeeper.\n", "created_at" : { "$date" : "2009-01-20T11:54:00.926+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.357+0000" }, "creator_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "reporter_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd15f627d6b05868bc9" }, "external_id" : "ZOOKEEPER-293", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zoo_set needs to be abi compatible (3.1 changed the signature), fix this by adding zoo_set2", "desc" : "ZOOKEEPER-255 fixed an issue with zoo_set not providing access to stat structure, however this has broken b/w compatibility with previous releases.\n\nWe need to:\n\n1) revert zoo_set to not have stat parameter (keep b/w compat)\n2) add zoo_set2 method with stat param added to the function signature\n3) add a version.h file to src/c/include that provides zoo version detail to clients\n\nie.\n> #define ZOO_MAJOR_VERSION 3\n> #define ZOO_MINOR_VERSION 1\n> #define ZOO_PATCH_VERSION 0\n\n(a new jira should be added to centralize version numbering, we now have the version number in 3 places in the source)\n", "created_at" : { "$date" : "2009-02-05T18:43:18.358+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.594+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd25f627d6b05868bd5" }, "external_id" : "ZOOKEEPER-285", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the stat command does not return the correct mode", "desc" : "the stat command is always returning \"standalone\" it should return the actual mode it is in.", "created_at" : { "$date" : "2009-02-02T11:56:46.700+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.446+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fd25f627d6b05868bd4" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d4fd25f627d6b05868be0" }, "external_id" : "ZOOKEEPER-284", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMX doesn't get the clientPort correctly", "desc" : "The client port in JMX is always zero. it should be getting the client port from the cnxnfactory. it's a pretty easy fix. the really problem is that we have a setter for the clientPort as well, which is a bit more complicated to implement correctly. do we need a setter for the clientPort? i think we should make it a readonly attribute.", "created_at" : { "$date" : "2009-02-02T11:55:40.928+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.397+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fd25f627d6b05868bd4" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4fd25f627d6b05868bd4" }, "external_id" : "ZOOKEEPER-286", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.0" ], "fix_versions" : [ "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fd25f627d6b05868bd5" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d4fd25f627d6b05868be0" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-02-02T16:20:50.595+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.474+0000" }, "title" : "Make GenerateLoad use InstanceContainers", "issue_type" : "Improvement", "desc" : "GenerateLoad is a pain to setup and run. It would be nice if it used the same infrastructure as the system test so that we can more easily run performance tests.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fd45f627d6b05868c04" }, "external_id" : "ZOOKEEPER-275", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Bug in FastLeaderElection", "desc" : "I found an execution in which leader election does not make progress. Here is the problematic scenario:\n\n- We have an ensemble of 3 servers, and we start only 2;\n- We let them elect a leader, and then crash the one with lowest id, say S_1 (call the other S_2);\n- We restart the crashed server.\n\nUpon restarting S_1, S_2 has its logical clock more advanced, and S_1 has its logical clock set to 1. Once S_1 receives a notification from S_2, it notices that it is in the wrong round and it advances its logical clock to the same value as S_1. Now, the problem comes exactly in this point because in the current code S_1 resets its vote to its initial vote (its own id and zxid). Since S_2 has already notified S_1, it won't do it again, and we are stuck. The patch I'm submitting fixes this problem by setting the vote of S_1 to the one received if it satisfies the total order predicate (\"received zxid\" is higher or \"received zxid is the same and received id is higher\").\n\nRelated to this problem, I noticed that by trying to avoid unnecessary notification duplicates, there could be scenarios in which a server fails before electing a leader and restarts before leader election succeeds. This could happen, for example, when there isn't enough servers available and one available crashes and restarts. I fixed this problem in the attached patch by allowing a server to send a new batch of notifications if there is at least one outgoing queue of pending notifications empty. This is ok because we space out consecutive batches of notifications. ", "created_at" : { "$date" : "2009-01-15T15:18:00.440+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.307+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd55f627d6b05868c1c" }, "external_id" : "ZOOKEEPER-272", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "getChildren can fail for large numbers of children", "desc" : "Zookeeper allows creation of an abritrary number of children, yet if the String array of children names exceeds 4,194,304 bytes a getChildren will fail because ClientCnxn$SendThread.readLength() throws an exception on line 490.  Mahadev Konar questioned this byte limit's need.  In any case consistency of create children, get children should exist.", "created_at" : { "$date" : "2009-01-13T18:15:32.799+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.162+0000" }, "creator_id" : { "$oid" : "5b7d4fd5e9214a0d1608d886" }, "reporter_id" : { "$oid" : "5b7d4fd5e9214a0d1608d886" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd65f627d6b05868c30" }, "external_id" : "ZOOKEEPER-269", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "connectionloss - add more documentation to detail ", "desc" : "discussion with user, this should be better documented:\n--------------\nThere are basically 2 cases where you can see connectionloss:\n\n1) you call an operation on a session that is no longer alive\n\n2) you are disconnected from a server when there are pending async operations to that server (you made an async request which has not yet completed)\n\nPatrick\n\nKevin Burton wrote:\n> Can this be thrown when using multiple servers as long as > 1 of them is\n> online?\n> Trying to figure out of I should try some type of reconnect if a single\n> machine fails instead of failing altogether.\n>\n> Kevin\n>\n", "created_at" : { "$date" : "2009-01-07T18:17:57.988+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.133+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fd65f627d6b05868c2f" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fd75f627d6b05868c43" }, "external_id" : "ZOOKEEPER-268", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "tostring on jute generated objects can cause NPE", "desc" : "Jute still causing problems with tostring operations on generated code, need to review/cleanup the toCSV code\n\nFrom user Kevin Burton:\n---------------------------------------------\nCreating this node with this ACL:\nCreated /foo\nsetAcl /foo world:anyone:w\n\nCauses the exception included below.\n\nIt's an infinite loop so it's just called over and over again filling my\nconsole.\n\nI'm just doing an exists( path, true ); ... setting a watch still causes the\nproblem.\n\n\n\njava.lang.NullPointerException\n        at org.apache.jute.Utils.toCSVBuffer(Utils.java:234)\n        at\norg.apache.jute.CsvOutputArchive.writeBuffer(CsvOutputArchive.java:101)\n        at\norg.apache.zookeeper.proto.GetDataResponse.toString(GetDataResponse.java:48)\n        at java.lang.String.valueOf(String.java:2827)\n        at java.lang.StringBuilder.append(StringBuilder.java:115)\n        at\norg.apache.zookeeper.ClientCnxn$Packet.toString(ClientCnxn.java:230)\n        at java.lang.String.valueOf(String.java:2827)\n        at java.lang.StringBuilder.append(StringBuilder.java:115)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:586)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:626)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:852)\njava.lang.NullPointerException\n        at org.apache.jute.Utils.toCSVBuffer(Utils.java:234)\n        at\norg.apache.jute.CsvOutputArchive.writeBuffer(CsvOutputArchive.java:101)\n        at\norg.apache.zookeeper.proto.GetDataResponse.toString(GetDataResponse.java:48)\n        at java.lang.String.valueOf(String.java:2827)\n        at java.lang.StringBuilder.append(StringBuilder.java:115)\n        at\norg.apache.zookeeper.ClientCnxn$Packet.toString(ClientCnxn.java:230)\n        at java.lang.String.valueOf(String.java:2827)\n        at java.lang.StringBuilder.append(StringBuilder.java:115)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:586)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:626)\n        at\norg.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:852)\n", "created_at" : { "$date" : "2009-01-07T18:05:01.266+0000" }, "updated_at" : { "$date" : "2009-02-13T21:18:54.013+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd75f627d6b05868c51" }, "external_id" : "ZOOKEEPER-273", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper c client build should not depend on CPPUNIT", "desc" : "One should be able to build Zookeeper C client libs on a machine without CPPUNIT installation.\n\nA simple fix is to remove from configure.ac the following line:\nM_PATH_CPPUNIT(1.10.2)\n\n\n", "created_at" : { "$date" : "2009-01-15T00:36:43.647+0000" }, "updated_at" : { "$date" : "2009-02-17T19:02:54.152+0000" }, "creator_id" : { "$oid" : "5b7d4fd7e9214a0d1608d887" }, "reporter_id" : { "$oid" : "5b7d4fd7e9214a0d1608d887" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd85f627d6b05868c6b" }, "external_id" : "ZOOKEEPER-317", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "avoid exporting functions which may be static", "desc" : "A number of functions in the 3.x.x C API such as add_to_list() and getImpl() from zk_hashtable.c and data_result_checker() and child_result_checker() from zookeeper.c could be marked static and removed from the set of exported functions.\n\nSince this change would remove functions from the API, it should wait for 4.0.0.", "created_at" : { "$date" : "2009-02-17T19:16:09.200+0000" }, "updated_at" : { "$date" : "2009-02-17T19:35:27.488+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.1.1", "3.2.0", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [ "4.0.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd85f627d6b05868c6f" }, "external_id" : "ZOOKEEPER-331", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create a privacy policy for the ZooKeeper website", "desc" : "It would be great to collect analytics about the visitors to the website and to do so, we need to create a privacy policy that tells visitors what we will collect.\n\nSee HADOOP-5190", "created_at" : { "$date" : "2009-02-27T19:10:16.999+0000" }, "updated_at" : { "$date" : "2009-02-27T19:10:16.999+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd95f627d6b05868c70" }, "external_id" : "ZOOKEEPER-313", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Problem with successive leader failures when no client is connected ", "desc" : "Steps to reproduce:\n\nCreate a 3 node cluster . Run some transactions and then stop all clients. Make sure no other clients connect for the duration of the test.\n\nLet L1 be the current leader. Bring down L1. Let L2 be the leader chosen.  Let the third node be N3. Note that this will increase the txn id for N3's snapshot without any  transaction being logged. Now bring up L1 -- same will happen for L1. Now bring down L2.\n\nBoth N3 and L1 now have snapshots with a transaction id greater than the last logged transaction. Whoever is elected leader will try to restore its state from the filesystem and fail.\n\nOne easy workaround is obviously to change the FileTxnSnapLog not to save a snapshot if zxid > last logged zxid. The correct solution is possibly to log a transaction for leader election as well.", "created_at" : { "$date" : "2009-02-13T22:20:11.824+0000" }, "updated_at" : { "$date" : "2009-03-04T19:01:27.070+0000" }, "creator_id" : { "$oid" : "5b7d4fd9e9214a0d1608d888" }, "reporter_id" : { "$oid" : "5b7d4fd9e9214a0d1608d888" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b7d4fda5f627d6b05868c78" }, "external_id" : "ZOOKEEPER-164", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Administering\"", "desc" : "Content/Information needed on the day to day running, management, administering of a ZooKeeper deployment.", "created_at" : { "$date" : "2008-10-06T14:12:49.511+0000" }, "updated_at" : { "$date" : "2009-03-12T01:00:34.847+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d4fda5f627d6b05868c7a" }, "external_id" : "ZOOKEEPER-166", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Logging\"", "desc" : "Content/information needed on Logging, from the point of view of the ZooKeeper Administrator", "created_at" : { "$date" : "2008-10-06T14:18:42.346+0000" }, "updated_at" : { "$date" : "2009-03-12T01:00:41.972+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d4fdb5f627d6b05868c7c" }, "external_id" : "ZOOKEEPER-357", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper cannot actually take care of a Zoo", "desc" : "Last week I setup an unattended ZooKeeper cluster that I expected to be able to take care of things while I was on vacation. I used 7 dedicated servers with two disks. I had done extensive burn in testing of the servers, so I fully expected the system to work problem free for the entire week. Indeed, when I returned yesterday none of the 7 servers had any hardware or software problem the entire time nor had there been any network problems. On the other hand the Zoo was in complete chaos. Even though there were no errors in the ZooKeeper log most of the animals were near starvation, except for the lions who had gotten loose and eaten some of the pigs. I'll not even go into the stench from the dirty cages!\n\nEither the documentation needs to more clearly explain how to configure the server properly in the Zoo environment, or it should clearly state that ZooKeeper cannot take care of the Zoo out of the box!", "created_at" : { "$date" : "2009-04-01T05:02:00.354+0000" }, "updated_at" : { "$date" : "2009-04-02T16:20:09.533+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdb5f627d6b05868c84" }, "external_id" : "ZOOKEEPER-387", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "closeLedger shouldn't shut down all QuorumEngines", "desc" : "We had initially assumed one ledger open at a time, and LedgerRecoverMonitor reads and closes a ledger without instantiating a QuorumEngine. Consequently, when closing a ledger, we have to shut down a QuorumEngine only if there is one. A poor way of implementing it is by having a for loop that iterates over all available QuorumEngines and shut them down. Given the assumptions of one ledger at a time and no QuorumEngine for LedgerRecoveryMonitor, this implementation works. However, as we move to a more flexible model in which multiple ledgers can be open and closed at arbitrary times, the for loop choice no longer works. \n\nThe attached patch fixes this problem by just shutting down the QuorumEngine instance corresponding to the ledger being closed, and it checks if a QuorumEngine exists before submitting a STOP operation. The patch also includes a test that opens four ledger, and then sequentially writes to the each ledger and closes it.", "created_at" : { "$date" : "2009-04-29T08:32:49.824+0000" }, "updated_at" : { "$date" : "2009-05-04T15:02:34.776+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fdb5f627d6b05868c83" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d4fdc5f627d6b05868c91" }, "external_id" : "ZOOKEEPER-401", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cleaning of logging in the code and log4j configuration might be a good idea", "desc" : "During the conversion of mainline tests from JUnit into TestNG it has been noticed (partially because TestNG doesn't intercept tests output) that some of log4j configuration parameters aren't very handy. E.g.\n - some of really non-important messages go at WARN level\n - by default all output goes into ConsoleAppender, which is a lot and makes it difficult to trace the execution from simply observing the console output\n - it'd be good to have a couple different log4j configs to be able to turn ConsoleAppender on and off by simply passing a parameter to ant build", "created_at" : { "$date" : "2009-05-12T21:35:29.669+0000" }, "updated_at" : { "$date" : "2009-05-12T21:35:29.669+0000" }, "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdd5f627d6b05868c92" }, "external_id" : "ZOOKEEPER-429", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Python contrib test failing on hudson", "desc" : "I was checking the console output of:\n\nhttp://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/100/\n\nand I observed the following output for the contrib tests:\n{noformat}\n     [exec] ======================================================================\n     [exec] ======================================================================\n     [exec]     Running contrib tests.\n     [exec] ======================================================================\n     [exec] ======================================================================\n     [exec] \n     [exec] \n     [exec] Warning: bad ps syntax, perhaps a bogus '-'? See http://procps.sf.net/faq.html\n     [exec] /bin/kill -9 30147 \n     [exec] kill: No such process\n     [exec] /home/hudson/tools/ant/latest/bin/ant  -Declipse.home=/home/nigel/tools/eclipse/latest -Dpython.home=/home/nigel/tools/python/latest -DZooKeeperPatchProcess= -Dtest.junit.output.format=xml -Dtest.output=yes test-contrib\n     [exec] Buildfile: build.xml\n     [exec] \n     [exec] test-contrib:\n     [exec] \n     [exec] BUILD SUCCESSFUL\n     [exec] Total time: 0 seconds\n{noformat}", "created_at" : { "$date" : "2009-06-03T07:14:52.625+0000" }, "updated_at" : { "$date" : "2009-06-03T11:31:24.269+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fde5f627d6b05868c98" }, "external_id" : "ZOOKEEPER-29", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Flexible quorums", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1938782&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:12:38.530+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:55.890+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdf5f627d6b05868cfa" }, "external_id" : "ZOOKEEPER-36", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "REST access to ZooKeeper", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1961763&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:39:28.948+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:55.996+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdf5f627d6b05868d1f" }, "external_id" : "ZOOKEEPER-82", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdf5f627d6b05868d20" }, "external_id" : "ZOOKEEPER-94", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMX tests are needed to verify that the JMX MBeans work properly", "created_at" : { "$date" : "2008-07-25T14:22:22.393+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.267+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [ "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fdf5f627d6b05868d1f" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" }, "external_id" : "ZOOKEEPER-78", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f6b5f627d6b05868438" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2008-07-17T15:35:42.948+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.183+0000" }, "title" : "added a high level protocol/feature - for easy Leader Election or exclusive Write Lock creation", "issue_type" : "New Feature", "desc" : "Here's a patch which adds a little WriteLock helper class for performing leader elections or creating exclusive locks in some directory znode. Note its an early cut; am sure we can improve it over time. The aim is to avoid folks having to use the low level ZK stuff but provide a simpler high level abstraction.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fe25f627d6b05868d9d" }, "external_id" : "ZOOKEEPER-60", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Get cppunit tests running as part of Hudson CI", "desc" : "Investigate if it is possible to run cppunit tests as part of Hudson.", "created_at" : { "$date" : "2008-06-30T21:51:40.461+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.077+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe25f627d6b05868dc8" }, "external_id" : "ZOOKEEPER-244", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "AsyncOpsTest fails when running consecutively", "desc" : "Attaching output log file.", "created_at" : { "$date" : "2008-12-03T21:18:19.214+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.633+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.2.0" ], "issue_links" : [  ], "environment" : "MacOS X 10.5.5, Java 1.6.0_05" },
{ "_id" : { "$oid" : "5b7d4fe35f627d6b05868dd2" }, "external_id" : "ZOOKEEPER-424", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe35f627d6b05868dd3" }, "external_id" : "ZOOKEEPER-237", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add a Chroot request", "desc" : "It would be nice to be able to root ZooKeeper handles at specific points in the namespace, so that applications that use ZooKeeper can work in their own rooted subtree.\n\nFor example, if ops decides that application X can use the subtree /apps/X and application Y can use the subtree /apps/Y, X can to a chroot to /apps/X and then all its path references can be rooted at /apps/X. Thus when X creates the path \"/myid\", it will actually be creating the path \"/apps/X/myid\".\n\nThere are two ways we can expose this mechanism: 1) We can simply add a chroot(String path) API, or 2) we can integrate into a service identifier scheme for example zk://server1:2181,server2:2181/my/root. I like the second form personally.", "created_at" : { "$date" : "2008-11-24T21:28:56.169+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.542+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe35f627d6b05868dd2" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4fe35f627d6b05868dd0" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4fe35f627d6b05868dd1" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fe45f627d6b05868dfe" }, "external_id" : "ZOOKEEPER-292", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "commit configure scripts (autotools) to svn for c projects and include in release", "desc" : "We currently don't include configure scripts, just the .ac file itself. This means that users are required\nto run \"autoreconf; ./configure\" rather than just configure.\n\nWe should commit the configure script(s) to svn (hadoop core does this btw) for our autotools based projects (currently c client api and zkfuse).\n\nAlso these should be included in the build.\n", "created_at" : { "$date" : "2009-02-05T01:27:08.277+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.977+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "contrib-zkfuse" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe45f627d6b05868dfd" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fe55f627d6b05868e0e" }, "external_id" : "ZOOKEEPER-192", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "trailing whitespace in config file can cause number format exceptions", "desc" : "a config file with trailing whitespace can cause number format exception\n\nfor example a line such as\n\nclientPort=2181\n\nwhere 2181 is followed by a space character, will fail to parse with number format excetion \"2181 \" (notice the space).\n\nWe need to trim whitespace when parsing numbers", "created_at" : { "$date" : "2008-10-15T22:49:54.477+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.415+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe55f627d6b05868e1c" }, "external_id" : "ZOOKEEPER-196", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "doxygen comment for state argument of watcher_fn typedef and implementation differ (\"...one of the *_STATE constants, otherwise -1\")", "desc" : "In zookeeper.h:\n * \\param state connection state. If the type is ZOO_SESSION_EVENT, the state value \n * will be one of the *_STATE constants, otherwise -1.\nbut for this sequence:\n 1. zoo_awexists(name)\n 2. zoo_acreate(name)\nwe've got a watcher callback with type=ZOO_CREATED_EVENT and state!=-1\n\nI think the comment should be altered to underline the difference between zookeeper_init() callback usage and others (\"the getter API functions with the \"w\" prefix in their names\") for the new \"watcher object\" style.\nIt looks like the type and path argument values are useless for the former (because type is always ZOO_SESSION_EVENT, and path is always empty), and the state is useless for the latter (it is considered to be -1).\n\nAnd more,  the state of the legacy style should be commented - will it be marked as obsolete? Or will it be supported in the future?\n\nI wonder if there are any plans to split current watcher_fn callback to something like:\n1. new watcher_fn: typedef void (*watcher_fn)(zhandle_t *zh, int type, const char *path, void *watcherCtx);\n2. connection_fn: typedef void (*watcher_fn)(zhandle_t *zh, int state, void *context);\nBecause, you see, the usage is different and there is no any common set of arguments apart from zh (which is common for API) and context.", "created_at" : { "$date" : "2008-10-20T12:12:56.640+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.480+0000" }, "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d4fe65f627d6b05868e2d" }, "external_id" : "HADOOP-3532", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe65f627d6b05868e2e" }, "external_id" : "HADOOP-2421", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe65f627d6b05868e30" }, "external_id" : "ZOOKEEPER-148", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add jdiff support to zookeeper release process", "desc" : "Add jdiff support to enable detailed release notes on changes to java.\n\nHadoop just added code for including that in the build: HADOOP-2421.\n\n", "created_at" : { "$date" : "2008-09-26T20:16:50.291+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.324+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe65f627d6b05868e2e" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4fe65f627d6b05868e2f" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4fe65f627d6b05868e2d" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fe75f627d6b05868e3f" }, "external_id" : "ZOOKEEPER-274", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document options to connect Jconsole remotely", "desc" : "Here is the command I used:\n\njava -cp .:./zookeeper-dev.jar:/usr/local/apache-log4j-1.2.15/log4j-1.2.15.jar -Dlog4j.configuration=log4j_console.properties -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=12122 -Dcom.sun.management.jmxremote.local.only=false -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false org.apache.zookeeper.server.quorum.QuorumPeerMain zoo.cfg\n\nIn addition to the ones in jira 234, we also need the following to connect remotely:\n-Dcom.sun.management.jmxremote.port\n-Dcom.sun.management.jmxremote.authenticate=false\n-Dcom.sun.management.jmxremote.ssl=false\n\nThis command assumes no authentication or secure connection through ssl. To use authentication, other options are necessary, such as the password file:\n-Dcom.sun.management.jmxremote.password.file\n\nIn general, I found the following page a good source of information on this topic:\n\nhttp://java.sun.com/javase/6/docs/technotes/guides/management/agent.html\n\n\n\n\n", "created_at" : { "$date" : "2009-01-15T14:58:30.070+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.741+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "jmx" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fd65f627d6b05868c2f" }, "external_id" : "ZOOKEEPER-264", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "documentation" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fd65f627d6b05868c30" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-01-05T20:00:15.605+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.699+0000" }, "title" : "docs should include a state transition diagram for client state", "issue_type" : "Improvement", "desc" : "we should have a state transition diagram to help users understand client state transitions. perhaps the edges could indicate what might cause such a  transition? (not sure if that will work). keep in mind for the states that the java/c clients have diff names for constants (not sure how to handle). This should be added to the programmer guide in the appropriate section.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fe85f627d6b05868e60" }, "external_id" : "ZOOKEEPER-288", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cleanup and fixes to BookKeeper", "desc" : "We observed one race condition when multiple threads try to write concurrently. This patch should fix it.  I will also remove some commented code.", "created_at" : { "$date" : "2009-02-03T11:49:47.084+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.913+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fe45f627d6b05868dfd" }, "external_id" : "ZOOKEEPER-281", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1" ], "components" : [ "c client" ], "fix_versions" : [ "3.2.0", "3.1.1" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe45f627d6b05868dfe" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-01-29T14:44:23.832+0000" }, "priority" : "Major", "desc" : "> autoreconf -i -f -v\nautoreconf-2.63: Entering directory `.'\nautoreconf-2.63: configure.ac: not using Gettext\nautoreconf-2.63: running: aclocal --force \nconfigure.ac:21: error: AC_SUBST: `DX_FLAG_[]DX_CURRENT_FEATURE' is not a valid shell variable name\nacinclude.m4:77: DX_REQUIRE_PROG is expanded from...\nacinclude.m4:117: DX_ARG_ABLE is expanded from...\nacinclude.m4:178: DX_INIT_DOXYGEN is expanded from...\nconfigure.ac:21: the top level\nautom4te-2.63: /usr/bin/m4 failed with exit status: 1\naclocal-1.10: autom4te failed with exit status: 1\nautoreconf-2.63: aclocal failed with exit status: 1\n>", "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "updated_at" : { "$date" : "2009-07-08T20:23:56.861+0000" }, "title" : "autoreconf fails for /zookeeper-3.0.1/src/c/", "issue_type" : "Bug", "environment" : "Linux dememax-laptop 2.6.27-gentoo-r8 #2 SMP Fri Jan 23 13:42:35 MSK 2009 i686 Intel(R) Core(TM)2 CPU T5600 @ 1.83GHz GenuineIntel GNU/Linux\nautoconf (GNU Autoconf) 2.63\nautomake (GNU automake) 1.10.2\nm4 (GNU M4) 1.4.11\naclocal (GNU automake) 1.10.2\nltmain.sh (GNU libtool) 1.5.26 (1.1220.2.493 2008/02/01 16:58:18)\nbasename (GNU coreutils) 6.10\ngettext (GNU gettext-runtime) 0.17\nGNU ld (GNU Binutils) 2.18", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4fea5f627d6b05868e93" }, "external_id" : "ZOOKEEPER-314", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add wiki docs for bookeeper.", "desc" : "we should have a wiki page for bookeeper for users to take a cursory look at what it is.", "created_at" : { "$date" : "2009-02-17T18:30:30.430+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.425+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fea5f627d6b05868e9b" }, "external_id" : "ZOOKEEPER-307", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log exception stack traces", "desc" : "For some exceptions, both on ZooKeeper and BookKeeper, we are calling printStackTrace explicitly instead of making a call to the logger. ", "created_at" : { "$date" : "2009-02-09T18:50:27.593+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.306+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4feb5f627d6b05868ea0" }, "external_id" : "ZOOKEEPER-306", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add BookKeeper documentation", "desc" : "Add detailed documentation about BookKeeper.", "created_at" : { "$date" : "2009-02-09T16:59:21.140+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.266+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.2.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fec5f627d6b05868ea6" }, "external_id" : "ZOOKEEPER-305", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Replace timers with semaphores in FLENewEpochTest", "desc" : "This patch replaces timers in the test with semaphores.", "created_at" : { "$date" : "2009-02-07T14:08:47.641+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.190+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fec5f627d6b05868ea5" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fec5f627d6b05868eb6" }, "external_id" : "ZOOKEEPER-309", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "core dump using zoo_get_acl() ", "desc" : "The zookeeper_process() function incorrectly calls the c.acl_result member of the completion_list_t structure when handling the completion from a synchronous zoo_get_acl() request.  The c.acl_result member is set to SYNCHRONOUS_MARKER, which is a null pointer.\n\nThe attached patch removes this call.", "created_at" : { "$date" : "2009-02-10T22:21:50.884+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.350+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fed5f627d6b05868ed5" }, "external_id" : "ZOOKEEPER-298", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some excecutables (scripts typ.) are not marked as such in tar generated by \"ant tar\"", "desc" : "The configure scripts in src/c, the zkServer.sh in src/c/test, and some of the other scripts are not marked as executable when running \"ant tar\". The build.xml should be updated to mark appropriately.\n", "created_at" : { "$date" : "2009-02-05T22:23:42.006+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.013+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fee5f627d6b05868edb" }, "external_id" : "ZOOKEEPER-299", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "server startup scripts fail on a mac.", "desc" : "JMX enabled by default\nreadlink: illegal option -- f\nusage: readlink [-n] [file ...]\n\n./zkEnv.sh no such file.\n\nif you run bin/zkServer.sh start this is the error i get.\nif I run it from the bin directory then it seems to be fine.", "created_at" : { "$date" : "2009-02-05T23:22:28.577+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.063+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fee5f627d6b05868eda" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d4fee5f627d6b05868ee1" }, "external_id" : "ZOOKEEPER-300", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zk jmx code is calling printStackTrace when creating bean name (should not be)", "desc" : "remove printStackTrace from zk jmx code (review the rest of the code at the same time)\n", "created_at" : { "$date" : "2009-02-05T23:24:03.442+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:57.121+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fef5f627d6b05868eee" }, "external_id" : "ZOOKEEPER-315", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add forrest docs for bookkeeper.", "desc" : "we should have forrest docs  for bookkeeper for \n- how to install bookkeeper\n- usage model\n- programming examples for users\n- FAQ", "created_at" : { "$date" : "2009-02-17T18:32:30.167+0000" }, "updated_at" : { "$date" : "2009-07-08T20:23:59.944+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff05f627d6b05868eff" }, "external_id" : "ZOOKEEPER-330", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper standalone server does not startup with just a port and datadir.", "desc" : "ZOOKEEPER-326 made a change to zookeeperservermain.java that broke the starting of zookeeperserver with just the port and datadir.", "created_at" : { "$date" : "2009-02-25T01:30:37.304+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.490+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff05f627d6b05868f0d" }, "external_id" : "ZOOKEEPER-318", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove locking in zk_hashtable.c or add locking in collect_keys()", "desc" : "From a review of zk_hashtable.c it appears to me that all functions which manipulate the hashtables are called from the IO thread, and therefore any need for locking is obviated.\n\nIf I'm wrong about that, then I think at a minimum collect_keys() should acquire a lock in the same manner as collect_session_watchers().  Both iterate over hashtable contents (in the latter case using copy_table()).\n\nHowever, from what I can see, the only function (besides the init/destroy functions used when creating a zhandle_t) called from the completion thread is deliverWatchers(), which simply iterates over a \"delivery\" list created from the hashtables by collectWatchers().  The activateWatcher() function contains comments which describe it being called by the completion thread, but in fact it is called by the IO thread in zookeeper_process().\n\nI believe all calls to collectWatchers(), activateWatcher(), and collect_keys() are made by the IO thread in zookeeper_interest(), zookeeper_process(), check_events(), send_set_watches(), and handle_error().  Note that queue_session_event() is aliased as PROCESS_SESSION_EVENT, but appears only in handle_error() and check_events().\n\nAlso note that handle_error() is called only in zookeeper_process() and handle_socket_error_msg(), which is used only by the IO thread, so far as I can see.", "created_at" : { "$date" : "2009-02-17T20:52:02.030+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.012+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff15f627d6b05868f22" }, "external_id" : "ZOOKEEPER-327", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document effects (latency) of storing large amounts of data in znodes", "desc" : "znodes have max 1mb of data storage. using zk to store large amounts of data can negatively impact latency as seen by clients - the server needs to serve the data. often it's a better idea to store a \"token\" (say a uri) in the znode pointing to a large data block stored elsewhere (filesystem? memcached, etc...) this offloads zk and reduces latency impact\n\nwe should have details of this in the forrest docs.\n", "created_at" : { "$date" : "2009-02-23T19:11:40.127+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.427+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff25f627d6b05868f2c" }, "external_id" : "ZOOKEEPER-326", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "standalone server ignores tickTime configuration", "desc" : "When using the ZooKeeper server in standalone mode, it ignores the tickTime setting in the configuration file and uses the DEFAULT_TICK_TIME of 3000 coded into ZooKeeperServer.java.", "created_at" : { "$date" : "2009-02-20T20:12:15.110+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.347+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff25f627d6b05868f37" }, "external_id" : "ZOOKEEPER-341", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "regression in QuorumPeerMain, tickTime from config is lost, cannot start quorum", "desc" : "ZOOKEEPER 330/336 caused a regression in QuorumPeerMain -- cannot reliably start a cluster due to missing tickTime.", "created_at" : { "$date" : "2009-03-18T16:11:12.554+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.901+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff35f627d6b05868f42" }, "external_id" : "ZOOKEEPER-343", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add tests that specifically verify the zkmain and qpmain classes", "desc" : "We are missing tests for these two main() routines.\n\nAdd tests that verify standalone and quorum (2 servers is probably enough) by starting and connecting a client.\n\nUse on-disk configuration files to configure these.\n(ie verify starting with actual config files)", "created_at" : { "$date" : "2009-03-18T16:17:59.876+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.965+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff45f627d6b05868f5a" }, "external_id" : "ZOOKEEPER-342", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve configuration code - remove static config and use java properties", "desc" : "The current server/quorum config classes are essentially global variables. Need to fix configuration parsing, remove use of essentially global vars (static) and also cleanup the code generally.\n\nAdd tests specific to configurtion parsing.\n", "created_at" : { "$date" : "2009-03-18T16:16:13.301+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.934+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff45f627d6b05868f64" }, "external_id" : "ZOOKEEPER-340", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "binaryinputarchive throws out runtimeexceptions for unreasonable length datastructures.", "desc" : "binaryinputarchive throws out runtimeexceptions for unreasonable length datastructures. We should change that to be IOExceptions so that we can handle partial writes to logs,, machine powerdown better.\n", "created_at" : { "$date" : "2009-03-17T22:16:39.773+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.817+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "jute", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4ff45f627d6b05868f63" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d4ff55f627d6b05868f77" }, "external_id" : "ZOOKEEPER-336", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "single bad client can cause server to stop accepting connections", "desc" : "One user saw a case where a single mis-programmed client was overloading the server with connections - the client was creating a huge number of sessions to the server. This caused all of the fds on the  server to become used.\n\nSeems like we should have some way of limiting (configurable override) the maximum number of sessions from a single client (say 10 by default?) Also we should output warnings when this limit is exceeded (or attempt to exceed).\n\n", "created_at" : { "$date" : "2009-03-12T18:37:15.086+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.720+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff65f627d6b05868fa2" }, "external_id" : "ZOOKEEPER-334", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bookkeeper benchmark (testclient.java) has compiling errros.", "desc" : "bookkeeper benchmark (testclient.java) has compiling errors.\n", "created_at" : { "$date" : "2009-02-27T23:55:44.282+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.637+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff75f627d6b05868fb0" }, "external_id" : "ZOOKEEPER-333", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "helgrind thread issues identified in mt c client code", "desc" : "helgrind generated a number of issues, I pulled a bunch of them. Most are related to the test, some are really issues with the mt zk client code though:\n\nvalgrind --tool=helgrind --log-file=helgrind_mt.out ./zktest-mt\n\n\n==31294== Thread #2: pthread_cond_{timed}wait called with un-held mutex\n==31294==    at 0x4027F8F: pthread_cond_wait@* (hg_intercepts.c:560)\n==31294==    by 0x404D881: pthread_cond_wait@GLIBC_2.0 (in /lib/tls/i686/cmov/libpthread-2.8.90.so)\n==31294==    by 0x4028037: pthread_cond_wait@* (hg_intercepts.c:574)\n==31294==    by 0x809EBB7: pthread_cond_wait (PthreadMocks.cc:54)\n==31294==    by 0x80ABCF6: notify_thread_ready (mt_adaptor.c:136)\n==31294==    by 0x80ABE90: do_io (mt_adaptor.c:277)\n\n\n==31294== Possible data race during write of size 4 at 0x42E9A58\n==31294==    at 0x8050D83: terminateZookeeperThreads(_zhandle*) (ZKMocks.cc:518)\n==31294==    by 0x805543B: DeliverWatchersWrapper::call(_zhandle*, int, int, char const*, watcher_object_list**) (ZKMocks.cc:261)\n==31294==    by 0x80520F7: __wrap_deliverWatchers (ZKMocks.cc:220)\n==31294==    by 0x80A287B: process_completions (zookeeper.c:1393)\n==31294==    by 0x80ABDAA: do_completion (mt_adaptor.c:332)\n\n==31294== Possible data race during write of size 4 at 0xBEFF5F30\n==31294==    at 0x80589AF: Zookeeper_watchers::ConnectionWatcher::~ConnectionWatcher() (TestWatchers.cc:54)\n==31294==    by 0x805D062: Zookeeper_watchers::testDefaultSessionWatcher1() (TestWatchers.cc:438)\n==31294==    by 0x805608C: CppUnit::TestCaller<Zookeeper_watchers>::runTest() (TestCaller.h:166)\n\n\n==31294== Possible data race during write of size 4 at 0x42EB104\n==31294==    at 0x80A03EE: queue_completion (zookeeper.c:1776)\n==31294==    by 0x80A3A44: zookeeper_process (zookeeper.c:1598)\n==31294==    by 0x80AC00B: do_io (mt_adaptor.c:309)\n\n\n==31294== Thread #29: pthread_cond_{timed}wait called with un-held mutex\n==31294==    at 0x4027F8F: pthread_cond_wait@* (hg_intercepts.c:560)\n==31294==    by 0x404D881: pthread_cond_wait@GLIBC_2.0 (in /lib/tls/i686/cmov/libpthread-2.8.90.so)\n==31294==    by 0x4028037: pthread_cond_wait@* (hg_intercepts.c:574)\n==31294==    by 0x809EBB7: pthread_cond_wait (PthreadMocks.cc:54)\n==31294==    by 0x80AB9B3: wait_sync_completion (mt_adaptor.c:82)\n==31294==    by 0x80A1E82: zoo_wget (zookeeper.c:2517)\n==31294==    by 0x80A1F13: zoo_get (zookeeper.c:2497)\n\n\n\n\n\n", "created_at" : { "$date" : "2009-02-27T21:56:25.242+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.602+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff85f627d6b05868fc3" }, "external_id" : "ZOOKEEPER-332", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client issues (memory leaks) reported by valgrind", "desc" : "Attaching valgrind log files.\n\n1)  getpwuid_r doesn't seem like it's due to us\n2) the rest seem to be valid\n", "created_at" : { "$date" : "2009-02-27T20:04:12.025+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.569+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0", "3.1.1" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fec5f627d6b05868ea5" }, "external_id" : "ZOOKEEPER-325", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.0" ], "components" : [ "quorum" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4ff85f627d6b05868fd1" }, "effect" : "duplicates", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d4fec5f627d6b05868ea6" }, "effect" : "relates to", "type" : "Reference" } ], "created_at" : { "$date" : "2009-02-20T00:04:55.731+0000" }, "priority" : "Major", "desc" : "FLENewEpochTest fails quite frequently on my machine. ", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.284+0000" }, "title" : "FLENewEpoch test fails.", "issue_type" : "Bug", "environment" : "linux 2.6.9-5.ELsmp", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4ffa5f627d6b05868fdc" }, "external_id" : "ZOOKEEPER-320", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "call auth completion in free_completions()", "desc" : "If a client calls zoo_add_auth() with an invalid scheme (e.g., \"foo\") the ZooKeeper server will mark their session expired and close the connection.  However, the C client has returned immediately after queuing the new auth data to be sent with a ZOK return code.\n\nIf the client then waits for their auth completion function to be called, they can wait forever, as no session event is ever delivered to that completion function.  All other completion functions are notified of session events by free_completions(), which is called by cleanup_bufs() in handle_error() in handle_socket_error_msg().\n\nIn actual fact, what can happen (about 50% of the time, for me) is that the next call by the IO thread to flush_send_queue() calls send() from within send_buffer(), and receives a SIGPIPE signal during this send() call.  Because the ZooKeeper C API is a library, it properly does not catch that signal.  If the user's code is not catching that signal either, they experience an abort caused by an untrapped signal.  If they are ignoring the signal -- which is common in context I'm working in, the Apache httpd server -- then flush_send_queue()'s error return code is EPIPE, which is logged by handle_socket_error_msg(), and all non-auth completion functions are notified of a session event.  However, if the caller is waiting for their auth completion function, they wait forever while the IO thread tries repeatedly to reconnect and is rejected by the server as having an expired session.\n\nSo, first of all, it would be useful to document in the C API portion of the programmer's guide that trapping or ignoring SIGPIPE is important, as this signal may be generated by the C API.\n\nNext, the two attached patches call the auth completion function, if any, in free_completions(), which fixes this problem for me.  The second attached patch includes auth lock/unlock function, as per ZOOKEEPER-319.", "created_at" : { "$date" : "2009-02-17T22:48:01.243+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.186+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ffa5f627d6b05868ff2" }, "external_id" : "ZOOKEEPER-319", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add locking around auth info in zhandle_t", "desc" : "Looking over the zookeeper.c code it appears to me that the zoo_add_auth() function may be called at any time by the user in their \"main\" thread.  This function alters the elements of the auth_info structure in the zhandle_t structure.\n\nMeanwhile, the IO thread may read those elements at any time in such functions as send_auth_info() and auth_completion_func().  It seems important, then, to add a lock which prevents data being read by the IO thread while only partially changed by the user's thread.  The attached patch add such a lock.", "created_at" : { "$date" : "2009-02-17T22:32:27.602+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:00.116+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ffb5f627d6b05869003" }, "external_id" : "ZOOKEEPER-344", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "doIO in NioServerCnxn: Exception causing close of session : cause is \"read error\"", "desc" : "I have been having a problem with zookeeper 3.0.1 and now with 3.1.0 where I see a lot of expired sessions.  I am using a 16 node cluster which is all on the same local network.  There is a single zookeeper instance (these are benchmarking runs).\nThe problem appears to be correlated with either run time or system load.\\\n\nPersonally I think that it is system load because I have session session expired events under a Windows platform running zookeeper and the application (i.e., everthing is local) when the application load suddenly spikes.  To me this suggests that the client is not able to renew (ping) the zookeeper service in a timely manner and is expired.  But the log messages below with the \"read error\" suggest that maybe there is something else going on?\n\nZookeeper Configuration\n#Wed Mar 18 12:41:05 GMT-05:00 2009\nclientPort=2181\ndataDir=/var/bigdata/benchmark/zookeeper/1\nsyncLimit=2\ndataLogDir=/var/bigdata/benchmark/zookeeper/1\ntickTime=2000\n\nSome representative log messages are below.\n\nClient side messages (from our app)\nERROR [main-EventThread] com.bigdata.zookeeper.ZLockImpl$ZLockWatcher.process(ZLockImpl.java:400) 2009-03-18 13:35:40,335 - Session expired: WatchedEvent: Server state change. New state: Expired : zpath=/benchmark/jobs/com.bigdata.service.jini.benchmark.ThroughputMaster/test_1/client1160/locknode\nERROR [main-EventThread] com.bigdata.zookeeper.ZLockImpl$ZLockWatcher.process(ZLockImpl.java:400) 2009-03-18 13:35:40,335 - Session expired: WatchedEvent: Server state change. New state: Expired : zpath=/benchmark/jobs/com.bigdata.service.jini.benchmark.ThroughputMaster/test_1/client1356/locknode\n\nServer side messages:\n WARN [NIOServerCxn.Factory:2181] org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:417) 2009-03-18 13:06:57,252 - Exception causing close of session 0x1201aac14300022 due to java.io.IOException: Read error\n WARN [NIOServerCxn.Factory:2181] org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:417) 2009-03-18 13:06:58,198 - Exception causing close of session 0x1201aac1430000f due to java.io.IOException: Read error\n", "created_at" : { "$date" : "2009-03-18T18:45:48.301+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.048+0000" }, "creator_id" : { "$oid" : "5b7d4fe8e9214a0d1608d88e" }, "reporter_id" : { "$oid" : "5b7d4fe8e9214a0d1608d88e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "jdk1.6.0_07\nLinux blade2 2.6.27.7-134.fc10.x86_64 #1 SMP Mon Dec 1 22:21:35 EST 2008 x86_64 x86_64 x86_64 GNU/Linux" },
{ "_id" : { "$oid" : "5b7d4ffc5f627d6b0586901c" }, "external_id" : "ZOOKEEPER-350", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "to run rats for releaseaudit ", "created_at" : { "$date" : "2009-03-26T20:50:27.610+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.439+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" } },
{ "_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" }, "external_id" : "ZOOKEEPER-349", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "build" ], "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "created_at" : { "$date" : "2009-03-26T20:49:33.284+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.364+0000" }, "title" : "to automate patch testing ", "issue_type" : "Improvement", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4ffd5f627d6b05869036" }, "external_id" : "ZOOKEEPER-348", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Creating node with path ending in \"/\" with sequence flag set", "desc" : "In 3.0.1, I could create a sequence node like this:\n/nodes/0000001\nlike this:\nstring path = \"/nodes/\";\nstring value = \"data\";\nint rc = zoo_acreate(zh, path.c_str(), value.c_str(), value.length(), &ZOO_OPEN_ACL_UNSAFE, ZOO_EPHEMERAL | ZOO_SEQUENCE, &czoo_created, &where);\n\nIn 3.1.1, this fails with error -8 (ZBADARGUMENTS).\n\nAdding something after the \"/\" in the path makes the code work fine:\nstring path = \"/nodes/n\";\n\nI assume something is checking if the path ends in \"/\" but not checking the sequence flag.", "created_at" : { "$date" : "2009-03-26T19:11:45.430+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.314+0000" }, "creator_id" : { "$oid" : "5b7d4ffde9214a0d1608d890" }, "reporter_id" : { "$oid" : "5b7d4ffde9214a0d1608d890" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ffe5f627d6b05869047" }, "external_id" : "ZOOKEEPER-347", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkfuse uses non-standard String", "desc" : "I'm getting an error compiling zkfuse:\n\ng++ -DHAVE_CONFIG_H -I. -I..    -I/home/nitay/code/zookeeper-git/src/contrib/zkfuse/../../c/include -I/home/nitay/code/zookeeper-git/src/contrib/zkfuse/../../c/generated -I../include -I/usr/include -D_FILE_OFFSET_BITS=64 -D_REENTRANT -g -O2 -MT zkfuse.o -MD -MP -MF .deps/zkfuse.Tpo -c -o zkfuse.o zkfuse.cc\nzkfuse.cc: In function 'int main(int, char**)':\nzkfuse.cc:4282: error: 'String' does not name a type\nzkfuse.cc:4283: error: 'file' was not declared in this scope\nmake[2]: *** [zkfuse.o] Error 1\nmake[2]: Leaving directory `/home/nitay/code/zookeeper-git/src/contrib/zkfuse/src'\nmake[1]: *** [all-recursive] Error 1\nmake[1]: Leaving directory `/home/nitay/code/zookeeper-git/src/contrib/zkfuse'\nmake: *** [all] Error 2\n\n4279     /**\n4280      * Initialize log4cxx \n4281      */\n4282     const String file(\"log4cxx.properties\");\n4283     PropertyConfigurator::configureAndWatch( file, 5000 );\n4284     LOG_INFO(LOG, \"Starting zkfuse\");\n\n\nString is not standard, we should change it to std::string.", "created_at" : { "$date" : "2009-03-26T00:13:38.819+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.265+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [ "contrib-zkfuse" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "gcc (GCC) 4.3.2 20081105 (Red Hat 4.3.2-7)" },
{ "_id" : { "$oid" : "5b7d4ffe5f627d6b05869056" }, "external_id" : "ZOOKEEPER-353", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "javadoc warnings needs to be fixed ", "desc" : "[javadoc] /.../SOMETHING/trunk/src/java/generated/org/apache/zookeeper/server/quorum/QuorumPacket.java:46: cannot find symbol\n  [javadoc] symbol  : class OutputArchive\n  [javadoc] location: class org.apache.zookeeper.server.quorum.QuorumPacket\n  [javadoc]   public void serialize(OutputArchive a_, String tag) throws java.io.IOException {\n  [javadoc]                         ^\n  [javadoc] /.../SOMETHING/trunk/src/java/generated/org/apache/zookeeper/server/quorum/QuorumPacket.java:63: cannot find symbol\n  [javadoc] symbol  : class InputArchive\n  [javadoc] location: class org.apache.zookeeper.server.quorum.QuorumPacket\n  [javadoc]   public void deserialize(InputArchive a_, String tag) throws java.io.IOException {\n  [javadoc]                           ^\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n  [javadoc] Generating /.../SOMETHING/trunk/build/docs/api/stylesheet.css...\n  [javadoc] 4 errors\n  [javadoc] 124 warnings\n\n", "created_at" : { "$date" : "2009-03-26T23:17:31.166+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.583+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" } },
{ "_id" : { "$oid" : "5b7d4fff5f627d6b0586906a" }, "external_id" : "ZOOKEEPER-355", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "make  validatePath non public in Zookeeper client api.", "desc" : "make  validatePath non public in Zookeeper client api.", "created_at" : { "$date" : "2009-03-27T05:09:51.521+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.648+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50005f627d6b05869081" }, "external_id" : "ZOOKEEPER-352", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "to add standard ant targets required by test-patch.sh script", "created_at" : { "$date" : "2009-03-26T22:31:14.421+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.507+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" } },
{ "_id" : { "$oid" : "5b7d50015f627d6b05869091" }, "external_id" : "ZOOKEEPER-351", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "to run checkstyle", "created_at" : { "$date" : "2009-03-26T22:01:52.786+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.475+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" } },
{ "_id" : { "$oid" : "5b7d50025f627d6b058690a1" }, "external_id" : "ZOOKEEPER-354", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "to fix javadoc warning in the source files", "desc" : " [javadoc] trunk/src/java/main/org/apache/zookeeper/ZooKeeper.java:597: warning - Tag @see:illegal character: \"60\" in \"#create(String, byte[], List<ACL>, CreateMode)\"\n  [javadoc]trunk/src/java/main/org/apache/zookeeper/ZooKeeper.java:597: warning - Tag @see:illegal character: \"62\" in \"#create(String, byte[], List<ACL>, CreateMode)\"\n  [javadoc]trunk/src/java/main/org/apache/zookeeper/ZooKeeper.java:597: warning - Tag @see: can't find create(String, byte[], List<ACL>, CreateMode) in org.apache.zookeeper.ZooKeeper\n  [javadoc]trunk/src/java/main/org/apache/zookeeper/ZooKeeper.java:499: warning - @param argument \"flags\" is not a parameter name.\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n  [javadoc] Generating trunk/build/docs/api/stylesheet.css...\n  [javadoc] 24 warnings\n\n", "created_at" : { "$date" : "2009-03-26T23:52:56.117+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.616+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4ffc5f627d6b0586901b" } },
{ "_id" : { "$oid" : "5b7d50025f627d6b058690b5" }, "external_id" : "ZOOKEEPER-346", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove the kill command fro mthe client port.", "desc" : "we should just remove the kill command from the client port. Its a security risk (though we do not have much security right now) to be able to kill the server from a tcp port without any authentication... ", "created_at" : { "$date" : "2009-03-23T23:34:45.137+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.179+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50035f627d6b058690c8" }, "external_id" : "ZOOKEEPER-345", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the CLIs should allow addAuth to be invoked", "desc" : "Not sure about the c client but the java CLI ZooKeeperMain does not allow addAuth to be called, it should have a command for this.\n", "created_at" : { "$date" : "2009-03-23T23:28:09.790+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:01.119+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50045f627d6b058690d8" }, "external_id" : "ZOOKEEPER-373", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "One thread per bookie", "desc" : "Currently, if a client is writing to multiple ledgers and these ledgers overlap on some bookie, there will be as many threads for such a bookie as the number of ledgers writing to it. Consequently, if a client writes to many ledgers simultaneously, it may end up with an undesirably large number of threads. I don't have a concrete proposal yet, but I suspect it is as simple as keeping an array of BookieHandle objects, one per bookie, and having each BookieHandle object shared by all ledgers.\n ", "created_at" : { "$date" : "2009-04-09T15:41:10.096+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.878+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4ff85f627d6b05868fd1" }, "external_id" : "ZOOKEEPER-362", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.1" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fec5f627d6b05868ea5" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-04-03T09:04:29.436+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.606+0000" }, "title" : "Issues with FLENewEpochTest", "issue_type" : "Bug", "desc" : "I have been able to identify two reasons that cause FLENewEpochTest to fail:\n\n1- There is a race condition that is triggered when two peers try to establish a connection to each other for leader election. Basically, if they start roughly at the same time, the server with highest id will try to open two connections. The two competing connections will lead to one notification message to be lost. This message happens to be critical for this two process scenario; \n2- The code to shut down a peer is not working well with the unit tests. For this particular unit test, we need to be able to shut down a peer completely to check the situation the test tries to reproduce. However, it seems that in some runs timing causes the other peers to believe it is still alive, and end up electing it. This peer, however, eventually shuts down and leader election fails.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50055f627d6b05869105" }, "external_id" : "ZOOKEEPER-361", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "integrate cppunit testing as part of hudson patch process.", "desc" : "we need to test the c tests as part of our hudson patch testing process.", "created_at" : { "$date" : "2009-04-02T21:30:15.519+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.567+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50065f627d6b05869119" }, "external_id" : "ZOOKEEPER-370", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix critical problems reported by findbugs", "desc" : "There are a couple of problems pointed out by findbugs and that we can easily fix.", "created_at" : { "$date" : "2009-04-07T21:26:40.851+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.764+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50075f627d6b0586912e" }, "external_id" : "ZOOKEEPER-363", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE when recovering ledger with no hint ", "desc" : "When recovering a ledger, LedgerRecoveryMonitor currently start from the entry preceding the hint. if the hint is zero, then it causes an access out of the bounds of the bookie array in QuorumEngine, leading to the mentioned NPE.\n", "created_at" : { "$date" : "2009-04-03T11:08:05.832+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.642+0000" }, "creator_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "reporter_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50085f627d6b05869145" }, "external_id" : "ZOOKEEPER-358", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Throw exception when ledger does not exist", "desc" : "Currently, openLedger() in the BookKeeper client returns null if the ledger ID does not exist on ZK. Maybe it would be better to throw a specific exception so it can be handled by the client side. ", "created_at" : { "$date" : "2009-04-01T11:42:17.320+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.416+0000" }, "creator_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "reporter_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50085f627d6b05869160" }, "external_id" : "ZOOKEEPER-360", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "WeakHashMap in Bookie.java causes NPE", "desc" : "We need a strong reference to prevent a key in masterKeys on Bookie.java to be garbage collected.", "created_at" : { "$date" : "2009-04-02T16:32:07.732+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.452+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50095f627d6b05869175" }, "external_id" : "ZOOKEEPER-375", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zoo_add_auth only retains most recent auth on re-sync", "desc" : "zoo_add_auth doesn't maintain a list of auths - it only stores the most recent auth send to the server. As a result on re-sync to the cluster it will lose (not reregister) any auths prior to the most recent.\n\nThis code should maintain a list of auths similar to the java code. Be sure to free the memory in close.\n\n", "created_at" : { "$date" : "2009-04-15T16:03:31.116+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.981+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d500a5f627d6b05869190" }, "external_id" : "ZOOKEEPER-374", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Uninitialized struct variable in C causes warning which is treated as an error", "desc" : "nitay-joffes-macbook-pro:c nitay$ pwd\n/Users/nitay/code/zookeeper/src/c\n\nnitay-joffes-macbook-pro:c nitay$ make\nmake  all-am\n/bin/sh ./libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O2 -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./include -I./tests -I./generated -Wall -Werror -g -O2 -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c  -fno-common -DPIC -o .libs/zookeeper.o\ncc1: warnings being treated as errors\nsrc/zookeeper.c: In function 'zoo_add_auth':\nsrc/zookeeper.c:2378: warning: 'auth.buff' may be used uninitialized in this function\nsrc/zookeeper.c:2378: warning: 'auth.len' may be used uninitialized in this function\nmake[1]: *** [zookeeper.lo] Error 1\nmake: *** [all] Error 2\n\n\nNeed to set auth.buff and auth.len to zero.", "created_at" : { "$date" : "2009-04-10T09:28:43.049+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.933+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "i686-apple-darwin9-gcc-4.0.1 (GCC) 4.0.1 (Apple Inc. build 5490)" },
{ "_id" : { "$oid" : "5b7d4fe65f627d6b05868e2f" }, "external_id" : "ZOOKEEPER-371", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "build" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe65f627d6b05868e30" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "created_at" : { "$date" : "2009-04-08T13:06:27.795+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.830+0000" }, "title" : "to implement jdiff ", "issue_type" : "Improvement", "environment" : "to implement jdiff ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4ff45f627d6b05868f63" }, "external_id" : "ZOOKEEPER-367", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "server" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4ff45f627d6b05868f64" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2009-04-04T00:29:32.882+0000" }, "priority" : "Critical", "desc" : "during local testing I received the attached recoverytest failure", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.716+0000" }, "title" : "RecoveryTest failure - \"unreasonable length\" IOException", "issue_type" : "Bug", "environment" : "ubuntu 8.10 intrpid ibex, jvm 1.6.0_10\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d500c5f627d6b058691e3" }, "external_id" : "ZOOKEEPER-365", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "javadoc is wrong for setLast in LedgerHandle", "desc" : "Note: the javadoc is wrong here:\n\n    /**\n     * Returns the last entry identifier submitted and increments it.\n     * @return long\n     */\n    long setLast(long last){\n\nalso would be great to have javadoc for the legerrecoverymonitor getNextHint method. I was reviewing this code and it would have been helpful to know what to expect of this method. (possible return values, etc...)", "created_at" : { "$date" : "2009-04-03T21:56:01.546+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.675+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fdb5f627d6b05868c83" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d500d5f627d6b058691f3" }, "external_id" : "ZOOKEEPER-356", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Masking bookie failure during writes to a ledger", "desc" : "The idea of this jira is to work out the changes necessary to make a client mask the failure of a bookie while writing to a ledger. I'm submitting a preliminary patch, but before I submit a final one, I need to have 288 committed.", "created_at" : { "$date" : "2009-03-27T12:18:30.698+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:02.258+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d500e5f627d6b05869218" }, "external_id" : "ZOOKEEPER-384", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "keeper exceptions missing path", "desc" : "keeper exceptions thrown by the java client don't include path, having path helps in debugging.\n", "created_at" : { "$date" : "2009-04-27T20:55:46.582+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.511+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d500f5f627d6b0586922a" }, "external_id" : "ZOOKEEPER-386", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve java cli shell", "desc" : "copied from the following comments by Vegard\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-364?focusedCommentId=12696002&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12696002\n------------------------------------------------------------\nPossible improvements:\n\nDefault host list to localhost:2181 when not given.\n\nDon't print a ton of debug, it looks like both cli_mt and zkCli.sh does this. Make a simple ls that lists subnodes one line at a time and a simple cat that lists only the node content, simple put etc.\n\nShell with gnu readline capabilities and tab completion on node names would be a big improvement of usability during testing and debugging. \n", "created_at" : { "$date" : "2009-04-27T22:43:27.100+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.591+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d500f5f627d6b05869229" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d500f5f627d6b05869255" }, "external_id" : "ZOOKEEPER-385", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "crctest failed on hudson patch test", "desc" : "http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/53/testReport/org.apache.zookeeper.server/CRCTest/testChecksums/\n\ncrctest failed with\n\nError Message\n\nUnreasonable length = 518291091\n\nStacktrace\n\njava.io.IOException: Unreasonable length = 518291091\n\tat org.apache.jute.BinaryInputArchive.readBuffer(BinaryInputArchive.java:101)\n\tat org.apache.zookeeper.server.DataNode.deserialize(DataNode.java:116)\n\tat org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:109)\n\tat org.apache.zookeeper.server.DataTree.deserialize(DataTree.java:954)\n\tat org.apache.zookeeper.server.util.SerializeUtils.deserializeSnapshot(SerializeUtils.java:91)\n\tat org.apache.zookeeper.server.persistence.FileSnap.deserialize(FileSnap.java:125)\n\tat org.apache.zookeeper.server.CRCTest.testChecksums(CRCTest.java:146)\n", "created_at" : { "$date" : "2009-04-27T22:38:07.438+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.558+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "server", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50105f627d6b05869260" }, "external_id" : "ZOOKEEPER-389", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add help/usage to the c shell cli.c", "desc" : "The current c shell should have help information (in the shell)\n\ncurrently it's hard to know what commands are available\n", "created_at" : { "$date" : "2009-05-01T20:47:56.484+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.633+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50115f627d6b0586926e" }, "external_id" : "ZOOKEEPER-376", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ant test target re-compiles cppunit code every time", "desc" : "Giri, can you take a look at this:\n\n1) looks like autoreconf is always run, which means that a re-configure/re-make is run each time the tests are run using ant\n\n2) tabs were introduced to the build when cppunit changes were made, please only use spaces (would be great if you could fix this too -- hard to read in my editor)\n\nThanks!\n", "created_at" : { "$date" : "2009-04-15T22:10:59.558+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.062+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client", "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50115f627d6b0586927d" }, "external_id" : "ZOOKEEPER-382", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper cpp tests fails on 64 bit machines with gcc 4.1.2", "desc" : "the zookeeper c tests fail on 64 bit machines with gcc 4.1.2 with the following error\n\n [exec] /workspace/zootestbuild/trunk/src/c/tests/TestClient.cc: In static member function 'static void Zookeeper_simpleSystem::statCompletion(int, const Stat*, const void*)':\n      [exec] /workspace/zootestbuild/trunk/src/c/tests/TestClient.cc:273: error: cast from 'const void*' to 'int' loses precision\n      [exec]/workspace/zootestbuild/trunk/src/c/tests/TestClient.cc: In static member function 'static void Zookeeper_simpleSystem::voidCompletion(int, const void*)':\n      [exec] /workspace/zootestbuild/trunk/src/c/tests/TestClient.cc:291: error: cast from 'const void*' to 'int' loses precision\n  ", "created_at" : { "$date" : "2009-04-27T18:30:04.537+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.412+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50125f627d6b05869289" }, "external_id" : "ZOOKEEPER-381", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The ZooKeeper front page tells us nothing about what ZooKeeper does", "desc" : "Currently, http://hadoop.apache.org/zookeeper does not contain a description of what ZK is.  The patch to follow copies the opening text from the Wiki and adds it to a section above the Getting Started section.\n\n", "created_at" : { "$date" : "2009-04-24T17:07:13.594+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.338+0000" }, "creator_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "reporter_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fdb5f627d6b05868c83" }, "external_id" : "ZOOKEEPER-380", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fdb5f627d6b05868c84" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d500c5f627d6b058691e3" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2009-04-23T21:12:02.282+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.278+0000" }, "title" : "bookkeeper should have a streaming api so that its easier to store checpoints/snapshots in bookkeeper.", "issue_type" : "Improvement", "desc" : "currently, bookkeeper api allows just a bytes interface which is \nld.write(bytes).\n\nWe should have an interface like \n\nStream s = ledger.createStream() (I am not very sure of the interface right now but will post a more concrete one after giving it a little more thought)\n\nnow this stream can be used to wirte checkpoints as \ns.write(bytes)\nand then closed to s.close() to close the snapshot. \nThis api could use the current api to implement snapshots as chunks of bytes (buffered by stream s) that can be written via ld.write(bytes).\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50145f627d6b058692b8" }, "external_id" : "ZOOKEEPER-379", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cppunit tests failed during hudson patch tests ", "desc" : "patch test build failed with \" equality assertion failed\"\nlink: http://hudson.zones.apache.org/hudson/view/ZooKeeper/job/Zookeeper-Patch-vesta.apache.org/44/console\n\nMahadev,\nCould you take a look?\nTnx!", "created_at" : { "$date" : "2009-04-21T06:30:02.226+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.245+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50145f627d6b058692c0" }, "external_id" : "ZOOKEEPER-378", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "contribution of Net::ZooKeeper Perl module", "desc" : "As per the conversation in ZOOKEEPER-364, I submitted a Software Grant Agreement to the ASF last week for Net::ZooKeeper by fax and surface mail; it might take a few more days for it to show up in the private grants.txt file, I believe.\n\nI also created a Net::ZooKeeper package, version 0.33, with licenses and a NOTICE file as required by the ASF for any ASF project.  It is attached to this issue and also available at http://people.apache.org/~chrisd/projects/net_zookeeper/.", "created_at" : { "$date" : "2009-04-20T17:36:04.510+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.190+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50155f627d6b058692f0" }, "external_id" : "ZOOKEEPER-377", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "running ant cppunit tests, a failure still results in BUILD SUCCESSFUL", "desc" : "Giri, can you take a look at this?\n\nI ran \"ant test\"\n\nlooks like this test failed:\n     [exec] Zookeeper_operations::testOperationsAndDisconnectConcurrently1 : assertion\n \nthen later...\n\n     [exec] \n     [exec] /home/phunt/dev/workspace/svnzk_apache/src/c/tests/TestOperations.cc:551: Assertion: equality assertion failed [Expected: -4, Actual  : 0, ZCONNECTIONLOSS != rc]\n     [exec] Failures !!!\n     [exec] Run: 38   Failure total: 1   Failures: 1   Errors: 0\n     [exec] make: *** [run-check] Error 1\n     [exec] Result: 2\n\ntest-core:\n\ntest-contrib:\n\nBUILD SUCCESSFUL\nTotal time: 15 minutes 39 seconds\n", "created_at" : { "$date" : "2009-04-17T18:14:36.925+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.140+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50165f627d6b058692fa" }, "external_id" : "ZOOKEEPER-402", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper c library segfaults on data for a node in zookeeper being null.", "desc" : "the zookeeper c client library seg faults on data being null for a zoo node. ", "created_at" : { "$date" : "2009-05-13T22:36:40.611+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.939+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50165f627d6b05869311" }, "external_id" : "ZOOKEEPER-396", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "race condition in zookeeper client library between zookeeper_close and zoo_synchronous api", "desc" : "There is a race condition in zoopkeeper client library wherein if the application calls zookeeper_close() and zoo_anysynchronouscall simultaneously, sometimes the zoo_sync api call gets hung waiting for a notification whcih will never come.\nWe might want to create another bugfix release for this.", "created_at" : { "$date" : "2009-05-09T00:41:05.720+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.871+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50175f627d6b0586931f" }, "external_id" : "ZOOKEEPER-392", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Change log4j properties", "desc" : "Change logging level to info in conf/log4j.properties.", "created_at" : { "$date" : "2009-05-06T21:37:33.031+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.723+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50185f627d6b05869329" }, "external_id" : "ZOOKEEPER-391", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bookeeper mainline code should not be calling printStackTrace", "desc" : "Bookeeper mainline code is calling printStackTrace, it should be using logging instead.", "created_at" : { "$date" : "2009-05-06T18:25:18.675+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:03.690+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50185f627d6b05869335" }, "external_id" : "ZOOKEEPER-419", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Reference counting bug in Python bindings causes abort errors", "desc" : "Due to reference counts being incremented incorrectly for stat-based calls, Python's GC occasionally aborts.", "created_at" : { "$date" : "2009-05-28T00:24:09.455+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.976+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50195f627d6b05869345" }, "external_id" : "ZOOKEEPER-416", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "BookKeeper jar includes unnecessary files", "desc" : "I was checking the bookkeper jar, and I found that it includes some unnecessary files related to junit, such as:\n\n{noformat}\n     0 Tue May 12 19:00:14 PDT 2009 tmp/\n     0 Tue May 12 19:00:00 PDT 2009 tmp/test14667.junit.dir/\n     0 Tue May 12 19:00:08 PDT 2009 tmp/test14667.junit.dir/version-2/\n     0 Tue May 12 19:00:10 PDT 2009 tmp/test16109.junit.dir/\n     0 Tue May 12 19:00:16 PDT 2009 tmp/test16109.junit.dir/version-2/\n     0 Tue May 12 19:00:14 PDT 2009 tmp/test16113.junit.dir/\n     0 Tue May 12 19:00:16 PDT 2009 tmp/test16113.junit.dir/version-2/\n  2256 Tue May 12 18:59:08 PDT 2009 logs/TEST-org.apache.bookkeeper.test.BookieClientTest.txt\n167046 Tue May 12 19:00:00 PDT 2009 logs/TEST-org.apache.bookkeeper.test.BookieReadWriteTest.txt\n 13035 Tue May 12 19:00:08 PDT 2009 logs/TEST-org.apache.bookkeeper.test.CloseTest.txt\n 25036 Tue May 12 19:00:16 PDT 2009 logs/TEST-org.apache.bookkeeper.test.LedgerRecoveryTest.txt\n   896 Tue May 12 19:00:16 PDT 2009 logs/TEST-org.apache.bookkeeper.test.NIOServerFactoryTest.txt\n{noformat}", "created_at" : { "$date" : "2009-05-26T15:51:26.920+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.896+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d501a5f627d6b05869354" }, "external_id" : "ZOOKEEPER-417", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stray message problem when changing servers", "desc" : "There is  a possibility for stray messages from a previous connection to violate ordering and generally cause problems. Here is a scenario: we have a client, C, two followers, F1 and F2, and a leader, L. The client is connected to F1, which is a slow follower. C sends setData(\"/a\", \"1\") to F1 and then loses the connection, so C reconnects to F2 and sends setData(\"/a\", \"2\").  it is possible, if F1 is slow enough and the setData(\"/a\", \"1\") got onto the network before the connection break, for F1 to forward the setData(\"/a\", \"1\") to L after F2 forwards setData(\"/a\", \"2\").\n\nto fix this, the leader should keep track of which follower last registered a session for a client and drop any requests from followers for clients for whom they do not have a registration. ", "created_at" : { "$date" : "2009-05-26T18:10:27.539+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.930+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d501b5f627d6b05869379" }, "external_id" : "ZOOKEEPER-415", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper c tests hang.", "desc" : "the c tests hang sometimes. ", "created_at" : { "$date" : "2009-05-21T20:29:44.150+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.856+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d501c5f627d6b05869385" }, "external_id" : "ZOOKEEPER-411", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Building zookeeper fails on RHEL 5 64 bit during test-cppunit", "desc" : "     [exec] Zookeeper_simpleSystem::testAsyncWatcherAutoReset : assertion\n     [exec] \n     [exec] /grid/0/gs/gridre/hudson/workspace/zootestbuild/trunk/src/c/tests/TestClient.cc:499: Assertion: assertion failed [Expression: ctx.waitForDisconnected(zk)]\n     [exec] Failures !!!\n     [exec] Run: 32   Failure total: 1   Failures: 1   Errors: 0\n     [exec] make: *** [run-check] Error 1\n", "created_at" : { "$date" : "2009-05-19T22:39:10.378+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.814+0000" }, "creator_id" : { "$oid" : "5b7d501ce9214a0d1608d892" }, "reporter_id" : { "$oid" : "5b7d501ce9214a0d1608d892" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "environment" : "RHEL5, 64bit " },
{ "_id" : { "$oid" : "5b7d501c5f627d6b05869399" }, "external_id" : "ZOOKEEPER-404", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "nightly build failed on hudson.", "desc" : "the nightly build failed with the following error\n\ncompile:\n     [echo] contrib: zkpython\n\nBUILD FAILED\n/home/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/build.xml:444: The following error occurred while executing this line:\n/home/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/src/contrib/build.xml:39: The following error occurred while executing this line:\n/home/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/src/contrib/build-contrib.xml:79: srcdir \"/home/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/src/contrib/zkpython/src/java\" does not exist!\n\nTotal time: 32 seconds\nPublishing Javadoc\nRecording test results\nRecording fingerprints\nPublishing Clover coverage report...\nSending e-mails to: zookeeper-dev@hadoop.apache.org\nfinished: FAILURE\n", "created_at" : { "$date" : "2009-05-18T16:50:10.007+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.499+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d501d5f627d6b058693a9" }, "external_id" : "ZOOKEEPER-410", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address all findbugs warnings in client/server classes", "desc" : "trunk/src/java/main/org/apache/zookeeper/ClientCnxn.java\ntrunk/src/java/main/org/apache/zookeeper/ZooKeeperMain.java\ntrunk/src/java/main/org/apache/zookeeper/server/SessionTrackerImpl.java\ntrunk/src/java/main/org/apache/zookeeper/server/SyncRequestProcessor.java\ntrunk/src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java\ntrunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java\ntrunk/src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java\n", "created_at" : { "$date" : "2009-05-18T18:16:00.012+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.783+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d501d5f627d6b058693a8" } },
{ "_id" : { "$oid" : "5b7d501e5f627d6b058693b7" }, "external_id" : "ZOOKEEPER-409", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address all findbugs warnings in jute related classes", "desc" : "trunk/src/java/main/org/apache/jute/XmlInputArchive.java\ntrunk/src/java/main/org/apache/jute/compiler/JFile.java\ntrunk/src/java/main/org/apache/jute/compiler/JRecord.java\ntrunk/src/java/main/org/apache/jute/compiler/CGenerator.java\ntrunk/src/java/main/org/apache/jute/compiler/CppGenerator.java\ntrunk/src/java/main/org/apache/jute/compiler/JavaGenerator.java\norg/apache/zookeeper/proto/AuthPacket.java\norg/apache/zookeeper/proto/ConnectRequest.java\norg/apache/zookeeper/proto/ConnectResponse.java\norg/apache/zookeeper/proto/CreateRequest.java\norg/apache/zookeeper/proto/GetChildrenResponse.java\norg/apache/zookeeper/proto/GetDataResponse.java\norg/apache/zookeeper/proto/SetDataRequest.java\norg/apache/zookeeper/proto/op_result_t.java\norg/apache/zookeeper/server/quorum/QuorumPacket.java\norg/apache/zookeeper/txn/CreateTxn.java\norg/apache/zookeeper/txn/SetDataTxn.java\n", "created_at" : { "$date" : "2009-05-18T18:15:14.869+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.746+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d501d5f627d6b058693a8" } },
{ "_id" : { "$oid" : "5b7d501f5f627d6b058693c5" }, "external_id" : "ZOOKEEPER-408", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address all findbugs warnings in persistence classes", "desc" : "trunk/src/java/main/org/apache/zookeeper/server/DataTree.java\ntrunk/src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java\ntrunk/src/java/main/org/apache/zookeeper/server/persistence/FileTxnLog.java\ntrunk/src/java/main/org/apache/zookeeper/server/persistence/Util.java\ntrunk/src/java/main/org/apache/zookeeper/server/DataNode.java\ntrunk/src/java/main/org/apache/zookeeper/server/upgrade/DataNodeV1.java\ntrunk/src/java/main/org/apache/zookeeper/server/upgrade/DataTreeV1.java", "created_at" : { "$date" : "2009-05-18T18:14:19.909+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.701+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d501d5f627d6b058693a8" } },
{ "_id" : { "$oid" : "5b7d50205f627d6b058693ec" }, "external_id" : "ZOOKEEPER-407", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address all findbugs warnings in org.apache.zookeeper.server.quorum.** packages", "desc" : "Flavio please address the findbugs warnings in quorum and sub packages. See\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/308/violations/\nfor a list of issues or use ant's findbugs (or eclipse) to identify the issues.\nIn general we should try to fix these, but ignoring the warning (annotation) is ok if it includes comments to effect why, also has\n to be reviewed/approved.\n", "created_at" : { "$date" : "2009-05-18T17:50:07.924+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.668+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d501d5f627d6b058693a8" } },
{ "_id" : { "$oid" : "5b7d501d5f627d6b058693a8" }, "external_id" : "ZOOKEEPER-406", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server", "java client" ], "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-05-18T17:47:44.788+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.632+0000" }, "title" : "address all findbugs warnings in mainline java code", "issue_type" : "Improvement", "desc" : "address; fix or mark invalid (ie ignore with comment to the effect why) all findbugs warnings in the mainline org.apache.zookeeper package and\nall subpackages. This is in src/java/main/org/apache/zookeeper/**\n\nsee for an example:\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/308/violations/\n\nyou can run findbugs in either eclipse or using the findbugs ant target\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50215f627d6b05869404" }, "external_id" : "ZOOKEEPER-405", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "nullpointer exception in zookeeper java shell.", "desc" : "The java client shell does not handle null return data and throws out null pointer exception.", "created_at" : { "$date" : "2009-05-18T17:24:02.263+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.541+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50225f627d6b05869415" }, "external_id" : "ZOOKEEPER-403", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup javac compiler warnings", "desc" : "Cleanup javac warnings, also turn on lint by default in ant build.xml for main org.apache.zookeeper classes.", "created_at" : { "$date" : "2009-05-14T18:33:18.235+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:04.448+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50225f627d6b05869428" }, "external_id" : "ZOOKEEPER-439", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50225f627d6b05869429" }, "external_id" : "ZOOKEEPER-428", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "logging should be makred as warn rathen than error in NIOServerCnxn.", "desc" : "Errors such as these should be marked as warn and not error.\n\n7:54,094 ERROR [NIOServerCxn.Factory:21810]\nserver.NIOServerCnxn(543): Client has seen zxid 0x10 our last zxid is 0x4\n\n", "created_at" : { "$date" : "2009-06-02T21:21:15.462+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.224+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50225f627d6b05869428" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50235f627d6b05869437" }, "external_id" : "ZOOKEEPER-422", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Java CLI should support ephemeral and sequential node creation", "desc" : "The C client supports creation of ephemeral and sequential nodes. For feature parity, so should the Java CLI. ", "created_at" : { "$date" : "2009-05-30T13:07:03.500+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.104+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50245f627d6b05869444" }, "external_id" : "ZOOKEEPER-421", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython run_tests.sh is missing #!", "desc" : "the scripts in the test directory of zkpython are missing #! headers\n\nProbably:\n\n#!/bin/sh\n\nfor shell scripts and \n\n#!/usr/bin/python\n\nfor .py scripts?\n\nAlso include a shell script that will svn chmod the *.py scripts so that they can be executed individually from the command line (shortcut\nrather than (python foo.py).\n", "created_at" : { "$date" : "2009-05-28T18:39:39.100+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.038+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50255f627d6b05869452" }, "external_id" : "ZOOKEEPER-446", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some traces of the host auth scheme left", "desc" : "the host auth scheme was removed because it used a blocking call in an async pipeline. however, tragically, the blocking call was not removed including a couple of other stray classes.", "created_at" : { "$date" : "2009-06-19T22:44:19.189+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.963+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50255f627d6b0586945c" }, "external_id" : "ZOOKEEPER-444", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "perms definition for PERMS_ALL differ in C and java", "desc" : "the perms_all definition in Java is PERMS.ALL and does not include ADMIN perms but in c the PERMS_ALL def includes the ADMIN perms. We should make it consistent to include or not include the admin perms in both c and java.", "created_at" : { "$date" : "2009-06-15T18:48:24.615+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.917+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50265f627d6b05869469" }, "external_id" : "ZOOKEEPER-443", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "trace logging in watch notification not wrapped with istraceneabled - inefficient", "desc" : "In org.apache.zookeeper.server.NIOServerCnxn.process(WatchedEvent) there's a trace message\nthat's not wrapped with isTraceEnabled, this is very inefficient and should be fixed.\n", "created_at" : { "$date" : "2009-06-12T20:24:20.796+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.882+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50275f627d6b05869479" }, "external_id" : "ZOOKEEPER-440", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update the performance documentation in forrest", "desc" : "Ben, it would be great if you could update the performance documentation in Forrest docs based on the 3.2 performance improvements.\nSpecifically the scalling graphs (reads vs write load for various quorum sizes)\n", "created_at" : { "$date" : "2009-06-09T01:22:44.166+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.839+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50275f627d6b0586948b" }, "external_id" : "ZOOKEEPER-438", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "addauth fails to register auth on new client that's not yet connected", "desc" : "if addauth is called on a new client connection that's never connected to the server, when the client does connect\n(syncconnected) the auth is not passed to the server. we should ensure we addauth when the client connects or reconnects", "created_at" : { "$date" : "2009-06-08T18:04:40.019+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.791+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50285f627d6b0586949f" }, "external_id" : "ZOOKEEPER-435", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "allow \"super\" admin digest based auth to be configurable", "desc" : "the server has a \"super\" digest based auth user that enables administrative access (ie has access to znodes regardless\nof acl settings) but the password is not configurable\n\n1) make the default digest null, ie turn off \"super\" by default\n2) if a command line option is specified when starting server then use the provided digest for super\n\neg. java -Dzookeeper.DigestAuthenticationProvider.superDigest=xkxkxkxkx ....\n\nalso this is not documented in the forrest docs - need to add that along with tests as part of the patch.\n", "created_at" : { "$date" : "2009-06-05T20:42:24.128+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.715+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50295f627d6b058694ae" }, "external_id" : "ZOOKEEPER-437", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Variety of Documentation Updates", "desc" : "Patch with a variety of documentation updates.  Some new content for getting started based on my experience trying it out, plus some typo fixes, etc.", "created_at" : { "$date" : "2009-06-06T03:54:00.823+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.757+0000" }, "creator_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "reporter_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d5012e9214a0d1608d891" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50295f627d6b058694c6" }, "external_id" : "ZOOKEEPER-434", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the java shell should indicate connection status on command prompt", "desc" : "it would be very useful if the java shell showed the current connection status as part of the command prompt.\n\nthis shows itself in particular for the following use case:\n\nI attempted to connect a java shell to a remote cluster that was unavailable, when I run the first command \"ls /\" on\nthe cluster the shell hangs. It would be nice if the shell indicated connection status in the prompt and make it more\nclear that the shell is currently not connected. (it was hard to see the \"attempting to connect\" console message as\nit was lost in with the other messaes...)\n", "created_at" : { "$date" : "2009-06-05T18:01:27.616+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.670+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502a5f627d6b058694d8" }, "external_id" : "ZOOKEEPER-433", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "getacl on root znode (/) fails", "desc" : "running a \"getAcl\" on the root znode \"/\" fails with the following:\n\nFri Jun  5 10:21:17 2009: 2009-06-05 10:21:17,072 - ERROR [CommitProcessor:3:FinalRequestProcessor@243] - Failed to process sessionid:0x321b16868f40003 ty\npe:getACL cxid:0x3 zxid:0xfffffffffffffffe txntype:unknown n/a \nFri Jun  5 10:21:17 2009: java.lang.NullPointerException\nFri Jun  5 10:21:17 2009:       at java.util.ArrayList.<init>(ArrayList.java:131)\nFri Jun  5 10:21:17 2009:       at org.apache.zookeeper.server.DataTree.getACL(DataTree.java:622)\nFri Jun  5 10:21:17 2009:       at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:216)\nFri Jun  5 10:21:17 2009:       at org.apache.zookeeper.server.quorum.CommitProcessor.run(CommitProcessor.java:74)\nFri Jun  5 10:21:17 2009: 2009-06-05 10:21:17,073 - ERROR [CommitProcessor:3:FinalRequestProcessor@250] - Dumping request buffer: 0x00012f\n\n\nWe need to support getting/setting the root acl in particular -- not being able to control acls on this node makes multi-tenancy a non-starter.\n", "created_at" : { "$date" : "2009-06-05T17:57:28.757+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.624+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502b5f627d6b058694f3" }, "external_id" : "ZOOKEEPER-432", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Various improvements to zkpython bindings", "desc" : "What's new, from the README for this new version:\n\n----------------------------------\nMore test coverage. \n\nBetter reference counting, fixing at least two serious bugs.\n\nOut-of-range zhandles are now checked, fixing a potential security hole.\n\nDocstrings! Editing and cleanup required, but most of the text is there.\n\nzookeeper.set_watcher is now implemented correctly.\n\nzookeeper.client_id is now implemented correctly. zookeeper.init now respects the client_id parameter.\n\nget_context and set_context have been removed from the API. The context mechanism is used by PyZK to store the callables that are dispatched by C-side watchers. Messing with this from Python-side causes bugs very quickly. You should wrap all desired context up in a callable and then use zookeeper.set_watcher to attach it to the global watcher. \n\nMany methods now have optional parameters (usually if you can specify a watch, it's optional). The only time where genuinely optional parameters are still mandatory is when a required parameters comes after it. Currently we still respect the ZK C client parameter ordering. For example, you can simply connect with zookeeper.init(\"host:port\") and ignore the other three parameters.", "created_at" : { "$date" : "2009-06-05T12:09:20.498+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.309+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502b5f627d6b05869507" }, "external_id" : "ZOOKEEPER-431", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Expose methods to ease ZK integration", "desc" : "HBase committer here. I opened this jira to see if it's possible to include some changes in the way quorum servers are started in order to ease the integration with HBase. Basically the major things we would change is how methods are exposed in QPM/QPC and such.", "created_at" : { "$date" : "2009-06-03T20:05:17.760+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:05.269+0000" }, "creator_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "reporter_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d502b5f627d6b05869506" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d502c5f627d6b0586951b" }, "external_id" : "ZOOKEEPER-455", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper c client crashes with chroot specified in the string.", "desc" : "the zookeeper c client crashes with chroot specified in the string. This does not fail on 2.6 but on ubuntu where the malloced memory is nto initialized to \\0.\n", "created_at" : { "$date" : "2009-06-30T23:44:02.115+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.304+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502d5f627d6b0586952a" }, "external_id" : "ZOOKEEPER-454", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "allow compilation with jdk1.5", "desc" : "we no longer officially support jdk1.5 however it still compiles -- except for a recent @override that was added for an interface method. jdk1.6\nallows this but jdk1.5 does not (must be superclass). small patch will address this. 3.3 we will drop 1.5 concerns entirely but for now...", "created_at" : { "$date" : "2009-06-30T20:53:41.678+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.262+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502d5f627d6b05869532" }, "external_id" : "ZOOKEEPER-453", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Worker is not removed in QuorumCnxManager upon crash", "desc" : "This causes a problem when we crash and restart a replica R because other replicas believe that they still have a connection to R after restart.", "created_at" : { "$date" : "2009-06-30T16:25:34.810+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.218+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d502e5f627d6b0586954a" }, "external_id" : "ZOOKEEPER-452", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper performance graph should have percentage of reads rather than percentage of writes -  zkperfRW-3.2.jpg", "desc" : "THe image is wrong and should have percentage of reads on the x axis.. ", "created_at" : { "$date" : "2009-06-30T01:17:21.687+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.171+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50305f627d6b05869553" }, "external_id" : "ZOOKEEPER-450", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "emphemeral cleanup not happening with session timeout", "desc" : "The session move patch broke ephemeral cleanup during session expiration. tragically, we didn't have test coverage to detect the bug.", "created_at" : { "$date" : "2009-06-29T15:29:01.098+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.111+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50305f627d6b05869562" }, "external_id" : "ZOOKEEPER-448", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "png files do nto work with forrest.", "desc" : "png images are not compatible with forrest generating pdf. We can them to jpg to get them into pdfs.", "created_at" : { "$date" : "2009-06-26T18:39:41.212+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.028+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50315f627d6b0586956e" }, "external_id" : "ZOOKEEPER-449", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "sesssionmoved in java code and ZCLOSING in C have the same value.", "desc" : "sesssionmoved in java code and ZCLOSING in C have the same value. We need to assign a new value to ZSESSIONMOVED.", "created_at" : { "$date" : "2009-06-26T20:36:25.024+0000" }, "updated_at" : { "$date" : "2009-07-08T20:24:06.073+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50325f627d6b05869578" }, "external_id" : "ZOOKEEPER-316", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "configure option --without-cppunit does not work", "desc" : "configure option --without-cppunit does not work.", "created_at" : { "$date" : "2009-02-17T19:02:08.253+0000" }, "updated_at" : { "$date" : "2009-07-14T18:14:05.177+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.1.0" ], "components" : [ "c client", "tests" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50325f627d6b05869584" }, "external_id" : "ZOOKEEPER-478", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "support custom hostnames for client and quorum connections", "desc" : "Our system administrators would love it if we could configure ZooKeeper to listen for client and quorum connections on a hostname which isn't bound to the localhost.\n\nMaybe there's some neat way to do this I'm not aware of already, of course, but it looks to me like we would need to change the two ss.socket().bind(new InetSocketAddress(port)); calls, one in NIOServerCnxn and one in QuorumCnxManager to so that they instead used InetSocketAddress(host, port).  Obviously that implies some optional definition of a hostname in the config file as well and possibly on the command-line.\n\nDoes that seem like the right approach?", "created_at" : { "$date" : "2009-07-17T19:36:38.923+0000" }, "updated_at" : { "$date" : "2009-07-17T19:36:38.923+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.2.0" ], "components" : [ "quorum", "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50335f627d6b05869585" }, "external_id" : "ZOOKEEPER-238", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "HostAuthenicationProvider should be removed", "desc" : "I think the way the HostAuthenticationProvider is implemented could cause serious performance problems if DNS is slow or broken. The problem is that we need to do a reverse hostname resolution during connection establishment. I suggest it be removed.", "created_at" : { "$date" : "2008-11-24T21:31:13.606+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:18.824+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.2.1" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50345f627d6b0586958e" }, "external_id" : "ZOOKEEPER-311", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "handle small path lengths in zoo_create()", "desc" : "The synchronous completion for zoo_create() contains the following code:\\\\\n\n{noformat}\nif (sc->u.str.str_len > strlen(res.path)) {\n    len = strlen(res.path);\n} else {\n    len = sc->u.str.str_len-1;\n}\nif (len > 0) {\n    memcpy(sc->u.str.str, res.path, len);\n    sc->u.str.str[len] = '\\0';\n}\n{noformat}\n\nIn the case where the max_realpath_len argument to zoo_create() is 0, none of this code executes, which is OK.  In the case where max_realpath_len is 1, a user might expect their buffer to be filled with a null terminator, but again, nothing will happen (even if strlen(res.path) is 0, which is unlikely since new node's will have paths longer than \"/\").\n\nThe name of the argument to zoo_create() is also a little misleading, as is its description (\"the maximum length of real path you would want\") in zookeeper.h, and the example usage in the Programmer's Guide:\n\n{noformat}\nint rc = zoo_create(zh,\"/xyz\",\"value\", 5, &CREATE_ONLY, ZOO_EPHEMERAL, buffer, sizeof(buffer)-1);\n{noformat}\n\nIn fact this value should be the actual length of the buffer, including space for the null terminator.  If the user supplies a max_realpath_len of 10 and a buffer of 11 bytes, and strlen(res.path) is 10, the code will truncate the returned value to 9 bytes and put the null terminator in the second-last byte, leaving the final byte of the buffer unused.\n\nIt would be better, I think, to rename the realpath and max_realpath_len arguments to something like path_buffer and path_buffer_len, akin to zoo_set().  The path_buffer_len would be treated as the full length of the buffer (as the code does now, in fact, but the docs suggest otherwise).\n\nThe code in the synchronous completion could then be changed as per the attached patch.\n\nSince this would change, slightly, the behaviour or \"contract\" of the API, I would be inclined to suggest waiting until 4.0.0 to implement this change.", "created_at" : { "$date" : "2009-02-12T20:03:36.324+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.014+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.1", "3.2.0", "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50345f627d6b058695b7" }, "external_id" : "ZOOKEEPER-460", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bad testRetry in cppunit tests (hudson failure)", "desc" : "the followng code failed on hudson\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/371/\n\n      watchctx_t ctx1, ctx2;\n      zhandle_t *zk1 = createClient(&ctx1);\n      CPPUNIT_ASSERT_EQUAL(true, ctx1.waitForConnected(zk1));\n      zhandle_t *zk2 = createClient(&ctx2);\n      zookeeper_close(zk1);\n      CPPUNIT_ASSERT_EQUAL(true, ctx2.waitForConnected(zk2));\n\nthere's a problem with this test, it assumes that close(1) can be called before createclient(2) gets connected.\n\nthis is not correct: createclient is an async call an in some cases the connection can be established before\ncreate client returns.\n\nthis shows a failure in this case because client1 was created, then client2 attempted to connect\nbut failed due to this on the server (max conn exceeded):\n        sprintf(cmd, \"export ZKMAXCNXNS=1;%s startClean %s\", ZKSERVER_CMD, getHostPorts());\n\nconn 2 failed and therefore the following assert eventually failed.\n\nthis code should not assume that close(1) will beat connect(2)\n\n\nHenry can you take a look?\n\n", "created_at" : { "$date" : "2009-07-09T16:39:28.078+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.327+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50345f627d6b058695b6" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50355f627d6b058695ca" }, "external_id" : "ZOOKEEPER-477", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCleanup.sh is flaky", "desc" : "the zkCleanup.sh script is buggy in two ways:\n\n1) it doesn't actually pass through the snapshot count, so it doesn't work\n2) it assumes that there is only dataDir, it doesn't support dataLogDir\n\nAnd it can use cleanup, so that it doesn't blindly call eval from the config file..\n", "created_at" : { "$date" : "2009-07-17T19:05:17.098+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.876+0000" }, "creator_id" : { "$oid" : "5b7d5035e9214a0d1608d894" }, "reporter_id" : { "$oid" : "5b7d5035e9214a0d1608d894" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5035e9214a0d1608d894" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50365f627d6b058695db" }, "external_id" : "ZOOKEEPER-470", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "include unistd.h for sleep() in c tests", "desc" : "Include unistd.h for sleep() calls in C tests to ensure successful compilation on some platforms.", "created_at" : { "$date" : "2009-07-14T18:25:45.671+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.706+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50365f627d6b058695e7" }, "external_id" : "ZOOKEEPER-469", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "make sure CPPUNIT_CFLAGS isn't overwritten", "desc" : "When compiling with --with-cppunit-prefix, CPPUNIT_CFLAGS is set by the AM_PATH_CPPUNIT macro.  In configure.ac, it is then reset in order to set the -DZKSERVER_CMD command line argument.  Instead, that argument should be added to CPPUNIT_CFLAGS so that things like a custom -I include location set by AM_PATH_CPPUNIT are not lost.  Otherwise, a custom cppunit installation is not properly supported, despite the --with-cppunit-prefix option.", "created_at" : { "$date" : "2009-07-14T18:10:28.889+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.630+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50375f627d6b058695f4" }, "external_id" : "ZOOKEEPER-468", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "avoid compile warning in send_auth_info()", "desc" : "Older compilers may complain that rc may be used without initialization in send_auth_info(), if -Wall is specified.  The fix is a simple initialization.", "created_at" : { "$date" : "2009-07-14T17:44:34.179+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.564+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50385f627d6b05869606" }, "external_id" : "ZOOKEEPER-467", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Change log level in BookieHandle", "desc" : "I have accidentally left a log.warn in BookieHandle. This is a pretty simple patch, so I would appreciate if we could review it quickly.", "created_at" : { "$date" : "2009-07-14T07:47:19.200+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.491+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50395f627d6b05869614" }, "external_id" : "ZOOKEEPER-457", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make ZookeeperMain public, support for HBase (and other) embedded clients", "desc" : "hi folks, we have made some changes to zookeeper to facilitate providing an embedded zk client in our own hbase client.  This will allow our users to use 1 shell to manipulate both hbase things and zookeeper things.  It requires making a few things public, and in the process rearranging how some static things are initialized.  \n\nIt's fairly trivial refactoring, hopefully you guys approve!\n\nThanks!", "created_at" : { "$date" : "2009-07-01T18:58:04.938+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.256+0000" }, "creator_id" : { "$oid" : "5b7d5039e9214a0d1608d895" }, "reporter_id" : { "$oid" : "5b7d5039e9214a0d1608d895" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5039e9214a0d1608d895" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50395f627d6b05869625" }, "external_id" : "ZOOKEEPER-447", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh doesn't allow different config files to be specified on the command line", "desc" : "Unless I'm missing something, you can change the directory that the zoo.cfg file is in by setting ZOOCFGDIR but not the name of the file itself.\n\nI find it convenient myself to specify the config file on the command line, but we should also let it be specified by environment variable.\n", "created_at" : { "$date" : "2009-06-25T10:38:03.619+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:19.122+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d503a5f627d6b05869638" }, "external_id" : "ZOOKEEPER-509", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Truncating of logs does not work right at the followers.", "desc" : "The truncating of logs does not work right because we use BufferedInputStream and the truncation happens at the buffered read which is greater than the actual truncate position.", "created_at" : { "$date" : "2009-08-19T17:41:14.865+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.856+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869636" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869637" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d503a5f627d6b05869636" }, "external_id" : "ZOOKEEPER-508", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum" ], "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869638" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869637" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2009-08-17T18:39:08.372+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.814+0000" }, "title" : "proposals and commits for DIFF and Truncate messages from the leader to followers is buggy.", "issue_type" : "Bug", "desc" : "The proposals and commits sent by the leader after it asks the followers to truncate there logs or starts sending a diff has missing messages which causes out of order commits messages and causes the followers to shutdown because of these out of order commits.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d503c5f627d6b05869669" }, "external_id" : "ZOOKEEPER-501", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "CnxManagerTest failed on hudson", "desc" : "It timed out according to the console output:\n\nhttp://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/406/testReport/org.apache.zookeeper.test/CnxManagerTest/testCnxManager/", "created_at" : { "$date" : "2009-08-06T22:11:42.250+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.729+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d503d5f627d6b0586967b" }, "external_id" : "ZOOKEEPER-499", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "electionAlg should default to FLE (3) - regression", "desc" : "there's a regression in 3.2 - electionAlg is no longer defaulting to 3 (incorrectly defaults to 0)\n\nalso - need to have tests to validate this", "created_at" : { "$date" : "2009-08-05T20:32:20.565+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.663+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "server", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d503e5f627d6b05869690" }, "external_id" : "ZOOKEEPER-498", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Unending Leader Elections : WAN configuration", "desc" : "In a WAN configuration, ZooKeeper is endlessly electing, terminating, and re-electing a ZooKeeper leader. The WAN configuration involves two groups, a central DC group of ZK servers that have a voting weight = 1, and a group of servers in remote pods with a voting weight of 0.\n\nWhat we expect to see is leaders elected only in the DC, and the pods to contain only followers. What we are seeing is a continuous cycling of leaders. We have seen this consistently with 3.2.0, 3.2.0 + recommended patches (473, 479, 481, 491), and now release 3.2.1.", "created_at" : { "$date" : "2009-08-04T21:18:51.605+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.601+0000" }, "creator_id" : { "$oid" : "5b7d503ee9214a0d1608d896" }, "reporter_id" : { "$oid" : "5b7d503ee9214a0d1608d896" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "environment" : "Each machine:\n\nCentOS 5.2 64-bit\n2GB ram\njava version \"1.6.0_13\"\nJava(TM) SE Runtime Environment (build 1.6.0_13-b03)\nJava HotSpot(TM) 64-Bit Server VM (build 11.3-b02, mixed \n\nNetwork Topology:\nDC : central data center\nPOD(N): remote data center\n\nZookeeper Topology:\nLeaders may be elected only in DC (weight = 1)\nOnly followers are elected in PODS (weight = 0)" },
{ "_id" : { "$oid" : "5b7d503f5f627d6b058696c2" }, "external_id" : "ZOOKEEPER-493", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "patch for command line setquota ", "desc" : "the command line \"setquota\" tries to use argument 3 as both a path and a value\n", "created_at" : { "$date" : "2009-08-01T09:40:58.787+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.521+0000" }, "creator_id" : { "$oid" : "5b7d503fe9214a0d1608d897" }, "reporter_id" : { "$oid" : "5b7d503fe9214a0d1608d897" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d503fe9214a0d1608d897" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50405f627d6b058696d0" }, "external_id" : "ZOOKEEPER-490", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the java docs for session creation are misleading/incomplete", "desc" : "the javadoc for ZooKeeper constructor says:\n\n     * The client object will pick an arbitrary server and try to connect to it.\n     * If failed, it will try the next one in the list, until a connection is\n     * established, or all the servers have been tried.\n\nthe \"or all server tried\" phrase is misleading, it should indicate that we retry until success, con closed, or session expired. \n\nwe also need ot mention that connection is async, that constructor returns immed and you need to look for connection event in watcher", "created_at" : { "$date" : "2009-07-29T18:27:29.243+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.441+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50405f627d6b058696dd" }, "external_id" : "ZOOKEEPER-487", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "setdata on root (/) crashes the servers.", "desc" : "setdata on root \"/\" crashes the servers with the followimg exception. Unfortunately we never had a setdata test on root. The following is the exception. This happens with 3.1.1 as well. We might want to consider releasing 3.1.2 just for this jira.\n\n{code}\njava.lang.IllegalArgumentException: Invalid path /\n        at org.apache.zookeeper.common.PathTrie.findMaxPrefix(PathTrie.java:255)\n        at org.apache.zookeeper.server.DataTree.setData(DataTree.java:543)\n        at org.apache.zookeeper.server.DataTree.processTxn(DataTree.java:701)\n        at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:94)\n        at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:127)\n        at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:75)\n{code}\n", "created_at" : { "$date" : "2009-07-24T20:38:00.747+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.359+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d503a5f627d6b05869637" }, "external_id" : "ZOOKEEPER-483", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.1" ], "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869638" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869636" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50415f627d6b058696e9" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-07-23T20:40:49.653+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5039e9214a0d1608d895" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5039e9214a0d1608d895" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.202+0000" }, "title" : "ZK fataled on me, and ugly", "issue_type" : "Bug", "desc" : "here are the part of the log whereby my zookeeper instance crashed, taking 3 out of 5 down, and thus ruining the quorum for all clients:\n\n2009-07-23 12:29:06,769 WARN org.apache.zookeeper.server.NIOServerCnxn: Exception causing close of session 0x52276d1d5161350 due to java.io.IOException: Read error\n2009-07-23 12:29:00,756 WARN org.apache.zookeeper.server.quorum.Follower: Exception when following the leader\njava.io.EOFException\n        at java.io.DataInputStream.readInt(DataInputStream.java:375)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:65)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n        at org.apache.zookeeper.server.quorum.Follower.readPacket(Follower.java:114)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:243)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:494)\n2009-07-23 12:29:06,770 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5161350 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.168:39489]\n2009-07-23 12:29:06,770 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb0578 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46797]\n2009-07-23 12:29:06,771 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa013e NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.153:33998]\n2009-07-23 12:29:06,771 WARN org.apache.zookeeper.server.NIOServerCnxn: Exception causing close of session 0x52276d1d5160593 due to java.io.IOException: Read error\n2009-07-23 12:29:06,808 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e02bb NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.158:53758]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa13e4 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.154:58681]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691382 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59967]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb1354 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.163:49957]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa13cd NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.150:34212]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691383 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46813]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb0350 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59956]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e139b NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.156:55138]\n2009-07-23 12:29:06,809 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e1398 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.167:41257]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5161355 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.153:34032]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d516011c NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56314]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e056b NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56322]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d516011f NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.157:49618]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e11ea NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.10.20.42:55483]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e02ba NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.157:49632]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb1355 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.169:58824]\n2009-07-23 12:29:06,810 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691378 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.161:40973]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691380 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59944]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e0311 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.160:56167]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e690374 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.169:58815]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e139f NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.151:51396]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e139c NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56315]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137b NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59859]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5160594 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.151:51370]\n2009-07-23 12:29:06,811 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137a NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46682]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5160347 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.165:35722]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137f NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46754]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5160121 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56307]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb0126 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.154:58688]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa05fc NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.152:45067]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e0316 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.169:58800]\n2009-07-23 12:29:06,812 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137e NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46737]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137d NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.159:46733]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa13df NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.156:55137]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb134e NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.166:40443]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691381 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.161:41086]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5161356 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.165:35719]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb1349 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.\n20.20.158:53770]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x12276d15dfb0352 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.165:35718]\n2009-07-23 12:29:06,813 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691379 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59823]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d516000e NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.150:34216]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x32276d15d2e1397 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.169:58829]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e69137c NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59862]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa0140 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56271]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x42276d1d3fa13e1 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.157:49608]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x22276d15e691377 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.162:59789]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x52276d1d5160593 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.165:35703]\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.FinalRequestProcessor: shutdown of request processor complete\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!\n2009-07-23 12:29:06,814 INFO org.apache.zookeeper.server.quorum.CommitProcessor: CommitProcessor exited loop!\n2009-07-23 12:29:06,815 INFO org.apache.zookeeper.server.quorum.Follower: shutdown called\njava.lang.Exception: shutdown Follower\n        at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:427)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-07-23 12:29:06,815 WARN org.apache.zookeeper.server.NIOServerCnxn: Ignoring exception\njava.nio.channels.CancelledKeyException\n        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n        at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:69)\n        at org.apache.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:201)\n2009-07-23 12:29:06,815 INFO org.apache.zookeeper.server.quorum.QuorumPeer: LOOKING\n2009-07-23 12:29:06,817 WARN org.apache.zookeeper.server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2009-07-23 12:29:06,817 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x0 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.156:55206]\n2009-07-23 12:29:06,818 WARN org.apache.zookeeper.server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2009-07-23 12:29:06,818 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x0 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.155:56331]\n[elided lots of the same]\n2009-07-23 12:29:33,008 INFO org.apache.zookeeper.server.NIOServerCnxn: closing session:0x0 NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/10.20.20.151:2181 remote=/10.20.20.152:5945\n8]\n2009-07-23 12:29:33,011 FATAL org.apache.zookeeper.server.SyncRequestProcessor: Severe unrecoverable error, exiting\njava.net.SocketException: Socket closed\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n        at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:100)\n        at org.apache.zookeeper.server.quorum.SendAckRequestProcessor.flush(SendAckRequestProcessor.java:52)\n        at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:131)\n        at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:76)\n\nThe good news is when I restarted the downed zookeepers, everything returned to normal.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50425f627d6b05869729" }, "external_id" : "ZOOKEEPER-484", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Clients get SESSION MOVED exception when switching from follower to a leader.", "desc" : "When a client is connected to follower and get disconnected and connects to a leader it gets SESSION MOVED excpetion. This is beacuse of a bug in the new feature of ZOOKEEPER-417 that we added in 3.2. All the releases before 3.2 DO NOT have this problem. The fix is to make sure the ownership of a connection gets changed when a session moves from follower to the leader. The workaround to it in 3.2.0 would be to swithc off connection from clients to the leader. take a look at *leaderServers* java property in http://hadoop.apache.org/zookeeper/docs/r3.2.0/zookeeperAdmin.html.", "created_at" : { "$date" : "2009-07-23T21:09:54.340+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.326+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50435f627d6b0586973f" }, "external_id" : "ZOOKEEPER-482", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ignore sigpipe in testRetry to avoid silent immediate failure", "desc" : "The testRetry test silently exits for me periodically, especially, it seems, on newer hardware.  It also spits out from log messages clutter the test output.\n\nThe silent exits turn out to be because SIGPIPE is sometimes delivered during the sleep(1) in createClient(), the second time createClient() is called.  Since SIGPIPE is not being ignored and there is no signal handler, the process exists immediately.  This leaves the test suite in a broken state, with the test ZooKeeper process still running because \"zkServer.sh stop\" is not run by tearDown().  You have to manually kill the ZK server and retry the tests; sometimes they succeed and sometimes they don't.\n\nI described SIGPIPE handling a little in ZOOKEEPER-320.  The appropriate thing, I think, is for the client application to ignore or handle SIGPIPE.  In this case, that falls to the test processes.  The attached patch fixes the issue for me with testRetry.\n\nThe patch uses sigaction() to ignore SIGPIPE in TestClientRetry.cc and, for good measure (although I never saw it actually fail for me), TestClient.cc, since that file also uses sleep() extensively.\n\nI also removed a couple of unused functions and a macro definition from TestClientRetry.cc, just to simply matters, and turned off log output, which makes the testRetry output much, much cleaner (otherwise you get a lot of log output spamming into the nice clean cppunit output :-).", "created_at" : { "$date" : "2009-07-22T22:44:53.929+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:20.090+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50435f627d6b0586974f" }, "external_id" : "ZOOKEEPER-514", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test failure on trunk in testCnxManager - NPE", "desc" : "http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/424/testReport/org.apache.zookeeper.test/CnxManagerTest/testCnxManager/\n\nFlavio can you take a look?\n", "created_at" : { "$date" : "2009-08-24T17:44:28.577+0000" }, "updated_at" : { "$date" : "2009-09-05T22:36:24.128+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50455f627d6b05869757" }, "external_id" : "ZOOKEEPER-308", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve the atomic broadcast performance 3x", "desc" : "We need a benchmark for zab, the atomic broadcast protocol of zookeeper. we can also do some small tweaks to make zab go much faster.", "created_at" : { "$date" : "2009-02-10T06:43:59.211+0000" }, "updated_at" : { "$date" : "2009-09-12T21:00:40.071+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50455f627d6b0586976f" }, "external_id" : "ZOOKEEPER-399", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "system tests conversion", "created_at" : { "$date" : "2009-05-09T22:58:39.056+0000" }, "updated_at" : { "$date" : "2009-09-22T23:36:47.452+0000" }, "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50455f627d6b0586976e" } },
{ "_id" : { "$oid" : "5b7d50465f627d6b05869773" }, "external_id" : "ZOOKEEPER-398", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "contrib tests convertion", "desc" : "In this phase conversion of src/contrib/**/test will happen", "created_at" : { "$date" : "2009-05-09T22:57:52.544+0000" }, "updated_at" : { "$date" : "2009-09-22T23:36:47.407+0000" }, "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50455f627d6b0586976e" } },
{ "_id" : { "$oid" : "5b7d4f875f627d6b058686da" }, "external_id" : "ZOOKEEPER-127", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "quorum" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f875f627d6b058686db" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d50475f627d6b05869778" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2008-08-27T13:18:34.883+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d5047e9214a0d1608d898" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5047e9214a0d1608d898" }, "updated_at" : { "$date" : "2009-11-12T15:23:30.842+0000" }, "title" : "Use of non-standard election ports in config breaks services", "issue_type" : "Bug", "desc" : "In QuorumCnxManager.toSend there is a call to create a connection as follows:\n    channel = SocketChannel.open(new InetSocketAddress(addr, port));\n\nUnfortunately \"addr\" is the ip address of a remote server while \"port\" is the electionPort of *this* server.\nAs an example, given this configuration (taken from my zoo.cfg)\n  server.1=10.20.9.254:2881\n  server.2=10.20.9.9:2882\n  server.3=10.20.9.254:2883\nServer 3 was observed trying to make a connection to host 10.20.9.9 on port 2883 and obviously failing.\n\nIn tests where all machines use the same electionPort this bug would not manifest itself.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50485f627d6b058697b6" }, "external_id" : "ZOOKEEPER-581", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "peerType in configuration file is redundant", "desc" : "to configure a machine to be an observer you must add a peerType=observer to the configuration file and an observer tag to the server list. this is redundant. if the observer tag is on the entry of a machine it should know it is an observer without needing the peerType tag.\n\non the other hand, do we really need the observers in the server list? they don't vote.", "created_at" : { "$date" : "2009-11-17T16:23:27.349+0000" }, "updated_at" : { "$date" : "2009-11-17T16:24:57.962+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50485f627d6b058697b5" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50485f627d6b058697b8" }, "external_id" : "ZOOKEEPER-99", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "All MXBeans interfaces that don't use complex paramters need to be renamed as MBean interaces. ", "desc" : "All the MXBean interfaces that I've looked at are standard MBean interfaces.  The interface names should get renamed to MBean instaead of MXBean. That way the server can also run on a the Java 1.5 Platform.", "created_at" : { "$date" : "2008-07-25T16:55:14.933+0000" }, "updated_at" : { "$date" : "2009-11-23T12:10:22.435+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "jmx" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50495f627d6b058697c2" }, "external_id" : "ZOOKEEPER-594", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Adding documentation to zkpython to help out with the setup for finding libzookeeper_mt.so.2", "desc" : "When setting up and using the zkpython binding, sometimes you encounter the problem that python cannot find the file \"libzookeeper_mt.so.2\". This can be fixed in most cases by for example adding the line \"export LD_LIBRARY_PATH=/usr/local/lib/\" to your .bashrc file. I some cases though, when for example running your python script from within a fcgi context and a lighttpd server it still isn't able to find the file.\n", "created_at" : { "$date" : "2009-11-24T17:25:38.088+0000" }, "updated_at" : { "$date" : "2009-11-24T23:27:29.393+0000" }, "creator_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "reporter_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "issue_links" : [  ], "environment" : "Have been tested on Fedora 9" },
{ "_id" : { "$oid" : "5b7d504a5f627d6b058697c9" }, "external_id" : "ZOOKEEPER-625", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "configure/change build scripts to generate cppunit reports", "created_at" : { "$date" : "2009-12-15T16:00:02.011+0000" }, "updated_at" : { "$date" : "2009-12-15T16:00:02.011+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504a5f627d6b058697cb" }, "external_id" : "ZOOKEEPER-618", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson not reporting failures correctly", "desc" : "See\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/612/\nthis test failed however there is no indication in the hudson page why it failed.\n\nLooking at the raw console output I see\n\n    [junit] Running org.apache.zookeeper.test.QuorumTest\n    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec\n    [junit] Test org.apache.zookeeper.test.QuorumTest FAILED (timeout)\n\nSo it seems there is an error in hudson reporting.\n\nGiri can you look into this?\n", "created_at" : { "$date" : "2009-12-10T21:29:07.075+0000" }, "updated_at" : { "$date" : "2009-12-15T16:06:28.534+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504a5f627d6b058697ca" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d504b5f627d6b058697d3" }, "external_id" : "ZOOKEEPER-634", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some elements of struct Stat have incorrect values when returned asynchronously", "desc" : "I'm working on Ruby bindings for ZK (3.2.2) via the C API.  This involves some painful kludgery due to MRI Ruby's threading model, but I believe this bug report is valid:\n\nSome of the elements of Stat structs, when returned via the C client, have values inconsistent with the synchronous call, zkCli output, and expectations.  E.g.:\n\n{noformat:title=zkCli command line}\n$ zk/bin/zkCli.sh -server localhost:2182 set /lala lala234\nConnecting to localhost:2182\n\nWATCHER::\n\nWatchedEvent: Server state change. New state: SyncConnected\ncZxid = 3\nctime = Sat Dec 19 14:32:03 EST 2009\nmZxid = 69\nmtime = Sat Dec 19 15:31:46 EST 2009\npZxid = 3\ncversion = 0\ndataVersion = 4\naclVersion = 0\nephemeralOwner = 0\ndataLength = 7\nnumChildren = 0\n\n{noformat}\n\n{noformat:title=Ruby script + verbose ZK log output}\n2009-12-19 15:31:48,952:45753(0x751000):ZOO_DEBUG@process_completions@1902: Switching on cptr->completion_type (async)\n2009-12-19 15:31:48,952:45753(0x751000):ZOO_DEBUG@process_completions@1916: Calling COMPLETION_STAT for xid=4b2d3837 rc=0\n2009-12-19 15:31:48,952:45753(0x751000):ZOO_DEBUG@process_completions@1949: --- PRE ruby callback.\n   -----------------------\n   &res.stat    0x00750e30\n        .czxid        3\n        .mzxid        69\n        .ctime        1261251123149\n        .mtime        1261254706180\n        .version      4\n        .cversion     0\n        .aversion     0\n        .ephemeralOwner 0\n        .dataLength   7\n        .numChildren  0\n        .pzxid        3\n   =======================\n2009-12-19 15:31:48,952:45753(0x751000):ZOO_DEBUG@ruby_stat_completion_wrapper@1702: --- creating ruby thread.\n2009-12-19 15:31:48,952:45753(0x7ee000):ZOO_DEBUG@ruby_stat_completion_wrapper_2@1685: --- invoking ruby callback.\n   -----------------------\n   cb->dc         0x002fe000\n   cb->rc         0\n   cb->ctx        0x01a03870\n   cb->stat       0x00750e30\n     ->czxid        3\n     ->mzxid        69\n     ->ctime        1261251123149\n     ->mtime        140735387442616\n     ->version      0\n     ->cversion     0\n     ->aversion     27264392\n     ->ephemeralOwner 4302638816\n     ->dataLength   -2100901903\n     ->numChildren  32767\n     ->pzxid        3\n   =======================\n2009-12-19 15:31:48,952:45753(0x7ee000):ZOO_DEBUG@ruby_stat_completion_wrapper_2@1687: --- callback returned, freeing struct.\n2009-12-19 15:31:48,952:45753(0x7ee000):ZOO_DEBUG@ruby_stat_completion_wrapper_2@1689: --- struct freed.\nsync returned #<ZooKeeperFFI::Stat:0x000001013783d0>\nasync callback.return_code 0\n           attr  ??                   sync                  async\n           ----  --                   ----                  -----\n          czxid  OK                      3                      3\n          mzxid  OK                     69                     69\n          ctime  OK          1261251123149          1261251123149\n          mtime  --          1261254706180        140735387442616\n        version  --                      4                      0\n       cversion  OK                      0                      0\n       aversion  --                      0               27264392\n ephemeralOwner  --                      0             4302638816\n     dataLength  --                      7            -2100901903\n    numChildren  --                      0                  32767\n          pzxid  OK                      3                      3\n2009-12-19 15:31:49,052:45753(0x6ce000):ZOO_DEBUG@do_io@316: IO thread terminated\n2009-12-19 15:31:49,052:45753(0x751000):ZOO_DEBUG@do_completion@335: completion thread terminated\n2009-12-19 15:31:49,052:45753(0x705f3be0):ZOO_INFO@zookeeper_close@2407: Closing zookeeper session 125a86bdc640020 to [127.0.0.1:2182]\n{noformat}\n\nThe last set of lines, above, are output from my Ruby code, comparing the differences between sync and async calls.  I added the LOG_DEBUG in zookeeper.c to dump the contents of res.stat before it gets shipped off to Ruby...as you can see, the LOG_DEBUG values match the values in the async Ruby call, but they're wrong.\n\nI've currently only tested on OSX 10.5 (32bit) and 10.6 (64bit), but sometimes different elements are wrong on each.  I can get a comprehensive list if it's useful, but as examples:\n\n{noformat:title=data variation examples}\n## aexists\n# ctime (int64_t):\n#  32b OK\n#  64b OK\n# dataLength (int32_t):\n#  32b OK\n#  64b NG (== -2100901903 instead of 10)\n\n## aget\n# ctime (int64_t):\n#  32b OK\n#  64b NG (== 0 instead of something unixtimey e.g. 1261251123149)\n# dataLength (int32_t):\n#  32b NG (== -1856148083 instead of 10)\n#  64b OK\n\n## aset\n# ctime (int64_t):\n#  32b OK\n#  64b OK\n# dataLength (int32_t):\n#  32b OK\n#  64b NG (== -2100901903 instead of 10)\n\n{noformat}\n\n\nLastly, a snippet of my changes to zookeeper.c, hopefully showing that I haven't done any harm to the data.  Note that I'm also seeing similar data variations for COMPLETION_DATA, which also returns a Stat struct.  I haven't finished the Ruby code for COMPLETION_ACLLIST (again, returns a Stat), so the same issue might arise there as well.\n\nI realize that hacking the ZK C API is not a great way to build a foreign binding.  :(\n\n{code:title=src/c/src/zookeeper.c}\n\n            case COMPLETION_STAT:\n                LOG_DEBUG((\"Calling COMPLETION_STAT for xid=%x rc=%d\",cptr->xid,rc));\n                if (rc) {\n                    //cptr->c.stat_result(rc, 0, cptr->data);\n                    ruby_stat_completion_wrapper(cptr->c.stat_result, rc, 0, (void *)cptr->data);\n                } else {\n                    struct SetDataResponse res;\n                    deserialize_SetDataResponse(ia, \"reply\", &res);\n  LOG_DEBUG((\"--- PRE ruby callback.\\n\\\n   -----------------------\\n\\\n   &res.stat    0x%08x\\n\\\n        .czxid        %ld\\n\\\n        .mzxid        %ld\\n\\\n        .ctime        %ld\\n\\\n        .mtime        %ld\\n\\\n        .version      %d\\n\\\n        .cversion     %d\\n\\\n        .aversion     %d\\n\\\n        .ephemeralOwner %ld\\n\\\n        .dataLength   %d\\n\\\n        .numChildren  %d\\n\\\n        .pzxid        %ld\\n\\\n   =======================\",\n    &res.stat,\n    res.stat.czxid, res.stat.mzxid, res.stat.ctime, res.stat.mtime,\n    res.stat.version, res.stat.cversion, res.stat.aversion,\n    res.stat.ephemeralOwner, res.stat.dataLength, res.stat.numChildren,\n    res.stat.pzxid ));\n                    //cptr->c.stat_result(rc, &res.stat, cptr->data);\n                    ruby_stat_completion_wrapper(cptr->c.stat_result, rc, &res.stat, (void *)cptr->data);\n                    deallocate_SetDataResponse(&res);\n                }\n                break;\n\n{code}\n\n\n", "created_at" : { "$date" : "2009-12-19T22:13:17.462+0000" }, "updated_at" : { "$date" : "2010-01-05T20:48:06.104+0000" }, "creator_id" : { "$oid" : "5b7d504be9214a0d1608d89b" }, "reporter_id" : { "$oid" : "5b7d504be9214a0d1608d89b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "OSX 10.5, 10.6 (32b and 64b, respectively)" },
{ "_id" : { "$oid" : "5b7d504c5f627d6b058697d9" }, "external_id" : "ZOOKEEPER-643", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "please add support for windows os", "desc" : "add zkServer.bat for windows beside zkServer.sh and other shell ", "created_at" : { "$date" : "2010-01-14T09:18:54.047+0000" }, "updated_at" : { "$date" : "2010-01-14T17:59:53.327+0000" }, "creator_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "reporter_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504c5f627d6b058697de" }, "external_id" : "ZOOKEEPER-520", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add static/readonly client resident serverless zookeeper", "desc" : "Occasionally people (typically ops) has asked for the ability to start a ZK client with a hardcoded, local, non cluster based session. Meaning that you can bring up a particular client with a hardcoded/readonly view of the ZK namespace even if the zk cluster is not available. This seems useful for a few reasons:\n\n1) unforseen problems - a client might be brought up and partial application service restored even in the face of catastrophic cluster failure\n\n2) testing - client could be brought up with a hardcoded configuration for testing purposes. we might even be able to extend this idea over time to allow \"simulated changes\" ie - simulate other clients making changes in the namespace, perhaps simulate changes in the state of the cluster (testing state change is often hard for users of the client interface)\n\nSeems like this shouldn't be too hard for us to add. The session could be established with a URI for a local/remote file rather than a URI of the cluster servers. The client would essentially read this file which would be a simple representation of the znode namespace.\n\n/foo/bar \"abc\"\n/foo/bar2 \"def\"\netc...\n\nIn the pure client readonly case this is simple. We might also want to allow writes to the namespace (essentially back this with an in memory hash) for things like group membership (so that the client continues to function).\n\nObv this wouldn't work in some cases, but it might work in many and would allow further options for users wrt building a relable/recoverable service on top of ZK.\n", "created_at" : { "$date" : "2009-09-04T00:06:07.760+0000" }, "updated_at" : { "$date" : "2010-01-15T22:21:35.780+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504d5f627d6b058697e1" }, "external_id" : "ZOOKEEPER-654", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Tests should not rely on CONSOLE appender being present", "desc" : "Tests have been failing for us in an environment where we removed the CONSOLE appender from log4j. This breaks a couple of tests in QuorumPeerMainTest at least.\n\nI have fixed in our builds by replacing CONSOLE with ROLLINGFILE (which we are using) for the time being, but messing with the log config shouldn't break tests. ", "created_at" : { "$date" : "2010-01-22T23:03:30.085+0000" }, "updated_at" : { "$date" : "2010-01-23T00:17:32.416+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.2.1" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504d5f627d6b058697e9" }, "external_id" : "ZOOKEEPER-270", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove NoSyncConnected in KeeperState - it's not used anywhere in the codebase. ", "desc" : "ZOOKEEPER-265 makes some constants deprecated. We should remove the deprecated stuff int the next release.", "created_at" : { "$date" : "2009-01-08T21:10:20.068+0000" }, "updated_at" : { "$date" : "2010-01-25T23:56:54.807+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504d5f627d6b058697e8" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d504e5f627d6b058697f4" }, "external_id" : "ZOOKEEPER-676", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "50%-75% connection loss exceptions using zkpython", "desc" : "I get about 50-75% connection loss exceptions and about 10% Bus Error when using the contrib/zkpython zookeeper.so.  Below is the exception:\n\n2010-02-21 16:57:56,138:18481(0xb0081000):ZOO_ERROR@handle_socket_error_msg@1359: Socket [fe80::1002:885:7f00:1:2181] zk retcode=-4, errno=47(Address family not supported by protocol family): connect() call failed\nTraceback (most recent call last):\n  File \"./zksh.py\", line 63, in <module>\n2010-02-21 16:57:56,138:18481(0xb0081000):ZOO_INFO@check_events@1439: initiated connection to server [127.0.0.1:2181]\n    zkcli.dispatch(cmd,*args)\n  File \"./zksh.py\", line 56, in dispatch\n    returned = run(*args)\n  File \"./zksh.py\", line 48, in ls\n    print \"\\n\".join(self.cmd.listNode(node))\n  File \"/Users/josh/git/zktools/commands.py\", line 22, in listNode\n    for path in zookeeper.get_children(self.zk, node):\nzookeeper.ConnectionLossException: connection loss\n\nI've run this in gdb and have this backtrace:\n\n#0  free_pywatcher (pw=0x0) at src/c/zookeeper.c:199\n#1  0x0025ae09 in pyzoo_exists (self=0x0, args=0x0) at src/c/zookeeper.c:765\n#2  0x0018f51e in PyEval_EvalFrameEx ()\n#3  0x00191173 in PyEval_EvalCodeEx ()\n#4  0x0013b488 in PyFunction_SetClosure ()\n#5  0x00121505 in PyObject_Call ()\n#6  0x0018fcd0 in PyEval_EvalFrameEx ()\n#7  0x00191173 in PyEval_EvalCodeEx ()\n#8  0x0013b488 in PyFunction_SetClosure ()\n#9  0x00121505 in PyObject_Call ()\n#10 0x0018fcd0 in PyEval_EvalFrameEx ()\n#11 0x00191173 in PyEval_EvalCodeEx ()\n#12 0x0018f79d in PyEval_EvalFrameEx ()\n#13 0x00191173 in PyEval_EvalCodeEx ()\n#14 0x00191260 in PyEval_EvalCode ()\n#15 0x001a883c in PyErr_Display ()\n#16 0x001aa4ab in PyRun_InteractiveOneFlags ()\n#17 0x001aa5f9 in PyRun_InteractiveLoopFlags ()\n#18 0x001aaa2b in PyRun_AnyFileExFlags ()\n#19 0x001b5a57 in Py_Main ()\n#20 0x00001fca in ?? ()\n\nzookeeper.c @ line 199:\n\n void free_pywatcher( pywatcher_t *pw)\n{\n  Py_DECREF(pw->callback);\n  free(pw);\n}\n\nThat's as far as I've dug so far -- I ended up just writing a retry decorator to get around it for now.  On the same machine, the zkCli.sh test client works flawlessly.  Also, here's the Mac OS X Bus Error trace:\n\nProcess:         Python [18556]\nPath:            /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/Python.app/Contents/MacOS/Python\nIdentifier:      Python\nVersion:         ??? (???)\nCode Type:       X86 (Native)\nParent Process:  bash [18436]\n\nInterval Since Last Report:          3323078 sec\nCrashes Since Last Report:           50\nPer-App Interval Since Last Report:  0 sec\nPer-App Crashes Since Last Report:   38\n\nDate/Time:       2010-02-21 17:07:27.399 -0800\nOS Version:      Mac OS X 10.5.8 (9L31a)\nReport Version:  6\nAnonymous UUID:  FA533BDA-50B2-47A9-931C-6F2614C741F0\n\nException Type:  EXC_BAD_ACCESS (SIGBUS)\nException Codes: KERN_PROTECTION_FAILURE at 0x0000000000000004\nCrashed Thread:  0\n\nThread 0 Crashed:\n0   zookeeper.so                  \t0x002332bd free_pywatcher + 10 (zookeeper.c:199)\n1   zookeeper.so                  \t0x00239e09 pyzoo_exists + 984 (zookeeper.c:765)\n2   org.python.python             \t0x0018f51e PyEval_EvalFrameEx + 17116\n3   org.python.python             \t0x0018f700 PyEval_EvalFrameEx + 17598\n4   org.python.python             \t0x00191173 PyEval_EvalCodeEx + 1638\n5   org.python.python             \t0x0013b488 PyFunction_SetClosure + 2667\n6   org.python.python             \t0x00121505 PyObject_Call + 50\n7   org.python.python             \t0x0018fcd0 PyEval_EvalFrameEx + 19086\n8   org.python.python             \t0x00191173 PyEval_EvalCodeEx + 1638\n9   org.python.python             \t0x0013b488 PyFunction_SetClosure + 2667\n10  org.python.python             \t0x00121505 PyObject_Call + 50\n11  org.python.python             \t0x0018fcd0 PyEval_EvalFrameEx + 19086\n12  org.python.python             \t0x00191173 PyEval_EvalCodeEx + 1638\n13  org.python.python             \t0x00191260 PyEval_EvalCode + 87\n14  org.python.python             \t0x001a883c PyErr_Display + 1896\n15  org.python.python             \t0x001a8e66 PyRun_FileExFlags + 135\n16  org.python.python             \t0x001aa7d2 PyRun_SimpleFileExFlags + 421\n17  org.python.python             \t0x001b5a57 Py_Main + 3095\n18  org.python.pythonapp          \t0x00001fca 0x1000 + 4042\n\nThread 1:\n0   libSystem.B.dylib             \t0x9265fe0e poll$UNIX2003 + 10\n1   libSystem.B.dylib             \t0x9262a155 _pthread_start + 321\n2   libSystem.B.dylib             \t0x9262a012 thread_start + 34\n\nThread 2:\n0   libSystem.B.dylib             \t0x9260046e __semwait_signal + 10\n1   libSystem.B.dylib             \t0x9262adcd pthread_cond_wait$UNIX2003 + 73\n2   libzookeeper_mt.2.dylib       \t0x00247e9f do_completion + 223\n3   libSystem.B.dylib             \t0x9262a155 _pthread_start + 321\n4   libSystem.B.dylib             \t0x9262a012 thread_start + 34\n\nThread 0 crashed with X86 Thread State (32-bit):\n  eax: 0x00000000  ebx: 0x00239a3c  ecx: 0x00000000  edx: 0x00000000\n  edi: 0x001efaa0  esi: 0x00000000  ebp: 0xbfffe508  esp: 0xbfffe4f0\n   ss: 0x0000001f  efl: 0x00010286  eip: 0x002332bd   cs: 0x00000017\n   ds: 0x0000001f   es: 0x0000001f   fs: 0x00000000   gs: 0x00000037\n  cr2: 0x00000004\n\nBinary Images:\n    0x1000 -     0x1ffe  org.python.pythonapp 2.5.0 (2.5.0a0) <5aa9f0cc36fda395f965e08c96613cf5> /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/Python.app/Contents/MacOS/Python\n  0x119000 -   0x1e5feb  org.python.python 2.5 (2.5) <523ba54c654eeed6bc670db2f58a73ab> /System/Library/Frameworks/Python.framework/Versions/2.5/Python\n  0x232000 -   0x23ffff +zookeeper.so ??? (???) <77134e53d6dbc7bbcf783b0fc2b16d6e> /Library/Python/2.5/site-packages/zookeeper.so\n  0x246000 -   0x255fef +libzookeeper_mt.2.dylib ??? (???) <839ce6d5a904236d0f0112e75656ecfd> /usr/local/lib/libzookeeper_mt.2.dylib\n0x8fe00000 - 0x8fe2db43  dyld 97.1 (???) <458eed38a009e5658a79579e7bc26603> /usr/lib/dyld\n0x925f8000 - 0x9275fff3  libSystem.B.dylib ??? (???) <ae47ca9b1686b065f8ac4d2de09cc432> /usr/lib/libSystem.B.dylib\n0x96aea000 - 0x96af1fe9  libgcc_s.1.dylib ??? (???) <e280ddf3f5fb3049e674edcb109f389a> /usr/lib/libgcc_s.1.dylib\n0x96fc9000 - 0x96fcdfff  libmathCommon.A.dylib ??? (???) /usr/lib/system/libmathCommon.A.dylib\n0xffff0000 - 0xffff1780  libSystem.B.dylib ??? (???) /usr/lib/libSystem.B.dylib\n\n", "created_at" : { "$date" : "2010-02-22T01:03:15.980+0000" }, "updated_at" : { "$date" : "2010-02-22T18:47:28.081+0000" }, "creator_id" : { "$oid" : "5b7d504ee9214a0d1608d89d" }, "reporter_id" : { "$oid" : "5b7d504ee9214a0d1608d89d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.2.2" ], "components" : [ "contrib-bindings", "contrib" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504e5f627d6b058697f3" }, "effect" : "is blocked by", "type" : "Blocker" } ], "environment" : "Mac OS X 10.5.8,   MacBook Air Intel Core 2 Duo @ 1.86GHz, Python 2.5.1, ZooKeeper 3.2.2 Standalone" },
{ "_id" : { "$oid" : "5b7d504f5f627d6b05869803" }, "external_id" : "ZOOKEEPER-695", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Need to remove the lookForLeader duplicated code in LENonTerminateTest", "desc" : "To do the LENonTerminateTest we need to hook into the lookForLeader code. In the last release we did this by duplicating the code. This needs to be cleaned up.", "created_at" : { "$date" : "2010-03-10T01:25:28.545+0000" }, "updated_at" : { "$date" : "2010-03-10T18:55:32.109+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504f5f627d6b05869802" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d504f5f627d6b05869808" }, "external_id" : "ZOOKEEPER-302", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Quote values in JMX ObjectNames ", "desc" : "Some characters are not allowed in ObjectName values and need quoting, see http://java.sun.com/javase/6/docs/api/javax/management/ObjectName.html.\n\nThis came up with IPv6 addresses which contain a colon character.", "created_at" : { "$date" : "2009-02-06T12:40:17.588+0000" }, "updated_at" : { "$date" : "2010-03-23T16:45:01.245+0000" }, "creator_id" : { "$oid" : "5b7d4fe1e9214a0d1608d88d" }, "reporter_id" : { "$oid" : "5b7d4fe1e9214a0d1608d88d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50505f627d6b0586981f" }, "external_id" : "ZOOKEEPER-726", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Performance and stress tests", "desc" : "We'd greatly benefit from long-running performance and stress tests that ran, say, nightly.\n\nOne thing I've done in the past is automatically run a set of classes with profiling enabled and periodically captured telemetry. Would be great to run something like this regularly as well, if the Hudson infrastructure were capable of doing so. ", "created_at" : { "$date" : "2010-03-25T06:05:24.235+0000" }, "updated_at" : { "$date" : "2010-03-25T06:05:24.235+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "testing" ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50505f627d6b0586981e" } },
{ "_id" : { "$oid" : "5b7d50515f627d6b05869820" }, "external_id" : "ZOOKEEPER-714", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50515f627d6b05869821" }, "external_id" : "ZOOKEEPER-715", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50515f627d6b05869822" }, "external_id" : "ZOOKEEPER-713", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper fails to start - broken snapshot?", "desc" : "Hi guys,\n\nThe following is not a bug report but rather a question - but as I am attaching large files I am posting it here rather than on mailinglist.\n\nToday we had major failure in our production environment. Machines in zookeeper cluster gone wild and all clients got disconnected.\nWe tried to restart whole zookeeper cluster but cluster got stuck in leader election phase.\n\nCalling stat command on any machine in the cluster resulted in 'ZooKeeperServer not running' message\nIn one of logs I noticed 'Invalid snapshot'  message which disturbed me a bit.\n\nWe did not manage to make cluster work again with data. We deleted all version-2 directories on all nodes and then cluster started up without problems.\nIs it possible that snapshot/log data got corrupted in a way which made cluster unable to start?\nFortunately we could rebuild data we store in zookeeper as we use it only for locks and most of nodes is ephemeral.\n\nI am attaching contents of version-2 directory from all nodes and server logs.\nSource problem occurred some time before 15. First cluster restart happened at 15:03.\nAt some point later we experimented with deleting version-2 directory so I would not look at following restart because they can be misleading due to our actions.\n\nI am also attaching zoo.cfg. Maybe something is wrong at this place. \nAs I know look into logs i see read timeout during initialization phase after 20secs (initLimit=10, tickTime=2000).\nMaybe all I have to do is increase one or other. which one? Are there any downsides of increasing tickTime.\n\nBest regards, ukasz Osipiuk\n\nPS. due to attachment size limit I used split. to untar use \ncat nodeX-version-2.tgz-* |tar -xz\n", "created_at" : { "$date" : "2010-03-18T15:53:19.576+0000" }, "updated_at" : { "$date" : "2010-03-26T17:20:46.795+0000" }, "creator_id" : { "$oid" : "5b7d5051e9214a0d1608d89e" }, "reporter_id" : { "$oid" : "5b7d5051e9214a0d1608d89e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50515f627d6b05869821" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50515f627d6b05869820" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "debian lenny; ia64; xen virtualization" },
{ "_id" : { "$oid" : "5b7d50525f627d6b05869844" }, "external_id" : "ZOOKEEPER-59", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Synchronized block in NIOServerCnxn", "desc" : "There are two synchronized blocks locking on different objects, and to me they should be guarded by the same object. Here are the parts of the code I'm talking about:\n\n{noformat}\nNIOServerCnxn.readRequest@444\n...\n          synchronized (this) {\n                outstandingRequests++;\n                // check throttling\n                if (zk.getInProcess() > factory.outstandingLimit) {\n                    disableRecv();\n                    // following lines should not be needed since we are already\n                    // reading\n                    // } else {\n                    // enableRecv();\n                }\n            } \n{noformat}\n\n{noformat}\nNIOServerCnxn.sendResponse@740\n...\n         synchronized (this.factory) {\n                outstandingRequests--;\n                // check throttling\n                if (zk.getInProcess() < factory.outstandingLimit\n                        || outstandingRequests < 1) {\n                    sk.selector().wakeup();\n                    enableRecv();\n                }\n            }\n{noformat}\n\nI think the second one is correct, and the first synchronized block should be guarded by \"this.factory\". \n\nThis could be related to issue ZOOKEEPER-57, but I have no concrete indication that this is the case so far.", "created_at" : { "$date" : "2008-06-30T11:20:15.005+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:53.875+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50535f627d6b0586988b" }, "external_id" : "ZOOKEEPER-152", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improve unit tests for leader election", "desc" : "There are two possible tasks here:\n\n1- Change the algorithm tested on QuorumTest.java;\n2- Add tests for the other supported algorithms.", "created_at" : { "$date" : "2008-10-01T20:29:26.593+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.348+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50535f627d6b0586988a" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50535f627d6b05869899" }, "external_id" : "ZOOKEEPER-158", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader and followers increase cpu utilization upon loss of a follower", "desc" : "In a set of ZooKeeper servers, when there is a leader operation and supported by a quorum of servers, we have observed that cpu utilization increases substantially once a follower fails or disconnects. Stu Hood provided logs showing this behavior.", "created_at" : { "$date" : "2008-10-05T11:17:11.649+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.402+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50545f627d6b058698aa" }, "external_id" : "ZOOKEEPER-420", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "build/test should not require install in zkpython", "desc" : "Currently you cannot just build and test the zkpython contrib, you need to actually install the zookeeper client c library as well\nas the zkpython lib itself.\n\nThere really needs to be 2 steps:\n\n1) build/test zkpython \"encapsulated\" within the src repository, there should be no requirement to actually install anything\n(this is esp the case for automated processes and for review by PMC during release time for example)\n2) build an egg that can be distributed/installed by end user\n", "created_at" : { "$date" : "2009-05-28T18:36:00.203+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.946+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50555f627d6b058698c7" }, "external_id" : "ZOOKEEPER-413", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "two flaws need addressing in the c tests that can cause false positive failures", "desc" : "1) createClient in testclient.cc (check all tests) is not correctly waiting for syncconnected to the server\n2) there are some instances of while(xxx); in the test code, this could cause problems, really we need to\nhave some limit on the number of iterations (other than just the test, which may never return false), also the\nloop should have some sort of sleep(100msec) (whatever time) in order to limit cpu use.\n", "created_at" : { "$date" : "2009-05-20T21:59:15.378+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.882+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50565f627d6b058698d8" }, "external_id" : "ZOOKEEPER-397", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "mainline tests conversion", "desc" : "In this stage main set (src/java/test) of ZK tests will be converted to TestNG", "created_at" : { "$date" : "2009-05-09T22:57:11.811+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.837+0000" }, "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50455f627d6b0586976e" } },
{ "_id" : { "$oid" : "5b7d50455f627d6b0586976e" }, "external_id" : "ZOOKEEPER-394", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.1" ], "components" : [ "tests" ], "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "created_at" : { "$date" : "2009-05-08T18:33:12.067+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "resolution" : "Invalid", "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.774+0000" }, "title" : "Converting JUnit tests into TestNG controlled environment", "issue_type" : "Test", "desc" : "TestNG is a powerful test harness, which provides a lot of useful features like parallel test execution, test parametrization, and such.\nZooKeeper uses JUnit (v.4.4) environment instead which certainly should help to ease the conversion\n\nI'd suggest to convert ZooKeeper's Junit based test infrastructure into TestNG controller environment, which will allow to achieve higher level of test execution control in the long run. \n\nThe same conversion has been already performed for Avro project (see https://issues.apache.org/jira/browse/AVRO-26)", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50575f627d6b05869908" }, "external_id" : "ZOOKEEPER-287", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "high cpu utilization caused by nioserver factory thread", "desc" : "a user reported that a long running server, part of a 2 server ensemble, started using 100%cpu (1 server of the ensemble, the other was fine).\n\nmahadev tracked it down to a thread in the server running epoll in a tight loop - the thread was the nio server factory thread that selects on client fds.\n", "created_at" : { "$date" : "2009-02-03T05:26:24.285+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.562+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.0.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50575f627d6b05869907" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Linux 2.6.9-67.ELsmp #1 SMP Wed Nov 7 13:58:04 EST 2007 i686 i686 i386 GNU/Linux\nthe servers were running in vmware vms\njava version \"1.6.0_06\"\nJava(TM) SE Runtime Environment (build 1.6.0_06-b02)\nJava HotSpot(TM) Client VM (build 10.0-b22, mixed mode)\n\n" },
{ "_id" : { "$oid" : "5b7d50585f627d6b05869913" }, "external_id" : "ZOOKEEPER-283", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add more javadocs to BookKeeper", "desc" : "Add more javadoc descriptors to BookKeeper code.", "created_at" : { "$date" : "2009-01-30T19:27:57.491+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.528+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.3.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f5f5f627d6b058682f3" }, "external_id" : "ZOOKEEPER-86", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "tests" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f5f5f627d6b058682f4" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4f5e5f627d6b058682e1" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "created_at" : { "$date" : "2008-07-23T16:59:46.555+0000" }, "priority" : "Major", "desc" : "Will attach the test output in an attachment...", "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.191+0000" }, "title" : "intermittent test failure of org.apache.zookeeper.test.AsyncTest", "issue_type" : "Bug", "environment" : "OS X and linux. It sometimes passes; but mostly seems to fail on OS X each time", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "external_id" : "ZOOKEEPER-107", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50485f627d6b058697b5" }, "external_id" : "ZOOKEEPER-368", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50485f627d6b058697b6" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2009-04-06T20:58:06.131+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2010-03-26T17:24:54.615+0000" }, "title" : "Observers: core functionality ", "issue_type" : "New Feature", "desc" : "Edit (Henry Robinson/henryr) 12/11/09:\n\nThis JIRA specifically concerns the implementation of non-voting peers called Observers, their documentation and their tests. \n\nExplicit goals are 1. not breaking any current ZK functionality, 2. enabling at least one deployment scenario involving Observers, 3. documentation describing how to use the feature and 4. tests validating the correct behaviour of 2. \n\nNon goals of this JIRA are 1. performance optimizations specific to Observers, 2. compatibility with every feature of ZooKeeper (in particular all leader election protocols), which are both to be addressed in future JIRAs. \n\nSee http://wiki.apache.org/hadoop/ZooKeeper/Observers for more detail of use cases, proposed design and usage.\n\nSee http://wiki.apache.org/hadoop/ZooKeeper/Observers/ReviewGuide for a brief commentary on the current patch. \n\n-------------\n\nCurrently, all servers of an ensemble participate actively in reaching agreement on the order of ZooKeeper transactions. That is, all followers receive proposals, acknowledge them, and receive commit messages from the leader. A leader issues commit messages once it receives acknowledgments from a quorum of followers. For cross-colo operation, it would be useful to have a third role: observer. Using Paxos terminology, observers are similar to learners. An observer does not participate actively in the agreement step of the atomic broadcast protocol. Instead, it only commits proposals that have been accepted by some quorum of followers.\n\nOne simple solution to implement observers is to have the leader forwarding commit messages not only to followers but also to observers, and have observers applying transactions according to the order followers agreed upon. In the current implementation of the protocol, however, commit messages do not carry their corresponding transaction payload because all servers different from the leader are followers and followers receive such a payload first through a proposal message. Just forwarding commit messages as they currently are to an observer consequently is not sufficient. We have a couple of options:\n\n1- Include the transaction payload along in commit messages to observers;\n2- Send proposals to observers as well.\n\nNumber 2 is simpler to implement because it doesn't require changing the protocol implementation, but it increases traffic slightly. The performance impact due to such an increase might be insignificant, though.\n\nFor scalability purposes, we may consider having followers also forwarding commit messages to observers. With this option, observers can connect to followers, and receive messages from followers. This choice is important to avoid increasing the load on the leader with the number of observers. \n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d505b5f627d6b058699b2" }, "external_id" : "ZOOKEEPER-472", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Making DataNode not instantiate a HashMap when the node is ephmeral", "desc" : "Looking at the code, there is an overhead of a HashSet object for that nodes children, even though the node might be an ephmeral node and cannot have children.", "created_at" : { "$date" : "2009-07-14T23:44:38.593+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.505+0000" }, "creator_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "reporter_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5049e9214a0d1608d89a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d505c5f627d6b058699f0" }, "external_id" : "ZOOKEEPER-476", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "upgrade junit library from 4.4 to 4.6", "desc" : "upgrade from junit 4.4 to 4.6", "created_at" : { "$date" : "2009-07-16T22:57:32.026+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.709+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50345f627d6b058695b6" }, "external_id" : "ZOOKEEPER-473", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "tests" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50345f627d6b058695b7" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-07-15T16:46:15.979+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.671+0000" }, "title" : "cleanup junit tests to eliminate false positives due to \"socket reuse\" and failure to close client", "issue_type" : "Improvement", "desc" : "The junit tests will occasionally fail on hudson due to a few problems:\n\n1) socket in use - sometimes the code/testcode will fail to close a socket, either that or tcp wait\n kicks in and the kernel holds onto the socket, either way subsequent tests that use this same\nport will fail\n\n2) sometimes the tests fail to close clients, this results in clients attempting to re-connect to\nthe server started as part of a subsequent test (the timeout is very long). this causes a few\nproblems, typically extra load on the server or more likely unusual changes to the server that the\nnext test(s) don't expect. also causes problems when trying to debug the test as the old clients\nspew messages into the log.\n\nwe see this on hudson, occasionally failures. We also saw this when working on ZOOKEEPER-397, the testng\nport. testng does not support \"fork mode\" for running the tests. as a result all the tests (all) run in a single\nvm instance, start to finish. so this problem is exacerbated significantly in that case. this patch only\nfixes the problem in junit btw, it does not move to testng\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d505d5f627d6b05869a0e" }, "external_id" : "ZOOKEEPER-426", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Windows versions of zookeeper scripts", "desc" : "Attached are a some Windows versions of the zookeeper scripts. They aren't as powerful as the .sh ones but they do work for me and can be invoked with any directory as the current dir.\nThe biggest trick in the scripts is in the zkEnv.cmd one where it says: \n  set ZOOCFGDIR=%~dp0%..\\conf\nthis basically figures out the location of the zkEnv.cmd file and sets the conf directory relative to that.", "created_at" : { "$date" : "2009-06-02T14:39:39.388+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.168+0000" }, "creator_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "reporter_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.1.1" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505d5f627d6b05869a0d" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d505e5f627d6b05869a27" }, "external_id" : "ZOOKEEPER-456", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "CREATOR_ALL_ACL has unnecessary PERMS.ADMIN in the declartion.", "desc" : "CREATOR_ALL_ACL has unnecessary PERMS.ADMIN in the declartion. The perms are defined as PERMS.ALL|PERMS.ADMIN. PERMS.ALL includes ADMIN, so the logical or is unnecessary.", "created_at" : { "$date" : "2009-07-01T00:30:51.467+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.337+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d505f5f627d6b05869a34" }, "external_id" : "ZOOKEEPER-436", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Bookies should auto register to ZooKeeper", "desc" : "currently bookies have to be manually added to ZooKeeper to be used in a BookKeeper service. we should be able to just start up a bookkie, point it at ZooKeeper, and have it get auto integrated in.", "created_at" : { "$date" : "2009-06-05T21:12:37.775+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.232+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d505f5f627d6b05869a62" }, "external_id" : "ZOOKEEPER-489", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "findbugs on hudson.zones.a.o has jumped way up (2k+)", "desc" : "for some reason hudson.zones violations report has jumped up to 2000+ findbugs issues in just the last couple of weeks. It's\njumped up from 0 violations so something is weird...\n\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/\n\nGiri can you take a look?\n", "created_at" : { "$date" : "2009-07-28T06:40:27.767+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.969+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50605f627d6b05869a69" }, "external_id" : "ZOOKEEPER-488", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "to fix src/c/tests/zkServer.sh script to add clover in classpath", "created_at" : { "$date" : "2009-07-27T06:19:14.075+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.902+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50615f627d6b05869a72" }, "external_id" : "ZOOKEEPER-486", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improve bookie performance for large number of ledgers", "desc" : "If we write simultaneously to a large number of ledgers on a bookie, then performance drops significantly due to more seeks on the ledger device. In such cases, we should be clustering ledgers into files to reduce the number of seeks, and performing sequential writes on each file. Clustering ledgers will impact read performance, so we would to have a knob to control such a feature.\n\n\n", "created_at" : { "$date" : "2009-07-24T01:03:50.557+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.830+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50415f627d6b058696e9" }, "external_id" : "ZOOKEEPER-485", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server", "documentation" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d503a5f627d6b05869637" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-07-23T21:47:03.446+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:24:55.794+0000" }, "title" : "need ops documentation that details supervision of ZK server processes", "issue_type" : "Bug", "desc" : "We need ops documentation detailing what to do if the ZK server VM fails - by fail I mean the jvm process\nexits/dies/crashes/etc...\n\nIn general a supervisor process should be used to start/stop/restart/etc... the ZK server vm.\n\nSomething like daemontools http://cr.yp.to/daemontools.html could be used, or more simply a wrapper script\nshould monitor the status of the pid and restart if the jvm fails. It's up to the operator, if this is not done\nautomatically then it will have to be done manually, by operator restarting the ZK server jvm\n\nThe inherent behavior of ZK wrt to failures - ie that it automatically recovers as long as quorum is maintained - \nfits into this nicely.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50625f627d6b05869a9a" }, "external_id" : "ZOOKEEPER-502", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bookkeeper create calls completion too many times", "desc" : "when calling the asynchronous version of create, the completion routine is called more than once.", "created_at" : { "$date" : "2009-08-07T00:57:50.287+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:56.283+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50635f627d6b05869aa7" }, "external_id" : "ZOOKEEPER-496", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper-tree utility for export, import and incremental updates", "desc" : "==========================================\nzktreeutil - Zookeeper Tree Data Utility\nAuthor: Anirban Roy\nOrganization: Yahoo Inc.\n==========================================\n\nzktreeutil program is intended to manage and manipulate zk-tree data quickly, effi-\nciently and with ease. The utility operates on free-form ZK-tree and hence can be used\nfor any cluster managed by Zookeeper. Here are the basic functionalities -\n\nEXPORT: The whole/partial ZK-tree is exported into a XML file. This helps in\ncapturing a current snapshot of the data for backup/analysis. For a subtree\nexport, one need to specify the path to the ZK-subtree with proper option.\n\nIMPORT: The ZK-tree can be imported from XML into ZK cluster. This helps in priming\nthe new ZK cluster with static configuration. The import can be non-intrusive by\nmaking only the additions in the existing data. The import of subtree is also\npossible by optionally providing the path to the ZK-subtree.\n\nDIFF: Creates a diff between live ZK data vs data saved in XML file. Diff can ignore\nsome ZK-tree branches (possibly dynamic data) on reading the optional ignore flag\nfrom XML file. Diffing on a ZK-subtree achieved by providing path to ZK-subtree with\ndiff command.\n\nUPDATE: Make the incremental changes into the live ZK-tree from saved XML, essentia-\nlly after running the diff.\n\nDUMP: Dumps the ZK-tree on the standard output device reading either from live ZK\nserver or XML file. Like export, ZK-subtree can be dumped with optionaly\nproviding the path to the ZK-subtree, and till a certain depth of the (sub)tree.\n\nThe exported ZK data into XML file can be shortened by only keeping the static ZK\nnodes which are required to prime a cluster. The dynamic zk nodes (created on-the-\nfly) can be ignored by setting a 'ignore' attribute at the root node of the dynamic\nsubtree (see tests/zk_sample.xml), possibly deleting all inner ZK nodes under that.\nOnce ignored, the whole subtree is ignored during DIFF, UPDATE and WRITE.", "created_at" : { "$date" : "2009-08-03T18:51:25.207+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:56.191+0000" }, "creator_id" : { "$oid" : "5b7d5063e9214a0d1608d8a7" }, "reporter_id" : { "$oid" : "5b7d5063e9214a0d1608d8a7" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5063e9214a0d1608d8a7" }, "issue_links" : [  ], "original_time_estimate" : 604800, "environment" : "RHEL 4.6, libxml2" },
{ "_id" : { "$oid" : "5b7d50645f627d6b05869adf" }, "external_id" : "ZOOKEEPER-504", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClassCastException in LedgerManagementProcessor", "desc" : "\njava.lang.ClassCastException: org.apache.bookkeeper.client.LedgerManagementProcessor$OpenLedgerOp cannot be cast to org.apache.bookkeeper.client.LedgerManagementProcessor$CloseLedgerOp\n\tat org.apache.bookkeeper.client.LedgerManagementProcessor.processResult(LedgerManagementProcessor.java:1083)\n\nThis seems to be happening because its a nested switch case statement. And the OPEN: case, doesn't ever call a break. It only calls a break from the inner switch-case and hence falls through into the CLOSE: case.\n", "created_at" : { "$date" : "2009-08-07T17:35:50.307+0000" }, "updated_at" : { "$date" : "2010-03-26T17:24:59.939+0000" }, "creator_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "reporter_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50655f627d6b05869af9" }, "external_id" : "ZOOKEEPER-531", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hudson trunk failure in heirarchical quorum test (interrupt problem)", "desc" : "Flavio, can you take a look, this is very unusual. This test seems to be failing due to interrupt being received and not handled properly:\n\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/470/testReport/org.apache.zookeeper.test/HierarchicalQuorumTest/testHierarchicalQuorum/\n\nI don't know why the interrupt would be received though...\n\nhere's an example:\n2009-09-21 10:46:47,681 - WARN  [Thread-8:QuorumCnxManager$SendWorker@539] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1934)\n\tat java.util.concurrent.ArrayBlockingQueue.take(ArrayBlockingQueue.java:317)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:533)\n", "created_at" : { "$date" : "2009-09-21T17:09:13.810+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.911+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50655f627d6b05869afd" }, "external_id" : "ZOOKEEPER-530", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Memory corruption: Zookeeper c client IPv6 implementation does not honor struct sockaddr_in6 size", "desc" : "I tried to run zookeeper c-client on a machine with IPv6 enabled. When connecting to the IPv6 address a connect(...) gave a \"Address family not supported by protocol\" error. The reason was, that a few lines earlier, the socket was opened with PF_INET instead of PF_INET6. Changing that the following way:\n\n{code}\n           if (zh->addrs[zh->connect_index].sa_family == AF_INET) {\n            \tzh->fd = socket(PF_INET, SOCK_STREAM, 0);\n            } else {\n            \tzh->fd = socket(PF_INET6, SOCK_STREAM, 0);\n            }\n{code}\n\nturned the error message into \"Invalid argument\". \n\nWhen printing out sizeof(struct sockaddr), sizeof(struct sockaddr_in) and sizeof(struct sockaddr_in6) I got sockaddr: 16, sockaddr_in: 16 and sockaddr_in6: 28. \n\nSo in the code calling \n\n{code}\n           connect(zh->fd, &zh->addrs[zh->connect_index], sizeof(struct sockaddr_in));\n{code}\n\nthe parameter address_len is too small.\n\nSame applies to how IPv6 addresses are handled in the function getaddrs(zhandle_t *zh).\n\n(Big Thanks+kiss to Thilo Fromm for helping me debug this.)", "created_at" : { "$date" : "2009-09-21T09:17:08.927+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.858+0000" }, "creator_id" : { "$oid" : "5b7d5065e9214a0d1608d8a8" }, "reporter_id" : { "$oid" : "5b7d5065e9214a0d1608d8a8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5065e9214a0d1608d8a8" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50665f627d6b05869b1a" }, "external_id" : "ZOOKEEPER-529", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Use Ivy to pull dependencies and also generate pom", "desc" : "Integrate Ivy into the build. Generate Pom and signed jars to allow zk jars to be officially deployed to a maven repo.", "created_at" : { "$date" : "2009-09-18T22:23:17.927+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.822+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50665f627d6b05869b19" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50675f627d6b05869b34" }, "external_id" : "ZOOKEEPER-527", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson trunk failure in  quota test", "desc" : "the following test failed:\n\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/462/testReport/org.apache.zookeeper.test/QuorumQuotaTest/testQuotaWithQuorum/\n\nhere's the interesting log:\n\n2009-09-16 10:35:52,728 - WARN  [CommitProcessor:1:DataTree@409] - Quota exceeded: /a bytes=1808 limit=1000\n2009-09-16 10:36:34,000 - INFO  [SessionTracker:SessionTrackerImpl@133] - Expiring session 0x423c26c1d220000\n2009-09-16 10:36:12,725 - WARN  [main-SendThread(localhost:11225):ClientCnxn$SendThread@969] - Exception closing session 0x423c26c1d220000 to sun.nio.ch.SelectionKeyImpl@a7dd39\njava.io.IOException: TIMED OUT\n\tat org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:908)\n\nlooks like a create call hung and the session eventually expired\n\nperhaps updating the quota had some issue? deadlock or ...\n", "created_at" : { "$date" : "2009-09-16T17:34:23.101+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.701+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50675f627d6b05869b3a" }, "external_id" : "ZOOKEEPER-528", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client exists() call with watch on large number of nodes (>100k) causes connection loss", "desc" : "If I create 100k nodes on /misc then\n\n      CPPUNIT_ASSERT_EQUAL(0, zoo_get_children(zh2, \"/misc\", 0, &children));\n      for (int i = 0; i < children.count; i++) {\n        sprintf(path, \"/misc/%s\", children.data[i]);\n        CPPUNIT_ASSERT_EQUAL(0, zoo_exists(zh2, path, 1, &stat));\n        CPPUNIT_ASSERT_EQUAL(0, zoo_wexists(zh3, path, watcher, &ctx3, &stat));\n      }\n\naround 47k or so through the loop the client fails with -4 (connection loss), the client timeout is 30 seconds. The server command port shows the following, so it looks like it's not the server but some issue with watcher reg on the c client?\n\nphunt@valhalla:~$ echo stat | nc localhost 22181\nZookeeper version: 3.3.0--1, built on 07/22/2009 23:55 GMT\nClients:\n /127.0.0.1:45729[1](queued=0,recved=100024,sent=0)\n /127.0.0.1:50229[1](queued=0,recved=0,sent=0)\n /127.0.0.1:45731[1](queued=0,recved=47116,sent=0)\n /127.0.0.1:45730[1](queued=0,recved=47117,sent=1)\n\nLatency min/avg/max: 0/196/1026\nReceived: 194257\nSent: 1\nOutstanding: 0\nZxid: 0x186a4\nMode: standalone\nNode count: 100005\n\n\n729 is a separate client - the one that created the nodes originally.\n\n731 and 730 are zh2/zh3 in the code.\n", "created_at" : { "$date" : "2009-09-16T18:46:54.068+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.758+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50685f627d6b05869b41" }, "external_id" : "ZOOKEEPER-519", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Followerhandler should close the socket if it gets an exception on a write.", "desc" : "We noticed this in our tests -\n\n{code}\n\njava.net.SocketException: Broken pipe\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.write(BufferedOutputStream.java:105)\n        at java.io.DataOutputStream.write(DataOutputStream.java:90)\n        at java.io.FilterOutputStream.write(FilterOutputStream.java:80)\n        at org.apache.jute.BinaryOutputArchive.writeBuffer(BinaryOutputArchive.java:122)\n        at org.apache.zookeeper.server.DataNode.serialize(DataNode.java:126)\n        at org.apache.jute.BinaryOutputArchive.writeRecord(BinaryOutputArchive.java:126)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:878)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:890)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:890)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:890)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:890)\n        at org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:890)\n        at org.apache.zookeeper.server.DataTree.serialize(DataTree.java:940)\n        at org.apache.zookeeper.server.util.SerializeUtils.serializeSnapshot(SerializeUtils.java:102)\n        at org.apache.zookeeper.server.ZooKeeperServer.serializeSnapshot(ZooKeeperServer.java:269)\n        at org.apache.zookeeper.server.quorum.FollowerHandler.run(FollowerHandler.java:263)\n{code}\n\nSo the followerhandler got an exception while writing to the socket but the follower was still waiting on the socket for a read and got a read timeout after 60 seconds or so. To just make sure we handle this rightly, we should close the socket at the followerhandler when we get an excpetion, so that the follower immediately recognizes that its disconnected from the leader.", "created_at" : { "$date" : "2009-08-25T23:49:16.387+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.536+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50695f627d6b05869b51" }, "external_id" : "ZOOKEEPER-516", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add support for 10 minute test ie \"pre-commit\" test", "desc" : "Our unit tests are now taking > 10 minutes (20 actually). We need to set things up such that we have a < 10 minute \"pre commit\" build, and a longer running test of tests (unbounded for all intents/purposes). Mainly this requires us to categorize our tests.\n", "created_at" : { "$date" : "2009-08-25T23:27:07.725+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.501+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506a5f627d6b05869b66" }, "external_id" : "ZOOKEEPER-511", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bad error handling in FollowerHandler.sendPackets", "desc" : "in FollowerHandler if sendPackets gets an ioexception on writeRecord the send thread will exit, however the \nsocket isn't necessarily closed.\n\n2009-08-19 15:28:46,869 - WARN  [Sender-/127.0.0.1:58179:FollowerHandler@131] - Unexpected exception\n\tat org.apache.zookeeper.server.quorum.FollowerHandler.sendPackets(FollowerHandler.java:128)\n\tat org.apache.zookeeper.server.quorum.FollowerHandler.access$0(FollowerHandler.java:107)\n\tat org.apache.zookeeper.server.quorum.FollowerHandler$1.run(FollowerHandler.java:325)\n\nThis results in the follower taking a very long time to recover and rejoin the quorum.\n", "created_at" : { "$date" : "2009-08-19T22:35:23.035+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.340+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506b5f627d6b05869b76" }, "external_id" : "ZOOKEEPER-512", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLE election fails to elect leader", "desc" : "I was doing some fault injection testing of 3.2.1 with ZOOKEEPER-508 patch applied and noticed that after some time the ensemble failed to re-elect a leader.\n\nSee the attached log files - 5 member ensemble. typically 5 is the leader\n\nNotice that after 16:23:50,525 no quorum is formed, even after 20 minutes elapses w/no quorum\n\nenvironment:\n\nI was doing fault injection testing using aspectj. The faults are injected into socketchannel read/write, I throw exceptions randomly at a 1/200 ratio (rand.nextFloat() <= .005 => throw IOException\n\nYou can see when a fault is injected in the log via:\n2009-08-19 16:57:09,568 - INFO  [Thread-74:ReadRequestFailsIntermittently@38] - READPACKET FORCED FAIL\n\nvs a read/write that didn't force fail:\n2009-08-19 16:57:09,568 - INFO  [Thread-74:ReadRequestFailsIntermittently@41] - READPACKET OK\n\notw standard code/config (straight fle quorum with 5 members)\n\nalso see the attached jstack trace. this is for one of the servers. Notice in particular that the number of sendworkers != the number of recv workers.\n\n", "created_at" : { "$date" : "2009-08-20T00:11:07.541+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.406+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506c5f627d6b05869bb1" }, "external_id" : "ZOOKEEPER-510", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython lumps all exceptions as IOError, needs specialized exceptions for KeeperException types", "desc" : "The current zkpython bindings always throw \"IOError(\"text\")\" exceptions, even for ZK specific exceptions such as NODEEXISTS. This makes it difficult (error prone) to handle exceptions in python code. You can't easily pickup a connection loss vs a node exists for example. Of course you could match the error string, but this seems like a bad idea imo.\n\nWe need to add specific exception types to the python binding that map directly to KeeperException/java types. It would also be useful to include the information provided by the KeeperException (like path in some cases), etc... as part of the error thrown to the python code. Would probably be a good idea to stay as close to java api as possible wrt mapping the errors.", "created_at" : { "$date" : "2009-08-19T21:13:42.756+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.299+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506d5f627d6b05869bdb" }, "external_id" : "BOOKKEEPER-691", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "external_id" : "ZOOKEEPER-507", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bda" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bdb" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bdc" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bd9" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50645f627d6b05869adf" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a9a" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "created_at" : { "$date" : "2009-08-15T08:26:12.058+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.217+0000" }, "title" : "BookKeeper client re-write", "issue_type" : "Improvement", "desc" : "Error handling is far from ideal currently in the BookKeeper client.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d506d5f627d6b05869be2" }, "external_id" : "ZOOKEEPER-659", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506e5f627d6b05869c25" }, "external_id" : "ZOOKEEPER-506", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumBase should use default leader election", "desc" : "QuorumBase currently does not use the default implementation of leader election.", "created_at" : { "$date" : "2009-08-15T08:24:51.154+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.178+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d506e5f627d6b05869c24" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d506d5f627d6b05869bd9" }, "external_id" : "ZOOKEEPER-505", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "created_at" : { "$date" : "2009-08-08T20:57:35.547+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.115+0000" }, "title" : "testAsyncCreateClose is badly broken", "issue_type" : "Bug", "desc" : "The test case testAsyncCreateClose is badly broken. I was wondering why all the unit tests are passing inspite of having found so many different problems with LedgerManagementProcessor. \n\nThere is a big try-catch block sitting in the test case that catches all exception, prints their stack trace, and exits, thereby allowing the test to pass. In general, unit tests shouldnt catch exceptions unless it is something you are expecting that will happen.\n\nAnother problem is that the same ControlObject is used for synchronization throughout. Since we already have the problem of callbacks being called multiple times (ZOOKEEPER-502), notify() on the control object is called too many times, resulting in the unit test not waiting for certain callbacks.\n\nThus the test never waits for the asyncOpenLedger() to finish, and hence still succeeds. I believe asyncOpenLedger() has never worked right. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d506f5f627d6b05869c3e" }, "external_id" : "ZOOKEEPER-524", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "DBSizeTest is not really testing anything", "desc" : "DBSizeTest looks like it should be testing latency, but it doesn't seem to do it (assert is commented out).\n\nWe need to decide if this test should be fixed, or just dropped.\n\nAlso note: this test takes 40seconds on my system. Way too long. Perhaps async create operations should be used\nto populate the database. I also noticed that data size has a big impact on overall test time (1k vs 5 bytes is something\nlike a 2x time diff for time to run the test).\n", "created_at" : { "$date" : "2009-09-10T23:36:16.869+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.668+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50705f627d6b05869c4a" }, "external_id" : "ZOOKEEPER-521", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "include autotools (autoconf/automake) in NOTICE file", "desc" : "The toplevel notice file should be updated to credit the gnu autotools project, something like:\n\nThis project includes scripts generated by GNU autotools (autoconf/automake/etc...).\nThese files are released under the Apache license.\nThis is permissible under the license clarification at:\n    http://ftp.gnu.org/old-gnu/Manuals/autoconf-2.53/html_node/Distributing.html#Distributing\n\n\nwe should also take the opportunity to adjust the existing text as detailed here:\nhttp://apache.org/legal/src-headers.html#notice", "created_at" : { "$date" : "2009-09-04T19:07:29.156+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:00.578+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build", "documentation" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50715f627d6b05869c51" }, "external_id" : "ZOOKEEPER-539", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "generate eclipse project via ant target", "desc" : "Enable eclipse project generation via ant target.\n", "created_at" : { "$date" : "2009-10-01T20:54:19.641+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.873+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50715f627d6b05869c5c" }, "external_id" : "ZOOKEEPER-532", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "java compiler should be target Java 1.5", "desc" : "The jars released in 3.2.1 will not run on Java 1.5.  With a small build change, it is possible to generate jars that will run on Java 1.5.", "created_at" : { "$date" : "2009-09-22T20:09:46.334+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.409+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50725f627d6b05869c74" }, "external_id" : "ZOOKEEPER-541", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython limited to 256 handles", "desc" : "zkpython is currently limited to a max of 256 total handles - not 256 open handles, but rather 256 total handles created\nover the lifetime of the python application.\n\nIn general this isn't a real issue, however in the case of a long lived application which polls the cluster periodically (closing\nthe session btw calls) this is an issue.\n\nit would be great if the slots could be reused? or perhaps a more complex structure, such as a linked list, which would allow\ndynamic growth/shrinkage of the handle list.\n\nAlso see ZOOKEEPER-540\n", "created_at" : { "$date" : "2009-10-06T00:04:47.423+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.988+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50725f627d6b05869c73" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50735f627d6b05869c87" }, "external_id" : "ZOOKEEPER-95", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50735f627d6b05869c88" }, "external_id" : "ZOOKEEPER-537", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The zookeeper jar includes the java source files", "desc" : "This is a problem if you use zookeeper as a dependency in maven because for whatever reason the maven compiler plugin will pick up the java files in the jar and compile them to the output directory. From there they will land in the generated jar file for whatever project happens to depend on zookeeper thus introducing duplicate classes (once in zookeeper.jar, once in the project's artifact).", "created_at" : { "$date" : "2009-09-25T22:25:43.547+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.735+0000" }, "creator_id" : { "$oid" : "5b7d5073e9214a0d1608d8aa" }, "reporter_id" : { "$oid" : "5b7d5073e9214a0d1608d8aa" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d5073e9214a0d1608d8aa" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50735f627d6b05869c87" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50665f627d6b05869b19" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d50745f627d6b05869cb3" }, "external_id" : "ZOOKEEPER-535", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ivy task does not enjoy being defined twice (build error)", "desc" : "Ant resolves the same dependencies multiple times if multiple targets are run on the command line:\n\n\"ant b c\", where b and c both depend on a, results in a being executed twice. However if you have a\ntarget d which depends on both b and c, \"ant d\" will only result in a being executed once.\n\nsay \"ant jar compile-test\" is run, this will currently fail as ivy-init is run twice, resulting in the taskdef failing.\n\nRather we need a guard on the ivy-init target itself to ensure it isn't run twice.\n\nie: put an unless attrib on ivy-init, then set that property in the body of the target\n", "created_at" : { "$date" : "2009-09-24T17:56:42.616+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.672+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50745f627d6b05869cbd" }, "external_id" : "ZOOKEEPER-533", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ant error running clean twice", "desc" : "if clean is run twice in a row (ie already clean, then run clean) an error is generated.", "created_at" : { "$date" : "2009-09-23T17:41:41.689+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.454+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50725f627d6b05869c73" }, "external_id" : "ZOOKEEPER-540", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "fix_versions" : [ "3.3.0", "3.2.2" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50725f627d6b05869c74" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2009-10-01T22:02:41.568+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.959+0000" }, "title" : "zkpython needs better tracking of handle validity", "issue_type" : "Bug", "desc" : "I was getting a python segfault in one of my scripts. Turns out I was closing a session handle and then reusing it (async call). This was causing python to segfault.\n\nzkpython should track handle state and complain, rather than crash, if the handle is invalid (closed).\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50765f627d6b05869cd5" }, "external_id" : "ZOOKEEPER-538", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper.async causes python to segfault", "desc" : "Henry, can you take a look at this, am I doing it right?\n\ncalling \n        zookeeper.async(self.handle, path)\ncauses python to segfault.\n\nsee: http://github.com/phunt/zk-smoketest/blob/master/zk-smoketest.py\n\n", "created_at" : { "$date" : "2009-09-30T06:00:21.552+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:01.800+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50765f627d6b05869ce8" }, "external_id" : "ZOOKEEPER-560", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "inefficient request handling in NIOServerCnxn", "desc" : "the server doIO code, specifically for read is inefficiently handling requests.\n\ndio does the following for reads\n\nif new request received: read length and return\nelse read request body and return\n....\n\nas a result we poll the selector twice for each request from a client.\n\nwe should just read the request fully, reducing selector polling by half\n", "created_at" : { "$date" : "2009-10-26T17:21:22.004+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.719+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50765f627d6b05869ce7" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50775f627d6b05869cf1" }, "external_id" : "ZOOKEEPER-557", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Upload Zookeeper jars to a public maven repository", "desc" : "There are many cool release of hadoop zookeeper and this project is an apache project, as the maven project.\nBut the released jars must be download manually and then deploy to a private repository before they can be used by developer using maven2.\n\nPlease could you upload the zookeeper  jars on the public maven2 repository ?\n\nOf course, we can help to deploy those artifact if necessary.", "created_at" : { "$date" : "2009-10-24T21:03:25.725+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.638+0000" }, "creator_id" : { "$oid" : "5b7d5077e9214a0d1608d8ab" }, "reporter_id" : { "$oid" : "5b7d5077e9214a0d1608d8ab" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.3.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50765f627d6b05869ce7" }, "external_id" : "ZOOKEEPER-558", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50785f627d6b05869cfa" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50785f627d6b05869cf9" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50765f627d6b05869ce8" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-10-25T00:08:18.545+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.680+0000" }, "title" : "server \"sent\" stats not being updated", "issue_type" : "Bug", "desc" : "the server and connection \"sent\" stat is not being updated. if you run \"stat\" on the client port the sent packets is much lower than it should be\n\nseems that sendbuffer is not updating the stats when it shortcircuits the send.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50795f627d6b05869d16" }, "external_id" : "ZOOKEEPER-551", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "unnecessary SetWatches message on new session", "desc" : "The java client is sending a SetWatches message even on a new session (always empty). Additionally SetWatches is called\neven in the case of re-establishing session, however no watches are set. The code should check for watches before\nsending this (ie don't send empty setwatches). I see this on java, investigate c as well.\n", "created_at" : { "$date" : "2009-10-13T04:10:33.048+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.480+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50795f627d6b05869d22" }, "external_id" : "ZOOKEEPER-554", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython can segfault when statting a deleted node", "desc" : "C client returns NULL for stat object for deleted nodes. zookeeper.c blindly dereferences it. Segfault. ", "created_at" : { "$date" : "2009-10-14T22:55:06.725+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.531+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507a5f627d6b05869d2e" }, "external_id" : "ZOOKEEPER-549", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Refactor Followers and related classes into a Peer->Follower hierarchy in preparation for Observers", "desc" : "For the Observers patch (ZOOKEEPER-368), a lot of functionality is shared between Followers and Observers. To avoid copying code, it makes sense to push the common code into a parent Peer class and specialise it for Followers and Observers. At the same time, some of the lengthier methods in Follower can be broken up to make the code more readable. ", "created_at" : { "$date" : "2009-10-08T23:19:58.839+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.368+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507b5f627d6b05869d57" }, "external_id" : "ZOOKEEPER-548", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper.ZooKeeperException not added to the module in zkpython", "desc" : "ZooKeeperException is not being added to the zookeeper module in zookeeper.c (zkpython). The other exceptions\nare added but not ZooKeeperException. Sorry, I missed this in my previous change, I got all the subclasses but not zkex itself.\n", "created_at" : { "$date" : "2009-10-08T22:59:10.754+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.320+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507c5f627d6b05869d5e" }, "external_id" : "ZOOKEEPER-555", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add stat information to GetChildrenResponse", "desc" : "GetChildren() is the only non-create/delete API which does not include the node stat information. I propose that the definition of GetChildren() should be:\n\n    class GetChildrenResponse {\n        vector<ustring> children;\n        org.apache.zookeeper.data.Stat stat;\n    }\n\nThere is a trivial fix to the server (FinalRequestProcessor.java): rsp = new GetChildrenResponse(children, stat);\n\nAnd something similar to the  client library.\n", "created_at" : { "$date" : "2009-10-15T10:58:29.305+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.567+0000" }, "creator_id" : { "$oid" : "5b7d507ce9214a0d1608d8ac" }, "reporter_id" : { "$oid" : "5b7d507ce9214a0d1608d8ac" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib-bindings", "c client", "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d507ce9214a0d1608d8ac" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d507c5f627d6b05869d5d" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d507d5f627d6b05869d8f" }, "external_id" : "ZOOKEEPER-550", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Java Queue Recipe", "desc" : "This patch adds a recipe for creating a distributed queue with ZooKeeper similar to the WriteLock recipe and some sequential tests.  This early attempt follows the Java BlockingQueue interface, though it doesn't implement it since I don't think there's a good reason for it to be Iterable.  ", "created_at" : { "$date" : "2009-10-09T22:59:26.853+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.416+0000" }, "creator_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "reporter_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507e5f627d6b05869dc4" }, "external_id" : "ZOOKEEPER-542", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c-client can spin when server unresponsive", "desc" : "Due to a mismatch between zookeeper_interest() and zookeeper_process(), when the zookeeper server is unresponsive the client can spin when reconnecting to the server.\n\nIn particular, zookeeper_interest() adds ZOOKEEPER_WRITE whenever there is data to be sent, but flush_send_queue() only writes the data if the state is ZOO_CONNECTED_STATE.  When in ZOO_ASSOCIATING_STATE, this results in spinning.\n\nThis probably doesn't affect production, but I had a runaway process in a development deployment that caused performance issues on the node.  This is easy to reproduce in a single node environment by doing a kill -STOP on the server and waiting for the session timeout.\n\nPatch to be added.", "created_at" : { "$date" : "2009-10-06T01:54:02.151+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.036+0000" }, "creator_id" : { "$oid" : "5b7d507ee9214a0d1608d8ae" }, "reporter_id" : { "$oid" : "5b7d507ee9214a0d1608d8ae" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d507ee9214a0d1608d8ae" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507e5f627d6b05869ddb" }, "external_id" : "ZOOKEEPER-547", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Sanity check in QuorumCnxn Manager and quorum communication port.", "desc" : "We need to put some sanity checks in QuorumCnxnManager and the other quorum port for rogue clients. Sometimes a clients might get misconfigured and they might send random characters on such ports. We need to make sure that such rogue clients do not bring down the clients and need to put in some sanity checks with respect to packet lengths and deserialization.", "created_at" : { "$date" : "2009-10-08T22:01:41.532+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.277+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.2.1" ], "components" : [ "leaderElection", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507f5f627d6b05869e04" }, "external_id" : "ZOOKEEPER-544", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve client testability - allow test client to access connected server location", "desc" : "This came up recently on the user list. If you are developing tests for your zk client you need to be able to access the server that your\nsession is currently connected to. The reason is that your test needs to know which server in the quorum to shutdown in order to\nverify you are handling failover correctly. Similar for session expiration testing.\n\nhowever we should be careful, we prefer not to expose this to all clients, this is an implementation detail that we typically\nwant to hide. \n\nalso we should provide this in both the c and java clients\n\nI suspect we should add a protected method on ZooKeeper. This will make a higher bar (user will have to subclass) for \nthe user to access this method. In tests it's fine, typically you want a \"TestableZooKeeper\" class anyway. In c we unfortunately\nhave less options, we can just rely on docs for now. \n\nIn both cases (c/java) we need to be very very clear in the docs that this is for testing only and to clearly define semantics.\n\nWe should add the following at the same time:\n\ntoString() method to ZooKeeper which includes server ip/port, client port, any other information deemed useful (connection stats like send/recv?)\n\nthe java ZooKeeper is missing \"deterministic connection order\" that the c client has. this is also useful for testing. again, protected and \nclear docs that this is for testing purposes only!\n\n\nAny other things we should expose?", "created_at" : { "$date" : "2009-10-08T16:29:04.352+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.208+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "tests", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50805f627d6b05869e21" }, "external_id" : "ZOOKEEPER-543", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Tests for ZooKeeper examples", "desc" : "Initial attempt to create ZooKeeper tests based on the example code on the website.  \nCurrent plan is to test features used in examples using ZooKeeper calls directly.  Another approach would be to make more usable abstractions such as those in src/recipes and test those.\n\n", "created_at" : { "$date" : "2009-10-06T20:32:12.407+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:02.153+0000" }, "creator_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "reporter_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50815f627d6b05869e49" }, "external_id" : "ZOOKEEPER-582", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper can revert to old data when a snapshot is created outside of normal processing", "desc" : "when zookeeper starts up it will restore the most recent state (latest zxid) it finds in the data directory. unfortunately, in the quorum version of zookeeper updates are logged using an epoch based on the latest log file in a directory. if there is a snapshot with a higher epoch than the log files, the zookeeper server will start logging using an epoch one higher than the highest log file.\n\nso if a data directory has a snapshot with an epoch of 27 and there are no log files, zookeeper will start logging changes using epoch 1. if the cluster restarts the state will be restored from the snapshot with the epoch of 27, which in effect, restores old data.\n\nnormal operation of zookeeper will never result in this situation.\n\nthis does not effect standalone zookeeper.\n\na fix should make sure to use an epoch one higher than the current state, whether it comes from the snapshot or log, and should include a sanity check to make sure that a follower never connects to a leader that has a lower epoch than its own.", "created_at" : { "$date" : "2009-11-17T20:56:40.406+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.963+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.1", "3.1.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.1.2", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50825f627d6b05869e80" }, "external_id" : "ZOOKEEPER-579", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython needs more test coverage for ACL code paths", "desc" : "zkpython's tests don't do a good enough job of exercising the ACL code paths. A few new tests that confirm that setACL and friends are working correctly are needed. \n\n", "created_at" : { "$date" : "2009-11-12T23:26:11.822+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.900+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50835f627d6b05869e96" }, "external_id" : "ZOOKEEPER-576", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "docs need to be updated for session moved exception and how to handle it", "desc" : "the handling and implications of session moved exception should be documented.", "created_at" : { "$date" : "2009-11-11T18:08:30.506+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.851+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50835f627d6b05869ea2" }, "external_id" : "ZOOKEEPER-574", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the documentation on snapcount in the admin guide has the wrong default", "desc" : "I believe it's 100k, not 10k\n\n-----------------------\nsnapCount\n(Java system property: zookeeper.snapCount)\n\nClients can submit requests faster than ZooKeeper can process them, especially if there are a lot of clients. To prevent ZooKeeper from running out of memory due to queued requests, ZooKeeper will throttle clients so that there is no more than globalOutstandingLimit outstanding requests in the system. The default limit is 1,000.ZooKeeper logs transactions to a transaction log. After snapCount transactions are written to a log file a snapshot is started and a new transaction log file is started. The default snapCount is 10,000.", "created_at" : { "$date" : "2009-11-11T00:43:34.137+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.805+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50845f627d6b05869eaf" }, "external_id" : "ZOOKEEPER-572", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50845f627d6b05869eb0" }, "external_id" : "ZOOKEEPER-573", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the dump 4letterword is not formatting sessionids in hex", "created_at" : { "$date" : "2009-11-10T01:05:59.750+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.751+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50845f627d6b05869eaf" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50845f627d6b05869eae" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50855f627d6b05869eb9" }, "external_id" : "ZOOKEEPER-570", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "AsyncHammerTest is broken, callbacks need to validate rc parameter", "desc" : "the asynchammertest is not validating the rc in the callback, more serious is that it is using path in the create callback\nto delete the node, rather than name (which is important in the case of a sequential node creation as in this case)", "created_at" : { "$date" : "2009-11-08T06:37:46.422+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.667+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50855f627d6b05869ecd" }, "external_id" : "ZOOKEEPER-569", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Failure of elected leader can lead to never-ending leader election", "desc" : "It is possible for basic LeaderElection to enter a situation where it never terminates. \n\nAs an example, consider a three node cluster A, B and C.\n\n1. In the first round, A votes for A, B votes for B and C votes for C\n2. Since C > B > A, all nodes resolve to vote for C in the second round as there is no first round winner\n3. A, B vote for C, but C fails.\n4. C is not elected because neither A nor B hear from it, and so votes for it are discarded\n5. A and B never reset their votes, despite not hearing from C, so continue to vote for it ad infinitum. \n\nStep 5 is the bug. If A and B reset their votes to themselves in the case where the heard-from vote set is empty, leader election will continue.\n\nI do not know if this affects running ZK clusters, as it is possible that the out-of-band failure detection protocols may cause leader election to be restarted anyhow, but I've certainly seen this in tests. \n\nI have a trivial patch which fixes it, but it needs a test (and tests for race conditions are hard to write!)", "created_at" : { "$date" : "2009-11-06T19:47:54.202+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.609+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50855f627d6b05869ecc" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d50865f627d6b05869efb" }, "external_id" : "ZOOKEEPER-568", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SyncRequestProcessor snapping too frequently - counts non-log events as log events", "desc" : "Noticed the following issues in SyncRequestProcessor\n\n1) logCount is incremented even for non-log events (say getData)\ntxnlog should return indication if request was logged or not (if hdr ==null it returns)\n\nalso:\n\n2) move r.nextInt below logCount++ (ie if an actual log event)\n3) fix indentation after txnlog.append (for some reason has unnecessary 4 char indent)\n", "created_at" : { "$date" : "2009-11-03T01:38:35.407+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.565+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d507c5f627d6b05869d5d" }, "external_id" : "ZOOKEEPER-567", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d507c5f627d6b05869d5e" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-11-01T04:41:05.350+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.526+0000" }, "title" : "javadoc for getchildren2 needs to mention \"new in 3.3.0\"", "issue_type" : "Bug", "desc" : "the javadoc/cdoc for getchildren2 needs to mention that the methods are \"new in 3.3.0\"\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50845f627d6b05869eae" }, "external_id" : "ZOOKEEPER-566", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50845f627d6b05869eb0" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-10-29T05:27:26.951+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.483+0000" }, "title" : "\"reqs\" four letter word (command port) returns no information", "issue_type" : "Bug", "desc" : "the four letter word \"reqs\" doesn't do anything - it always returns empty data. Seems that \"outstanding\" field is always empty and never set.\n\nwe should remove outstanding and also update the reqs code to correctly output the outstanding requests (if not possible then remove the cmd and update docs - although this is very useful command, hate to see us lose it)", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50885f627d6b05869f22" }, "external_id" : "ZOOKEEPER-563", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ant test for recipes is broken.", "desc" : "With ZOOKEEPER-529 checked in, ant test for recipes broke. Its a minor change to the build for including librariries from the new location where jars are downloaded by ivy.", "created_at" : { "$date" : "2009-10-28T17:09:27.189+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.355+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50895f627d6b05869f31" }, "external_id" : "ZOOKEEPER-561", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "inefficient buffer management, inefficient gc, in NIOServer request handling", "desc" : "for every request we allocate a buffer to read the body. in most cases the request (say for get) will be very small, but we\nalways allocate a new buffer to store the request.\n\nThere should be a way to improve the buffer handling here. In particular it seems that if we have a buffer of reasonable\nlength (1k) preallocated we could use this to service all requests <= 1k and only allocate when requests are larger. seems\nlike this would handle a large fraction of the requests we typically see (except for large sets for example)\n", "created_at" : { "$date" : "2009-10-26T17:24:18.526+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.237+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d508a5f627d6b05869f36" }, "external_id" : "ZOOKEEPER-562", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client can flood server with pings if tcp send queue filled", "desc" : "The c client can flood the server with pings if the tcp queue is filled.\n\nSay the cluster is overloaded and shuts down the recv processing\n\na c client can send a ping, but since last_send is only updated on successful pushing of data into the \nsocket, if flush_send_queue fails to send any data (send_buffer returns 0) then last_send is not updated\nand zookeeper_interest will again send a ping the next time it is woken - which could be 0 if recv_to is close\nto 0, easily could happen if server is not sending data to the client.\n", "created_at" : { "$date" : "2009-10-26T20:45:28.818+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:03.321+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.1.2", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d508a5f627d6b05869f49" }, "external_id" : "ZOOKEEPER-593", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "java client api does not allow client to access negotiated session timeout", "desc" : "The java client api does not allow the client to access the negotiated session timeout (c does allow this).\n\nIn some cases the client may not get the requested timeout (server applies a min/max bound) in which case\nthe client user code may want to examine the timeout it did receive.", "created_at" : { "$date" : "2009-11-24T16:54:45.672+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:04.373+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d508a5f627d6b05869f48" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d508b5f627d6b05869f57" }, "external_id" : "ZOOKEEPER-591", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The C Client cannot exit properly in some situation", "desc" : "The following code produce a situation, where the C Client can not exit properly,\n\n#include \"include/zookeeper.h\"\n\nvoid default_zoo_watcher(zhandle_t *zzh, int type, int state, const char *path, void* context){\n    int zrc = 0;\n    struct String_vector str_vec = {0, NULL};\n    printf(\"in the default_zoo_watcher\\n\");\n    zrc = zoo_wget_children(zzh, \"/mytest\", default_zoo_watcher, NULL, &str_vec);\n    printf(\"zoo_wget_children, error: %d\\n\", zrc);\n\n    return;\n}\n\nint main()\n{\n    int zrc = 0;\n    int buff_len = 10; \n    char buff[10] = \"hello\";\n    char path[512];\n    struct Stat stat;\n    struct String_vector str_vec = {0, NULL};\n\n    zhandle_t *zh = zookeeper_init(\"10.81.20.62:2181\", NULL, 30000, 0, 0, 0); \n    zrc = zoo_create(zh, \"/mytest\", buff, 10, &ZOO_OPEN_ACL_UNSAFE, 0, path, 512);\n    printf(\"zoo_create, error: %d\\n\", zrc);\n\n    zrc = zoo_wget_children(zh, \"/mytest\", default_zoo_watcher, NULL, &str_vec);\n    printf(\"zoo_wget_children, error: %d\\n\", zrc);\n\n    zrc = zoo_create(zh, \"/mytest/test1\", buff, 10, &ZOO_OPEN_ACL_UNSAFE, 0, path, 512);\n    printf(\"zoo_create, error: %d\\n\", zrc);\n\n    zrc = zoo_wget_children(zh, \"/mytest\", default_zoo_watcher, NULL, &str_vec);\n    printf(\"zoo_wget_children, error: %d\\n\", zrc);\n\n    zrc = zoo_delete(zh, \"/mytest/test1\", -1);\n\n    printf(\"zoo_delete, error: %d\\n\", zrc);\n    zookeeper_close(zh);\n    return 0;\n}\n\n\nrunning this code can cause the program hang at zookeeper_close(zh);(line 38). using gdb to attach the process, I found that the main thread is waiting for do_completion thread to finish,\n(gdb) bt\n#0  0x000000302b806ffb in pthread_join () from /lib64/tls/libpthread.so.0\n#1  0x000000000040de3b in adaptor_finish (zh=0x515b60) at src/mt_adaptor.c:219\n#2  0x00000000004060ba in zookeeper_close (zh=0x515b60) at src/zookeeper.c:2100\n#3  0x000000000040220b in main ()\n\nand the thread which handle the zoo_wget_children(in the default_zoo_watcher) is waiting for sc->cond. \n(gdb) thread 2\n[Switching to thread 2 (Thread 1094719840 (LWP 25093))]#0  0x000000302b8089aa in pthread_cond_wait@@GLIBC_2.3.2 ()\n   from /lib64/tls/libpthread.so.0\n(gdb) bt\n#0  0x000000302b8089aa in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/tls/libpthread.so.0\n#1  0x000000000040d88b in wait_sync_completion (sc=0x5167f0) at src/mt_adaptor.c:82\n#2  0x00000000004082c9 in zoo_wget_children (zh=0x515b60, path=0x40ebc0 \"/mytest\", watcher=0x401fd8 <default_zoo_watcher>, watcherCtx=Variable \"watcherCtx\" is not available.)\n    at src/zookeeper.c:2884\n#3  0x0000000000402037 in default_zoo_watcher ()\n#4  0x000000000040d664 in deliverWatchers (zh=0x515b60, type=4, state=3, path=0x515100 \"/mytest\", list=0x5177d8) at src/zk_hashtable.c:274\n#5  0x0000000000403861 in process_completions (zh=0x515b60) at src/zookeeper.c:1631\n#6  0x000000000040e1b5 in do_completion (v=Variable \"v\" is not available.) at src/mt_adaptor.c:333\n#7  0x000000302b80610a in start_thread () from /lib64/tls/libpthread.so.0\n#8  0x000000302afc6003 in clone () from /lib64/tls/libc.so.6\n#9  0x0000000000000000 in ?? ()\n\nhere, a deadlock presents.\n\n", "created_at" : { "$date" : "2009-11-23T09:35:37.425+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:04.290+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "environment" : "Linux db-passport-test05.vm 2.6.9_5-4-0-5 #1 SMP Tue Apr 14 15:56:24 CST 2009 x86_64 x86_64 x86_64 GNU/Linux " },
{ "_id" : { "$oid" : "5b7d508c5f627d6b05869f99" }, "external_id" : "ZOOKEEPER-589", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "When create a znode, a NULL ACL parameter cannot be accepted", "desc" : "In the comments of client C API which associated with creating znode, eg. zoo_acreate, it is said that the initial ACL of the node \"if null, the ACL of the parent will be used\". However, the it doesn't work. When execute this kind of request at the server side, it raises InvalidACLException. The source code show that, the function fixupACL return false when it get a null ACL. ", "created_at" : { "$date" : "2009-11-23T02:47:54.828+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:04.242+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "environment" : "Linux db-passport-test05.vm 2.6.9_5-4-0-5 #1 SMP Tue Apr 14 15:56:24 CST 2009 x86_64 x86_64 x86_64 GNU/Linux\n" },
{ "_id" : { "$oid" : "5b7d508d5f627d6b05869fa9" }, "external_id" : "ZOOKEEPER-674", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d508d5f627d6b05869faa" }, "external_id" : "ZOOKEEPER-586", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client does not compile under cygwin", "desc" : "the c client fails to compile under cygwin", "created_at" : { "$date" : "2009-11-21T01:18:13.682+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:04.010+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d508d5f627d6b05869fa9" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d506d5f627d6b05869bdc" }, "external_id" : "ZOOKEEPER-607", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-12-02T16:22:11.459+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.893+0000" }, "title" : "improve bookkeeper overview", "issue_type" : "Improvement", "desc" : "fix the overview section in the bookkeeper documentation to introduce the programmer/admin to bookkeeper before giving the details.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d505d5f627d6b05869a0d" }, "external_id" : "ZOOKEEPER-606", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "components" : [ "scripts" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505d5f627d6b05869a0e" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-12-02T01:10:23.536+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.845+0000" }, "title" : "bin scripts don't work in cygwin (spaces in paths)", "issue_type" : "Bug", "desc" : "the scripts in bin fail under cygwin due to spaces not handled properly", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50905f627d6b0586a00e" }, "external_id" : "ZOOKEEPER-601", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "allow configuration of session timeout min/max bounds", "desc" : "ZK servers currently enforce a min/max boundary on client session timeout relative to the ticktime setting, detailed here:\nhttp://hadoop.apache.org/zookeeper/docs/current/zookeeperProgrammers.html#ch_zkSessions\n\nIn general there are good reasons for this however in some cases, in particular with HBase region servers, we have seen a need to allow this bound to be set differently (higher). The Sun jvm can GC pause for very long times (in some cases we've seen 4 minutes even with the \"realtime\" gc.\n\nIt would be good to allow this bound to be set via configuration parameters. \n\nNote: 4letterword and JMX integration would be needed.", "created_at" : { "$date" : "2009-11-30T23:12:25.347+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.761+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50905f627d6b0586a00c" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50905f627d6b0586a00d" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50915f627d6b0586a025" }, "external_id" : "ZOOKEEPER-600", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "TODO pondering about allocation behavior in zkpython may be removed", "desc" : "I suppose the TODO below is referring to the \"path\" variable which is passed in as an output variable to PyArg_ParseTuple right below.  The TODO may be removed, since the code is right.  Code using PyArg_ParseTuple will borrow the reference from the calling code, since there's a stack behind the call to the enclosing function (pyzoo_get_children in this case) which won't go away until the function returns.\n\n\nIndex: src/contrib/zkpython/src/c/zookeeper.c\n===================================================================\n--- src/contrib/zkpython/src/c/zookeeper.c\t(revision 885582)\n+++ src/contrib/zkpython/src/c/zookeeper.c\t(working copy)\n@@ -774,8 +774,6 @@\n \n static PyObject *pyzoo_get_children(PyObject *self, PyObject *args)\n {\n-  // TO DO: Does Python copy the string or the reference? If it's the former\n-  // we should free the String_vector\n   int zkhid;\n   char *path;\n   PyObject *watcherfn = Py_None;\n", "created_at" : { "$date" : "2009-11-30T22:22:37.305+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.704+0000" }, "creator_id" : { "$oid" : "5b7d505ae9214a0d1608d8a0" }, "reporter_id" : { "$oid" : "5b7d505ae9214a0d1608d8a0" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d505ae9214a0d1608d8a0" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d506e5f627d6b05869c24" }, "external_id" : "ZOOKEEPER-599", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d506e5f627d6b05869c25" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-11-26T16:55:38.727+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.639+0000" }, "title" : "Changes to FLE and QuorumCnxManager to support Observers", "issue_type" : "Improvement", "desc" : "Observers currently can only use electionAlg 0, which is not the default, supported leader implementation. This issue will fix it.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50935f627d6b0586a06c" }, "external_id" : "ZOOKEEPER-602", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50935f627d6b0586a06d" }, "external_id" : "ZOOKEEPER-597", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ASyncHammerTest is failing intermittently on hudson trunk", "desc" : "ASyncHammerTest is failing intermittently on hudson trunk. There is no clear reason why this is happening, but\nit seems from the logs that a session connection to a follower is failing during session establishment - the\nfailure seems to be a problem either on the follower or leader. The server gets the session create request, but\nit stalls in the request processor pipeline. (we see it go in, but we do not see it com eout)\n\nunfortunately all efforts to reproduce this on non-hudson trunk have failed. Even trying to reproduce by\nrunning on hudson host itself (manually) has failed.\n\nWe need to instrument the client session creation code in the test to dump the thread stack if the\nsession creation fails.\n", "created_at" : { "$date" : "2009-11-25T18:18:59.253+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.593+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.1", "3.1.1" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.1.2", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50935f627d6b0586a06c" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50905f627d6b0586a00d" }, "external_id" : "ZOOKEEPER-595", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server", "jmx" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50905f627d6b0586a00e" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-11-24T21:45:41.961+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5094e9214a0d1608d8b1" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5094e9214a0d1608d8b1" }, "updated_at" : { "$date" : "2010-03-26T17:25:07.326+0000" }, "title" : "A means of asking quorum what conifguration it is running with", "issue_type" : "Improvement", "desc" : "I'd like to ask a running quorum what its configuration is.  I'd want to know stuff like session timeout and tick times.\n\nUse case is that in hbase there is no zoo.cfg usually; the configuration is manufactured and piped to the starting zk server.  I want to know if all of the manufactured config. 'took' or how zk interpreted it.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50955f627d6b0586a0b9" }, "external_id" : "ZOOKEEPER-624", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The C Client cause core dump when receive error data from Zookeeper Server", "desc" : "I encountered a problem today that the Zookeeper C Client (version 3.2.0) core dump when reconnected and did some operations on the zookeeper server which just restarted. The gdb infomation is like:\n\n(gdb) bt\n#0  0x000000302af71900 in memcpy () from /lib64/tls/libc.so.6\n#1  0x000000000047bfe4 in ia_deserialize_string (ia=Variable \"ia\" is not available.) at src/recordio.c:270\n#2  0x000000000047ed20 in deserialize_CreateResponse (in=0x9cd870, tag=0x50a74e \"reply\", v=0x409ffe70) at generated/zookeeper.jute.c:679\n#3  0x000000000047a1d0 in zookeeper_process (zh=0x9c8c70, events=Variable \"events\" is not available.) at src/zookeeper.c:1895\n#4  0x00000000004815e6 in do_io (v=Variable \"v\" is not available.) at src/mt_adaptor.c:310\n#5  0x000000302b80610a in start_thread () from /lib64/tls/libpthread.so.0\n#6  0x000000302afc6003 in clone () from /lib64/tls/libc.so.6\n#7  0x0000000000000000 in ?? ()\n(gdb) f 1\n#1  0x000000000047bfe4 in ia_deserialize_string (ia=Variable \"ia\" is not available.) at src/recordio.c:270\n270     in src/recordio.c\n(gdb) info locals\npriv = (struct buff_struct *) 0x9cd8d0\nlen = -1\nrc = Variable \"rc\" is not available.\n\nAccording to the source code,\nint ia_deserialize_string(struct iarchive *ia, const char *name, char **s)\n{\n    struct buff_struct *priv = ia->priv;\n    int32_t len;\n    int rc = ia_deserialize_int(ia, \"len\", &len);\n    if (rc < 0)\n        return rc;\n    if ((priv->len - priv->off) < len) {\n        return -E2BIG;\n    }\n    *s = malloc(len+1);\n    if (!*s) {\n        return -ENOMEM;\n    }\n    memcpy(*s, priv->buffer+priv->off, len);\n    (*s)[len] = '\\0';\n    priv->off += len;\n    return 0;\n}\n\nthe variable len is set by ia_deserialize_int, and the returned len doesn't been checked, so the client segment fault when trying to memcpy -1 byte data.\nIn the source file recordio.c, there are many functions which don't check the returned len. They all might cause segment fault in some kind of  situations.", "created_at" : { "$date" : "2009-12-15T03:17:08.521+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.822+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "environment" : "Linux 2.6.9 x86_64" },
{ "_id" : { "$oid" : "5b7d50965f627d6b0586a0cc" }, "external_id" : "ZOOKEEPER-621", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson failure ZooKeeper-trunk/621 - clover issue", "desc" : "Giri can you take a look? Any recent changes on hudson that could have caused this?\n\nhttp://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/621/\n\njute:\n    [javac] Compiling 38 source files to /grid/0/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/build/classes\n   [clover] Clover Version 2.4.3, built on March 09 2009 (build-756)\n   [clover] Loaded from: /homes/hudson/tools/clover/latest/lib/clover.jar\n   [clover] Clover: Open Source License registered to Apache.\n   [clover] Failed to create temp directory\n   [clover] ** Error(s) occurred and the instrumentation process can't continue.\n\nBUILD FAILED\n/grid/0/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/build.xml:879: The following error occurred while executing this line:\n/grid/0/hudson/hudson-slave/workspace/ZooKeeper-trunk/trunk/build.xml:199: com.cenqua.clover.CloverException: Failed to create temp directory\n", "created_at" : { "$date" : "2009-12-12T21:36:22.173+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.672+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50975f627d6b0586a0d1" }, "external_id" : "ZOOKEEPER-685", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50975f627d6b0586a0d2" }, "external_id" : "ZOOKEEPER-622", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Test for pending watches in send_set_watches should be moved", "desc" : "Valgrind found:\n\n{quote}\n==2357== Conditional jump or move depends on uninitialised value(s)\n==2357==    at 0x807FDCA: check_events (zookeeper.c:1180)\n==2357==    by 0x808043A: zookeeper_process (zookeeper.c:1775)\n==2357==    by 0x806A21B: Zookeeper_close::testCloseConnected1() (TestZookeeperClose.cc:161)\n==2357==    by 0x806C6BF: CppUnit::TestCaller<Zookeeper_close>::runTest() (TestCaller.h:166)\n{quote}\n\nzookeeper.c:1180 was the first if in send_set_watches.\n\n", "created_at" : { "$date" : "2009-12-12T22:22:59.237+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.724+0000" }, "creator_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "reporter_id" : { "$oid" : "5b7d507de9214a0d1608d8ad" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50975f627d6b0586a0d1" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50985f627d6b0586a0f6" }, "external_id" : "ZOOKEEPER-620", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson is not reporting compiler warning correctly", "desc" : "http://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/590/warningsResult/HIGH/\n\nIf you click on any of these links you will see that these are not compiler warnings:\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/590/warningsResult/HIGH/file.-1602148846/\n\nGiri can you take a look at these and resolve?", "created_at" : { "$date" : "2009-12-10T21:34:02.880+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.625+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504a5f627d6b058697ca" }, "external_id" : "ZOOKEEPER-619", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.0" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504a5f627d6b058697cb" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-12-10T21:31:25.782+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Invalid", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.572+0000" }, "title" : "hudson test failure in QuorumTest -- timeout error", "issue_type" : "Bug", "desc" : "Hudson is not reporting this correctly but:\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/612/\n\n    [junit] 2009-12-03 08:46:27,297 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11301:LeaderElection@109] - 5\t-> 2\n    [junit] Running org.apache.zookeeper.test.QuorumTest\n    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec\n    [junit] Test org.apache.zookeeper.test.QuorumTest FAILED (timeout)\n    [junit] 2009-12-03 08:46:28,390 - INFO  [main:PortAssignment@31] - assigning port 11221\n    [junit] 2009-12-03 08:46:28,393 - INFO  [main:PortAssignment@31] - assigning port 11222\n    [junit] Running org.apache.zookeeper.test.QuorumZxidSyncTest\n\nbut this makes no sense - how is this a timeout?\n\nOne concern is - perhaps this is a deadlock?", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50905f627d6b0586a00c" }, "external_id" : "ZOOKEEPER-617", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50905f627d6b0586a00e" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-12-10T19:11:11.443+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.518+0000" }, "title" : "improve cluster setup documentation in forrest", "issue_type" : "Bug", "desc" : "http://hadoop.apache.org/zookeeper/docs/current/zookeeperAdmin.html#sc_zkMulitServerSetup\n\n1) the config file is missing line returns\n2) call out setting up the myid file as it's own bullet, otw it's too easy to miss\n3) we should make sure the values we use in examples are consistent, and resonable defaults", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50995f627d6b0586a108" }, "external_id" : "ZOOKEEPER-615", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "wrong javadoc for create with a sequence flag", "desc" : "The javadoc for create with a sequence flag mentions a suffix of \"\\_i\" but the true suffix is just \"i\" and no \"\\_\".\n", "created_at" : { "$date" : "2009-12-09T22:17:48.258+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.475+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509a5f627d6b0586a115" }, "external_id" : "ZOOKEEPER-614", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improper synchronisation in getClientCnxnCount", "desc" : "getClientCnxnCount reads from Factory.ipMap without synchronizing. ", "created_at" : { "$date" : "2009-12-07T23:31:18.603+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.436+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1", "3.2.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509b5f627d6b0586a128" }, "external_id" : "ZOOKEEPER-612", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make Zookeeper C client can be compiled by gcc of early version", "desc" : "The original C Client, Version 3.2.1, cannot be compiled successfully by the gcc of early version, due some declaration restriction. To compile the source code on the server with gcc of early version, I made some modification on the original source. What's more, some extra codes are added to make the client be compatible with the hosts list format: ip1:port1, ip2:port2... There is often a space after this kind of comma.", "created_at" : { "$date" : "2009-12-07T08:59:18.369+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.363+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d509c5f627d6b0586a15c" }, "external_id" : "ZOOKEEPER-611", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson build failiure", "desc" : "The hudson build failure failed again on \n\nhttp://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/582/\n", "created_at" : { "$date" : "2009-12-07T01:47:46.084+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.326+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1", "3.1.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0", "3.1.2", "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509d5f627d6b0586a18c" }, "external_id" : "ZOOKEEPER-610", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cleanup final fields, esp those used for locking", "desc" : "There are a number of places where we have non-final fields that could (should) be declared as final.", "created_at" : { "$date" : "2009-12-04T06:50:58.738+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.285+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509e5f627d6b0586a19a" }, "external_id" : "ZOOKEEPER-609", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ObserverTest failure \"zk should not be connected expected not same\"", "desc" : "ObserverTest failed running on 8core\n\nI ran the test as:\n\nant -Dtest.junit.output.format=xml -Dtest.output -Dtestcase=AsyncHammerTest clean test-core-java &> test.out", "created_at" : { "$date" : "2009-12-03T19:32:32.128+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.232+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509e5f627d6b0586a1ad" }, "external_id" : "ZOOKEEPER-608", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Receipt of ACK from observer should not be logged as ERROR", "desc" : "Observers - in general - don't send ACKs. But a couple of times they need to. Currently, these are all logged as an ERROR, which is wrong. They should at most be WARN (and this would probably be confusing to the user). INFO might be better. ", "created_at" : { "$date" : "2009-12-03T00:26:20.518+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:08.107+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d509f5f627d6b0586a1c1" }, "external_id" : "ZOOKEEPER-633", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fetch netty using ivy for bookkeeper", "desc" : "The patch of ZOOKEEPER-507 requires netty and to compile we now have to manually add the netty jar to {project root}/src/java/lib. GIven that we bookkeeper already fetches junit and log4j using ivy, we could also do it for netty. However, we need to configure it to fetch from a different repository.", "created_at" : { "$date" : "2009-12-18T16:30:55.322+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.372+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a05f627d6b0586a1d1" }, "external_id" : "ZOOKEEPER-632", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add some documentation or FAQ on how to do rolling upgrade", "desc" : "add some detail on how to do a rolling upgrade. the benefits, etc...", "created_at" : { "$date" : "2009-12-17T00:21:05.096+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.346+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a05f627d6b0586a1d7" }, "external_id" : "ZOOKEEPER-630", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Trunk has duplicate ObserverTest.java files", "desc" : "There are two identical ObserverTest.java files in trunk. ", "created_at" : { "$date" : "2009-12-16T07:39:59.693+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.302+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a15f627d6b0586a1e6" }, "external_id" : "ZOOKEEPER-627", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython arbitrarily restricts the size of a 'get' to 512 bytes", "desc" : "Reported on the list:\n\n\"\nI'm working on using ZooKeeper for an internal application at Digg.  I've been using the zkpython package and I just noticed that the data I was receiving from a zookeeper.get() call was being truncated.  After some quick digging I found that zookeeper.c limits the data returned to 512 characters (see http://svn.apache.org/viewvc/hadoop/zookeeper/tags/release-3.2.2/src/contrib/zkpython/src/c/zookeeper.c?view=markup line 855).\n\nIs there a reason for this?  The only information regarding node size that I've read is that it should not exceed 1MB so this limit seems a bit arbitrary and restrictive.\n\nThanks for the great work!\n\nRich\"", "created_at" : { "$date" : "2009-12-16T00:45:07.023+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.224+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a25f627d6b0586a202" }, "external_id" : "ZOOKEEPER-626", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ensure the c/java cli's print xid/sessionid/etc... in hex", "desc" : "Java/c clients should output xid/sessionids (incl ephemeralowner) in hex format\n\n    private static void printStat(Stat stat) {\n        System.err.println(\"cZxid = \" + stat.getCzxid());\n        System.err.println(\"ctime = \" + new Date(stat.getCtime()).toString());\n        System.err.println(\"mZxid = \" + stat.getMzxid());\n        System.err.println(\"mtime = \" + new Date(stat.getMtime()).toString());\n        System.err.println(\"pZxid = \" + stat.getPzxid());\n        System.err.println(\"cversion = \" + stat.getCversion());\n        System.err.println(\"dataVersion = \" + stat.getVersion());\n        System.err.println(\"aclVersion = \" + stat.getAversion());\n        System.err.println(\"ephemeralOwner = \" + stat.getEphemeralOwner());\n        System.err.println(\"dataLength = \" + stat.getDataLength());\n        System.err.println(\"numChildren = \" + stat.getNumChildren());\n    }\n", "created_at" : { "$date" : "2009-12-15T17:54:33.216+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.165+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a25f627d6b0586a20e" }, "external_id" : "ZOOKEEPER-651", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log exception trace in QuorumCnxManager.SendWorker", "desc" : "There is an error log message that only outputs a constant string. It would be good to have the trace as well.", "created_at" : { "$date" : "2010-01-19T11:57:33.664+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.885+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.2.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a35f627d6b0586a21a" }, "external_id" : "ZOOKEEPER-648", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix releaseaudit warning count to zero", "desc" : "ant releaseaudit -Dforrest.home=<> -Djava5.home=<>\n200 unknown license should be updated with Apache License headers  \n\nreleaseaudit:\n     [java]\n     [java] *****************************************************\n     [java] Summary\n     [java] -------\n     [java] Notes: 57\n     [java] Binaries: 95\n     [java] Archives: 16\n     [java] Standards: 954\n     [java]\n     [java] Apache Licensed: 610\n     [java] Generated Documents: 144\n     [java]\n     [java] JavaDocs are generated and so license header is optional\n     [java] Generated files do not required license headers\n     [java]\n     [java] 200 Unknown Licenses\n     [java]\n     [java] *******************************", "created_at" : { "$date" : "2010-01-17T18:01:47.575+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.830+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a45f627d6b0586a231" }, "external_id" : "ZOOKEEPER-647", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson failure in testLeaderShutdown", "desc" : "http://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/666/testReport/org.apache.zookeeper.test/QuorumTest/testLeaderShutdown/\n\njunit.framework.AssertionFailedError: QP failed to shutdown in 30 seconds\n\tat org.apache.zookeeper.test.QuorumBase.shutdown(QuorumBase.java:293)\n\tat org.apache.zookeeper.test.QuorumBase.shutdownServers(QuorumBase.java:281)\n\tat org.apache.zookeeper.test.QuorumBase.tearDown(QuorumBase.java:266)\n\tat org.apache.zookeeper.test.QuorumTest.tearDown(QuorumTest.java:55)\n\nFlavio, can you triage this one?\n", "created_at" : { "$date" : "2010-01-15T22:33:58.998+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.783+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a55f627d6b0586a250" }, "external_id" : "ZOOKEEPER-644", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Nightly build failed on hudson.", "desc" : "the nighthly build has been failing. http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/664/. The problem seems to be \n{code}\nBUILD FAILED\njava.lang.NoClassDefFoundError: org/apache/ivy/ant/IvyMakePom$Mapping\n\nTotal time: 15 minutes 14 seconds\n{code}", "created_at" : { "$date" : "2010-01-14T18:43:44.552+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.739+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a55f627d6b0586a25d" }, "external_id" : "ZOOKEEPER-640", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "make build.xml more configurable to ease packaging for linux distros", "desc" : "Hi,\n\nI started packaging Zookeeper for Debian[1][2]. Thereby I had a problem excluding contrib/rest from the build without patching the upstream tarball. Could you please add some properties to your build.xml that allow me to (de)select contribs? In the example below I can easily override the properties:\n\n<project name=\"zookeepercontrib\">\n  \n  <property name=\"contribfilesetincludes\" value=\"*/build.xml\" />\n  <property name=\"contribfilesetexcludes\" value=\"\" />\n\n  <fileset id=\"contribfileset\" \n           dir=\".\" \n           includes=\"${contribfilesetincludes}\"\n           excludes=\"${contribfilesetexcludes}\"\n           />\n\n  <target name=\"compile\">\n    <subant target=\"jar\">\n     <fileset refid=\"contribfileset\" />\n    </subant>\n  </target>\n\nCould you please also add a line to project.classpath:\n\n  <path id=\"project.classpath\">\n      <fileset dir=\"${additional.lib.dir}\" includes=\"*.jar\"/>\n\nFor Debian I may not compile based on the jar files in lib but must use the jars already in Debian.\n\n[1] http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=561947\n[2] http://git.debian.org/?p=pkg-java/zookeeper.git\n\nThank you!", "created_at" : { "$date" : "2010-01-08T14:16:30.073+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.689+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1", "3.2.2" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 900 },
{ "_id" : { "$oid" : "5b7d50a65f627d6b0586a274" }, "external_id" : "ZOOKEEPER-638", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "upgrade ivy to 2.1.0 final from 2.1.0 release candidate", "desc" : "2.1.0 is now available", "created_at" : { "$date" : "2010-01-07T17:15:25.930+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:09.475+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50535f627d6b0586988a" }, "external_id" : "ZOOKEEPER-658", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum", "server", "documentation" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50535f627d6b0586988b" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2010-01-26T00:08:45.745+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.277+0000" }, "title" : "update forrest docs - AuthFLE no longer supported", "issue_type" : "Improvement", "desc" : "See ZOOKEEPER-152, the docs should be updated to reflect that AuthFLE is no longer supported. It would be a good idea to take\nthis opportunity to review the election docs in general and make sure they are up to date.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50a85f627d6b0586a294" }, "external_id" : "ZOOKEEPER-655", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "StringBuffer -> StringBuilder - conversion of references as necessary", "desc" : "Some of the 'StringBuffer' references that do not escape the scope of the method can be better typed as StringBuilder  as concurrency is not needed in that case. ", "created_at" : { "$date" : "2010-01-23T21:46:21.404+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.071+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50a85f627d6b0586a2a2" }, "external_id" : "ZOOKEEPER-656", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SledgeHammer test - thread.run() deprecated ", "desc" : "Thread.run() used instead of Thread.start() . ", "created_at" : { "$date" : "2010-01-24T01:27:49.278+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.217+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504e5f627d6b058697f3" }, "external_id" : "ZOOKEEPER-677", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.2" ], "components" : [ "c client" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504e5f627d6b058697f4" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2010-02-22T18:20:07.985+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.981+0000" }, "title" : "c client doesn't allow ipv6 numeric connect string", "issue_type" : "Bug", "desc" : "The c client doesn't handle ipv6 numeric addresses as they are colon : delmited. After splitting the host/port on : we look for the port as the second entry in the array rather than the last entry in the array.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50aa5f627d6b0586a2df" }, "external_id" : "ZOOKEEPER-673", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix observer documentation regarding leader election", "desc" : "We just need to remove the first two paragraphs of Section 2.", "created_at" : { "$date" : "2010-02-16T19:03:13.579+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.932+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50aa5f627d6b0586a2e9" }, "external_id" : "ZOOKEEPER-672", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "typo nits across documentation ", "desc" : "some typo nits across the documentation.  relevant forrest.xml files fixed. ", "created_at" : { "$date" : "2010-02-16T00:39:14.208+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.897+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ab5f627d6b0586a2f5" }, "external_id" : "ZOOKEEPER-669", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "watchedevent tostring should clearly output the state/type/path", "desc" : "the current tostring method is broken", "created_at" : { "$date" : "2010-02-12T20:46:04.064+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.867+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.1.2", "3.2.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ac5f627d6b0586a30a" }, "external_id" : "ZOOKEEPER-668", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Close method in LedgerInputStream doesn't do anything", "desc" : "I think we should remove the close call in LedgerInputStream. ", "created_at" : { "$date" : "2010-02-12T12:12:01.359+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.801+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ac5f627d6b0586a319" }, "external_id" : "ZOOKEEPER-665", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add BookKeeper streaming documentation ", "created_at" : { "$date" : "2010-02-09T09:40:16.071+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.442+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ad5f627d6b0586a328" }, "external_id" : "ZOOKEEPER-664", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "BookKeeper API documentation", "desc" : "Review and improve BookKeeper API documentation.", "created_at" : { "$date" : "2010-02-09T09:39:36.760+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.384+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ae5f627d6b0586a332" }, "external_id" : "ZOOKEEPER-663", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson failure in ZKDatabaseCorruptionTest", "desc" : "http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/686/\n\njava.lang.RuntimeException: Unable to run quorum server \n\tat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:380)\n\tat org.apache.zookeeper.test.ZkDatabaseCorruptionTest.testCorruption(ZkDatabaseCorruptionTest.java:99)\nCaused by: java.io.IOException: Invalid magic number 0 != 1514884167\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:455)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:471)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:438)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:519)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:145)\n\tat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:193)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:377)", "created_at" : { "$date" : "2010-02-02T17:30:51.711+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:10.309+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ae5f627d6b0586a33e" }, "external_id" : "ZOOKEEPER-709", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bookkeeper build failing with missing factory", "desc" : "ant test in bookkeeper results in\n\ncompile-test:\n    [javac] Compiling 10 source files to /home/phunt/dev/workspace/gitzk/build/contrib/bookkeeper/test\n    [javac] /home/phunt/dev/workspace/gitzk/src/contrib/bookkeeper/test/org/apache/bookkeeper/test/BaseTestCase.java:91: cannot find symbol\n    [javac] symbol  : constructor Factory(java.lang.Integer)\n    [javac] location: class org.apache.zookeeper.server.NIOServerCnxn.Factory\n    [javac]         serverFactory = new NIOServerCnxn.Factory(ZooKeeperDefaultPort);\n    [javac]                         ^\n    [javac] 1 error\n\nFlavio can you take a look at this one? (patch)\n", "created_at" : { "$date" : "2010-03-18T05:57:45.772+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.979+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50af5f627d6b0586a34a" }, "external_id" : "ZOOKEEPER-708", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython failing due to undefined symbol deallocate_String_vector", "desc" : "ant test in zkpython is failing. I think this is due to mahadev's changes to remove unnecessary exports from the client lib.\n\n     [exec] ImportError: /home/phunt/dev/workspace/gitzk/build/contrib/zkpython/lib.linux-x86_64-2.6/zookeeper.so: undefined symbol: deallocate_String_vector\n\nMahadev can you take a look?\n", "created_at" : { "$date" : "2010-03-18T05:34:53.476+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.932+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings", "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b05f627d6b0586a35c" }, "external_id" : "ZOOKEEPER-689", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "release build broken - ivysettings.xml not copied during \"package\"", "desc" : "ivysettings.xml was added in 3.3.0 but it is not copied into the release artifact via ant \"package\" target of build.xml", "created_at" : { "$date" : "2010-03-09T01:23:12.340+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.406+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d504f5f627d6b05869802" }, "external_id" : "ZOOKEEPER-684", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "leaderElection", "server" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504f5f627d6b05869803" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2010-03-03T10:18:39.220+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.278+0000" }, "title" : "Race in LENonTerminateTest", "issue_type" : "Bug", "desc" : "testNonTermination failed during a Hudson run for ZOOKEEPER-59. After inspecting the output, it looks like server is electing 2 as a leader and leaving. Given that 2 is just a mock server, server 0 remains alone in leader election.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50b15f627d6b0586a38d" }, "external_id" : "ZOOKEEPER-693", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "TestObserver stuck in tight notification loop in FLE", "desc" : "See http://hudson.zones.apache.org/hudson/view/ZooKeeper/job/Zookeeper-Patch-h7.grid.sp2.yahoo.net/77/testReport/junit/org.apache.zookeeper.test/ObserverTest/testObserver/\n\n     [exec]     [junit] 2010-03-04 00:23:37,803 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11229:FastLeaderElection@683] - Notification time out: 3200\n     [exec]     [junit] 2010-03-04 00:23:37,804 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11229:FastLeaderElection@689] - Notification: 2, 0, 2, 3, LOOKING, LOOKING, 1\n\nad infinitum. ", "created_at" : { "$date" : "2010-03-09T21:40:06.955+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.813+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b25f627d6b0586a3a0" }, "external_id" : "ZOOKEEPER-692", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "upgrade junit to latest version (4.8.1)", "desc" : "upgrade junit to 4.8.1", "created_at" : { "$date" : "2010-03-09T21:11:00.454+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.776+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b35f627d6b0586a3ab" }, "external_id" : "ZOOKEEPER-691", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Interface changed for NIOServer.Factory", "desc" : "BookKeeper starts a ZooKeeper server and needs to create an NIOServer.Factory, but the constructor changed.", "created_at" : { "$date" : "2010-03-09T20:40:59.494+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.744+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b35f627d6b0586a3b7" }, "external_id" : "ZOOKEEPER-687", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LENonterminatetest fails on some machines.", "desc" : "LENonterminateTest fails with the following error:\n\n{noformat}\n2010-03-04 20:26:32,347 - INFO  [Thread-0:LeaderElection@155] - Server address: 0.0.0.0/0.0.0.0:11223\n2010-03-04 20:26:32,348 - WARN  [Thread-0:LeaderElection@195] - Ignoring exception while looking for leader\njava.io.IOException: Network is unreachable\n\tat java.net.PlainDatagramSocketImpl.send(Native Method)\n\tat java.net.DatagramSocket.send(DatagramSocket.java:612)\n\tat org.apache.zookeeper.server.quorum.LeaderElection.lookForLeader(LeaderElection.java:169)\n\tat org.apache.zookeeper.test.LENonTerminateTest$LEThread.run(LENonTerminateTest.java:83)\n{noformat}\n", "created_at" : { "$date" : "2010-03-04T22:12:23.629+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.333+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b45f627d6b0586a3ca" }, "external_id" : "ZOOKEEPER-696", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE in the hudson logs, seems nioservercnxn closed twice", "desc" : "seeing the following on the console for http://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/729/\n\nlooks like the cnxn is closed twice? (the second time 'sock' is null). perhaps it's due to client closing and sending session term, then closing socket, server sees the read return -1, so closes cnxn, then sees the session close request (which was queued)?\n\n    [junit] 2010-03-10 03:15:53,205 - INFO  [main:NIOServerCnxn@1232] - Closed socket connection for client /127.0.0.1:41285 which had sessionid 0x127461233fc0000\n    [junit] 2010-03-10 03:15:53,206 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11221:NIOServerCnxn$Factory@269] - Ignoring unexpected runtime exception\n    [junit] java.lang.NullPointerException\n    [junit] \tat org.apache.zookeeper.server.NIOServerCnxn.close(NIOServerCnxn.java:1232)\n    [junit] \tat org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:594)\n    [junit] \tat org.apache.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:259)\n", "created_at" : { "$date" : "2010-03-10T05:41:35.685+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.859+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b85f627d6b0586a3d9" }, "external_id" : "ZOOKEEPER-698", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "intermittent JMX test failures due to not verifying QuorumPeer shutdown ", "desc" : "in some cases the tests are failing with JMX errors. From the logs I can see that QP was shutdown, however it did not exit it's thread until some time much later. This is causing interference with subsequent tests, causing the test to fail.\n\nI have a patch that attempts to verify that the QP was shutdown (by joining the thread). It turns out that tests based on QuorumBase do this check (join) however some of the other tests do not. I believe this will address the issue.", "created_at" : { "$date" : "2010-03-12T22:22:01.440+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.891+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b85f627d6b0586a3e9" }, "external_id" : "ZOOKEEPER-688", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "explain session expiration better in the docs & faq", "desc" : "We are not clear enough (and the diagram we do have seems misleading) on _when_ session expirations are generated. In particular the fact that you only get expirations when the client is connected to the cluster, not when disconnected.\n\nwe need to detail:\n\n1) when do you get expiration\n2) what is the sequence of events that the watcher sees, from disco state, to getting the expiration (say the expiration happens when the client is disco, what do you see in the watcher while you are getting reconnected)\n3) we need to give some examples of how to test this. We should be explicit that \"pulling the network cable\" on the client will not show expiration since the cliient will not be reconnected.\n", "created_at" : { "$date" : "2010-03-05T17:10:39.028+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.366+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50b95f627d6b0586a3f8" }, "external_id" : "ZOOKEEPER-683", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LogFormatter fails to parse transactional log files", "desc" : "LogFormatter fails to parse txn log files - seems the tool was never updated to handle FileHeader.\n\nIt would be good to update the docs on txn log file to include detail on the file format.", "created_at" : { "$date" : "2010-03-01T07:04:20.575+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.219+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ba5f627d6b0586a404" }, "external_id" : "ZOOKEEPER-682", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Event is not processed when the watcher is set to watch \"/\" if chrooted", "desc" : "After the event notification response from server is received, the client will convert the server path to the client path if chrooted by:\n\nevent.setPath(serverPath.substring(chrootPath.length());\n\nIf chrootPath and serverPath are the same, then the event's path will be set to a null string.\n\nBut the key of the watcher's map is \"/\", not a null string, so the watcher will not get notified at all.", "created_at" : { "$date" : "2010-02-25T12:01:43.898+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.187+0000" }, "creator_id" : { "$oid" : "5b7d50bae9214a0d1608d8b4" }, "reporter_id" : { "$oid" : "5b7d50bae9214a0d1608d8b4" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d50bae9214a0d1608d8b4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50bb5f627d6b0586a417" }, "external_id" : "ZOOKEEPER-681", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Minor doc issue re unset maxClientCnxns", "desc" : "Just a small issue, the doc says that \"Setting this to 0 or omitting it entirely removes the limit on concurrent connections.\", but we ran without this setting, and saw: WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn$Factory@226] - Too many connections from /10.76.251.190 - max is 10\n\nBug in doc possibly?\n\n", "created_at" : { "$date" : "2010-02-25T11:25:07.050+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:11.119+0000" }, "creator_id" : { "$oid" : "5b7d50bbe9214a0d1608d8b5" }, "reporter_id" : { "$oid" : "5b7d50bbe9214a0d1608d8b5" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50bc5f627d6b0586a427" }, "external_id" : "ZOOKEEPER-710", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "permanent ZSESSIONMOVED error after client app reconnects to zookeeper cluster", "desc" : "Originally problem was described on Users mailing list starting with this [post|http://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/201003.mbox/<3b910d891003160743k38e2e7c9y830b182d88396d55@mail.gmail.com>].\nBelow I restate it in more organized form.\n\nWe occasionally (few times a day) observe that our client application disconnects from Zookeeper cluster.\nApplication is written in C++ and we are using libzookeeper_mt library. In version 3.2.2.\n\nThe disconnects we are observing are probably related to some problems with our network infrastructure - we are observing periods with great packet loss between machines in our DC. \n\nSometimes after client application (i.e. zookeeper library) reconnects to zookeeper cluster we are observing that all subsequent requests return ZSESSIONMOVED error. Restarting client app helps - we always pass 0 as clientid to zookeeper_init function so old session is not reused.\n\nOn 16-03-2010 we observed few occurences of problem. Example ones:\n- 22:08; client IP 10.1.112.60 (app1); sessionID 0x22767e1c9630000\n- 14:21; client IP 10.1.112.61 (app2); sessionID 0x324dcc1ba580085\n\nI attach logs of cluster and application nodes (only stuff concerining zookeeper):\n- [^zookeeper-node1.log.2010-03-16.gz] - logs of zookeepr cluster node 1 10.1.112.62\n- [^zookeeper-node2.log.2010-03-16.gz] - logs of zookeepr cluster node 2 10.1.112.63\n- [^zookeeper-node3.log.2010-03-16.gz] - logs of zookeepr cluster node 3 10.1.112.64\n- [^app1.log.2010-03-16.gz] - application logs of app1 10.1.112.60\n- [^app2.log.2010-03-16.gz] - application logs of app2 10.1.112.61\n\nI also made some analysis of case at 22:08:\n- Network glitch which resulted in problem occurred at about 22:08.\n- From what I see since 17:48 node2 was the leader and it did not\nchange later yesterday.\n- Client was connected to node2 since 17:50\n- At around 22:09 client tried to connect to every node (1,2,3).\nConnections to node1 and node3 were closed\n with exception \"Exception causing close of session 0x22767e1c9630000\ndue to java.io.IOException: Read error\".\n Connection to node2 stood alive.\n- All subsequent operations were refused with ZSESSIONMOVED error.\nError visible both on client and on server side.\n\n", "created_at" : { "$date" : "2010-03-18T11:39:31.140+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:12.009+0000" }, "creator_id" : { "$oid" : "5b7d5051e9214a0d1608d89e" }, "reporter_id" : { "$oid" : "5b7d5051e9214a0d1608d89e" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.3", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "debian lenny; ia64; xen virtualization" },
{ "_id" : { "$oid" : "5b7d50bc5f627d6b0586a450" }, "external_id" : "ZOOKEEPER-718", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the fatjar is missing libraries", "desc" : "when we moved to ivy, we didn't update the fatjar build.xml to grab libraries out of the new location that ivy uses for downloaded libraries.", "created_at" : { "$date" : "2010-03-19T16:09:05.046+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:12.397+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50bd5f627d6b0586a45c" }, "external_id" : "ZOOKEEPER-717", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add a preferred list to the instancemanager", "desc" : "it would be nice to be able to list the preferred containers to assign tasks to when using instance containers. right now assignments are made in hashmap order which is more or less psuedo-random.", "created_at" : { "$date" : "2010-03-19T16:04:59.335+0000" }, "updated_at" : { "$date" : "2010-03-26T17:25:12.134+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50be5f627d6b0586a469" }, "external_id" : "ZOOKEEPER-202", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Phantom ephemeral node", "desc" : "One of our users has observed that an ephemeral znode had gone away once its creator had disconnected according to the leader, but one follower believed that it existed long after the znode had been deleted. Apparently the follower was never going to delete it. Because the leader wouldn't recognize the znode as an existing one, any attempt to delete the znode failed.  We have to investigate if this is related to any known bug, although, to my knowledge, this is the first time it happens. It is important to note that the user was running an older version of our code.", "created_at" : { "$date" : "2008-10-21T21:24:55.487+0000" }, "updated_at" : { "$date" : "2010-03-26T17:28:11.532+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50be5f627d6b0586a478" }, "external_id" : "ZOOKEEPER-598", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LearnerHandler is misspelt in the thread's constructor", "desc" : "Typo in thread constructor. Oops. ", "created_at" : { "$date" : "2009-11-25T19:53:54.553+0000" }, "updated_at" : { "$date" : "2010-03-26T17:28:56.369+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50bf5f627d6b0586a483" }, "external_id" : "ZOOKEEPER-585", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Update README for zkpython in 3.2.2", "desc" : "zkpython has a few improvements going into 3.2.2, and its README needs a short update to reflect this. ", "created_at" : { "$date" : "2009-11-20T00:02:53.764+0000" }, "updated_at" : { "$date" : "2010-03-26T17:29:09.833+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.2" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4f985f627d6b05868840" }, "external_id" : "ZOOKEEPER-239", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f985f627d6b05868841" }, "effect" : "duplicates", "type" : "Duplicate" } ], "created_at" : { "$date" : "2008-11-24T21:53:51.816+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2010-03-26T17:29:36.709+0000" }, "title" : "ZooKeeper System Tests", "issue_type" : "Test", "desc" : "It would be nice to have real system tests. Our current Java system tests start everything in the same JVM. It would be nice to be able to start up the servers on different machines.\n\nThe C tests have a system test with a script to start and stop the cluster. It would be good to extend the script and to make it used by the Java tests as well.\n\nIf we can standardize on the script, we can have script options for different cluster shells from simple ssh to torque.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50475f627d6b05869778" }, "external_id" : "ZOOKEEPER-141", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f875f627d6b058686da" }, "effect" : "is part of", "type" : "Incorporates" } ], "created_at" : { "$date" : "2008-09-15T17:27:45.771+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2010-03-26T17:30:33.464+0000" }, "title" : "Remove challenge on QuorumCnxManager", "issue_type" : "Improvement", "desc" : "The patch of JIRA 127 replaces InetSocket objects with server ids on QuorumCnxManager. Server ids are unique by assumption, and can be used instead of the randomly generated challenges we have currently. I suggest that we make this modification, and we use server ids as the challenge values instead of randomly generated numbers.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50c15f627d6b0586a498" }, "external_id" : "ZOOKEEPER-301", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Util class to initialize Zookeeper with a set of user-specified bookies ", "desc" : "This patch provides a class named org.apache.bookkeeper.util.ZookeeperInitialization which provides basic initialization for bookies onto zookeeper reading from a text file. An example configuration file is provided in conf/zookeeper-initialize-bookies.conf ", "created_at" : { "$date" : "2009-02-06T09:57:00.795+0000" }, "updated_at" : { "$date" : "2010-03-26T17:30:48.804+0000" }, "creator_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "reporter_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c15f627d6b0586a4a0" }, "external_id" : "ZOOKEEPER-441", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zk-336 diff got applied twice to TestClientRetry.cc C test, causing compilation failure", "desc" : "The latest version of trunk has a src/c/tests/TestClientRetry.cc file that has the actual file from ZK-336 appended to itself. This causes the compilation to fail due to lots of redeclaration errors. ", "created_at" : { "$date" : "2009-06-09T11:32:58.884+0000" }, "updated_at" : { "$date" : "2010-03-26T17:31:23.109+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c25f627d6b0586a4aa" }, "external_id" : "ZOOKEEPER-592", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "BookKeeper cannot find junit", "desc" : "When trying to compile bookkeeper, the compiler complains that it can't find junit. I suspect that this is related to the fact that zookeeper now fetches junit using ivy.", "created_at" : { "$date" : "2009-11-24T09:48:39.020+0000" }, "updated_at" : { "$date" : "2010-03-26T17:31:34.433+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c35f627d6b0586a4af" }, "external_id" : "ZOOKEEPER-637", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Trunk build is failing", "desc" : "The trunk build is failing when Hudson runs it. The problem seems to be that ivy-init is executed only once, but its definitions (in particular ivy:settings) do not persist, and the failure occurs when we run ivy-retrieve a second time, which requires the definition of ivy:settings.\n\nIt seems that the problem occur with ant 1.7.0, but not with 1.7.1, so it could be an ant issue. ", "created_at" : { "$date" : "2010-01-06T16:26:42.178+0000" }, "updated_at" : { "$date" : "2010-03-26T17:33:22.956+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50505f627d6b0586981e" }, "external_id" : "ZOOKEEPER-725", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "build", "tests" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50c35f627d6b0586a4c8" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2010-03-24T02:08:42.431+0000" }, "updated_at" : { "$date" : "2010-03-31T05:16:14.393+0000" }, "reporter_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "creator_id" : { "$oid" : "5b7d4fdce9214a0d1608d88b" }, "priority" : "Major", "title" : "Test organization, methodology, and infrastructure improvements ", "issue_type" : "Test", "desc" : "This is an umbrella feature for a number of improvements needed to happen in ZK test realm", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50c45f627d6b0586a4d0" }, "external_id" : "ZOOKEEPER-699", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "GSoC 2010: Optimizations for WAN Deployments", "desc" : "Optimizations for WAN Deployments\n\nPossible Mentor\nHenry Robinson (henry at apache dot org)\n\nRequirements\nJava, some networking familiarity\n\nDescription\nZK 3.3.0 added observers which are non-voting members of a ZK ensemble. One use case for observers is as a proxy to a remote voting ensemble, say in a different data center. Since observers do not need to vote, there are less strict latency requirements on the delivery of messages to them. WAN traffic is also expensive. This project would investigate and implement batching of messages to observers, and potential mechanisms for decreasing the number of messages that need to be sent. For example, a destructive update to a znode twice in a row does not theoretically need to be sent twice - although making this work correctly with ZAB will be a challenge.", "created_at" : { "$date" : "2010-03-13T00:39:53.492+0000" }, "updated_at" : { "$date" : "2010-04-03T07:25:11.844+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "gsoc", "mentor" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c55f627d6b0586a4d3" }, "external_id" : "ZOOKEEPER-3", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : " syncLimit has slightly different comments in the class header, and > inline with the variable.", "desc" : "syncLimit as documented in QuorumPeer is documented twice with two different aspects of in each instance. It should be better documented and unified. (Probably remove the second instance.)", "created_at" : { "$date" : "2008-06-09T16:39:34.900+0000" }, "updated_at" : { "$date" : "2010-04-09T13:43:11.531+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c55f627d6b0586a4e2" }, "external_id" : "ZOOKEEPER-739", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "use a simple command-line parsing library for flexibility in command-line arguments ", "desc" : "JOpt is being used by HBase team and very light-weight.  \n\nhttp://jopt-simple.sourceforge.net/examples.html \n\n <jopt.version>3.2</jopt.version> \n\n\nmvn artifacts are available in public repositories, so integrating with ivy should not be an issue either. \n\nCheck if that makes sense. \n", "created_at" : { "$date" : "2010-04-12T23:10:46.353+0000" }, "updated_at" : { "$date" : "2010-04-12T23:10:46.353+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c65f627d6b0586a4e3" }, "external_id" : "ZOOKEEPER-743", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Diagram error on Zookeeper internals page", "desc" : "http://hadoop.apache.org/zookeeper/docs/r3.1.2/zookeeperInternals.html\n\nIn the active messaging diagram, one of the commit arrows is going the wrong way.", "created_at" : { "$date" : "2010-04-16T14:20:02.818+0000" }, "updated_at" : { "$date" : "2010-04-16T14:20:02.818+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c75f627d6b0586a4e4" }, "external_id" : "ZOOKEEPER-745", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython documentation", "desc" : "zkpython deserves better documentation than the README I have given it. This jira is for tracking a document that includes at a minimum:\n\n1. Installation instructions\n2. Basic usage instructions, including common idiomatic use\n3. API reference\n\n", "created_at" : { "$date" : "2010-04-21T17:35:54.500+0000" }, "updated_at" : { "$date" : "2010-04-21T17:35:54.500+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c75f627d6b0586a4e6" }, "external_id" : "ZOOKEEPER-678", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Browser application to view and edit the contents of a zookeeper instance", "desc" : "An application which shows a tree view of the nodes currently in a zookeeper instance and allow the user to view and update the contents of the nodes as well as allowing users to add and remove nodes from the tree, similar in use to the Luke application in the Lucene project.\n\nI have a list of other features that I want to add to this application but I wanted to gauge the response before I implemented them all.  I have found this useful when debugging my application and thought that it may be useful to others.\n\nI was going to submit this as a patch file but I have used some icon files and one library which isn't available in the maven/ivy repositories and these don't seem to work when creating a patch file using subversion.  Because of this I have attached a zip containing this application to this issue.  If there is a better way to submit this please let me know.\n\nThe zip contains two directories, the src directory contains the source as it would be added to the contrib folder and the build folder contains a build version of the with a runnable jar.", "created_at" : { "$date" : "2010-02-22T20:00:39.363+0000" }, "updated_at" : { "$date" : "2010-04-27T16:17:05.549+0000" }, "creator_id" : { "$oid" : "5b7d50c7e9214a0d1608d8b8" }, "reporter_id" : { "$oid" : "5b7d50c7e9214a0d1608d8b8" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d50c7e9214a0d1608d8b8" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50c75f627d6b0586a4e5" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50c85f627d6b0586a4fd" }, "external_id" : "ZOOKEEPER-757", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython acl/auth usage needs documentation + unit test", "desc" : "\nThe zookeeper   digest authentication and acl scheme needs a bit more documentation. Currently its documented in the programmer guide.\n\n\"\"\"\ndigest uses a username:password string to generate MD5 hash which is then used as an ACL ID identity. Authentication is done by sending the username:password in clear text. When used in the ACL the expression will be the username:base64 encoded SHA1 password digest.\n\"\"\"\n\nhowever its actually the digest of the entire credential that needs to be used.\n\nI've attached a python unit test that sets and verifies an acl on a node.\n\n\n\n\n\n\t\t\n\t\t\n", "created_at" : { "$date" : "2010-04-29T00:13:25.193+0000" }, "updated_at" : { "$date" : "2010-04-29T00:36:22.375+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.0", "3.4.0" ], "components" : [ "contrib-bindings", "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "ubuntu karmic / lucid  ... sun jdk 1.6.0_20 " },
{ "_id" : { "$oid" : "5b7d50c95f627d6b0586a509" }, "external_id" : "ZOOKEEPER-707", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c95f627d6b0586a50a" }, "external_id" : "ZOOKEEPER-768", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython segfault on close (assertion error in io thread)", "desc" : "While trying to create a test case showing slow average add_auth, i stumbled upon a test case that reliably segfaults for me, albeit with variable amount of iterations (anwhere from 0 to 20 typically). fwiw, I've got about 220 processes in my test environment (ubuntu lucid 10.04). The test case opens a connection, adds authentication to it, and closes the connection, in a loop. I'm including the sample program and the gdb stack traces from the core file. I can upload the core file if thats helpful.", "created_at" : { "$date" : "2010-05-06T16:05:55.266+0000" }, "updated_at" : { "$date" : "2010-05-06T22:13:59.778+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50c95f627d6b0586a509" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "ubuntu lucid (10.04), zookeeper trunk (java/c/zkpython)" },
{ "_id" : { "$oid" : "5b7d50c95f627d6b0586a518" }, "external_id" : "ZOOKEEPER-588", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove unnecessary/annoying log of tostring error in Request.toString()", "desc" : "Why are we logging this? It's unnecessary and just annoying afaict. We should remove it entirely.\n\n2009-11-18 05:37:29,312 WARN org.apache.zookeeper.server.Request: Ignoring exception during toString\njava.nio.BufferUnderflowException\n\tat java.nio.HeapByteBuffer.get(HeapByteBuffer.java:127)\n\tat java.nio.ByteBuffer.get(ByteBuffer.java:675)\n\tat org.apache.zookeeper.server.Request.toString(Request.java:199)\n\tat java.lang.String.valueOf(String.java:2827)\n\tat java.lang.StringBuilder.append(StringBuilder.java:115)\n\tat org.apache.zookeeper.server.quorum.CommitProcessor.processRequest(CommitProcessor.java:167)\n\tat org.apache.zookeeper.server.quorum.FollowerRequestProcessor.run(FollowerRequestProcessor.java:68)\n", "created_at" : { "$date" : "2009-11-21T23:23:59.586+0000" }, "updated_at" : { "$date" : "2010-05-07T17:39:56.954+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [ "logging" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d508a5f627d6b05869f48" }, "external_id" : "ZOOKEEPER-587", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "components" : [ "c client", "java client" ], "labels" : [ "logging" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d508a5f627d6b05869f49" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-11-21T23:21:29.076+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2010-05-07T17:40:07.587+0000" }, "title" : "client should log timeout negotiated with server", "issue_type" : "Bug", "desc" : "The ZK client should log the timeout negotiated with the server if the time is different than the timeout parameter specified by the client.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50785f627d6b05869cfa" }, "external_id" : "ZOOKEEPER-565", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "labels" : [ "logging" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50765f627d6b05869ce7" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-10-28T20:47:42.831+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "updated_at" : { "$date" : "2010-05-07T17:40:16.184+0000" }, "title" : "Revisit some java client log messages", "issue_type" : "Improvement", "desc" : "As discussed during the 10/23 meeting, some messages in the java client logs are mixing up terms from different levels. For example:\n\n{code}\n2009-10-14 15:12:43,566 WARN org.apache.zookeeper.ClientCnxn: Exception closing session 0x1244f619478000d to sun.nio.ch.SelectionKeyImpl@15e32c4\njava.io.IOException: Session Expired\n   at org.apache.zookeeper.ClientCnxn$SendThread.readConnectResult(ClientCnxn.java:589)\n   at org.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:709)\n   at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:945)\n{code}\n\nWhich session are we talking about in the first line? Now I know that it's a network-related session and not the ZK one, but I've seen many of our users getting confused over those lines. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50785f627d6b05869cf9" }, "external_id" : "ZOOKEEPER-564", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "labels" : [ "logging" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50765f627d6b05869ce7" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-10-28T20:42:45.600+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "updated_at" : { "$date" : "2010-05-07T17:40:21.246+0000" }, "title" : "Give more feedback on that current flow of events in java client logs", "issue_type" : "Improvement", "desc" : "As discussed during the 10/23 meeting, one issue we have in debugging ZK client logs with HBase is that we have a hard time following the flow of events. It may be obvious for a ZK dev, but in our POV that kind of trace isn't very intuitive:\n\n{code}\n2009-09-27 15:41:10,776 INFO org.apache.zookeeper.ClientCnxn: Attempting connection to server ...\n2009-09-27 15:41:10,776 INFO org.apache.zookeeper.ClientCnxn: Priming connection to java.nio.channels.SocketChannel[connected local=/ ... remote=...\n2009-09-27 15:41:10,776 INFO org.apache.zookeeper.ClientCnxn: Server connection successful \n2009-09-27 15:41:10,784 WARN org.apache.zookeeper.ClientCnxn: Exception closing session 0x0 to sun.nio.ch.SelectionKeyImpl@2c9b42e6\n{code}\n\nThis excerpt is just an example. We would like to see something like a numbering of the events and possibly, in the case of an exception, at which point did it went wrong and what's the next step.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50cc5f627d6b0586a556" }, "external_id" : "ZOOKEEPER-518", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "DEBUG message for outstanding proposals in leader should be moved to trace.", "desc" : "this is the code in Leader.java \n{code}\n if (LOG.isDebugEnabled()) {\n            LOG.debug(\"Ack zxid: 0x\" + Long.toHexString(zxid));\n            for (Proposal p : outstandingProposals.values()) {\n                long packetZxid = p.packet.getZxid();\n                LOG.debug(\"outstanding proposal: 0x\"\n                        + Long.toHexString(packetZxid));\n            }\n            LOG.debug(\"outstanding proposals all\");\n        }\n\n{code}\n\nWe should move this debug to trace since it will cause really high latencies in response times from zookeeper servers in case folks want to use DEBUG logging for servers.\n", "created_at" : { "$date" : "2009-08-25T23:38:34.209+0000" }, "updated_at" : { "$date" : "2010-05-07T17:40:27.856+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Test", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "4.0.0" ], "components" : [ "tests" ], "labels" : [ "logging" ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "Non specific" },
{ "_id" : { "$oid" : "5b7d50cd5f627d6b0586a570" }, "external_id" : "ZOOKEEPER-495", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client logs an invalid error when zookeeper_init is called with chroot", "desc" : "The C client logs this error message when zookeeper_init is called with chroot. \n\n2009-08-03 18:14:29,130:6624(0x5e66e950):ZOO_ERROR@sub_string@730: server path  does not include chroot path /chroot\n\nI'll attach a simple program to reproduce this.\n\nThanks!\n--Michi", "created_at" : { "$date" : "2009-08-03T18:20:00.198+0000" }, "updated_at" : { "$date" : "2010-05-07T17:40:33.540+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [ "logging" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50cd5f627d6b0586a582" }, "external_id" : "ZOOKEEPER-62", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Generally improve logging to enable debuggability in the field.", "desc" : "We need to improve our logging to enable debugging of field issues.\n\nFlavio, assigning to you as you are currently looking at some client/server issues that could benefit from better logging. Please attach patches if you see potential areas for improvement.", "created_at" : { "$date" : "2008-06-30T22:03:29.853+0000" }, "updated_at" : { "$date" : "2010-05-07T17:40:39.272+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [ "logging" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ce5f627d6b0586a58e" }, "external_id" : "ZOOKEEPER-771", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython return without exception set on invalid auth scheme", "desc" : "If you attempt to utilize an invalid auth scheme when adding authentication, you'll end up with an error return value in your callback. But the handle itself will be hosed,  attempting to utilize it with any part of the api will return\n\nSystemError: error return without exception set\n\n\n\n\n", "created_at" : { "$date" : "2010-05-07T19:51:48.685+0000" }, "updated_at" : { "$date" : "2010-05-07T20:07:49.778+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "ubuntu lucid" },
{ "_id" : { "$oid" : "5b7d50cf5f627d6b0586a592" }, "external_id" : "ZOOKEEPER-781", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50cf5f627d6b0586a593" }, "external_id" : "ZOOKEEPER-779", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C Client should check the connectivity to the hosts in zookeeper_init", "desc" : "In some scenario, whether the client can connect to zookeeper servers is used as a logic condition. If the client cannot connect to the servers, the program should turn to another fork. However, current zookeeper_init could not tell whether the client can connect to one server or not. It could make some users feel confused. I think we should check the connectivity to the host in zookeeper_init, so we can tell whether the hosts are avaiable at that time or not.", "created_at" : { "$date" : "2010-05-23T03:00:29.468+0000" }, "updated_at" : { "$date" : "2010-05-26T18:00:49.245+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50cf5f627d6b0586a592" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d4fa75f627d6b05868979" }, "external_id" : "ZOOKEEPER-119", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fa75f627d6b0586897a" }, "effect" : "relates to", "type" : "Reference" } ], "created_at" : { "$date" : "2008-08-11T18:10:59.099+0000" }, "updated_at" : { "$date" : "2010-06-14T23:43:51.140+0000" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "priority" : "Major", "title" : "Reserve \".zookeeper\" node for server use.", "issue_type" : "New Feature", "desc" : "The server should not allow clients to create .zookeeper nodes in the node hierarchy. These nodes should be reserved for zk future use, some ideas:\n\n* /.zookeeper/proc\n* /.zookeeper/stats\n* /.zookeeper/...\n\n* /.../.zookeeper/... (disallow both at root as well as child nodes)\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50d05f627d6b0586a5ba" }, "external_id" : "ZOOKEEPER-791", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Watches get triggered during client's reconnection", "desc" : "I start 2 of 3 servers of an ensemble, connect to it with zkCli.sh, do \"ls / 1\" which registers a watch.\nThen I kill one of 2 servers which makes alive one to lose a quorum and forces client to reconnect. \n\nAnd when the client connects to this alive server (but gets quickly dropped by the server afterwards), watch is triggered:\nWatchedEvent state:SyncConnected type:NodeChildrenChanged path:/ \n\nI can reproduce it only with command-line client, and quite rarely. I tried to write unit test, but id didn't catch this.\nHas anybody seen this before?", "created_at" : { "$date" : "2010-06-24T12:20:18.365+0000" }, "updated_at" : { "$date" : "2010-06-24T12:22:18.085+0000" }, "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d15f627d6b0586a5be" }, "external_id" : "ZOOKEEPER-803", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improve defenses against misbehaving clients", "desc" : "This issue is in response to ZOOKEEPER-801. Short version is a small number of buggy clients opened thousands of connections and caused Zookeeper to fail.\n\nThe misbehaving client did not correctly handle expired sessions, creating a new connection each time. The huge number of connections exacerbated the issue.", "created_at" : { "$date" : "2010-07-02T20:52:47.845+0000" }, "updated_at" : { "$date" : "2010-07-03T03:03:19.205+0000" }, "creator_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "reporter_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50d15f627d6b0586a5bd" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50d15f627d6b0586a5bd" }, "external_id" : "ZOOKEEPER-801", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50d25f627d6b0586a5c4" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50d15f627d6b0586a5be" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "created_at" : { "$date" : "2010-07-01T16:39:17.996+0000" }, "priority" : "Major", "desc" : "[Moving a thread from the zookeeper-user]\n\nRECOVERY\nWe eventually recovered from this situation by shutting down clients. Initially I tried restarting the Zookeepers, however, they were getting hammered and I believe sessions timing out. I shut down ~2k clients (lightweight python app; simply sets one data watch and takes an action when it changes) at which point zktop could make a connection and a leader election was verified. After resetting latency stats the numbers were very good. I do not believe it would have ever recovered without shedding load.\n\n\nQUORUM/ELECTIONS DURING EVENT\nUnfortunately I do not have logs from the event :( We had debug logging on, and logrotate configured to keep 10 100MB files, and the interesting parts rotated away. I have already switched to info logging so we don't lose this data again.\n\nDuring the incident I was not able to view cluster status with zktop, and never observed a successful operation beyond connections, which quickly timed out.\n\n\nGC PAUSE/LOGGING\nThis is a very good question. No, Zookeeper GC is not tuned and uses whatever the defaults are in the start scripts. GC logging is not enabled either. I filed an internal bug against myself to enable logging, and tune GC.\n\n\nCLIENT SESSION TIMEOUTS\nClients are not explicitly setting timeouts, and I believe sessionTimeout is 10 seconds based on this log entry when initially connecting.\n\n2010-07-01 05:14:00,260:44267(0x2af330240110):ZOO_INFO@zookeeper_init@727: Initiating client connection, host=10.209.21.133:2181,10.209.21.175:2181,10.209.21.181:2181 sessionTimeout=10000 watcher=(nil) sessionId=0 sessionPasswd=<null> context=(nil) flags=0\n\n\nCLIENT BACKOFFS\nLooking in application logs, we see lots of the following:\n\n2010-07-01 05:13:14,674:41491(0x41ebf940):ZOO_ERROR@handle_socket_error_msg@1528: Socket [10.209.21.181:2181] zk retcode=-7, errno=110(Connection timed out): connection timed out (exceeded timeout by 0ms)\n\nDoing some simple aggregations we see 130 errors in a ~13 minute sample period. This behavior on thousands of clients appears to have been a DDoS attack against Zookeeper. Using exponential behavior as the default behavior seems appropriate looking at this data.\n\nFulltext of the client errors is attached. I grepped \"errno\" from a Python client log; I believe it uses the same underlying C library, so I did not include example output from a C program (though I can if needed). It looks basically the same.\n\n\nGOING FORWARD\nThe long-GC pause causing clients to dogpile sounds like the most plausible explanation at this time. GC logging/tuning is clearly where I dropped the ball, just using the defaults; I don't think any changes should be made related to lack of tuning.\n\nExponential backoffs does seem like a good idea, and generally useful for most people. There will always be service interruptions and backoffs would be a great preventive measure to get out of a dogpile situation.\n\n\n\nPatrick's message:\n\"\"\"\nHi Travis, as Flavio suggested would be great to get the logs. A few questions:\n\n1) how did you eventually recover, restart the zk servers?\n\n2) was the cluster losing quorum during this time? leader re-election?\n\n3) Any chance this could have been initially triggered by a long GC pause on one of the servers? (is gc logging turned on, any sort of heap monitoring?) Has the GC been tuned on the servers, for example CMS and incremental?\n\n4) what are the clients using for timeout on the sessions?\n\n3.4 probably not for a few months yet, but we are planning for a 3.3.2 in a few weeks to fix a couple critical issues (which don't seem related to what you saw). If we can identify the problem here we should be able to include it in any fix release we do.\n\nfixing something like 517 might help, but it's not clear how we got to this state in the first place. fixing 517 might not have any effect if the root cause is not addressed. 662 has only ever been reported once afaik, and we weren't able to identify the root cause for that one.\n\nOne thing we might also consider is modifying the zk client lib to backoff connection attempts if they keep failing (timing out say). Today the clients are pretty aggressive on reconnection attempts. Having some sort of backoff (exponential?) would provide more breathing room to the server in this situation.\n\nPatrick\n\"\"\"\n\nFlavio's message:\n\"\"\"\nHi Travis, Do you think it would be possible for you to open a jira and upload your logs?\n\nThanks,\n-Flavio\n\"\"\"\n\nMy initial message:\n\"\"\"\nHey zookeepers -\n\nWe just experienced a total zookeeper outage, and here's a quick\npost-mortem of the issue, and some questions about preventing it going\nforward. Quick overview of the setup:\n\n- RHEL5 2.6.18 kernel\n- Zookeeper 3.3.0\n- ulimit raised to 65k files\n- 3 cluster members\n- 4-5k connections in steady-state\n- Primarily C and python clients, plus some java\n\nIn chronological order, the issue manifested itself as alert about RW\ntests failing. Logs were full of too many files errors, and the output\nof netstat showed lots of CLOSE_WAIT and SYN_RECV sockets. CPU was\n100%. Application logs showed lots of connection timeouts. This\nsuggests an event happened that caused applications to dogpile on\nZookeeper, and eventually the CLOSE_WAIT timeout caused file handles\nto run out and basically game over.\n\nI looked through lots of logs (clients+servers) and did not see a\nclear indication of what happened. Graphs show a sudden decrease in\nnetwork traffic when the outage began, zookeeper goes cpu bound, and\nruns our of file descriptors.\n\nClients are primarily a couple thousand C clients using default\nconnection parameters, and a couple thousand python clients using\ndefault connection parameters.\n\nDigging through Jira we see two issues that probably contributed to this outage:\n\n   https://issues.apache.org/jira/browse/ZOOKEEPER-662\n   https://issues.apache.org/jira/browse/ZOOKEEPER-517\n\nBoth are tagged for the 3.4.0 release. Anyone know if that's still the\ncase, and when 3.4.0 is roughly scheduled to ship?\n\nThanks!\nTravis\n\"\"\"", "reporter_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "resolution" : "Not A Problem", "creator_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "updated_at" : { "$date" : "2010-07-03T03:03:19.254+0000" }, "title" : "Zookeeper outage post-mortem", "issue_type" : "Improvement", "environment" : "- RHEL5 2.6.18 kernel\n- Zookeeper 3.3.0\n- ulimit raised to 65k files\n- 3 cluster members\n- 4-5k connections in steady-state\n- Primarily C and python clients, plus some java", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d50d25f627d6b0586a5d9" }, "external_id" : "ZOOKEEPER-613", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add ganglia monitoring support as contrib", "desc" : "It would be great to add ganglia monitoring support for ZooKeeper Cluster. AFAIK this means writing a ganglia plugin that knows\nhow to talk to ZK servers (either JMX, or the command port via 4letterwords)\n", "created_at" : { "$date" : "2009-12-07T19:28:24.257+0000" }, "updated_at" : { "$date" : "2010-07-05T18:27:39.835+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib", "scripts" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50d25f627d6b0586a5d8" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50d35f627d6b0586a5e2" }, "external_id" : "ZOOKEEPER-165", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: \"Monitoring\"", "desc" : "Content/information needed on how to Monitor a zooKeeper deployment. I think we can talk about jmx, etc", "created_at" : { "$date" : "2008-10-06T14:14:53.187+0000" }, "updated_at" : { "$date" : "2010-07-09T15:36:53.415+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d50d35f627d6b0586a5e4" }, "external_id" : "ZOOKEEPER-702", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d35f627d6b0586a5e5" }, "external_id" : "ZOOKEEPER-810", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Failure Detector Model: Write Forrest docs", "desc" : "Write forrest docs about the Failure Detector Model implementation. \n\nThis documentation should help one to understand how the failure detection model works on ZooKeeper, both on client and server sides. The usage and configuration of this feature should also be addressed in this documentation.", "created_at" : { "$date" : "2010-07-12T06:44:16.282+0000" }, "updated_at" : { "$date" : "2010-07-12T06:44:16.282+0000" }, "creator_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "reporter_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d35f627d6b0586a5e4" } },
{ "_id" : { "$oid" : "5b7d50d45f627d6b0586a5e6" }, "external_id" : "ZOOKEEPER-812", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Failure Detector Model: Evaluate QoS metrics", "created_at" : { "$date" : "2010-07-12T07:03:17.289+0000" }, "updated_at" : { "$date" : "2010-07-12T07:03:17.289+0000" }, "creator_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "reporter_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d35f627d6b0586a5e4" } },
{ "_id" : { "$oid" : "5b7d50d55f627d6b0586a5e8" }, "external_id" : "ZOOKEEPER-817", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve the efficiency of tracing", "desc" : "Zookeeper uses two kinds of logs, logs for information and debugging (the ones considered in this project) and transaction logs (need for Zab/Paxos to be fault tolerant); the latter are very efficient so the idea would be to make the first likewise using similar mechanisms.", "created_at" : { "$date" : "2010-07-16T15:00:05.812+0000" }, "updated_at" : { "$date" : "2010-07-16T15:00:05.812+0000" }, "creator_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "reporter_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d55f627d6b0586a5e7" } },
{ "_id" : { "$oid" : "5b7d50d55f627d6b0586a5e9" }, "external_id" : "ZOOKEEPER-818", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve the traces with additional information needed ", "desc" : "The current traces do not include all the information we need to do the checking. The main additions would be to log the replies and hashes of values read/written.", "created_at" : { "$date" : "2010-07-16T15:01:40.733+0000" }, "updated_at" : { "$date" : "2010-07-16T15:01:40.733+0000" }, "creator_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "reporter_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d55f627d6b0586a5e7" } },
{ "_id" : { "$oid" : "5b7d50d65f627d6b0586a5ea" }, "external_id" : "ZOOKEEPER-819", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "build the checking tool", "desc" : "Building the checking tool is the hardest part of the project. It involves putting the traces together in a unified trace and checking if this unified trace shows that Zookeeper is satisfying a set of properties (e.g., a getData returns what was stored by the previous setData or create).", "created_at" : { "$date" : "2010-07-16T15:03:17.302+0000" }, "updated_at" : { "$date" : "2010-07-16T15:03:17.302+0000" }, "creator_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "reporter_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d55f627d6b0586a5e7" } },
{ "_id" : { "$oid" : "5b7d50d55f627d6b0586a5e7" }, "external_id" : "ZOOKEEPER-816", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "created_at" : { "$date" : "2010-07-16T14:55:29.377+0000" }, "updated_at" : { "$date" : "2010-07-20T20:48:28.627+0000" }, "reporter_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "creator_id" : { "$oid" : "5b7d50d5e9214a0d1608d8c0" }, "priority" : "Minor", "title" : "Detecting and diagnosing elusive bugs and faults in Zookeeper", "issue_type" : "New Feature", "desc" : "Complex distributed systems like Zookeeper tend to fail in strange ways that are hard to diagnose. The objective is to build a tool that helps understand when and where these problems occurred based on Zookeeper's traces (i.e., logs in TRACE level). Minor changes to the server code will be needed.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50d75f627d6b0586a5f4" }, "external_id" : "ZOOKEEPER-826", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cli.c should not call zoo_add_auth immediately after zookeeper_init() ", "desc" : "In cli.c, zoo_add_auth() gets called right after zookeeper_init(). Instead, zoo_add_auth() should be called in the callback after the connection is established. \n\n--Michi", "created_at" : { "$date" : "2010-07-21T07:13:00.514+0000" }, "updated_at" : { "$date" : "2010-07-21T09:06:55.196+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d85f627d6b0586a5f7" }, "external_id" : "ZOOKEEPER-811", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Failure Detector Model: Refactor server to server monitoring", "desc" : "Refactor server to server failure detection code to use the FailureDetector interface proposed in the parent JIRA. The failure detection method and its parameters should also be configurable in this case. \n\nPatches submitted in this JIRA use the latest patch of the parent JIRA as baseline.", "created_at" : { "$date" : "2010-07-12T06:51:12.720+0000" }, "updated_at" : { "$date" : "2010-07-29T18:26:53.660+0000" }, "creator_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "reporter_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d35f627d6b0586a5e4" } },
{ "_id" : { "$oid" : "5b7d50d85f627d6b0586a5fb" }, "external_id" : "ZOOKEEPER-841", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stat is returned by parameter", "desc" : "Since one can return only one value in java it's the only choice to do so. \nStill it feels more like C then like Java. However with operator classes one \ncould simply get the result values with getter functions after the execution.", "created_at" : { "$date" : "2010-08-11T14:57:44.146+0000" }, "updated_at" : { "$date" : "2010-08-11T14:59:02.173+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50d95f627d6b0586a5ff" }, "external_id" : "ZOOKEEPER-842", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stat calls static method on org.apache.zookeeper.server.DataTree", "desc" : "It's a huge jump from client code to the internal server class DataTree. \nShouldn't there rather be some class related to the protobuffer stat class \nthat knows how to copy a stat?\n", "created_at" : { "$date" : "2010-08-11T15:34:48.684+0000" }, "updated_at" : { "$date" : "2010-08-11T15:35:40.007+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50da5f627d6b0586a605" }, "external_id" : "ZOOKEEPER-843", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Session class?", "desc" : "Maybe it'd make sense to combine hostlist, sessionId, sessionPassword and \nsessionTimeout in a Session class so that the ctor of ClientCnxn won't get too \nlong?", "created_at" : { "$date" : "2010-08-11T15:36:23.784+0000" }, "updated_at" : { "$date" : "2010-08-11T15:57:35.536+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50d95f627d6b0586a604" }, "effect" : "is blocked by", "type" : "Blocker" } ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50da5f627d6b0586a60b" }, "external_id" : "ZOOKEEPER-840", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "massive code duplication in zookeeper class", "desc" : "Each operation calls validatePath, handles the chroot, calls ClientCnxn and \nchecks the return header for error. I'd like to address this with the \noperation classes:\nEach operation should receive a prechecked Path object. Calling ClientCnxn and \nerror checking is not (or only partly) the concern of the operation but of an \n\"executor\" like class.", "created_at" : { "$date" : "2010-08-11T14:56:10.896+0000" }, "updated_at" : { "$date" : "2010-08-16T12:20:13.049+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50dc5f627d6b0586a612" }, "external_id" : "ZOOKEEPER-701", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "GSoC 2010: Monitoring Recipes and Web-based Administrative Interface", "desc" : "Monitoring Recipes And Web-based Administrative Interface\nMentor: Patrick Hunt (phunt@apache.org)\n\nRequirements:\nModern web platform - e.g. Django. Some design or UI skills would help. Java for adding methods to ZooKeeper.\n\nDescription:\nZooKeeper is a complex distributed system. Understanding how well it is running is tremendously important. Patrick Hunt has created a Django-based dashboard (see http://github.com/phunt/zookeeper_dashboard) that allows some insight into how ZooKeeper is running. This is a great foundation on which to build; however there are improvements that could be made! This project would capture much more information from ZooKeeper, adding hooks to retrieve it where necessary and visualise it in a appealing and useful way. Integration with Ganglia would be a definite plus.\n\n", "created_at" : { "$date" : "2010-03-13T00:42:39.493+0000" }, "updated_at" : { "$date" : "2010-08-18T06:59:54.591+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [ "gsoc", "mentor" ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a610" }, "effect" : "requires", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a611" }, "effect" : "requires", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a60f" }, "effect" : "requires", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50d25f627d6b0586a5d8" }, "effect" : "requires", "type" : "Required" } ] },
{ "_id" : { "$oid" : "5b7d50dc5f627d6b0586a62b" }, "external_id" : "ZOOKEEPER-858", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper appears as QuorumPeerMain in jps output, which is not very user-friendly", "desc" : "As noted by Jordan Sissel on Twitter: http://twitter.com/jordansissel/status/22570450969", "created_at" : { "$date" : "2010-08-31T02:18:59.894+0000" }, "updated_at" : { "$date" : "2010-08-31T10:27:34.214+0000" }, "creator_id" : { "$oid" : "5b7d4f94e9214a0d1608d87c" }, "reporter_id" : { "$oid" : "5b7d4f94e9214a0d1608d87c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50dd5f627d6b0586a62e" }, "external_id" : "ZOOKEEPER-865", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Runaway thread", "desc" : "I'm starting a standalone Zookeeper server (v3.3.1).  That starts normally and does not have a runaway thread.\n\nNext, I start an based Eclipse application that is using ZK 3.3.0 to register itself with the ZooKeeper server (3.3.1).  The Eclipse application using the following arguments to Eclipse:\n\n-Dzoodiscovery.autoStart=true\n-Dzoodiscovery.flavor=zoodiscovery.flavor.centralized=smccants.austin.ibm.com\n\nWhen the Eclipse application starts, the ZK server prints out:\n\n2010-09-03 09:59:46,006 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@250] - Accepted socket connection from /9.53.189.11:42271\n2010-09-03 09:59:46,039 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@776] - Client attempting to establish new session at /9.53.189.11:42271\n2010-09-03 09:59:46,045 - INFO  [SyncThread:0:NIOServerCnxn@1579] - Established session 0x12ad81b90000002 with negotiated timeout 4000 for client /9.53.189.11:42271\n2010-09-03 09:59:46,046 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@250] - Accepted socket connection from /9.53.189.11:42272\n2010-09-03 09:59:46,078 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@776] - Client attempting to establish new session at /9.53.189.11:42272\n2010-09-03 09:59:46,080 - INFO  [SyncThread:0:NIOServerCnxn@1579] - Established session 0x12ad81b90000003 with negotiated timeout 4000 for client /9.53.189.11:42272\n\nThen both the Eclipse application and the ZK server go into runaway states and consume 100% of the CPU.\n\nHere is a view from top:\n\n  PID USER        PR  NI  VIRT    RES  SHR S %CPU %MEM    TIME+  COMMAND\n4949 smccants  15   0  597m  78m 5964 S    66.2      1.0      1:03.14 autosubmitter\n4876 smccants  17   0  554m  27m 6688 S    30.9       0.3     0:34.74 java\n\nPID 4949 (autosubmitter) is the Eclipse application and is using more than twice the CPU of PID 4876 (java) which is the ZK server.  They will continue in this state indefinitely.\n\nI can attach a debugger to the Eclipse application and if I stop the thread named \"pool-1-thread-2-SendThread(smccants.austin.ibm.com:2181)\" and the runaway condition stops on both the application and ZK server.  However the ZK server reports:\n\n2010-09-03 10:03:38,001 - INFO  [SessionTracker:ZooKeeperServer@315] - Expiring session 0x12ad81b90000003, timeout of 4000ms exceeded\n2010-09-03 10:03:38,002 - INFO  [ProcessThread:-1:PrepRequestProcessor@208] - Processed session termination for sessionid: 0x12ad81b90000003\n2010-09-03 10:03:38,005 - INFO  [SyncThread:0:NIOServerCnxn@1434] - Closed socket connection for client /9.53.189.11:42272 which had sessionid 0x12ad81b90000003\n\nHere is the stack trace from the suspended thread:\n\nEPollArrayWrapper.epollWait(long, int, long, int) line: not available [native method]\t\nEPollArrayWrapper.poll(long) line: 215\t\nEPollSelectorImpl.doSelect(long) line: 77\t\nEPollSelectorImpl(SelectorImpl).lockAndDoSelect(long) line: 69\t\nEPollSelectorImpl(SelectorImpl).select(long) line: 80\t\nClientCnxn$SendThread.run() line: 1066\t\n\nAny ideas what might be going wrong?\n\nThanks.", "created_at" : { "$date" : "2010-09-03T15:07:05.561+0000" }, "updated_at" : { "$date" : "2010-09-03T15:09:30.065+0000" }, "creator_id" : { "$oid" : "5b7d50dde9214a0d1608d8c2" }, "reporter_id" : { "$oid" : "5b7d50dde9214a0d1608d8c2" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Open", "affects_versions" : [ "3.3.1", "3.3.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dd5f627d6b0586a62d" }, "effect" : "blocks", "type" : "Blocker" } ], "environment" : "Linux; Java 1.6; x86;" },
{ "_id" : { "$oid" : "5b7d50de5f627d6b0586a632" }, "external_id" : "ZOOKEEPER-604", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zk needs to prevent export of any symbol not listed in their api", "desc" : "Currently the zookeeper seems to be exporting symbols not in the api. An example of this seems to be the symbol hash, which interferes with me using memcached and zookeeper in the same program.", "created_at" : { "$date" : "2009-12-01T21:01:58.757+0000" }, "updated_at" : { "$date" : "2010-09-03T17:21:25.590+0000" }, "creator_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "reporter_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.2.0", "4.0.0", "3.2.1", "3.2.2", "3.1.0", "3.3.0", "3.1.2", "3.0.1", "3.1.1", "3.0.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50de5f627d6b0586a631" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "All" },
{ "_id" : { "$oid" : "5b7d50de5f627d6b0586a631" }, "external_id" : "ZOOKEEPER-295", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.1.0", "3.0.0" ], "components" : [ "c client" ], "fix_versions" : [ "4.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50de5f627d6b0586a632" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2009-02-05T19:45:25.224+0000" }, "updated_at" : { "$date" : "2010-09-03T17:21:25.531+0000" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "priority" : "Major", "title" : "prevent multiple namespace pollution by C API", "issue_type" : "Improvement", "desc" : "The ZOOKEEPER-6 issue touched on the problem of namespace pollution by the ZooKeeper C API; this report was closed but I don't think the problem has actually been substantially resolved.\n\nThere are multiple namespaces to consider.  First, the names of the C include files should ideally have a common prefix, e.g., zoo_recordio.h, or else be concatenated into a single zookeeper.h file.  The zookeeper.jute.h include file has a reasonably good name in this regard.\n\nSecond, all macros should ideally have a common prefix, e.g., ZOO_ or ZK_ or ZOOKEEPER_.  Currently many exported constants (not macros) have the ZOO_ prefix, such as ZOO_PERM_READ, but error codes have a Z prefix, e.g., ZOK, ZNOTEMPTY.\n\nThird, all functions should ideally have a common prefix, e.g., zoo_ or zk_ or zookeeper_.  Many do already, but there is some variation, such as zookeeper_init(), zookeeper_process(), and there are also a large number of functions which have no prefix.  These include many of the functions defined in recordio.h and zookeeper.jute.h, such as get_buffer() and serialize_Id().  Many others are simply used internally within the ZooKeeper C library and not declared in an external include file, but still pollute the caller's namespace, e.g., get_xid(), process_completions(), adaptor_init(), etc.  All external symbols in the libraries should have a common prefix.\n\nFourth, all structure and type definitions should also have a common prefix, again, zoo_ or zk_ or zookeeper_.  This is especially true of structures which currently have very generic names such as Id, Stat, and ACL from zookeeper.jute.h; buffer, iarchive, and oarchive from recordio.h; and clientid_t and watcher_fn from zookeeper.h.  The zhandle_t structure should also be renamed to have the same prefix, e.g., zoo_handle_t.\n\nThe ZOOKEEPER-6 report includes the comment that the names in zookeeper.jute.h will be difficult to change because they affect the Java code and that there should be \"limited exposure since jute naming starts with caps\".  It would be nice to think so, but I fear that a structure named Id or Stat is going to be pretty darn commonplace in other people's code.  I would strongly recommend revising the entire set file, function, macro, type and structure names for 4.0.0.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50dd5f627d6b0586a62d" }, "external_id" : "ZOOKEEPER-863", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dd5f627d6b0586a62e" }, "effect" : "is blocked by", "type" : "Blocker" } ], "priority" : "Critical", "created_at" : { "$date" : "2010-09-03T14:33:42.750+0000" }, "updated_at" : { "$date" : "2010-09-03T18:52:11.514+0000" }, "reporter_id" : { "$oid" : "5b7d50dde9214a0d1608d8c2" }, "creator_id" : { "$oid" : "5b7d50dde9214a0d1608d8c2" }, "issue_type" : "Bug", "title" : "Runaway thread - Zookeeper inside Eclipse", "desc" : "I'm running Zookeeper inside an Eclipse application.  When I launch the application from inside Eclipse I use the following arguments:\n\n-Dzoodiscovery.autoStart=true\n-Dzoodiscovery.flavor=zoodiscovery.flavor.centralized=localhost\n\nThis causes the application to start its own ZooKeeper server inside the JVM/application.  It immediately goes into a runaway state.  The name of the runaway thread is \"NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181\".  When I suspend this thread, the CPU usage returns to 0.  Here is a stack trace from that thread when it is suspended:\n\nEPollArrayWrapper.epollWait(long, int, long, int) line: not available [native method]\t\nEPollArrayWrapper.poll(long) line: 215\t\nEPollSelectorImpl.doSelect(long) line: 77\t\nEPollSelectorImpl(SelectorImpl).lockAndDoSelect(long) line: 69\t\nEPollSelectorImpl(SelectorImpl).select(long) line: 80\t\nNIOServerCnxn$Factory.run() line: 232\t\n\nAny ideas what might be going wrong?\n\nThanks.", "environment" : "Linux; x86", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50e05f627d6b0586a658" }, "external_id" : "ZOOKEEPER-868", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cleanups from ZOOKEEPER-823 patch", "created_at" : { "$date" : "2010-09-08T17:19:34.413+0000" }, "updated_at" : { "$date" : "2010-09-08T17:23:12.089+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50e05f627d6b0586a65a" }, "external_id" : "ZOOKEEPER-875", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ResponderThread and udpSocket should be move from QuorumPeer to LeaderElection", "desc" : "Part of the algorithm implemented in the class LeaderElection is inside QuorumPeer. Is there any reason for that? ResponderThread and udpSocket belong to LeaderElection class and should be moved in LeaderElection.java. That would make the code look cleaner.", "created_at" : { "$date" : "2010-09-17T17:15:53.510+0000" }, "updated_at" : { "$date" : "2010-09-17T17:15:53.510+0000" }, "creator_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "reporter_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Open", "affects_versions" : [ "3.3.1" ], "components" : [ "leaderElection" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e15f627d6b0586a65c" }, "external_id" : "ZOOKEEPER-869", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Support for election of leader with arbitrary zxid", "desc" : "Currently, the leader election algorithm implemented guarantees that the leader has the maximum zxid of the ensemble. The state synchronization after the election was built based on this assumption. However, other leader elections algorithms might elect leaders with arbitrary zxid. \n\nTo support other leader election algorithms, the state synchronization should allow the leader to have an arbitrary zxid.", "created_at" : { "$date" : "2010-09-14T07:39:07.571+0000" }, "updated_at" : { "$date" : "2010-09-21T13:44:08.433+0000" }, "creator_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "reporter_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e15f627d6b0586a65b" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d50e15f627d6b0586a662" }, "external_id" : "ZOOKEEPER-879", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "outgoingQueue should be a class", "desc" : "I'm not yet 100% sure about this yet, but it seems reasonable to me.\nCurrently outgoingQueue is a simple list. Whether additional items can be added to the queue and the logic to add sth to the queue is handled by ClientCnxn. \n\nclass OutgoingQueue\n- isOpen\n+ add(Packet) / offer(Packet)\n+ poll() / take()\n\nOutgoingQueue must have knowledge about the state of SendThreat and may only accept additional Packets if SendThread has not yet terminated.\nOutgoingQueue knows, when it must call ConnectionLoss on the remaining Packets in its queue.\n", "created_at" : { "$date" : "2010-09-23T08:52:58.533+0000" }, "updated_at" : { "$date" : "2010-09-23T16:08:15.569+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50e25f627d6b0586a664" }, "external_id" : "ZOOKEEPER-889", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "pyzoo_aget_children crashes due to incorrect watcher context", "desc" : "The pyzoo_aget_children function passes the completion callback (\"pyw\") in place of the watcher callback (\"get_pyw\"). Since it is a one-shot callback, it is deallocated after the completion callback fires, causing a crash when the watcher callback should be invoked.\n", "created_at" : { "$date" : "2010-10-07T04:16:01.388+0000" }, "updated_at" : { "$date" : "2010-10-07T04:19:49.335+0000" }, "creator_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "reporter_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "OS X 10.6.5, Python 2.6.1" },
{ "_id" : { "$oid" : "5b7d50e35f627d6b0586a66b" }, "external_id" : "DIRMINA-678", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50575f627d6b05869907" }, "external_id" : "ZOOKEEPER-427", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.1" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e35f627d6b0586a66b" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50575f627d6b05869908" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50e35f627d6b0586a66a" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-06-02T21:01:41.077+0000" }, "priority" : "Blocker", "desc" : "I am running a 5 node ZooKeeper cluster and I noticed that one of them has very high CPU usage:\n\n PID   USER      PR  NI  VIRT  RES  SHR S   %CPU %MEM    TIME+   COMMAND \n 6883  infact       22   0   725m  41m  4188 S   95       0.5          5671:54  java\n\nIt is not \"doing anything\" application-wise at this point, so I was wondering why the heck it's using up so much CPU.", "reporter_id" : { "$oid" : "5b7d50e3e9214a0d1608d8c5" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e3e9214a0d1608d8c5" }, "updated_at" : { "$date" : "2010-10-11T07:34:54.398+0000" }, "title" : "ZooKeeper server unexpectedly high CPU utilisation", "issue_type" : "Bug", "environment" : "Linux: 2.6.18-92.1.18.el5 #1 SMP Wed Nov 12 09:19:49 EST 2008 x86_64 x86_64 x86_64 GNU/Linux\njava version \"1.6.0_03\"\nJava(TM) SE Runtime Environment (build 1.6.0_03-b05)\nJava HotSpot(TM) 64-Bit Server VM (build 1.6.0_03-b05, mixed mode)\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50e35f627d6b0586a68d" }, "external_id" : "ZOOKEEPER-886", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hedwig Server stays in \"disconnected\" state when connection to ZK dies but gets reconnected", "desc" : "The Hedwig Server is connected to ZooKeeper.  In the ZkTopicManager, it registers a watcher so that if it ever gets disconnected from ZK, it will temporarily fail all incoming requests since the Hedwig server does not know for sure if it is still the master for the topics.  When the ZK client gets reconnected, the logic currently is wrong and it does not unset the suspended flag.  Thus once it gets disconnected, it will stay in the suspended state forever, thereby making the Hedwig server hub dead.", "created_at" : { "$date" : "2010-10-05T20:18:00.322+0000" }, "updated_at" : { "$date" : "2010-10-12T10:52:04.521+0000" }, "creator_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "reporter_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e45f627d6b0586a699" }, "external_id" : "ZOOKEEPER-890", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client invokes watcher callbacks multiple times", "desc" : "Code using the C client assumes that watcher callbacks are called exactly once. If the watcher is called more than once, the process will likely overwrite freed memory and/or crash.\n\ncollect_session_watchers (zk_hashtable.c) gathers watchers from active_node_watchers, active_exist_watchers, and active_child_watchers without removing them. This results in watchers being invoked more than once.\n\nTest code is attached that reproduces the bug, along with a proposed patch.", "created_at" : { "$date" : "2010-10-07T07:53:45.689+0000" }, "updated_at" : { "$date" : "2010-10-13T17:11:33.419+0000" }, "creator_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "reporter_id" : { "$oid" : "5b7d4f54e9214a0d1608d875" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e45f627d6b0586a698" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Mac OS X 10.6.5" },
{ "_id" : { "$oid" : "5b7d50e55f627d6b0586a6a5" }, "external_id" : "ZOOKEEPER-894", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add Package o.a.zookeeper.client", "desc" : "I'd like to move classes that are not part of the API but belong to the ZK Client into a separate Client package. These classes are:\n\n- Inner classes that should become normal classes:\n  Zookeeper.ZkWatchManager\n  Zookeeper.WatchRegistration\n  ClientCnxn.SendThread (should become a Runnable anyhow)\n  ClientCnxn.EventThread\n  ClientCnxn.Package\n  ClientCnxn.AuthData ?\n\n- Classes now in the zookeeper package:\n  ClientCnxn -> Client.Cnxn\n  ClientCnxnSocket* -> Client.CnxnSocket*\n  ... Maybe some others that can be moved without breaking the API\n\n- Classes yet to be written:\n  PendingQueue ?\n  OutgoingQueue ?", "created_at" : { "$date" : "2010-10-13T09:51:38.337+0000" }, "updated_at" : { "$date" : "2010-10-13T17:24:02.774+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50e55f627d6b0586a6aa" }, "external_id" : "ZOOKEEPER-916", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Problem receiving messages from subscribed channels in c++ client ", "desc" : "We see this bug with receiving messages from a subscribed channel.  This problem seems to happen with larger messages.  The flow is to first read at least 4 bytes from the socket channel. Extract the first 4 bytes to get the message size.  If we've read enough data into the buffer already, we're done so invoke the messageReadCallbackHandler passing the channel and message size.  If not, then do an async read for at least the remaining amount of bytes in the message from the socket channel.  When done, invoke the messageReadCallbackHandler.\n\nThe problem seems that when the second async read is done, the same sizeReadCallbackHandler is invoked instead of the messageReadCallbackHandler.  The result is that we then try to read the first 4 bytes again from the buffer.  This will get a random message size and screw things up.  I'm not sure if it's an incorrect use of the boost asio async_read function or we're doing the boost bind to the callback function incorrectly.\n\n\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler system:0,512 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: size of buffer before reading message size: 512 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: size of incoming message 599, currently in buffer 508 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: Still have more data to read, 91 from channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler system:0, 91 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: size of buffer before reading message size: 599 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: size of incoming message 134287360, currently in buffer 595 channel(0x80b7a18)\n101015 15:30:40.108 DEBUG hedwig.channel.cpp - DuplexChannel::sizeReadCallbackHandler: Still have more data to read, 134286765 from channel(0x80b7a18)\n", "created_at" : { "$date" : "2010-11-03T09:10:22.219+0000" }, "updated_at" : { "$date" : "2010-11-05T10:52:47.139+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e65f627d6b0586a6b5" }, "external_id" : "ZOOKEEPER-923", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "TaskManagement Using Zookeeper Recipe", "desc" : "A typical use case in distributed system is \" There are T tasks and P processes running but only T processes must be active always [ P > T ]  and remaining P-T processes acting as stand by and be ready to take up a Task with one or more active processes fail\".  \n\nZookeeper provides an excellent service which can be used to co ordinate among P processes and using the mechanism of locking we can ensure that there is always T processes active.  Without a central co-ordinating service generally there will be 2T processes[ i.e atleast one back up for each process].  With Zookeeper we can decide P based on the failure rate.\n\nThe assumption here are\n1. At any time we have P > T. P can be chosen appropriately based on failure rate.\n2. The tasks are stateless. That is any process P_i that takes up a task T_j does not know the state of the process P_k which previously processed T_j.  This is not entirely true and there are ways to over come this draw back on a case by case basis.\n\n\nThis was developed for a different project S4 which is also open sourced http://s4.io/. The communication layer and task management layer is completely independent of S4 and can be used in any application.\n\n\n\n", "created_at" : { "$date" : "2010-11-08T20:17:15.404+0000" }, "updated_at" : { "$date" : "2010-11-08T20:18:15.870+0000" }, "creator_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "reporter_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_type" : "Task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "recipes" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e65f627d6b0586a6b4" }, "effect" : "is cloned by", "type" : "Cloners" } ], "environment" : "Any" },
{ "_id" : { "$oid" : "5b7d50e65f627d6b0586a6b4" }, "external_id" : "ZOOKEEPER-924", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "recipes" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e65f627d6b0586a6b5" }, "effect" : "is cloned by", "type" : "Cloners" } ], "priority" : "Major", "created_at" : { "$date" : "2010-11-08T20:18:14.807+0000" }, "updated_at" : { "$date" : "2010-11-08T20:20:22.397+0000" }, "reporter_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "creator_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_type" : "Task", "title" : "Recipe: Fault tolerant communication layer using Zookeeper", "desc" : "This recipe caters to the following use case\nThere are S(Active) + s(standby) sender nodes and R(Active) + r(standby) receiver nodes. The objective is following\n\n    * If one of the S Active server goes down a standby node should take up the task.\n    * If one of the R Active server goes down a standby node should take up the task.\n    * When there is a change in receiver the Sender must get updated and send the message to correct destination\n\nThis also uses recipe described in  https://issues.apache.org/jira/browse/ZOOKEEPER-923\n\nThis was developed for a different project S4 which is also open sourced http://s4.io/. The communication layer and task management layer is completely independent of S4 and can be used in any application.\n\n\n\n", "environment" : "Any", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50e75f627d6b0586a6b9" }, "external_id" : "ZOOKEEPER-928", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Follower should stop following and start FLE if it does not receive pings from the leader", "desc" : "In Follower.followLeader() after syncing with the leader, the follower does:\n                while (self.isRunning()) {\n                    readPacket(qp);\n                    processPacket(qp);\n                }\n\nIt looks like it relies on socket timeout expiry to figure out if the connection with the leader has gone down.  So a follower *with no cilents* may never notice a faulty leader if a Leader has a software hang, but the TCP connections with the peers are still valid. Since it has no cilents, it won't hearbeat with the Leader. If majority of followers are not connected to any clients, then FLE will fail even if other followers attempt to elect a new leader.\n\nWe should keep track of pings received from the leader and see if we havent seen\na ping packet from the leader for (syncLimit * tickTime) time and give up following the\nleader.", "created_at" : { "$date" : "2010-11-10T20:06:16.880+0000" }, "updated_at" : { "$date" : "2010-11-11T17:07:34.306+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e85f627d6b0586a6d0" }, "external_id" : "ZOOKEEPER-914", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumCnxManager blocks forever ", "desc" : "This was a disaster. While testing our application we ran into a scenario where a rebooted follower could not join the cluster. Further debugging showed that the follower could not join because the QuorumCnxManager on the leader was blocked for indefinite amount of time in receiveConnect()\n\n\"Thread-3\" prio=10 tid=0x00007fa920005800 nid=0x11bb runnable [0x00007fa9275ed000]\n   java.lang.Thread.State: RUNNABLE\n    at sun.nio.ch.FileDispatcher.read0(Native Method)\n    at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:21)\n    at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:233)\n    at sun.nio.ch.IOUtil.read(IOUtil.java:206)\n    at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:236)\n    - locked <0x00007fa93315f988> (a java.lang.Object)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager.receiveConnection(QuorumCnxManager.java:210)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$Listener.run(QuorumCnxManager.java:501)\n\nI had pointed out this bug along with several other problems in QuorumCnxManager earlier in \nhttps://issues.apache.org/jira/browse/ZOOKEEPER-900 and https://issues.apache.org/jira/browse/ZOOKEEPER-822.\n\nI forgot to patch this one as a part of ZOOKEEPER-822. I am working on a fix and a patch will be out soon. \n\nThe problem is that QuorumCnxManager is using SocketChannel in blocking mode. It does a read() in receiveConnection() and a write() in initiateConnection().\n\nSorry, but this is really bad programming. Also, points out to lack of failure tests for QuorumCnxManager.", "created_at" : { "$date" : "2010-10-27T19:54:48.319+0000" }, "updated_at" : { "$date" : "2010-11-12T22:47:19.851+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e95f627d6b0586a6e7" }, "external_id" : "ZOOKEEPER-930", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hedwig c++ client uses a non thread safe logging library", "created_at" : { "$date" : "2010-11-15T09:55:32.601+0000" }, "updated_at" : { "$date" : "2010-11-17T10:55:02.246+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e95f627d6b0586a6f9" }, "external_id" : "ZOOKEEPER-823", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50e95f627d6b0586a6fa" }, "external_id" : "ZOOKEEPER-895", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClientCnxn.authInfo must be thread safe", "desc" : "authInfo can be accessed concurrently by different Threads, as exercised in \norg.apache.zookeeper.test.ACLTest\n\nThe two concurrent access points in this case were (presumably):\norg.apache.zookeeper.ClientCnxn$SendThread.primeConnection(ClientCnxn.java:805) and\norg.apache.zookeeper.ClientCnxn.addAuthInfo(ClientCnxn.java:1121)\n\nThe line numbers refer to the latest patch in ZOOKEEPER-823.\n\nThe exception that pointed to this issue:\n    [junit] 2010-10-13 09:35:55,113 [myid:] - WARN  [main-SendThread(localhost:11221):ClientCnxn$SendThread@713] - Session 0x0 for server localhost/127.0.0.1:11221, unexpected error, closing socket connection and attempting reconnect\n    [junit] java.util.ConcurrentModificationException\n    [junit] \tat java.util.AbstractList$Itr.checkForComodification(AbstractList.java:372)\n    [junit] \tat java.util.AbstractList$Itr.next(AbstractList.java:343)\n    [junit] \tat org.apache.zookeeper.ClientCnxn$SendThread.primeConnection(ClientCnxn.java:805)\n    [junit] \tat org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:247)\n    [junit] \tat org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:694)\n\nProposed solution: Use a thread save list for authInfo", "created_at" : { "$date" : "2010-10-14T07:25:53.986+0000" }, "updated_at" : { "$date" : "2010-11-19T17:40:29.029+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e95f627d6b0586a6f9" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d50ea5f627d6b0586a700" }, "external_id" : "ZOOKEEPER-942", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address hudson configuration change for mailing list", "created_at" : { "$date" : "2010-11-24T17:46:33.644+0000" }, "updated_at" : { "$date" : "2010-11-24T20:57:38.893+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50eb5f627d6b0586a704" }, "external_id" : "ZOOKEEPER-948", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "send mail to the zk mailing lists about the list name changes", "created_at" : { "$date" : "2010-11-24T18:16:33.245+0000" }, "updated_at" : { "$date" : "2010-11-24T20:58:10.771+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50eb5f627d6b0586a708" }, "external_id" : "ZOOKEEPER-944", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "perform a svn move to move the ZK codebase out from under hadoop", "created_at" : { "$date" : "2010-11-24T17:47:27.442+0000" }, "updated_at" : { "$date" : "2010-11-24T22:19:03.262+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50ec5f627d6b0586a70f" }, "external_id" : "ZOOKEEPER-945", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update legacy website with new mailing list details", "created_at" : { "$date" : "2010-11-24T17:47:47.508+0000" }, "updated_at" : { "$date" : "2010-11-24T22:58:28.269+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50ec5f627d6b0586a713" }, "external_id" : "ZOOKEEPER-943", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address hudson configuration change for svn move", "created_at" : { "$date" : "2010-11-24T17:46:50.321+0000" }, "updated_at" : { "$date" : "2010-11-24T22:58:50.965+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50ed5f627d6b0586a718" }, "external_id" : "ZOOKEEPER-28", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Incompatible client and server list detection", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1937084&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:09:34.325+0000" }, "updated_at" : { "$date" : "2010-11-29T08:57:13.511+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ee5f627d6b0586a723" }, "external_id" : "ZOOKEEPER-949", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "work with infra to move the git mirror ", "created_at" : { "$date" : "2010-11-24T22:37:44.604+0000" }, "updated_at" : { "$date" : "2010-11-30T18:14:32.385+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50ef5f627d6b0586a729" }, "external_id" : "ZOOKEEPER-338", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ef5f627d6b0586a72a" }, "external_id" : "ZOOKEEPER-836", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hostlist as string", "desc" : "The hostlist is parsed in the ctor of ClientCnxn. This violates the rule of \nnot doing (too much) work in a ctor. Instead the ClientCnxn should receive an \nobject of class \"HostSet\". HostSet could then be instantiated e.g. with a \ncomma separated string.", "created_at" : { "$date" : "2010-08-11T14:46:00.037+0000" }, "updated_at" : { "$date" : "2010-12-01T10:52:17.690+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a728" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d4fe35f627d6b05868dd0" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a729" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50cf5f627d6b0586a592" }, "effect" : "is related to", "type" : "Reference" } ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50ef5f627d6b0586a774" }, "external_id" : "ZOOKEEPER-849", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50ef5f627d6b0586a775" }, "external_id" : "ZOOKEEPER-324", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "do not materialize strings in the server", "desc" : "We convert paths and authentication information to strings rather than byte[] even though we could work just as well with byte[] for our needs since we don't really interpret the strings. we are just doing basic pattern matching. the only really string manipulations we do with paths is to look for '/', but we could easily to that with byte[] since we use utf8 encoding for the strings. by not materializing the strings we save time doing the serializations and also space since most (almost all) of our strings are ASCII and thus just one byte.\n\nwe could probably get by without even changing the jute spec if we make the generated classes check for a flag to see whether strings should be treated as byte[] or String.", "created_at" : { "$date" : "2009-02-19T22:54:00.027+0000" }, "updated_at" : { "$date" : "2010-12-01T21:19:52.624+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a774" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "external_id" : "ZOOKEEPER-938", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f05f627d6b0586a77c" }, "external_id" : "ZOOKEEPER-329", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document how to integrate 3rd party authentication into ZK server ACLs", "desc" : "the docs mention that zk supports pluggable auth schemes but doesn't detail the API/examples. We should add this to the docs.", "created_at" : { "$date" : "2009-02-23T23:30:06.341+0000" }, "updated_at" : { "$date" : "2010-12-06T19:08:03.295+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "is required by", "type" : "Required" } ] },
{ "_id" : { "$oid" : "5b7d50f15f627d6b0586a78a" }, "external_id" : "ZOOKEEPER-104", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "KeptSet: a distributed data stucture backed by the children of a ZooKeeper node", "desc" : "Here is an implementation of a ZooKeeper backed Java Set. It should be generally useful.", "created_at" : { "$date" : "2008-07-25T23:53:04.594+0000" }, "updated_at" : { "$date" : "2010-12-08T20:39:48.587+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f25f627d6b0586a7ad" }, "external_id" : "ZOOKEEPER-31", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Need deleteRecursively method", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1941112&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:17:32.961+0000" }, "updated_at" : { "$date" : "2010-12-12T03:55:27.333+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f25f627d6b0586a7b1" }, "external_id" : "ZOOKEEPER-459", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Opening a ledger with wrong password doesn't raise an exception", "desc" : "I've experienced by accident the following behavior: \n- created a ledger with a password\n- opened a ledger with a different password \n\nNo exception was raised, the openLedger(...) would return correctly but containing 0 entries ", "created_at" : { "$date" : "2009-07-03T14:16:46.029+0000" }, "updated_at" : { "$date" : "2010-12-18T15:30:58.056+0000" }, "creator_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "reporter_id" : { "$oid" : "5b7d4fd0e9214a0d1608d884" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.1.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f35f627d6b0586a7b9" }, "external_id" : "ZOOKEEPER-838", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Chroot is an attribute of ClientCnxn", "desc" : "It would be better to have one process that uses ZooKeeper for different things \n(managing a list of work, locking some unrelated locks elsewhere). So there are\ncomponents that do this work inside the same process. These components should \nget the same zookeeper-client reference chroot'ed for their needs.\nSo it'd be much better, if the ClientCnxn would not care about the chroot.", "created_at" : { "$date" : "2010-08-11T14:50:53.208+0000" }, "updated_at" : { "$date" : "2010-12-21T20:59:56.784+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f35f627d6b0586a7b8" }, "effect" : "is related to", "type" : "Reference" } ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7be" }, "external_id" : "ZOOKEEPER-277", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7bf" }, "external_id" : "ZOOKEEPER-22", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7c0" }, "external_id" : "ZOOKEEPER-666", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" }, "external_id" : "ZOOKEEPER-835", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f45f627d6b0586a7c1" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50f45f627d6b0586a7bf" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50f45f627d6b0586a7c0" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50f45f627d6b0586a7be" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d50e95f627d6b0586a6f9" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "created_at" : { "$date" : "2010-08-11T14:41:35.137+0000" }, "updated_at" : { "$date" : "2010-12-28T04:53:40.610+0000" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "priority" : "Major", "title" : "Refactoring Zookeeper Client Code", "issue_type" : "Improvement", "desc" : "Thomas Koch asked me to fill individual issues for the points raised in his mail to zookeeper-dev:\n[Mail of Thomas Koch| http://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-dev/201008.mbox/%3C201008111145.17507.thomas@koch.ro%3E ]\n\n\nHe published several issues, which are present in the current zookeeper client, so a refactoring of the code would be an facility for other developers working with zookeeper.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7c2" }, "external_id" : "ZOOKEEPER-911", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7ce" }, "external_id" : "ZOOKEEPER-969", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stat parameter in asynchronous getACL() method is superfluous", "created_at" : { "$date" : "2010-12-29T16:26:00.037+0000" }, "updated_at" : { "$date" : "2010-12-29T16:26:00.037+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50f55f627d6b0586a7cf" }, "external_id" : "ZOOKEEPER-971", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Replace Packet class with Operation classes", "desc" : "The operation classes introduced in ZOOKEEPER-911 can be used to replace the Packet class entirely.\nThen it would also be possible to move the code from the ugly big if clause in EventThread.processEvent to the individual operation classes.\n\nThis cleanup may help to prepare the code for the move from jute to avro.", "created_at" : { "$date" : "2010-12-30T18:20:59.079+0000" }, "updated_at" : { "$date" : "2010-12-30T18:20:59.079+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f55f627d6b0586a7d0" }, "external_id" : "ZOOKEEPER-970", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Review and refactor Java client close logic", "desc" : "There have been several jira tickets to fix the close logic but there are still possibilities for blocks as discovered in ZOOKEEPER-911.\n\nFor example the failing server.InvalidSnapshotTest times out because the ClientCnxn.close() call blocks in Packet.waitForFinish().\n\nHowever the only change introduced is that instead of\n\nsynchronize(packet) while(!packet.finished) packet.wait()\n\nI call packet.waitForFinish() which is a synchronized method.\n\nThe bug is in ClientCnxn.queuePacket:\nClientCnxn.closing is set to true before the closeSession Packet is added to outgoingQueue. Between these two steps, the SendThread already terminate so that there's nobody left to call packet.notifyAll().", "created_at" : { "$date" : "2010-12-30T17:14:29.350+0000" }, "updated_at" : { "$date" : "2010-12-30T18:29:24.619+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d50f65f627d6b0586a7d3" }, "external_id" : "HADOOP-7089", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d4fee5f627d6b05868eda" }, "external_id" : "ZOOKEEPER-303", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.0" ], "components" : [ "scripts" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fee5f627d6b05868edb" }, "effect" : "is duplicated by", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d50f65f627d6b0586a7d3" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4fe1e9214a0d1608d88d" }, "created_at" : { "$date" : "2009-02-06T14:06:17.352+0000" }, "priority" : "Major", "desc" : "Macs don't support the -f option in readlink\n\n{noformat}\n$ bin/zkServer.sh start\nJMX enabled by default\nreadlink: illegal option -- f\nusage: readlink [-n] [file ...]\n{noformat}", "reporter_id" : { "$oid" : "5b7d4fe1e9214a0d1608d88d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4fe1e9214a0d1608d88d" }, "updated_at" : { "$date" : "2011-01-06T03:45:21.761+0000" }, "title" : "Bin scripts don't work on Mac", "issue_type" : "Bug", "environment" : "Mac OS X", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50f75f627d6b0586a7e4" }, "external_id" : "ZOOKEEPER-704", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "GSoC 2010: Read-Only Mode", "desc" : "Read-only mode\nPossible Mentor\nHenry Robinson (henry at apache dot org)\n\nRequirements\nJava and TCP/IP networking\n\nDescription\nWhen a ZooKeeper server loses contact with over half of the other servers in an ensemble ('loses a quorum'), it stops responding to client requests because it cannot guarantee that writes will get processed correctly. For some applications, it would be beneficial if a server still responded to read requests when the quorum is lost, but caused an error condition when a write request was attempted.\n\nThis project would implement a 'read-only' mode for ZooKeeper servers (maybe only for Observers) that allowed read requests to be served as long as the client can contact a server.\n\nThis is a great project for getting really hands-on with the internals of ZooKeeper - you must be comfortable with Java and networking otherwise you'll have a hard time coming up to speed.\n", "created_at" : { "$date" : "2010-03-13T00:59:31.883+0000" }, "updated_at" : { "$date" : "2011-01-27T17:45:25.279+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "gsoc", "mentor" ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f75f627d6b0586a7e3" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d50f75f627d6b0586a7f0" }, "external_id" : "ZOOKEEPER-979", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "UnknownHostException in QuorumCnxManager", "desc" : "I'm using zk 3.3.2 and I'm seeing this in my logs around startup:\n\n2011-01-27 10:16:21,513 [WorkerSender Thread] WARN  org.apache.zookeeper.server.quorum.QuorumCnxManager - Cannot open channel to 0 at election address xxx.yyy.com/10.2.131.19:3888\njava.net.UnknownHostException\n\tat sun.nio.ch.Net.translateException(Net.java:100)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:140)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:366)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:335)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:360)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:333)\n\tat java.lang.Thread.run(Thread.java:636)\n\nAnd all subsequent zk ops give {{ConnectionLossException}}.\n\nI've just explained this to breed_zk on IRC, and he asked me to file a ticket, mentioning that UnknownHostException may sometimes be thrown for reasons other than host resolution. While I'm reasonably certain that the hostname is correct and should be contactable, I need to put some more time into checking our network setup to be absolutely sure. However, two observations arose while looking into this:\n\n* At the top of QuorumCnxManager.connectOne(), we set electionAddr (or fail and return). But then a few lines later we don't actually use this local variable in the call to connect(). This seems like a minor programming mistake (although AFAICT it doesn't change the behaviour).\n* In the subsequent catch block, the UnknownHostException that's thrown doesn't contain the address that we were trying to connect to (though if you capture WARN log messages, you can see what it was).", "created_at" : { "$date" : "2011-01-27T16:44:00.764+0000" }, "updated_at" : { "$date" : "2011-01-28T14:10:16.155+0000" }, "creator_id" : { "$oid" : "5b7d50f7e9214a0d1608d8cf" }, "reporter_id" : { "$oid" : "5b7d50f7e9214a0d1608d8cf" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f85f627d6b0586a7f3" }, "external_id" : "ZOOKEEPER-947", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "move the wiki content to it's new home", "created_at" : { "$date" : "2010-11-24T17:50:43.342+0000" }, "updated_at" : { "$date" : "2011-02-07T05:31:39.480+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50f95f627d6b0586a7fe" }, "external_id" : "ZOOKEEPER-953", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "review project branding requirements, report to board", "created_at" : { "$date" : "2010-11-25T02:04:05.011+0000" }, "updated_at" : { "$date" : "2011-02-07T18:30:15.438+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f95f627d6b0586a7fd" }, "effect" : "relates to", "type" : "Reference" } ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50f95f627d6b0586a7fd" }, "external_id" : "ZOOKEEPER-941", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f95f627d6b0586a7fe" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" }, "created_at" : { "$date" : "2010-11-24T17:45:09.119+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-02-07T18:40:17.269+0000" }, "title" : "setup the new website on zookeeper.apache.org", "issue_type" : "Sub-task", "desc" : "This uses the new CMS system. See INFRA-3228 for details.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d50fa5f627d6b0586a80e" }, "external_id" : "ZOOKEEPER-950", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "create bylaws", "created_at" : { "$date" : "2010-11-24T22:59:59.849+0000" }, "updated_at" : { "$date" : "2011-02-07T18:40:55.246+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50fa5f627d6b0586a812" }, "external_id" : "ZOOKEEPER-987", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fatal error after reelection", "desc" : "ZK server hit fatal error after leader re-election:\n\n2011-01-17 14:38:29,709 - DEBUG [WorkerSender Thread:QuorumCnxManager@384] - There is a connection already for server 4\n2011-01-17 14:38:30,111 - DEBUG [WorkerReceiver Thread:FastLeaderElection$Messenger$WorkerReceiver@214] - Receive new notification message. My id = 1\n2011-01-17 14:38:30,111 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 4 (n.leader), 8589936845 (n.zxid), 6 (n.round), LOOKING (n.state), 4 (n.sid), FOLLOWING (my state)\n2011-01-17 14:38:30,111 - DEBUG [WorkerReceiver Thread:FastLeaderElection$Messenger$WorkerReceiver@288] - Sending new notification. My id =  1, Recipient = 4\n2011-01-17 14:38:30,112 - DEBUG [WorkerSender Thread:QuorumCnxManager@384] - There is a connection already for server 4\n2011-01-17 14:38:34,115 - INFO  [QuorumPeer:/0.0.0.0:2181:Learner@315] - Setting leader epoch 3\n2011-01-17 14:38:34,117 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@116] - Got zxid 0x2000008ce expected 0x1\n2011-01-17 14:38:34,117 - INFO  [QuorumPeer:/0.0.0.0:2181:FileTxnSnapLog@208] - Snapshotting: 300000000\n2011-01-17 14:38:37,346 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@116] - Got zxid 0x300000001 expected 0x2000008cf\n2011-01-17 14:38:37,988 - FATAL [QuorumPeer:/0.0.0.0:2181:FollowerZooKeeperServer@112] - Committing zxid 0x300000001 but next pending txn 0x2000008ce", "created_at" : { "$date" : "2011-02-14T00:10:41.282+0000" }, "updated_at" : { "$date" : "2011-02-14T06:14:01.026+0000" }, "creator_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "reporter_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50fb5f627d6b0586a816" }, "external_id" : "ZOOKEEPER-990", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "random session timeout when there is a large number of sessions", "desc" : "When there is large number of sessions, random session timeout starts after a few hours. It happens even though the load on the server is small (less than 1 out of 8 process busy and plenty of memory). Increase the timeout to 300 seconds only delays this but the session timeout eventually happens.", "created_at" : { "$date" : "2011-02-14T00:20:09.127+0000" }, "updated_at" : { "$date" : "2011-02-14T17:04:33.205+0000" }, "creator_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "reporter_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50fc5f627d6b0586a819" }, "external_id" : "ZOOKEEPER-848", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Implement the Failure Detector module in the C client", "desc" : "The failure detector module https://issues.apache.org/jira/browse/ZOOKEEPER-702 is only used in the java client of ZooKeeper, once it reuses the implementation written in Java. The failure detectors must be written in C and the C client must be refactored to use them.", "created_at" : { "$date" : "2010-08-16T04:11:25.003+0000" }, "updated_at" : { "$date" : "2011-02-25T04:24:47.112+0000" }, "creator_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "reporter_id" : { "$oid" : "5b7d50d3e9214a0d1608d8bf" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50fd5f627d6b0586a81b" }, "external_id" : "ZOOKEEPER-946", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update howtorelease page with new details (svn, filepaths, notifications and such)", "created_at" : { "$date" : "2010-11-24T17:49:59.916+0000" }, "updated_at" : { "$date" : "2011-03-11T06:25:23.052+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50fd5f627d6b0586a820" }, "external_id" : "ZOOKEEPER-1015", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50fd5f627d6b0586a821" }, "external_id" : "ZOOKEEPER-1014", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "DateFormat.getDateTimeInstance() is very expensive, we can cache it to improve performance", "desc" : "In the file:\n{noformat}\n./zookeeper-3.3.2/src/java/main/org/apache/zookeeper/server/TraceFormatter.java\n{noformat}\nDateFormat.getDateTimeInstance() is called in the while loop. We can cache the return value, and improve performance.\n\nThis is similar to the  Apache Bug https://issues.apache.org/bugzilla/show_bug.cgi?id=48778 ", "created_at" : { "$date" : "2011-03-12T17:42:07.663+0000" }, "updated_at" : { "$date" : "2011-03-15T03:51:36.528+0000" }, "creator_id" : { "$oid" : "5b7d50fde9214a0d1608d8d1" }, "reporter_id" : { "$oid" : "5b7d50fde9214a0d1608d8d1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50fd5f627d6b0586a820" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d50ff5f627d6b0586a826" }, "external_id" : "ZOOKEEPER-1017", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Follower.followLeader throws SocketException, then shutdown Follower", "desc" : "i use three node to deploy zkcluster. but follower node throws SocketException twice every day.\n2011-03-15 14:15:48,260 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@90] - Exception when following the leader\njava.net.SocketException: Broken pipe\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n        at org.apache.zookeeper.server.quorum.Learner.writePacket(Learner.java:126)\n        at org.apache.zookeeper.server.quorum.Learner.ping(Learner.java:361)\n        at org.apache.zookeeper.server.quorum.Follower.processPacket(Follower.java:116)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:80)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:644)\n\ni found the reason is that Follower do not reponse Leader's Ping just on time.\nso, i add some logs. finnally, i found that, in org.apache.zookeeper.server.SyncRequestProcessor: \n{noformat}\n    public void processRequest(Request request) {\n        // request.addRQRec(\">sync\");\n        //TODO tom liu added\n    \tif(LOG.isDebugEnabled()) {\n    \t\tLOG.debug(\"Processing request::\" + request);\n    \t}\n        queuedRequests.add(request);\n        //TODO tom liu added\n    \tif(LOG.isDebugEnabled()) {\n    \t\tLOG.debug(\"Processing request::\" + request);\n    \t}\n    }\n{noformat}\n\nthat log is:\n2011-03-15 14:15:34,515 - DEBUG [QuorumPeer:/0:0:0:0:0:0:0:0:2181:SyncRequestProcessor@189] - Processing request::sessionid:0x22e9907b5d50000 type:setData cxid:0x70b55 zxid:0xd50000a73f txntype:5 reqpath:n/a\n2011-03-15 14:15:48,259 - DEBUG [QuorumPeer:/0:0:0:0:0:0:0:0:2181:SyncRequestProcessor@194] - Processing request::sessionid:0x22e9907b5d50000 type:setData cxid:0x70b55 zxid:0xd50000a73f txntype:5 reqpath:n/a\n\nso: elapsed time=13744, LearnerHandler's ia.readRecord TimeOut on run method, then Leader shutdown, and re-elect Leader process.\n\nmy question is: why the queuedRequests.add statement take so long time?", "created_at" : { "$date" : "2011-03-15T09:59:38.978+0000" }, "updated_at" : { "$date" : "2011-03-15T09:59:38.978+0000" }, "creator_id" : { "$oid" : "5b7d50ffe9214a0d1608d8d2" }, "reporter_id" : { "$oid" : "5b7d50ffe9214a0d1608d8d2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "quorum" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "JDK1.6.0_17/CentOS5.5" },
{ "_id" : { "$oid" : "5b7d50ff5f627d6b0586a828" }, "external_id" : "ZOOKEEPER-989", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZK servers not balanced in number of sessions", "desc" : "In a 5-machine ZK cluster, when there is a large number of sessions, the 1st server seems to get more sessions.\n\n1st server gets 25% sessions, while the remaining gets 18.75% sessions", "created_at" : { "$date" : "2011-02-14T00:16:36.223+0000" }, "updated_at" : { "$date" : "2011-03-19T20:15:41.171+0000" }, "creator_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "reporter_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.2" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ff5f627d6b0586a827" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51005f627d6b0586a82c" }, "external_id" : "ZOOKEEPER-1026", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Sequence number assignment decreases after old node rejoins cluster", "desc" : "I ran into a weird case where a Zookeeper server rejoins the cluster after missing several operations, and then a client creates a new sequential node that has a number earlier than the last node it created.  I don't have full logs, or a live system in this state, or any data directories, just some partial server logs and the evidence as seen by the client.  Haven't tried reproducing it yet, just wanted to see if anyone here had any ideas.  Here's the scenario (probably more info than necessary, but trying to be complete)\n\n1) Initially (5:37:20): 3 nodes up, with ids 215, 126, and 37 (called nodes #1, #2, and #3 below):\n2) Nodes periodically (and throughout this whole timeline) create sequential, non-ephemeral nodes under the /zkrsm parent node.\n3) 5:46:57: Node #1 gets notified of /zkrsm/0000000000000000_record0000002116\n4) 5:47:06: Node #1 restarts and rejoins\n5) 5:49:26: Node #2 gets notified of /zkrsm/0000000000000000_record0000002708\n6) 5:49:29: Node #2 restarts and rejoins\n7) 5:52:01: Node #3 gets notified of /zkrsm/0000000000000000_record0000003291\n8) 5:52:02: Node #3 restarts and begins the rejoining process\n9) 5:52:08: Node #1 successfully creates /zkrsm/0000000000000000_record0000003348\n10) 5:52:08: Node #2 dies after getting notified of /zkrsm/0000000000000000_record0000003348\n11) 5:52:10ish: Node #3 is elected leader (the ZK server log doesn't have wallclock timestamps, so not exactly sure on the ordering of this step)\n12) 5:52:15: Node #1 successfully creates /zkrsm/0000000000000000_record0000003292\n\nNote that the node created in step #12 is lower than the one created in step #9, and is exactly one greater than the last node seen by node #3 before it restarted.\n\nHere is the sequence of session establishments as seen from the C client of node #1 after its restart (the IP address of node #1=13.0.0.11, #2=13.0.0.12, #3=13.0.0.13):\n\n2011-03-18 05:46:59,838:17454(0x7fc57d3db710):ZOO_INFO@check_events@1632: session establishment complete on server [13.0.0.13:2888], sessionId=0x252ec780a3020000, negotiated timeout=6000\n2011-03-18 05:49:32,194:17454(0x7fc57cbda710):ZOO_INFO@check_events@1632: session establishment complete on server [13.0.0.13:2888], sessionId=0x252ec782f5100002, negotiated timeout=6000\n2011-03-18 05:52:02,352:17454(0x7fc57d3db710):ZOO_INFO@check_events@1632: session establishment complete on server [13.0.0.12:2888], sessionId=0x7e2ec782ff5f0001, negotiated timeout=6000\n2011-03-18 05:52:08,583:17454(0x7fc57d3db710):ZOO_INFO@check_events@1632: session establishment complete on server [13.0.0.11:2888], sessionId=0x7e2ec782ff5f0001, negotiated timeout=6000\n2011-03-18 05:52:13,834:17454(0x7fc57cbda710):ZOO_INFO@check_events@1632: session establishment complete on server [13.0.0.11:2888], sessionId=0xd72ec7856d0f0001, negotiated timeout=6000\n\nI will attach logs for all nodes after each of their restarts, and a partial log for node #3 from before its restart.", "created_at" : { "$date" : "2011-03-22T17:16:03.098+0000" }, "updated_at" : { "$date" : "2011-03-25T18:25:30.881+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51015f627d6b0586a846" }, "external_id" : "ZOOKEEPER-5", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Upgrade Feature in Zookeeper server.", "desc" : "We need an upgrade feature in zookeeper where we can upgrade the old databases to a new one.", "created_at" : { "$date" : "2008-06-09T23:43:48.032+0000" }, "updated_at" : { "$date" : "2011-03-30T19:28:06.679+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51025f627d6b0586a869" }, "external_id" : "ZOOKEEPER-1036", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "send UPTODATE to follower until a quorum of servers synced with leader", "desc" : "1. current process\nwhen leader fail, a new leader will be elected, followers will sync with the\nnew leader.\nAfter synced, leader send UPTODATE to follower.\n\n2. a corner case\nbut there is a corner case, things will go wrong.\nsuppose message M only exists on leader, after a follower synced with\nleader, the client connected to the follower will see M.\nbut it only exists on two servers, not on a quorum of servers. If the new\nleader and the follower failed, message M is lost, but M is already seen by\nclient.\n\n3. one solution\nSo I think UPTODATE  can be sent to follower only when a quorum of server\nsynced with the leader.", "created_at" : { "$date" : "2011-03-29T00:46:05.584+0000" }, "updated_at" : { "$date" : "2011-03-31T20:26:30.960+0000" }, "creator_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "reporter_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51025f627d6b0586a87b" }, "external_id" : "ZOOKEEPER-1038", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Move bookkeeper and hedwig code in subversion", "desc" : "need to do an svn move of the hedwig and bookkeeper code to the bookkeeper subversion", "created_at" : { "$date" : "2011-03-30T05:28:52.675+0000" }, "updated_at" : { "$date" : "2011-04-05T20:05:23.018+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51025f627d6b0586a87a" } },
{ "_id" : { "$oid" : "5b7d51035f627d6b0586a883" }, "external_id" : "ZOOKEEPER-1047", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper Standalone does not shutdown cleanly", "desc" : "When I shutdown a standalone ZooKeeper server (programmatically) I get the following exception logged. Occasionally, no exception is logged. \n{noformat}\n10:32:43.353 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] WARN  o.a.zookeeper.server.NIOServerCnxn - Ignoring unexpected runtime exception\njava.nio.channels.CancelledKeyException: null\n\tat sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55) ~[na:1.6.0_24]\n\tat sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:69) ~[na:1.6.0_24]\n\tat org.apache.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:241) ~[na:na]\n10:32:43.353 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] INFO  o.a.zookeeper.server.NIOServerCnxn - NIOServerCnxn factory exited run method\n10:32:43.387 [SyncThread:0] INFO  o.a.z.server.SyncRequestProcessor - SyncRequestProcessor exited!\n10:32:43.387 [ProcessThread:-1] INFO  o.a.z.server.PrepRequestProcessor - PrepRequestProcessor exited loop!\n10:32:43.387 [app thread] INFO  o.a.z.server.FinalRequestProcessor - shutdown of request processor complete\n{noformat}\n\nBecause it's logged with a WARN level, my assumption is that something is wrong on shutdown. However, I follow the exact same shutdown order than ZooKeeperMain, i.e. shutdown the {{NIOServerCnxn.Factory}} first and shutdown the {{ZooKeeperServer}} instance thereafter if its still running.\n\n{noformat}\n...\nfactory.shutdown();\nfactory = null;\n\nif (zkServer.isRunning()) {\n\tzkServer.shutdown();\n}\nzkServer = null;\n{noformat}\n\n\n", "created_at" : { "$date" : "2011-04-13T09:04:09.492+0000" }, "updated_at" : { "$date" : "2011-04-13T09:04:09.492+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51035f627d6b0586a884" }, "external_id" : "ZOOKEEPER-1056", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Questions and Improvements for the C client codebase", "desc" : "Having been using the C client for a few months now, I thought I'd look through the code and see if anything could be improved and/or fixed in order to be a good citizen. Here are some observations and questions I was hoping people could elaborate on.\n\n- There appears to be a bug in sub_string (zookeeper.c). The third argument being passed into strncmp is a conditional due to misplaced parenthesis, meaning the length is either 0 or 1. This likely leads to many, many false positives of chroots matching paths.\n- There appears to be a bug in queue_session_event, where we check for cptr->buffer not being NULL after already dereferencing it\n- In both queue_buffer and queue_completion_nolock, we assert a conditional that we just checked for\n- What is the policy on whether the result of memory allocations are checked for, assert'd against or ignored? This is done inconsistently.\n- What is the policy on whether pointers are checked/set against NULL versus 0? This is done inconsistently.\n- Some functions, such as zoo_wget_children2_, exhibit needlessly high cyclomatic complexity\n- What is the policy on line length restrictions? Some functions go through hurdles to enforce 80 characters while others do no such thing.\n- What is the policy on indentation and spacing of if statements and blocks of code? This is done inconsistently.\n\nIf any or all of these turn out to be issues that need to be fixed I'd be more than happy to do so.", "created_at" : { "$date" : "2011-04-27T03:20:06.113+0000" }, "updated_at" : { "$date" : "2011-04-27T03:20:06.113+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51045f627d6b0586a885" }, "external_id" : "ZOOKEEPER-1039", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "give bookkeeper committers access to bookkeeper svn", "desc" : "need to give ivan, utkarsh, and dhruba svn access to bookkeeper svn", "created_at" : { "$date" : "2011-03-30T05:30:20.655+0000" }, "updated_at" : { "$date" : "2011-04-28T23:09:23.001+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51025f627d6b0586a87a" } },
{ "_id" : { "$oid" : "5b7d51055f627d6b0586a88a" }, "external_id" : "ZOOKEEPER-1040", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "create bookkeeper webpage", "desc" : "create a webpage for bookkeeper", "created_at" : { "$date" : "2011-03-30T05:31:16.087+0000" }, "updated_at" : { "$date" : "2011-04-28T23:09:39.103+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51025f627d6b0586a87a" } },
{ "_id" : { "$oid" : "5b7d51055f627d6b0586a890" }, "external_id" : "ZOOKEEPER-1022", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "let the children under a ZNode in order.", "desc" : "let the children under a ZNode in order. and user can specify a comparator for each parent ZNode.\nsome time we only need get some children, not all, like getting first children.\nand some application can leverage the order, like in HBase, the meta table can put into ZK. ", "created_at" : { "$date" : "2011-03-19T10:13:28.121+0000" }, "updated_at" : { "$date" : "2011-04-29T15:34:31.060+0000" }, "creator_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "reporter_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51055f627d6b0586a88f" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51065f627d6b0586a896" }, "external_id" : "ZOOKEEPER-282", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51055f627d6b0586a88f" }, "external_id" : "ZOOKEEPER-423", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bindings", "server", "java client", "documentation" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51065f627d6b0586a896" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51055f627d6b0586a890" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2009-06-01T16:10:15.188+0000" }, "updated_at" : { "$date" : "2011-04-29T16:07:12.232+0000" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "priority" : "Major", "title" : "Add getFirstChild API", "issue_type" : "New Feature", "desc" : "When building the distributed queue for my tutorial blog post, it was pointed out to me that there's a serious inefficiency here. \n\nInformally, the items in the queue are created as sequential nodes. For a 'dequeue' call, all items are retrieved and sorted by name by the client in order to find the name of the next item to try and take. This costs O( n ) bandwidth and O(n.log n) sorting time - per dequeue call! Clearly this doesn't scale very well. \n\nIf the servers were able to maintain a data structure that allowed them to efficiently retrieve the children of a node in order of the zxid that created them this would make successful dequeue operations O( 1 ) at the cost of O( n ) memory on the server (to maintain, e.g. a singly-linked list as a queue). This is a win if it is generally true that clients only want the first child in creation order, rather than the whole set. \n\nWe could expose this to the client via this API: getFirstChild(handle, path, name_buffer, watcher) which would have much the same semantics as getChildren, but only return one znode name. \n\nSequential nodes would still allow the ordering of znodes to be made explicitly available to the client in one RPC should it need it. Although: since this ordering would now be available cheaply for every set of children, it's not completely clear that there would be that many use cases left for sequential nodes if this API was augmented with a getChildrenInCreationOrder call. However, that's for a different discussion. \n\nA halfway-house alternative with more flexibility is to add an 'order' parameter to getFirstChild and have the server compute the first child according to the requested order (creation time, update time, lexicographical order). This saves bandwidth at the expense of increased server load, although servers can be implemented to spend memory on pre-computing commonly requested orders. I am only in favour of this approach if servers maintain a data-structure for every possible order, and then the memory implications need careful consideration.\n\n[edit - JIRA interprets ( n ) without the spaces as a thumbs-down. cute.]", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d51075f627d6b0586a8aa" }, "external_id" : "ZOOKEEPER-1024", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "let path be binary", "desc" : "let path be binary, not string. there are overhead to hold string.\nthe overhead is obvious when there are millions of nodes.\n\nsome time ZK can be used as a highly available meta database.\nsome data are binary, if converting to string, there is also obvious overhead. ", "created_at" : { "$date" : "2011-03-19T10:20:16.602+0000" }, "updated_at" : { "$date" : "2011-05-03T03:42:53.654+0000" }, "creator_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "reporter_id" : { "$oid" : "5b7d5102e9214a0d1608d8d5" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51075f627d6b0586a8ad" }, "external_id" : "ZOOKEEPER-793", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Large-scale Pub/Sub System (C++ Client)", "desc" : "Write a c++ client for hedwig", "created_at" : { "$date" : "2010-06-25T14:39:15.534+0000" }, "updated_at" : { "$date" : "2011-05-05T11:59:50.400+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51075f627d6b0586a8ac" } },
{ "_id" : { "$oid" : "5b7d51085f627d6b0586a8b5" }, "external_id" : "ZOOKEEPER-1065", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Possible timing issue in embedded server", "desc" : "I have an application that uses ZooKeeper. There is an ensemble in\nproduction. But in order to simplify development the application will\nstart an embedded ZooKeeper server when started in development mode. We\nare experiencing a timing issue with ZooKeeper 3.3.3 and I was wondering\nif this is allowed to be happen or if we did something wrong when\nstarting the embedded server.\n\n\nBasically, we have a watch registered using an #exists call and watch\ncode like the following.\n{code}\n@Override\npublic void process(final WatchedEvent event) {\n  switch (event.getType()) {\n    ...\n    case NodeCreated:\n      pathCreated(event.getPath());\n      break;\n    ...\n  }\n}\n\n@Override\nprotected void pathCreated(final String path) {\n  // process events only for this node\n  if (!isMyPath(path))\n    return;\n  try {\n    loadNode(); // calls zk.getData(String, Watcher, Stat)\n  } catch (final Exception e) {\n    // got NoNodeException here (but not when debugging)\n    log(..., e)\n  }\n}\n{code}\n\n\nFrom inspecting the logs we noticed a NoNodeException. When setting\nbreakpoints on #loadNode and stepping through we don't get the\nexception. But when setting a breakpoint on #log only we got a hit and\ncould confirm the issue this way.\n\nThe path is actually some levels deep. All the parent paths don't exist\neither so they are created as well. However, no exception is thrown fro\nthem. The sequence is as follows.\n\n{noformat}\n/l1  --> watch triggered, getData, no exception\n/l1/l2  --> watch triggered, getData, no exception\n/l1/l2/l3  --> watch triggered, getData, no exception\n/l1/l2/l3/l4  --> watch triggered, getData, no exception\n/l1/l2/l3/l4/l5  --> watch triggered, getData, no exception\n/l1/l2/l3/l4/l5/l6  --> watch triggered, getData, NoNodeException\n{noformat}\n\nThe only difference is that all paths up to including l5 do not actually\nhave any data. Only l6 has some data. Could there be some latency issues?\n\nFor completeness, the embedded server is started as follows.\n{code}\n// disable LOG4J JMX stuff\nSystem.setProperty(\"zookeeper.jmx.log4j.disable\", Boolean.TRUE.toString());\n\n// get directories\nfinal File dataDir = new File(config.getDataLogDir());\nfinal File snapDir = new File(config.getDataDir());\n\n// clean old logs\nPurgeTxnLog.purge(dataDir, snapDir, 3);\n\n// create standalone server\nzkServer = new ZooKeeperServer();\nzkServer.setTxnLogFactory(new FileTxnSnapLog(dataDir, snapDir));\nzkServer.setTickTime(config.getTickTime());\nzkServer.setMinSessionTimeout(config.getMinSessionTimeout());\nzkServer.setMaxSessionTimeout(config.getMaxSessionTimeout());\n\nfactory = new NIOServerCnxn.Factory(config.getClientPortAddress(),\nconfig.getMaxClientCnxns());\n\n// start server\nLOG.info(\"Starting ZooKeeper standalone server.\");\ntry {\n  factory.startup(zkServer);\n} catch (final InterruptedException e) {\n  LOG.warn(\"Interrupted during server start.\", e);\n  Thread.currentThread().interrupt();\n}\n{code}", "created_at" : { "$date" : "2011-05-20T06:46:18.784+0000" }, "updated_at" : { "$date" : "2011-05-20T18:39:30.239+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows 7, 32bit, Core2 Duo T9300, JDK 1.6.0_24, ZooKeeper data on 500GB hybrid Seagate HDD with 4GB SSD cache" },
{ "_id" : { "$oid" : "5b7d51095f627d6b0586a8be" }, "external_id" : "ZOOKEEPER-1070", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "let org.apache.zookeeper.recipes.lock.WriteLock implements java.util.concurrent.locks.Lock", "desc" : "and add a zookeeper distributed java.util.concurrent.locks.ReadWriteLock\nuse concurrent locks internally,don't use keyword synchronized", "created_at" : { "$date" : "2011-05-24T02:23:23.359+0000" }, "updated_at" : { "$date" : "2011-05-24T02:23:23.359+0000" }, "creator_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "reporter_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "recipes" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51095f627d6b0586a8bf" }, "external_id" : "ZOOKEEPER-1071", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh script needs to track whether ZK is already running or not", "desc" : "If one repeatedly invokes:\n\n{noformat}\n/usr/lib/zookeeper/bin/zkServer.sh start\n{noformat}\n\nafter the initial start 2 bad things happen:\n\n1. ZK reports that it got started where in reality it failed with the following:\n{noformat}\n2011-05-24 10:18:58,217 - INFO  [main:NIOServerCnxn$Factory@143] - binding to port 0.0.0.0/0.0.0.0:2181\n2011-05-24 10:18:58,219 - FATAL [main:ZooKeeperServerMain@62] - Unexpected exception, exiting abnormally\njava.net.BindException: Address already in use\n{noformat}\n\n2. It clobbers the zookeeper_server.pid file", "created_at" : { "$date" : "2011-05-24T17:20:56.442+0000" }, "updated_at" : { "$date" : "2011-05-26T17:48:36.762+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510a5f627d6b0586a8c5" }, "external_id" : "ZOOKEEPER-1075", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper Server cannot join an existing ensemble if the existing ensemble doesn't already have a quorum", "desc" : "Here is the sequence of steps that reproduces the problem.\nOn a 3 server ensemble,\n1. Bring up two servers (say 1 and 2). Lets say 1 is leading.\n2. Bring down 2\n3. Bring up 2. \n4. 2 gets a notification from 1 that it is leading but 2 doesn't accept it as a leader since it cannot find one other node that thinks 1 is the leader.\n\n\nSo the ensemble gets stuck where 2 isn't following. If at this point, 3 comes up, then one of 2 & 3 will become a leader and 1 will keep thinking it is the leader.\n\n\nI am working on a patch to fix this issue.", "created_at" : { "$date" : "2011-05-25T21:39:54.032+0000" }, "updated_at" : { "$date" : "2011-05-27T07:07:02.319+0000" }, "creator_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "reporter_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 172800, "environment" : "Windows 7" },
{ "_id" : { "$oid" : "5b7d510a5f627d6b0586a8d2" }, "external_id" : "ZOOKEEPER-996", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZkClient: stat on non-existing node causes NPE", "desc" : "stat on non-existing node causes NPE. client quit\n\nstat /aa\nException in thread \"main\" java.lang.NullPointerException\n        at org.apache.zookeeper.ZooKeeperMain.printStat(ZooKeeperMain.java:130)\n        at org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:722)\n        at org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:581)\n        at org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:353)\n        at org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:311)\n        at org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:270)", "created_at" : { "$date" : "2011-02-21T19:02:58.245+0000" }, "updated_at" : { "$date" : "2011-05-27T16:08:20.471+0000" }, "creator_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "reporter_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "CentOS release 5.5 (Final)" },
{ "_id" : { "$oid" : "5b7d510b5f627d6b0586a8d7" }, "external_id" : "HIVE-1235", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510b5f627d6b0586a8d9" }, "external_id" : "HBASE-1933", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50665f627d6b05869b19" }, "external_id" : "ZOOKEEPER-224", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "build" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50665f627d6b05869b1a" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d510b5f627d6b0586a8d8" }, "effect" : "is cloned by", "type" : "Cloners" }, { "issue_id" : { "$oid" : "5b7d510b5f627d6b0586a8d7" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d510b5f627d6b0586a8d9" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50735f627d6b05869c88" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2008-11-18T01:02:01.621+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86c" }, "updated_at" : { "$date" : "2011-06-01T07:22:30.671+0000" }, "title" : "Deploy ZooKeeper jars/artifacts to a Maven Repository", "issue_type" : "Task", "desc" : "I've created the maven poms needed for the 3.0.0 release.  \n\nThe directory structure and artifacts located at:\nhttp://people.apache.org/~chirino/zk-repo/\naka\npeople.apache.org:/x1/users/chirino/public_html/zk-repo\n\n\nJust need sto get GPG signed by the project KEY and deployed to:\npeople.apache.org:/www/people.apache.org/repo/m2-ibiblio-rsync-repository\n\nWho's the current ZooKeeper release manager?\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d510c5f627d6b0586a90e" }, "external_id" : "ZOOKEEPER-1079", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "'Create' command in Hbase makes a table in Hbase but it sends 'Delete' request to Zookeeper !!!", "desc" : "\"when use 'Create' in Hbase==> Got user-level KeeperException... type:delete\" And caused zookeper make Nonode Exception.... and when make a znode in zookeeper shell for example a node with name 'mkm' , and  in hbase command line use create 'mkm' , 'm' this command delete 'mkm' from zookeeper !!\n\nLinux Ubuntu\nZookeeper and Hbase\n", "created_at" : { "$date" : "2011-05-29T06:41:28.897+0000" }, "updated_at" : { "$date" : "2011-06-08T16:24:57.873+0000" }, "creator_id" : { "$oid" : "5b7d510ce9214a0d1608d8e1" }, "reporter_id" : { "$oid" : "5b7d510ce9214a0d1608d8e1" }, "issue_type" : "Test", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510d5f627d6b0586a918" }, "external_id" : "ZOOKEEPER-1099", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add simple examples to show the usage of zookeeper", "desc" : "We used zookeeper to make one of our service highly available. I have written a sample program which shows the usage of zookeeper to make the required service highly available . Please review the client code attached .", "created_at" : { "$date" : "2011-06-20T18:48:55.198+0000" }, "updated_at" : { "$date" : "2011-06-20T18:52:08.879+0000" }, "creator_id" : { "$oid" : "5b7d510de9214a0d1608d8e2" }, "reporter_id" : { "$oid" : "5b7d510de9214a0d1608d8e2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510d5f627d6b0586a91c" }, "external_id" : "ZOOKEEPER-1084", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hard-coding a well-known location for configuration directory gives less flexibility for packaging Zookeeper configurations", "desc" : "Currently, Zookeeper relies on zkEnv.sh logic to discover the location of the configuration directory if none is specified:\n\n{noformat}\n# We use ZOOCFGDIR if defined,\n# otherwise we use /etc/zookeeper\n# or the conf directory that is\n# a sibling of this script's directory\nif [ \"x$ZOOCFGDIR\" = \"x\" ]\nthen\n    if [ -d \"/etc/zookeeper\" ]\n    then\n        ZOOCFGDIR=\"/etc/zookeeper\"\n    else\n        ZOOCFGDIR=\"$ZOOBINDIR/../conf\"\n    fi\nfi\n{noformat}\n\nThe problem with such an approach is that having /etc/zookeeper (for whatever reason) trips this logic up in believing that\nit is THE place. It would be much nicer to follow the suit of other Apache Hadoop projects and restrict the logic to\n$ZOOCFGDIR and $ZOOBINDIR/../conf\n\nPlease note, that if that happens one can always have an existing behavior of picking up /etc/zookeeper by creating\na symlink at $ZOOBINDIR/../conf pointing to it.", "created_at" : { "$date" : "2011-05-31T22:55:22.574+0000" }, "updated_at" : { "$date" : "2011-06-21T17:33:01.483+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510e5f627d6b0586a927" }, "external_id" : "ZOOKEEPER-323", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log file reuse", "desc" : "in some benchmarks i noticed that you can get much higher throughput using preallocated files rather than doing the grow-by-padding approach that we use. we should recycle log files that are no longer needed. this should give us a performance boost. it will also make the purgelog utility unnecessary. we should have a policy that we only keep X snapshots and associated logs and reuse older log files (and probably delete the older snapshots as well since the snapshot would be useless without the corresponding log file.)", "created_at" : { "$date" : "2009-02-19T22:44:24.907+0000" }, "updated_at" : { "$date" : "2011-06-23T17:27:03.881+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d510e5f627d6b0586a926" }, "effect" : "supercedes", "type" : "Supercedes" } ] },
{ "_id" : { "$oid" : "5b7d510f5f627d6b0586a92b" }, "external_id" : "ZOOKEEPER-121", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SyncRequestProcessor is not closing log stream during shutdown", "desc" : "The SyncRequestProcessor is not closing log stream during shutdown. \n\nSee FIXMEs with this ID in ClientBase.java -- I've commented out the assertion for the time being (checking for logs being deleted), as part of this fix re-enable these asserts and also verify tests on a Windows system.\n", "created_at" : { "$date" : "2008-08-12T18:57:23.342+0000" }, "updated_at" : { "$date" : "2011-06-24T04:53:24.394+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d510f5f627d6b0586a92a" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51105f627d6b0586a975" }, "external_id" : "ZOOKEEPER-1114", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Concurrent primitives library - barrier", "desc" : "The patch is provide according to wiki[1]. The source follows the description at tutorial[2]. \n\nHowever, from the mailing list it shows that this version is not optimized[3]. So is there any chance anyone can point out which algorithm may provide better result for this construct? I am happy to work on it, though it may take some time.  \n\n[1]. http://wiki.apache.org/hadoop/ZooKeeper/SoC2010Ideas#Concurrent_Primitives_Library\n[2]. http://zookeeper.apache.org/doc/current/zookeeperTutorial.html#sc_barriers\n[3]. http://mail-archives.apache.org/mod_mbox/zookeeper-user/201102.mbox/%3C87184214-59D4-4D64-A884-A6F07CE0F239@yahoo-inc.com%3E\n", "created_at" : { "$date" : "2011-07-01T04:22:11.184+0000" }, "updated_at" : { "$date" : "2011-07-01T04:23:29.233+0000" }, "creator_id" : { "$oid" : "5b7d5110e9214a0d1608d8e4" }, "reporter_id" : { "$oid" : "5b7d5110e9214a0d1608d8e4" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Open", "affects_versions" : [  ], "components" : [ "recipes" ], "labels" : [ "gsoc2010" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "GNU/ Debian \njava 1.6.0_21\nzookeeper trunk (svn info shows Revision: 1141788)" },
{ "_id" : { "$oid" : "5b7d51105f627d6b0586a977" }, "external_id" : "ZOOKEEPER-1116", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add MX4J Support to Zookeeper", "desc" : "It would be great to add MX4J support for Zookeeper, if possible it can be inspired by the Cassandra way for loading mx4j (which only starts if the mx4j jar is in the classpath, see https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/utils/Mx4jTool.java)\n\n", "created_at" : { "$date" : "2011-07-03T07:43:25.549+0000" }, "updated_at" : { "$date" : "2011-07-03T07:43:25.549+0000" }, "creator_id" : { "$oid" : "5b7d5110e9214a0d1608d8e5" }, "reporter_id" : { "$oid" : "5b7d5110e9214a0d1608d8e5" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.4" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51115f627d6b0586a978" }, "external_id" : "ZOOKEEPER-1118", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Inconsistent data after server crashes several times", "desc" : "I think there is a bug when Follower try to sync data with Leader.\nAssume there are some operations committed during one server had been crashed. When the server restart, it will receive a NEWLEADER packet which include the last zxid of leader and the server will set its own lastProcessZxid to the leader's. \n{code:title=Follower.java|borderStyle=solid}\nvoid followLeader() throws InterruptedException {\n    fzk.registerJMX(new FollowerBean(this, zk), self.jmxLocalPeerBean);\n    try {\n        InetSocketAddress addr = findLeader();\n        try {\n            connectToLeader(addr);\n            long newLeaderZxid = registerWithLeader(Leader.FOLLOWERINFO);  // get the last zxid from leader\n            //check to see if the leader zxid is lower than ours                                                                                          \n            //this should never happen but is just a safety check                                                                                         \n            long lastLoggedZxid = self.getLastLoggedZxid();\n            if ((newLeaderZxid >> 32L) < (lastLoggedZxid >> 32L)) {\n                LOG.fatal(\"Leader epoch \" + Long.toHexString(newLeaderZxid >> 32L)\n                        + \" is less than our epoch \" + Long.toHexString(lastLoggedZxid >> 32L));\n                throw new IOException(\"Error: Epoch of leader is lower\");\n            }\n            syncWithLeader(newLeaderZxid);   // set its own lastProcessZxid to leader's last zxid\n{code}\n\nThen, some COMMIT packets will be received by the server in order to sync the data with leader. And then, the leader will send an UPTODATE packet to server to take a snapshot. \n{code:title=Follower.java|borderStyle=solid}\nprotected void processPacket(QuorumPacket qp) throws IOException{\n    switch (qp.getType()) {\n    case Leader.PING:\n        ping(qp);\n        break;\n    case Leader.PROPOSAL:\n        TxnHeader hdr = new TxnHeader();\n        BinaryInputArchive ia = BinaryInputArchive\n        .getArchive(new ByteArrayInputStream(qp.getData()));\n        Record txn = SerializeUtils.deserializeTxn(ia, hdr);\n        if (hdr.getZxid() != lastQueued + 1) {\n            LOG.warn(\"Got zxid 0x\"\n                    + Long.toHexString(hdr.getZxid())\n                    + \" expected 0x\"\n                    + Long.toHexString(lastQueued + 1));\n        }\n        lastQueued = hdr.getZxid();\n        fzk.logRequest(hdr, txn);\n        break;\n    case Leader.COMMIT:\n        fzk.commit(qp.getZxid());\n        break;\n    case Leader.UPTODATE:\n        fzk.takeSnapshot();\n        self.cnxnFactory.setZooKeeperServer(fzk);\n        break;\n    case Leader.REVALIDATE:\n        revalidate(qp);\n        break;\n    case Leader.SYNC:\n        fzk.sync();\n        break;\n    }\n}\n{code}\nNotice the different way the Follower treat the COMMIT and the UPTODATE packets. When receives a COMMIT packet, the follower will give this to a processor to deal with. But if receives a UPTODATE packet, the follower will take a snapshot immediately. So it is possible that the server will take snapshot before it commits all the operations it missed. Then if the server crashed again and recovered it will recover its data from the snapshot, so the date inconsistent with the leader now, but its last zxid is the same. ", "created_at" : { "$date" : "2011-07-06T02:56:31.075+0000" }, "updated_at" : { "$date" : "2011-07-07T01:11:17.778+0000" }, "creator_id" : { "$oid" : "5b7d5111e9214a0d1608d8e6" }, "reporter_id" : { "$oid" : "5b7d5111e9214a0d1608d8e6" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Redhat RHEL5" },
{ "_id" : { "$oid" : "5b7d51115f627d6b0586a97d" }, "external_id" : "ZOOKEEPER-1121", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Data cleanup / Eviction policy", "desc" : "We are using zookeeper to store versions of business objects in order to achieve coherence, distributed locks, etc. These business objects have limited lifespans (i.e. objects created over a week ago are rarely accessed), so effectively, after some time period, we do not need their information in zookeeper anymore. It would be nice to have a built-in tool or mechanism for expiring old data, much like how PurgeTxnLog cleans the snapshot and transaction log files. \n\nAny thoughts on whether this can be supported or how it can be accomplished? Currently we are walking the tree and deleting nodes with an old mtime.", "created_at" : { "$date" : "2011-07-08T19:13:53.922+0000" }, "updated_at" : { "$date" : "2011-07-08T19:13:53.922+0000" }, "creator_id" : { "$oid" : "5b7d5111e9214a0d1608d8e7" }, "reporter_id" : { "$oid" : "5b7d5111e9214a0d1608d8e7" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51125f627d6b0586a97e" }, "external_id" : "ZOOKEEPER-92", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "spring factory beans for ZooKeeper, ZooKeeperFacade and ZooKeeperServer", "desc" : "for folks who use Spring for Dependency Injection it might be handy to have a couple of factory beans to make it easier to create and configure the ZooKeeper, ZooKeeperFacade and ZooKeeperServer via the normal Spring dependency mechanism; via Java or XML code etc", "created_at" : { "$date" : "2008-07-24T11:21:53.310+0000" }, "updated_at" : { "$date" : "2011-07-10T11:42:21.424+0000" }, "creator_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "reporter_id" : { "$oid" : "5b7d4f3be9214a0d1608d86e" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f3b5f627d6b05868057" } },
{ "_id" : { "$oid" : "5b7d51135f627d6b0586a988" }, "external_id" : "ZOOKEEPER-1126", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "state of zk_handle should NOT be initialized to 0 (CLOSED) in zokeeper_init. It should have a not initialized state.", "desc" : "In zoo_add_auth, we have following check.\n  2954     // [ZOOKEEPER-800] zoo_add_auth should return ZINVALIDSTATE if\n   2955     // the connection is closed.\n   2956     if (zoo_state(zh) == 0) {\n   2957         return ZINVALIDSTATE;\n\nwhen we do zookeeper_init, the state is initialized to 0 and above we check if state = 0 then throw exception.\nThere is a race condition where the doIo thread is slow and has not changed the state to CONNECTING, then you end up returning back ZKINVALIDSTATE from zoo_add_auth.\nThe problem is we use 0 for CLOSED state and UNINITIALIZED state. in case of uninitialized case it should let it go through.\nIs this intentional? In java we have the uninitialized state = null. \nIf not we can initialize it to some other magic number.\n", "created_at" : { "$date" : "2011-07-18T18:47:05.914+0000" }, "updated_at" : { "$date" : "2011-07-18T21:19:25.778+0000" }, "creator_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "reporter_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51135f627d6b0586a98d" }, "external_id" : "ZOOKEEPER-1093", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper quotas will always trigger if set on one criteria but not the other ", "desc" : "/testing has quota on bytes but not node count. Count quota will always fire because it is set to -1 and will always fail comparison.\n\n2011-06-13 16:01:53,492 - WARN  [CommitProcessor:3:DataTree@373] - Quota exceeded: /testing count=4 limit=-1\n\n", "created_at" : { "$date" : "2011-06-13T20:05:51.136+0000" }, "updated_at" : { "$date" : "2011-07-19T23:55:56.491+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51145f627d6b0586a996" }, "external_id" : "ZOOKEEPER-1132", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper FAQ is out of date wrt testing SessionExpiredException", "desc" : "See http://markmail.org/thread/vyipodh6ar2b77a3\n\nIn addition, this other thread was mentioned as the culprit: http://markmail.org/thread/z5bt4o3quqil7r7t\n\nThere still seems to be no way to programmatically test SessionExipredExceptions based on these threads.  I'm not sure if that warrants a separate ticket or not.", "created_at" : { "$date" : "2011-07-22T12:56:55.575+0000" }, "updated_at" : { "$date" : "2011-07-22T12:56:55.575+0000" }, "creator_id" : { "$oid" : "5b7d5114e9214a0d1608d8ea" }, "reporter_id" : { "$oid" : "5b7d5114e9214a0d1608d8ea" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "documentation" ], "labels" : [ "documentation", "test" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51155f627d6b0586a998" }, "external_id" : "ZOOKEEPER-1135", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "clarify usage of clientPortAddress zoo.cfg option", "desc" : "Documentation should clarify permitted usage of clientPortAddress:\n\nAdd something like:\n\n\"You must specify the port and the address separately like so:\n\nclientPortAddress=my.hostname.com\nclientPort=2181\n\n(that is, you can't do \"clientPortAddress=my.hostname.com:2181\")\"\n\n", "created_at" : { "$date" : "2011-07-22T23:06:19.382+0000" }, "updated_at" : { "$date" : "2011-07-22T23:07:49.945+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51155f627d6b0586a997" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d51155f627d6b0586a997" }, "external_id" : "ZOOKEEPER-635", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51155f627d6b0586a99a" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d51155f627d6b0586a998" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-12-22T08:12:31.883+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5115e9214a0d1608d8eb" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5115e9214a0d1608d8eb" }, "updated_at" : { "$date" : "2011-07-22T23:07:49.975+0000" }, "title" : "Server supports listening on a specified network address", "issue_type" : "New Feature", "desc" : "The issue in maililist is located:\nhttp://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/200912.mbox/%3c4ac0d28c0912210242g58230a9ds1c55361561c70d61@mail.gmail.com%3e\n\nI have checked the server size code, seems no this option provided. This feature is useful when we have more than two network interfaces, one for Internet and others for intranet. We want to run ZooKeeper in our intranet and not be exposed  to outside world.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51165f627d6b0586a9bd" }, "external_id" : "ZOOKEEPER-1131", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Transactions can be dropped because leader election uses last committed zxid instead of last acknowledged/received zxid", "desc" : "Suppose we have 3 servers - A, B, C which have seen the same number of commits. \n- A is the leader and it sends out a new proposal.\n- B doesn't receive the proposal, but A and C receive and ACK it\n- A commits the proposal, but fails before anyone else sees the commit.\n- B and C start leader election. \n- since both B and C saw the same number of commits, if B has a higher server-id than C, leader election will elect B. Then, the last transaction will be truncated from C's log, which is a bug since it was acked by a majority.\n  \nThis happens since servers propose their last committed zxid in leader election, and not their last received / acked zxid (this is not being tracked, AFAIK). See method\nFastLeaderElection.getInitLastLoggedZxid(), which calls QuorumPeer.getLastLoggedZxid(), which is supposed to return the last logged Zxid, but instead calls zkDb.getDataTreeLastProcessedZxid() which returns the last committed zxid.", "created_at" : { "$date" : "2011-07-21T19:16:09.948+0000" }, "updated_at" : { "$date" : "2011-07-27T18:59:31.216+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "leaderElection", "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51175f627d6b0586a9cd" }, "external_id" : "ZOOKEEPER-162", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Content needed: Provisioning", "desc" : "I need the content for the ZooKeeper Admin guide, for the section on \"Provisioning\" your zookeeper deployment. ", "created_at" : { "$date" : "2008-10-06T14:09:19.471+0000" }, "updated_at" : { "$date" : "2011-08-03T08:53:18.335+0000" }, "creator_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "reporter_id" : { "$oid" : "5b7d4f44e9214a0d1608d873" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d4f445f627d6b058680e5" }, "original_time_estimate" : 28800 },
{ "_id" : { "$oid" : "5b7d51175f627d6b0586a9cf" }, "external_id" : "ZOOKEEPER-1102", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Need update for programmer manual to cover multi operation", "desc" : "The new multi operation is undocumented as yet.  Clearly it needs some doc to cover:\n\n1) the basic syntax\n\n2) java code sample\n\n3) C code sample\n", "created_at" : { "$date" : "2011-06-21T17:53:13.613+0000" }, "updated_at" : { "$date" : "2011-08-08T18:05:57.103+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51185f627d6b0586a9d1" }, "external_id" : "ZOOKEEPER-1151", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "http://zookeeper.apache.org/doc/trunk/api/ missing", "desc" : "I see in http://zookeeper.apache.org/doc/ that we have http://zookeeper.apache.org/doc/trunk/, but http://zookeeper.apache.org/doc/trunk/api/ is a 404. I can generate the docs locally, but it would be useful to be able to be able to have URLs to reference the trunk API (e.g. for discussing new features in the JIRA).", "created_at" : { "$date" : "2011-08-10T17:57:29.577+0000" }, "updated_at" : { "$date" : "2011-08-10T17:57:29.577+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51195f627d6b0586a9d2" }, "external_id" : "ZOOKEEPER-1008", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZK should give more specific error on missing myid", "desc" : "On startup, ZK should specifically test for and provide an error message if the myid file is missing. Currently, the error message is simply \"Invalid config\" if myid is missing.", "created_at" : { "$date" : "2011-03-07T17:48:37.263+0000" }, "updated_at" : { "$date" : "2011-09-05T11:50:33.377+0000" }, "creator_id" : { "$oid" : "5b7d5119e9214a0d1608d8ef" }, "reporter_id" : { "$oid" : "5b7d5119e9214a0d1608d8ef" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51195f627d6b0586a9d4" }, "external_id" : "ZOOKEEPER-778", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ability to add a watch on a setData or create call", "desc" : "It is often desirable to set a watch when creating a node or setting data on a node. Currently, you have to add a watch after the create/set with another api call, which incurs extra cost, and a window of unobserved state change.\nThis would \"seem\" to be an easy addition to the server/client libs, but i'm not sure if there are reasons this was never proposed or developed.\n\nI currently am most concerned with a data watch in these two scenarios, but i would imagine other users might be interested in registering a children watch immediately upon creation.\n\nThis change would require adding new method signatures in the clients for create and setData which took watchers. And some changes to the protocol, as the SetDataRequest and CreateRequest objects would need watch flags.", "created_at" : { "$date" : "2010-05-22T20:22:06.239+0000" }, "updated_at" : { "$date" : "2011-09-05T13:09:59.242+0000" }, "creator_id" : { "$oid" : "5b7d5119e9214a0d1608d8f0" }, "reporter_id" : { "$oid" : "5b7d5119e9214a0d1608d8f0" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [ "feature" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d511a5f627d6b0586a9d7" }, "external_id" : "ZOOKEEPER-833", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Attachments in the wiki do not work (so no presentations)", "desc" : "This is apparently a known issue:\n\nhttp://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/201005.mbox/%3C562709E0-0516-481F-87AD-2039A564E5BD@yahoo-inc.com%3E\n\nNone of the attachments on the Presentations page in the wiki work (nor does the link to the screenshot on the performance page).\n", "created_at" : { "$date" : "2010-08-06T19:17:25.573+0000" }, "updated_at" : { "$date" : "2011-09-05T19:55:49.533+0000" }, "creator_id" : { "$oid" : "5b7d511ae9214a0d1608d8f1" }, "reporter_id" : { "$oid" : "5b7d511ae9214a0d1608d8f1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d511a5f627d6b0586a9dd" }, "external_id" : "ZOOKEEPER-939", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the threads number of a zookeeper is increased all the time", "desc" : "I have a group of zookeeper servers, there are three servers in this group.\nserver.0=10.81.4.11:2888:3888\nserver.1=10.23.240.93:2888:3888\nserver.2=10.23.244.224:2888:3888\n\nAt first, the cluster ran well.  About several days ago, I shut down the zookeeper process on one of servers(server.2)., and today, I find that the other two servers run in wired status(the network is fine). The zookeeper process take pretty much resource on the two servers:\n\non server.1 (it's the leader)\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                               \n26836 work      18   0 12.8g 803m 8724 S  3.7 10.1 195:56.56 java \n\n$ ll /proc/26836/fd/ | wc -l\n3586\n\n[work@tc-test-aos03.tc.baidu.com conf]$ ll /proc/26836/task/ | wc -l\n10510\n\nsome warning log:\n2010-11-24 15:37:48,705 - WARN  [Thread-37409:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:39:48,626 - WARN  [Thread-37414:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.nio.channels.AsynchronousCloseException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:39:48,656 - WARN  [Thread-37413:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:39:48,657 - WARN  [Thread-37413:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:41:48,614 - WARN  [Thread-37417:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:41:48,643 - WARN  [Thread-37418:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.nio.channels.AsynchronousCloseException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:41:48,662 - WARN  [Thread-37417:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:43:48,627 - WARN  [Thread-37421:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:43:48,627 - WARN  [Thread-37422:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.nio.channels.AsynchronousCloseException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:43:48,654 - WARN  [Thread-37421:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:44:48,622 - WARN  [Thread-37424:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.nio.channels.AsynchronousCloseException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:44:48,652 - WARN  [Thread-37423:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:44:48,653 - WARN  [Thread-37423:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:45:48,668 - WARN  [Thread-37426:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.io.IOException: Channel eof\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:46:48,647 - WARN  [Thread-37427:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:46:48,722 - WARN  [Thread-37428:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.nio.channels.AsynchronousCloseException\n        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:46:48,736 - WARN  [Thread-37427:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:47:48,687 - WARN  [Thread-37430:QuorumCnxManager$RecvWorker@658] - Connection broken:\njava.io.IOException: Channel eof\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n\n\non server.0\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                               \n27322 work      19   0 15.2g 943m 9140 S 38.6 11.8   1396:51 java\n\n$ ll /proc/27322/fd/ | wc -l\n3587\n\n$ ll /proc/27322/task/ | wc -l\n12938\n\n2010-11-24 15:37:49,269 - WARN  [Thread-37407:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:39:49,235 - WARN  [Thread-37412:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:39:49,410 - WARN  [Thread-37411:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n    at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:39:49,411 - WARN  [Thread-37411:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:41:49,314 - WARN  [Thread-37416:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:41:49,383 - WARN  [Thread-37415:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n    at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:41:49,405 - WARN  [Thread-37415:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:43:49,372 - WARN  [Thread-37420:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:43:49,512 - WARN  [Thread-37419:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n    at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:43:49,513 - WARN  [Thread-37419:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:44:49,407 - WARN  [Thread-37422:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:45:49,645 - WARN  [Thread-37424:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.nio.channels.AsynchronousCloseException\n    at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n    at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:45:49,781 - WARN  [Thread-37423:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n    at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:45:49,799 - WARN  [Thread-37423:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:46:49,495 - WARN  [Thread-37427:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n2010-11-24 15:47:49,541 - WARN  [Thread-37429:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.nio.channels.AsynchronousCloseException\n    at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)\n    at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:263)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2010-11-24 15:47:49,622 - WARN  [Thread-37428:QuorumCnxManager$SendWorker@581] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:1899)\n    at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:1976)\n    at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:342)\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:570)\n2010-11-24 15:47:49,622 - WARN  [Thread-37428:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2010-11-24 15:48:48,827 - WARN  [Thread-37431:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.io.IOException: Channel eof\n    at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:630)\n\n\nWhat's more, the number of threads under the zookeeper process is still increasing time by time. It seems that , something is wrong in communication of the two servers. Have anyone met such problem before?", "created_at" : { "$date" : "2010-11-24T07:53:06.390+0000" }, "updated_at" : { "$date" : "2011-09-06T03:11:01.296+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511a5f627d6b0586a9dc" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Linux 2.6.9-52bs #2 SMP Fri Jan 26 13:34:38 CST 2007 x86_64 x86_64 x86_64 GNU/Linux" },
{ "_id" : { "$oid" : "5b7d511b5f627d6b0586a9e6" }, "external_id" : "ZOOKEEPER-650", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Servers cannot join in quorum", "desc" : "Server fails to join ensemble.", "created_at" : { "$date" : "2010-01-19T10:59:43.893+0000" }, "updated_at" : { "$date" : "2011-09-06T15:57:32.114+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.1" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux 2.6.9 x86_64" },
{ "_id" : { "$oid" : "5b7d511c5f627d6b0586a9ef" }, "external_id" : "ZOOKEEPER-628", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the ephemeral node wouldn't disapper due to session close error", "desc" : "I find a very strange scenario today, I'm not sure how it happen, I just found it like this. Maybe you can give me some information about it, my Zookeeper Server is version 3.2.1.\n\nMy Zookeeper cluster contains three servers, with ip: 10.81.12.144,10.81.12.145,10.81.12.141. I wrote a client to create ephemeral node under znode: se/diserver_tc. The client runs on the server with ip 10.81.13.173. The client can create a ephemeral node on zookeeper server and write the host ip (10.81.13.173) in to the node as its data. There is only one client process can be running at a time, because the client will listen to a certain port.\n\nIt is strange that I found there were two ephemeral node with the ip 10.81.13.173 under znode se/diserver_tc.\nse/diserver_tc/diserver_tc0000000067\nSTAT:\n        czxid: 124554079820\n        mzxid: 124554079820\n        ctime: 1260609598547\n        mtime: 1260609598547\n        version: 0\n        cversion: 0\n        aversion: 0\n        ephemeralOwner: 226627854640480810\n        dataLength: 92\n        numChildren: 0\n        pzxid: 124554079820\n\nse/diserver_tc/diserver_tc0000000095\nSTAT:\n        czxid: 128849019107\n        mzxid: 128849019107\n        ctime: 1260772197356\n        mtime: 1260772197356\n        version: 0\n        cversion: 0\n        aversion: 0\n        ephemeralOwner: 154673159808876591\n        dataLength: 92\n        numChildren: 0\n        pzxid: 128849019107\n\nThere are TWO with different session id! And after I kill the client process on the server 10.81.13.173, the se/diserver_tc/diserver_tc0000000095 node disappear, but the se/diserver_tc/diserver_tc0000000067 stay the same. That means it is not my coding mistake to create the node twice. I checked several times and I'm sure that there is no another client instance running. And I use the 'stat' command to check the three zookeeper servers, and there is no client from 10.81.13.173,\n\n$echo stat | nc 10.81.12.144 2181   \nZookeeper version: 3.2.1-808558, built on 08/27/2009 18:48 GMT\nClients:\n /10.81.13.173:35676[1](queued=0,recved=0,sent=0) # it is caused by the nc process\n\nLatency min/avg/max: 0/3/254\nReceived: 11081\nSent: 0\nOutstanding: 0\nZxid: 0x1e000001f5\nMode: follower\nNode count: 32\n\n$ echo stat | nc 10.81.12.141 2181\nZookeeper version: 3.2.1-808558, built on 08/27/2009 18:48 GMT\nClients:\n /10.81.12.152:58110[1](queued=0,recved=10374,sent=0)\n /10.81.13.173:35677[1](queued=0,recved=0,sent=0) # it is caused by the nc process\n\nLatency min/avg/max: 0/0/37\nReceived: 37128\nSent: 0\nOutstanding: 0\nZxid: 0x1e000001f5\nMode: follower\nNode count: 26\n\n$ echo stat | nc 10.81.12.145 2181\nZookeeper version: 3.2.1-808558, built on 08/27/2009 18:48 GMT\nClients:\n /10.81.12.153:19130[1](queued=0,recved=10624,sent=0)\n /10.81.13.173:35678[1](queued=0,recved=0,sent=0) # it is caused by the nc process\n\nLatency min/avg/max: 0/2/213\nReceived: 26700\nSent: 0\nOutstanding: 0\nZxid: 0x1e000001f5\nMode: leader\nNode count: 26\n\nThe three 'stat' commands show different Node count! ", "created_at" : { "$date" : "2009-12-16T01:58:31.336+0000" }, "updated_at" : { "$date" : "2011-09-06T15:58:02.521+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux 2.6.9 x86_64" },
{ "_id" : { "$oid" : "5b7d511c5f627d6b0586a9f8" }, "external_id" : "ZOOKEEPER-515", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper quorum didn't provide service when restart after an \"Out of memory\" crash", "desc" : "The Zookeeper quorum, containing 5 servers, didn't provide service when restart after an \"Out of memory\" crash. \n\nIt happened as following:\n1. we built  a Zookeeper quorum which contained  5 servers, say 1, 3, 4, 5, 6 (have no 2), and 6 was the leader.\n2. we created 18 threads on 6 different servers to set and get data from a znode in the Zookeeper at the same time.  The size of the data is 1MB. The test threads did their job as fast as possible, no pause between two operation, and they repeated the setting and getting 4000 times. \n3. the Zookeeper leader crashed about 10 mins  after the test threads started. The leader printed out the log:\n\n2009-08-25 12:00:12,301 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x523\n4223c2dc00b5 due to java.io.IOException: Read error\n2009-08-25 12:00:12,318 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x523\n4223c2dc00b6 due to java.io.IOException: Read error\n2009-08-25 12:03:44,086 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x523\n4223c2dc00b8 due to java.io.IOException: Read error\n2009-08-25 12:04:53,757 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x523\n4223c2dc00b7 due to java.io.IOException: Read error\n2009-08-25 12:15:45,151 - FATAL [SyncThread:0:SyncRequestProcessor@131] - Severe unrecoverable error, exiting\njava.lang.OutOfMemoryError: Java heap space\n    at java.util.Arrays.copyOf(Arrays.java:2786)\n    at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:71)\n    at java.io.DataOutputStream.writeInt(DataOutputStream.java:180)\n    at org.apache.jute.BinaryOutputArchive.writeInt(BinaryOutputArchive.java:55)\n    at org.apache.zookeeper.txn.SetDataTxn.serialize(SetDataTxn.java:42)\n    at org.apache.zookeeper.server.persistence.Util.marshallTxnEntry(Util.java:262)\n    at org.apache.zookeeper.server.persistence.FileTxnLog.append(FileTxnLog.java:154)\n    at org.apache.zookeeper.server.persistence.FileTxnSnapLog.append(FileTxnSnapLog.java:268)\n    at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:100)\n\nIt is clear that the leader ran out of memory. then the server 4 was down almost at the same time, and printed out the log:\n2009-08-25 12:15:45,995 - ERROR [FollowerRequestProcessor:3:FollowerRequestProcessor@91] - Unexpected exception causing\nexit\njava.net.SocketException: Connection reset\n    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:96)\n    at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n    at java.io.BufferedOutputStream.write(BufferedOutputStream.java:105)\n    at java.io.DataOutputStream.write(DataOutputStream.java:90)\n    at java.io.FilterOutputStream.write(FilterOutputStream.java:80)\n    at org.apache.jute.BinaryOutputArchive.writeBuffer(BinaryOutputArchive.java:119)\n    at org.apache.zookeeper.server.quorum.QuorumPacket.serialize(QuorumPacket.java:51)\n    at org.apache.jute.BinaryOutputArchive.writeRecord(BinaryOutputArchive.java:123)\n    at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:97)\n    at org.apache.zookeeper.server.quorum.Follower.request(Follower.java:399)\n    at org.apache.zookeeper.server.quorum.FollowerRequestProcessor.run(FollowerRequestProcessor.java:86)\n2009-08-25 12:15:45,996 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x423\n4ab894330075 due to java.net.SocketException: Broken pipe\n2009-08-25 12:15:45,996 - FATAL [SyncThread:3:SyncRequestProcessor@131] - Severe unrecoverable error, exiting\njava.net.SocketException: Broken pipe\n    at java.net.SocketOutputStream.socketWrite0(Native Method)\n    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n    at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n    at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:100)\n    at org.apache.zookeeper.server.quorum.SendAckRequestProcessor.flush(SendAckRequestProcessor.java:52)\n    at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:147)\n    at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:92)\n2009-08-25 12:15:45,995 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@309] - Exception when following the leader\njava.net.SocketException: Broken pipe\n    at java.net.SocketOutputStream.socketWrite0(Native Method)\n    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n    at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n    at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:100)\n    at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:256)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-08-25 12:15:46,022 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 12:15:46,022 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 12:15:46,023 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n\nIt was really strange that when the 2 server down, the other three servers cannot provide service any more, the 'stat' command all leaded to \"ZooKeeperServer not running\".\n\n\n4. I restarted the server 6(the former leader) and the server 4. But the service didn't come back. All the five servers printed \"ZookeeperServer not running\". The server 6 printed the logs:\n\n2009-08-25 14:02:15,395 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:02:27,703 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: Responded to info probe\n2009-08-25 14:02:28,733 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:02:42,070 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:02:55,407 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:03:08,744 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:03:22,080 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:03:29,396 - ERROR [main:Util@238] - Last transaction was partial.\n2009-08-25 14:03:35,417 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n2009-08-25 14:03:48,761 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running \n\nThe server 4 printed logs like:\n\n2009-08-25 14:03:48,747 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 14:04:02,091 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 14:04:15,427 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 14:04:17,816 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@164] - Unexpected exception, tries=0\njava.net.ConnectException: Connection refused\n    at java.net.PlainSocketImpl.socketConnect(Native Method)\n    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n    at java.net.Socket.connect(Socket.java:525)\n    at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:156)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-08-25 14:04:18,820 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@164] - Unexpected exception, tries=1\njava.net.ConnectException: Connection refused\n    at java.net.PlainSocketImpl.socketConnect(Native Method)\n    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n    at java.net.Socket.connect(Socket.java:525)\n    at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:156)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-08-25 14:04:19,823 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@164] - Unexpected exception, tries=2\njava.net.ConnectException: Connection refused\n    at java.net.PlainSocketImpl.socketConnect(Native Method)\n    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n    at java.net.Socket.connect(Socket.java:525)\n    at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:156)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-08-25 14:04:28,764 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 14:04:42,101 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n\nthe server 1, 3, 5 printed out the logs like:\n\n2009-08-25 14:01:35,396 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: ZooKeeperServer not running\n2009-08-25 14:01:36,554 - WARN  [QuorumPeer:/0.0.0.0:2181:LeaderElection@194] - Ignoring exception while looking for lea\nder\njava.net.SocketTimeoutException: Receive timed out \n    at java.net.PlainDatagramSocketImpl.receive0(Native Method)\n    at java.net.PlainDatagramSocketImpl.receive(PlainDatagramSocketImpl.java:136)\n    at java.net.DatagramSocket.receive(DatagramSocket.java:712)\n    at org.apache.zookeeper.server.quorum.LeaderElection.lookForLeader(LeaderElection.java:170)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:488)\n2009-08-25 14:01:37,758 - WARN  [QuorumPeer:/0.0.0.0:2181:LeaderElection@194] - Ignoring exception while looking for lea\nder\njava.net.SocketTimeoutException: Receive timed out \n    at java.net.PlainDatagramSocketImpl.receive0(Native Method)\n    at java.net.PlainDatagramSocketImpl.receive(PlainDatagramSocketImpl.java:136)\n    at java.net.DatagramSocket.receive(DatagramSocket.java:712)\n    at org.apache.zookeeper.server.quorum.LeaderElection.lookForLeader(LeaderElection.java:170)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:488)\n2009-08-25 14:01:37,865 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@164] - Unexpected exception, tries=0\njava.net.ConnectException: Connection refused\n    at java.net.PlainSocketImpl.socketConnect(Native Method)\n    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n    at java.net.Socket.connect(Socket.java:525)\n    at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:156)\n    at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498)\n2009-08-25 14:01:38,289 - WARN  [NIOServerCxn.Factory:2181:NIOServerCnxn@497] - Exception causing close of session 0x0 d\nue to java.io.IOException: Responded to info probe\n\n\nmy zoo.cfg is like:\ntickTime=2000\ndataDir=./status/\nclientPort=2181\ninitLimit=10\nsyncLimit=2\nserver.1=10.81.11.107:2888:3888\nserver.2=10.81.11.106:2888:3888\nserver.3=10.81.11.89:2888:3888\nserver.4=10.81.11.99:2888:3888\nserver.5=10.81.11.79:2888:3888\n\nSeveral questions:\n1. Why the leader selection failed after the restart?\n2. Is the size of data too big to be processed properly?\n3. How can I recover from this situation? Can I just remove the version-2 directory on server 6(the former leader) and restart the server?\n\n", "created_at" : { "$date" : "2009-08-25T13:10:58.350+0000" }, "updated_at" : { "$date" : "2011-09-06T16:01:35.659+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ], "environment" : "Linux 2.6.9-52bs-4core #2 SMP Wed Jan 16 14:44:08 EST 2008 x86_64 x86_64 x86_64 GNU/Linux\nJdk: 1.6.0_14 " },
{ "_id" : { "$oid" : "5b7d511d5f627d6b0586aa03" }, "external_id" : "ZOOKEEPER-9", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Set socket linger longer for commands", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1888835&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:07:39.971+0000" }, "updated_at" : { "$date" : "2011-09-06T16:14:51.437+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d511e5f627d6b0586aa07" }, "external_id" : "ZOOKEEPER-33", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Better ACL management", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1945175&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:34:27.650+0000" }, "updated_at" : { "$date" : "2011-09-07T14:49:25.952+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511e5f627d6b0586aa06" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d511e5f627d6b0586aa06" }, "external_id" : "ZOOKEEPER-1173", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "labels" : [ "acl" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511f5f627d6b0586aa30" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d511e5f627d6b0586aa07" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d511f5f627d6b0586aa2f" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "created_at" : { "$date" : "2011-09-07T14:47:52.749+0000" }, "updated_at" : { "$date" : "2011-09-07T14:49:26.798+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "priority" : "Major", "title" : "Server never forgets old ACL lists", "issue_type" : "Bug", "desc" : "The ACL stuff in DataTree.java reimplements a kind of reference system. The idea may have been to save memory for equal ACL lists. However there's no code that ever removes an ACL list that is not used anymore.\n\nRelated: \n- The ACL stuff could be in a separate class so that DataTree.java is not such a big beast anymore.\n- It's risky to have mutable objects (list) as keys in a HashMap.\n\nAn idea to solve this: Have ACL lists as members of the datatree nodes. Lookup already existing ACL lists in a java.util.WeakHashMap.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d511f5f627d6b0586aa2f" }, "external_id" : "ZOOKEEPER-1035", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1", "3.3.2" ], "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511e5f627d6b0586aa06" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2011-03-28T08:36:50.289+0000" }, "updated_at" : { "$date" : "2011-09-07T14:49:26.823+0000" }, "reporter_id" : { "$oid" : "5b7d5120e9214a0d1608d8f2" }, "creator_id" : { "$oid" : "5b7d5120e9214a0d1608d8f2" }, "priority" : "Major", "title" : "CREATOR_ALL_ACL does not work together with IPAuthenticationProvider", "issue_type" : "Bug", "desc" : "We were trying to use the predefined ACL \"Ids.CREATOR_ALL_ACL\" together with the default ip authentication. Unfortunately it seems that this cannot work due to the implementation of the PrepRequestProcessor.fixupACL() method checking the return value of the AuthenticationProvider.isAuthenticated() (the IPAuthenticationProvider in our case) method. \nUnfortunately this provider always returns false which results in the Ids.CREATOR_ALL_ACL to be always rejected.\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d51215f627d6b0586aa36" }, "external_id" : "ZOOKEEPER-1175", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "DataNode references parent node for no reason", "desc" : "Having the parent referenced in a node makes the tree building harder then it needs to be. With the parent you need to get the parent before you can create the DataNode. Without the parent in the DataNode one can have a method tree.put(String path, new DataNode(...)).", "created_at" : { "$date" : "2011-09-08T18:53:17.326+0000" }, "updated_at" : { "$date" : "2011-09-15T10:56:36.207+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51215f627d6b0586aa48" }, "external_id" : "ZOOKEEPER-1170", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix compiler (eclipse) warnings: unused imports, unused variables, missing generics", "desc" : "IDE warnings get useless if there are too many of them. This issue + patch fixes nearly the rest of them.", "created_at" : { "$date" : "2011-09-02T19:12:20.469+0000" }, "updated_at" : { "$date" : "2011-09-15T10:56:36.628+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51225f627d6b0586aa58" }, "external_id" : "ZOOKEEPER-1188", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "client should detect a broken-network itself", "desc" : "Client receive session expire event after the connection with servers has recovered. But I think client should get it itself, after stay in lossconnecion for a session_expire_time period. Why we always wait for the message from servers?", "created_at" : { "$date" : "2011-09-16T02:47:25.446+0000" }, "updated_at" : { "$date" : "2011-09-16T02:47:25.446+0000" }, "creator_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "reporter_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51235f627d6b0586aa59" }, "external_id" : "ZOOKEEPER-1182", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make findbugs usable in Eclipse", "desc" : "I did not find any way how one could tell the eclipse findbugs extension to ignore the java files under src/java/test. I already use src/java/test/config/findbugsExcludeFile.xml but there are still many findbug warnings.\n\nSo this patch solves the most obvious findbugs warnings under src/java/test. There are 30 remaining warnings which could either be ignored in the exclude file or solved by somebody with more knowledge about the code.", "created_at" : { "$date" : "2011-09-14T09:42:30.527+0000" }, "updated_at" : { "$date" : "2011-09-17T10:56:12.547+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51235f627d6b0586aa6b" }, "external_id" : "ZOOKEEPER-1184", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "jute generated files are not being cleaned up via \"ant clean\"", "desc" : "The change for ZOOKEEPER-96 has removed the generated files from SVN, it seems that these files should now live under build subdir? If this change is made be sure that the C/contrib/recipes environment is not broken...", "created_at" : { "$date" : "2011-09-14T22:48:04.293+0000" }, "updated_at" : { "$date" : "2011-09-17T10:56:12.689+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51255f627d6b0586aa78" }, "external_id" : "ZOOKEEPER-1176", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove dead code and basic cleanup in DataTree", "desc" : "- DataTree members scount, initialized and method listACLEquals are never used\n- transform if(!C) B else A to if(C) A else B (removes one indirection to follow for the brain)\n- remove unused imports and one annotation\n- add method getApproximateDataSize to DataNode (I work towards an immutable DataNode without public properties)\n- move assignments (lastPrefix = getMaxPrefixWithQuota(path)) out of if statements\n- combine nested if statements: if A if B then C => if A && B => C\n- make ACL maps private and add getAclSize() to hide implementation details of the ACLs.\n", "created_at" : { "$date" : "2011-09-09T15:44:28.353+0000" }, "updated_at" : { "$date" : "2011-09-17T10:56:12.822+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51265f627d6b0586aa9e" }, "external_id" : "ZOOKEEPER-1078", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51265f627d6b0586aa9f" }, "external_id" : "ZOOKEEPER-899", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Update Netty version in trunk to 3.2.2", "desc" : "The patch for ZOOKEEPER-823 already has netty version 3.2.1.Final while trunk has still 3.1.5.GA. Could you please update the netty version in trunk so that we can rule out the version difference a s a cause for the failures? Note that the most recent version of netty is already 3.2.2, not 3.2.1 as in ZOOKEEPER-823\n\n-    <dependency org=\"org.jboss.netty\" name=\"netty\" conf=\"default\" rev=\"3.1.5.GA\">\n+    <dependency org=\"org.jboss.netty\" name=\"netty\" conf=\"default\" rev=\"3.2.1.Final\">", "created_at" : { "$date" : "2010-10-15T12:49:55.921+0000" }, "updated_at" : { "$date" : "2011-09-17T10:56:12.419+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51265f627d6b0586aa9e" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51275f627d6b0586aabb" }, "external_id" : "ZOOKEEPER-556", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Startup messages should account for common error of missing leading slash in config files", "desc" : "It would be nice if the startup noticed directories without a leading slash in the config file.  That is worth a warning.\n\nMoreover, if that directory exists looking from root, but not looking from the current directory, a very serious warning is in order.\n\n", "created_at" : { "$date" : "2009-10-22T22:16:22.905+0000" }, "updated_at" : { "$date" : "2011-09-17T10:56:12.957+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51285f627d6b0586aadf" }, "external_id" : "ZOOKEEPER-1196", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve Kerberos name parsing and canonicalization testing", "desc" : "Currently we are not testing Kerberos name parsing. Kerberos name parsing is error prone because Keberos principals are complex; see http://web.mit.edu/kerberos/krb5-1.5/krb5-1.5.4/doc/krb5-user/What-is-a-Kerberos-Principal_003f.html. \n\nBugs such as https://issues.apache.org/jira/browse/ZOOKEEPER-1195 would have been caught, had we better tests. Although we cannot test (yet) a full end-to-end KDC realm, we can at least test Kerberos principal syntax and semantics.", "created_at" : { "$date" : "2011-09-20T17:28:11.253+0000" }, "updated_at" : { "$date" : "2011-09-24T14:32:23.876+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server", "tests" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51285f627d6b0586aade" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51295f627d6b0586aae3" }, "external_id" : "ZOOKEEPER-1211", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client's package name", "desc" : "the package name of c client is \"c-client-src\",\nwhich lead the include file to be installed to /usr/local/include/c-client-src.\n\nit's a bit annoying since user need to manual rename it to zookeeper.\n\ni think there are two fix,\n1) change autoconf package name to \"zookeeper\", then the header will be installed to\n   zookeeper subdir, which is consistent with the README;\n2) change pkginclude_HEADER to include_HEADER, which will install headers to /usr/local/include.\n", "created_at" : { "$date" : "2011-09-30T09:07:25.159+0000" }, "updated_at" : { "$date" : "2011-10-13T02:28:14.924+0000" }, "creator_id" : { "$oid" : "5b7d5129e9214a0d1608d8f5" }, "reporter_id" : { "$oid" : "5b7d5129e9214a0d1608d8f5" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "centos 5" },
{ "_id" : { "$oid" : "5b7d512a5f627d6b0586aae8" }, "external_id" : "ZOOKEEPER-786", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Exception in ZooKeeper.toString", "desc" : "When trying to call ZooKeeper.toString during client disconnections, an exception can be generated:\n\n\n[04/06/10 15:39:57.744] ERROR Error while calling watcher \njava.lang.Error: java.net.SocketException: Socket operation on non-socket\n\tat sun.nio.ch.Net.localAddress(Net.java:128)\n\tat sun.nio.ch.SocketChannelImpl.localAddress(SocketChannelImpl.java:430)\n\tat sun.nio.ch.SocketAdaptor.getLocalAddress(SocketAdaptor.java:147)\n\tat java.net.Socket.getLocalSocketAddress(Socket.java:717)\n\tat org.apache.zookeeper.ClientCnxn.getLocalSocketAddress(ClientCnxn.java:227)\n\tat org.apache.zookeeper.ClientCnxn.toString(ClientCnxn.java:183)\n\tat java.lang.String.valueOf(String.java:2826)\n\tat java.lang.StringBuilder.append(StringBuilder.java:115)\n\tat org.apache.zookeeper.ZooKeeper.toString(ZooKeeper.java:1486)\n\tat java.util.Formatter$FormatSpecifier.printString(Formatter.java:2794)\n\tat java.util.Formatter$FormatSpecifier.print(Formatter.java:2677)\n\tat java.util.Formatter.format(Formatter.java:2433)\n\tat java.util.Formatter.format(Formatter.java:2367)\n\tat java.lang.String.format(String.java:2769)\n\tat com.echonest.cluster.ZooContainer.process(ZooContainer.java:544)\n\tat org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:488)\nCaused by: java.net.SocketException: Socket operation on non-socket\n\tat sun.nio.ch.Net.localInetAddress(Native Method)\n\tat sun.nio.ch.Net.localAddress(Net.java:125)\n\t... 15 more\n", "created_at" : { "$date" : "2010-06-04T21:25:32.946+0000" }, "updated_at" : { "$date" : "2011-10-17T01:00:39.355+0000" }, "creator_id" : { "$oid" : "5b7d512ae9214a0d1608d8f6" }, "reporter_id" : { "$oid" : "5b7d512ae9214a0d1608d8f6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "environment" : "Mac OS X, x86" },
{ "_id" : { "$oid" : "5b7d512b5f627d6b0586ab0e" }, "external_id" : "ZOOKEEPER-1233", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "throw RuntimeExceptions for Exceptions that \"should never happen\"", "desc" : "see effective java Ed2. item 65 (\"Don't ignore exceptions\"). If you're really sure, that the exception will never appear, then you shouldn't fear to rethrow it.", "created_at" : { "$date" : "2011-10-17T11:07:47.124+0000" }, "updated_at" : { "$date" : "2011-10-17T11:07:47.699+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d512c5f627d6b0586ab0f" }, "external_id" : "ZOOKEEPER-1224", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "problem across zookeeper clients when reading data written by other clients", "desc" : "create a java client \ncreate a persistent node using that client\nwrite data into the node  \nlike..\nZkClient zk = new ZkClient ( getZKServers () );\n        zk.createPersistent ( \"/amith\" , true );\n        zk.writeData ( \"/amith\", \"amith\" );\n        Object readData = zk.readData ( \"/amith\" );\n        LOGGER.logInfo (readData);\n\n        zk.delete ( \"/amith\" );\n\nand try to read the same using ZkCli.sh console client\n\n[zk: XXX.XXX.XXX.XXX:XXXXX(CONNECTED) 2] get /amith\ntamith\ncZxid = 0x100000004\nctime = Wed Oct 12 10:13:15 CST 2011\nmZxid = 0x100000005\nmtime = Wed Oct 12 10:13:15 CST 2011\npZxid = 0x100000004\ncversion = 0\ndataVersion = 1\naclVersion = 0\nephemeralOwner = 0x0\ndataLength = 12\nnumChildren = 0\n\ndata is displayed as tamith\nthis include some unwanted char\n\n \n\n\n\n", "created_at" : { "$date" : "2011-10-13T04:54:14.229+0000" }, "updated_at" : { "$date" : "2011-10-18T08:09:58.180+0000" }, "creator_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "reporter_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "issue_links" : [  ], "original_time_estimate" : 2419200, "environment" : "Zookeeper console client (i.e, zkCli.sh )\nand ZkClient\nwith 3 zookeeper quorum" },
{ "_id" : { "$oid" : "5b7d512d5f627d6b0586ab18" }, "external_id" : "ZOOKEEPER-1226", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "extract version check in separate method in PrepRequestProcessor", "desc" : "The following code is repeated 4 times and should be put in a method that either throws the Exception or returns the incremented version (see below).\n{code}\nversion = setDataRequest.getVersion();\nint currentVersion = nodeRecord.stat.getVersion();\nif (version != -1 && version != currentVersion) {\n    throw new KeeperException.BadVersionException(path);\n}\nversion = currentVersion + 1;\n{code}\n\n{code}\nprivate static int checkAndIncVersion(int currentVersion, int versionToCompare, String path )\n{code}", "created_at" : { "$date" : "2011-10-14T11:23:20.445+0000" }, "updated_at" : { "$date" : "2011-10-18T11:13:59.720+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51325f627d6b0586ab24" }, "external_id" : "ZOOKEEPER-1231", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "refactor int constants in o.a.z.s.q.Leader to enum", "desc" : "There are a couple of magic number in Leader, representing QuorumPackage types, like DIFF, TRUNC, SNAP, OBSERVERINFO, NEWLEADER, FOLLOWERINFO... These should rather be made an enum.", "created_at" : { "$date" : "2011-10-17T07:42:30.905+0000" }, "updated_at" : { "$date" : "2011-10-18T18:30:18.447+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51325f627d6b0586ab26" }, "external_id" : "ZOOKEEPER-1155", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add windows automated builds (CI) for zookeeper c client bindings", "desc" : "setup an CI build on windows to make sure that the new code checked in compiles fine on windows (VS compilers) for the zookeeper c bindings.\n\nThere is a ticket opened with the INFRA team to assign a build box and setup CI env for zookeeper c bindings\nhttps://issues.apache.org/jira/browse/INFRA-3842\n\nfeel free to help us with this effort, this will ensure that the new checkins dont break windows builds.", "created_at" : { "$date" : "2011-08-16T17:26:04.114+0000" }, "updated_at" : { "$date" : "2011-10-20T14:09:12.125+0000" }, "creator_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "reporter_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51335f627d6b0586ab33" }, "external_id" : "ZOOKEEPER-1221", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Provide accessors for Request.{hdr|txn}", "desc" : "I'm working on a larger patch that makes the Request class immutable. To see, where the hdr and txn fields are modified, it helped to introduce accessor methods. The JVM should happily inline the method calls so no performance overhead should be expected.\n\nThere's a minor, unrelated change included: ToBeAppliedRequestProcessor had a reference to the toBeApplied list of the Leader. So it was hard to find all places, where this list was actually modified. The patch gives instead the leader instance to the toBeAppliedRequestProcessor and the processor then accesses leader.toBeApplied.", "created_at" : { "$date" : "2011-10-12T13:20:35.030+0000" }, "updated_at" : { "$date" : "2011-10-21T10:55:40.222+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51345f627d6b0586ab4a" }, "external_id" : "ZOOKEEPER-1241", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Typo in ZooKeeper Recipes and Solutions documentation", "desc" : "In \"if p is the lowest process node in L, wait on highest process node in P\", \"P\" should be \"L\".", "created_at" : { "$date" : "2011-10-23T15:10:38.391+0000" }, "updated_at" : { "$date" : "2011-10-24T10:53:12.768+0000" }, "creator_id" : { "$oid" : "5b7d5134e9214a0d1608d8f8" }, "reporter_id" : { "$oid" : "5b7d5134e9214a0d1608d8f8" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5134e9214a0d1608d8f8" }, "issue_links" : [  ], "original_time_estimate" : 300 },
{ "_id" : { "$oid" : "5b7d51345f627d6b0586ab55" }, "external_id" : "ZOOKEEPER-1244", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "resolve remaining compiler warnings", "desc" : "The ZooKeeper main codebase, including tests, currently triggers only 5 warnings in eclipse. The remaining 5 warnings should be fixed by people knowing these classes better then me.\nOnce the warnings are down to zero it could be made a policy to keep it that way.\n\nThe contrib loggraph however has around 300 warnings, many of them missing generics.", "created_at" : { "$date" : "2011-10-25T06:59:20.322+0000" }, "updated_at" : { "$date" : "2011-10-25T06:59:50.432+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51355f627d6b0586ab58" }, "external_id" : "ZOOKEEPER-1245", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix compiler warnings in contrib loggraph", "desc" : "Eclipse shows around 300 compiler warnings in loggraph, many of them no-brainers like missing generics.", "created_at" : { "$date" : "2011-10-25T07:00:58.336+0000" }, "updated_at" : { "$date" : "2011-10-25T07:01:20.067+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51365f627d6b0586ab5b" }, "external_id" : "ZOOKEEPER-1216", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix more eclipse compiler warnings, also in Tests", "desc" : "I did set up a new work environment for a presentation of Eclipse+EGit+Gerrit+Jenkins and found more warnings that were ignored on my machine.\nWarnings are now down to 5! So no excuses to introduce new ones!\n\nFixed warnings:\n- removed unused imports\n- removed unused variables / methods\n- added missing generics\n- added ignore warnings for calls to deprecated code in tests\n", "created_at" : { "$date" : "2011-10-07T14:06:02.181+0000" }, "updated_at" : { "$date" : "2011-10-25T10:56:36.957+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51365f627d6b0586ab7a" }, "external_id" : "ZOOKEEPER-646", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Namespace partitioning in ZK ", "desc" : "Tracking JIRA for namespace partitioning in ZK \n\n\nFrom the mailing list (- courtesy: Mahadev / Flavio ) , discussion during Jan 2010 - \n\n\"Hi, Mahadev said it all, we have been thinking about it for a while, but\n>> haven't had time to work on it. I also don't think we have a jira open for\n>> it; at least I couldn't find one. But, we did put together some comments:\n>>\n>>    http://wiki.apache.org/hadoop/ZooKeeper/PartitionedZookeeper\n>>\n>> One of the main issues we have observed there is that partitioning will\n>> force us to change our consistency guarantees, which is far from ideal.\n>> However, some users seem to be ok with it, but I'm not sure we have\n>> agreement.\n>>\n>> In any case, please feel free to contribute or simply express your\n>> interests so that we can take them into account.\n>>\n>> Thanks,\n>> -Flavio\n>>\n>>\n>> On Jan 15, 2010, at 12:49 AM, Mahadev Konar wrote:\n>>\n> >>> Hi kay,\n> >>>  the namespace partitioning in zookeeper has been on a back burner for a\n> >>> long time. There isnt any jira open on it. There had been some\n> >>> discussions\n> >>> on this but no real work. Flavio/Ben have had this on there minds for a\n> >>> while but no real work/proposal is out yet.\n> >>>\n> >>> May I know is this something you are looking for in production?\n> >>>\n> >>> Thanks\n> >>> mahadev\n\"", "created_at" : { "$date" : "2010-01-15T20:51:15.019+0000" }, "updated_at" : { "$date" : "2011-10-26T02:07:46.037+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "external_id" : "ZOOKEEPER-1198", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "created_at" : { "$date" : "2011-09-22T09:00:34.710+0000" }, "updated_at" : { "$date" : "2011-10-27T06:41:18.711+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "priority" : "Major", "title" : "Refactorings and Cleanups", "issue_type" : "Improvement", "desc" : "Umbrella issue for refactorings. I'll post individual refactoring steps as sub-issues. I'll also use this umbrella issue to submit previews of the full refactoring for testing by Jenkins or to ReviewBoard.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d51385f627d6b0586abcc" }, "external_id" : "ZOOKEEPER-1254", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test correct watch handling with multi ops", "desc" : "I was wondering, what happens with watches that would be triggered by a multi op if subsequent ops fail. I didn't find a test for this, wrote one and everything was fine. :-)\n\nThe patch contains two additional test cases.", "created_at" : { "$date" : "2011-10-26T14:25:09.371+0000" }, "updated_at" : { "$date" : "2011-10-27T10:54:40.968+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51395f627d6b0586abd5" }, "external_id" : "ZOOKEEPER-1199", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make OpCode an enum", "desc" : "ZooDefs.OpCode is an interface with integer constants. Changing this to an enum provides safety. See \"Item 30: Use enums instead of int constants\" in Effective Java.", "created_at" : { "$date" : "2011-09-22T09:04:54.104+0000" }, "updated_at" : { "$date" : "2011-10-27T21:12:21.142+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513a5f627d6b0586abf3" }, "external_id" : "ZOOKEEPER-1204", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Shorten calls to ZooTrace", "desc" : "The calls to ZooTrace are kind of verbose and contain duplicated logic. This patch makes the calls as short as possible so that they do not distract that much from what's actually going on.\nCalls to LOG.isTraceEnabled() are removed at many places, because this check is done anyways inside ZooTracer. At some places it has been left, to avoid costly message creation.", "created_at" : { "$date" : "2011-09-26T15:46:04.287+0000" }, "updated_at" : { "$date" : "2011-10-27T22:03:37.605+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513b5f627d6b0586abff" }, "external_id" : "ZOOKEEPER-1234", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "basic cleanup in LearnerHandler", "desc" : "- order class members: properties, constructor, methods\n- make properties private final\n- rename version to protocolVersion\n- The integer value 0x10000 should be extracted to a constant with a declarative name. But since I don't yet fully understand its purpose, I've no idea for the name of the constant.\n- Initialize properties BinaryInpuutArchive ia, BinaryOutputArchive oa and BuferedOutputSream bufferedOutput in the constructor so that they can be made final.\n- Remove call to sock.setSoTimeout. All two users of the class set the sockettimeout anyways themselfes. This also removes a link to the Leader class.\n- remove unused method packetToString.", "created_at" : { "$date" : "2011-10-18T08:06:09.927+0000" }, "updated_at" : { "$date" : "2011-10-27T22:47:04.034+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513b5f627d6b0586ac0d" }, "external_id" : "ZOOKEEPER-1247", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "dead code in PrepRequestProcessor.pRequest multi case", "desc" : "There's an if statement in the for loop which sets the request.hdr.type and request.txn in case that an error happened in the preceding multiop. However hdr and txn are overwritten anyways at the end of the multi case. The values set are only used a bit later to serialize them. This could better be achieved with local variables holding the temporary hdr and txn.\n\nAlso the if condition (ke == null) in the catch block is pointless, since the surrounding if(ke != null) makes sure that the catch block could only ever be reached in a loop where ke == null.", "created_at" : { "$date" : "2011-10-25T11:24:39.531+0000" }, "updated_at" : { "$date" : "2011-10-28T10:55:18.781+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513c5f627d6b0586ac18" }, "external_id" : "ZOOKEEPER-1200", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove obsolete DataTreeBuilder", "desc" : "There's a DataTreeBuilder thing in the whole type hierarchy of ZooKeeperServer classes, which is never used.", "created_at" : { "$date" : "2011-09-22T13:34:19.857+0000" }, "updated_at" : { "$date" : "2011-10-28T10:55:19.137+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513d5f627d6b0586ac2e" }, "external_id" : "ZOOKEEPER-1252", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove unused method o.a.z.test.AxyncTest.restart()", "desc" : "see Summary.", "created_at" : { "$date" : "2011-10-26T12:55:03.053+0000" }, "updated_at" : { "$date" : "2011-10-28T10:55:19.489+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513d5f627d6b0586ac3d" }, "external_id" : "ZOOKEEPER-1266", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "\"request.getHdr() != null\" and \"isQuorum\" are identical", "desc" : "FinalRequestProcessor has this code block:\n{code:java}\n            if (request.getHdr() != null) {\n               ... SNIP ...\n            }\n            // do not add non quorum packets to the queue.\n            if (request.isQuorum()) {\n                zks.getZKDatabase().addCommittedProposal(request);\n            }\n{code}\n\nBoth conditions are equivalent so the two if blocks could actually be merged to one block.", "created_at" : { "$date" : "2011-10-28T13:58:44.005+0000" }, "updated_at" : { "$date" : "2011-10-28T16:52:22.362+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513e5f627d6b0586ac43" }, "external_id" : "ZOOKEEPER-1217", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove unnecessary MissingSessionException in ZooKeeperServer", "desc" : "MissingSessionException in only thrown and catched once inside this class and can as well be replaced by a boolean return value.\n\nWhile I'm at it: The method throwing this Exception makes more sense to be inlined in the one place from where it is called.", "created_at" : { "$date" : "2011-10-07T14:59:52.613+0000" }, "updated_at" : { "$date" : "2011-10-29T10:39:32.669+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Patch Available", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d513f5f627d6b0586ac59" }, "external_id" : "ZOOKEEPER-1265", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Normalize switch cases lists on request types", "desc" : "As discussed on the list, it's probably an error that the ReadOnlyRequestProcessor does not have multi alongside the other write operations.\nAdding check to the lists may not make a difference by now since the ZK client does not expose check as a first level request but only encapsulated inside a multi request. However from a logical view, change belongs in these lists.", "created_at" : { "$date" : "2011-10-28T13:35:46.865+0000" }, "updated_at" : { "$date" : "2011-10-29T10:56:49.761+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d513f5f627d6b0586ac66" }, "external_id" : "ZOOKEEPER-1267", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "closeSession flag in finalRequestProcessor is superfluous", "desc" : "The variable can be removed and instead where it is evaluated one can just check whether the request.type was OpCode.closesession. Removes one indirection from your head in a method that's long enough already.", "created_at" : { "$date" : "2011-10-28T14:16:33.098+0000" }, "updated_at" : { "$date" : "2011-10-29T10:56:49.940+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51405f627d6b0586ac6f" }, "external_id" : "ZOOKEEPER-1272", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper.multi() could violate API if server misbehaves", "desc" : "The client API method Zookeeper.multi() promisses, that the KeeperException it throws in case of one of the multi ops failing, contains a list of individual results.\n\nThe method ZooKeeper.multiInternal() however throws a Keeperexception if the returned response header has an error code != 0. This should actually never happen if the server does not misbehave since the error code of a multi response is always zero, but I managed to trigger this code path with my refactorings.", "created_at" : { "$date" : "2011-10-29T13:36:00.720+0000" }, "updated_at" : { "$date" : "2011-10-30T17:11:43.223+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51415f627d6b0586ac74" }, "external_id" : "ZOOKEEPER-233", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51415f627d6b0586ac75" }, "external_id" : "ZOOKEEPER-652", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "package server and client separately", "desc" : "is it possible split zookeeper.jar to zookeeper-server.jar and zookeeper-client.jar?\nso app can only use client jar ", "created_at" : { "$date" : "2010-01-22T11:10:12.298+0000" }, "updated_at" : { "$date" : "2011-11-01T10:05:13.955+0000" }, "creator_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "reporter_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51415f627d6b0586ac74" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d51415f627d6b0586ac7d" }, "external_id" : "ZOOKEEPER-1003", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "provide a separate client library jar ", "desc" : "This feature request applies to ZooKeeper, HBase, Hadoop and maybe other\nprojects. Currently, to use one of these projects, I need to include one big\njar file as a dependency, that\n\n- contains the complete server code,\n- contains much more code then I use\n- and most annoyingly depends on many other jars, that are mostly needed for the\nserver but not for the client library.\n\nThus when using maven and including any of the mentioned projects, the\ndependency graph of my projects grows unnecessarily large.\n\nThis is a severe problem for at least two reasons:\n- The probability of conflicting dependencies (versions) gets boosted.\n- Especially for mapreduce jobs depending on HBase or Zookeeper, the jars sent to the\nclusters grow to beyond 20-30MB of unnecessary dependencies.\n\nOne could work around the problem with maven dependency exclusions, but this may lead to unpredictable runtime errors (ClassNotFound) since dependency management is not save on compile time only.\n\nI wish we could solve the underlying issue at the root with a client library.", "created_at" : { "$date" : "2011-02-24T07:57:21.820+0000" }, "updated_at" : { "$date" : "2011-11-01T10:07:12.958+0000" }, "creator_id" : { "$oid" : "5b7d5141e9214a0d1608d8fc" }, "reporter_id" : { "$oid" : "5b7d5141e9214a0d1608d8fc" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [ "client", "dependencies", "maven", "library" ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51415f627d6b0586ac74" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d51425f627d6b0586ac82" }, "external_id" : "ZOOKEEPER-1273", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Copy'n'pasted unit test", "desc" : "Probably caused by the usage of a legacy VCS a code duplication happened when you moved from Sourceforge to Apache (ZOOKEEPER-38). The following file can be deleted:\nsrc/java/test/org/apache/zookeeper/server/DataTreeUnitTest.java\n\nsrc/java/test/org/apache/zookeeper/test/DataTreeTest.java was an exact copy of the above until ZOOKEEPER-1046 added an additional test case only to the latter.\n\nDo I need to upload a patch file for this?", "created_at" : { "$date" : "2011-10-30T18:33:08.107+0000" }, "updated_at" : { "$date" : "2011-11-01T10:57:28.804+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51435f627d6b0586ac8d" }, "external_id" : "ZOOKEEPER-1100", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51435f627d6b0586ac8e" }, "external_id" : "ZOOKEEPER-1186", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper client seems to hang quietly on OutOfMemoryError", "desc" : "ZooKeeper client seems to hang quietly on OutOfMemoryError.\n\nLook at code of ClientCnxn.SendThread.run:\n\n{code}\nvoid run() {\n  while (zooKeeper.state.isAlive()) {\n    try {\n      ...\n    } catch (Exception e) {\n      // handle exception and restart\n    }\n  }\n  ...\n}\n{code}\n\nIf OutOfMemoryError happens somewhere inside of try block, thread just exits and ZooKeeper hangs.\n\nClient should handle any Throwable same way it handles Exception.", "created_at" : { "$date" : "2011-09-15T13:21:48.242+0000" }, "updated_at" : { "$date" : "2011-11-01T16:06:45.351+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51435f627d6b0586ac8d" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d51445f627d6b0586ac94" }, "external_id" : "ZOOKEEPER-1250", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "trigger jenkins dummy issue", "desc" : "Sorry, I don't have my own servers for testing, so I need to upload patches here to run the ZK test suite.", "created_at" : { "$date" : "2011-10-25T17:09:56.184+0000" }, "updated_at" : { "$date" : "2011-11-02T15:58:09.044+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51455f627d6b0586ad10" }, "external_id" : "ZOOKEEPER-1280", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add current epoch number and timestamp of when it began to 4 letter words (stat, srvr, mntr maybe?)", "desc" : "It would be nice if there were some stats displayed about the current epoch in the 4 letter words.  At the very least it would be nice to expose the current epoch number (I know I could parse it from the Zxid but exposing it directly is more transparent) and the date of when the epoch began.", "created_at" : { "$date" : "2011-11-02T17:21:34.802+0000" }, "updated_at" : { "$date" : "2011-11-02T17:21:34.802+0000" }, "creator_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "reporter_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51465f627d6b0586ad11" }, "external_id" : "ZOOKEEPER-1284", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cleanup minor PrepRequestProcessor issues", "desc" : "Instead of having if statements in every switch case in pRequest2Txn, it is possible to have only one if statement before the switch case in pRequest.", "created_at" : { "$date" : "2011-11-03T09:35:14.919+0000" }, "updated_at" : { "$date" : "2011-11-03T10:13:32.969+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Patch Available", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51465f627d6b0586ad17" }, "external_id" : "ZOOKEEPER-1286", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumPeer contains unused constructor", "desc" : "The following constructor in QuorumPeer seems to be never used, starting at line 370 in my branch:\n{code:java}\n    /**\n     * For backward compatibility purposes, we instantiate QuorumMaj by default.\n     */\n\n    public QuorumPeer(Map<Long, QuorumServer> quorumPeers, File dataDir,\n            File dataLogDir, int electionType,\n            long myid, int tickTime, int initLimit, int syncLimit,\n            ServerCnxnFactory cnxnFactory) throws IOException {\n        this(quorumPeers, dataDir, dataLogDir, electionType, myid, tickTime,\n                initLimit, syncLimit, cnxnFactory,\n                new QuorumMaj(countParticipants(quorumPeers)));\n    }\n{code}", "created_at" : { "$date" : "2011-11-04T07:58:07.495+0000" }, "updated_at" : { "$date" : "2011-11-04T07:58:08.116+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Trivial", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51475f627d6b0586ad19" }, "external_id" : "ZOOKEEPER-1092", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "get rid of pending changes", "desc" : "pending changes used by PrepRequestProcessor and FinalRequestProcessor is complicated and requires synchronization between threads.", "created_at" : { "$date" : "2011-06-12T01:49:21.629+0000" }, "updated_at" : { "$date" : "2011-11-04T16:20:57.256+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is superceded by", "type" : "Supercedes" } ] },
{ "_id" : { "$oid" : "5b7d51475f627d6b0586ad1e" }, "external_id" : "ZOOKEEPER-1290", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper_init_with_watches", "desc" : "Our use of zookeeper requires high scalability, and the underlying data set is small and changes infrequently. A persisted cache is ideal for solving scalability. We want to treat a restart as if it were a prolonged reconnect - that is, maintain the last known zxid and watch list. We would like to expose a new zookeeper_init_with_watches api that allows the zhandle to be initialized with the watch list and last known zxid. The change would reuse the current reconnect logic.", "created_at" : { "$date" : "2011-11-05T02:04:25.695+0000" }, "updated_at" : { "$date" : "2011-11-05T06:06:57.690+0000" }, "creator_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "reporter_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51485f627d6b0586ad23" }, "external_id" : "ZOOKEEPER-675", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LETest thread fails to join", "desc" : "After applying the patch of ZOOKEEPER-569, I observed a failure of LETest. From a cursory inspection of the log, I can tell that a leader is being elected, but some thread is not joining. At this point I'm not sure if this is a problem with the leader election implementation or the test itself. \n\nJust to be clear, the patch of ZOOKEEPER-569 solved a real issue, but it seems that there is yet another problem with LETest.\n\n\n", "created_at" : { "$date" : "2010-02-20T14:32:41.349+0000" }, "updated_at" : { "$date" : "2011-11-10T12:30:44.514+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51495f627d6b0586ad34" }, "external_id" : "ZOOKEEPER-1251", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "call checkSession at begin of PrepRequestProcessor.pRequest", "desc" : "There are 6 locations that call checkSession. This can be reduced to one location and makes it also much clearer in which cases checkSession is called or not called.\n\nNote that in case that now the SessionMoved|Expired error is checked first before the check for a Marshalling error. However it shouldn't matter which error gets reported.", "created_at" : { "$date" : "2011-10-26T11:07:56.736+0000" }, "updated_at" : { "$date" : "2011-11-12T12:15:14.905+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Patch Available", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d514a5f627d6b0586ad4b" }, "external_id" : "ZOOKEEPER-1298", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "config,h gets emptied by make, at least on mac os x 10.6.8", "desc" : "configure creates a working config.h.\n\nOn Snow leopard, after running configure:\n\n  ls -l config.h\n  -rw-r--r--  1 jim  jim  4437 Nov 12 12:16 config.h\n\nwhich looks reasomnable.\n\nRunning make replaces config.h:\n\n  make\n  (CDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/sh /Users/jim/s/zookeeper-3.3.3/src/c/missing --run autoheader)\n  /opt/local/bin/gm4: cannot open `configure.in': No such file or directory\n  rm -f stamp-h1\n  touch config.h.in\n  cd . && /bin/sh ./config.status config.h\n  config.status: creating config.h\n  make  all-am\n  /bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c\n  libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./include -I./tests -I./generated -Wall -Werror -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c  -fno-common -DPIC -o .libs/zookeeper.o\n  src/zookeeper.c: In function 'log_env':\n  src/zookeeper.c:658: error: 'PACKAGE_STRING' undeclared (first use in this function)\n  src/zookeeper.c:658: error: (Each undeclared identifier is reported only once\n  src/zookeeper.c:658: error: for each function it appears in.)\n  cc1: warnings being treated as errors\n  src/zookeeper.c:647: warning: unused variable 'buf'\n  make[1]: *** [zookeeper.lo] Error 1\n  make: *** [all] Error 2\n\n\n  ls -l config.h\n  -rw-r--r--  1 jim  jim  137 Nov 12 12:17 config.h\n\nconfig.h is empty, except for a comment.\n\nIf I make a copy of config.h after configure and restore it after\nrunning the failed make, then I can run make again and the make\nsucceeds.\n\nOn a centos 5 vm, I can build just fine, but I suspect that has\nsomething to do with it not being happy with autoconf:\n\n  (CDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/sh /home/jim/s/zookeeper-3.3.3/src/c/missing --run autoheader)\n  aclocal.m4:20: warning: this file was generated for autoconf 2.67.\n  You have another version of autoconf.  It may work, but is not guaranteed to.\n  If you have problems, you may need to regenerate the build system entirely.\n  To do so, use the procedure documented by the package, typically `autoreconf'.\n  configure.ac:21: error: Autoconf version 2.62 or higher is required\n  aclocal.m4:8577: AM_INIT_AUTOMAKE is expanded from...\n  configure.ac:21: the top level\n  autom4te: /usr/bin/m4 failed with exit status: 63\n  autoheader: /usr/bin/autom4te failed with exit status: 63\n  WARNING: `autoheader' is probably too old.  You should only need it if\n           you modified `acconfig.h' or `configure.ac'.  You might want\n           to install the `Autoconf' and `GNU m4' packages.  Grab them\n           from any GNU archive site.\n  rm -f stamp-h1\n  touch config.h.in\n  cd . && /bin/sh ./config.status config.h\n  config.status: creating config.h\n  config.status: config.h is unchanged\n  ...\n\nI'm pretty clueless wrt autoconf.\n\nI can work around this by touching config.h.in before running\nconfigure. That seems to lead to a clean make, presumably by bypassing\nthe autoconf step.  I don't know if that matters. :)\n\nMy goal is to automate building on at least unix-like systems as part\nof building a self-contained source distribution of the Python\nextension that builds by just running it's setup script.\n", "created_at" : { "$date" : "2011-11-12T17:29:01.374+0000" }, "updated_at" : { "$date" : "2011-11-12T17:29:01.374+0000" }, "creator_id" : { "$oid" : "5b7d514ae9214a0d1608d900" }, "reporter_id" : { "$oid" : "5b7d514ae9214a0d1608d900" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Mac OS X 10.6.8" },
{ "_id" : { "$oid" : "5b7d514b5f627d6b0586ad4c" }, "external_id" : "ZOOKEEPER-1243", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "New 4lw for short simple monitoring ldck", "desc" : "The existing monitoring fails so often due to https://issues.apache.org/jira/browse/ZOOKEEPER-1197 that we need a workaround. This introduces a short 4lw called ldck that just runs ServerStats.toString to get information about the sever's leadership status.", "created_at" : { "$date" : "2011-10-24T14:43:08.762+0000" }, "updated_at" : { "$date" : "2011-11-17T06:05:07.819+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Improvement", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d514b5f627d6b0586ad60" }, "external_id" : "ZOOKEEPER-1088", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "delQuota does not remove the quota node and subesquent setquota calls for that path will fail", "desc" : "sequota -b 1000 /testing\ndelquota -b /testing\nsetquota -n 1024 /testing\nCommand failed: java.lang.IllegalArgumentException: /testing has a parent /zookeeper/quota/testing which has a quota\n", "created_at" : { "$date" : "2011-06-08T20:04:14.955+0000" }, "updated_at" : { "$date" : "2011-11-17T06:05:53.905+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ], "original_time_estimate" : 86400 },
{ "_id" : { "$oid" : "5b7d51a05f627d6b0586b9a0" }, "external_id" : "ZOOKEEPER-1125", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ae5f627d6b0586bc71" }, "external_id" : "ZOOKEEPER-915", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c75f627d6b0586bfc1" }, "external_id" : "BOOKKEEPER-2", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c75f627d6b0586bfcd" }, "external_id" : "ZOOKEEPER-807", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51d15f627d6b0586c131" }, "external_id" : "ZOOKEEPER-954", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51de5f627d6b0586c222" }, "external_id" : "ZOOKEEPER-740", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52075f627d6b0586c707" }, "external_id" : "ZOOKEEPER-1346", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52255f627d6b0586ca11" }, "external_id" : "HIVE-2712", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d522e5f627d6b0586cae1" }, "external_id" : "ZOOKEEPER-1277", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52305f627d6b0586cb08" }, "external_id" : "HADOOP-8149", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d524d5f627d6b0586cd3f" }, "external_id" : "ZOOKEEPER-1495", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52545f627d6b0586cdba" }, "external_id" : "HADOOP-6941", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52755f627d6b0586d0fc" }, "external_id" : "ZOOKEEPER-1437", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52885f627d6b0586d236" }, "external_id" : "ZOOKEEPER-1557", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52af5f627d6b0586d5cb" }, "external_id" : "ZOOKEEPER-474", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52b15f627d6b0586d60a" }, "external_id" : "BOOKKEEPER-4", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52bb5f627d6b0586d6f4" }, "external_id" : "HADOOP-7853", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52bc5f627d6b0586d742" }, "external_id" : "ZOOKEEPER-1408", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52bd5f627d6b0586d764" }, "external_id" : "ZOOKEEPER-1564", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c05f627d6b0586d7a2" }, "external_id" : "ZOOKEEPER-1540", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c05f627d6b0586d7a3" }, "external_id" : "ZOOKEEPER-1660", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52cb5f627d6b0586d999" }, "external_id" : "DOSGI-191", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e35f627d6b0586dc07" }, "external_id" : "HADOOP-8315", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e45f627d6b0586dc11" }, "external_id" : "ZOOKEEPER-1512", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e95f627d6b0586dca3" }, "external_id" : "ZOOKEEPER-1777", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc4" }, "external_id" : "HBASE-7022", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53035f627d6b0586de1a" }, "external_id" : "ZOOKEEPER-1681", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530a5f627d6b0586ded4" }, "external_id" : "SOLR-4526", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d531a5f627d6b0586e015" }, "external_id" : "ZOOKEEPER-1829", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c035f627d846d496d60" }, "external_id" : "BIGTOP-65", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c035f627d846d496d61" }, "external_id" : "HADOOP-7069", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ab5f627d6b0586bc3b" }, "external_id" : "ZOOKEEPER-925", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "documentation" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51ab5f627d6b0586bc3c" }, "type" : "Reference", "effect" : "is related to" }, { "issue_id" : { "$oid" : "5b904c035f627d846d496d61" }, "type" : "Reference", "effect" : "relates to" }, { "issue_id" : { "$oid" : "5b904c035f627d846d496d60" }, "type" : "Reference", "effect" : "relates to" }, { "issue_id" : { "$oid" : "5b904c035f627d846d496d62" }, "type" : "Reference", "effect" : "is related to" }, { "issue_id" : { "$oid" : "5b904c035f627d846d496d63" }, "type" : "Reference", "effect" : "is related to" } ], "issue_type" : "Wish", "desc" : "See WHIRR-19 for some background.\n\nIn whirr we looked at a number of site/doc generation facilities. In the end Maven site generation plugin turned out to be by far the best option. You can see our nascent site here (no attempt at styling,etc so far):\nhttp://incubator.apache.org/whirr/\n\nIn particular take a look at the quick start:\nhttp://incubator.apache.org/whirr/quick-start-guide.html\nwhich was generated from\nhttp://svn.apache.org/repos/asf/incubator/whirr/trunk/src/site/confluence/quick-start-guide.confluence\nnotice this was standard wiki markup (confluence wiki markup, same as available from apache)\n\nYou can read more about mvn site plugin here:\nhttp://maven.apache.org/guides/mini/guide-site.html\nNotice that other formats are available, not just confluence markup, also note that you can use different markup formats if you like in the same site (although probably not a great idea, but in some cases might be handy, for example whirr uses the confluence wiki, so we can pretty much copy/paste source docs from wiki to our site (svn) if we like)\n\n\nRe maven vs our current ant based build. It's probably a good idea for us to move the build to maven at some point. We could initially move just the doc generation, and then incrementally move functionality from build.xml to mvn over a longer time period.\n", "priority" : "Major", "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "status" : "Open", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2014-01-27T03:58:28.471+0000" }, "title" : "Consider maven site generation to replace our forrest site and documentation generation", "created_at" : { "$date" : "2010-11-09T01:53:00.325+0000" } },
{ "_id" : { "$oid" : "5b904c045f627d846d496d8e" }, "external_id" : "ZOOKEEPER-1870", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c045f627d846d496d90" }, "external_id" : "ZOOKEEPER-1691", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add a flag to disable standalone mode", "desc" : "Currently you cannot use dynamic reconfiguration to bootstrap zookeeper cluster because the server goes into standalone mode when there is only one server in the cluster.\n\n--Michi", "created_at" : { "$date" : "2013-04-15T19:41:40.069+0000" }, "updated_at" : { "$date" : "2014-01-28T18:47:58.027+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b904c0410ae152115d28d4e" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904c045f627d846d496d8e" }, "type" : "Reference", "effect" : "relates to" }, { "issue_id" : { "$oid" : "5b904c045f627d846d496d8f" }, "type" : "Reference", "effect" : "relates to" } ] },
{ "_id" : { "$oid" : "5b904c055f627d846d496dd4" }, "external_id" : "ZOOKEEPER-1847", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Normalize line endings in repository", "desc" : "It is good practice to have all the code in the repository use the same line endings (LF) so that patches can be applied normally. We can add a gitattributes file so that checked out code can still have platform dependent line endings. \n\nMore readings: \nhttps://help.github.com/articles/dealing-with-line-endings\nhttp://stackoverflow.com/questions/170961/whats-the-best-crlf-handling-strategy-with-git\n", "created_at" : { "$date" : "2013-12-17T23:05:22.045+0000" }, "updated_at" : { "$date" : "2014-02-05T21:31:38.248+0000" }, "creator_id" : { "$oid" : "5b7d52e7e9214a0d1608d9d1" }, "reporter_id" : { "$oid" : "5b7d52e7e9214a0d1608d9d1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52e7e9214a0d1608d9d1" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c065f627d846d496de0" }, "external_id" : "ZOOKEEPER-1874", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add proper teardown/cleanups in ReconfigTest to shutdown quorumpeer", "desc" : "This jira to provide proper cleanups in ReconfigTest test cases.", "created_at" : { "$date" : "2014-02-02T04:58:03.944+0000" }, "updated_at" : { "$date" : "2014-02-12T02:29:23.968+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904c065f627d846d496ddf" } },
{ "_id" : { "$oid" : "5b904c075f627d846d496dee" }, "external_id" : "ZOOKEEPER-1861", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ConcurrentHashMap isn't used properly in QuorumCnxManager", "desc" : "queueSendMap is a ConcurrentHashMap.\nAt line 210:\n{code}\n            if (!queueSendMap.containsKey(sid)) {\n                queueSendMap.put(sid, new ArrayBlockingQueue<ByteBuffer>(\n                        SEND_CAPACITY));\n{code}\nBy the time control enters if block, there may be another concurrent put with same sid to the ConcurrentHashMap.\nputIfAbsent() should be used.\n\nSimilar issue occurs at line 307 as well.", "created_at" : { "$date" : "2014-01-11T23:50:07.335+0000" }, "updated_at" : { "$date" : "2014-02-14T03:03:33.332+0000" }, "creator_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "reporter_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c075f627d846d496e0b" }, "external_id" : "ZOOKEEPER-1886", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Exception in Follower.followLeader() where Leader is still running, can make that follower hang in LeaderElection", "desc" : "SocketTimeoutException in {{Follower#followLeader()}} where the leader is successfully running can make this follower not able to rejoin the quorum.\n\nAnalysis:\n1. SocketTimeoutException in below code, will make follower to stop following (Not process shutdown) and try to participate in leader election again. \n{code}                while (self.isRunning()) {\n                    readPacket(qp);\n                    processPacket(qp);\n                }{code}\n\n2. At the time of leader election {{FastLeaderElection#logicalclock}} will be incremented at only follower side, and this is more than electionEpoch of the leader.\n\n3. Notification from the Leader will get ignored and from this follower notifications will be continously sent and again ignored.\n\n", "created_at" : { "$date" : "2014-02-21T05:35:58.588+0000" }, "updated_at" : { "$date" : "2014-02-21T05:35:58.588+0000" }, "creator_id" : { "$oid" : "5b7d52dfe9214a0d1608d9cb" }, "reporter_id" : { "$oid" : "5b7d52dfe9214a0d1608d9cb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c085f627d846d496e0c" }, "external_id" : "ZOOKEEPER-1885", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Znodes deletable by anyone without having the rights to do so", "desc" : "Hi,\n\nI'm not really sure if this is a bug or a misunderstanding on my part, but I have the problem that, when I create a znode with an ACL as follows:\n\n{noformat}\n[zk: localhost:2181(CONNECTED) 60] create /anode \"somecontent\" digest:'user:IAEttLCxci/qWhKN2QJ6u1nrQgw=':cdrwa\nCreated /anode\n[zk: localhost:2181(CONNECTED) 61] getAcl /anode                                                               \n'digest,''user:IAEttLCxci/qWhKN2QJ6u1nrQgw='\n: cdrwa\n{noformat}\n\nI am not able to read or update the content of the node, as it should be:\n\n{noformat}\n[zk: localhost:2181(CONNECTED) 62] get /anode\nAuthentication is not valid : /anode\n[zk: localhost:2181(CONNECTED) 63] set /anode \"update\"                                                         \nAuthentication is not valid : /anode\n{noformat}\n\nBut everyone without being authenticated can delete the node:\n\n{noformat}\n[zk: localhost:2181(CONNECTED) 64] delete /anode                                                               \n[zk: localhost:2181(CONNECTED) 65] get /anode         \nNode does not exist: /anode\n{noformat}\n\nIs this a bug or is there a way to set the ACL so that only the user having the credentials can delete the znode?\n\n", "created_at" : { "$date" : "2014-02-20T15:55:47.808+0000" }, "updated_at" : { "$date" : "2014-02-21T09:52:38.034+0000" }, "creator_id" : { "$oid" : "5b904c0810ae152115d28d50" }, "reporter_id" : { "$oid" : "5b904c0810ae152115d28d50" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Ubuntu 12.04 LTS 64-bit" },
{ "_id" : { "$oid" : "5b904c095f627d846d496e12" }, "external_id" : "ZOOKEEPER-1889", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Implement Top-N sort operator", "desc" : "When, for example, doing an order by with a limit, if limit << total, it would be much more efficient to maintain a priority queue instead of sorting the entire data set.\n\nIn most cases, this will greatly reduce the number of comparisons, since most incoming records will not fall in the Top N, and thus will only require a single comparison operation. Incoming records that are in the Top-N will require at most log N comparisons.\n\nThis will also allow periodic purging of record batches, reducing memory requirements.", "created_at" : { "$date" : "2014-02-26T00:38:40.302+0000" }, "updated_at" : { "$date" : "2014-02-26T00:52:16.393+0000" }, "creator_id" : { "$oid" : "5b904c0810ae152115d28d51" }, "reporter_id" : { "$oid" : "5b904c0810ae152115d28d51" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c095f627d846d496e18" }, "external_id" : "ZOOKEEPER-1698", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add deterministic host connection to Java client", "desc" : "\"C client has zoo_deterministic_conn_order() to make the connection\norder deterministic. We can add a similar feature to Java client.\"", "created_at" : { "$date" : "2013-05-02T01:04:56.068+0000" }, "updated_at" : { "$date" : "2014-02-26T22:45:16.482+0000" }, "creator_id" : { "$oid" : "5b904c0910ae152115d28d52" }, "reporter_id" : { "$oid" : "5b904c0910ae152115d28d52" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c0a5f627d846d496e1a" }, "external_id" : "ZOOKEEPER-1779", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ReconfigTest littering the source root with test files", "desc" : "After running the ReconfigTest I saw a number of the following files in the source root (not in a subdir of the build directory as would be expected)\n\nzoo_replicated1.dynamic\n(saw files zoo_replicated{1-9})", "created_at" : { "$date" : "2013-10-02T18:42:57.751+0000" }, "updated_at" : { "$date" : "2014-03-06T11:09:22.690+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b904c0a10ae152115d28d54" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c0a5f627d846d496e28" }, "external_id" : "ZOOKEEPER-1349", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Support starting zkCli.sh in readonly mode", "desc" : "Start the .zkCli.sh in readonly mode. ZooKeeper client is supporting the readonly mode, it would be desirable the admin shell is providing the same support and can be able to see the status.\n\nSuggestion:- \nAdd one more parameter as follows specifying the r-o mode.\n\n./zkCli.sh -server 10.18.52.144:2179:readonly\n", "created_at" : { "$date" : "2012-01-02T15:10:14.093+0000" }, "updated_at" : { "$date" : "2014-03-11T08:35:53.373+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904c0a5f627d846d496e27" }, "type" : "Duplicate", "effect" : "duplicates" } ] },
{ "_id" : { "$oid" : "5b904c0a5f627d846d496e27" }, "external_id" : "ZOOKEEPER-784", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904c0a5f627d846d496e28" }, "type" : "Duplicate", "effect" : "is duplicated by" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_type" : "Sub-task", "priority" : "Major", "parent_issue_id" : { "$oid" : "5b7d50f75f627d6b0586a7e4" }, "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "status" : "Closed", "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "updated_at" : { "$date" : "2014-03-11T08:35:53.387+0000" }, "title" : "server-side functionality for read-only mode", "desc" : "As per http://wiki.apache.org/hadoop/ZooKeeper/GSoCReadOnlyMode , create ReadOnlyZooKeeperServer which comes into play when peer is partitioned.", "created_at" : { "$date" : "2010-06-02T22:16:19.991+0000" } },
{ "_id" : { "$oid" : "5b904c0c5f627d846d496e9b" }, "external_id" : "ZOOKEEPER-1662", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix to two small bugs in ReconfigTest.testPortChange()", "desc" : "Fix to two small bugs in ReconfigTest.testPortChange():\n1. the test expected a port change to happen immediately, which is not necessarily\ngoing to happen. The fix waits a bit and also tries several times.\n2. when a client port changes, the test created a new ZooKeeper handle, but didn't specify a Watcher object, which generated some NullPointerException events when the watcher was triggered.", "created_at" : { "$date" : "2013-03-09T00:27:54.527+0000" }, "updated_at" : { "$date" : "2014-03-11T11:11:05.761+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c0d5f627d846d496ead" }, "external_id" : "ZOOKEEPER-1440", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Spurious log error messages when QuorumCnxManager is shutting down", "desc" : "When shutting down the QuroumPeer, ZK server logs unnecessary errors. See QuorumCnxManager.Listener.run() - ss.accept() will throw an exception when it is closed. The catch (IOException e) will log errors. It should first check the shutdown field to see if the Listener is being shutdown. If it is, the exception is correct and no errors should be logged.", "created_at" : { "$date" : "2012-04-01T20:28:39.856+0000" }, "updated_at" : { "$date" : "2014-03-12T23:32:22.283+0000" }, "creator_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "reporter_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c0e5f627d846d496eca" }, "external_id" : "ZOOKEEPER-1638", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Redundant zk.getZKDatabase().clear();", "desc" : "Learner.syncWithLeader calls zk.getZKDatabase().clear() right before zk.getZKDatabase().deserializeSnapshot(leaderIs); Then the first thing deserializeSnapshot does is another clear(). \n\nSuggest to remove the clear() in syncWithLeader.\n\n", "created_at" : { "$date" : "2013-02-02T23:02:21.342+0000" }, "updated_at" : { "$date" : "2014-03-13T00:39:56.381+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b904c0e10ae152115d28d56" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c0f5f627d846d496eed" }, "external_id" : "ZOOKEEPER-1892", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "addrvec_next gets called twice when failing over to the next server", "desc" : "zookeeper_interest() already calls zoo_cycle_next_server() when the socket is set to -1, so we shouldn't call addrvec_next in handle_error. This causes the next server to get skipped. Zookeeper_simpleSystem::testFirstServerDown fails unless the client gets connected to the server during the first round because the client keeps skipping the second server after the first round.", "created_at" : { "$date" : "2014-03-13T02:06:36.030+0000" }, "updated_at" : { "$date" : "2014-03-13T03:41:05.738+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c105f627d846d496ef8" }, "external_id" : "ZOOKEEPER-1821", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "very ugly warning when compiling load_gen.c", "desc" : "this is the compiler output:     \n3.4/src/c/src/load_gen.c:110:1: warning: control may reach end of non-void function [-Wreturn-type]\n     [exec] }\n     [exec] ^\n3.4/src/c/src/load_gen.c:135:1: warning: control may reach end of non-void function [-Wreturn-type]\n     [exec] }\n     [exec] ^\n3.4/src/c/src/load_gen.c:163:1: warning: control may reach end of non-void function [-Wreturn-type]\n     [exec] }\n     [exec] ^\n3.4/src/c/src/load_gen.c:180:1: warning: control may reach end of non-void function [-Wreturn-type]\n     [exec] }\n     [exec] ^\ni think that the code is missing a \"return ZOK\" in the end of these functions.", "created_at" : { "$date" : "2013-11-23T06:43:58.229+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:52.625+0000" }, "creator_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "reporter_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.5.0", "3.4.6" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_links" : [  ], "environment" : "macos" },
{ "_id" : { "$oid" : "5b904c105f627d846d496f0b" }, "external_id" : "ZOOKEEPER-1770", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NullPointerException in SnapshotFormatter", "desc" : "SnapshotFormatter fails with a NullPointerException when parsing one snapshot (with \"null\" data in one Znode):\nException in thread \"main\" java.lang.NullPointerException\n        at org.apache.zookeeper.server.SnapshotFormatter.printZnode(SnapshotFormatter.java:90)\n        at org.apache.zookeeper.server.SnapshotFormatter.printZnode(SnapshotFormatter.java:95)\n        at org.apache.zookeeper.server.SnapshotFormatter.printZnode(SnapshotFormatter.java:95)\n        at org.apache.zookeeper.server.SnapshotFormatter.printZnode(SnapshotFormatter.java:95)\n        at org.apache.zookeeper.server.SnapshotFormatter.printZnodeDetails(SnapshotFormatter.java:79)\n        at org.apache.zookeeper.server.SnapshotFormatter.printDetails(SnapshotFormatter.java:71)\n        at org.apache.zookeeper.server.SnapshotFormatter.run(SnapshotFormatter.java:67)\n        at org.apache.zookeeper.server.SnapshotFormatter.main(SnapshotFormatter.java:51)\n", "created_at" : { "$date" : "2013-09-30T08:00:45.920+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:52.768+0000" }, "creator_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "reporter_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_links" : [  ], "environment" : "Windos, Java 1.7" },
{ "_id" : { "$oid" : "5b904c115f627d846d496f1f" }, "external_id" : "ZOOKEEPER-1696", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fail to run zookeeper client on Weblogic application server", "desc" : "The problem in details is described here: http://comments.gmane.org/gmane.comp.java.zookeeper.user/2897\nThe provided link also contains a reference to fix implementation.\n\n{noformat}\n####<Apr 24, 2013 1:03:28 PM MSK> <Warning> <org.apache.zookeeper.ClientCnxn> <devapp090> <clust2> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (devapp090:2182)> <internal> <> <> <1366794208810> <BEA-000000> <WARN  org.apache.zookeeper.ClientCnxn - Session 0x0 for server null, unexpected error, closing socket connection and attempting reconnect\njava.lang.IllegalArgumentException: No Configuration was registered that can handle the configuration named Client\n                at com.bea.common.security.jdkutils.JAASConfiguration.getAppConfigurationEntry(JAASConfiguration.java:130)\n                at org.apache.zookeeper.client.ZooKeeperSaslClient.<init>(ZooKeeperSaslClient.java:97)\n                at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:943)\n                at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:993)\n>\n\n{noformat}", "created_at" : { "$date" : "2013-04-24T13:39:23.200+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:52.305+0000" }, "creator_id" : { "$oid" : "5b904c1110ae152115d28d59" }, "reporter_id" : { "$oid" : "5b904c1110ae152115d28d59" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.4.5" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b904c1110ae152115d28d58" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d239" }, "type" : "Reference", "effect" : "is related to" } ], "environment" : "Java version: jdk170_06\nWebLogic Server Version: 10.3.6.0 " },
{ "_id" : { "$oid" : "5b904c125f627d846d496f50" }, "external_id" : "ZOOKEEPER-1598", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ability to support more digits in the version string", "desc" : "Ability to support more digits in the version string.\nZookeeper, now expects the version sting to be of X.Y.Z-# format.\nWith this change, the default behavior is still the same X.Y.Z-# and will not break any existing things.\nBut at the same time, allows people to tag on their own digits to the version strings, so that they can add a patch or two in their own environments and be able to distinguish between apache zookeeper version and locally modified zookeeper version.", "created_at" : { "$date" : "2012-12-07T18:24:05.251+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:52.933+0000" }, "creator_id" : { "$oid" : "5b904c1210ae152115d28d5c" }, "reporter_id" : { "$oid" : "5b904c1210ae152115d28d5c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b904c1210ae152115d28d5c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c135f627d846d496f78" }, "external_id" : "ZOOKEEPER-1834", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Catch IOException in FileTxnLog", "desc" : "Upon an IOException in FileTxnLog#next(), the log file open remains open, which causes test cases at least in BufferSizeTest to fail. We need to add a catch block.", "created_at" : { "$date" : "2013-12-10T22:12:11.197+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:52.482+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904c065f627d846d496ddf" } },
{ "_id" : { "$oid" : "5b904c145f627d846d496f8e" }, "external_id" : "ZOOKEEPER-1873", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Unnecessarily InstanceNotFoundException is coming when unregister failed jmxbeans", "desc" : "MBeanRegistry#register is keeping the beans which are failed to complete the registration. During unregistration time, these failed beans will results in following exception.\n{code}\n    [junit] 2014-01-29 08:34:56,667 [myid:] - WARN  [main:MBeanRegistry@134] - Error during unregister\n    [junit] javax.management.InstanceNotFoundException: org.apache.ZooKeeperService:name0=StandaloneServer_port-1\n    [junit] \tat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getMBean(DefaultMBeanServerInterceptor.java:1095)\n    [junit] \tat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.exclusiveUnregisterMBean(DefaultMBeanServerInterceptor.java:427)\n    [junit] \tat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.unregisterMBean(DefaultMBeanServerInterceptor.java:415)\n    [junit] \tat com.sun.jmx.mbeanserver.JmxMBeanServer.unregisterMBean(JmxMBeanServer.java:536)\n    [junit] \tat org.apache.zookeeper.jmx.MBeanRegistry.unregister(MBeanRegistry.java:115)\n{code}", "created_at" : { "$date" : "2014-01-29T21:06:55.994+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:53.098+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904c065f627d846d496ddf" } },
{ "_id" : { "$oid" : "5b904c155f627d846d496fa1" }, "external_id" : "ZOOKEEPER-1837", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix JMXEnv checks (potential race conditions)", "desc" : "The following failures in ZooKeeper-3.4-WinVS2008_java and ZooKeeper-trunk-WinVS2008_java require fixing:\n[junit] junit.framework.AssertionFailedError: expected:<0> but was:<1>\n    [junit] \tat junit.framework.Assert.fail(Assert.java:47)\n    [junit] \tat junit.framework.Assert.failNotEquals(Assert.java:283)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:64)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:195)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:201)\n    [junit] \tat org.apache.zookeeper.test.JMXEnv.ensureOnly(JMXEnv.java:138)\n    [junit] \tat org.apache.zookeeper.test.ClientBase.startServer(ClientBase.java:417)\n    [junit] \tat org.apache.zookeeper.test.ZooKeeperQuotaTest.testQuota(ZooKeeperQuotaTest.java:80)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:597)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n\n\n[junit] junit.framework.AssertionFailedError: expected:<0> but was:<1>\n    [junit] \tat junit.framework.Assert.fail(Assert.java:47)\n    [junit] \tat junit.framework.Assert.failNotEquals(Assert.java:283)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:64)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:195)\n    [junit] \tat junit.framework.Assert.assertEquals(Assert.java:201)\n    [junit] \tat org.apache.zookeeper.test.JMXEnv.ensureOnly(JMXEnv.java:138)\n    [junit] \tat org.apache.zookeeper.test.ClientBase.startServer(ClientBase.java:417)\n    [junit] \tat org.apache.zookeeper.test.ZooKeeperQuotaTest.testQuota(ZooKeeperQuotaTest.java:80)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    [junit] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    [junit] \tat java.lang.reflect.Method.invoke(Method.java:597)\n    [junit] \tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    [junit] \tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    [junit] \tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    [junit] \tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    [junit] \tat org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)\n    [\n\njunit.framework.AssertionFailedError: expected [0x142e5f027b50001] expected:<1> but was:<0>\n\tat org.apache.zookeeper.test.JMXEnv.ensureAll(JMXEnv.java:115)\n\tat org.apache.zookeeper.test.ClientBase.createClient(ClientBase.java:197)\n\tat org.apache.zookeeper.test.ClientBase.createClient(ClientBase.java:171)\n\tat org.apache.zookeeper.test.ClientBase.createClient(ClientBase.java:156)\n\tat org.apache.zookeeper.test.ClientBase.createClient(ClientBase.java:149)\n\tat org.apache.zookeeper.ZooKeeperTest.testDeleteRecursive(ZooKeeperTest.java:45)\n\tat org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)\n", "created_at" : { "$date" : "2013-12-13T07:40:26.746+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:53.262+0000" }, "creator_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "reporter_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904c065f627d846d496ddf" }, "environment" : "Windows 8" },
{ "_id" : { "$oid" : "5b904c155f627d846d496fe9" }, "external_id" : "ZOOKEEPER-1513", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "\"Unreasonable length\" exception while starting a server.", "desc" : "The server is allowing a client to set data larger than the server can then later read:\n\n{noformat}\n2012-07-18 14:28:12,555 - FATAL [main:QuorumPeer@400] - Unable to load database on disk \njava.io.IOException: Unreasonable length = 1048583 \nat org.apache.jute.BinaryInputArchive.readBuffer(BinaryInputArchive.java:100) \nat org.apache.zookeeper.server.persistence.Util.readTxnBytes(Util.java:232) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:602) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:529) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:504) \nat org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:341) \nat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:131) \nat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:222) \nat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:398) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:143) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:103) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:76) \n2012-07-18 14:28:12,555 - FATAL [main:QuorumPeerMain@87] - Unexpected exception, exiting abnormally \njava.lang.RuntimeException: Unable to run quorum server \nat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:401) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:143) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:103) \nat org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:76) \nCaused by: java.io.IOException: Unreasonable length = 1048583 \nat org.apache.jute.BinaryInputArchive.readBuffer(BinaryInputArchive.java:100) \nat org.apache.zookeeper.server.persistence.Util.readTxnBytes(Util.java:232) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:602) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:529) \nat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:504) \nat org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:341) \nat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:131) \nat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:222) \nat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:398) \n... 3 more\n{noformat}\n\nNotice the size is 0x100007 - 7 bytes beyond.\n\nThe SetDataTxn contains the client data + a couple extra fields. On ingest the server is applying the jute.maxbuffer size to the data (expected) but not handling the fact that the data plus these extra fields may exceed the jute.maxbuffer check when reading from disk.\n\nWorkaround was simple here: set the jute.maxbuffer size a bit higher (and fix the mis-behaving client, expectation was not that the data would grow this large).\n", "created_at" : { "$date" : "2012-07-20T00:38:33.614+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:53.618+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.4" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d5271e9214a0d1608d982" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53065f627d6b0586de81" }, "external_id" : "ZOOKEEPER-1548", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3" ], "components" : [ "leaderElection" ], "fix_versions" : [ "3.4.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53065f627d6b0586de82" }, "type" : "Reference", "effect" : "is related to" } ], "issue_type" : "Bug", "desc" : "Hi,\n\nWe have a five node cluster, recently upgraded from 3.3.5 to 3.4.3. Was running fine for a few weeks after the upgrade, then the following sequence of events occurred :\n\n1. All servers stopped responding to 'ruok' at the same time\n2. Our local supervisor process restarted all of them at the same time \n(yes, this is bad, we didn't expect it to fail this way :)\n3. The cluster would not serve requests after this. Appeared to be unable to complete an election.\n\nWe tried various things at this point, none of which worked :\n\n* Moved around the restart order of the nodes (e.g. 4 thru 0, instead of 0 thru 4)\n* Reduced number of running nodes from 5 -> 3 to simplify the quorum, by only starting up 0, 1 & 2, in one test, and  0, 2 & 4 in the other\n* Removed the *Epoch files from version-2/ snapshot directory\n* Put the same version2/snapshot.xxxxx file on each server in the cluster\n* Added the (same on all nodes) last txlog onto each cluster\n* Kept only the last snapshot plus txlog unique on each server\n* Moved leaderServes=no to leaderServes=yes\n* Removed all files and started up with empty data as a control. This worked, but of course isn't terribly useful :)\n\nFinally, I brought the data up on a single node running in standalone and this worked (yay!) So at this point we brought the single node back into service and have kept the other four available to debug why the election is failing.\n\nWe downgraded the four nodes to 3.3.5, and then they completed the election and started serving as expected.\nWe did a rolling upgrade to 3.4.3, and everything was fine until we restarted the leader, whereupon we encountered the same re-election loop as before.\n\nWe're a bit out of ideas at this point, so I was hoping someone from this list might have some useful input.\n\nOutput from two followers and a leader during this condition are attached.\n\nCheers,\n\nAl\n", "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b904c1610ae152115d28d5d" }, "status" : "Closed", "priority" : "Major", "reporter_id" : { "$oid" : "5b904c1610ae152115d28d5d" }, "updated_at" : { "$date" : "2014-03-13T18:16:53.462+0000" }, "title" : "Cluster fails election loop in new and interesting way", "created_at" : { "$date" : "2012-09-07T21:51:48.286+0000" } },
{ "_id" : { "$oid" : "5b904c175f627d846d49701b" }, "external_id" : "ZOOKEEPER-1750", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Race condition producing NPE in NIOServerCnxn.toString", "desc" : " The socket is closed and the variable \"sock\" is set to null for normal reasons, but the toString method is called before \"sock\" can be set again, producing a NullPointerException.\n\nStack trace: \n\n2013-08-29 01:49:19,991 6277 [CommitProcWorkThread-3] WARN org.apache.zookeeper.server.WorkerService  - Unexpected exception\njava.lang.NullPointerException\n    at org.apach.zookeeper.server.NIOServerCnxn.toString(NIOServerCnxn.java:961)\n    at java.lang.String.valueOf(String.java:2854)\n    at java.lang.StringBuilder.append(StringBuilder.java:128)\n    at org.apache.zookeeper.server.NIOServerCnxn.process(NIOServerCnxn.java:1104)\n    at org.apache.zookeeper.server.WatchManager.triggerWatch(WatchManager.java:120)\n    at org.apache.zookeeper.server.WatchManager.triggerWatch(WatchManager.java:92)\n    at org.apache.zookeeper.server.DataTree.createNode(DataTree.java:544)\n    at org.apache.zookeeper.server.DataTree.processTxn(DataTree.java:805)\n    at org.apache.zookeeper.server.ZKDatabase.processTxn(ZKDatabase.java:319)\n    at org.apache.zookeeper.server.ZooKeeperServer.processTxn(ZooKeeperServer.java:967)\n    at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:115)\n    at org.apache.zookeeper.server.quorum.Leader$ToBeAppliedRequestProcessor.processRequest(Leader.java:859)\n    at org.apache.zookeeper.server.quorum.CommitProcessor$CommitWorkRequest.doWork(CommitProcessor.java:271)\n    at org.apache.zookeeper.server.WorkerService$ScheduledWorkRequest.run(WorkerService.java:152)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:722)", "created_at" : { "$date" : "2013-08-30T22:57:04.026+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:54.935+0000" }, "creator_id" : { "$oid" : "5b904c0410ae152115d28d4e" }, "reporter_id" : { "$oid" : "5b904c0410ae152115d28d4e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c185f627d846d49703c" }, "external_id" : "ZOOKEEPER-1633", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Introduce a protocol version to connection initiation message", "desc" : "Currently the first message a server sends to another server includes just one field - the server's id (long). This is in QuorumCnxManager.java. This makes changes to the information passed during this initial connection very difficult. This patch will change the first field of the message to be a protocol version (a negative number that can't be a server id). The second field will be the server id. The third field is number of bytes in the remainder of the message. A 3.4 server will read the first field as before, but if this is a negative number it will read the second field to find the server id, and then remove the remainder of the message from the stream. This will not affect 3.4 since 3.4 and earlier servers send just the server id (so the code in the patch will not run unless there is a server > 3.4 trying to connect). This will, however, provide the necessary flexibility for future releases as well as an upgrade path from 3.4", "created_at" : { "$date" : "2013-01-30T19:14:03.411+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:54.314+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.6" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "type" : "Required", "effect" : "is required by" } ] },
{ "_id" : { "$oid" : "5b904c1b5f627d846d497074" }, "external_id" : "ZOOKEEPER-1583", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document maxClientCnxns in conf/zoo_sample.cfg", "desc" : "It is silly that maxClientCnxns being set to the default, and that default being too low, is the number one issue for users (according to some: https://raw.github.com/strangeloop/strangeloop2012/master/slides/sessions/Ting-BuildingAnImpenetrableZooKeeper.pdf).\n\nIt seems to me that this can be resolved by an extremely simple documentation change: add a commented-out configuration line in conf/zoo_sample.cfg that shows the default, but more importantly, shows users that the configuration option exists.", "created_at" : { "$date" : "2012-11-14T19:20:26.600+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:54.023+0000" }, "creator_id" : { "$oid" : "5b904c1b10ae152115d28d5e" }, "reporter_id" : { "$oid" : "5b904c1b10ae152115d28d5e" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.4.4" ], "components" : [ "documentation" ], "labels" : [ "configuration", "documentation", "example" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b904c1b10ae152115d28d5e" }, "issue_links" : [  ], "original_time_estimate" : 300 },
{ "_id" : { "$oid" : "5b904c1c5f627d846d497085" }, "external_id" : "ZOOKEEPER-1790", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Deal with special ObserverId in QuorumCnxManager.receiveConnection", "desc" : "QuorumCnxManager.receiveConnection assumes that a negative sid means that this is a 3.5.0 server, which has a different communication protocol. This doesn't account for the fact that ObserverId = -1 is a special id that may be used by observers and is also negative. \n\nThis requires a fix to trunk and a separate fix to 3.4 branch, where this function is different (see ZOOKEEPER-1633)", "created_at" : { "$date" : "2013-10-10T23:59:13.332+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:54.654+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.5.0", "3.4.6" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904c1c5f627d846d497093" }, "external_id" : "ZOOKEEPER-1562", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Memory leaks in zoo_multi API", "desc" : "Valgrind is reporting memory leak for zoo_multi operations.\n\n==4056== 2,240 (160 direct, 2,080 indirect) bytes in 1 blocks are definitely lost in loss record 18 of 24\n==4056==    at 0x4A04A28: calloc (vg_replace_malloc.c:467)\n==4056==    by 0x504D822: create_completion_entry (zookeeper.c:2322)\n==4056==    by 0x5052833: zoo_amulti (zookeeper.c:3141)\n==4056==    by 0x5052A8B: zoo_multi (zookeeper.c:3240)\n\nIt looks like completion entries for individual operations in multiupdate transaction are not getting freed. My observation is that memory leak size depends on the number of operations in single mutlipupdate transaction", "created_at" : { "$date" : "2012-10-13T01:03:48.048+0000" }, "updated_at" : { "$date" : "2014-03-13T18:16:54.502+0000" }, "creator_id" : { "$oid" : "5b904c1c10ae152115d28d5f" }, "reporter_id" : { "$oid" : "5b904c1c10ae152115d28d5f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.4.3", "3.4.4" ], "components" : [ "c client" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.6" ], "assignee_id" : { "$oid" : "5b904c1c10ae152115d28d5f" }, "issue_links" : [  ], "environment" : "Zookeeper client and server both are running on CentOS 6.3" },
{ "_id" : { "$oid" : "5b904cf65f627d84c8d6a9fc" }, "external_id" : "VELOCITY-365", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904cf65f627d84c8d6a9fd" }, "external_id" : "VELOCITY-232", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add support for array.length", "desc" : "I know velocity can only introspect Methods, not member variables, but\nperhaps you could make an exception for arrays?\nArrays are basically suported with foreach iteration.\nNow it would be great if I could also say \"$myarray.length items displayed\".\nIs this possible somehow now?\nIf not, does someone agree this could be implemented?\n\nI think .length support should be possible only IF the passed variable is an\narray, and for nothing else.", "created_at" : { "$date" : "2003-11-26T18:27:01.000+0000" }, "updated_at" : { "$date" : "2005-09-20T03:19:22.000+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66b" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904cf65f627d84c8d6a9fc" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904cf75f627d84c8d6aa12" }, "external_id" : "VELOCITY-92", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "File names do not appear in ParseErrorExceptions", "desc" : "ParseErrorExceptions currently include the line and column number of the\nerror, but not the name of the file that was being parsed.  It would\nbe very helpful if it did, becase sometimes templates include\nseveral other templates.", "created_at" : { "$date" : "2002-07-23T05:19:31.000+0000" }, "updated_at" : { "$date" : "2006-09-06T10:50:50.000+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904cf75f627d84c8d6aa11" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904cf85f627d84c8d6aa21" }, "external_id" : "VELOCITY-394", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RFE: optional record comments", "desc" : "At the moment, the whole content except the terminator of a comment are dropped.\n\nThis ok, for the normal server/application use, where a template is evaluated,\nbut for IDEs it would be a big advantage, to have the whole comment in the\nparser tree, so that a ParserVisitor can be used, e.g. to highlight comments in\nan editor.\n\nSo it would be nice, to have something like parser.recordComments(boolean\ncomplete), to dis/enable the recording of the complete comment, if encountered.", "created_at" : { "$date" : "2005-07-14T08:35:36.000+0000" }, "updated_at" : { "$date" : "2006-11-05T19:07:08.000+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904cf85f627d84c8d6aa30" }, "external_id" : "VELOCITY-482", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Get a velocity-commits list", "created_at" : { "$date" : "2006-11-11T00:26:19.000+0000" }, "updated_at" : { "$date" : "2006-11-11T01:25:31.000+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904cf95f627d84c8d6aa37" }, "external_id" : "VELOCITY-486", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update SVN to send commits to velocity-commits", "created_at" : { "$date" : "2006-11-11T00:27:16.000+0000" }, "updated_at" : { "$date" : "2006-11-11T01:28:46.000+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904cfa5f627d84c8d6aa3f" }, "external_id" : "VELOCITY-487", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Get private@ added to pmcs@", "created_at" : { "$date" : "2006-11-11T00:27:32.000+0000" }, "updated_at" : { "$date" : "2006-11-11T01:59:52.000+0000" }, "creator_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "reporter_id" : { "$oid" : "5b7d3540e9214a0d1608d677" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904cfa5f627d84c8d6aa46" }, "external_id" : "VELOCITY-512", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "fix dependency  list in jar-dependencies.xml", "desc" : "xdocs/docs/jar-dependencies.xml is inconsistent with\nxdocs/docs/build.xml.  Specifically the list of dependencies is\nmissing antlr and junit.", "created_at" : { "$date" : "2007-01-30T17:06:44.860+0000" }, "updated_at" : { "$date" : "2007-01-30T21:57:57.647+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904cfb5f627d84c8d6aa4f" }, "external_id" : "VELOCITY-511", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "add notes on jar upgrade to README", "desc" : "We should highlight changes in the jar dependencies.  Even though this occurred Velocity 1.4 -> 1.5, it would still be useful notes for user's upgrading.  Suggested text:\n\nThis release is a drop-in replacement for earlier versions of\nVelocity. No changes to your application should be required other than\nchanges to the dependent jar files.  \n\nWhen upgrading from Velocity 1.3, these jar file requirements have been changed\n* JDOM has been upgraded to 1.0\n* Commons Collection has been upgraded to 3.1\n* Commons Lang 2.1 has been added\n\nIn addition,\n* Ant 1.6  or greater is required for building.\n* Java CC 3.2 or greater is now required for compiling parser files.\n* HSQLDB 1.7.1 is required for running unit tests.\n\n", "created_at" : { "$date" : "2007-01-30T17:05:13.587+0000" }, "updated_at" : { "$date" : "2007-01-30T22:48:32.831+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904cfc5f627d84c8d6aa57" }, "external_id" : "VELOCITY-515", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "how to handlae velosity projects for open source step by step", "desc" : "plz send the requested document  as such i can easly go on the projects development.\n\nvelocity is very new for me.", "created_at" : { "$date" : "2007-02-14T11:33:01.635+0000" }, "updated_at" : { "$date" : "2007-02-14T21:02:15.370+0000" }, "creator_id" : { "$oid" : "5b7d3543e9214a0d1608d678" }, "reporter_id" : { "$oid" : "5b7d3543e9214a0d1608d678" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "win xp,java" },
{ "_id" : { "$oid" : "5b904cfc5f627d84c8d6aa5f" }, "external_id" : "VELOCITY-524", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "MD5 files have incorrect format", "desc" : "The MD5 files for the Velocity downloads don't have the standard format.\n\nV1.4\nMD5 (velocity-1.4.zip) = 22cbd895f81dd4a6f17665b20b1cbcf71\n\nV1.5B2\n5f148e43c1f7c647ec73af0b26ea5ebe\n\nThe standard format is:\n\n5f148e43c1f7c647ec73af0b26ea5ebe *velocity-1.5-beta2.zip\n\nand can readily be autogenerated from Ant using the following snippet:\n\n<echo message=\"Creating MD5 for ${path}\"/>\n<basename property=\"_base\" file=\"${path}\"/>\n<checksum file=\"${path}\" property=\"md5\"/>\n<echo message=\"${md5} *${_base}\" file=\"${path}.md5\"/>\n", "created_at" : { "$date" : "2007-03-04T12:58:06.415+0000" }, "updated_at" : { "$date" : "2007-03-06T12:08:45.227+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5 beta2", "1.5 beta1", "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904cfd5f627d84c8d6aa68" }, "external_id" : "VELOCITY-262", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#set not parsed in #macro", "desc" : "#set statements are not being parsed in #macros in VM_global_library.\nWorked in 1.3.1, doesn't in 1.4.\n\nI'm going to attach the #macro and the diff'd 1.3.1 vs 1.4 output.\n\n-Mike", "created_at" : { "$date" : "2004-04-16T03:09:59.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:03:13.955+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5 beta2", "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904cfe5f627d84c8d6aa84" }, "external_id" : "VELOCITY-183", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "StringResourceLoader", "desc" : "Resource loader that works with Strings. Users should manualy add\nresources to the repository that is know by the factory of this package. \n\nBelow is an example configuration for this loader.\nNote that 'repositoryimpl' is not mandatory;\nif not provided, the factory will fall back on using the default\nimplementation of this package.\n\nstringres.resource.loader.description = Velocity StringResource loader\nstringres.resource.loader.class = \norg.apache.velocity.tools.stringresources.StringResourceLoader\nstringres.resource.loader.repositoryimpl = \norg.apache.velocity.tools.stringresources.StringResourceRepositoryImpl\n\nResources can be added to the repository like this:\n\nStringResourceRepositoryFactory vsRepository = null;\nvsRepository = StringResourceRepositoryFactory.getRepository();\nString myTemplateName = \"/somewhere/intherepo/name\";\nString myTemplateBody = \"Hi, ${username}... this is a some template!\";\nvsRepository.putStringResource(myTemplateName, myTemplateBody);\n\nAfter this, the templates can be retrieved as usual", "created_at" : { "$date" : "2003-06-11T16:40:15.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:03:13.758+0000" }, "creator_id" : { "$oid" : "5b7d3546e9214a0d1608d67b" }, "reporter_id" : { "$oid" : "5b7d3546e9214a0d1608d67b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5 beta2", "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904cfe5f627d84c8d6aa9d" }, "external_id" : "VELOCITY-477", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DOCTYPE url correction in veltag.tld", "desc" : "I noticed that the DOCTYPE declaration in experimantal/veltag/examples/veltag.tld uses \"http://java.sun.com/j2ee/dtds/web-jsptaglib_1_1.dtd\" but should use \"http://java.sun.com/j2ee/dtds/web-jsptaglibrary_1_1.dtd\".  \n\nVery little drama here, I know.  But I figured I should point it out anyway.", "created_at" : { "$date" : "2006-11-06T00:55:01.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:03:14.066+0000" }, "creator_id" : { "$oid" : "5b7d3547e9214a0d1608d67c" }, "reporter_id" : { "$oid" : "5b7d3547e9214a0d1608d67c" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5 beta2" ], "issue_links" : [  ], "environment" : "All" },
{ "_id" : { "$oid" : "5b904cff5f627d84c8d6aaaa" }, "external_id" : "VELOCITY-75", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Send all log output to System.out in the event that Avalon or whatever can't be loaded.", "desc" : "First of all, a problem with this site:\n\nI just submitted this bug by laboriously typing in lots of detailed info, and \nyour bug servlet complained that it was missing a component, and to \npress \"back\", but I then lost everything I had typed.\n\nThis is really \"insult to injury\".  Please don't let the user go to a new page \nand throw away everything that they've typed!  This is a favor to you guys and \nthe development community.\n\nPhew!  Now, the main point:\n\nThis is the second time I've posted a bug in the log system, this time \nregarding the default settings in the velocity.properties file searching for an \nAvalon log system that is not present.\n\nHere's what you do:  If the avalon log system is not found, create a simple \nclass that sends everything to Standard.out.\n\nO.k.?\n\nThe class to change is: org.apache.velocity.runtime.log.LogManager.java\n\nThe line to change is in the following block of code, noted inline:\n\n try\n        {\n            als = new AvalonLogSystem();\n\n            als.init( rsvc );\n        }\n        catch( NoClassDefFoundError ncdfe )\n        {\n\n///////////////////////////// PUT THE CHANGE HERE!\n\n\n//////////////////////////////  END OF THE CHANGE, REMOVE THE REST OF THE CODE\n/////////////////////////////   IN THIS CATCH BLOCK\n\n            String errstr = \"PANIC : Velocity cannot find any of the\"\n                + \" specified or default logging systems in the classpath,\"\n                + \" or the classpath doesn't contain the necessary classes\"\n                + \" to support them.\"\n                + \" Please consult the documentation regarding logging.\"\n                + \" Exception : \" + ncdfe;\n\n            System.out.println( errstr );\n            System.err.println( errstr );\n\n            throw ncdfe;\n        }\n\njava.lang.NoClassDefFoundError: org/apache/log/format/Formatter\n\tat org.apache.velocity.runtime.log.LogManager.createLogSystem\n(LogManager.java:200)\n\tat org.apache.velocity.runtime.RuntimeInstance.initializeLogger\n(RuntimeInstance.java:533)\n\tat org.apache.velocity.runtime.RuntimeInstance.init\n(RuntimeInstance.java:267)\n\tat org.apache.velocity.runtime.RuntimeSingleton.init\n(RuntimeSingleton.java:169)\n\tat org.apache.velocity.app.Velocity.init(Velocity.java:123)\n\tat com.wonderwidgets.util.Preprocessor.main(Preprocessor.java:20)\n\nThanks.\n\nMatt Gould", "created_at" : { "$date" : "2002-05-09T05:07:04.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:17.726+0000" }, "creator_id" : { "$oid" : "5b7d3547e9214a0d1608d67d" }, "reporter_id" : { "$oid" : "5b7d3547e9214a0d1608d67d" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d005f627d84c8d6aac1" }, "external_id" : "VELOCITY-71", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "False positive error condition parsing VM_global_library.vm", "desc" : "This bug is actually against 1.3 RC1, but there is no Version listing for that\nin the Bugzilla config.\n\nThe initial parsing of the global Velocimacro library is incorrectly indicating\nan error when context variables which are not passed in as arguments to a macro\nare used when calling one macro within the body of another.  Confusing, eh?  I\nassume that this could be worked around by putting double quotes around the\nsupposedly non-existent arguments to the invoked macro, but was wondering if\nthis was a bug.  Included is a sample problem case and some log output.\n\nFrom VM_global_library.vm:\n\n#macro(linkedLoginName $acl $user)\n #linkIf($user.isEditableBy($acl) $currentDomain.getProjectPageURL(\"UserEdit\",\n\"userID=$user.getID()\") $user.getLoginName()) \n#end\n\n#macro(linkIf $condition $link $text)\n #if ($condition) <a href=\"$link\">$text</a> #else $text #end\n#end\n\nFrom velocity.log:\n\n2002-05-01 15:04:28,496 - Velocimacro : added new VM : #enterHelp( filename\nlinktext ) : source = VM_global_library.vm\n2002-05-01 15:04:28,843 - VM #linkIf: error : too few arguments to macro. Wanted\n3 got 0\n2002-05-01 15:04:28,847 - VM #servletLink: error : too few arguments to macro.\nWanted 2 got 0\n2002-05-01 15:04:28,848 - VM #servletLink: error : too few arguments to macro.\nWanted 2 got 0\n2002-05-01 15:04:28,849 - VM #servletLink: error : too few arguments to macro.\nWanted 2 got 0\n2002-05-01 15:04:28,857 - VM #displayProjectTreeAsOptions: error : too few\narguments to macro. Wanted 4 got 0\n2002-05-01 15:04:28,907 - VM #selectYear: error : too few arguments to macro.\nWanted 2 got 0\n2002-05-01 15:04:28,907 - VM #selectMonth: error : too few arguments to macro.\nWanted 1 got 0\n2002-05-01 15:04:28,908 - VM #selectDay: error : too few arguments to macro.\nWanted 1 got 0\n2002-05-01 15:04:29,109 - ResourceManager : found VM_global_library.vm with\nloader org.apache.velocity.runtime.resource.loader.FileResourceLoader\n2002-05-01 15:04:29,113 - Velocimacro :  VM library template macro registration\ncomplete.\n2002-05-01 15:04:29,113 - Velocimacro : allowInline = true : VMs can be defined\ninline in templates", "created_at" : { "$date" : "2002-05-02T06:24:16.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:17.618+0000" }, "creator_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "reporter_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d005f627d84c8d6aac0" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Operating System: Linux\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d015f627d84c8d6aada" }, "external_id" : "VELOCITY-78", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "SimpleLog4JLogSystem closes appenders", "desc" : "The SimpleLog4JLogSystem class closes all appenders in its shutdown() method, \neven if the appenders were not created by Velocity. This can cause problems if \nthe logging system is initialized in your servlet, and if Velocity instances \nare finalized while other instances are in use -- since Log4J Categories are \nstatic :P\n\nWhat should probably happen is a flag should be set so that appenders are only \nclosed if they were created by the SimpleLog4JLogSystem class, and/or when all \nVelocity instances are GC'ed.", "created_at" : { "$date" : "2002-05-13T22:22:41.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:17.842+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d015f627d84c8d6aaf4" }, "external_id" : "VELOCITY-81", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "org.apache.velocity.util.StringUtils.chop(String s, int i, String eol) assumes too much about EOL string", "desc" : "I'm running Velocity with Texen under WinXP/cygwin/SunJDK1.3.1_02-b02\n\nWhen I try to generate my pages, I get the following exception:\n\norg.apache.velocity.exception.MethodInvocationException: Invocation of \nmethod 'chop' in  class org.apache.velocity.util.StringUtils threw exception \nclass java.lang.ArrayIndexOutOfBoundsException : null\n\nI've traced this back to the source code and found out that the reason for \nthis exception is most probably the fact that Velocity assumes that the \ntemplates it is working with are written with the same EOL combination that is \nthe default for the platform that it is running on.\n\nSo, to give you an example, I have templates that have Unix-style linebreaks \nin them and I'm executing Velocity on Windows machine with those templates. \nThis breaks the whole thing down.\n\nWorkaround? Convert your linebreaks or replace your chop method with this:\n    public static String chop(String s, int i, String eol)\n    {\n        char[] sa = s.toCharArray();\n        int length = sa.length;\n        length -= i;\n        return new String(sa, 0, length);\n    }\nThis will of course break the system, if you have windows-style linebreaks.\n\nSo, maybe you can come up with some more elegant fix for this problem? :-)", "created_at" : { "$date" : "2002-05-17T23:43:02.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:17.956+0000" }, "creator_id" : { "$oid" : "5b7d354ce9214a0d1608d681" }, "reporter_id" : { "$oid" : "5b7d354ce9214a0d1608d681" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d025f627d84c8d6ab03" }, "external_id" : "VELOCITY-126", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "String containing '##' is treated as unterminated String.", "desc" : "The following template snippet\n\n${System_err.println(\"###############################################\")}\n\nResults in this output:\n[INFO,STDERR] [rrd] 1042589262000 Error in interpolating string literal : \norg.apache.velocity.runtime.parser.ParseException: Lexical error: \norg.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 1, \ncolumn 49.  Encountered: <EOF> after : \"\"\n\nIf you're wondering what I'm doing, I've got System.err passed into velocity as \nSystem_err", "created_at" : { "$date" : "2003-01-15T08:21:25.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:18.741+0000" }, "creator_id" : { "$oid" : "5b7d354de9214a0d1608d682" }, "reporter_id" : { "$oid" : "5b7d354de9214a0d1608d682" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d035f627d84c8d6ab10" }, "external_id" : "VELOCITY-98", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#parse / #include causing ClassCastException", "desc" : "If caching is on, and a template has been previously cached due to a #parse or \n#include directive, subsequently using the other directive will cause a \nClassCastException and fail.\n\nExample: if I have two templates, the first one loaded includes the line:\n  #include( \"include/header.vtl\" )\nand the second one the line: \n  #parse( \"include/header.vtl\" )\n\nWhen the second page is viewed, a ClassCastException is thrown with an error in \nthe log like:\n\n[error] #parse() : arg = include/header.vtl.  Exception : \njava.lang.ClassCastException: \norg.apache.velocity.runtime.resource.ContentResource\n\nA solution might be to include the resourceType as part of the key when \ncaching/retrieving the resource, within the getResource() method of the \norg.apache.velocity.runtime.resource.ResourceManagerImpl class. Alternatively \nseperate caches could be used for the different types of Resource.", "created_at" : { "$date" : "2002-07-24T20:05:15.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:18.247+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d684" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d684" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d005f627d84c8d6aac0" }, "external_id" : "VELOCITY-108", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d005f627d84c8d6aac1" }, "effect" : "duplicates", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "desc" : "I've confirmed that both forward referenced and recursed Velocimacros cause\nerror messages in 1.3-rc1 and 1.3.1-rc2 (I assume the intervening versions are\naffected as well).  I have not (yet) tested 1.4-dev.\n\nThe error message currently spouted by\norg.apache.velocity.runtime.directive.VelocimacroProxy does not differentiate\nbetween forward referencing and recursion (it is a very similar problem), and is\nnot representitive of the problem.  It goes as follows:\n\n  2002-10-14 16:03:49,562 - VM #linkIf: error : too few arguments to macro.\nWanted 3 got 0\n\nThis issue can be reproduced through either of the following setups:\n\na) Use the #linkIf macro in your VM_global_library.vm, then define it later on\nin the file.\n\nb) Define a #linkIf macro which calls itself recursively.\n\nThe expected behavior is that Velocity will either provide a more accurate\ndescription of what it wants from the user, or allow forward referencing and\nrecursion without error messages.  If not already in use, perhaps a multi-pass\napproach to dealing with Velocimacro libraries should be put in place to\nimplement this.", "reporter_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "title" : "Use of Velocimacro forward reference and/or recursion causes error messages", "priority" : "Major", "status" : "Closed", "environment" : "Operating System: All\nPlatform: All", "updated_at" : { "$date" : "2007-03-08T00:04:18.362+0000" }, "issue_type" : "Bug", "resolution" : "Duplicate", "created_at" : { "$date" : "2002-10-15T06:32:29.000+0000" } },
{ "_id" : { "$oid" : "5b904d045f627d84c8d6ab32" }, "external_id" : "VELOCITY-159", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Not possible to get Velocity to log stack traces.", "desc" : "I am trying to get velocity to log stack traces, \nHowever setting the VelocityEngine.RUNTIME_LOG_ERROR_STACKTRACE does\nnot cause the stack traces to be printed, because \nRuntimeInstance.showStackTrace() first checks configuration.isInitialized(),\nwhich always seems to return false. :(\n\nIs there a problem with ExtendedProperties? Looking at the 2.1\nExtendedProperties source the isInitialized flag is never set, \nunless I am missing something.", "created_at" : { "$date" : "2003-04-03T08:57:32.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.787+0000" }, "creator_id" : { "$oid" : "5b7d3550e9214a0d1608d689" }, "reporter_id" : { "$oid" : "5b7d3550e9214a0d1608d689" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d055f627d84c8d6ab44" }, "external_id" : "VELOCITY-157", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocityEngine.init opens velocity.log multiple times", "desc" : "velocityEngine.init opens velocity.log multiple times   Every call to velocityEngine.init() opens velocity.log several times. Frequent calls to .init() (e.g. in doGet/doPost) will use up all file descriptors of the operation system.  This is a critical problem because Windows 2000 deletes all files that a process wants to open after Windows has no more file descriptors left. (On Windows NT 4.0 you get \"Too many open files\" and nothing is deleted)   Steps to reproduce: 1. java Test (see attachment) 2. While Test is still running do:  a) GNU/Linux: lsof | grep velocity.log|wc -l  b) Windows: handle | find \"velocity.log\"  (You can get handle.exe from http://www.systeminternals.com)   Expected Result: velocity.log should be opened one or a few times.  Actual Result: velocity.log is opened 900 times (9 times per call to \"init\").", "created_at" : { "$date" : "2003-03-30T03:21:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.687+0000" }, "creator_id" : { "$oid" : "5b7d3551e9214a0d1608d68a" }, "reporter_id" : { "$oid" : "5b7d3551e9214a0d1608d68a" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d055f627d84c8d6ab43" }, "effect" : "is part of", "type" : "Incorporates" } ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d065f627d84c8d6ab5b" }, "external_id" : "VELOCITY-154", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] Relative resource loading for #include and #parse", "desc" : "This little patch allows one to do\n \n#parse(\"foo.vm\")\n \nwhere foo.vm is located in the same directory as the template containing the \n#parse directive.\n \nIt is independant from the resource loader (and shouldn't impact loaders that \ndon't use path) : the only modified files are Parse.java and Include.java.\n \nCloD", "created_at" : { "$date" : "2003-03-18T00:40:16.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.606+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d065f627d84c8d6ab6a" }, "external_id" : "VELOCITY-166", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "avoid setting up file logging", "desc" : "Please avoid trying to setup file logging, if RuntimeConstants.RUNTIME_LOG\nproperty is not set or empty. The thrown exception (e.g. in\nSimpleLog4JLogSystem#init) is misleading! Having no [file] logging\nset, AFAIK has no implications on the production of the results,\nso it is neither a PANIC situation nor worth for a warning message.\n\nI would at max. assign it to the INFO level, speaking in terms of a log system...", "created_at" : { "$date" : "2003-04-18T08:10:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.950+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d075f627d84c8d6ab88" }, "external_id" : "VELOCITY-132", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "IllegalArgumentException while calling an overloaded method", "desc" : "If there are two methods with the same name and different parameters like:\npublic class myClass\n{\n    public String foo ( Integer intObj );\n    public String foo ( String str );\n}\n\nand a velocity template like this\n\n$myObj.foo( $someObj.getNull() )\n$myObj.foo( $str )\n\nwhile $someObj.getNull() returns null and $str is a java.lang.String object\nwith a String like 'test'. Because velocity caches the first method with the \nInteger argument on calling with the parameter null (which isn't of course of \nany type/class) the call fails with the String argument, because velocity tries\nto call the foo( Integer intObj )!\n\nIn the velocity log appears a IllegalArgumentException which is right, but \nvelocity should call the right method!\n\nmike", "created_at" : { "$date" : "2003-02-03T22:53:58.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.243+0000" }, "creator_id" : { "$oid" : "5b7d3554e9214a0d1608d68d" }, "reporter_id" : { "$oid" : "5b7d3554e9214a0d1608d68d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d075f627d84c8d6ab87" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d085f627d84c8d6aba8" }, "external_id" : "VELOCITY-151", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RuntimeInstance.setDefaultProperties() codepage problem", "desc" : "There is a bug in the RuntimeInstance setDefaultProperties method that prevents\nVelocity 1.3.1 from running on an IBM mainframe.\n\nThe code is currently written:\n \n          InputStream inputStream = classLoader\n                 .getResourceAsStream( DEFAULT_RUNTIME_PROPERTIES );\n \n             configuration.load( inputStream );\n \nWhich loads the default runtime properties into an ExtendedProperties\nobject.\nThis fails on an OS/390 which has a default codepage of Cp1047 (ebcdic),\nsince:\n \n 1) the properties resource is packaged in the Jar in codepage ISO8859_1.\n 2) The ExtendedProperties class attempts to load it using the default\n codepage (Cp1047).\n 3) Because of the codepage mismatch, the resulting ExtendedProperties\n object is empty and you get the error:\n \"It appears that no class was specified as the ResourceManager.  Please\n ensure that all configuration information is correct.\"\n \n Note that java.util.Properties.load(InputStream) ALWAYS loads using\n \"8859_1\", since properties files are assumed to be in ASCII.\n \n \n A workaround to this bug is to load the default properties manually, add\n your changes and pass them all to the  VelocityEngine.init(Properties)\n method.\n \n The fix is to change the line to:\n\n       configuration.load( inputStream, \"8859_1\" );\n \n Which is consistent with java.util.Properties.load().  Also, any other uses\n of the ExtendedProperties.load() should be changed as well.   In fact,\n ExtendedProperties.load() should probably default to \"8859_1\", IMO.", "created_at" : { "$date" : "2003-03-10T21:46:07.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.439+0000" }, "creator_id" : { "$oid" : "5b7d3555e9214a0d1608d690" }, "reporter_id" : { "$oid" : "5b7d3555e9214a0d1608d690" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d095f627d84c8d6abb7" }, "external_id" : "VELOCITY-144", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow absolute filename with FileResourceLoader", "desc" : "There is no way of providing an absolute path (e.g. c:\\temp\\wibble.tmp) to the \nFileResourceLoader because it always attempts to use the 2-argument File \nconstructor (even if the path component is empty).\n\nThe following fix resolves this problem:\nIn FileResourceLoader.findTemplate replace:\n  File file = new File( path, template );\nwith\n  File file = null;\n\n  if(\"\".equals(path))\n    file = new File( template );\n  else\n    file = new File ( path, template );\n\nNote this does not introduce any security risks as the FileResourceLoader must \nbe configured to search the empty (\"\") path.", "created_at" : { "$date" : "2003-02-26T00:35:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:19.345+0000" }, "creator_id" : { "$oid" : "5b7d3555e9214a0d1608d691" }, "reporter_id" : { "$oid" : "5b7d3555e9214a0d1608d691" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d095f627d84c8d6abc9" }, "external_id" : "VELOCITY-179", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "prevent execution of methods on Class, ClassLoader and related classes", "desc" : "Template designers currently have the capability to acquire a ClassLoader, \ninstantiate an arbitrary class, and call an arbitrary method.  (Example: [1], \nalthough more compact examples exist).  This is a drastic break with the MVC \nmodel, as template designers can execute any arbitary code.  It gets worse if \nyou have untrusted template designers who might call methods that erase files, \nexecute arbitrary SQL code, or shut down the VM.   This has been discussed on \nthe dev list [2].\n\nThis patch prevents any method from being called on objects of a class that \nhas reflection, classloader, or runtime capabilities.  (List at the end of the \nreport [4]).  It's configurable with a property, but the default is ON, as \nsecurity restrictions, IMHO, should be strict by default.\n\nAn alternate solution to this issue would be to prohibit the ClassLoader \nthrough the Java Security Manager, as proposed here [4].  I believe this \nsolution to be too difficult for the typical developer.  It's complex, and \nrequires knowledge of the Velocity source code.  Essentially, you have to \nsplit the files that execute the methods on the Java classes into a separate \nJAR file, then designate that jar file as not have permission to call \ngetClassLoader.  This requires that you (A) know what those Velocity classes \nare (B) understand how to work with the security manager, which is quite \ncomplex, and (C) have to modify the Velocity package every time there is a new \nrelease.  I think it would be better if this is handled natively within \nVelocity.  \n\nFinally, this patch does not include docs or test cases.  I'd be willing to \nwrite both, if a committer is willing to put in the patch.  \n\n[1] Example of VTL to call arbitray method\nhttp://nagoya.apache.org/eyebrowse/ReadMsg?listName=velocity-\ndev@jakarta.apache.org&msgNo=6114\n\n[2] Related discussion\nhttp://nagoya.apache.org/eyebrowse/ReadMsg?listId=102&msgNo=5980 \nhttp://nagoya.apache.org/eyebrowse/ReadMsg?listName=velocity-\nuser@jakarta.apache.org&msgNo=10444\n\n[3] Classes affected\n\njava.lang.Class\njava.lang.ClassLoader\njava.lang.Compiler\njava.lang.Package\njava.lang.Process\njava.lang.InheritableThreadLocal\njava.lang.Runtime\njava.lang.RuntimePermission\njava.lang.SecurityManager\njava.lang.System\njava.lang.Thread\njava.lang.ThreadGroup\njava.lang.ThreadLocal\njava.lang.reflect.*\n\n[4] Java security manager proposal\nhttp://nagoya.apache.org/eyebrowse/ReadMsg?listName=velocity-\ndev@jakarta.apache.org&msgNo=6012", "created_at" : { "$date" : "2003-05-30T05:16:23.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:20.288+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d0a5f627d84c8d6abed" }, "external_id" : "VELOCITY-186", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#set does not allow to assign nulls---cannot it be changed?", "desc" : "Currently #set does not change $ref if the value is null. To quote manual: \"If \nthe RHS evaluates to null, it is not assigned to the LHS\". It has some \nadvantages, but well, it has also disadvantages.\n\nIn my concrete case, I have #foreach loop, where I list some items. \nUnfortunatley, the listing (I mean the output) heavily depends on values of \nsome fields. Considering I have #foreach $item in $items I have to call \n$item.foo or $item.bar every time I need to check if the value is set or not. \nInstead I'd prefer to #set ($foo = $item.foo) a.s.o. and to use just $foo in \nfurther processing instead of calling $item getFoo() method all the time---\nit's not only about ease of writting, it's also about the time it takes to \ninvoke that method, plus the time of what this metod really does (it's not \nalways just simple return this.foo statement).\n\nOf course I would not like to break the compatibility of the #set behaviour, \nbut I wonder if would be there a way to actually add the possibility to set \nsome $ref to null, what would casue #if ($ref) to evaluate as false.\n\nCurrently, using #set causes, that if we step on $item.foo that returns null, \nwe have $ref set to the value of a previous $item. The workaround is to use \n$item.foo everywhere, but it's not very comfortable. Can it be done something \nabout that? Maybe on option in velocity.properties enabling of returning nulls \nor new operator (instead of '=') to assign null values (like ':=' for example).", "created_at" : { "$date" : "2003-06-22T21:57:01.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:20.805+0000" }, "creator_id" : { "$oid" : "5b7d3557e9214a0d1608d693" }, "reporter_id" : { "$oid" : "5b7d3557e9214a0d1608d693" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d055f627d84c8d6ab43" }, "external_id" : "VELOCITY-193", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d0b5f627d84c8d6ac08" }, "effect" : "is cloned by", "type" : "Cloners" }, { "issue_id" : { "$oid" : "5b904d055f627d84c8d6ab44" }, "effect" : "incorporates", "type" : "Incorporates" } ], "creator_id" : { "$oid" : "5b7d3558e9214a0d1608d695" }, "desc" : "When creating and then releasing to garbage collection multiple VelocityEngine instances, the \ninstances are apparently not closing out or otherwise letting go of their logger instances. As a \nresult, code that needs to create and destroy several VelocityEngine instances will eventually choke \nand die. This happens with either Avalon Logkit or Log4j, although the exact nature of the choking \ndiffers. This test program isolates the problem:\n\nimport org.apache.velocity.app.VelocityEngine;\npublic class IsolateVelocityBug {\n\tstatic public void main( String[] args ) {\n\t\tint repCount = Integer.parseInt( args[0] );\n\t\tfor( int i = 0; i < repCount; i++ ) {\n\t\t\tSystem.out.println( \"Test repetition \" + i + \"...\" );\n\t\t\ttry {\n\t\t\t\tfinal VelocityEngine velocityEngine = new VelocityEngine();\n\t\t\t\tvelocityEngine.init();\n\t\t\t} catch( Exception e ) {\n\t\t\t\tthrow new Error( e );\n\t\t\t}\n\t\t}\n\t}\n}\n\nRun the program with an integer command-line argument specifying the number of times to cycle \nthrough the loop, and make sure velocity-1.3.1.jar, commons-collections.jar, and either an Avalon \nLogkit or Log4j JAR are on your classpath. (I tested with logkit-1.0.1.jar and log4j-1.1.3.jar.) What \n*should* happen is that the program completes its specified number of loops, doing nothing but \nwriting \"Test repetition\" over and over with an incrementing number. What *does* happen, at least \non my machine, depends on which logging package is provided for Velocity.\n\nUsing Avalon Logkit 1.0.1, the program runs fine for 252 iterations; on the 253nd, it aborts with \nthe following message:\n\n    \"PANIC : Error configuring AvalonLogSystem : java.io.FileNotFoundException: /Users/ibeatty/\nDevelopment/javaDev/VelocityBugIsolator/velocity.log (Too many open files)\"\n\nUsing Log4j 1.1.3, the program runs fine for only one iteration; on the second and any subsequent \niterations, it continues but prints out a whole mess of\n\n    \"log4j:ERROR Attempted to append to closed appender named [null].\n     log4j:WARN Not allowed to write to a closed appender.\"\n\nThat happens for as long as I care to let it run (95 iterations, with something over 800 lines of \nsuch errors per iteration by the end).\n\nTo me, it sure looks like Velocity is leaving dangling loggers behind as VelocityEngine instances \nare created and discarded, and that the two logging systems respond differently to this but both \nhave problems.\n\nWhy, might you ask, should anyone care about making many VelocityEngine instances? I ran into it \nwhen developing a major web app using JUnit to build comprehensive test suites. To run \nindependently, every test has to start from scratch, which means getting its own VelocityEngine. \nMany tests means many instances, and the logging problem kicks in. Running JUnit test suites \nwithin Intellij IDEA and using Log4j, the ERROR/WARN messages were more than a nuicanse; \neventually, I'd start getting out-of-memory errors, too. These went away when I changed the tests \nto use a shared VelocityEngine instance (which caused its own set of problems).\n\nUsing binary download of Velocity 1.3.1, which claims to have been created on 2003-04-01.\n\nI find it hard to believe nobody else has tripped over this before, so maybe it's sensitive to the OS \nor something. It happened whether I compiled the test code with Javac or Jikes. Using Java \n1.4.1_01.", "reporter_id" : { "$oid" : "5b7d3558e9214a0d1608d695" }, "title" : "Memory/logger leak with multiple VelocityEngine instances", "priority" : "Critical", "status" : "Closed", "environment" : "Operating System: All\nPlatform: Macintosh", "updated_at" : { "$date" : "2007-03-08T00:04:21.003+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2003-07-19T03:21:01.000+0000" } },
{ "_id" : { "$oid" : "5b904d0c5f627d84c8d6ac2e" }, "external_id" : "VELOCITY-215", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "SimpleLog4JLogSystem property lookup should come from RuntimeConstants", "desc" : "The SimpleLog4JLogSystem class looks at the \nproperty \"runtime.log.logsystem.log4j.category\" when trying to determine \nwhich \"category\" to log to [should really be logger as Log4j no longer uses the \nterm 'category', but thats a different story...]\n\nThe property name should come from the RuntimeConstants class like most of the \nother property keys.", "created_at" : { "$date" : "2003-10-08T23:16:14.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:21.507+0000" }, "creator_id" : { "$oid" : "5b7d3559e9214a0d1608d69a" }, "reporter_id" : { "$oid" : "5b7d3559e9214a0d1608d69a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d0c5f627d84c8d6ac3f" }, "external_id" : "VELOCITY-214", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "References to non-public members (inner classes, fields, etc.) should log a warning rather than failing silently", "desc" : "When I try to access a property on an object through the context and the\ndefining class of that object is a non-public inner class the reference fails as\nif there was no object for that key in the context.\n\nI'd like to at least get a userful error message in the log.\n\nI have reproduced this with both velocity-1.3.1 and cvs HEAD as of today.", "created_at" : { "$date" : "2003-10-07T20:08:51.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:21.418+0000" }, "creator_id" : { "$oid" : "5b7d355fe9214a0d1608d69b" }, "reporter_id" : { "$oid" : "5b7d355fe9214a0d1608d69b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d0d5f627d84c8d6ac51" }, "external_id" : "VELOCITY-199", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "java.lang.ClassCastException: 'cache' doesn't map to a Boolean object", "desc" : "The initialization fails entirely due to what appears to be a problem\nconfiguring the logsystem. I found a single reference to someone else\nencountering this problem in the Google cache at the URL listed above\n(http://216.239.37.104/search?q=cache:swlDhCygFHoJ:www.disastertravel.com/computers/java/velocity/example_servlet.php+velocity+java.lang.ClassCastException:+%27cache%27+doesn%27t+map+to+a+Boolean+object&hl=en&ie=UTF-8)\n\nIn our case, the error occurs when initializing the standalone Velocity parser\nwith the following code:\n\nVelocity.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM_CLASS,\n\"org.apache.velocity.runtime.log.SimpleLog4JLogSystem\");\nVelocity.setProperty(\"runtime.log.logsystem.log4j.category\", \"velocity\");\nVelocity.init();\n\nThe \"velocity\" category is configured in the log4j_conf.xml file as:\n\n<log4j:configuration xmlns:log4j=\"http://jakarta.apache.org/log4j/\">\n    <appender name=\"velocity_app\" class=\"org.apache.log4j.FileAppender\">\n        <param name=\"File\"  \nvalue=\"/www/sites/tomcat/webapps/nndc/logs/idb_velocity.log\" />\n        <param name=\"Append\" value=\"true\" />\t    \t\n        <layout class=\"org.apache.log4j.PatternLayout\">\n            <param name=\"ConversionPattern\" value=\"%t %-5p %c{2} - %m%n\"/>\n        </layout>\t    \n    </appender>\n\n    <category name=\"velocity\">\n\t<priority value=\"warn\" />\n  \t<appender-ref ref=\"velocity_app\" />\n    </category>\n\n    <!-- Root & other categories snipped -->\n\n</log4j:configuration>\n\n\nStack trace:\n\njava.lang.ClassCastException: 'cache' doesn't map to a Boolean object\nat org.apache.commons.collections.ExtendedProperties.getBoolean(Unknown Source)\nat org.apache.commons.collections.ExtendedProperties.getBoolean(Unknown Source)\nat\norg.apache.velocity.runtime.resource.loader.ResourceLoader.commonInit(ResourceLoader.java:116)\nat\norg.apache.velocity.runtime.resource.ResourceManagerImpl.initialize(ResourceManagerImpl.java:186)\nat\norg.apache.velocity.runtime.RuntimeInstance.initializeResourceManager(RuntimeInstance.java:502)\nat org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:268)\nat org.apache.velocity.runtime.RuntimeSingleton.init(RuntimeSingleton.java:169)\nat org.apache.velocity.app.Velocity.init(Velocity.java:123)\nat gov.noaa.nndc.idb.IdbTemplateParser.initVelocity(IdbTemplateParser.java:145)\n\nThe handling of configuring the logsystem needs to be improved such that this is\nnot a fatal error. However, this bug may be somewhat difficult to pin down as I\nam unable to reproduce the problem on my local system, but it occurs in the\nremote deployment. In any case, I suspect it to be related to problems writing\nthe logfiles in the designated place that starts the chain of events that\nresults in the (seemingly unrelated) error.", "created_at" : { "$date" : "2003-08-21T01:37:51.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:21.328+0000" }, "creator_id" : { "$oid" : "5b7d3560e9214a0d1608d69c" }, "reporter_id" : { "$oid" : "5b7d3560e9214a0d1608d69c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d0e5f627d84c8d6ac60" }, "external_id" : "VELOCITY-219", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity list operator should return a Java List reference rather than ArrayList reference", "desc" : "In the 1.x releases of Velocity, the list operator [] returns an ArrayList\nreference instead of a List reference.  In the future (2.x), a cleaner API would\nbe to return a List reference.", "created_at" : { "$date" : "2003-10-29T11:47:15.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:21.904+0000" }, "creator_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "reporter_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d0e5f627d84c8d6ac77" }, "external_id" : "VELOCITY-216", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Thread safety fault in Directives when Template caching on", "desc" : "When the template caching is on, concurrent thread may used at the same time \nthe same compiled template.\nAs Directives are not designed to be stateless it may produce funny effect.\nExample: #foreach\n\n\nT1:     #foreach    ...    |    ...    |    ...    |    ...    |   \n           c=0            c=1   c=0   c=1   c=2   c=3   c=4 \nT2:                           #foreach...    |    ...    |\n    ---------|-------------|-----|-----|-----|-----|-----|------->", "created_at" : { "$date" : "2003-10-25T05:09:06.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:21.599+0000" }, "creator_id" : { "$oid" : "5b7d3561e9214a0d1608d69d" }, "reporter_id" : { "$oid" : "5b7d3561e9214a0d1608d69d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d0f5f627d84c8d6ac85" }, "external_id" : "VELOCITY-304", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "UberspectImpl#getPropertyGet should return null when not found", "desc" : "Currently, UberspectImpl#getPropertyGet will return an instance whether it has \nfound an \"alive\" AbstractExecutor or not.  This makes it hard to extend, \nbecause the caller can not tell if a proper getter was found.", "created_at" : { "$date" : "2004-10-16T13:41:18.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:22.919+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d105f627d84c8d6ac9c" }, "external_id" : "VELOCITY-260", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "patch to event handling configuration / new event handlers", "desc" : "Substantial patch to event handling infrastructure.  See readme.txt and \ndiscussion on velocity-dev list for more detail.  Key changes:\n\n(1) Event handlers can be registered in the velocity-properties, e.g.\n\neventhandler.referenceinsertion.class = \norg.apache.velocity.app.event.implement.EscapeXMLEntities\n\n(2) Multiple event handlers can be registered for a given type and are applied \nin a \"filter\" pattern.  The specifics vary per event handler (documented in \nthe JavaDocs).  The following example would first enforce a relative path rule \nto included templates, and would then check to see if the template is actually \navailable.\n\neventhandler.include.class = \norg.apache.velocity.app.event.implement.IncludeRelativePath,org.apache.velocity\n.app.event.implement.IncludeNotFound\n\t\n(3) Event handlers have a new lifecycle.  Before they are called they are \ninitialized with a link to RuntimeServices.  This allows the handlers to \nretrieve Velocity properties and to have access to a number of interesting \nsystem methods.  Each event handler is also given the current context when it \nis called.  This allows the template designer (or custom directives) to change \nthe behavior of the event.  A nice example of this is the EscapeXMLEntities \nreference insertion handler, which stops escaping HTML when an \"ignoreEscape\" \nflag is set in the context.\n\n(4) New implemented event handlers include:\n\t\t-- EscapeXMLEntities  (escapes HTML/XML & < > \")\n\t\t-- IncludeNotFound\n\t\t-- IncludeRelativePath\n\t\t-- PrintExceptions\n\t\nUsing these built-in event handlers, users can do useful things (e.g. escape \nHTML) with no extra coding just by configuring velocity.properties.\n\n(5) The patch is almost entirely backwards compatible.  The old \"attach the \nhandler to the context\" still works, although this results in a per-request \nrather than per-application lifecycle for the handler.  One difference... the \nAPI for the event handlers has changed, and as such will require minor editing \nand recompilation of user code.  (I think this is worth it).  All tests (old \nand new) work.", "created_at" : { "$date" : "2004-04-15T00:39:25.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:22.219+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d105f627d84c8d6ac9b" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d105f627d84c8d6acb1" }, "external_id" : "VELOCITY-274", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Errant space in velocity.properties file can cause classpath resource loader to fail", "desc" : "I just spent about two hours ferreting out this obnoxious bug, but it should be\ntrivial to fix.\n\nWhen configuring my velocity.properties file, I had the lines (taken verbatim\nfrom the documentation):\n\n# specify the resource loaders to use\nresource.loader = class \n\nclass.resource.loader.description = Velocity Classpath Resource Loader\nclass.resource.loader.class =\norg.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\nclass.resource.loader.cache = false\n\nI was consistently able to load a resource file from the classpath with\ngetClass().getClassLoader().getResourceAsStream(\"/my/package/foo.vm\") but\nVelocity consistently failed with the following stack trace:\n\nCaused by: org.apache.velocity.exception.ResourceNotFoundException: Unable to\nfind resource '/gov/noaa/nndc/idb/render/vm/field/textField.vm'\n    at\norg.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:458)\n    at\norg.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:341)\n    at\norg.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:831)\n    at\norg.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:813)\n    at\norg.apache.velocity.runtime.RuntimeSingleton.getTemplate(RuntimeSingleton.java:285)\n    at org.apache.velocity.app.Velocity.getTemplate(Velocity.java:469)\n    at gov.noaa.nndc.idb.IdbInitServlet.initVelocity(IdbInitServlet.java:241)\n    ... 47 more\n\n\nAfter much ado and hacking around, here is some of my debugging code and the output:\n\nSystem.out.println(\"Resource Loaders: \" +\nVelocity.getProperty(RuntimeConstants.RESOURCE_LOADER));\nSystem.out.println(\"Loader class: \" +\nVelocity.getProperty(\"class.resource.loader.class\"));            \n\n\nResource Loaders: [class ]\nLoader class: org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n\n\nIt turns out that that there was an errant space in the properties file after\nthe word \"class\" and this was causing the classpath resource loader not to be\nfound. Velocity should trim this whitespace when reading the properties file!", "created_at" : { "$date" : "2004-06-24T02:25:30.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:22.521+0000" }, "creator_id" : { "$oid" : "5b7d3560e9214a0d1608d69c" }, "reporter_id" : { "$oid" : "5b7d3560e9214a0d1608d69c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d115f627d84c8d6acc1" }, "external_id" : "VELOCITY-284", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "MethodInvocationException is handled inconsistently", "desc" : "It appears that the exception handling is different depending on whether the\nmethod is invoked as a passed parameter to a velocimacro or just in a template.\n\nEx.\n\n#doTextLink( ${myObj.exception})\n\n${myObj.exception}\n\nThe first #doTextLink macro will throw an exception, but it will be logged and\nignored. However, the second invocation will throw the exception properly.\n\nI have a patch that should fix this behavior. The exception just needs to be\nrethrown up the call stack. A small signature change to a couple of methods.\n\nThanks,\n\nMike Rettig", "created_at" : { "$date" : "2004-07-21T02:37:49.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:22.610+0000" }, "creator_id" : { "$oid" : "5b7d3564e9214a0d1608d69e" }, "reporter_id" : { "$oid" : "5b7d3564e9214a0d1608d69e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d125f627d84c8d6ace7" }, "external_id" : "VELOCITY-267", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Create a DataSourceResourceLoader that can be wired to the datasource with IoC", "desc" : "I'd like to create a ResourceLoader similar to DataSourceResourceLoader, except that I'd like to set \nthe DataSource via IoC (in Spring).  The main reason for this is so my database-loading of templates \ndoes not depend on a JNDI connection.  \n\nThe main problem is how to manage a ResourceLoader with Spring and then set it declaratively on its \nVelocityEngine - rather than via properties.\n\n<suggested patch from Will Glass-Husain>\nDoes this mean that you'd need to pass in an instance of a resource manager\n(initialized with the datasource) to VelocityEngine, rather than just set\nthe class name as a property? (MR - Yes)\n\nAs I understand the source code, this doesn't seem possible.  But I think a\npatch wouldn't be difficult.  (a change to\nRuntimeInstance.initializeResourceManager) to look for an instance of the\nclass as well as the class name.  Something similar to\nLogManager.createLogSystem which accepts as a property the class name of a\nclass that implements LogSystem, or an instance of the class itself.\n</suggested patch>", "created_at" : { "$date" : "2004-04-27T10:54:14.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:22.325+0000" }, "creator_id" : { "$oid" : "5b7d3565e9214a0d1608d69f" }, "reporter_id" : { "$oid" : "5b7d3565e9214a0d1608d69f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d135f627d84c8d6ad03" }, "external_id" : "VELOCITY-374", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VE throws NPE if not initialized", "desc" : "VelocityEngine throws a strange NPE if it's not initialized.  It'd be better \nif it threw an Exception with a meaningful error message.\n\nFrom jeichels@optonline.net <jeichels@optonline.net>\n\nI had another problem that I think can help others in the future.  In looking \nthrough the archives I noticed other people having the same null pointer \nexception I was having.  I went through the code and noticed that if a person \ndid not \"init()\" a velocity engine, the resourceManager never gets \ninitialized.  When they call the function below in RuntimeInstance.java, they \nget the null pointer exception.\n\n    public Template getTemplate(String name, String  encoding)\n        throws ResourceNotFoundException, ParseErrorException, Exception\n    {\n        return (Template)\n                resourceManager.getResource(name,\n                    ResourceManager.RESOURCE_TEMPLATE, encoding);\n    }\n\nERROR [http8080-Processor2] TemplateToStringManagerBD.getContentAsString() - \nVelocityEngine failed to merge the template.\njava.lang.NullPointerException\n        at org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:835)\n        at org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:817)\n        at org.apache.velocity.runtime.RuntimeSingleton.getTemplate\n(RuntimeSingleton.java:285)\n        at org.apache.velocity.app.Velocity.getTemplate(Velocity.java:469)\n        at \ncom.jb.commonmvc.view.template.velocity.TemplateToStringManagerBD.getContentAsS\ntring(TemplateToStringManagerBD.java:120)\n        at com.jb.commonmvc.transport.email.EmailTemplate.emailTemplate\n(EmailTemplate.java:37)", "created_at" : { "$date" : "2005-04-16T07:03:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.936+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904cf75f627d84c8d6aa11" }, "external_id" : "VELOCITY-373", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904cf75f627d84c8d6aa12" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "desc" : "Enhance the ParseErrorException to report:\n* template name (path)\n* error line\n* error column\n\nThe Click framework attempts to render the template error highlighting the\noffending line. However when templates or macros are included in a page, the \nsource of the error cannot be determined from the ParseErrorException message.\n\nIf the additional properties could be added to the ParseErrorException\nthe framework could accurately render the offending template error. This\ninformation should enable quicker debugging of usage errors by all Velocity users.", "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "title" : "Enhance ParseErrorException", "priority" : "Minor", "status" : "Closed", "environment" : "Operating System: other\nPlatform: Other", "updated_at" : { "$date" : "2007-03-08T00:04:23.823+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2005-04-10T19:06:31.000+0000" } },
{ "_id" : { "$oid" : "5b904d155f627d84c8d6ad2d" }, "external_id" : "VELOCITY-370", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NullPointerException in Introspector.java", "desc" : "In line 116 of the getMethod method of Introspector.java, a NullPointerException\ncan be thrown at this line:\n\nmsg = msg + params[i].getClass().getName();\n\nThe scenario was that an overloaded method in a tool class in my context was\nbeing called with a null parameter (i.e., params[i] was null).  That resulted in\nan AmbiguousException correctly being thrown, but the error message being built\nin this method was never being shown because a NullPointerException occurred\nfirst.  Looking at the code, you would expect to see something like this:\n\nIntrospection Error : Ambiguous method invocation someOverloadedMethod( null)\nfor class class com.blah.blah.MyTool\n\nInstead I was seeing this:\n\nASTMethod.execute() : exception from introspection : java.lang.NullPointerException\n\nEasy fix should be:\n\nif (params[i] == null)\n    msg = msg + \"null\";\nelse\n    msg = msg + params[i].getClass().getName();", "created_at" : { "$date" : "2005-03-31T04:29:51.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.602+0000" }, "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a2" }, "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d155f627d84c8d6ad3c" }, "external_id" : "VELOCITY-350", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Base Equality on toString() when operands are of different classes", "desc" : "This was discussed on the dev list a few weeks ago.  If two objects being \ncompared are of different (non-numeric) classes, I'd like to see equality be \nbased on toString (rather than just be false).  This just makes sense in a \ntemplate environment where types are not visible to template writers, and is \nalso the way that JSTL/JSP 2.0 works.  This is particularly useful when \ncomparing a literal String to a class implementing Bloch's Typesafe \nEnumeration pattern [1] or a StringBuffer.\n\nComments welcome.\n\n[1]\nhttp://java.sun.com/developer/Books/shiftintojava/", "created_at" : { "$date" : "2005-02-01T14:05:27.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.216+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d165f627d84c8d6ad4d" }, "external_id" : "VELOCITY-366", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Need verification of velocity templates to assure that non-UTF-8 characters are flagged for repair", "desc" : "There seem to be problem in interpolating the template when we add non-UTF\ncharacters in the velocity templates. \n\nA typical synario where we faced this issue was that a welcome message e-mail\n(velocity template) was missing the content portion as it contained the\ncharecter \"\". We could reproduce the problem consistently by adding this\ncharecter in the velocity template.\n\nIt would be great if we get velocity to handle these type of data as there is a\npossibility of making the contents look weird otherwise.", "created_at" : { "$date" : "2005-03-08T18:56:50.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.502+0000" }, "creator_id" : { "$oid" : "5b7d3569e9214a0d1608d6a3" }, "reporter_id" : { "$oid" : "5b7d3569e9214a0d1608d6a3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d0b5f627d84c8d6ac08" }, "external_id" : "VELOCITY-360", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d055f627d84c8d6ab43" }, "effect" : "is cloned by", "type" : "Cloners" } ], "creator_id" : { "$oid" : "5b7d356ae9214a0d1608d6a4" }, "desc" : "If you instance and init multiple engines, under some circumstances that are not\nyet clear, there is an error on the log4j logger.\n\nFor example the following code:\n\npublic static void main(String[] args) throws Exception\n{\n       VelocityEngine[] engines = new VelocityEngine[4];\n        \n        for (int i = 0; i < engines.length; i++)\n        {\n            VelocityEngine engine = new VelocityEngine();\n            engine.setProperty(RuntimeConstants.FILE_RESOURCE_LOADER_PATH,\n\"C:\\\\temp\");\n            engine.init();\n        }\n}\n\nwill generate 141 lines of the following error:\n\nlog4j:ERROR Attempted to append to closed appender named [null].\n\nDebugging Velocity source code we noticed that all the engines add an appender\nto the same shared logger and sometime a null appender is added.\nWe are currently using Velocity 1.4 and Log4J 1.2.9.", "reporter_id" : { "$oid" : "5b7d356ae9214a0d1608d6a4" }, "title" : "Logger error with multiple Velocity engines", "priority" : "Major", "status" : "Closed", "environment" : "Operating System: Windows 2000\nPlatform: PC", "updated_at" : { "$date" : "2007-03-08T00:04:23.402+0000" }, "issue_type" : "Bug", "resolution" : "Duplicate", "created_at" : { "$date" : "2005-02-23T02:04:19.000+0000" } },
{ "_id" : { "$oid" : "5b904d235f627d84c8d6ad6f" }, "external_id" : "VELOCITY-359", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#if(some expression)#end causes ParseException", "desc" : "#if(...) #end works but #if(...)#end\n\nStacktrace:\n\norg.apache.velocity.exception.ParseErrorException: Encountered \"#en\nd\\n\" at line 61, column 44.\nWas expecting one of:\n    \"(\" ...\n    <RPAREN> ...\n    <ESCAPE_DIRECTIVE> ...\n    <SET_DIRECTIVE> ...\n    \"\\\\\\\\\" ...\n    \"\\\\\" ...\n    <TEXT> ...\n    <SINGLE_LINE_COMMENT> ...\n    \"*#\" ...\n    \"*#\" ...\n    <STRING_LITERAL> ...\n    \"if\" ...\n    \"stop\" ...\n    <NUMBER_LITERAL> ...\n    <WORD> ...\n    <DOT> ...\n    \"{\" ...\n    \"}\" ...\n    <IDENTIFIER> ...\n\nIf you wonder why we write such stupid statements: We use velocity inside a CMS\nwhere it is possible to leave texts blank inside an #if-block.", "created_at" : { "$date" : "2005-02-21T23:18:29.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.312+0000" }, "creator_id" : { "$oid" : "5b7d356be9214a0d1608d6a5" }, "reporter_id" : { "$oid" : "5b7d356be9214a0d1608d6a5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d235f627d84c8d6ad7f" }, "external_id" : "VELOCITY-336", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't pass a Map to a method.", "desc" : "Can't pass the new Map feature to a method.\n\nThis is due the the Parser taking both Map() and Reference() in Parameter().  \nBut only Reference() get's recognized inside a method call.\n\nSee this thread in the user list for details:\n  http://mail-archives.apache.org/eyebrowse/BrowseList?listName=velocity-\nuser@jakarta.apache.org&by=thread&from=973444", "created_at" : { "$date" : "2005-01-16T00:06:39.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:23.011+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d075f627d84c8d6ab87" }, "external_id" : "VELOCITY-389", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d075f627d84c8d6ab88" }, "effect" : "duplicates", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d3554e9214a0d1608d68e" }, "desc" : "If there are two methods with the same name and different parameters like:\npublic class myClass\n{\n    public String foo ( Integer intObj );\n    public String foo ( String str );\n}\n\nand a velocity template like this\n\n$myObj.foo( $someObj.getNull() )\n$myObj.foo( $str )\n\nwhile $someObj.getNull() returns null and $str is a java.lang.String object\nwith a String like 'test'. Because velocity caches the first method with the \nInteger argument on calling with the parameter null (which isn't of course of \nany type/class) the call fails with the String argument, because velocity tries\nto call the foo( Integer intObj )!\n\nIn the velocity log appears a IllegalArgumentException which is right, but \nvelocity should call the right method!\n\nthe bug appears only, if the call of foo is in a file\nwhich is included by #parse. \n\nYou can reproduce the bug with following files:\n\nmain template file:\n#set ( $param = $someobj.getNull() )\n#parse ( \"includecall.vm\" )<br>\n#set ( $param = \"a string\" )\n#parse ( \"includecall.vm\" )\n\nincludecall.vm:\n$testobj.foo( $param )\n\nclass with the name someobj in the context:\n\npublic class VelocityCachingBug\n{\n    public VelocityCachingBug()\n    {\n    }\n\n    public String foo ( Integer s )\n    {\n        return \"Integer\";\n    }\n\n    public String foo ( String i )\n    {\n        return \"String\";\n    }\n\n    public Object getNull()\n    {\n        return null;\n    }\n}\n\nif you render the main template, the second call can't be found by velocity\nbecause the parsed file is cached only once (as one single node). \n\nI don't think the solution to this is to cache every call in a parsed file (if\nit's parsed more than once), because that can lead to much more memory use if\nyou have many parsed files (like we have...), which are mostly the same.\n\nmike", "reporter_id" : { "$oid" : "5b7d3554e9214a0d1608d68e" }, "title" : "IllegalArgumentException while calling an overloaded method", "priority" : "Major", "status" : "Closed", "environment" : "Operating System: All\nPlatform: All", "updated_at" : { "$date" : "2007-03-08T00:04:24.884+0000" }, "issue_type" : "Bug", "resolution" : "Invalid", "created_at" : { "$date" : "2005-07-06T17:35:59.000+0000" } },
{ "_id" : { "$oid" : "5b904d255f627d84c8d6ada9" }, "external_id" : "VELOCITY-383", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Non thread-safe Template object can cause NPE under heavy concurrent load", "desc" : "During load testing the server, with 50 concurrent users, the \nVelocityViewServlet would throw a null pointer exception about 3% of the time. \n97% of the time, the page would serve normally.\n\nBelow is the trace:\njava.lang.NullPointerException\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.init\n(ASTDirective.java:94)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.init\n(SimpleNode.java:201)\n\tat org.apache.velocity.Template.initDocument(Template.java:199)\n\tat org.apache.velocity.Template.process(Template.java:124)\n\tat \norg.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource\n(ResourceManagerImpl.java:423)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource\n(ResourceManagerImpl.java:341)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:831)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:813)\n\tat org.apache.velocity.runtime.RuntimeSingleton.getTemplate\n(RuntimeSingleton.java:285)\n\tat \norg.apache.velocity.tools.view.servlet.VelocityViewServlet.getTemplate\n(VelocityViewServlet.java:540)\n\tat \norg.apache.velocity.tools.view.servlet.VelocityViewServlet.handleRequest\n(VelocityViewServlet.java:475)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doRequest\n(VelocityViewServlet.java:407)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doPost\n(VelocityViewServlet.java:383)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:674)\n\tat org.apache.catalina.core.ApplicationDispatcher.doInclude\n(ApplicationDispatcher.java:576)\n\tat org.apache.catalina.core.ApplicationDispatcher.include\n(ApplicationDispatcher.java:501)\n\tat org.apache.velocity.tools.view.ImportSupport.acquireString\n(ImportSupport.java:140)\n\tat org.apache.velocity.tools.struts.TilesTool.doInsert\n(TilesTool.java:476)\n\tat org.apache.velocity.tools.struts.TilesTool.doInsert\n(TilesTool.java:419)\n\tat org.apache.velocity.tools.struts.TilesTool.processUrl\n(TilesTool.java:398)\n\tat org.apache.velocity.tools.struts.TilesTool.processAsDefinitionOrURL\n(TilesTool.java:357)\n\tat org.apache.velocity.tools.struts.TilesTool.processObjectValue\n(TilesTool.java:305)\n\tat org.apache.velocity.tools.struts.TilesTool.get(TilesTool.java:135)\n\tat sun.reflect.GeneratedMethodAccessor136.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.apache.velocity.runtime.parser.node.GetExecutor.execute\n(GetExecutor.java:65)\n\tat \norg.apache.velocity.util.introspection.UberspectImpl$VelGetterImpl.invoke\n(UberspectImpl.java:302)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute\n(ASTIdentifier.java:157)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute\n(ASTReference.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render\n(ASTReference.java:220)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render\n(SimpleNode.java:230)\n\tat org.apache.velocity.Template.merge(Template.java:256)\n\tat \norg.apache.velocity.tools.view.servlet.VelocityViewServlet.mergeTemplate\n(VelocityViewServlet.java:592)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doRequest\n(VelocityViewServlet.java:417)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doPost\n(VelocityViewServlet.java:383)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:674)\n\tat org.apache.catalina.core.ApplicationDispatcher.processRequest\n(ApplicationDispatcher.java:465)\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java:400)\n\tat org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:303)\n\tat org.apache.struts.action.RequestProcessor.doForward\n(RequestProcessor.java:1063)\n\tat org.apache.struts.tiles.TilesRequestProcessor.doForward\n(TilesRequestProcessor.java:263)\n\tat org.apache.struts.tiles.TilesRequestProcessor.processTilesDefinition\n(TilesRequestProcessor.java:239)\n\tat org.apache.struts.tiles.TilesRequestProcessor.processForwardConfig\n(TilesRequestProcessor.java:302)\n\tat org.apache.struts.action.RequestProcessor.process\n(RequestProcessor.java:229)\n\tat org.apache.struts.action.ActionServlet.process\n(ActionServlet.java:1194)\n\tat org.apache.struts.action.ActionServlet.doPost\n(ActionServlet.java:432)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:105)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:825)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnecti\non(Http11Protocol.java:731)\n\tat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket\n(PoolTcpEndpoint.java:526)\n\tat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt\n(LeaderFollowerWorkerThread.java:80)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:684)\n\tat java.lang.Thread.run(Unknown Source)", "created_at" : { "$date" : "2005-06-12T07:55:35.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:24.735+0000" }, "creator_id" : { "$oid" : "5b7d356fe9214a0d1608d6a7" }, "reporter_id" : { "$oid" : "5b7d356fe9214a0d1608d6a7" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d265f627d84c8d6adc9" }, "external_id" : "VELOCITY-382", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "getResourceStream returns null instead of throwing an ResourceNotFoundException", "desc" : "According to the documentation of org.apache.velocity.runtime.resource.loader.\ngetResourceStream(String name), it should throw an ResourceNotFoundException \nwhen the resource with the given name can't be found. But the Exception isn't \nthrown, null is returned as result from the \"classLoader.getResourceAsStream( name\n )\" method.", "created_at" : { "$date" : "2005-06-09T21:47:09.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:24.603+0000" }, "creator_id" : { "$oid" : "5b7d3571e9214a0d1608d6a9" }, "reporter_id" : { "$oid" : "5b7d3571e9214a0d1608d6a9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d275f627d84c8d6add9" }, "external_id" : "VELOCITY-381", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Silent Failure of a toString that return null", "desc" : "$!method.toString() -\n$!method.getInstance().toString() -\n$!method -\n$!method.getInstance()\n\nif the toString method returns null, \nthis will return ' - - null - null'\n\nsee attached testcase", "created_at" : { "$date" : "2005-05-25T00:25:02.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:24.455+0000" }, "creator_id" : { "$oid" : "5b7d3554e9214a0d1608d68f" }, "reporter_id" : { "$oid" : "5b7d3554e9214a0d1608d68f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d285f627d84c8d6adee" }, "external_id" : "VELOCITY-412", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Enable access to application attributes", "desc" : "Enable the getting of application attributes held by the RuntimeInstance.\n\nCurrently you can set application attributes through the RuntimeServices interface, but you cannot get them.\n\nWhen Click starts up it initialises a custom Logger with Velocity and sets the logging level to INFO which produces useful initialisation debug information. \n\nOnce initialisation has been completed it Click needs to turn down the Logger level to WARN, so that Velocity resource loading messages are not displayed.\n\nPlease see the attached patches.\n\nregards Malcolm Edgar", "created_at" : { "$date" : "2005-10-19T08:52:54.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:25.940+0000" }, "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d285f627d84c8d6adfb" }, "external_id" : "VELOCITY-411", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "org.apache.velocity.app.event.implement.EscapeReference needs a guard against NPE", "desc" : "If reference value passed to EscapeReference.referenceInsert(String reference, Object value)  is null,\nthen derived clases produce NPE  when trying to do toString()\n\nThis condition shall be guarded like this: ( insert it on line 86 - too trivial for a patch ) \n        if(value == null) \n                return value;\n", "created_at" : { "$date" : "2005-10-12T20:45:12.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:25.805+0000" }, "creator_id" : { "$oid" : "5b7d3558e9214a0d1608d697" }, "reporter_id" : { "$oid" : "5b7d3558e9214a0d1608d697" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d295f627d84c8d6ae04" }, "external_id" : "VELOCITY-409", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Convert Exceptions to RuntimeExceptions", "desc" : "There's a movement in the field to simplify Java development by using unchecked Exceptions rather than checked Exceptions.  Most notably this approach has been championed by Rod Johnson (J2EE without EJB, Spring Framework) and Bruce Eckels (Thinking in Java).   In the last 2 years, popular libraries like Spring Framework and Hibernate 3.0 have used unchecked exceptions.\n\nQuote from the DeveloperWorks article listed below:\n\n\"Some exceptions are basically secondary return codes (which generally signal violation of business rules), and some are of the \"something went horribly wrong\" variety (such as failure to make a database connection). Johnson advocates using checked exceptions for the first category (alternative return codes), and runtime exceptions for the latter category. In the \"something went horribly wrong\" category, the motivation is simply to recognize the fact that no caller is going to effectively handle this exception, so it might as well get propagated all the way up the stack with the minimum of impact on the intervening code (and minimize the chance of exception swallowing).\"\n\nI'd argue that Velocity exceptions like ParseException and ResourceNotFoundException are of the \"horribly wrong\" category.  Probably MethodInvocationException as well.  In version 2.0, we should consider making VelocityException a subclass of java.lang.RuntimeException.\n\nResources:\n\nhttp://www-128.ibm.com/developerworks/java/library/j-jtp05254.html\n\nHere's an argument against this practice:\nhttp://java.sun.com/docs/books/tutorial/essential/exceptions/runtime.html", "created_at" : { "$date" : "2005-10-04T07:29:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:25.666+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2a5f627d84c8d6ae10" }, "external_id" : "VELOCITY-404", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Uberspect - info is created wrong / premature blocking of invalid methods", "desc" : "Reported and patch submitted by Llwellyn Falco & Dan Powell.  Email below:\n\nSorry,\n\n    apparently i am being a bit confusing.\n\n    the patch was rather large (six lines of code) so i can understand why i \nshould have explained it more clearly,\n\n    The patch is against 3 issues, 1 of them i submitted when the old \nbugzilla, the other 2 don't exist. but there is a unit test per each issue \nsubmitted with the patch.\n    don't quite understand why i would create an issue merely to close it. i \nmean if i needed to show my boss i was working the busy work would make \nsense, but as we are all doing this\n    in our free time.... if you feel you need notes that better explain the \npatch than the unit tests, by all means fell free, but i personally can't \nthink what i would write that is more precise than actual code.\n\n    issue 1 (this is Velocity-381)\n\n\n[ see Velocity-381 ]\n\n  issue 2 (no jira issue)\n the info is created wrong.\n code change\n----\n-                method = rsvc.getUberspect().getMethod(o, methodName, \nparams, new Info(\"\",1,1));\n+                method = rsvc.getUberspect().getMethod(o, methodName, \nparams, new Info(context.getCurrentTemplateName(), getLine(), getColumn()));\n-----\n the test checks against an uberspect that throws exceptions with it can't \nfind stuff.\n(this is also useful for development, but i am trying to start with small \nchanges as to keep things simple, so kept it to testing)\n---\n    public Info getInfoFor(String velocity) throws Exception {\n        try {\n            parseString(velocity, this);\n            fail(\"Uberspect Should have thrown an exception\");\n            throw new Error(\"Shouldn't be able to reach this point\");\n        } catch (VelocityParsingError t) {\n            return t.getInfo();\n        }\n    }\n\n    public void testInfoForField() throws Exception {\n        Info i = getInfoFor(\"$main.unknownField\");\n        assertInfoEqual(i, \"$main.unknownField\", 1, 7);\n    }\n\n    public void testInfoForMethod() throws Exception {\n        Info i = getInfoFor(\"$main.unknownMethod()\");\n        assertInfoEqual(i, \"$main.unknownMethod()\", 1, 7);\n    }\n\n    private void assertInfoEqual(Info i, String name, int line, int column) \n{\n        assertEquals(\"Template Name\", name, i.getTemplateName());\n        assertEquals(\"Template Line\", line, i.getLine());\n        assertEquals(\"Template Column\", column, i.getColumn());\n    }\n---\n\nThe third test also deals with the uberspect. design indicates that the \nuberspect should be asked to find the method, and therefore if you wanted a \nto write an uberspect to check when you are calling methods on null's you \ncould write one. but the parser blocked it.\nthe test is\n---\n    public void testNullPointer() {\n        assertErrorThrown(\"$main.getNull().callMethod()\");\n    }\n\n    private void assertErrorThrown(String string) {\n        try {\n            String result = parseString(string, this);\n        Assert.fail(\"parsing '\" + string + \"' did not fail but returned '\" + \nresult + \"'\");\n        } catch (Throwable t) {\n            return;\n        }\n    }\n---- \n\n  the code change is the removal of premature exit\n-                if (result == null)\n-                {\n-                    return null;\n-                }\n\n\n", "created_at" : { "$date" : "2005-09-24T02:34:30.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:25.444+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2b5f627d84c8d6ae21" }, "external_id" : "VELOCITY-403", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Enhance Velocity's LogSystem and internal use thereof", "desc" : "After several very, very long debates with Geir over commons-logging, i have become largely convinced that it is something we should do with hesitation (i.e. let's talk about it for 2.0, but not before).   i've also begun to have some frustrations with commons-logging in both work projects and in VelocityTools.\n\nregardless of these issues, it is clear to me that Velocity's LogSystem and use of it is in great need of improvement.  we need to lower the priority of many messages, eliminate some, and above all, upgrade the system itself to be more useful.\n\nsome specific, unevaluated, off-the-cuff ideas are:\n-make logging a null-op if no logger is found, rather than panic and break\n-detect jdk 1.4+ logging\n-add a trace level\n-add is<Level>Enabled\n-make it possible to grab a LogSystem instance of sorts, so Velocity extensions can use it more sensibly (i'm tired of the hacks we must do in Tools)\n\nthose are just a few ideas, and they might not all even be feasible.  still, i'm hoping to take a whack at some of this and hoping that others can help me out.  my volunteer time is still rather limited.", "created_at" : { "$date" : "2005-09-20T02:17:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:25.080+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2b5f627d84c8d6ae47" }, "external_id" : "VELOCITY-424", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "directive.Parse eating RuntimeException", "desc" : "The org.apache.velocity.runtime.directive.Parse class is \"eating\" RuntimeExceptions thrown by Nodes being rendered on line 195.   These errors are logged, but are not rethrown.\n\nThese types of errors are typically NPE being thrown by model objects trying to render themselves using their toString() method.\n\nIt is better if any RuntimeExceptions are not caught by this method, as it allows the calling code to document/report the error. ", "created_at" : { "$date" : "2005-11-22T20:07:40.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.569+0000" }, "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2c5f627d84c8d6ae58" }, "external_id" : "VELOCITY-414", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Extend the MethodInvocation exception to be able to give the velocity macro writer a usefull error page", "desc" : "We use velocity macros that invoke methods in a java written web engine.\nWhen an invoked method fails because of an exception,  it is not\npossible to use the\nMethodInvocation exception to give the velocity macro writer a usefull\nerror page since the MethodInvocation Exception has not cause set.\nSo to be short the reason why the method invocation failed can not be\nrouted back to the veloticy macro writer on a running system.\n\nI extended the MethodInvocationException.java and the method execute in\nASTMethod.java \n\nproposed changes in MethodInvocationException.java : \n===============================================\npackage org.apache.velocity.exception; \n\nimport org.apache.velocity.exception.VelocityException;\nimport org.apache.velocity.runtime.parser.Token;\n\n/*\n * Copyright 2001,2004 The Apache Software Foundation.\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *      http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n *  Application-level exception thrown when a reference method is \n *  invoked and an exception is thrown.\n *  <br>\n *  When this exception is thrown, a best effort will be made to have\n *  useful information in the exception's message.  For complete \n *  information, consult the runtime log.\n *\n * @author <a href=\"mailto:geirm@optonline.net\">Geir Magnusson Jr.</a>\n * @version $Id: MethodInvocationException.java,v 1.2.14.1 2004/03/03 23:22:54 geirm Exp $\n */\npublic class MethodInvocationException extends VelocityException\n{\n    private String methodName = \"\";\n    private String referenceName = \"\";\n    private Throwable wrapped = null;\n    private int line; // Added by CX\n    private int column; // Added by CX\n\n    /**\n     *  CTOR - wraps the passed in exception for\n     *  examination later\n     *\n     *  @param message \n     *  @param e Throwable that we are wrapping\n     *  @param methodName name of method that threw the exception\n     */\n    public MethodInvocationException( String message, Throwable e, String methodName )\n    {\n        super(message);\n        this.wrapped = e;\n        this.methodName = methodName;\n    }       \n\n    /**\n     *  Returns the name of the method that threw the\n     *  exception\n     *\n     *  @return String name of method\n     */\n    public String getMethodName()\n    {\n        return methodName;\n    }\n\n    /**\n     *  returns the wrapped Throwable that caused this\n     *  MethodInvocationException to be thrown\n     *  \n     *  @return Throwable thrown by method invocation\n     */\n    public Throwable getWrappedThrowable()\n    {\n        return wrapped;\n    }\n\n    /**\n     *  Sets the reference name that threw this exception\n     *\n     *  @param reference name of reference\n     */\n    public void setReferenceName( String ref )\n    {\n        referenceName = ref;\n    }\n\n    /**\n     *  Retrieves the name of the reference that caused the \n     *  exception\n     *\n     *  @return name of reference\n     */\n    public String getReferenceName()\n    {\n        return referenceName;\n    }\n\n    /**\n     *  Retrieves the line number where the error occured\n     * \n     * @return line number\n     */\n\tpublic int getLine() \n\t{\n\t\treturn line;\n\t}\n\t\n    /**\n     *  Sets the line number where the error occured\n     *\n     *  @param line\n     */\n\tpublic void setLine(int line) \n\t{\n\t\tthis.line = line;\n\t}\n\n\t/**\n\t * Retrieves the line number where the error occured\n\t * \n\t * @return column number\n\t */\n\tpublic int getColumn() \n\t{\n\t\treturn column;\n\t}\n\n\t/**\n\t *  Sets the column number where the error occured\n\t *  \n\t * @param column\n\t */\n\tpublic void setColumn(int column) \n\t{\n\t\tthis.column = column;\n\t}\n    \n}\n\n===============================================\nProposed changes in ASTMethod.java\n===============================================\npackage org.apache.velocity.runtime.parser.node;\n\n/*\n * Copyright 2000-2001,2004 The Apache Software Foundation.\n * \n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * \n *      http://www.apache.org/licenses/LICENSE-2.0\n * \n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport org.apache.velocity.context.InternalContextAdapter;\nimport org.apache.velocity.runtime.parser.*;\nimport org.apache.velocity.util.introspection.IntrospectionCacheData;\nimport org.apache.velocity.util.introspection.VelMethod;\nimport org.apache.velocity.util.introspection.Info;\n\nimport org.apache.velocity.exception.MethodInvocationException;\nimport java.lang.reflect.InvocationTargetException;\n\nimport org.apache.velocity.app.event.EventCartridge;\n\n/**\n *  ASTMethod.java\n *\n *  Method support for references :  $foo.method()\n *\n *  NOTE :\n *\n *  introspection is now done at render time.\n *\n *  Please look at the Parser.jjt file which is\n *  what controls the generation of this class.\n *\n * @author <a href=\"mailto:jvanzyl@apache.org\">Jason van Zyl</a>\n * @author <a href=\"mailto:geirm@optonline.net\">Geir Magnusson Jr.</a>\n * @version $Id: ASTMethod.java,v 1.24.4.1 2004/03/03 23:22:59 geirm Exp $ \n */\npublic class ASTMethod extends SimpleNode\n{\n    private String methodName = \"\";\n    private int paramCount = 0;\n\n    public ASTMethod(int id)\n    {\n        super(id);\n    }\n\n    public ASTMethod(Parser p, int id)\n    {\n        super(p, id);\n    }\n\n    /** Accept the visitor. **/\n    public Object jjtAccept(ParserVisitor visitor, Object data)\n    {\n        return visitor.visit(this, data);\n    }\n\n    /**\n     *  simple init - init our subtree and get what we can from \n     *  the AST\n     */\n    public Object init(  InternalContextAdapter context, Object data)\n        throws Exception\n    {\n        super.init(  context, data );\n\n        /*\n         *  this is about all we can do\n         */\n\n        methodName = getFirstToken().image;\n        paramCount = jjtGetNumChildren() - 1;\n\n        return data;\n    }\n\n    /**\n     *  invokes the method.  Returns null if a problem, the\n     *  actual return if the method returns something, or \n     *  an empty string \"\" if the method returns void\n     */\n    public Object execute(Object o, InternalContextAdapter context)\n        throws MethodInvocationException\n    {\n        /*\n         *  new strategy (strategery!) for introspection. Since we want \n         *  to be thread- as well as context-safe, we *must* do it now,\n         *  at execution time.  There can be no in-node caching,\n         *  but if we are careful, we can do it in the context.\n         */\n\n        VelMethod method = null;\n\n        Object [] params = new Object[paramCount];\n\n        try\n        {\n            /*\n             *   check the cache \n             */\n\n            IntrospectionCacheData icd =  context.icacheGet( this );\n            Class c = o.getClass();\n\n            /*\n             *  like ASTIdentifier, if we have cache information, and the\n             *  Class of Object o is the same as that in the cache, we are\n             *  safe.\n             */\n\n            if ( icd != null && icd.contextData == c )\n            {\n                /*\n                 * sadly, we do need recalc the values of the args, as this can \n                 * change from visit to visit\n                 */\n\n                for (int j = 0; j < paramCount; j++)\n                    params[j] = jjtGetChild(j + 1).value(context);\n\n                /*\n                 * and get the method from the cache\n                 */\n\n                method = (VelMethod) icd.thingy;\n            }\n            else\n            {\n                /*\n                 *  otherwise, do the introspection, and then\n                 *  cache it\n                 */\n\n                for (int j = 0; j < paramCount; j++)\n                    params[j] = jjtGetChild(j + 1).value(context);\n\n                method = rsvc.getUberspect().getMethod(o, methodName, params, new Info(\"\",1,1));\n\n                if (method != null)\n                {    \n                    icd = new IntrospectionCacheData();\n                    icd.contextData = c;\n                    icd.thingy = method;\n                    context.icachePut( this, icd );\n                }\n            }\n \n            /*\n             *  if we still haven't gotten the method, either we are calling \n             *  a method that doesn't exist (which is fine...)  or I screwed\n             *  it up.\n             */\n\n            if (method == null)\n                return null;\n        }\n        catch( MethodInvocationException mie )\n        {\n            /*\n             *  this can come from the doIntrospection(), as the arg values\n             *  are evaluated to find the right method signature.  We just\n             *  want to propogate it here, not do anything fancy\n             */\n\n            throw mie;\n        }\n        catch( Exception e )\n        {\n            /*\n             *  can come from the doIntropection() also, from Introspector\n             */\n\n            rsvc.error(\"ASTMethod.execute() : exception from introspection : \" + e);\n            return null;\n        }\n\n        try\n        {\n            /*\n             *  get the returned object.  It may be null, and that is\n             *  valid for something declared with a void return type.\n             *  Since the caller is expecting something to be returned,\n             *  as long as things are peachy, we can return an empty \n             *  String so ASTReference() correctly figures out that\n             *  all is well.\n             */\n\n            Object obj = method.invoke(o, params);\n            \n            if (obj == null)\n            {\n                if( method.getReturnType() == Void.TYPE)\n                     return new String(\"\");\n            }\n            \n            return obj;\n        }\n        catch( InvocationTargetException ite )\n        {\n            /*\n             *  In the event that the invocation of the method\n             *  itself throws an exception, we want to catch that\n             *  wrap it, and throw.  We don't log here as we want to figure\n             *  out which reference threw the exception, so do that \n             *  above\n             */\n\n            EventCartridge ec = context.getEventCartridge();\n\n            /*\n             *  if we have an event cartridge, see if it wants to veto\n             *  also, let non-Exception Throwables go...\n             */\n\n            if ( ec != null && ite.getTargetException() instanceof java.lang.Exception)\n            {\n                try\n                {\n                    return ec.methodException( o.getClass(), methodName, (Exception)ite.getTargetException() );\n                }\n                catch( Exception e )\n                {\n                    MethodInvocationException miex = new MethodInvocationException( \n                        \"Invocation of method '\" \n                        + methodName + \"' in  \" + o.getClass() \n                        + \" threw exception \" \n                        + e.getClass() + \" : \" + e.getMessage(), \n                        e, methodName );\n                    miex.initCause(ite.getTargetException());\n                    miex.setLine(first.beginLine);\n                    miex.setColumn(first.beginColumn);\n                    throw miex;\n                }\n            }\n            else\n            {\n                /*\n                 * no event cartridge to override. Just throw\n                 */\n\n            \tMethodInvocationException miex = new MethodInvocationException( \n                \"Invocation of method '\" \n                + methodName + \"' in  \" + o.getClass() \n                + \" threw exception \" \n                + ite.getTargetException().getClass() + \" : \"\n                + ite.getTargetException().getMessage(), \n                ite.getTargetException(), methodName );\n                miex.initCause(ite.getTargetException());\n                miex.setLine(first.beginLine);\n                miex.setColumn(first.beginColumn);\n                throw miex;\n            }\n        }\n        catch( Exception e )\n        {\n            rsvc.error(\"ASTMethod.execute() : exception invoking method '\" \n                               + methodName + \"' in \" + o.getClass() + \" : \"  + e );\n                               \n            return null;\n        }            \n    }\n}\n\n\n", "created_at" : { "$date" : "2005-10-28T04:15:18.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.065+0000" }, "creator_id" : { "$oid" : "5b7d357be9214a0d1608d6aa" }, "reporter_id" : { "$oid" : "5b7d357be9214a0d1608d6aa" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2d5f627d84c8d6ae66" }, "external_id" : "VELOCITY-423", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Report invalid references", "desc" : "I've made a new patch that includes a ReferenceInsertionEventHandler (\"InvalidReferenceHandler\") that collects a list of all invalid references in a Velocity page.\n\nTo see how it works, look at the test code (the last two methods) in BuiltInEventHandlerTestCase.\n\nTo make this work, I had to make some changes to the internals.  So I thought I'd hold off a couple days before committing, let any interested parties comment. \n\nThere's a couple of interesting new pieces for plugin writers.\n\n(1) In any user-defined plugin (event handlers, uberspectors, etc) you can now throw a subclass of VelocityRuntimeException (new exception).  to signal unrecoverable states to the calling application.  This runtime exception requires no change to the interface signature and is passed through the Velocity parsing process.  (In the past, all Exceptions were caught and logged).\n\nExample use: a custom uberspector or event handler that wishes to stop page processing.  For example, the InvalidReferenceHandler can be configured to throw an exception at the first reference error.\n\n(2) Event handlers can now receive information on the template name, line number, and column by implementing InfoAware.  This only works for Local event handlers attached to a context (as opposed to the new Global type defined in Velocity properties).  \n\nExample use: InvalidReferenceHandler reports out the line,column, and template name of each reference error.\n\nEverything is completely backwards compatible.  It'd be simpler if it wasn't of course as they we could just redo the interfaces.", "created_at" : { "$date" : "2005-11-19T08:31:28.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.399+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2d5f627d84c8d6ae77" }, "external_id" : "VELOCITY-426", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "move of Node object broke compatibility with custom directives", "desc" : "\nFrom Malcolm Edgar:\n\nHi Will & company,\n\nRegarding the cause of the problem.\n\nThis is the code from Cayenne class ResultDirective (Cayenne 1.2 M6):\n\nimport org.apache.velocity.runtime.parser.node.Node;\n\n    protected Object getChild(InternalContextAdapter context, Node node, int\ni)\n        throws MethodInvocationException {\n        return (i >= 0 && i < node.jjtGetNumChildren())\n            ? node.jjtGetChild(i).value(context)\n            : null;\n    }\n\nWhen running with Velocity 1.5-dev this throwing the exception:\n\nCaused by: java.lang.NoSuchMethodError:\norg.apache.velocity.runtime.parser.node.Node.jjtGetChild\n(I)Lorg/apache/velocity/runtime/parser/node/Node;\n    at org.objectstyle.cayenne.access.jdbc.ResultDirective.getChild(\nResultDirective.java:190)\n\nAs the Node.jttGetChild(i) returns:\n\norg.apache.velocity.runtime.parser.Node\n\nrather than:\n\norg.apache.velocity.runtime.parser.node.Node\n\nThis issue, plus another Velocity/Cayenne issue of a disappearing object\nreference in the velocity Context, is causing a lot of grief.  We have been\nburning a lot of time over the last couple of weeks trying identify the\nlatter issue, plus having to rollback Velocity changes maintain Cayenne\ncompatability.\n", "created_at" : { "$date" : "2005-12-12T00:58:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.682+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2e5f627d84c8d6ae84" }, "external_id" : "VELOCITY-430", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow commas or spaces to separate macro arguments", "desc" : "If there is a macro \"displayNotes\", it'd be nice to allow\n\n#displayNotes(\"note1\"  \"note2\")   OR\n#displayNotes(\"note1\" ,\"note2\")   \n\nAllowing macros to support comma separated arguments like almost every programming language in existence.  This never made sense to me.\n\nAnyone object to adding this?\n", "created_at" : { "$date" : "2006-01-17T17:40:21.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.993+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2f5f627d84c8d6ae90" }, "external_id" : "VELOCITY-429", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Pass through runtime exceptions", "desc" : "Thought it might be useful to archive the brief discussion on this topic since it's a cross-cutting type of issue.  I'm going to link to this issue in the change log.\n\n----- Original Message ----- \nFrom: \"Will Glass-Husain\" <wglass@forio.com>\nTo: <velocity-dev@jakarta.apache.org>\nSent: Monday, January 02, 2006 7:03 AM\nSubject: RuntimeExceptions\n\nFirst, happy new year to the Velocity developer community...\n\nI've been pondering how Velocity handles exceptions. Right now, almost every call to a plugin has a catch-all Exception handler which does little more than log the Exception.  There's been a couple of requests in the past few months to pass RuntimeExceptions or similar through.  \n\n* In Velocity-424, Malcolm Edgar wanted NPEs from a call to toString to pass through a #parse.  (we did this).\n* Llewelyn Falco created a \"TestableUberspect\" which interrupted processing upon an invalid method call.\n* There was someone else (can't find the reference) who wanted to interrupt processing when confronted with an invalid method call.\n\nI was wondering, why does Velocity intercept every exception?  Isn't the point of a RuntimeException that it signals an application-level problem that should be returned to the calling code?  In addition, we should allow plugins (event handlers, uberspectors, resource loaders) to interrupt processing for critical problems.  To me, there seems three choices.\n\n(1) Catch every unexpected condition and do something with it (e.g. catch NPE from toString() and wrap it in a MethodInvocationException).  Logging does not count as doing something.\n\n(2) Create a special VelocityRuntimeException that plugins can use to interrupt processing.  Every generic catch (Exception E) wrapper would pass this through.  (I've coded this though not applied the patch).\n\n(3) Remove all generic Exception catch's.  (or if not feasible, always pass RuntimeException's through).\n\nTo me, option #1 seems infeasible.  (if we start wrapping toString, we'd need to wrap a lot of other little stuff).  Option #2 is useful for plugins to interrupt processing.  But I'm wondering, why not do option #3 and just pass through all RuntimeExceptions.  Any reason why we *should* be catching unexpected RuntimeException's?\n\nAppreciate other thoughts...\n\nBest,\nWILL", "created_at" : { "$date" : "2006-01-04T13:52:37.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:26.866+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d2f5f627d84c8d6ae9a" }, "external_id" : "VELOCITY-435", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ParseErrorException not thrown with #macro parse error", "desc" : "I have just been reviewing the new error handlingin Velocity 1.5-dev.\nOne change I have observed it that an invalid macro call, passing 2\narguments instead of one will log an error message:\n\n[Velocity] [error] VM #writeForm: error : too many arguments to macro.\nWanted 1 got 2\n[Velocity] [error] VM error writeForm. Null AST\n\nHowever it will not throw an ParseErrorException like it used to in\n1.5-dev. Please see the example below for the earlier behaviour:\n\nhttp://www.sunvolt.com/click-examples/exception.htm?actionLink=brokenBorderLink#\n\nI prefer earlier approach, as the error is explicit. The new approach\nlogs an error message, but beyond that you would not have known that\nan error occured. The #writeForm() call is not even rendered, as is\ndone with an invalid object reference.\n\nregards Malcolm Edgar", "created_at" : { "$date" : "2006-03-05T07:31:24.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:27.897+0000" }, "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Windows XP, JDK 1.4.2_09" },
{ "_id" : { "$oid" : "5b904d305f627d84c8d6aeae" }, "external_id" : "VELOCITY-432", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#stop produces unexpected results when used with #parse", "desc" : "On 20th of January (2006) I took the latest trunk from SVN, and tried it against some Velocity templates I am just working on. I came across two bugs, which I am reporting here, along with patches:\n\n1. When #stop is issued from within #parse, the processing of subsequent #parse directives does not stop. Since expressions are no longer being rendered after a #stop, the parameter to #parse can be an empty string, resulting in an unexpected exception that confuses the user. I am attaching an example that reproduces this (stop3.vm, stop3-include.vm), with a patch \n(-1.patch).\n\n2. I came across a string-out-of-bounds exception which happened because string length was not being checked. Patch is attached.", "created_at" : { "$date" : "2006-02-07T23:40:57.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:27.437+0000" }, "creator_id" : { "$oid" : "5b7d3583e9214a0d1608d6ab" }, "reporter_id" : { "$oid" : "5b7d3583e9214a0d1608d6ab" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d315f627d84c8d6aec0" }, "external_id" : "VELOCITY-458", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "InternalContextBase defines non-serializable non-transient fields", "desc" : "According to Findbugs, org.apache.velocity.context.InternalContextBase defines currentResource and eventCartridge as non-serializable, non-transient  in a serializable class.\n\nPossible solutions:\n\na) make Resource and EventCartridge serializable (might drag a large number of classes along)\n\nb) remove Serializable from InternalContextBase (does the Context get serialized somewhere? Is it needed for e.g. Web Applications?)\n\nc) make the fields transient, losing their contents after serialization / de-serialization.\n\n", "created_at" : { "$date" : "2006-09-16T08:52:58.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:28.908+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d325f627d84c8d6aeca" }, "external_id" : "VELOCITY-453", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] Fix IntrospectionCacheData caching", "desc" : "The old code used Class[].hashCode() in MethodCacheKey.hashCode() implementation.\nhashCode() is not overriden for arrays so it returns different value for each array instance.\n\nThe attached is the correct implementation and a test case to prove the caching actually works.", "created_at" : { "$date" : "2006-08-31T05:53:02.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:28.545+0000" }, "creator_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "reporter_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d325f627d84c8d6aeeb" }, "external_id" : "VELOCITY-456", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Uberspector chokes on a number of corner cases", "desc" : "The uberspector can be tricked into strange errors like java.lang.StringIndexOutOfBoundsException by passing some \"unusual\" property names like \"\" or null. It should catch these problems and behave reasonable.", "created_at" : { "$date" : "2006-09-06T14:08:37.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:28.729+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d335f627d84c8d6aef5" }, "external_id" : "VELOCITY-475", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Javadocs for SecureUberspector are not correct.", "desc" : "  [javadoc] /home/scratch/velocity/engine/bin/src/org/apache/velocity/util/introspection/SecureIntrospectorControl.java:39: warning - @param argument \"o\" is not a parameter name.\n\nhas been introduced by the latest patch to include the SecureUberspector.", "created_at" : { "$date" : "2006-11-01T11:15:41.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:29.938+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d335f627d84c8d6aefe" }, "external_id" : "VELOCITY-469", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Spaces in velocimacro.library hard to troubleshoot", "desc" : "With the following velocity.properties file (note the spaces after 'TypeConversions.vm'):\n-----\nresource.loader = classpath\n\n# this configuration allows you to supply template files somewhere on the classpath\nclasspath.resource.loader.description = Velocity Classpath Resource Loader\nclasspath.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n\nvelocimacro.library=TypeConversions.vm  \n---------\n\nOne gets the following log entries:\n----\nFri Oct 27 10:42:39 CEST 2006   [info] Velocimacro : adding VMs from VM library template : TypeConversions.vm  \nFri Oct 27 10:42:39 CEST 2006  [error] ResourceManager : unable to find resource 'TypeConversions.vm  ' in any resource loader.\nFri Oct 27 10:42:39 CEST 2006   [info] Velocimacro : error using  VM library template TypeConversions.vm   : org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource 'TypeConversions.vm  '\n----\n\nIt took me a few hours to notice that there were spaces after the '.vm' - it would maybe be better to add a trim() to VelocimacroFactory.initVelocimacro(), about line 164:\n\n----\n                     if (lib != null && !lib.equals(\"\"))\n                     {\n                         /*\n                          *  let the VMManager know that the following is coming\n                          *  from libraries - need to know for auto-load\n                          */\n\nlib = lib.trim(); // NEW \n\n                         vmManager.setRegisterFromLib( true );\n\n                         logVMMessageInfo(\"Velocimacro : adding VMs from \" +\n                             \"VM library template : \" + lib  );\n\n---\n", "created_at" : { "$date" : "2006-10-27T11:00:16.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:29.763+0000" }, "creator_id" : { "$oid" : "5b7d358ae9214a0d1608d6ad" }, "reporter_id" : { "$oid" : "5b7d358ae9214a0d1608d6ad" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "N/A" },
{ "_id" : { "$oid" : "5b904d345f627d84c8d6af08" }, "external_id" : "VELOCITY-459", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "localscope doesn't allow get to leak", "desc" : "In short, we wanted \"localscope\" on for macros due to some recursion. However, this meant that both puts /and/ gets only use the localscope.\n\nFor gets this seems overly restrictive--if I set \"foo=bar\" in my base VelocityContext, and then get into my macro, it should be able to reach that \"foo\" even if it can't overwrite it.\n\nThe attached patch relaxes the \"VMContext.get\" to let it check first the local scope and then the inner scope. Included is a test that makes sure an \"outsideVar\" is accessible from VMContext even if localscope is on.", "created_at" : { "$date" : "2006-09-21T06:06:17.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:29.189+0000" }, "creator_id" : { "$oid" : "5b7d358be9214a0d1608d6ae" }, "reporter_id" : { "$oid" : "5b7d358be9214a0d1608d6ae" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d355f627d84c8d6af18" }, "external_id" : "VELOCITY-462", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Change headers in source files to comply with new license header policy", "desc" : "The text at the top of every source file must be changed according to new ASF rules adopted this Spring.  The changes are intended to improve cliarity and make the files easier to maintain.\n\nAccording to the new policy, this must be implemented for any release after November 1, 2006.  Archived old releases do not need to be changed.  There's some scripts available to help out.\n\nMore info at:\n\nhttp://www.apache.org/legal/src-headers.html", "created_at" : { "$date" : "2006-10-11T14:19:04.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:29.500+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d355f627d84c8d6af26" }, "external_id" : "VELOCITY-503", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Method arguments are evaluated twice", "desc" : "Method arguments are evaluated twice in ASTMethod - no apparent reason.", "created_at" : { "$date" : "2006-11-28T12:56:27.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:30.479+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b904d365f627d84c8d6af42" }, "external_id" : "VELOCITY-501", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Building Velocity on JDK 1.3.1 throws java.lang.ClassCircularityError", "desc" : "VelTTools66TestCase throws a ClassCircularityError when building Velocity 1.5 beta 2 on JDK 1.3.1\n\nTestcase: testVelTools66 took 0.202 sec\n        Caused an ERROR\norg/apache/velocity/test/issues/VelTools66TestCase$TestObject\njava.lang.ClassCircularityError: org/apache/velocity/test/issues/VelTools66TestCase$TestObject\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:115)\n        at org.apache.velocity.test.issues.VelTools66TestCase$TestSecurityManager.class$(VelTools66TestCase.java:89)\n        at org.apache.velocity.test.issues.VelTools66TestCase$TestSecurityManager.checkMemberAccess(VelTools66TestCase.java:120)\n        at java.lang.Class.checkMemberAccess(Class.java:1332)\n        at java.lang.Class.newInstance(Class.java:230)\n        at sun.io.Converters.newConverter(Converters.java:115)\n        at sun.io.Converters.newDefaultConverter(Converters.java:206)\n        at sun.io.CharToByteConverter.getDefault(CharToByteConverter.java:50)\n        at java.lang.String.getBytes(String.java:751)\n        at java.io.UnixFileSystem.getBooleanAttributes0(Native Method)\n        at java.io.UnixFileSystem.getBooleanAttributes(UnixFileSystem.java:114)\n        at java.io.File.exists(File.java:543)\n        at sun.misc.URLClassPath$FileLoader.getResource(URLClassPath.java:780)\n        at sun.misc.URLClassPath.getResource(URLClassPath.java:133)\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:187)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:183)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:294)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:288)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:250)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:310)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:115)\n        at org.apache.velocity.test.issues.VelTools66TestCase$TestSecurityManager.class$(VelTools66TestCase.java:89)\n        at org.apache.velocity.test.issues.VelTools66TestCase$TestSecurityManager.checkMemberAccess(VelTools66TestCase.java:120)\n        at java.lang.Class.checkMemberAccess(Class.java:1332)\n        at java.lang.Class.getMethod(Class.java:882)\n", "created_at" : { "$date" : "2006-11-25T09:59:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:30.280+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d375f627d84c8d6af54" }, "external_id" : "VELOCITY-493", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RuntimeInstance.getProperty() should check overridingProperties  when not yet initialized", "desc" : "For consistency, RuntimeInstance.getProperty() should return the values previously set with setProperty() event when it hasn't already been initialized.\n\nruntimeInstance.setProperty(\"foo\",\"bar\");\nSystem.out.println(runtimeInstance.getProperty(\"foo\")); // output \"null\"\nruntimeInstance.init();\nSystem.out.println(runtimeInstance.getProperty(\"foo\")); // output \"bar\"\n\n", "created_at" : { "$date" : "2006-11-11T16:37:44.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:30.139+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b904d375f627d84c8d6af6a" }, "external_id" : "VELOCITY-516", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "SecureUberspector doesn't work with #foreach (iterators)", "desc" : "When using a #foreach iterating over strings I get: \"Cannot retrieve iterator from object of class [Ljava.lang.String; due to security restrictions.\"\n\nThe reason is that in the SecureUberspector class there's a call to checkObjectExecutePermission() with the second parameter being null. And in checkObjectExecutePermission() there's:\n\n{code}\n        if (methodName == null)\n        {\n            return false;\n        }\n{code}\n\n", "created_at" : { "$date" : "2007-02-15T09:54:02.749+0000" }, "updated_at" : { "$date" : "2007-03-08T00:04:31.188+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d385f627d84c8d6af7d" }, "external_id" : "VELOCITY-2", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VMProxy needs to return String rather than StringWriter when reference arg is null", "desc" : "Found this while reviewing the remarks of Nathan Bubna, so figured this was a\ngood test of Bugzilla.", "created_at" : { "$date" : "2001-03-21T23:07:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:17.739+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d671" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d671" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0b1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d671" }, "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d395f627d84c8d6af85" }, "external_id" : "VELOCITY-84", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Classloader problem limit LogSystem creation", "desc" : "When you run velocity using external-dir ClassLoader (by putting it in the -\nDjava.ext.dir property in the java command line), you cannot use a class for \nthe LogSystem that is in the regular classpath (a NoClassDefFoundError will be \nissued).\nThis will happen every time that the velocity package is on a ClassLoader that \nis higher in the hierarchy than the LogSystem class, due to the behaviour of \nthe ClassLoader.\nTo resolve this, the Velocity.init should have an overloading with a \nClassLoader as parameter, and it should be used in every Class.forName in the \ncode.", "created_at" : { "$date" : "2002-06-12T14:45:32.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:21.817+0000" }, "creator_id" : { "$oid" : "5b7d3595e9214a0d1608d6b0" }, "reporter_id" : { "$oid" : "5b7d3595e9214a0d1608d6b0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d395f627d84c8d6af91" }, "external_id" : "VELOCITY-104", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "hyphens in xsd element names produce uncompilable code", "desc" : "I'm not all that familiar (yet) with Velocity, so I apologize if this is not \nthe right forum to post this problem.  This may be a bug in Velocity or simple \nmy misunderstanding of how to use Velocity.\n\nI have been using Velocity successfully for some time now to produce parsers \nfor XSD's of my own, but now I have been handed an XSD that contains hyphens in \nthe element names and the code that is produced will not compile in Java \nbecause hyphens are illegal in class names and function names.\n\nIs this a bug in Velocity?  Should it automatically replace '-' with '_' when \nparsing elements and translating them when used in Velocity templates?  Can an \noption be added to Velocity that would allow for this?", "created_at" : { "$date" : "2002-09-17T05:00:08.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:22.612+0000" }, "creator_id" : { "$oid" : "5b7d3596e9214a0d1608d6b1" }, "reporter_id" : { "$oid" : "5b7d3596e9214a0d1608d6b1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d3a5f627d84c8d6af9c" }, "external_id" : "VELOCITY-114", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "New line wrongly added to output when using block comments", "desc" : "If you use block comments, a new line is incorrectly inserted in the output, \nbut if you use regular comments (##) no new line is inserted.\n\nFor example:\n#*\n*#\nHello\n\nWill produce:\n\nHello\n\nWhere:\n##\n##\nHello\n\nWill Produce:\nHello", "created_at" : { "$date" : "2002-11-12T06:40:26.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:23.765+0000" }, "creator_id" : { "$oid" : "5b7d3597e9214a0d1608d6b2" }, "reporter_id" : { "$oid" : "5b7d3597e9214a0d1608d6b2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d3b5f627d84c8d6afa7" }, "external_id" : "VELOCITY-138", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity-Tools: Loggers and Resource Loaders ignores in config file", "desc" : "The configuration file passed to VelocityViewServlet is ignoring custom Loggers\nand Resource Loaders.\n\nPart of the reason for this is the default logging and resource loading needed\nto have a ServletContext, and the current hack to make that work forced a\nspecific logger and resource loader.\n\nProposed fix:\n\n1) Put the ServletContext in the velocity application attributes\n2) Let the loggers and loaders rely on the fact that they can get to\nServletContext through the key VelocityViewServlet.SERVLET_CONTEXT\n3) Check the incoming configuration file, and take a reasonable default for the\nlogger and resource loader IF they are not explicitly set.\n\nWhile patching this bug, I have found the following additional issues:\n- The tools rely on 1.3-dev of velocity. When building against the current\nCVS of velocity (1.4), I get null pointer exceptions on the Velocity.init() when\ncalled from VelocityViewServlet. I will need to look into this further.\n- The new recommended init-param property is supposed to be named\norg.apache.velocity.properties, but with 1.3-dev it only works if you use the\nold name \"properties\".\n\nI have eliminated the need for the interface WebappLoaderAppContext, and have\nalso written a simple proof of concept example called config_sample (to be\nplaced in view/examples).\n\nI want to write/run some more tests, but this seems to work with the 1.3-dev.", "created_at" : { "$date" : "2003-02-13T17:56:11.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:24.833+0000" }, "creator_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "reporter_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d3b5f627d84c8d6afb4" }, "external_id" : "VELOCITY-140", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityServlet should use getResourceAsStream in loadConfiguration()", "desc" : "The current source (in both 1.3.1rc2 and nightly) for VelocityServlet uses\ndirect file access to get to the velocity properties in a web app. Most\ncontainers will allow this, but I have found at least one place where this\nbreaks things: Tomcat remote deployment.\n\nThe Tomcat system has a set of Ant tasks that allow you to deploy a webapp\nwithout manually copying the file into a webapps directory, when you deploy with\nthis method, the file technique in VelocityServlet will fail. The following\nbuild file excerpt (depends on catalina-ant.jar) shows the technique:\n\n   ... snip snip ...\n   <!-- These properties are used for dealing with Tomcat -->\n   <property name=\"war.file\"        value=\"config_sample\"/>\n   <property name=\"war.file.name\"   value=\"${war.file}.war\"/>\n   <property name=\"war.path\"  \nvalue=\"f:/opensrc/jakarta-velocity-tools/view/examples\"/>\n   <property name=\"manager.url\"      value=\"http://localhost:8080/manager\"/>\n   <property name=\"tomcat.username\" value=\"awkay\"/>\n   <property name=\"tomcat.password\" value=\"test\"/>\n   <property name=\"contextpath\" value=\"/simple\"/>\n\n   <taskdef name=\"deploy\"    classname=\"org.apache.catalina.ant.DeployTask\"/>\n   <taskdef name=\"undeploy\"  classname=\"org.apache.catalina.ant.UndeployTask\"/>\n\n   ... snip snip ...\n\n   <target name=\"redeploy\" depends=\"war, undeploy, deploy\"/>\n\n   <target name=\"undeploy\">\n      <undeploy url=\"${manager.url}\" username=\"${tomcat.username}\" \n                password=\"${tomcat.password}\" path=\"${contextpath}\"/>\n   </target>\n\n   <target name=\"deploy\" depends=\"war\">\n      <deploy url=\"${manager.url}\" username=\"${tomcat.username}\" \n              password=\"${tomcat.password}\" path=\"${contextpath}\"\n              war=\"file:///${war.path}/${war.file.name}\"/>\n   </target>\n\nDirect file access fails, because tomcat doesn't bother putting the files in the\nsame directory system (webapps) as manually deployed apps. I do not consider\nthis a tomcat bug, since there is no problem accessing the contents of the\nwebapp programmatically, as long as you use the getResource*() methods as\nrecommended in the Servlet Spec.\n\nI have a patch, and will attach it as soon as I get a CVS copy of 1.3.1rc2.", "created_at" : { "$date" : "2003-02-14T04:39:01.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:25.317+0000" }, "creator_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "reporter_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d3c5f627d84c8d6afbe" }, "external_id" : "VELOCITY-139", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityServlet should use getResourceAsStream in loadConfiguration()", "desc" : "The current source (in both 1.3.1rc2 and nightly) for VelocityServlet uses\ndirect file access to get to the velocity properties in a web app. Most\ncontainers will allow this, but I have found at least one place where this\nbreaks things: Tomcat remote deployment.\n\nThe Tomcat system has a set of Ant tasks that allow you to deploy a webapp\nwithout manually copying the file into a webapps directory, when you deploy with\nthis method, the file technique in VelocityServlet will fail. The following\nbuild file excerpt (depends on catalina-ant.jar) shows the technique:\n\n   ... snip snip ...\n   <!-- These properties are used for dealing with Tomcat -->\n   <property name=\"war.file\"        value=\"config_sample\"/>\n   <property name=\"war.file.name\"   value=\"${war.file}.war\"/>\n   <property name=\"war.path\"  \nvalue=\"f:/opensrc/jakarta-velocity-tools/view/examples\"/>\n   <property name=\"manager.url\"      value=\"http://localhost:8080/manager\"/>\n   <property name=\"tomcat.username\" value=\"awkay\"/>\n   <property name=\"tomcat.password\" value=\"test\"/>\n   <property name=\"contextpath\" value=\"/simple\"/>\n\n   <taskdef name=\"deploy\"    classname=\"org.apache.catalina.ant.DeployTask\"/>\n   <taskdef name=\"undeploy\"  classname=\"org.apache.catalina.ant.UndeployTask\"/>\n\n   ... snip snip ...\n\n   <target name=\"redeploy\" depends=\"war, undeploy, deploy\"/>\n\n   <target name=\"undeploy\">\n      <undeploy url=\"${manager.url}\" username=\"${tomcat.username}\" \n                password=\"${tomcat.password}\" path=\"${contextpath}\"/>\n   </target>\n\n   <target name=\"deploy\" depends=\"war\">\n      <deploy url=\"${manager.url}\" username=\"${tomcat.username}\" \n              password=\"${tomcat.password}\" path=\"${contextpath}\"\n              war=\"file:///${war.path}/${war.file.name}\"/>\n   </target>\n\nDirect file access fails, because tomcat doesn't bother putting the files in the\nsame directory system (webapps) as manually deployed apps. I do not consider\nthis a tomcat bug, since there is no problem accessing the contents of the\nwebapp programmatically, as long as you use the getResource*() methods as\nrecommended in the Servlet Spec.\n\nI have a patch, and will attach it as soon as I get a CVS copy of 1.3.1rc2.", "created_at" : { "$date" : "2003-02-14T04:38:47.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:25.210+0000" }, "creator_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "reporter_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3598e9214a0d1608d6b3" }, "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d3c5f627d84c8d6afc6" }, "external_id" : "VELOCITY-165", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "errors and stackTraces should go to System.err", "desc" : "Actually it is annoying, to get the \"transformed\" output mixed with\nerror messages.\n\nUnfortunately the log stuff is not used in a consequent manner:\nsome methodes make use of System.out to report errors and StackTraces.\nEven if this is necessary, System.err should be used to avoid mixing\nresults with more or less important error messages ...", "created_at" : { "$date" : "2003-04-18T07:42:09.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:25.812+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d3d5f627d84c8d6afd3" }, "external_id" : "VELOCITY-145", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityServlet::loadConfiguration() may not load from war file", "desc" : "VelocityServlet::loadConfiguration() may not load from a war file since it \ncalls getServletContext().getRealPath(), the behavior of which is undefined in \nthis case, and returns null from some containers (Tomcat).\n\nPatch is:\n\n--- VelocityServlet.java\t2003-02-26 13:50:17.000000000 -0800\n+++ VelocityServlet.java.fixed\t2003-02-26 13:48:34.000000000 -0800\n@@ -60,11 +60,14 @@\n import java.io.Writer;\n import java.io.BufferedWriter;\n import java.io.OutputStreamWriter;\n+import java.io.InputStream;\n import java.io.FileInputStream;\n import java.io.FileNotFoundException;\n import java.io.IOException;\n import java.io.UnsupportedEncodingException;\n \n+import java.net.URL;\n+\n import java.util.Properties;\n \n import javax.servlet.ServletConfig;\n@@ -341,13 +344,25 @@\n         if ( propsFile != null )\n         {\n             String realPath = getServletContext().getRealPath(propsFile);\n-        \n+\n+            InputStream propsIStream = null;\n             if ( realPath != null )\n             {\n                 propsFile = realPath;\n+            } else {\n+                // assume we're here because getRealPath() returned null\n+                // try loading from URL instead\n+                URL configURL = getServletContext().getResource(\"/\" + \npropsFile);\n+                if (configURL != null)\n+                    propsIStream = configURL.openStream();\n             }\n \n-            p.load( new FileInputStream(propsFile) );\n+            if (propsIStream == null)\n+            {\n+               propsIStream = new FileInputStream(propsFile);\n+            }\n+\t    \n+            p.load(propsIStream);\n         }\n \n         return p;", "created_at" : { "$date" : "2003-02-27T05:57:33.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:25.414+0000" }, "creator_id" : { "$oid" : "5b7d35a6e9214a0d1608d6b4" }, "reporter_id" : { "$oid" : "5b7d35a6e9214a0d1608d6b4" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d35a6e9214a0d1608d6b4" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d3e5f627d84c8d6afdb" }, "external_id" : "VELOCITY-253", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d3e5f627d84c8d6afdc" }, "external_id" : "VELOCITY-261", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "whitespace after an one-line inner #if statement are lost", "desc" : "#if ($condition3)\nb3 Line#if($condition4)extra#end \n#end\nb4 Line\n\nprints \"b3 Lineb4 Line\" rather than \"b3 Line \\nb4 Line\"", "created_at" : { "$date" : "2004-04-15T03:08:20.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:26.877+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d3e5f627d84c8d6afdb" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d3e5f627d84c8d6aff0" }, "external_id" : "VELOCITY-189", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide access to the underlying RuntimeInstance instance of Velocity/VelocityEngine class", "desc" : "It would be nice to be able to access the underlying VelocityEngine instance to\nwhich the Velocity facade class delegates. That way i can have logic that either\nuses a default application-wide velocity config or a specific one, i.e.\n\npublic class AppConfig {\n  public void init (...) {\n    // init app-wide velocity \n    Velocity.init (..);\n  }\n}\n\npublic class Foo {\n  private VelocityEngine m_engine;\n\n  public void init (String velConfigFile, ...) {\n    ..\n    if (velConfigFile != null) {\n      m_engine = new VelocityEngine ();\n      m_engine.init (velConfigFile);\n    } else {\n      m_engine = Velocity.getEngine ();\n    }\n  }\n\n  // other methods use m_engine\n}\n\nAs it is now, to do something like this you'd have to have everywhere you use\nvelocity the logic of\n\nif (haveOwnConfig) {\n  my_engine.merge (..);\n} else {\n  Velocity.merge (..);\n}", "created_at" : { "$date" : "2003-07-02T09:08:49.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:26.553+0000" }, "creator_id" : { "$oid" : "5b7d35a8e9214a0d1608d6b6" }, "reporter_id" : { "$oid" : "5b7d35a8e9214a0d1608d6b6" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d3f5f627d84c8d6b000" }, "external_id" : "VELOCITY-206", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The Velocity Plugins for eclipse throw an npe when trying to access a template.", "desc" : "The Velocity Plugins for eclipse throw an npe when trying to access a template.\n\nI am an IBM developer working on a eclipsed based project that uses velocity.\nI have eclipse installed with a my project plugins along with the velocity \nplugins.  When I startup up eclipse and my plugins are invoked, I get an NPE \nwhenever I try to access a template.  However if I start up eclipse, then use \nthe runtime workbench to startup another instance of eclipse then when i \ninvoke my plugins I do not get any errors.  My code is correct and I am \ninitlizing the velocity engine correctly as well as it pointing to my template \ncorrectly.  However velocity only seems to work when eclipse is started from \nwithin a runtie workbench.  Here is the exception I am getting:\n\njava.lang.NullPointerException\n        at java.lang.Throwable.<init>(Throwable.java)\n        at java.lang.Throwable.<init>(Throwable.java)\n        at java.lang.NullPointerException.<init>(NullPointerException.java:63)\n        at org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:814)\n        at org.apache.velocity.runtime.RuntimeInstance.getTemplate\n(RuntimeInstance.java:796)\n        at org.apache.velocity.runtime.RuntimeSingleton.getTemplate\n(RuntimeSingleton.java:337)\n        at org.apache.velocity.app.Velocity.getTemplate(Velocity.java:512)\n        at com.ibm.ws.rd.taghandlers.EJBSourceHandler.endResource\n(EJBSourceHandler.java:121)\n        at com.ibm.ws.rd.builders.AnnotationProcessor.visit\n(AnnotationProcessor.java:149)\n        at com.ibm.ws.rd.builders.AnnotationProcessor.visit\n(AnnotationProcessor.java:118)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java)\n        at org.eclipse.core.internal.events.ResourceDelta.accept\n(ResourceDelta.java:52)", "created_at" : { "$date" : "2003-09-12T01:01:18.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:26.760+0000" }, "creator_id" : { "$oid" : "5b7d35a9e9214a0d1608d6b7" }, "reporter_id" : { "$oid" : "5b7d35a9e9214a0d1608d6b7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d405f627d84c8d6b019" }, "external_id" : "VELOCITY-286", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "CORBA structs used for data transfer - need field introspection", "desc" : "I read the FAQ in the developer guide regarding field introspection, but still \nrequire it with good reason. \n\nBackground:\nOur company uses CORBA for middleware. The most portable and efficient method \nof data transfer from our application servers is by using CORBA structs \n(including nested structs).\n\nProblem:\nAttributes in CORBA structs map to Java public fields.\n\nVelocity\u0080\u0099s FieldMethodizer won\u0080\u0099t work because:\nThe mapped attributes are not static fields as is required by the \nFieldMethodizer.  Even if it allowed instance fields, we would still have a \nproblem because our structs are often nested.  The FieldMethodizer would \ntherefore need to handle the nesting recursively.\n\nWriting accessors wont work because:\nThe Java code for the CORBA structs are generated by vendor idl2java.  We would \ntherefore have to duplicate all these data transfer classes with similar ones \nthat have assessor methods AND write copy code to get the data from the struct \nobjects into our objects.  However, we have TONS of these data transfer \nstructs.  We will not be able to get approval from business to develop a whole \ndata layer (with assessor methods and copy code) JUST to cater for Velocity.  \nThe reason we want to use Velocity is to save time.\n\nFrom a purist point of view I can understand why you don\u0080\u0099t want to allow field \nintrospection i.e. \u0080\u009cWe don't do that because we wish to promote the idea that \nyou hide your raw data in your data objects\u0080\u009d.  However, the FACT is that Java \nclasses allow public fields i.e. Java allows one to expose the data in objects \u0080\u0093\n the reasons are irrelevant.  Therefore, from a completeness point of view, \nVelocity should allow field introspection.", "created_at" : { "$date" : "2004-07-30T01:15:56.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:27.781+0000" }, "creator_id" : { "$oid" : "5b7d35abe9214a0d1608d6b8" }, "reporter_id" : { "$oid" : "5b7d35abe9214a0d1608d6b8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d405f627d84c8d6b024" }, "external_id" : "VELOCITY-363", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "this expected result con't be rendered out", "desc" : "Result expected: <c:if test=\"${userForm.id != null}\">.\nAs you can see, it's a widely use JSTL core tag.\nThe precondition is: #set ($formName = \"user\")\nI tried 4 ways:\none:\n\t<c:if test=\"${${formName}.id != null}\">\ntwo:\n\t#set ($D = '$')\n\t<c:if test=\"$D{${formName}Form.id != null}\">\nthree: use the EscapeTool\n\t<c:if test=\"${escape.d}{${formName}Form.id != null}\">\nfour: !@#(^*%%(*^....\n\t#set ($D = '$')\n\t#set ($LEFT_B = '{')\n\t#set ($RIGHT_B = '}')\n\t<c:if test=\"$D{${formName}Form.id != null}\">\nBut all 3 ways failed, with the same error:\norg.apache.velocity.runtime.parser.ParseException: Encountered \" != null} , Was\nexpecting one of:\n    \"}\" ...\n    <DOT> ...\n    \ncurrently all I can do is NOT USE the JSTL, replaced it with the ugly java code:\n\n<%if (((User)request.getParameter(\"userForm\")).getId() != null) %> ...\n\nany suggest?\n\nThanks.\n\nstoneman.huang", "created_at" : { "$date" : "2005-02-28T16:05:10.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:29.826+0000" }, "creator_id" : { "$oid" : "5b7d35ace9214a0d1608d6b9" }, "reporter_id" : { "$oid" : "5b7d35ace9214a0d1608d6b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d415f627d84c8d6b039" }, "external_id" : "VELOCITY-318", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DVSL stylesheet encoding problem", "desc" : "DVSL reads stylesheet with default system encoding.\nDVSL producing garbled documents on another machine which has other system encoding.", "created_at" : { "$date" : "2004-11-16T00:23:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:29.334+0000" }, "creator_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "reporter_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d425f627d84c8d6b043" }, "external_id" : "VELOCITY-419", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error trying to sum two floating point numbers using a #set statement", "desc" : "Sorry by my english. It's truly bad.\n\nThe description is:\nWhen I try to generate a text summarizing two floating points in a #set statement (#set ($totalPercentualDoutorado = 10.4 + 22.2)) I receive an error like this:\n\norg.apache.velocity.exception.ParseErrorException: Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 173, column 38.  Encountered: \"2\" (50), after : \".\"\n\tat org.apache.velocity.Template.process(Template.java:141)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:423)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:341)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:831)\n\tat org.apache.velocity.runtime.RuntimeSingleton.getTemplate(RuntimeSingleton.java:303)\n\tat org.apache.velocity.app.Velocity.mergeTemplate(Velocity.java:439)\n\tat info.stela.textgenerator.TextGeneratorImpl.mergeTemplate(TextGeneratorImpl.java:36)\n\tat br.org.cgee.inovacao.qualisInteracao.model.SumaryModel.getSumary(SumaryModel.java:138)\n\tat br.org.cgee.inovacao.qualisInteracao.view.text.TextView.initialize(TextView.java:40)\n\tat br.org.cgee.inovacao.qualisInteracao.view.text.TextView.<init>(TextView.java:32)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat info.stela.gui.dynapi.SApplication.drvGetModule(SApplication.java:558)\n\tat info.stela.gui.dynapi.SMainStackContainer.drvShowModule(SMainStackContainer.java:165)\n\tat info.stela.gui.dynapi.SApplication.drvShowModule(SApplication.java:598)\n\tat info.stela.gui.TApplication.showModule(TApplication.java:99)\n\tat info.stela.gui.TMainStackContainer.showModule(TMainStackContainer.java:65)\n\tat br.org.cgee.inovacao.qualisInteracao.Application.<init>(Application.java:54)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat info.stela.gui.dynapi.SApplication.createMainContainer(SApplication.java:250)\n\tat info.stela.gui.dynapi.Controller.doGet(Controller.java:184)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:198)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:152)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n\tat org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:793)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:702)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:571)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:644)\n\tat java.lang.Thread.run(Thread.java:595)\ninfo.stela.textgenerator.TextGeneratorException: org.apache.velocity.exception.ParseErrorException: Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 173, column 38.  Encountered: \"2\" (50), after : \".\"\n\tat info.stela.textgenerator.TextGeneratorImpl.mergeTemplate(TextGeneratorImpl.java:40)\n\tat br.org.cgee.inovacao.qualisInteracao.model.SumaryModel.getSumary(SumaryModel.java:138)\n\tat br.org.cgee.inovacao.qualisInteracao.view.text.TextView.initialize(TextView.java:40)\n\tat br.org.cgee.inovacao.qualisInteracao.view.text.TextView.<init>(TextView.java:32)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat info.stela.gui.dynapi.SApplication.drvGetModule(SApplication.java:558)\n\tat info.stela.gui.dynapi.SMainStackContainer.drvShowModule(SMainStackContainer.java:165)\n\tat info.stela.gui.dynapi.SApplication.drvShowModule(SApplication.java:598)\n\tat info.stela.gui.TApplication.showModule(TApplication.java:99)\n\tat info.stela.gui.TMainStackContainer.showModule(TMainStackContainer.java:65)\n\tat br.org.cgee.inovacao.qualisInteracao.Application.<init>(Application.java:54)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat info.stela.gui.dynapi.SApplication.createMainContainer(SApplication.java:250)\n\tat info.stela.gui.dynapi.Controller.doGet(Controller.java:184)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:198)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:152)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n\tat org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:793)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:702)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:571)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:644)\n\tat java.lang.Thread.run(Thread.java:595)\nCaused by: org.apache.velocity.exception.ParseErrorException: Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 173, column 38.  Encountered: \"2\" (50), after : \".\"\n\tat org.apache.velocity.Template.process(Template.java:141)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:423)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:341)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:831)\n\tat org.apache.velocity.runtime.RuntimeSingleton.getTemplate(RuntimeSingleton.java:303)\n\tat org.apache.velocity.app.Velocity.mergeTemplate(Velocity.java:439)\n\tat info.stela.textgenerator.TextGeneratorImpl.mergeTemplate(TextGeneratorImpl.java:36)\n\t... 45 more\n\nI don't know if it's an error or a new feature that need to be added. If it's impossible to sum two floating points a in template using velocitys language then I suppouse its an error but if there is a way to do this I think in the next release velocity should be able to execute this statement.", "created_at" : { "$date" : "2005-11-17T02:43:37.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:30.851+0000" }, "creator_id" : { "$oid" : "5b7d35afe9214a0d1608d6bb" }, "reporter_id" : { "$oid" : "5b7d35afe9214a0d1608d6bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows XP with jdk 1.5" },
{ "_id" : { "$oid" : "5b904d425f627d84c8d6b04c" }, "external_id" : "VELOCITY-371", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Compatibility with log4j 1.3 alpha", "desc" : "The 1.3 alpha release of log4j changed the location and usage of the \nRollingFileAppender class. These changes are not currently backwards compatible \nand, as such, the SimpleLog4JLogSystem implementation must be changed \naccordingly.\n\nSteps to reproduce:\nWith log4j 1.3 alpha in the classpath, any code calling the init method of a \nVelocityEngine instance will fail with the following error:\n\njava.lang.NoSuchFieldError: DEBUG\n\tat org.apache.velocity.runtime.log.SimpleLog4JLogSystem.internalInit\n(SimpleLog4JLogSystem.java:112)\n\tat org.apache.velocity.runtime.log.SimpleLog4JLogSystem.init\n(SimpleLog4JLogSystem.java:82)\n\tat org.apache.velocity.runtime.log.LogManager.createLogSystem\n(LogManager.java:127)\n\tat org.apache.velocity.runtime.RuntimeInstance.initializeLogger\n(RuntimeInstance.java:553)\n\tat org.apache.velocity.runtime.RuntimeInstance.init\n(RuntimeInstance.java:226)\n\tat org.apache.velocity.runtime.RuntimeInstance.init\n(RuntimeInstance.java:461)\n\tat org.apache.velocity.app.VelocityEngine.init(VelocityEngine.java:106)\n\t\u0085.\n\nOther information:\nThis issue was raised and discussed on the developer mail list at the following \nthread <a href=\"http://mail-archives.eu.apache.org/mod_mbox/jakarta-velocity-\ndev/200503.mbox/%3cB6AF899A8346D711813C0002B350F611204E7A40@garnet.main.gpo.gov%\n3e\">http://mail-archives.eu.apache.org/mod_mbox/jakarta-velocity-\ndev/200503.mbox/%3cB6AF899A8346D711813C0002B350F611204E7A40@garnet.main.gpo.gov%\n3e</a>. \n\nResolution:\nThe above thread references a posting made by one of the log4j developers who \nindicated that the development of compatibility libraries had been suggested \nfor incorporation. If these are added, then the problem goes away until those \nclasses have been sufficiently deprecated and removed.\n\nThe alternate solution is modification of the code base to reflect the changes. \nThis, however, will cause incompatibility problems with previous versions of \nthe log4j library. The following represents the code changes required for \ncompatibility. The changes below also replace the deprecated Category class \nusage with Logger as indicated in the message from the aforementioned log4j \ndeveloper.\n\ndiff \u0096w SimpleLog4JLogSystem.old SimpleLog4JLogSystem.java\n\n21,22c21,22\n< import org.apache.log4j.Category;\n< import org.apache.log4j.RollingFileAppender;\n---\n> import org.apache.log4j.Logger;\n> import org.apache.log4j.rolling.RollingFileAppender;\n24c24,26\n< import org.apache.log4j.Priority;\n---\n> import org.apache.log4j.rolling.SizeBasedTriggeringPolicy;\n> import org.apache.log4j.rolling.FixedWindowRollingPolicy;\n> import org.apache.log4j.Level;\n44c46\n<     protected Category logger = null;\n---\n>     protected Logger logger = null;\n63c65\n<             logger = Category.getInstance( categoryname );\n---\n>             logger = Logger.getLogger( categoryname );\n105c107,108\n<         logger = Category.getInstance(this.getClass().getName());\n---\n>         logger = Logger.getLogger(this.getClass().getName());\n> \n112,114c115\n<         logger.setPriority(Priority.DEBUG);\n< \n<         RollingFileAppender appender = new RollingFileAppender( new \nPatternLayout( \"%d - %m%n\"), logfile, true);\n---\n>         logger.setLevel(Level.DEBUG);\n116c117,129\n<         appender.setMaxBackupIndex( 1 );\n---\n>         RollingFileAppender appender = new RollingFileAppender();\n>         appender.setFile(logfile);\n>         appender.setLayout(new PatternLayout( \"%d - %m%n\"));\n>         appender.setAppend(true);\n>         \n>         SizeBasedTriggeringPolicy triggerPolicy = new \nSizeBasedTriggeringPolicy();\n>         triggerPolicy.setMaxFileSize(100000);\n>         appender.setTriggeringPolicy(triggerPolicy);\n>         \n>         FixedWindowRollingPolicy rollingPolicy = new FixedWindowRollingPolicy\n();\n>         rollingPolicy.setActiveFileName(logfile);\n>         rollingPolicy.setMaxIndex(1);\n>         appender.setRollingPolicy(rollingPolicy);\n118c131\n<         appender.setMaximumFileSize( 100000 );\n---\n>         appender.activateOptions();", "created_at" : { "$date" : "2005-03-31T06:53:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:30.153+0000" }, "creator_id" : { "$oid" : "5b7d35b0e9214a0d1608d6bc" }, "reporter_id" : { "$oid" : "5b7d35b0e9214a0d1608d6bc" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d35b0e9214a0d1608d6bc" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d435f627d84c8d6b055" }, "external_id" : "VELOCITY-444", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow evaluation of Java expressions that does not return text or value!", "desc" : "I have started to use Velocity as a file preprocessor with my own macros in separate files.   I quickly realized that there are some features missing in Velocity.  \n\nI want to create Velocity macros with optional parameters, which is essential for my application.   When a user calls my macros, she/he should not be obliged to pass all the necessary parameters to my macro.   The macro should be callable with no parameter or with partial or full set of parameters.   All parameters will have default values.\n\nI think the best way to do this is to have a Map (like a java.util.Map as in HashMap).   As far as I know, Velocity does not support a Map objects directly.   Such object as a Map has to be created in Java and used from the Velocity macro language.   Therein lies the problem.\n\nVelocity does not have a reserved word for evaluating a Java expression without returning a value or text.   In the documentation, using #set( $result = $myObj.method() ), method() can have side effects but it must return a value.   I want to be able to call methods that return nothing (void).   I have tried many things to try circumventing this but nothing works.  Velocity always outputs the text of the expression without evaluating it.\n\nThe solution would be to have a reserve construct similar like #set(....) but it would be called #eval(....).  Such expression #eval(....) would take a Java expression and would evaluate it without generating any text.   The #eval(....) would be used to set the value of my Map.\n\n    // Utility Java class that creates and keeps HashMap(s)\n    public static class Utility {\n        public static final byte MAP_COUNT = 16;\n        private final Stack<Map<String,String>> maps = \nnew Stack<Map<String,String>>();\n\n        public Utility() { this(MAP_COUNT); }\n        public Utility(int count) { \n            for(int i=0;i<count;i++) {\n                maps.push(new HashMap<String,String>());\n            }\n        }\n        public Map<String,String> createMap() { return maps.pop(); }\n        public void discardMap(Map<String,String> map) { map.clear(); maps.push(map); }\n    }\n    protected final Utility util = new Utility(); \n\n    engine.setProperty(\"util\", util);\t// ...later passed as property of VelocityEngine\n##=======================\n## Macro to create a Map and use it inside the macro\n##=======================\n#set( $myMap = $util.createMap() )\n$myMap.size()\n\n#$myMap.put(\"first\", \"alpha\")\n#$myMap.put(\"second\", \"beta\")\n#$myMap.put(\"third\", \"kapa\")\n#$myMap.put(\"fourth\", \"gamma\")\n#foreach( $myKey in [ \"first\", \"second\", \"third\", \"fourth\" ] )\n$myKey    ${myMap.get($myKey)}\n#end\n\n##=======================\n## Output text file ...DOES NOT WORK AS PLANNED!!\n##=======================\n$myMap.size()\n\n#$myMap.put(\"first\", \"alpha\")\n#$myMap.put(\"second\", \"beta\")\n#$myMap.put(\"third\", \"kapa\")\n#$myMap.put(\"fourth\", \"gamma\")\nfirst    ${myMap.get($myKey)}\nsecond    ${myMap.get($myKey)}\nthird    ${myMap.get($myKey)}\nfourth    ${myMap.get($myKey)}\n\n", "created_at" : { "$date" : "2006-06-16T00:37:03.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:30.984+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "WindowsXP" },
{ "_id" : { "$oid" : "5b904d435f627d84c8d6b061" }, "external_id" : "VELOCITY-497", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Porting Velocity application from Jboss3.2.3 to Jboss 4.0.5", "desc" : "We have our application running fine on Jboss 3.2.3.\nNow we are trying to port the same application to to Jboss 4.0.5.\n\nWe are using Velocity and JMX, Servlets, Hibernate, JBoss.\n\nAll the static content like Velocity vm files, css, js, gifs file are\nnot stored directly in parallel to web-inf.\nWe have stored them into some local docbase say C:\\content folder\n\nThe above startgy works find with JBoss 3.2.3. and Velocity picks all the references to images and js files from local docbase.\n\nWe are pointing to docbase through some configuration file with the help of Velocity.\nlike in velocity.properties.\nresource.loader = file\nfile.resource.loader.description = Velocity File Resource Loader\nfile.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader\n\nAnd setting the docbase :-\n\nOurVelocityServlet :\nprivate VelocityEngine velocity;\nvelocity = new VelocityEngine();\nExtendedProperties p = new ExtendedProperties();\n    p.addProperty(VelocityEngine.RESOURCE_LOADER, \"file\");\n    p.addProperty(\"file.resource.loader.class\",      FileResourceLoader.class.getName());\n     p.setProperty(VelocityEngine.FILE_RESOURCE_LOADER_PATH, System.getProperty(_docBaseProp));\n     velocity.setExtendedProperties(p);\n\n\n\nAll vm and html files are being picked up from that docbase but not picking images,css and js files.\n\nDoes anyone have some idea?Do we need to do some extra configuration setting while moving from jboss 3.2.3 to jboss 4.0.5 with Velocity and Jboss combination.", "created_at" : { "$date" : "2006-11-16T11:56:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:31.552+0000" }, "creator_id" : { "$oid" : "5b7d35b2e9214a0d1608d6be" }, "reporter_id" : { "$oid" : "5b7d35b2e9214a0d1608d6be" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows 200xp Sp2\nVelocity 1.4\nJboss 4.0.5\n" },
{ "_id" : { "$oid" : "5b904d445f627d84c8d6b075" }, "external_id" : "VELOCITY-460", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "the IncludeRelativePath handler should treat paths beginning with a slash as absolute paths", "desc" : "The most widely spread convention about systems supporting relative paths is that paths that begin with '/' (or '\\') are absolute while others are relative. The IncludeRelativePath event handler should follow the same convention.\n\nThe corrective patch is attached.\n", "created_at" : { "$date" : "2006-09-24T10:10:05.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:31.427+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d455f627d84c8d6b088" }, "external_id" : "VELOCITY-445", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Integrate Jython or BeanShell or Perl with Velocity to have complete macro language!", "desc" : "I do some advanced macro preprocessing using Velocity.   I find that Velocity's macro language should be more powerful than what it is.    I miss the capabilities of a full featured language.  I wish that velocity macro language should be comparable with Perl or Jython or BeanShell.\n\nI strongly suggest that Velocity be reengineered to support a complete macro processing language like Perl or Jython or BeanShell (Jython or BeanShell are already 100% Java).   The old macro processing language would disappear, insteand we would enter a scripting language like Jython or BeanShell.\n\nThis is necessary in order that Velocity be used as a full-featured macro preprocessing utility.", "created_at" : { "$date" : "2006-06-16T01:15:48.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:09:31.225+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "WindowsXP" },
{ "_id" : { "$oid" : "5b904d455f627d84c8d6b092" }, "external_id" : "VELOCITY-415", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong link to the SVN repository on the site main page", "desc" : "Near the tail of the page http://jakarta.apache.org/velocity/ there is a link to online SVN repository http://svn.apache.org/repos/asf/jakarta/velocity/trunk/ that is 404.", "created_at" : { "$date" : "2005-11-02T21:06:40.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.685+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d465f627d84c8d6b09c" }, "external_id" : "VELOCITY-416", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VTL Reference include directive's explanation is wrong", "desc" : "VTL Reference include include directive's explanation is wrong.\nCurrent explanation is\n #include( arg[, arg2, ... argn] )\n\n    * arg - Refers to a valid file under TEMPLATE_ROOT.\n\nExamples:\n\n    * String: #include( \"disclaimer.txt\", \"opinion.txt\" )\n    * Variable: #include( $foo, $bar )\n\nbut #include directive does not allow comma-deliminated expression. So this should describe as follows,\n #include( arg[ arg2 ... argn] )\n\n    * arg - Refers to a valid file under TEMPLATE_ROOT.\n\nExamples:\n\n    * String: #include( \"disclaimer.txt\"  \"opinion.txt\" )\n    * Variable: #include( $foo $bar )", "created_at" : { "$date" : "2005-11-05T18:31:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.786+0000" }, "creator_id" : { "$oid" : "5b7d35b7e9214a0d1608d6bf" }, "reporter_id" : { "$oid" : "5b7d35b7e9214a0d1608d6bf" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d475f627d84c8d6b0a7" }, "external_id" : "VELOCITY-408", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Gump failure in test-clean target - can't find testcases.xml file", "desc" : "Gump is currently failing on the test-clean target - can't find the testcases.xml file\n\nhttp://vmgump.apache.org/gump/public/jakarta-velocity/jakarta-velocity/gump_work/build_jakarta-velocity_jakarta-velocity.html\n\nLooks like this recent change missed updating the test-clean target:\n\nhttp://svn.apache.org/viewcvs.cgi?rev=291407&view=rev", "created_at" : { "$date" : "2005-09-28T00:40:34.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.591+0000" }, "creator_id" : { "$oid" : "5b7d35b9e9214a0d1608d6c0" }, "reporter_id" : { "$oid" : "5b7d35b9e9214a0d1608d6c0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d105f627d84c8d6ac9b" }, "external_id" : "VELOCITY-405", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "components" : [ "Documentation" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d105f627d84c8d6ac9c" }, "effect" : "relates to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "desc" : "This is a reminder to add documentation for the new Event Handler features.", "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "title" : "Document new Event Handler features", "priority" : "Major", "status" : "Closed", "environment" : "", "updated_at" : { "$date" : "2007-03-08T00:12:32.498+0000" }, "issue_type" : "New Feature", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "created_at" : { "$date" : "2005-09-26T13:50:39.000+0000" } },
{ "_id" : { "$oid" : "5b904d485f627d84c8d6b0ba" }, "external_id" : "VELOCITY-402", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "First cut at a working and usable maven build for Velocity", "desc" : "This is a patch and a file to add an actually working maven build (which can also build the site) to velocity. \n\nThis is non-intrusive and does not touch the ant build at all. As the current maven build works 'somehow', this adds support\nfor JDK 1.3/1.4 building and also some starting hooks to get the unit tests in shape (to be able to move them out of the production jar).\n\nThe resulting jar from maven jar:jar is exactly one class smaller than the ant built jar: It omits the TestSimplePool class that is already in src/test\n\nThe velocity-maven patch should be applied to the core directory, the project.properties file must be added to the root.\n\nIt is also useful to add \"velocity.log*\" and \"*.ser\" to the svn:ignore property of the root directory.", "created_at" : { "$date" : "2005-09-20T01:58:13.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.400+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d495f627d84c8d6b0c8" }, "external_id" : "VELOCITY-401", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "remove all J2EE build tasks", "desc" : "I think we should remove all J2EE build tasks and make compilation of DataSourceResourceLoader included by default.\n\nThe reason the J2EE tasks exist is that javax.sql.DataSource was not present in JDK 1.3 and before.  Hence DataSourceResourceLoader could not be compiled unless j2ee.jar, jdbc2_0-stdext.jar in the classpath or JDK 1.4+ was used.\n\nAt this point, most users are on JDK 1.4+.  I suggest we just check for the presence of javax.sql.DataSource and include the DataSourceResourceLoader if it is present.  If not, leave it out and just display a warning message noting that it is missing.  (and suggesting users download the appropriate library).", "created_at" : { "$date" : "2005-09-19T15:00:11.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.303+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d4a5f627d84c8d6b0d4" }, "external_id" : "VELOCITY-400", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Move Contrib folder to Wiki", "desc" : "I'd like to move all contents of the contrib folder to the Wiki.  (IntelliJ, emacs templates etc).  No current committer is supporting them - let's take them out of svn.\n\n", "created_at" : { "$date" : "2005-09-19T06:39:03.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.214+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d4a5f627d84c8d6b0d3" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d4a5f627d84c8d6b0de" }, "external_id" : "VELOCITY-399", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "documentation update for bugzilla to JIRA migration", "desc" : "Need to update menus and other references in xdocs with JIRA info", "created_at" : { "$date" : "2005-09-13T15:18:07.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:32.112+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d4c5f627d84c8d6b0ef" }, "external_id" : "VELOCITY-498", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "old mailing lists are dead -- need to announce", "desc" : "The old mailing lists, velocity-user@jakarta.apache.org, is dead.  New users are confused.\n\nWe need a prominent announcement on our home page about the site change and mailing list change.  I'll work on this.", "created_at" : { "$date" : "2006-11-17T13:20:13.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.755+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d4c5f627d84c8d6b0fa" }, "external_id" : "VELOCITY-517", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "anchors do not appear in user guide", "desc" : "Note from Will: this is correct in the xdoc source and docs generated with \"ant docs\" -- maybe this is an issue with the Maven build of the site?\n\n---------- Forwarded message ----------\nFrom: Egorov Aleksey <aleeg@mail.ru>\nDate: Jan 31, 2007 8:24 AM\nSubject: anchors in doc\nTo: dev@velocity.apache.org\n\n\nHigh Developers!\n\nStrangely.. Relative anchors (\"About this Guide\", \"What is Velocity?\",\n\"What can Velocity do for me?\", etc...) in document\n(http://velocity.apache.org/engine/devel/user-guide.html) don't work at\nall in Firefox 2.0.0.1\n:-\\\nCould you please fix this annoying little bug.\nThanks\n\nWBR,\nEgorov Alex.\n\n\n\n---------- Forwarded message ----------\nFrom: Gonzalo Diethelm <gonzalo.diethelm@diethelm.org>\nDate: Jan 31, 2007 12:57 PM\nSubject: Re: anchors in doc\nTo: Velocity Developers List <dev@velocity.apache.org>\n\n\nI don't think this is limited to any specific browser / version. I\nviewed the source for that page, and the anchors appear only once in the\ndocument, in the index. Oops.\n\nRegards.\n\nOn Wed, 2007-01-31 at 19:24 +0300, Egorov Aleksey wrote:\n\n> High Developers!\n>\n> Strangely.. Relative anchors (\"About this Guide\", \"What is Velocity?\",\n> \"What can Velocity do for me?\", etc...) in document\n> (http://velocity.apache.org/engine/devel/user-guide.html) don't work at\n> all in Firefox 2.0.0.1\n> :-\\\n> Could you please fix this annoying little bug.\n> Thanks\n>\n> WBR,\n> Egorov Alex.\n>\n> ---------------------------------------------------------------------\n> To unsubscribe, e-mail: dev-unsubscribe@velocity.apache.org\n> For additional commands, e-mail: dev-help@velocity.apache.org\n>\n>\n\n", "created_at" : { "$date" : "2007-02-21T07:48:45.963+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.852+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d4d5f627d84c8d6b105" }, "external_id" : "VELOCITY-494", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fix up small documentation issues", "desc" : "Before we release 1.5, need to do a pass and make sure all the little documentation issues are done.\n--> changelist is up to date\n--> NOTICE, other legal documentation is correct\n--> README and other similar files have correct info.\n\nRemove anything that's clearly out of date.  (I did a pass on the \"How to Build Velocity\" page today).", "created_at" : { "$date" : "2006-11-13T23:41:38.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.657+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d4e5f627d84c8d6b10d" }, "external_id" : "VELOCITY-474", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Get a Solaris zone for Velocity", "desc" : "Get a Solaris zone for the Velocity TLP to set up nightlies / tests etc. ", "created_at" : { "$date" : "2006-10-29T20:57:45.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.556+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d4f5f627d84c8d6b118" }, "external_id" : "VELOCITY-473", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Create wrapper site for velocity TLP", "desc" : "Take the contents of http://svn.apache.org/viewvc/jakarta/velocity/site/ and revamp it into a wrapper site that can be used as main site for all Velocity TLP subprojects (engine, tools, DVSL at the moment)", "created_at" : { "$date" : "2006-10-29T20:55:46.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.453+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904d4f5f627d84c8d6b117" }, "effect" : "is blocked by", "type" : "Blocker" } ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d4f5f627d84c8d6b123" }, "external_id" : "VELOCITY-472", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Move Mailing lists to velocity.apache.org", "desc" : "Move Mailing lists to velocity.apache.org", "created_at" : { "$date" : "2006-10-29T20:53:33.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:12:33.357+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904d4f5f627d84c8d6b117" }, "effect" : "is blocked by", "type" : "Blocker" } ], "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" } },
{ "_id" : { "$oid" : "5b904d4f5f627d84c8d6b117" }, "external_id" : "VELOCITY-471", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "components" : [ "Website" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d4f5f627d84c8d6b118" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b904d4f5f627d84c8d6b123" }, "effect" : "blocks", "type" : "Blocker" } ], "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "desc" : "Trigger infrastructure@ to create velocity.apache.org", "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "parent_issue_id" : { "$oid" : "5b904cf85f627d84c8d6aa2f" }, "title" : "Create velocity.apache.org", "priority" : "Major", "status" : "Closed", "updated_at" : { "$date" : "2007-03-08T00:12:33.153+0000" }, "issue_type" : "Sub-task", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2006-10-29T20:52:58.000+0000" } },
{ "_id" : { "$oid" : "5b904d515f627d84c8d6b139" }, "external_id" : "VELOCITY-233", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Documentation and examples do not work and are misleading", "desc" : "In the documentation that comes with Velocity 1.3.1\n(developer-guide.html#Using%20Velocity%20In%20Servlets) there is an  Appendix 1\n: called \"Deploying the Example Servlet\" which has a number of flaws:\n1) Deployment is not simple and error messages in the Catalina log are useless\n2) There is no mention of web.xml so deployment will never work in Tomcat\n3) The velocity documentation has no side by side examples of the code in the\nHTML template file and the Java servlet code that loads it. These two pieces\ntalk to each other and are dependent on each other but the examples never make\nthat link.\n4) The Velocity documentation is almost completely devoid of examples of\ndatabase access which is surely from where the greatest need for dynamic HTML\npages comes.", "created_at" : { "$date" : "2003-11-27T01:39:38.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.986+0000" }, "creator_id" : { "$oid" : "5b7d35cfe9214a0d1608d6c1" }, "reporter_id" : { "$oid" : "5b7d35cfe9214a0d1608d6c1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d515f627d84c8d6b146" }, "external_id" : "VELOCITY-210", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#macro arguments space-separated, not comma-separated", "desc" : "http://jakarta.apache.org/velocity/vtl-reference-guide.html defines #macro \nas\n\n#macro( vmname $arg1[, $arg2, $arg3, ... $argn ] )\n\nbut the actual format appears to be\n\n#macro( vmname $arg1[ $arg2 $arg3 ... $argn ] )", "created_at" : { "$date" : "2003-10-02T21:25:03.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.582+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "assignee_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d525f627d84c8d6b14f" }, "external_id" : "VELOCITY-182", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Corrections to README.txt for example #2", "desc" : "While using the /velocity-1.3.1/examples/servlet_example2/README.txt file to \ninstall example #2, I noticed the following corrections needed: \n1) the templates JAR file is \"template.jar\" (singular) rather \nthan \"templates.jar\"; \n2) the velocity.properties file should be put into the velexample/ directory, \nrather than in velexample/WEB-INF/ with web.xml (in 2 places in doc)  \nThanks.", "created_at" : { "$date" : "2003-06-09T22:00:33.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.050+0000" }, "creator_id" : { "$oid" : "5b7d35d1e9214a0d1608d6c2" }, "reporter_id" : { "$oid" : "5b7d35d1e9214a0d1608d6c2" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d525f627d84c8d6b15b" }, "external_id" : "VELOCITY-224", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Mention in docs that VelocityServlet is deprecated", "desc" : "I posted a general rant on the dev list about the fact that Velocity-Tools is \nnot documented on the web set as the preferred way to build servlets.  \n\nAs a first step, I suggest deprecating VelocityServlet and including a \nreference to velocity-tools.  Here's a patch to the JavaDocs.", "created_at" : { "$date" : "2003-11-10T05:43:08.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.888+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d535f627d84c8d6b163" }, "external_id" : "VELOCITY-222", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[patch] add javacc task to build.xml", "desc" : "This patch adds a new task \"parser\" to build.xml.  This task runs jjtree and \njavacc on the source file Parser.jjt.  It's an independent task, nothing else \nis dependent on it.  (such as compile).  The purpose is to speed up \nintegrating changes to the parse syntax into the source tree.  (replacing the \nodd and non-platform independent \"build\" script at \nsrc/org/apache/velocity/runtime/parser).\n\nIncluding this patch as an optional task would make things more efficient for \nthose of us playing with the syntax, but keep compilation simple in general.\n\nYou could argue that this task should be integrated into the general build \nprocess (e.g. remove Parser.java, etc. out of the source tree), but I think \nthis wouldn't be wise.  The main reason is that it makes it too hard for \nnovice developers to compile Velocity.  (They'd have to learn javacc in \naddition to ant).  It'd be good to keep the barriers to entry for developers \nlow.  \n\nFinally, note that ant 1.5 is not compatible with javacc 3.x.  To use this \ntask with javacc3.1, you must upgrade to the 1.6 version of ant (currently \nonly available as a nightly build).  I've found it useful, but some may feel \nthis is enough of a reason to keep this patch out of CVS.  (I'd appreciate \ncomments).", "created_at" : { "$date" : "2003-11-03T12:35:31.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.779+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d545f627d84c8d6b175" }, "external_id" : "VELOCITY-187", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "TexenTask javadoc does not match source code for its inheritance from Ant Task", "desc" : "The javadoc that I downloaded with Velocity 1.3.1 (as well as that on the \nwebsite) appears to be inconsistent with the associated source code for the \norg.apache.velocity.texen.ant.TexenTask class.\n\nThe source code states that it inherits from the Ant Task class (and this is \nconsistent with the TexenTask.class file in velocity-dep-1.3.1.jar).  The \njavadoc, however, is comletely missing the \"extends Task\" statement!", "created_at" : { "$date" : "2003-06-28T02:55:50.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:46.220+0000" }, "creator_id" : { "$oid" : "5b7d35d5e9214a0d1608d6c3" }, "reporter_id" : { "$oid" : "5b7d35d5e9214a0d1608d6c3" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d545f627d84c8d6b17f" }, "external_id" : "VELOCITY-390", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "add MANIFEST.MF to build", "desc" : "From mailmur@yahoo.com:\n\nbuild.xml changes:\nmanifest.mf file: It is like windows\nsecondaryClick/Version tabsheet information where we\ncan see version info etc.\n\nSee my webpage zipfile, where you should find\nsrc/META-INF/MANIFEST.MF file. I believe diff did not\ninclude it (just realized).\n\nSo to summarize:\n* meaninfull src/META-INF/MANIFEST.MF file added (take\nfrom zip)\n* updated build.xml to include manifest file when\njarring a project\n\nGo ahead and test it in your working copy. Then open\nVelocity-xxx.jar file to Winzip or something and see\nmanifest.mf file. I really hope Velocity started to\nuse a meaninfull manifest.mf file.", "created_at" : { "$date" : "2005-07-07T02:30:31.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.857+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d555f627d84c8d6b192" }, "external_id" : "VELOCITY-393", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "site.vsl errors", "desc" : "~/workspace/velocity.core/build > ant docs\nBuildfile: build.xml\n\nenv:\n     [echo] java.home = /usr/apps/jdk1.5.0_04/jre\n     [echo] user.home = /home/elkner\n...\ndocs:\n     [echo] \n     [echo]        #######################################################\n     [echo]        #\n     [echo]        #  Now using Anakia to transform our XML documentation\n     [echo]        #  to HTML.\n     [echo]         \n     [echo]        #######################################################\n     [echo]       \n   [anakia] SLF4J built for org.slf4j.impl.Log4jLoggerFA\n   [anakia] Transforming into: /home/elkner/workspace/velocity.core/docs\n   [anakia] 23:25:45,665 [main] ERROR (VelocimacroProxy.java:224) - ./site.vsl\n[line 42, column 13]: #tr  too few arguments to macro. Wanted 1 got 0\n   [anakia] 23:25:45,672 [main] ERROR (VelocimacroProxy.java:224) - ./site.vsl\n[line 52, column 13]: #td  too few arguments to macro. Wanted 1 got 0\n   [anakia] 23:25:45,674 [main] ERROR (VelocimacroProxy.java:224) - ./site.vsl\n[line 54, column 13]: #th  too few arguments to macro. Wanted 1 got 0\n...", "created_at" : { "$date" : "2005-07-11T06:34:18.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.961+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d555f627d84c8d6b1a0" }, "external_id" : "VELOCITY-358", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add documetation for the #literal directive", "desc" : "#literal is currently not in the user guide.\n  http://jakarta.apache.org/velocity/user-guide.html#Directives\n\nWant documentation for it.", "created_at" : { "$date" : "2005-02-18T23:22:57.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.752+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d565f627d84c8d6b1b3" }, "external_id" : "VELOCITY-326", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "forumdemo web.xml", "desc" : "Please update the forumdemo's web.xml init param-name property to be current,\norg.apache.velocity.properties vs properties. This is a cause of much confusion\nand waste of precious time trying to figure out why the ant test says everything\nis OK, and read all documentation, articles, and Archive emails to no avail\nuntil days later accidentally stumbling on a tomcat archive email almost\ncompletely unrelated that mentioned a change to the property. Thanks.", "created_at" : { "$date" : "2004-12-04T01:05:00.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.647+0000" }, "creator_id" : { "$oid" : "5b7d35e0e9214a0d1608d6c6" }, "reporter_id" : { "$oid" : "5b7d35e0e9214a0d1608d6c6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d575f627d84c8d6b1bf" }, "external_id" : "VELOCITY-324", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Cannot compile Velocity with JDK 1.5 due to use of the newly-reserved word \"enum\"", "desc" : "Currently, Velocity doesn't compile with Java5 because it uses enum in the \nfollowing classes:\n  o.a.v.runtime.parser.Parser\n  o.a.v.texen.Generator\n  o.a.v.util.EnumerationIterator\n\nTo avoid future issues, I think the source should be changed.\n## Of course, you might have to do something with javacc for Parser...", "created_at" : { "$date" : "2004-11-28T09:48:43.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.537+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d575f627d84c8d6b1d1" }, "external_id" : "VELOCITY-259", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't see a reason why Velocity.mergeTemplate(String,Context,Writer) is deprecated", "desc" : "The encoding of template files is well-defined, so I see no reason to deprecate \nthe method from above.\nThere is a velocity property input.encoding which defines the encoding\nof templates\n\"Character encoding for input (templates). Using this, you can use alternative \nencoding for your templates, such as UTF-8.\"\n\nI feel that Velocity.mergeTemplate(String,Context,Writer) should simply use \nthat encoding.\nBy deprecating the method and referencing to mergeTemplate\n(String,String,Context,Writer) you force a developer to duplicate the property.\n\nSuggestion:\nIF you decide to keep it deprecated, please extend the javadoc of the long \nmergeTemplate method eg:\n\"\nThe default encoding that Velocity uses to read template files is defined in \nthe property input.encoding and defaults to ISO-8859-1.\nYou can get the encoding that is currently configured in the Velocity runtime \nusing\n\"RuntimeSingleton.getString\n(RuntimeConstants.INPUT_ENCODING,RuntimeConstants.ENCODING_DEFAULT)\"\nAnd you can paste that code for the second parameter of mergeTemplate.\n\"", "created_at" : { "$date" : "2004-04-14T17:28:02.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:47.093+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66b" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d585f627d84c8d6b1dc" }, "external_id" : "VELOCITY-410", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Revise changelog.xml", "desc" : "This is a reminder - we need to update the changelog before the 1.5-beta release.\n\nI'm a little frustrated with the format.  I've been thinking of doing something a bit more structured (like the Tomcat change docs).  The current version is hard to read at a glance.  Specific changes I'd like to see:\n\n* Fix release numbers (the headings appear to be one release off)\n* Clearly differentiate enhancements from bug fixes\n* Have a common format to note who provided patch\n", "created_at" : { "$date" : "2005-10-10T05:34:55.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.064+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d595f627d84c8d6b1e4" }, "external_id" : "VELOCITY-418", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "FileInputStreams are not being closed so webapps cannot be undeployed.", "desc" : "Deployed web app in application server. Unable to undeploy because directory cannot be deleted.\n\nExample error:\n\nUnable to delete: rm: App/App_war/org/apache/velocity/runtime/defaults/directive.properties: Permission denied\n\nInputStreams are not being closed.\n\nFrom RuntimeInstance.java\n\n    private void initializeDirectives() throws Exception\n    {\n        /*\n         * Initialize the runtime directive table.\n         * This will be used for creating parsers.\n         */\n        runtimeDirectives = new Hashtable();\n        \n        Properties directiveProperties = new Properties();\n        \n        /*\n         * Grab the properties file with the list of directives\n         * that we should initialize.\n         */\n\n        InputStream inputStream =\n            getClass().getResourceAsStream('/' + DEFAULT_RUNTIME_DIRECTIVES);\n    \n        if (inputStream == null)\n            throw new Exception(\"Error loading directive.properties! \" +\n                                \"Something is very wrong if these properties \" +\n                                \"aren't being located. Either your Velocity \" +\n                                \"distribution is incomplete or your Velocity \" +\n                                \"jar file is corrupted!\");\n        \n        directiveProperties.load(inputStream);\n\n\nOn top of this\n\nExtendedProperties.java does not close InputStreams which it opens.", "created_at" : { "$date" : "2005-11-11T07:58:23.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.384+0000" }, "creator_id" : { "$oid" : "5b7d35e3e9214a0d1608d6c7" }, "reporter_id" : { "$oid" : "5b7d35e3e9214a0d1608d6c7" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.4", "1.3-rc1", "1.3.1-rc2", "1.3", "1.3.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Deployed web app in application server. Unable to undeploy because directory cannot be deleted." },
{ "_id" : { "$oid" : "5b904d595f627d84c8d6b1ee" }, "external_id" : "VELOCITY-421", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Downloaded libraries are checked twice when started by 'ant jar jar-src'", "desc" : "<ant antfile=\"${velocity.build.dir}/download.xml\" target=\"build-download\" /> was executed two times - for jar and jar-src.\nI move it to separated target having unless condition.\n\nSo the following download is not executed and also downloadable libraries check can be disabled completety.", "created_at" : { "$date" : "2005-11-17T16:25:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.609+0000" }, "creator_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "reporter_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d5a5f627d84c8d6b1fa" }, "external_id" : "VELOCITY-420", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Library download failure when started by 'ant jar jar-src'", "desc" : "I usually compile it using \"ant jar jar-src\" and 'build-download' called during 'jar-src' fails since 'jarname' is already defined in 'jar' with \n<property name=\"jarname\" value=\"${final.name}\" /> \n- it tries to download something like velocity-1.5-dev-2.7.5.jar (the first download is antlr and jarname can not be redefined).", "created_at" : { "$date" : "2005-11-17T16:20:29.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.496+0000" }, "creator_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "reporter_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d5b5f627d84c8d6b209" }, "external_id" : "VELOCITY-438", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "toString is called twice on references", "desc" : "ASTReference.java has some null check logic that does, summarized:\n\nif (value == null || value.toString() == null) {\n   ...\n} else {\n  ... output value.toString();\n}\n\nNote value.toString() being called twice.\n\nFor strings and other primitives, this may not be a big deal, but I'm happily using Click, which puts full-fledged components into the velocity context that you render with \"$componentName\". Very slick. But now calling toString() multiple times isn't all that cool, both from perf and logic standpoints.\n\nI've got a patch if I can figure out how to upload it.", "created_at" : { "$date" : "2006-04-18T12:35:22.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.827+0000" }, "creator_id" : { "$oid" : "5b7d358be9214a0d1608d6ae" }, "reporter_id" : { "$oid" : "5b7d358be9214a0d1608d6ae" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d5c5f627d84c8d6b216" }, "external_id" : "VELOCITY-431", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "\"Its\" has an apostrophe where it shouldn't, throughout the documentation", "desc" : "I don't pretend this is a big deal, but I notice it and it interrupts my reading flow so I thought I'd point it out.  The possesive form of \"its\" - that is, when the word is used to mean, \"belonging to it,\" does not take an apostrophe.  The only time it is appropriate to include an apostrophe in the word \"its\" is when the word is a contraction of \"it is\".  I would be happier with the document if its usage of the word were correct.  Thank you.", "created_at" : { "$date" : "2006-02-07T06:12:40.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.711+0000" }, "creator_id" : { "$oid" : "5b7d35e7e9214a0d1608d6c8" }, "reporter_id" : { "$oid" : "5b7d35e7e9214a0d1608d6c8" }, "issue_type" : "Task", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "n/a" },
{ "_id" : { "$oid" : "5b904d5c5f627d84c8d6b220" }, "external_id" : "VELOCITY-449", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Uberspector behaves differently for get(String) and put(String, Object) methods", "desc" : "Consider an Object \n\npublic class Test {\n  private Object foo;\n\n  public Object get(String dummy) { return foo; }\n  public void put(String dummy, Object foo) { this.foo = foo };\n}\n\nPut this object into a Velocity Context as $test, add a HashMap as $map.\n\nUse the following template:\n\n$map.put(\"key\", \"val1\")\n$test.put(\"key\", \"val1\")\n\n$map.get(\"key\")   --> Returns val1\n$test.get(\"key\")  --> Returns val1\n\n$map.key --> Returns val1\n$test.key --> Returns val1\n\n#set ($map.key = \"val2\")\n#set ($test.key = \"val2\")\n\n$map.key --> Returns val2\n$test.key --> Returns val1   !!\n\nThe reason for this is, that the UberspectorImpl, in getPropertySet tests in line 247 whether the passed object is assignable to a Map. This test is no in the getPropertyGet\nand seems to have no reason because the following method lookup for \"put\" will succeed anyway.\n\nI'd suggest the removal of this test. \n\n", "created_at" : { "$date" : "2006-07-08T22:29:37.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:48.953+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d5d5f627d84c8d6b22f" }, "external_id" : "VELOCITY-502", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Skip jar verification unless \"force.jar.loading\" is true", "desc" : "When the www.iblibo.org/maven repository is down (as it seems right now, at least from here), or when you want to work form an unconnected place (yes, it still exists...), build fails because ant wants to check every jar timestamp.\n\nThe attached patch modifies this behaviour: if a jar file is already present, the repository is not hit at all (why would we have to check any timestamp anyway since version numbers are present inside filenames?!).\n\nThe new force.jar.loading property forces reloading of jar files.\n\n", "created_at" : { "$date" : "2006-11-28T12:36:29.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.691+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b904d5e5f627d84c8d6b24a" }, "external_id" : "VELOCITY-508", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "MacroForwardDefineTestCase fails when built/run under JDK 1.3.1", "desc" : "This test is supposed to write error messages to the log.  Works under JDK 1.5.  No messages are written to the log in JDK 1.3.1.", "created_at" : { "$date" : "2006-12-14T17:05:37.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.964+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d5e5f627d84c8d6b252" }, "external_id" : "VELOCITY-507", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ant package embeds local path info into TemplateTestBase.java", "desc" : "Our release of Velocity 1.5beta2 doesn't build on anyone's system but mine.  (more precisely, \"ant test\" fails)\n\nThat's because the released distribution, created with \"ant package\" contains my path info embedded into \nTemplateTestBase.java instead of the expected filter marker \"@build.test@\" and \"@test.dir@\".\n\nWe need to fix the ant script and release beta3 ASAP.\n\n", "created_at" : { "$date" : "2006-12-06T15:15:08.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.814+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d5f5f627d84c8d6b25b" }, "external_id" : "VELOCITY-495", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Gump is failing due to missing HSQLDB jars", "desc" : "Gump has been failing for a while due to missing HSQLDB jars.  I'd like to resolve this before releasing beta2.  (In case there are other hidden compatibility issues)\n\nIt looks like this file is relevant.\nhttps://svn.apache.org/repos/asf/gump/metadata/project/jakarta-velocity.xml\n\nAnyone know -- if we edit this file to include a reference to hsqldb - is this enough?", "created_at" : { "$date" : "2006-11-14T05:42:10.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.570+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d5f5f627d84c8d6b266" }, "external_id" : "VELOCITY-457", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "documentation mistake? order of Velocimacros in template", "desc" : "from mailing list.\n(need to confirm)\n\n---------- Forwarded message ----------\nFrom: sun davy <aweisw@hotmail.com>\nDate: Sep 11, 2006 3:51 AM\nSubject: i encounter some mistakes in User Guide.\nTo: velocity-user@jakarta.apache.org\n\n\nhi Velocity team:\n  I am an user of Velocity from China. Thanks for your perfect production.\nThrough your creative and hard work, we have such Convenience and Powerful\ntools in our toolbox.\n\n...\n\n3) Velocimacro Trivia\n   Currently, Velocimacros must be defined before they are first used in a\ntemplate. This means that your #macro() declarations should come before\nusing the Velocimacros.\n\n   i defined VM after they are first used in a template, it also work. i\ndon't know why.\n\n", "created_at" : { "$date" : "2006-09-12T23:02:59.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.208+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d605f627d84c8d6b26e" }, "external_id" : "VELOCITY-461", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Class loading issue", "desc" : "If Velocity.jar is loaded from the WL classpath then it cannot load resources from the war or ear. This applies to both template resources as well as to the loader of the resources loaders themselves e.g. custom ClasspathResourceLoader couldn't be loaded when velocity.jar was loaded from the WL app claspath and the custom class was loaded from the ear.\n\nIn my view all appearances of this.getClass().getClassLoader() should be replaced by Thred.currentThread.getContextClassLoader()\n\n\nThanks\n", "created_at" : { "$date" : "2006-09-27T13:55:47.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:49.437+0000" }, "creator_id" : { "$oid" : "5b7d35ebe9214a0d1608d6c9" }, "reporter_id" : { "$oid" : "5b7d35ebe9214a0d1608d6c9" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "any java env" },
{ "_id" : { "$oid" : "5b904d615f627d84c8d6b279" }, "external_id" : "VELOCITY-518", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Veloctiy poms should have a <licenses> section", "desc" : "\nA licenses section should be added to the velocity poms.   It should look something like:\n\n    <licenses>\n        <license>\n            <name>The Apache Software License, Version 2.0</name>\n            <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>\n            <distribution>repo</distribution>\n        </license>\n    </licenses>\n\nThe maven team is working on using that information in several plugins to help validate releases.  (Example: there could be an apache validate plugin that makes sure all the licenses of dependencies are OK for apache to release)\n\n", "created_at" : { "$date" : "2007-02-21T19:10:11.654+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:50.090+0000" }, "creator_id" : { "$oid" : "5b7d35ece9214a0d1608d6ca" }, "reporter_id" : { "$oid" : "5b7d35ece9214a0d1608d6ca" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1", "1.5 beta1", "1.1-rc2", "1.0-Release", "1.1-rc1", "1.0b3", "1.0b2", "1.2", "1.3.1", "1.1", "1.3", "1.4", "1.5 beta2", "1.3.1-rc2", "1.0b1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d615f627d84c8d6b284" }, "external_id" : "VELOCITY-523", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "http://velocity.apache.org/engine/releases/velocity-1.4/index.html is actually 3.1.1 documentation", "desc" : "The page http://velocity.apache.org/engine/releases/velocity-1.4/index.html is linked from the Engine 1.4 entry in the lh panel in http://velocity.apache.org/index.html (and elsewhere) - however, it relates to version 3.1.1 which was not a TLP, and used Bugzilla etc ...", "created_at" : { "$date" : "2007-03-04T12:37:23.931+0000" }, "updated_at" : { "$date" : "2007-03-08T00:14:50.398+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d625f627d84c8d6b28d" }, "external_id" : "VELOCITY-64", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "disgard whitespace between consecutive velocity calls", "desc" : "I've been using velocity for a few months now, and I like it quite a bit, but \nI've been bothered by one minor but not insignificant problem.\n\nOften, I need to use velocity calls inside templates to perform logic and set \nup data structures... For example, to define the menu structure of a website in \na template for use in another template to be parsed during the same merge() \ncall, in order to keep such things that are irrelevant to the java code outside \nof it so it can be modified without rebuilding.\n\nThe problem is that whitespace used outside the velocity calls (for readability \nand necessity) ends up in the output. In practice, the resulting html can \ncontain many kilobytes of irrelevant whitespace which the browsers will need to \ndownload. I would like to see a feature for omitting whitespace between \nconsecutive velocity calls, or something equivalent to accomplish this.\n\nThanks", "created_at" : { "$date" : "2002-04-11T06:30:42.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:47.817+0000" }, "creator_id" : { "$oid" : "5b7d35eee9214a0d1608d6cb" }, "reporter_id" : { "$oid" : "5b7d35eee9214a0d1608d6cb" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d3e5f627d84c8d6afdb" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d625f627d84c8d6b299" }, "external_id" : "VELOCITY-76", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "forumdemo-tomcat4 error on windows xp", "desc" : "Followed instructions on http://jakarta.apache.org/builds/jakarta-\nvelocity/demo/\n\n1) downloaded this\nhttp://jakarta.apache.org/builds/jakarta-velocity/demo/forumdemo-tomcat-\n4.0b2.tar.gz\n\n2) cd to I:\\Program Files\\forumdemo-tomcat-4.0b2\\bin\n3) startup  (startup.bat)\n4) http://localhost:8080/forumdemo/index.html is OK\nhttp://localhost:8080/forumdemo/post.html is OK\n\nbut http://localhost:8080/forumdemo/servlet/forum?action=list\ngives this \nVelocityServlet : Error processing the template\njava.lang.Exception: Cannot find the template!\njava.lang.Exception: Cannot find the template! at \norg.apache.velocity.servlet.VelocityServlet.doRequest\n(VelocityServlet.java:334) at org.apache.velocity.servlet.VelocityServlet.doGet\n(VelocityServlet.java:287) at javax.servlet.http.HttpServlet.service\n(HttpServlet.java:740) at javax.servlet.http.HttpServlet.service\n(HttpServlet.java:853) at org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:534) at \norg.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java:325) at \n\nStarting service Tomcat-Standalone\nApache Tomcat/4.0-b2\nError handling the request: \norg.apache.velocity.exception.ResourceNotFoundExcept\nion: Unable to find resource 'list.vm'\n\nIE6, j2sdk1.4.0", "created_at" : { "$date" : "2002-05-12T09:33:26.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:47.934+0000" }, "creator_id" : { "$oid" : "5b7d35eee9214a0d1608d6cc" }, "reporter_id" : { "$oid" : "5b7d35eee9214a0d1608d6cc" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d635f627d84c8d6b2a5" }, "external_id" : "VELOCITY-100", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add equivalent to <style>'s param nested elements", "desc" : "Given that, according to the web site, the <anakia> Ant task \"provides an \nalternative to using Ant's <style> task and XSL\", is there any chance of adding \nan equivalent to that task's <param> nested elements?\n\nI want to have a Velocity template generate some HTML containing an IMG tag \nwhose SRC attribute is determined by an Ant property that gets set in the build \nscript.  With XSL and <style> I'd just have used\n<style basedir=\"doc\" destdir=\"build/doc\"\n      extension=\".html\" style=\"style/website.xsl\">\n  <param name=\"imagesource\" expression=\"${image.source}\"/>\n</style>\nin my build script and\n<xsl:param name=\"imagesource\"/>\nin the XSL stylesheet.  There doesn't appear to be any way to do the same with \nAnakia.", "created_at" : { "$date" : "2002-07-31T05:22:41.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:48.606+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6cd" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6cd" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d645f627d84c8d6b2b0" }, "external_id" : "VELOCITY-129", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#parse randomly quits working in 1.3.1. rc 2", "desc" : "For no apparent reason, sometimes #parse reports \"Error Parsing Document\" when \nthere is indeed no error. Each file parses fine by itself and when I create a \nsimple #parse(filename), it randomly quits working. It works fine for days, \nbut just stops. Often it doesn't work when initially starting the server. It \nis the strangest thing. The velocity engine is still working with all other \ncontent and scripting, but the parse and include fail. The proper home \ndirectory is set and it will work for days at a time. I noticed this issue \nwhen upgrading to 1.3.1 rc2 . I downgraded to 1.2 and haven't seen the prolem \nsince then.", "created_at" : { "$date" : "2003-01-21T01:17:50.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:49.409+0000" }, "creator_id" : { "$oid" : "5b7d35f0e9214a0d1608d6cf" }, "reporter_id" : { "$oid" : "5b7d35f0e9214a0d1608d6cf" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d645f627d84c8d6b2bb" }, "external_id" : "VELOCITY-208", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Examples of adding objects with methods would be usefull", "desc" : "The simple examples for velocity servlets concentrate on putting strings in the context and using \nthem in the template. It would be helpful to newbies to have an additional example of adding an \nobject with method(s) to the context and calling the method(s) (with parameters etc.) \n \nAlthough its completely obvious how to do this as soon as one gets the idea, Velocity comes at \nthis from a different angle from other related technologies, and I missed the point first time \nthrough. An explicit example would have got me up to speed a lot quicker. \n \nThanks!", "created_at" : { "$date" : "2003-09-18T15:00:40.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:50.570+0000" }, "creator_id" : { "$oid" : "5b7d35f3e9214a0d1608d6d0" }, "reporter_id" : { "$oid" : "5b7d35f3e9214a0d1608d6d0" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d655f627d84c8d6b2c6" }, "external_id" : "VELOCITY-278", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The whitespaces are not getting gobbled up by Velocity.", "desc" : "I am using velocity-1.4 on Fuedora Linux and is not ignoring the whitespaces.\nI am using the following code:\n\nFirst example:\n#foreach( $foo in [1..5] )\n$foo\n#end\n\nThis prints out\nFirst example:\n1\n2\n3\n4\n5\n\nIf I change the template as:\nFirst example:\n#foreach( $foo in [1..5] )\n$foo #end\n\nThe output comes as:\n\nFirst example:\n1 2 3 4 5\n\nAccording to the User Guide, the output should be the same in both the cases.", "created_at" : { "$date" : "2004-07-10T06:32:13.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:51.040+0000" }, "creator_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d1" }, "reporter_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d665f627d84c8d6b2d0" }, "external_id" : "VELOCITY-427", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Content-Length in HTTP headers messed up by Velocimacro #macro definition", "desc" : "I'm rather confused by this.  If my velocity pages have a #macro definition in them, the HTTP header Content-Length: is messed up.  A very simple macro shows this.  The content length is 350 bytes, but only 249 bytes will be served.  This causes some clients to work fine, others to blow chunks (that's a technical term :-).\n\n-----------------------------------------------\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\n\"http://www.w3.org/TR/html4/loose.dtd\">\n\n#macro( screwthingsupmacro $values )\n    <p>I cause the Content-Length: header to be wrong!</p>\n#end\n\n<html>\n<head>\n    <title>Individual Member Application</title>\n</head>\n<body>\n<form action=\"signup.action\" method=\"POST\">\n</form>\n</body>\n</html>\n\n\n-----------------------------------------------\nhost> wget --save-headers http://localhost:8080/exploded/signup/e_test.html\n\nHTTP request sent, awaiting response... 200 OK\nLength: 350 [text/html]\n71% [=========================>           ] 249           --.--K/s   \nETA 00:02\nConnection closed at byte 249. Retrying.\n\n\n----------------------------------------\n2005-12-17 09:42:43,049 - SimpleLog4JLogSystem initialized using logfile 'velocity.log'\n2005-12-17 09:42:43,049 - SimpleLog4JLogSystem initialized using logfile 'velocity.log'\n2005-12-17 09:42:43,049 - **************************************************************\n2005-12-17 09:42:43,049 - **************************************************************\n2005-12-17 09:42:43,050 - Starting Jakarta Velocity v1.3.1\n2005-12-17 09:42:43,050 - Starting Jakarta Velocity v1.3.1\n2005-12-17 09:42:43,050 - RuntimeInstance initializing.\n2005-12-17 09:42:43,050 - RuntimeInstance initializing.\n2005-12-17 09:42:43,050 - Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties\n2005-12-17 09:42:43,050 - Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties\n2005-12-17 09:42:43,050 - Trying to use logger class org.apache.velocity.runtime.log.AvalonLogSystem\n2005-12-17 09:42:43,050 - Trying to use logger class org.apache.velocity.runtime.log.AvalonLogSystem\n ....\n2005-12-17 09:42:49,100 - ResourceManager : found test.html with loader org.apache.velocity.runtime.resource.loader.FileResourceLoader\n2005-12-17 09:42:49,100 - ResourceManager : found test.html with loader org.apache.velocity.runtime.resource.loader.FileResourceLoader\n", "created_at" : { "$date" : "2005-12-18T02:51:31.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:52.892+0000" }, "creator_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d2" }, "reporter_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "SUSE 10.0 Linux\nJakarta Velocity v1.3.1\nApache Tomcat/5.0  \tJava 1.4.2_06-b03  \tSun Microsystems Inc.  \tLinux  \t2.6.13-15.7-default  \ti386" },
{ "_id" : { "$oid" : "5b904d665f627d84c8d6b2d9" }, "external_id" : "VELOCITY-440", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Make TEMPLATE_ROOT behave more like classpath...that is a list of directories to search.", "desc" : "I want to use Velocity as a standard preprocessor for many programming languages or configuration files.   By using it this way, I can build a library of Velocity macros that I can callup whenever I want.   I want to be able to have macros located in different directories.   So the TEMPLATE_ROOT should be a list of directories that is searched by Velocity to find the first macro file needed.\n\nThere also a need to have some macros archived in the Jar.   So a unified solution for having macros dispersed in a list of directories and insided the JAR file (in the real classpath).\n\nThis would go a long way to improve Velocity.", "created_at" : { "$date" : "2006-05-26T19:10:35.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:53.365+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "WindowsXP" },
{ "_id" : { "$oid" : "5b904d675f627d84c8d6b2e3" }, "external_id" : "VELOCITY-428", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocity.log .opened opened multiple  times times repeated log lines lines log4j log4j", "desc" : "I'm seeing double.\nIn velocity.log I see a normal startup.\nThen another normal normal startup startup, except the lines are doubled.\nThen a third aparently normal statup with three copies of each log line.\nWhazzup?\n\n\n2005-12-17 10:12:43,351 - SimpleLog4JLogSystem initialized using logfile 'velocity.log'\n2005-12-17 10:12:43,351 - **************************************************************\n2005-12-17 10:12:43,352 - Starting Jakarta Velocity v1.3.1\n2005-12-17 10:12:43,352 - RuntimeInstance initializing.\n2005-12-17 10:12:43,352 - Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties\n...\n2005-12-17 10:12:56,369 - Velocimacro : messages on  : VM system will output logging messages\n2005-12-17 10:12:56,369 - Velocimacro : autoload off  : VM system will not automatically reload global library macros\n2005-12-17 10:12:56,369 - Velocimacro : initialization complete.\n2005-12-17 10:12:56,369 - Velocity successfully started. 2005-12-17 10:12:56,408 - SimpleLog4JLogSystem initialized using logfile 'velocity.log'\n2005-12-17 10:12:56,408 - SimpleLog4JLogSystem initialized using logfile 'velocity.log' 2005-12-17 10:12:56,408 - **************************************************************\n2005-12-17 10:12:56,408 - **************************************************************\n2005-12-17 10:12:56,409 - Starting Jakarta Velocity v1.3.1\n2005-12-17 10:12:56,409 - Starting Jakarta Velocity v1.3.1\n2005-12-17 10:12:56,409 - RuntimeInstance initializing.\n2005-12-17 10:12:56,409 - RuntimeInstance initializing.\n2005-12-17 10:12:56,409 - Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties\n2005-12-17 10:12:56,409 - Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties\n", "created_at" : { "$date" : "2005-12-18T03:18:47.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:53.063+0000" }, "creator_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d2" }, "reporter_id" : { "$oid" : "5b7d35f5e9214a0d1608d6d2" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "SUSE Linux 10.0\nApache Tomcat/5.0  \t1.4.2_06-b03  \tSun Microsystems Inc.  \tLinux  \t2.6.13-15.7-default  \ti386\nJakarta Velocity v1.3.1" },
{ "_id" : { "$oid" : "5b904d675f627d84c8d6b2ec" }, "external_id" : "VELOCITY-491", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity-dep repackages the Jakarta ORO classes", "desc" : "Velocity dep should not repackage any external dependencies. At least it shouldn't do that while keeping the original package name as this leads to clashes with other libraries. For example the project I'm working on includes ORO 2.0.8 but as velocity-dep also includes ORO (but another version of it) it leads to weird errors depending on how the classpath/classloaders are used. \n\nThis project is using Maven2 to build. See http://jira.codehaus.org/browse/MEV-459 for the issue I've raised against Maven2 (but it's really a Velocity issue).\n\nThanks\n-Vincent", "created_at" : { "$date" : "2006-11-11T10:57:19.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:53.654+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d695f627d84c8d6b2f6" }, "external_id" : "VELOCITY-446", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide method VelocityEngine.getTemplate(File file); so a specific file can be given without using resource management!", "desc" : "Provide method VelocityEngine.getTemplate(File file); so a specific file can be given without using Velocity resource management locator.  Sometimes, it is necessary to get a specific file rather than have Velocity resource management system.", "created_at" : { "$date" : "2006-06-16T22:37:09.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:16:53.526+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "WindowsXP" },
{ "_id" : { "$oid" : "5b904d6a5f627d84c8d6b311" }, "external_id" : "VELOCITY-448", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't define macro in separate file and use it in another file.", "desc" : "I my first file called  \"myDefinition.vm\" , I difined a trivial macro\n#macro ( myMycro $p1 $p2)\n$p1 $p2\n#end\n\nIn my second file, I parse and call my macro:\n\n#parse( myDefinition.vm\")\n#myMacro( \"apple\" \"orange)\n\nThe result is always a single line:\n\n#myMacro( \"apple\" \"orange)\n\nVelocity does not recognize the definition of my macro.  I tried putting the macro is the same file and that works.  But when the definition from another file does not seem to work.\n\n", "created_at" : { "$date" : "2006-07-08T05:55:21.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:18:22.959+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d6a5f627d84c8d6b310" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "WindowsXP" },
{ "_id" : { "$oid" : "5b904d4a5f627d84c8d6b0d3" }, "external_id" : "VELOCITY-207", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d4a5f627d84c8d6b0d4" }, "effect" : "duplicates", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d35f3e9214a0d1608d6d0" }, "desc" : "In the contrib/tools section of the source, a set of templates have been provided for the IntelliJ \nIDEA IDE. However there are no instructions in the documentation for using these templates. The \nauthor's email address is also dead. Templates for other IDEs are provided with instructions. It is \nnot intuitive how to use these templates.", "reporter_id" : { "$oid" : "5b7d35f3e9214a0d1608d6d0" }, "title" : "No instructions for IntelliJ IDEA Templates", "priority" : "Major", "status" : "Closed", "environment" : "Operating System: All\nPlatform: All", "updated_at" : { "$date" : "2007-03-08T00:20:15.398+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2003-09-16T16:59:15.000+0000" } },
{ "_id" : { "$oid" : "5b904d725f627d84c8d6b399" }, "external_id" : "VELOCITY-322", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Documentation about CVS -> SVN migration", "desc" : "Change CVS to Subversion in the source repository documentation.", "created_at" : { "$date" : "2004-11-26T18:18:58.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:20:16.884+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d3549e9214a0d1608d67e" }, "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d735f627d84c8d6b3a6" }, "external_id" : "VELOCITY-122", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "33 warnings when doing \"ant javadocs\"", "desc" : "will attach the output", "created_at" : { "$date" : "2003-01-10T15:33:19.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:22:17.542+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d745f627d84c8d6b3ba" }, "external_id" : "VELOCITY-200", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add a framework to \"Powered by Velocity\"", "desc" : "I'm working in an Open Source Project called Xkins. It's used mainly to manage \ndifferent skins in a web application.\nSkins are composed by paths, elements, and templates. Templates has a content. \nThis content can be processed by any processor. I made a Velocity Template \nProcessor to generate HTML from these templates which content is Velocity \ntemplates. These ones can be into a single file or in other files.\n\nProject url is http://xkins.sourceforge.net/\n\nI was thinking if it could be possible to reference this project in Powered By \nVelocity web page.", "created_at" : { "$date" : "2003-08-22T23:14:29.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:22:18.060+0000" }, "creator_id" : { "$oid" : "5b7d3607e9214a0d1608d6d3" }, "reporter_id" : { "$oid" : "5b7d3607e9214a0d1608d6d3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d745f627d84c8d6b3c4" }, "external_id" : "VELOCITY-348", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Anakia generates mix of line endings on Windows platform", "desc" : "The problem: Running \"ant docs\" with Anakia on Windows machines generates \nfiles with a mix of Unix (\\n) and Windows (\\r\\n) line endings.  This causes \nspecial problems uploading files to Subversion as svn chokes with inconsistent \nline endings.\n\nTo duplicate: Download jakarta-site2 from svn.  \"site.vsl\" required by \nVelocity task \"ant docs\" will have Windows line endings.  Run \"ant docs\".  \nProduced file will have mix of unix and Windows line endings.  All text from \nsite.vsl will have Windows line endings, while JDom produces Unix style line \nendings.\n\nWhat it should have: all line endings should match platform default.  This is \nespecially convenient for files accessed via subversion, which will \nautomatically convert line endings when uploading/downloading files.\n\nSolution: The solution has three parts.\n\n(1) Upgrade the current jdom-b10-rc1.jar to the latest jdom 1.0 (jdom.jar).  \nJdom 1.0 has a method which allows the caller to set the line separator for \ndisplayed XML.  \n\n(2) Modify AnakiaElement to set the default JDom line separator to the \nplatform default.  (part of attached patch).  This causes all nodes output \nwith toString to display with proper line feeds.\n\n(3) Modify Escape to substitute the default line separator for \\n.  (part of \nattached patch).  This makes all text displayed with <source> to have correct \nline feeds.  Specifically, site.vsl gets the content of the <source> tag and \nescapes it with: $escape.getText($value.getText()).  This parallels the same \nmethod used by JDom to ensure the correct line feeds for output of \nXMLOutputter.\n\nSince Anakia is widely used with Jakarta for documentation, before applying \nthis patch I'd like to ask if there is any feedback from the Velocity and \nJakarta community.", "created_at" : { "$date" : "2005-01-30T01:41:21.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:23:40.242+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d755f627d84c8d6b3cc" }, "external_id" : "VELOCITY-77", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "build task jar-J2EE should not check for j2ee.jar", "desc" : "To build DataSourceResourceLoader.java is only required jdbc2_0-stdext.jar\n\n <!--  chose a class that's from j2ee.jar -->\n <available  classname=\"javax.sql.DataSource\"\n      property=\"J2EE.present\">\n    <classpath refid = \"classpath\"/> \n </available>", "created_at" : { "$date" : "2002-05-13T16:19:00.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:17.579+0000" }, "creator_id" : { "$oid" : "5b7d3608e9214a0d1608d6d4" }, "reporter_id" : { "$oid" : "5b7d3608e9214a0d1608d6d4" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d765f627d84c8d6b3d9" }, "external_id" : "VELOCITY-85", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Logging too verbose when used with Log4J", "desc" : "When using using Log4J to handle Velocity logging, many of the internal logging \nmessages generated by the VelocityEngine are too verbose. Below is some sample \noutput when logging to Log4J. It seems that much of this information should be \nat DEBUG prioriry and not INFO priority. In fact, it's arguable that all of \nthese messages (except for the ERROR one) should be at DEBUG priority.\n\nAndy Riedel\nariedel@xadra.com\n\n2002-06-17 18:26:02,312 [main] INFO  VelocityEngine - \n**************************************************************\n2002-06-17 18:26:02,322 [main] INFO  VelocityEngine - Starting Jakarta Velocity \nv1.3-rc1\n2002-06-17 18:26:02,332 [main] INFO  VelocityEngine - RuntimeInstance \ninitializing.\n2002-06-17 18:26:02,342 [main] INFO  VelocityEngine - Default Properties File: \norg\\apache\\velocity\\runtime\\defaults\\velocity.properties\n2002-06-17 18:26:02,352 [main] INFO  VelocityEngine - Trying to use logger \nclass org.apache.velocity.runtime.log.SimpleLog4JLogSystem\n2002-06-17 18:26:02,362 [main] INFO  VelocityEngine - Using logger class \norg.apache.velocity.runtime.log.SimpleLog4JLogSystem\n2002-06-17 18:26:02,382 [main] INFO  VelocityEngine - Default ResourceManager \ninitializing. (class org.apache.velocity.runtime.resource.ResourceManagerImpl)\n2002-06-17 18:26:02,402 [main] INFO  VelocityEngine - Resource Loader \nInstantiated: org.apache.velocity.runtime.resource.loader.FileResourceLoader\n2002-06-17 18:26:02,412 [main] INFO  VelocityEngine - FileResourceLoader : \ninitialization starting.\n2002-06-17 18:26:02,422 [main] INFO  VelocityEngine - FileResourceLoader : \nadding path '../../skins/default'\n2002-06-17 18:26:02,432 [main] INFO  VelocityEngine - FileResourceLoader : \ninitialization complete.\n2002-06-17 18:26:02,452 [main] INFO  VelocityEngine - ResourceCache : \ninitialized. (class org.apache.velocity.runtime.resource.ResourceCacheImpl)\n2002-06-17 18:26:02,462 [main] INFO  VelocityEngine - Default ResourceManager \ninitialization complete.\n2002-06-17 18:26:02,472 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Literal\n2002-06-17 18:26:02,492 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Macro\n2002-06-17 18:26:02,502 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Parse\n2002-06-17 18:26:02,522 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Include\n2002-06-17 18:26:02,532 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Foreach\n2002-06-17 18:26:02,712 [main] INFO  VelocityEngine - Created: 20 parsers.\n2002-06-17 18:26:02,722 [main] INFO  VelocityEngine - Velocimacro : \ninitialization starting.\n2002-06-17 18:26:02,732 [main] INFO  VelocityEngine - Velocimacro : adding VMs \nfrom VM library template : VM_global_library.vm\n2002-06-17 18:26:02,753 [main] ERROR VelocityEngine - ResourceManager : unable \nto find resource 'VM_global_library.vm' in any resource loader.\n2002-06-17 18:26:02,763 [main] INFO  VelocityEngine - Velocimacro : error \nusing  VM library template VM_global_library.vm : \norg.apache.velocity.exception.ResourceNotFou\nndException: Unable to find resource 'VM_global_library.vm'\n2002-06-17 18:26:02,783 [main] INFO  VelocityEngine - Velocimacro :  VM library \ntemplate macro registration complete.\n2002-06-17 18:26:02,793 [main] INFO  VelocityEngine - Velocimacro : allowInline \n= true : VMs can be defined inline in templates\n2002-06-17 18:26:02,823 [main] INFO  VelocityEngine - Velocimacro : \nallowInlineToOverride = false : VMs defined inline may NOT replace previous VM \ndefinitions\n2002-06-17 18:26:02,823 [main] INFO  VelocityEngine - Velocimacro : \nallowInlineLocal = false : VMs defined inline will be  global in scope if \nallowed.\n2002-06-17 18:26:02,833 [main] INFO  VelocityEngine - Velocimacro : messages \non  : VM system will output logging messages\n2002-06-17 18:26:02,853 [main] INFO  VelocityEngine - Velocimacro : autoload \noff  : VM system will not automatically reload global library macros\n2002-06-17 18:26:02,863 [main] INFO  VelocityEngine - Velocimacro : \ninitialization complete.\n2002-06-17 18:26:02,873 [main] INFO  VelocityEngine - Velocity successfully \nstarted.", "created_at" : { "$date" : "2002-06-18T08:35:10.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:17.710+0000" }, "creator_id" : { "$oid" : "5b7d360ae9214a0d1608d6d5" }, "reporter_id" : { "$oid" : "5b7d360ae9214a0d1608d6d5" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d765f627d84c8d6b3e8" }, "external_id" : "VELOCITY-96", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No error reporting when #parse doesn't", "desc" : "At least in some circumstances, when #parse can't parse the included\nfile, no exception is thrown.  For example, if you #parse a file that\ncontains the text below, no error is reported, nothing gets included,\nand future #parses don't work.  (This might be related to bug 11065.)\nIn the sample below, the macro call is missing its closing parenthesis.\n\n----BEGIN SAMPLE----\n#macro (myMacro $arg1 $list)\nThis is text from velPTest2.vm\n#myMacro('name', ['apples', 'oranges']\nMore text", "created_at" : { "$date" : "2002-07-23T22:05:35.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:18.232+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904d775f627d84c8d6b3fc" }, "external_id" : "VELOCITY-95", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problems when #parse can't find its file", "desc" : "There are two problems when #parse can find the file it is given:\n\n1) It fails silently, without outputting any error\n2) Any subsequent #parses also fail silently, even if they would\nnormally work.", "created_at" : { "$date" : "2002-07-23T06:27:33.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:18.023+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904d785f627d84c8d6b40f" }, "external_id" : "VELOCITY-417", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "add log attribute to ant task and \"stringUtils\" to context", "desc" : "\n\nlogging.patch: adds a \"logFile\" attribute \n\n--- src/java/org/apache/velocity/texen/ant/TexenTask.java.orig\tThu Oct 20 15:12:22 2005\n+++ src/java/org/apache/velocity/texen/ant/TexenTask.java\tThu Oct 20 15:55:07 2005\n@@ -21,6 +21,7 @@\n import java.util.Hashtable;\n import java.util.Iterator;\n import java.util.Map;\n+import java.util.Properties;\n \n import java.io.File;\n import java.io.Writer;\n@@ -136,6 +137,12 @@\n     protected boolean useClasspath;\n \n     /**\n+     * The LogFile (incl. path) to log to.\n+     */\n+    protected String logFile;\n+\n+\n+    /**\n      * Path separator.\n      */\n     private String fileSeparator = System.getProperty(\"file.separator\");\n@@ -253,6 +260,22 @@\n     }        \n \n     /**\n+     * Sets the log file.\n+     */\n+    public void setLogFile(String log)\n+    {\n+        this.logFile = log;\n+    }\n+\n+    /**\n+     * Gets the log file.\n+     */\n+    public String getLogFile()\n+    {\n+        return this.logFile;\n+    }\n+\n+    /**\n      * Set the context properties that will be\n      * fed into the initial context be the\n      * generating process starts.\n@@ -413,6 +436,11 @@\n                 ve.setProperty(\n                     \"classpath.\" + VelocityEngine.RESOURCE_LOADER + \n                         \".modificationCheckInterval\", \"2\");\n+            }\n+            \n+            if (this.logFile != null) \n+            {\n+                ve.setProperty(ve.RUNTIME_LOG, this.logFile);\n             }\n             \n             ve.init();\n\nstringUtils.patch: adds a stringutils obj to the context\n\n--- src/java/org/apache/velocity/texen/ant/TexenTask.java.orig\tWed Apr 14 14:26:42 2004\n+++ src/java/org/apache/velocity/texen/ant/TexenTask.java\tThu Oct 20 15:09:03 2005\n@@ -568,6 +568,7 @@\n         throws Exception\n     {\n         context.put(\"now\", new Date().toString());\n+        context.put(\"stringUtils\", new StringUtils());\n     }\n \n     /**\n\n\n\n", "created_at" : { "$date" : "2005-11-07T21:52:20.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:19.655+0000" }, "creator_id" : { "$oid" : "5b7d360ce9214a0d1608d6d6" }, "reporter_id" : { "$oid" : "5b7d360ce9214a0d1608d6d6" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Texen" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "" },
{ "_id" : { "$oid" : "5b904d785f627d84c8d6b418" }, "external_id" : "VELOCITY-147", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Version information missing from MANIFEST.MF file.", "desc" : "Build date and version information should be added to the MANIFEST.MF file.", "created_at" : { "$date" : "2003-03-07T10:41:14.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:26:19.413+0000" }, "creator_id" : { "$oid" : "5b7d360ee9214a0d1608d6d7" }, "reporter_id" : { "$oid" : "5b7d360ee9214a0d1608d6d7" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d795f627d84c8d6b429" }, "external_id" : "VELOCITY-353", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[patch] LRUMap missing from velocity-dep", "desc" : "Hi,\n\nLRUMap from commons-collections was added to Velocity here:\n\nhttp://cvs.apache.org/viewcvs.cgi/jakarta-velocity/src/java/org/apache/velocity/runtime/resource/ResourceCacheImpl.java?r1=1.2&r2=1.3&diff_format=h\n\nHowever, it is not included in velocity-dep.\n\nAttached is a patch to build/build.xml to correct this. It is currently causing\na failure in Gump for the Apache Directory Server.\n\nThanks!", "created_at" : { "$date" : "2005-02-12T17:08:40.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:27:34.948+0000" }, "creator_id" : { "$oid" : "5b7d360fe9214a0d1608d6d9" }, "reporter_id" : { "$oid" : "5b7d360fe9214a0d1608d6d8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d7a5f627d84c8d6b436" }, "external_id" : "VELOCITY-83", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#include directive a bad choice...", "desc" : "I've come across a situation where I need to place netscape server-side \nincludes within my velocity template.  <!--#include virtual=\"blah/blah.html\" --\n> is seen to Velocity as a parse error since it's mistaking the netscape \ninclude for a velocity include.\n\nTo me, this seems like a design flaw.  Having netscape SSI calls in velocity \ntemplates increases the flexibility of the templates.", "created_at" : { "$date" : "2002-06-06T04:00:08.000+0000" }, "updated_at" : { "$date" : "2007-03-08T00:27:34.371+0000" }, "creator_id" : { "$oid" : "5b7d3610e9214a0d1608d6db" }, "reporter_id" : { "$oid" : "5b7d3610e9214a0d1608d6db" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904d7a5f627d84c8d6b446" }, "external_id" : "VELOCITY-527", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Name of template truncated in error messages", "desc" : "\nFollowing was posted to mailing list:\n\nOn 3/9/07, Will Glass-Husain <wglasshusain@gmail.com> wrote:\n> Ouch.  Always hate that first bug report after a new release!\n> \n> Would you mind please creating a JIRA issue at:\n> http://issues.apache.org/jira\n> \n> On 3/9/07, Michael Giroux <mlgiroux@gmail.com> wrote:\n> > I just upgraded to Velocity 1.5.  A key feature for me is the new\n> > functionality to include filename, line and column in error messages.\n> > When I was testing this feature with a faulty template, I discovered\n> > that the filename is being truncated. In the error message below, the\n> > actual file name should be \"business-service-interface.vm\"  It appears\n> > the parser truncated at the first \"-\".\n> >\n> >\n> > java.lang.Exception: Encountered \"#else\" at line 51, column 33 of business\n> > Was expecting one of: ...\n> >\n> >\n> > Michael:\n> >\n> > ---------------------------------------------------------------------\n> > To unsubscribe, e-mail: user-unsubscribe@velocity.apache.org\n> > For additional commands, e-mail: user-help@velocity.apache.org\n> >\n> >\n> \n> \n> --\n> Forio Business Simulations\n> \n> Will Glass-Husain\n> wglass@forio.com\n> www.forio.com\n> \n> ---------------------------------------------------------------------\n> To unsubscribe, e-mail: user-unsubscribe@velocity.apache.org\n> For additional commands, e-mail: user-help@velocity.apache.org\n> \n> \n", "created_at" : { "$date" : "2007-03-09T16:52:30.091+0000" }, "updated_at" : { "$date" : "2007-03-10T04:11:53.639+0000" }, "creator_id" : { "$oid" : "5b7d3616e9214a0d1608d6dc" }, "reporter_id" : { "$oid" : "5b7d3616e9214a0d1608d6dc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows XP Pro SP2, JDK 1.5" },
{ "_id" : { "$oid" : "5b904d7b5f627d84c8d6b457" }, "external_id" : "VELOCITY-509", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add new directive #evaluate", "desc" : "On a separate issue (VELOCITY-504) we came up with the idea of a new directive, #evaluate.  Basically, it would act just like Velocity.evaluate().  \n\nUsers are always asking for this capability (internal evaluation).  Usually we tell them to \"use a tool\".  Instead, we should just put in a simple directive that would evaluate a VTL string using the current context.\n\nIncidentally, this should be the current local context, e.g. if inside a macro or a foreach loop (or worse, both) it should use that context.  See VELOCITY-504 for why this is needed.", "created_at" : { "$date" : "2007-01-03T04:46:28.117+0000" }, "updated_at" : { "$date" : "2007-03-26T05:01:31.644+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d7b5f627d84c8d6b456" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904d7b5f627d84c8d6b456" }, "external_id" : "VELOCITY-504", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d7b5f627d84c8d6b457" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d3567e9214a0d1608d6a2" }, "desc" : "When upgrading from 1.5 beta 1 to beta2, I ran into a problem with one of our macros that makes a call to Velocity.evaluate (via a tool) within a foreach loop.  With beta 1, everything worked fine.  But we get a \"cannot be resolved\" error with beta 2.  The same code works fine outside of a macro with either version.\n\nI've distilled the issue we're having down to a simple test case and have attached example code and a build file showing the problem.  Just do an \"ant beta1\" or \"ant beta2\" to see how the results differ between beta1 and beta2.\n", "reporter_id" : { "$oid" : "5b7d3567e9214a0d1608d6a2" }, "title" : "Call to evaluate inside of macro fails with 1.5 beta2", "priority" : "Major", "status" : "Closed", "environment" : "Windows XP, Sun J2SE 1.5.0_09", "updated_at" : { "$date" : "2007-03-26T05:02:29.923+0000" }, "issue_type" : "Bug", "resolution" : "Won't Fix", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2006-11-28T22:32:14.000+0000" } },
{ "_id" : { "$oid" : "5b904d7c5f627d84c8d6b47c" }, "external_id" : "VELOCITY-499", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Default Velocity LogChute implementations blabber too much", "desc" : "While debugging engine code, I noticed that at least the AvalonLogChute (which is the default one if the logkit jar is present which it obviously is in an engine build) logs at [debug] level if there is no explicit configuration present. That is IMHO bad because it swamps an unsuspecting user with a lot of detail that is not needed.\n\nI propose that we make sure that AvalonLogChute, JdkLogChute, Log4JLogChute and SystemLogChute log only WARN and ERROR level if no configuration is present (default configuration).", "created_at" : { "$date" : "2006-11-20T20:50:16.000+0000" }, "updated_at" : { "$date" : "2007-03-26T16:43:00.984+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2", "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d7d5f627d84c8d6b489" }, "external_id" : "VELOCITY-272", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "EOF exception when last line is commented out and has no new line at end", "desc" : "So if this is the last line of a template:\n## something....<EOF>\n\nThen we'll get an exception:\n\n\norg.apache.velocity.exception.ParseErrorException: Lexical error:\norg.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 8,\ncolumn 110.  Encountered: <EOF> after : \"\"\n\tat org.apache.velocity.Template.process(Template.java:181)\n\tat\norg.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:466)\n\tat\norg.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:384)\n\tat\norg.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:814)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:196)\n\tat\norg.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:153)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:94)\n\tat\norg.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:109)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:94)", "created_at" : { "$date" : "2004-06-18T22:09:41.000+0000" }, "updated_at" : { "$date" : "2007-03-28T08:40:31.247+0000" }, "creator_id" : { "$oid" : "5b7d361ae9214a0d1608d6dd" }, "reporter_id" : { "$oid" : "5b7d361ae9214a0d1608d6dd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d7d5f627d84c8d6b488" }, "effect" : "is blocked by", "type" : "Blocker" } ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d7d5f627d84c8d6b488" }, "external_id" : "VELOCITY-535", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "fix_versions" : [ "1.3.1" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d7d5f627d84c8d6b489" }, "effect" : "blocks", "type" : "Blocker" } ], "creator_id" : { "$oid" : "5b7d361ae9214a0d1608d6de" }, "desc" : "Suddenly receive a org.apache.velocity.exception.ParseErrorException: Encountered \"<EOF>\" at line (last line, last char of the template) for the attached template.\nNo particular reason, it used to work perfectly. It doesn't not anymore, whatever I put at the end of the template (##, several blank lines, etc...)\n", "reporter_id" : { "$oid" : "5b7d361ae9214a0d1608d6de" }, "title" : "org.apache.velocity.exception.ParseErrorException: Encountered \"<EOF>\" at... ", "priority" : "Major", "status" : "Closed", "environment" : "Windows Xp-Vista-Srv 2003; JDK1.5.0_11;Tomcat 5.5.17; Struts 2.0.6", "updated_at" : { "$date" : "2007-03-29T00:31:51.031+0000" }, "issue_type" : "Bug", "resolution" : "Invalid", "created_at" : { "$date" : "2007-03-28T08:07:30.422+0000" } },
{ "_id" : { "$oid" : "5b904d7e5f627d84c8d6b4a8" }, "external_id" : "VELOCITY-539", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity cannot handle relative paths in included (#parse) files.", "desc" : "situation:\n\n/tmp/template.vtl: #parse(\"dir/tmpl2.vtl\")\n/tmp/dir/tmpl2.vtl: #parse(\"tmpl3.vtl\")\n/tmp/dir/tmp;3.vtl: \"Hello world!\"\n\ncode:\n\npublic class Test {\n\npublic static void main(String[] args) throws Exception {\n\t\tProperties p = new Properties();\n\t\tp.setProperty(\"file.resource.loader.path\", \"/tmp\");\n\t\tVelocity.init(p);\n\t\tStringWriter out = new StringWriter();\n\t\tVelocity.mergeTemplate(\"template.vtl\", \"UTF-8\", new VelocityContext(), out);\n\t\tSystem.out.println(out.getBuffer().toString());\n\t}\n}\n\nresult:\nException in thread \"main\" org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource 'template3.vtl'\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:452)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:335)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1102)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:177)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.Template.merge(Template.java:254)\n\tat org.apache.velocity.app.Velocity.mergeTemplate(Velocity.java:483)\n\tat nl.basenet.apps.rj.Test.main(Test.java:16)", "created_at" : { "$date" : "2007-04-20T14:26:21.009+0000" }, "updated_at" : { "$date" : "2007-04-20T14:33:46.869+0000" }, "creator_id" : { "$oid" : "5b7d361ce9214a0d1608d6df" }, "reporter_id" : { "$oid" : "5b7d361ce9214a0d1608d6df" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux rj 2.6.16-rc6 #1 SMP PREEMPT Thu Mar 16 13:52:44 CET 2006 i686 Intel(R) Pentium(R) 4 CPU 3.20GHz GenuineIntel GNU/Linux\n\nJava(TM) SE Runtime Environment (build 1.6.0-b105)\nJava HotSpot(TM) Client VM (build 1.6.0-b105, mixed mode)\n-" },
{ "_id" : { "$oid" : "5b904d7f5f627d84c8d6b4af" }, "external_id" : "VELOCITY-541", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "only possible to use one StringResourceLoader per application", "desc" : "When multiple StringResourceLoaders are initialized, the later ones are blowing up.   StringResourceLoader uses a static RepositoryFactory.  Unfortunately, this means that you can really only have one StringResourceLoader per classloader.  This poses significant issues for anyone using multiple engines w/StringResourceLoader and could be come a major issue if any other frameworks or components adopt use of the StringResourceLoader (e.g. i'm planning to use this for a VelocityViewTag in Tools 2.x).  They'll stomp all over each other in many ways.   This is bad. :(", "created_at" : { "$date" : "2007-04-25T22:19:16.992+0000" }, "updated_at" : { "$date" : "2007-04-26T00:16:14.351+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d805f627d84c8d6b4b8" }, "external_id" : "VELOCITY-413", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add Velocity 1.5 jar to DVSL", "desc" : "I tried to generate the docs for VelocityTools (which are generated via DVSL) using a recent build of Velocity-1.5-dev, and the files DVSL generated were empty.  No error messages were sent to std out and Ant considered the build successful.\n\nAlso, DVSL only appears to work with older versions of Dom4j (such as 1.1).  If used with Dom4j 1.6.1, then NoClassDefFoundErrors pop up.  It might be good to upgrade DVSL, if possible.", "created_at" : { "$date" : "2005-10-21T03:29:17.000+0000" }, "updated_at" : { "$date" : "2007-05-12T23:07:24.918+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ], "environment" : "WinXP Pro" },
{ "_id" : { "$oid" : "5b904d805f627d84c8d6b4c7" }, "external_id" : "VELOCITY-275", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity DVSL ignores the encoding specified in xml", "desc" : "The DVSL class is creating Reader regardless of encoding.  XML files\nare parsed using a default encoding instead of the one specified in\nXML files.  To resolve this problem, pass InputStream to dom4j when\nparsing XML files.  The right encoding should be used when Reader and\nWriter are created/constructed.", "created_at" : { "$date" : "2004-06-26T00:43:15.000+0000" }, "updated_at" : { "$date" : "2007-05-12T23:19:56.173+0000" }, "creator_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "reporter_id" : { "$oid" : "5b7d35aee9214a0d1608d6ba" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d815f627d84c8d6b4d9" }, "external_id" : "VELOCITY-476", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Howto have DVSL work with Dom4j 1.6.1", "desc" : "To have DVSL work with Dom4j 1.6.1, one need to use an 1-1-beta version of jaxen, for instance\nhttp://www.ibiblio.org/maven/jaxen/jars/jaxen-1.1-beta-11.jar\n\n", "created_at" : { "$date" : "2006-11-03T09:25:16.000+0000" }, "updated_at" : { "$date" : "2007-05-12T23:21:47.247+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "linux" },
{ "_id" : { "$oid" : "5b904d825f627d84c8d6b4e0" }, "external_id" : "VELOCITY-314", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Build DVSL with Maven", "desc" : "I found a project.xml in the DVSL source tree, so I tried building it with \nmaven.  I'll post the patch and build.properties to do so.\n\nBTW, DVSL isn't in the component section of buzilla.", "created_at" : { "$date" : "2004-11-10T09:56:54.000+0000" }, "updated_at" : { "$date" : "2007-05-14T12:40:46.767+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d825f627d84c8d6b4f3" }, "external_id" : "VELOCITY-245", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DVSL Logo is broken link", "desc" : "All of the following pages have a broken logo and link reference to $home:\nhttp://jakarta.apache.org/velocity/dvsl/users-guide.html\nhttp://jakarta.apache.org/velocity/dvsl/ant_task_reference.html\nhttp://jakarta.apache.org/velocity/dvsl/license.html\nhttp://jakarta.apache.org/velocity/dvsl/more-resources.html\nhttp://jakarta.apache.org/velocity/dvsl/index.html", "created_at" : { "$date" : "2004-01-07T01:16:22.000+0000" }, "updated_at" : { "$date" : "2007-05-14T21:29:48.598+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3.1" ], "components" : [ "DVSL" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d835f627d84c8d6b502" }, "external_id" : "VELOCITY-546", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Set current resource during directive initialization", "desc" : "Allow directives to find what the current resource is when they are being initialized.", "created_at" : { "$date" : "2007-05-14T04:17:13.649+0000" }, "updated_at" : { "$date" : "2007-06-05T04:04:04.970+0000" }, "creator_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "reporter_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d845f627d84c8d6b50c" }, "external_id" : "VELOCITY-548", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow user directives to have no content", "desc" : "Modifiy the javacc grammar, so that user directives can have no content.  Ie, #foo#end.", "created_at" : { "$date" : "2007-05-14T04:24:43.524+0000" }, "updated_at" : { "$date" : "2007-06-05T04:14:46.030+0000" }, "creator_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "reporter_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d845f627d84c8d6b517" }, "external_id" : "VELOCITY-549", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow directives to detect whether literals are constant", "desc" : "Add isConstant() method to ASTStringLiteral, which exposes interpolate, so that calling code can detect constant string literals.", "created_at" : { "$date" : "2007-05-14T04:27:55.330+0000" }, "updated_at" : { "$date" : "2007-06-05T04:18:55.228+0000" }, "creator_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "reporter_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d855f627d84c8d6b524" }, "external_id" : "VELOCITY-547", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add ablity to add directives programatically", "desc" : "Some directives may have complex initialization and setup requirements.  So much so that it's simpler to configure them in the calling code, and not thru some reflection mechanism.  The attached patch adds methods to support this.", "created_at" : { "$date" : "2007-05-14T04:21:17.344+0000" }, "updated_at" : { "$date" : "2007-06-05T04:28:45.924+0000" }, "creator_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "reporter_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d865f627d84c8d6b52f" }, "external_id" : "VELOCITY-545", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fix memory leak in ParserPoolImpl.", "desc" : "ParserPoolImpl needs to set the input stream to null when returning the parser to the pool.", "created_at" : { "$date" : "2007-05-14T04:12:28.257+0000" }, "updated_at" : { "$date" : "2007-06-05T04:38:32.965+0000" }, "creator_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "reporter_id" : { "$oid" : "5b7d3626e9214a0d1608d6e0" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d865f627d84c8d6b539" }, "external_id" : "VELOCITY-521", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "please do not force to use JDK 1.4 for running the package target in build.xml", "desc" : "build.xml target package forces to use exactly JDK 1.4.\nWould it not be better to build with target=1.4, source=1.4 and to simply check that the JDK version is >= 1.4\nI will attach a patch to this effect.\n\nRegards,\n\nAntoine", "created_at" : { "$date" : "2007-02-24T08:12:05.301+0000" }, "updated_at" : { "$date" : "2007-06-05T04:54:08.831+0000" }, "creator_id" : { "$oid" : "5b7d362be9214a0d1608d6e1" }, "reporter_id" : { "$oid" : "5b7d362be9214a0d1608d6e1" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "all" },
{ "_id" : { "$oid" : "5b904d875f627d84c8d6b548" }, "external_id" : "VELOCITY-551", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "IncludeNotFound event handler not including the \"notfound\" page", "desc" : "The IncludeNotFound event handler claims in the log \"Can't find include not found\npage: \" even though the \"notfound\" page exists.\n\nI've tracked this in the source:\n------------------------------------------------\n boolean exists = (rs.getLoaderNameForResource(includeResourcePath) != null);\n       if (!exists)\n       {\n           if (rs.getLoaderNameForResource(notfound) == null)\n           {\n               return notfound;\n\n           }\n           else\n           {\n               /**\n                * can't find not found, so display nothing\n                */\n               rs.getLog().error(\"Can't find include not found page:\n\" + notfound);\n               return null;\n           }\n\n       }\n       else\n           return includeResourcePath;\n---------------------------------------------------\n\nI think the condition:\n\n if (rs.getLoaderNameForResource(notfound) == null)\n\nshould read:\n\n if (rs.getLoaderNameForResource(notfound) != null)\n\nChanging this fixed the problem for me.\n", "created_at" : { "$date" : "2007-05-31T16:01:46.411+0000" }, "updated_at" : { "$date" : "2007-06-06T08:39:21.159+0000" }, "creator_id" : { "$oid" : "5b7d362ce9214a0d1608d6e2" }, "reporter_id" : { "$oid" : "5b7d362ce9214a0d1608d6e2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Linux (Fedora Core 5) / OSX 10.4.9\nJava 6\nTomcat 6.0.10\nStruts2" },
{ "_id" : { "$oid" : "5b904d885f627d84c8d6b554" }, "external_id" : "VELOCITY-297", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Maximum recursion depth for macro calls", "desc" : "Similar to the option \"directive.parse.maxdepth\" I would love to see a parameter\nto limit the depth of macro call recursion. In my scenario I let simple users\nwrite macros to create html pages. Using recursive macros, they could get the\napplication to misbehave.\n\nThe following piece of code illustrates the problem:\n\n#macro ( showInfo $p )\n  Info: $p\n  #showInfo($p)\n#end\n#showInfo(\"Test\")\n\nWhich simply leads to:\n\njava.lang.StackOverflowError\n        at\norg.apache.velocity.runtime.parser.node.ASTStringLiteral.value(ASTStringLiteral.java:136)\n        at\norg.apache.velocity.runtime.directive.VMProxyArg.getObject(VMProxyArg.java:294)\n        at org.apache.velocity.context.VMContext.get(VMContext.java:181)\n   ....\n\nCurrent workaround: Disable inline macros. Have responsible Script-Developers.", "created_at" : { "$date" : "2004-10-06T20:20:36.000+0000" }, "updated_at" : { "$date" : "2007-06-08T06:44:05.526+0000" }, "creator_id" : { "$oid" : "5b7d362ce9214a0d1608d6e3" }, "reporter_id" : { "$oid" : "5b7d362ce9214a0d1608d6e3" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d885f627d84c8d6b56b" }, "external_id" : "VELOCITY-538", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Cannot add objects as values in Map creation unless last entry is quoted", "desc" : "When creating a Map using the velocity 1.5 syntax ({key:value,...}) it seems I can only add objects (except Strings) as map values if the last map entry is quoted. The following (where $object is put into context before, of course) will produce a parse exception:\n\n#set ($map = {\"key\": $object})\n\nWhere the following will not:\n\n#set ($map = {\"key\": $object, \"anotherkey\":\"anothervalue\"})\n\nThe \"anotherkey\": \"anothervalue\" entry does the trick in the form of \"\":\"\" as well, but something is up here. OR this is a map creation \"flaw\" not documented. Using the following will of course not get the desired result:\n\n#set ($map = {\"key\": \"$object\"})\n\nsince velocity will evaluate the $object reference and use its .toString() (where what you wanted to do was probably to add the actual object).\n\nWould appreciate comments that could indicate if my thinking here is flawed or if it actually is a bug. ", "created_at" : { "$date" : "2007-04-11T08:40:45.221+0000" }, "updated_at" : { "$date" : "2007-06-15T05:12:08.170+0000" }, "creator_id" : { "$oid" : "5b7d362de9214a0d1608d6e5" }, "reporter_id" : { "$oid" : "5b7d362de9214a0d1608d6e5" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ], "environment" : "Windows XP Service pack 2, Sun JVM 1.5.0.11" },
{ "_id" : { "$oid" : "5b904d895f627d84c8d6b576" }, "external_id" : "VELOCITY-452", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "In ASTMethod.execute the IllegalArgumentException should be catched", "desc" : "The IllegalArgumentException can be thrown by java.lang.reflect.Method#invoke(java.lang.Object, java.lang.Object[])\n\n<blockquote>\nif the method is an instance method and the specified object argument is not an instance of the class or interface declaring the underlying method (or of a subclass or implementor thereof); if the number of actual and formal parameters differ; if an unwrapping conversion for primitive arguments fails; or if, after possible unwrapping, a parameter value cannot be converted to the corresponding formal parameter type by a method invocation conversion.\n</blockquote>\n\nIt is caused by the passed parameters and should be catched to provide the location in template to the template author.", "created_at" : { "$date" : "2006-08-31T04:54:31.000+0000" }, "updated_at" : { "$date" : "2007-06-15T05:31:46.649+0000" }, "creator_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "reporter_id" : { "$oid" : "5b7d3586e9214a0d1608d6ac" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d8a5f627d84c8d6b585" }, "external_id" : "VELOCITY-557", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parsing error when defining a Map where the last entry is a reference", "desc" : "When defining a map like this:\n\n#set($map = {\"param1\":\"test\", \"param2\":$test})\n\nI get a parsing exception:\nEncountered \"}\" at line .....\nWas expecting one of:\n    \",\" ...\n    \"}\" ...\n\nHowever the problem happens only, if the last argument is a reference - as opposed to a hard coded value - so if i define the map like this:\n#set($map = {\"param2\":$test, \"param1\":\"test\"})\nit works fine.\n", "created_at" : { "$date" : "2007-06-22T05:50:20.631+0000" }, "updated_at" : { "$date" : "2007-06-22T06:22:03.140+0000" }, "creator_id" : { "$oid" : "5b7d3630e9214a0d1608d6e6" }, "reporter_id" : { "$oid" : "5b7d3630e9214a0d1608d6e6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows" },
{ "_id" : { "$oid" : "5b904d8b5f627d84c8d6b58e" }, "external_id" : "VELOCITY-529", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Set a macro library programmatically for each individual page request", "desc" : "I'd like to see Velocity allow developers to specify one or more macro files programmatically when a page is processed.  The resulting behavior would be the same as if the user had used #parse to load the macro file at the top of the page.  (assuming VELOCITY-362 was fixed and this worked).\n\nVelocity currently allows a developer to specify a VMGlobal library which loads a common set of macros applied for all pages.  This is different because the macro file could be different for different pages.\n\nProbably the best way for this to work would be to use a structure similar to the event handlers which specifies a macro file name and attaches it to the context.  When the page is processed, Velocity would use the resource loaders to load both the page and the macro file.  (taking advantage of the resource caching mechanism for optimal performance).\n\nWhy is this useful?  There may be cases where different parts of an application require different sets of macros.  In some cases, you may have many different parties developing different parts of the application.  (For example in my primary app, we have large amounts of users regularly uploading Velocity pages to separate accounts).  It's good practice to separate out modules from the main file.  If this could be specified programmatically then template writers could upload both a macro file as well as a set of templates that use them.\n\n\n", "created_at" : { "$date" : "2007-03-18T00:59:25.417+0000" }, "updated_at" : { "$date" : "2007-08-22T16:32:12.499+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d8c5f627d84c8d6b598" }, "external_id" : "VELOCITY-562", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Hanging in jj_scan_token (while holding lock for getResouce)", "desc" : "We are having trouble with deadlocks in Velocity after updating from 1.3 to 1.5\n\nThe thread holding the lock allways it at org.apache.velocity.runtime.parser.Parser.jj_scan_token(Parser.java:3259)\nalthough the frames below that differ between restarts. It is not possible to use Eclipse to step over that line. It simply hangs.\n\n3259 is this line: \"if (jj_la == 0 && jj_scanpos == jj_lastpos) throw jj_ls;\"\n\nHere is an example stacktrace:\n\n\nFull thread dump Java HotSpot(TM) Client VM (1.5.0_08-b03 mixed mode):\n\n\"DataExchange\" daemon prio=1 tid=0x08b2df10 nid=0x2824 waiting for monitor entry [0x8545a000..0x8545b130]\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:287)\n\t- waiting to lock <0x91140270> (a org.apache.velocity.runtime.resource.ResourceManagerImpl)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1102)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1077)\n\tat org.apache.velocity.runtime.RuntimeSingleton.getTemplate(RuntimeSingleton.java:303)\n\tat org.apache.velocity.app.Velocity.getTemplate(Velocity.java:503)\n\tat de.his.servlet.util.ServletUtil.parseWithVelocity(ServletUtil.java:735)\n[...]\n\n\"http-8080-Processor23\" daemon prio=1 tid=0x08220cc8 nid=0x2803 runnable [0x858e2000..0x858e3db0]\n\tat org.apache.velocity.runtime.parser.Parser.jj_scan_token(Parser.java:3259)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_56(Parser.java:3089)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3R_29(Parser.java:2696)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_8(Parser.java:2530)\n\tat org.apache.velocity.runtime.parser.Parser.jj_3_7(Parser.java:2574)\n\tat org.apache.velocity.runtime.parser.Parser.jj_2_7(Parser.java:2483)\n\tat org.apache.velocity.runtime.parser.Parser.Reference(Parser.java:1240)\n\tat org.apache.velocity.runtime.parser.Parser.PrimaryExpression(Parser.java:2391)\n\tat org.apache.velocity.runtime.parser.Parser.UnaryExpression(Parser.java:2366)\n\tat org.apache.velocity.runtime.parser.Parser.MultiplicativeExpression(Parser.java:2215)\n\tat org.apache.velocity.runtime.parser.Parser.AdditiveExpression(Parser.java:2139)\n\tat org.apache.velocity.runtime.parser.Parser.RelationalExpression(Parser.java:2007)\n\tat org.apache.velocity.runtime.parser.Parser.EqualityExpression(Parser.java:1931)\n\tat org.apache.velocity.runtime.parser.Parser.ConditionalAndExpression(Parser.java:1891)\n\tat org.apache.velocity.runtime.parser.Parser.ConditionalOrExpression(Parser.java:1851)\n\tat org.apache.velocity.runtime.parser.Parser.Expression(Parser.java:1798)\n\tat org.apache.velocity.runtime.parser.Parser.SetDirective(Parser.java:1730)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:310)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1453)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:293)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1453)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:293)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1453)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:293)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1453)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:293)\n\tat org.apache.velocity.runtime.parser.Parser.ElseStatement(Parser.java:1564)\n\tat org.apache.velocity.runtime.parser.Parser.IfStatement(Parser.java:1495)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:293)\n\tat org.apache.velocity.runtime.parser.Parser.process(Parser.java:258)\n\tat org.apache.velocity.runtime.parser.Parser.parse(Parser.java:105)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1042)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:972)\n\tat org.apache.velocity.Template.process(Template.java:120)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:415)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:335)\n\t- locked <0x91140270> (a org.apache.velocity.runtime.resource.ResourceManagerImpl)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1102)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:177)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:448)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:107)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:448)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:448)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:107)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:107)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n\tat org.apache.velocity.Template.merge(Template.java:254)\n\tat de.his.servlet.util.ServletUtil.parseWithVelocity(ServletUtil.java:736)\n\tat de.his.servlet.util.ServletUtil.sendResponseWithVelocity(ServletUtil.java:684)\n\tat de.his.servlet.HISServletModuleImpl.handleRequest(HISServletModuleImpl.java:637)\n\tat de.his.servlet.RequestDispatcherServlet.invoke(RequestDispatcherServlet.java:908)\n\tat de.his.servlet.RequestDispatcherServlet.handleRequest(RequestDispatcherServlet.java:843)\n\tat de.his.servlet.RequestDispatcherServlet.doGet(RequestDispatcherServlet.java:1060)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:868)\n\tat org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:663)\n\tat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n\tat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n\tat java.lang.Thread.run(Thread.java:595)\n\n", "created_at" : { "$date" : "2007-08-15T09:14:52.196+0000" }, "updated_at" : { "$date" : "2007-08-23T13:51:00.457+0000" }, "creator_id" : { "$oid" : "5b7d3632e9214a0d1608d6e7" }, "reporter_id" : { "$oid" : "5b7d3632e9214a0d1608d6e7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Integreated in Tomcat on Ubuntu Linux \nJDK version: 1.5.0_08-b03" },
{ "_id" : { "$oid" : "5b904d8c5f627d84c8d6b5a7" }, "external_id" : "VELOCITY-277", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "macros in #parsed files are not refreshed when including page is refreshed", "desc" : "If a template #parses a file containing velocimacros, changes those macros do \nnot make it into the including template.  This is true whether the file is \nincluded via the library property or via #parse.\n\nAlthough there is the velocimacro.library.autoreload property, it is \"not for \nuse in production\" according to the documentation - and cannot be used with \ntemplate caching.\n\nAlso, often, macros included via #parse do not pick up their macros the first \ntime they are compiiled.  And with template caching they are only ever called \nonce, this leads to situations where changes in templates that include macros \nand are cached do not function in production.", "created_at" : { "$date" : "2004-07-08T02:59:13.000+0000" }, "updated_at" : { "$date" : "2007-08-24T04:14:15.092+0000" }, "creator_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "reporter_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d6a5f627d84c8d6b310" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d8d5f627d84c8d6b5c7" }, "external_id" : "VELOCITY-146", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macros not evaluated on the first attempt with #parse", "desc" : "I have noticed that sometimes macros do not get evaluated after Velocity has \njust been started. A subsequent request for the same resource produces a valid \ndocument, where macros are now correctly evaluated.\n\nHere's an example: I have a WAP-Mail webapp, which runs on Tomcat 3.3a. It uses \nVelocity to render the content, and the Velocity versions I have used are 1.2-\ndep, 1.3-dep and 1.3.1-dep. This problem occurs with all of these versions.\n\nThe first request should produce a message list (there's an autologin feature, \nso the message list page is the first one being accessed). Here's the most \nrelevant part of the content:\n\n------------------------------------------------------------------------------\n\n    <p>Folder: INBOX<br/></p>\n\n      <p>\n      <br/><b>Date: 05.03 11:16</b>\n      <br/>Sender: John Doe\n      <br/>Subject: <a href=\"/wapmail/message/show/", "created_at" : { "$date" : "2003-03-05T19:49:34.000+0000" }, "updated_at" : { "$date" : "2007-08-24T04:17:40.035+0000" }, "creator_id" : { "$oid" : "5b7d3634e9214a0d1608d6ea" }, "reporter_id" : { "$oid" : "5b7d3634e9214a0d1608d6ea" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d8e5f627d84c8d6b5e4" }, "external_id" : "VELOCITY-536", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Engine throws NullPointer Exception when two people click on the same page at the same time for the first time", "desc" : "Multi-thread concurrency issue\n\nDuring our concurrency testing, we observed NullPointer exceptions being thrown when two people hit the same page at the same time for the first time. Upon further investigation, it turns out that we need to synchronize the init method on ASTDirective, ASTSetDirective, and render method on ASTSetDirective, and VelocimacroProxy.\n\n Basically, the problem is introduced as the following; when two threads attempts to parse and render the same template at the same time. Thread1 finishes parsing first and proceeds to the render method call, while thread 2 is still busy parsing and will overwrite the existing parse tree that is being used by thread 1 for rendering purpose. Thus under certainly condition a NullPointer exception will be thrown. ", "created_at" : { "$date" : "2007-04-02T14:42:54.182+0000" }, "updated_at" : { "$date" : "2007-08-24T05:08:11.847+0000" }, "creator_id" : { "$oid" : "5b7d3635e9214a0d1608d6eb" }, "reporter_id" : { "$oid" : "5b7d3635e9214a0d1608d6eb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d8f5f627d84c8d6b5fe" }, "external_id" : "VELOCITY-556", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Another concurrency issue with macros", "desc" : "The symptom is similar to\nhttps://issues.apache.org/jira/browse/VELOCITY-514 and\nhttps://issues.apache.org/jira/browse/VELOCITY-24\n\n- the 'Null AST' errors show up in the logs under concurrency. \nThe issue is different however. First, unlike those two, this one only happens when the macro caching is ON (at least, I was never able to reproduce it with the cache off), and second, the issue only appears when there is a macro call from inside a macro. Like this:\n#macro A() A #end\n#macro AB() #A()B#end\n\nI have debugged this problem, and came up with this fix. I replaced Velocimacro.class file in velocity-1.5.jar with the one I compiled with my fix, and have been running it in production evironment for a while. It does indeed seem to have fixed the problem.\nPlease feel free to use this fix if you like it.\n\n--- org/apache/velocity/runtime/directive/VelocimacroProxy.orig 2007-06-08 19:21:19.000000000 -0400\n+++ org/apache/velocity/runtime/directive/VelocimacroProxy.java 2007-06-08 19:22:10.000000000 -0400\n@@ -164,11 +164,14 @@\n\n             if (nodeTree != null)\n             {\n+                synchronized (this)\n+                {\n                 if ( !init )\n                 {\n                     nodeTree.init( context, rsvc);\n                     init = true;\n                 }\n+                }\n\n                 /*\n                  *  wrap the current context and add the VMProxyArg objects\n\n-- Dima", "created_at" : { "$date" : "2007-06-20T22:02:36.622+0000" }, "updated_at" : { "$date" : "2007-08-24T05:08:23.871+0000" }, "creator_id" : { "$oid" : "5b7d3636e9214a0d1608d6ed" }, "reporter_id" : { "$oid" : "5b7d3636e9214a0d1608d6ed" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d8f5f627d84c8d6b607" }, "external_id" : "VELOCITY-564", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Give ability to reinitialize Velocity", "desc" : "I have an eclipse plugin that use Velocity as a code generation tool.\nDuring the generation of a project I intialize velocity by using Velocity.init(Properties).\nWhen I try to generate another project with different velocity properties (i.e. different language used for javadoc generation), that initialization was ignored by velocity. The only solution is to close and restart eclipse.\n\nIt is possible to have a reinit(Properties) method or ability to set the isInitialized attribute to false ?\n\nThanks and Regards.", "created_at" : { "$date" : "2007-09-04T10:01:03.359+0000" }, "updated_at" : { "$date" : "2007-09-04T14:35:09.822+0000" }, "creator_id" : { "$oid" : "5b7d3637e9214a0d1608d6ee" }, "reporter_id" : { "$oid" : "5b7d3637e9214a0d1608d6ee" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d905f627d84c8d6b60e" }, "external_id" : "VELOCITY-50", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RFE: invalid parameters for #if directive should be a parse error?", "desc" : "The 3 lines below will print two No-s and one Yes:\n  #if('foo') Yes #else No #end\n  #if(1) Yes #else \nNo #end\n  #if(true) Yes #else No #end\n\nwhile the 4 lines bellow will print two Yes-es as \nexpected:\n  #set($x = 'foo')\n  #if($x) Yes #else No #end\n  #set($x = 1)\n  #if($x) Yes #else No \n#end\n\nAlso, the 2 lines below will print false:\n  #set($x = 'x' && true)\n  $x\n\n(Please \nignore possible false line breaks inserted by bugzilla.)\n\nTried with 1.2 Stable and 1.3 \nNightly 22/03", "created_at" : { "$date" : "2002-03-23T17:48:20.000+0000" }, "updated_at" : { "$date" : "2007-09-18T04:48:41.477+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904d915f627d84c8d6b621" }, "external_id" : "VELOCITY-379", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "foreach should generalise for Iterable, not just Collection", "desc" : "As of Java 1.5 the java.lang.Iterable interface is the general contract that\nshould be used when looking for things that provide Iterators. This allows for\nuser defined non collection types to be generally usable by things that just\nneed iteration such as the Java Language's for(X x : y) looping construct and\nseems perfectly applicable to the velocity Foreach directive. \nI'm not sure of the versioning policy (which java version) of Velocity so if you\nare deliberately not creating a 1.5 dependency then this is not a bug.", "created_at" : { "$date" : "2005-05-15T19:56:22.000+0000" }, "updated_at" : { "$date" : "2007-09-25T18:05:40.776+0000" }, "creator_id" : { "$oid" : "5b7d363ae9214a0d1608d6f0" }, "reporter_id" : { "$oid" : "5b7d363ae9214a0d1608d6f0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d915f627d84c8d6b638" }, "external_id" : "VELOCITY-533", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Treat arrays like fixed-length lists", "desc" : "I'd like to see arrays treated like fixed-length List objects as much as possible.  This means auto-magically supporting size(), set(int,Object), get(int), and isEmpty() at a minimum.  Support for something like iterator() probably isn't necessary, since #foreach already handles arrays, but it might be good for completeness.  These should be possible via some Uberspect hackery.\n\nAnd since the goal is to free template authors from having to care about the differences between Lists and arrays, we might also consider supporting conversion between the two for method calls, so:\n\n$foo.wantsListHere($thisisAnArray)\n\nand\n\n$bar.wantsArrayHere($thisisAList)\n\nboth work automatically.   I haven't yet looked into what it would take to do this.   If it is too hard or messy, i could be happy with just support for calling List methods on arrays.", "created_at" : { "$date" : "2007-03-26T17:16:58.165+0000" }, "updated_at" : { "$date" : "2007-09-25T20:59:56.538+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904cf65f627d84c8d6a9fc" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b904d925f627d84c8d6b645" }, "external_id" : "VELOCITY-565", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "EvaluateContext does not take account of inner.localContext", "desc" : "the following vtl does not render what is, IMHO, expected :\n\n#macro(testEval $expr)\n\n    #foreach($value in [\"val1\", \"val2\"])\n        value is : #evaluate( $expr )\n    #end\n#end\n\n#testEval( \"${value}\" )\n\nrenders :\n\nvalue is : ${value}\nvalue is : ${value}\n\nThe reason is that EvaluateContext ctor assigns 'inner.getBaseContext()'\nto instance variable 'innerContext', and getBaseContext() does not\nreturn VMContext localContext refs (of the #foreach directive).\n\nChanging the EvaluateContext ctor so that 'innerContext' is set to\n'inner' allow velocity to render the right result :\n\nvalue is : val1\nvalue is : val2\n\nBut I'm not sure this would be a correct fix, should the VMContext\nreturn all current refs ? Could you tell me what the normal behavior is\nand what is the way all that stuff sould work ?\n\nEtienne Massip\n\n", "created_at" : { "$date" : "2007-09-17T07:06:16.012+0000" }, "updated_at" : { "$date" : "2007-10-06T23:44:42.393+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d935f627d84c8d6b656" }, "external_id" : "VELOCITY-443", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.4 does not support Iterable collections.", "desc" : "In the new for loop in Java 5 e.g.\n\nfor(Object obj: iterable)\n\nthe collection iterated only needs to be of type Iterable\n\nHowever, In Velocity a foreach loop must be either a Collection or a Map but cannot be just an Iterable.\n\nSuggestion, support Iterable containers.", "created_at" : { "$date" : "2006-06-09T16:56:14.000+0000" }, "updated_at" : { "$date" : "2007-10-09T15:36:20.465+0000" }, "creator_id" : { "$oid" : "5b7d363de9214a0d1608d6f4" }, "reporter_id" : { "$oid" : "5b7d363de9214a0d1608d6f4" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_links" : [  ], "environment" : "Java 5" },
{ "_id" : { "$oid" : "5b904d935f627d84c8d6b66c" }, "external_id" : "VELOCITY-568", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Value of String Array[] not obtained in vm file when calling a method in a Java class running against jre v1.5 update 12", "desc" : "The below mentioned issue is being faced after upgrading jdk/jre from v1.4.2 update 13 to v1.5 update 12.\n\nThe value of a String Array is not obtained in the .vm file when calling a method in a Java class running against jre v1.5 update 12. The vm file is calling the java method using SOAP service. The String Array contains values at the java class level, however, when the array is returned to the vm file, it is obtained as null.\n\nThe same method works fine when tested with jdk/jre 1.4.2 update 13.\n\nPlease provide inputs on this issue urgently, as it is affecting the working of my application.\n\nThanks.", "created_at" : { "$date" : "2007-10-24T05:59:30.069+0000" }, "updated_at" : { "$date" : "2007-10-24T15:29:03.555+0000" }, "creator_id" : { "$oid" : "5b7d3644e9214a0d1608d6f5" }, "reporter_id" : { "$oid" : "5b7d3644e9214a0d1608d6f5" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "1.3.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "OS: Windows XP\nS/w Platform: Jdk/Jre v1.5 update 12, Phoenix 4.0.2, Jetty, " },
{ "_id" : { "$oid" : "5b904d945f627d84c8d6b676" }, "external_id" : "VELOCITY-569", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problem using the backslash ( \\ ) character for \"double quote\"", "desc" : "i want to set the value of variable to a string value include \"double quote\", the statement is as following:\n\n#set ($opt = \" onchange=\\\"javascript:changeTaxType(this.value, 'sales2product_tax_type_$criterion')\\\"\")\n\nI expect the string value is:\n\nonchange=\"javascript:changeTaxType(this.value, 'sales2product_tax_type_$criterion')\"\n\nbut the actual value is:\n\nonchange=\\\"javascript:changeTaxType(this.value, 'sales2product_tax_type_1')\\\"\n\nthe backslash character is not removed from the string, it cause javascript to fail.\n\nAny suggestion on how to resolve this problem?", "created_at" : { "$date" : "2007-11-02T16:05:22.624+0000" }, "updated_at" : { "$date" : "2007-11-02T21:12:46.907+0000" }, "creator_id" : { "$oid" : "5b7d3645e9214a0d1608d6f6" }, "reporter_id" : { "$oid" : "5b7d3645e9214a0d1608d6f6" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "windows server 2003, tomcat 6 jdk1.6.0_03" },
{ "_id" : { "$oid" : "5b904d955f627d84c8d6b67d" }, "external_id" : "VELOCITY-577", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "reload template by programming", "desc" : "Dear developers\nI have a problem when using VelocityEngine to merge template. I want to reload template when i merge it with context every times. but VelocityEngine just merge the cached template for the first time.\nI dont know anyway to do this.\nSo you can help me. and show me the way to reload template by programming.\n\nPS: I put template files in classpath, and i set no cache when init VelocityEngine.\n\nThanks.", "created_at" : { "$date" : "2007-12-12T06:57:21.893+0000" }, "updated_at" : { "$date" : "2007-12-12T16:18:23.796+0000" }, "creator_id" : { "$oid" : "5b7d3646e9214a0d1608d6f7" }, "reporter_id" : { "$oid" : "5b7d3646e9214a0d1608d6f7" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d955f627d84c8d6b684" }, "external_id" : "VELOCITY-566", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "EmptyStackException when rendering macros simultaneously", "desc" : "When two threads are running VelocimacroFactory.startRenderingMacro() simultaneously (same template), both check that templateMap is empty, then both create a new stack, then the second thread put it in templateMap, replacing the one added by the first thread.\n\nAt this time we got a stack which size == 1 instead of 2.\n\nThen both threads endProcessingMacros(), both get stack from templateMap and check that its size is > 0, first one empty stack then second pop() macro and gets an EmptyStackException.\n\nbehavior was introduced by improvement VELOCITY-297.\n\npatch is joined, synchronize(templateMap) in VelocimacroFactory.startRenderingMacro().", "created_at" : { "$date" : "2007-10-10T09:59:46.868+0000" }, "updated_at" : { "$date" : "2007-12-12T16:24:54.441+0000" }, "creator_id" : { "$oid" : "5b7d363de9214a0d1608d6f3" }, "reporter_id" : { "$oid" : "5b7d363de9214a0d1608d6f3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d965f627d84c8d6b68f" }, "external_id" : "VELOCITY-578", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityEngine.mergeTemplate without the encoding parameter has incorrect javadoc for the deprecated flag", "desc" : "see http://velocity.apache.org/engine/releases/velocity-1.5/apidocs/org/apache/velocity/app/VelocityEngine.html#mergeTemplate(java.lang.String,%20org.apache.velocity.context.Context,%20java.io.Writer)\n\nseems like there is an additional * that prevent the method to be marked as deprecated in the javadoc ", "created_at" : { "$date" : "2007-12-17T08:35:00.397+0000" }, "updated_at" : { "$date" : "2007-12-17T16:45:54.665+0000" }, "creator_id" : { "$oid" : "5b7d3648e9214a0d1608d6f8" }, "reporter_id" : { "$oid" : "5b7d3648e9214a0d1608d6f8" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d975f627d84c8d6b698" }, "external_id" : "VELOCITY-582", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow invocation of public methods in non-public classes", "desc" : "I was tempted to log this as a bug, however according to this comment it's a feature:\n\nhttps://issues.apache.org/jira/browse/VELOCITY-214?focusedCommentId=12323932#action_12323932\n\nIn any case, Velocity's requirement for all called methods to be in public classes forces developers to violate proper OO encapsulation by exposing implementation details. For example, consider this interface:\n\n  public interface Foo {\n    int getFooCount();\n  }\n\nAnd a non-public implementation:\n\n  class FooImpl implements Foo {\n    public int getFooCount() {\n      return 0;\n    }\n  }\n\nAnd a provider of Foo instances (in the same package as FooImpl):\n\npublic class FooService {\n  public Foo getFoo() {\n    return new FooImpl();     // only this class should know what type of Foo is being created\n  }\n}\n\nThis is good OO code as it stands, however Velocity forces us to make FooImpl a public class. Although this allows Velocity to work properly, it also allows all other classes in the application to access the FooImpl class for themselves, creating the risk of excessive coupling and diluting the benefit of using interfaces in the first place.\n\nThis wouldn't be so bad in a new project, but in my existing Velocity-based enterprise application of over 3000 classes, I can't be sure which of these can be properly non-public and which have to be made public just for Velocity's sake. In other words, there's no way to work out which ones might be (or might end up being) invoked by a template (particularly given that many of them are properly hidden behind interfaces). This means I'm not at liberty to refactor my code in the interests of proper encapsulation, because I run the risk of breaking a Velocity template. To me this is a big cross against Velocity, and if we weren't already using it heavily, I'd switch to an alternative templating tool. So any priority or importance that can be assigned to this issue would be greatly appreciated.", "created_at" : { "$date" : "2008-01-22T04:06:19.996+0000" }, "updated_at" : { "$date" : "2008-01-22T05:28:24.638+0000" }, "creator_id" : { "$oid" : "5b7d3649e9214a0d1608d6f9" }, "reporter_id" : { "$oid" : "5b7d3649e9214a0d1608d6f9" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Any" },
{ "_id" : { "$oid" : "5b904d975f627d84c8d6b6a1" }, "external_id" : "VELOCITY-593", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove class map from FieldMethodizer", "desc" : "According to the API docs of {{[Field.get()|http://java.sun.com/javase/6/docs/api/java/lang/reflect/Field.html#get(java.lang.Object)]}}:\nbq. If the underlying field is a static field, the obj argument is ignored; it may be null.\nSo there is no need to waste memory on keeping a class map (besides, if one needs to know the class defining a field, there is {{Field.getDeclaringClass()}}).", "created_at" : { "$date" : "2008-05-01T12:31:44.545+0000" }, "updated_at" : { "$date" : "2008-05-02T03:58:05.720+0000" }, "creator_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "reporter_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d985f627d84c8d6b6ab" }, "external_id" : "VELOCITY-24", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "calls to local macros not always made when template caching is off", "desc" : "In the latest nightly build Oct 28, 2001 and also in velocity 1.2 rc2 i noticed \nthe following problem with autoreloading macros.\n\nMade a simple html page. added a simple one line macro that accepted one param, \na letter\nsomething like....\n\n## local macro, not global\n#macro(letter $char)\n    This is the letter $char\n#end\n\n#letter(\"A\")\n#letter(\"B\")\n#letter(\"C\")\n\netc.... to Z\n\n------\nThe html page would be loaded in response to a form being submitted. If I \nclicked on the submit button five times, quickly ( five separate submits), most \ntimes the final response would out put something like...\n----\n\nThis is the letter A\nThis is the letter B\nThis is the letter C\nThis is the letter D\nThis is the letter E\n#letter    #letter    #letter \n#letter ......\nThis is the letter Z\n\nAs you can see, some macro calls did not get parsed.\n\nWe were just happening to use velocity through turbine, but I don't think that \naffects the bug. Besides, the bug went away when the autoreload was false.\n\nOnce scarab's runbox is back up, might be interesting to test this out on their \nmacros too for comparison, although I don't see that they have any local macros.", "created_at" : { "$date" : "2001-10-29T02:28:20.000+0000" }, "updated_at" : { "$date" : "2008-06-10T18:46:00.324+0000" }, "creator_id" : { "$oid" : "5b7d364be9214a0d1608d6fb" }, "reporter_id" : { "$oid" : "5b7d364be9214a0d1608d6fb" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904d985f627d84c8d6b6aa" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904d995f627d84c8d6b6cc" }, "external_id" : "VELOCITY-580", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Multi line comments simply don't work inside a macro", "desc" : "This very simple macro: \n\n#macro(tabSection_begin $sectionTitle)\na\n#*\n\ntest \n\n*#\nb\n#end\n\n\nproduces : \n\na *# b\n\n(notice the presence of the end of comment \"*#\" in the result !)\n\nThis worked as intended in 1.3.1.\n\n", "created_at" : { "$date" : "2007-12-18T13:30:19.898+0000" }, "updated_at" : { "$date" : "2008-07-08T06:13:47.339+0000" }, "creator_id" : { "$oid" : "5b7d365de9214a0d1608d6fd" }, "reporter_id" : { "$oid" : "5b7d365de9214a0d1608d6fd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d995f627d84c8d6b6cb" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b904d995f627d84c8d6b6cb" }, "external_id" : "VELOCITY-537", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d995f627d84c8d6b6cc" }, "effect" : "incorporates", "type" : "Incorporates" } ], "creator_id" : { "$oid" : "5b7d3660e9214a0d1608d6fe" }, "desc" : "Moving from velocity engine 1.4 to 1.5, one of my macros is now causing a ParseException:\n\n#macro( makeLink $filepath )#*\n\n    *##if ($request.serverName.equalsIgnoreCase(\"www.liveserver.com\") || $request.serverName.equalsIgnoreCase(\"liveserver.com\"))#*\n\n        *##set($mirrorDomain = \"livemirror.com\")#*\n\n    *##elseif($request.serverName.equalsIgnoreCase(\"stagingserver.com\"))#*\n\n        *##set($mirrorDomain = \"stagingmirror.com\")#*\n\n    *##elseif($request.serverName.equalsIgnoreCase(\"devserver.com\") || $request.serverName.equalsIgnoreCase(\"localhost\"))#*\n\n        *##set($mirrorDomain = \"devmirror.com\")#*\n\n    *##else#*\n\n        *##set($mirrorDomain = \"liveserver.com\")#*\n\n    *##end#*\n\n    *#http://${mirrorDomain}${filepath}#*\n\n*##end\n\nThis macro uses the mutli-line comment hack to gobble whitespace (so that none appears in the link text, whilst preserving some kind of readability.\n\nThis works fine in 1.4, but throws a ParseException in 1.5 (stacktrace below)\n\n-- stacktrace --\n\n2007-04-03 16:05:38,712 - VelocimacroManager.parseTree() : exception makeLink\norg.apache.velocity.runtime.parser.ParseException: Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 1, column 535.  Encountered: <EOF> after : \"\"\n\tat org.apache.velocity.runtime.parser.Parser.parse(Parser.java:124)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:1042)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.parseTree(VelocimacroProxy.java:342)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.setupMacro(VelocimacroProxy.java:322)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.init(VelocimacroProxy.java:309)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.init(ASTDirective.java:134)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.init(SimpleNode.java:285)\n\tat org.apache.velocity.Template.initDocument(Template.java:199)\n\tat org.apache.velocity.Template.process(Template.java:121)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:415)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:335)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1102)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1077)\n\tat org.apache.velocity.app.VelocityEngine.getTemplate(VelocityEngine.java:528)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.getTemplate(VelocityViewServlet.java:667)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.handleRequest(VelocityViewServlet.java:601)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doRequest(VelocityViewServlet.java:541)\n\tat org.apache.velocity.tools.view.servlet.VelocityViewServlet.doGet(VelocityViewServlet.java:507)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n\tat org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n\tat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n\tat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n\tat java.lang.Thread.run(Thread.java:595)", "reporter_id" : { "$oid" : "5b7d3660e9214a0d1608d6fe" }, "title" : "Multi-line comments causing ParseException in macros in Velocity engine 1.5", "priority" : "Major", "status" : "Resolved", "updated_at" : { "$date" : "2008-07-08T15:04:05.677+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "created_at" : { "$date" : "2007-04-03T16:57:40.100+0000" } },
{ "_id" : { "$oid" : "5b904d9a5f627d84c8d6b6fa" }, "external_id" : "VELOCITY-594", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "null-values cannot be set in macros", "desc" : "There is an issue with the new supported feature of assigning null-values to velocity variables. The following scenarios illustrate the error. The configuration parameter \"directive.set.null.allowed\" must be set to \"true\".\n\nScenario 1 (correct behaviour outside macro):\n\n#set ($test = \"test\")\n$test\n#set ($test = $null)\n$test\n\nyields to the output:\n\ntest\n$test\n\nScenario 2 (erroneous behaviour using macro):\n\n#macro (test)\n    #set ($test = \"test\")\n    $test\n    #set ($test = $null)\n    $test\n#end\n\n#test()\n\nyields to the output:\n\ntest\ntest\n\nand the varibale test has not been resetted to null which is the error.\n", "created_at" : { "$date" : "2008-05-08T13:32:21.767+0000" }, "updated_at" : { "$date" : "2008-07-13T18:23:58.582+0000" }, "creator_id" : { "$oid" : "5b7d3662e9214a0d1608d704" }, "reporter_id" : { "$oid" : "5b7d3662e9214a0d1608d704" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows XP SP2\n" },
{ "_id" : { "$oid" : "5b904d9b5f627d84c8d6b707" }, "external_id" : "VELOCITY-591", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#evaluate directive is wiping out macros", "desc" : "I think I've found a problem with the new #evaluate directive in 1.6.  It seems like a call to #evaluate is causing the macros that have already been defined to be cleared.  Here is a test template to demonstrate:\n\n#macro (test $t)\n  test: #evaluate($t)\n#end\n\n#macro (test2 $t)\n  test2: #evaluate($t)\n#end\n\n#evaluate(\"Will Clear Macros\")\n\n#test(\"hi world 1\")\n#test2(\"hi world 2\")\n\n\n-------------------------------\n\nMy overall major goal is to have a template be able to render other VTL that is pulled from objects.  The problem with the RenderTool is that it doesn't share the same macros as the parent.  That's why I'm trying to go down the route of using the new #evaluate directive since in theory both the macro and context are shared.\n", "created_at" : { "$date" : "2008-04-01T15:05:46.562+0000" }, "updated_at" : { "$date" : "2008-07-13T20:08:36.668+0000" }, "creator_id" : { "$oid" : "5b7d3665e9214a0d1608d705" }, "reporter_id" : { "$oid" : "5b7d3665e9214a0d1608d705" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "JDK 1.5" },
{ "_id" : { "$oid" : "5b904d9c5f627d84c8d6b70f" }, "external_id" : "VELOCITY-223", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VMs that use a large number of directives and macros use excessive amounts of memory - over 4-6MB RAM per form", "desc" : "Our application FinanceCenter is based on Velocity as the template engine.  We \nhave a library of about 200 macros and about 400 VM files.  Because the \nvelocity parser copies the macro body into the VM during parsing, macros that \nare frequently used (even though identical and using local contexts) use up \nlarge amounts of memory.  On our Linux server (running Redhat 7.2 with Sun JDK \n1.4.1_04) we can easily use up over 1GB of RAM simply by opening up many forms \n(about 150) - the server starts out using 60MB after startup.  This memory \ntimes out after 5 minutes and is returned which tells me that it is screen \nmemory.  Our problem is that the NT JVM and Linux JVM (32 bit) are currently \nlimited to about 1.6 - 2.0 GB of ram for heap space.  Thus, using a fair number \nof forms in the application leaves little space for user session data.\n\nWe have implemented a caching mechanism for compiled templates and integrated \nit into Velocity so that cached objects are timed out of the cache but the \nserver is still using large amounts of memory.  We finally had to rewrite many \nof our macros into Java so that memory usage would be reduced (note that these \nmacros were doing complex screen formatting not business logic).  Doing this \nhas reduced our memory by about 30%.  This is currently our biggest issue with \nVelocity and is causing us to review our decision to stay with Velocity going \nforward.  This is because we will likely end up with close to 1,000 forms by \nthe end of next year and need to know that Velocity can deal with this.  Is \nthere any work underway to share compiled macro AST's?  This would greatly \nreduce the amount of memory used.  I have reviewed the parser code that is \ndoing this but it seems that this is an embedded part of the design and not \neasily changed.", "created_at" : { "$date" : "2003-11-04T15:01:43.000+0000" }, "updated_at" : { "$date" : "2008-07-13T23:03:56.849+0000" }, "creator_id" : { "$oid" : "5b7d3666e9214a0d1608d706" }, "reporter_id" : { "$oid" : "5b7d3666e9214a0d1608d706" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904d9d5f627d84c8d6b734" }, "external_id" : "VELOCITY-605", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity tools / Message Tool - ambiguous method invocation with latest SVN head (1.6)", "desc" : "I compiled the latest SVN head of Velocity today. Template memory consumption has gone down a lot. Great work!\n\nHowever, I noticed that i18n string in my templates don't work anymore.\n\nI have a properties file with:\ntoolbar.loggedin=Logged in as <b>{0}</b>\n\nin the toolbox.xml:\n\n  <tool>\n     <key>msg</key>\n     <scope>request</scope>\n     <class>\n       org.apache.velocity.tools.struts.MessageTool\n     </class>\n  </tool>\n\n\nIn the template file I have a string:\n$msg.toolbar.loggedin.insert(\"joe\")\n\nThis works with Velocity 1.5 and Velocity tools 1.4 fine but with latest SVN head build the velocity.log shows:\n\nIntrospection Error : Ambiguous method invocation insert(java.lang.String) for class class org.apache.velocity.tools.struts.MessageTool$TextKey\n\nand the message isn't rendered at all.\n\nAny idea what's wrong?", "created_at" : { "$date" : "2008-07-14T18:13:20.531+0000" }, "updated_at" : { "$date" : "2008-07-14T21:17:16.601+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904d985f627d84c8d6b6aa" }, "external_id" : "VELOCITY-595", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d985f627d84c8d6b6ab" }, "effect" : "is related to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d366ae9214a0d1608d709" }, "desc" : "The ResourceManagerImpl.getResource() method is synchronized, which makes it difficult to share a Velocity Runtime between threads in an environment such as a j2ee web application.\n\nAfter upgrading Velocity to version 1.5 in Roller and running some performance tests I saw a very noticeable decrease in throughput for the application.  I fired up jconsole and noticed that almost all of my app server threads were in a BLOCKED state and were waiting on the ResourceManagerImpl.getResource() method.\n\nIn my particular case the difference resulted in a loss of 2/3 of my original ops/sec, which is pretty huge.  After simply switching Velocity back to the 1.4 release and rerunning the test I saw the results I expected.\n\nI assume this is overactive use of Java synchronization because the developer guide suggests that the singleton model is \"very appropriate model for use in a Servlet 2.2+ compliant web application\".\n\n\n", "reporter_id" : { "$oid" : "5b7d366ae9214a0d1608d709" }, "title" : "ResourceManagerImpl.getResource() causes locking issues", "priority" : "Major", "status" : "Resolved", "environment" : "jdk 1.5", "updated_at" : { "$date" : "2008-07-25T22:51:03.202+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2008-05-15T22:46:16.988+0000" } },
{ "_id" : { "$oid" : "5b904d9e5f627d84c8d6b74e" }, "external_id" : "VELOCITY-606", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.5 performance bottlenecks", "desc" : "I did some quite extensive profiling to identify performance bottlenecks in Velocity 1.5.\n\nUsing Maven 2, JUnitPerf and JRat I was able to identify these methods as top bottlenecks:\n\norg.apache.velocity.util.introspection\tClassMap - findMethod(String,Object[])\norg.apache.velocity.util.introspection\tIntrospectorBase - getMethod(Class,String,Object[])\norg.apache.velocity.runtime.parser.node\tSimpleNode - literal()\norg.apache.velocity.runtime.parser.node\tSimpleNode - render(InternalContextAdapter,Writer)\norg.apache.commons.collections\tExtendedProperties - getBoolean(String,boolean)\norg.apache.velocity.runtime.parser.node\tASTReference - render(InternalContextAdapter,Writer)\n\nThe first two eat over 50% of the CPU with many threads. See attached screenshots.\n\nInterestingly enough the synchronized\norg.apache.velocity.runtime\tRuntimeInstance\tgetTemplate(String,String)\n\nisn't a big problem when templates are cached. However, if all resources are not cached it becomes a serious performance bottleneck. ResourceCacheImpl also uses a synchronized map which slows things down.\n\nI think these bottlenecks could be at least made less worse by reducing synchronization by using ConcurrentHashMap and StringBuilder that ship with JDK 1.5. I'm investigating what kind of benefits could be achieved with those.", "created_at" : { "$date" : "2008-07-22T11:49:35.087+0000" }, "updated_at" : { "$date" : "2008-07-29T21:57:27.487+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Win XP, 1 Gb, single core, Maven 2, JUnitPerf, JRat, cached Velocity templates with a ClassLoader" },
{ "_id" : { "$oid" : "5b904d9f5f627d84c8d6b76e" }, "external_id" : "VELOCITY-607", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Runtime macro rendering very slow in Velocity 1.6-dev (679708) compared to 1.5", "desc" : "The following test template (see VELOCITY-24):\n\n## local macro, not global\n#macro(letter $char)\n    This is the letter $char\n#end\n\n#letter(\"A\")\n#letter(\"B\")\n#letter(\"C\")\n#letter(\"D\")\n#letter(\"E\")\n#letter(\"F\")\n#letter(\"G\")\n#letter(\"H\")\n#letter(\"I\")\n#letter(\"J\")\n#letter(\"K\")\n#letter(\"L\")\n#letter(\"M\")\n#letter(\"N\")\n#letter(\"O\")\n#letter(\"P\")\n#letter(\"Q\")\n#letter(\"R\")\n#letter(\"S\")\n#letter(\"T\")\n#letter(\"U\")\n#letter(\"V\")\n#letter(\"W\")\n#letter(\"X\")\n#letter(\"Y\")\n#letter(\"Z\")\n\n---\n\nWorks quickly and correctly with Velocity 1.5 with several concurrent threads. However, 1.6-dev is a LOT slower (even 20x).\n\nThe major performance bottlenecks seem to be:\nRuntimeMacro.render (60% of time)\nVelocimacroFactory.getVelocimacro (20% of time)\n\nWith several threads this test also causes Velocity to throw error(s):\n\norg.apache.velocity.exception.MacroOverflowException: Exceed maximum 20 macro calls. Call Stack:letter->letter->letter->letter->letter\n\tat org.apache.velocity.runtime.VelocimacroFactory.startMacroRendering(VelocimacroFactory.java:179)\n\tat org.apache.velocity.runtime.RuntimeInstance.startMacroRendering(RuntimeInstance.java:1693)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:200)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:230)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:178)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:323)\n\tat org.apache.velocity.Template.merge(Template.java:324)\n\tat org.apache.velocity.Template.merge(Template.java:232)\n\tat org.apache.velocity.test.load.Velocity24Test.testRendering(Velocity24Test.java:51)\n\nThis is related to VELOCITY-297 but the fix doesn't seem work with the new modified macro implementation.\n", "created_at" : { "$date" : "2008-07-25T09:23:38.282+0000" }, "updated_at" : { "$date" : "2008-08-13T06:32:00.351+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Maven 2, JUnit, JUnitPerf, JRat, custom testbench: http://www.iki.fi/wyla/velocity/testbench" },
{ "_id" : { "$oid" : "5b904da05f627d84c8d6b7af" }, "external_id" : "VELOCITY-597", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Javadoc does not seem to have @since markers to show when new features were introduced", "desc" : "Javadoc does not seem to have @since markers to show when new features were introduced.\n\nFor example, StringResourceLoader was introduced in 1.5 according to the changes list, but does not have the marker.\n\nI think it's quite easy to do this - e.g. using clirr ?", "created_at" : { "$date" : "2008-05-23T13:23:13.354+0000" }, "updated_at" : { "$date" : "2008-08-13T23:12:51.201+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da15f627d84c8d6b7ba" }, "external_id" : "VELOCITY-602", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Document  Velocity-533 (Treat arrays like fixed length lists)", "desc" : "Need to document VELOCITY-533 \"Treat arrays like fixed-length lists\" before releasing Velocity 1.6\n\nThis should go in the new user guide in the velocity/docs project", "created_at" : { "$date" : "2008-07-13T23:22:50.014+0000" }, "updated_at" : { "$date" : "2008-08-14T21:24:30.145+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da15f627d84c8d6b7c0" }, "external_id" : "VELOCITY-514", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Rendering a template with inline macro concurrently causes VM error : Null AST", "desc" : "If a template with inline macro is rendered concurrently it prints the following errors in the log:\n\nERROR [velocity] VM #myInlineMacro: error : too few arguments to macro. Wanted 3 got 0\nERROR [velocity] VM error : myInlineMacro. Null AST\n\nand where the expected output of the inline macro is, it has the string values of the arguments passed to the macro in brackets\neg:  \n#myInlineMacro('Arg1' 'arg2' 'arg3')\ngives the following on above error\n(Arg1 arg2 arg3)\n", "created_at" : { "$date" : "2007-02-06T22:56:42.532+0000" }, "updated_at" : { "$date" : "2008-08-15T02:47:16.702+0000" }, "creator_id" : { "$oid" : "5b7d3672e9214a0d1608d70d" }, "reporter_id" : { "$oid" : "5b7d3672e9214a0d1608d70d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4", "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da25f627d84c8d6b7f3" }, "external_id" : "VELOCITY-149", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "allow for deeply nested macro calls", "desc" : "currently, it appears that more than two levels get almost unfeasible.\nsee also http://sourceforge.net/mailarchive/message.php?msg_id=4015929\n\nBeing able to do multi-line string literals or macro arguments is probably a\nrelated idea (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=17803)", "created_at" : { "$date" : "2003-03-08T13:50:57.000+0000" }, "updated_at" : { "$date" : "2008-08-15T02:52:33.358+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904da35f627d84c8d6b80f" }, "external_id" : "VELOCITY-598", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macros within macros are losing the context", "desc" : "consider the following test code:\n\n#foreach($num in [1, 2, 3])\n    from loop body: $num\n    #macro(numMacro)$num (numMacro)#end\n    From Macro: #numMacro()\n#end\n\nit produces correctly:\n\nfrom loop body: 1\nFrom Macro: 1 (numMacro)\nfrom loop body: 2\nFrom Macro: 2 (numMacro)\nfrom loop body: 3\nFrom Macro: 3 (numMacro)\n\n\n\nBut if you wrap this in a macro again, it fails:\n\n#macro(outerMacro)\n    #foreach($num in [1, 2, 3])\n        from loop body: $num\n        #macro(numMacro)$num (numMacro)#end\n        From Macro: #numMacro()\n    #end\n#end\n#outerMacro()\n\noutput:\n\nfrom loop body: 1\nFrom Macro: $num (numMacro)\nfrom loop body: 2\nFrom Macro: $num (numMacro)\nfrom loop body: 3\nFrom Macro: $num (numMacro)\n\nThat seams to be a bug for me, when considereing the settings above.", "created_at" : { "$date" : "2008-05-28T14:03:31.703+0000" }, "updated_at" : { "$date" : "2008-08-15T02:54:56.894+0000" }, "creator_id" : { "$oid" : "5b7d3675e9214a0d1608d710" }, "reporter_id" : { "$oid" : "5b7d3675e9214a0d1608d710" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "velocimacro.permissions.allow.inline.local.scope=true\nvelocimacro.permissions.allow.inline=true\nvelocimacro.context.localscope=false\n(we can not change this!)" },
{ "_id" : { "$oid" : "5b904da45f627d84c8d6b818" }, "external_id" : "VELOCITY-604", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Document: Allow definition of macro's within parsed files", "desc" : "Your documentation at http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html#velocimacro_miscellany has the following snippet -\n\n\"\nVelocimacro Trivia\n-------------------------\nCurrently, Velocimacros must be defined before they are first used in a template. This means that your #macro() declarations should come before using the Velocimacros.\n\nThis is important to remember if you try to #parse() a template containing inline #macro() directives. Because the #parse() happens at runtime, and the parser decides if a VM-looking element in the template is a VM at parsetime, #parse()-ing a set of VM declarations won't work as expected. To get around this, simply use the velocimacro.library facility to have Velocity load your VMs at startup.\n\nIs this likely to change in any forthcoming versions?\n\nThe use case is theme development for Confluence.  It would be nice to be able to share some common macro definitions between a number of templates within a theme (i.e. not inlining). And using the velocimacro.library property isn't really an option because themes are dynamically loaded or unloaded.", "created_at" : { "$date" : "2008-07-14T05:08:04.267+0000" }, "updated_at" : { "$date" : "2008-08-15T03:00:23.656+0000" }, "creator_id" : { "$oid" : "5b7d3678e9214a0d1608d711" }, "reporter_id" : { "$oid" : "5b7d3678e9214a0d1608d711" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da55f627d84c8d6b827" }, "external_id" : "VELOCITY-570", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "speed improvement of the tokenizer", "desc" : "On some large templates (1-4MB) velocity gets very slow. I used JProfiler and found a lot of time is spent in VelocityCharStream.ExpandBuff. It is doing a lot of System.arraycopy.\nThe problem is that the size of the buffer is increased linearly in stead of exponentialy.\nI have made a patch which doubles the size of the buffer in stead of incrementing it with the same value.\nIn my tests and in JProfiler it is shown that a lot less time is spent in ExpandBuff.", "created_at" : { "$date" : "2007-11-16T15:52:32.591+0000" }, "updated_at" : { "$date" : "2008-08-15T18:52:32.548+0000" }, "creator_id" : { "$oid" : "5b7d3679e9214a0d1608d712" }, "reporter_id" : { "$oid" : "5b7d3679e9214a0d1608d712" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5", "1.6", "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Tested on FreeBSD 6.2-STABLE and Linux (Debian Etch) on i386.\nJava: JDK 1.5\n" },
{ "_id" : { "$oid" : "5b904da55f627d84c8d6b840" }, "external_id" : "VELOCITY-455", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error in chapter \"Escaping VTL Directives\" in the User Guide", "desc" : "the manual says\n\nConsider the following case:\n\\#if( $jazz ) \nVyacheslav Ganelin \n\\#end\n\nWhether $jazz is true or false, the output will be\n#if($ jazz ) \nVyacheslav Ganelin \n#end\n\nHowever, since the \\#if is escaped, $jazz will be evaluated, to the output will be\n\n#if(true)\nVyacheslav Ganelin \n#end\n\nor \n\n#if(false)\nVyacheslav Ganelin \n#end\n\nrespectively (depending on the value of $jazz)\n", "created_at" : { "$date" : "2006-08-31T16:23:18.000+0000" }, "updated_at" : { "$date" : "2008-08-15T20:17:16.811+0000" }, "creator_id" : { "$oid" : "5b7d367ce9214a0d1608d714" }, "reporter_id" : { "$oid" : "5b7d367ce9214a0d1608d714" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da65f627d84c8d6b84f" }, "external_id" : "VELOCITY-558", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Allow macros that act as blockDirectives", "desc" : "Currently migrating a web project from Oracle's proprietary UIX to Velocity, I found the limitation that macros are always line directives and cannot ave content somewhat limiting.\n\nI would suggest the following improvement or addition to the macro functionality.\n\nYou should be able to define a blockMacro - maybe with a syntax like this:\n\n#blockmacro(section $title $open)\n<table><th><td>$title</td></th>\n#if($open)\n  #body\n#end\n</table>\n#end\n\nWhere #body would render the body of the macro call. The macro call could look like this:\n\n#section(\"My Collapsible Section\", true)\n<tr><td>sectionContent</td></tr>\n#end\n\nThis allows the macro to render the content only under a certain condition, or it would allow the macro to render the content multiple times. I think this would a lot of flexibilty to macros - it might be an enhancement worth considering for the Summer of Code Google project.\n", "created_at" : { "$date" : "2007-06-22T06:08:03.426+0000" }, "updated_at" : { "$date" : "2008-08-15T20:40:58.552+0000" }, "creator_id" : { "$oid" : "5b7d3630e9214a0d1608d6e6" }, "reporter_id" : { "$oid" : "5b7d3630e9214a0d1608d6e6" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904da65f627d84c8d6b84e" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Windows" },
{ "_id" : { "$oid" : "5b904da65f627d84c8d6b859" }, "external_id" : "VELOCITY-450", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Reduce memory usage for Velocity templates", "desc" : "Hi,\n\nWe are using the velocity templates extensively to\ngenerate HTML reports. Normally our templates size on\nthe Disk is around 20-50kb, when it gets loaded into\nApplication(Tomcat) memory it turns to 3-5MB.\n\nAs of now we have 500 templates, in near future we are\nplanning to increase this to 1500.\n\nAny Idea why this is happening. Any help in this is\nmuch appreciated, as this is becoming a bottleneck for\nthe scalability of our application. \n\nThanks in advance.\n\nRegards,\nCoumar\n", "created_at" : { "$date" : "2006-08-15T11:19:11.000+0000" }, "updated_at" : { "$date" : "2008-08-15T21:35:09.767+0000" }, "creator_id" : { "$oid" : "5b7d367ee9214a0d1608d715" }, "reporter_id" : { "$oid" : "5b7d367ee9214a0d1608d715" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows 2000, Jdk1.4.2, Tomcat4.1.29" },
{ "_id" : { "$oid" : "5b904da75f627d84c8d6b86a" }, "external_id" : "VELOCITY-447", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "add documentation to explain precedence for resolving property", "desc" : "The Velocity user guide is not clear about the precedence for resolving the property of a variable. As in the UberspectImpl.java code, the precedence to resolve a property should be something like in this order:\n\ngetbar()\ngetBar()\nget(\"bar\")\nisBar()\n\nThis information will be very useful to the user. I suggest that this is added to the user guide under the \"Properties\" section.", "created_at" : { "$date" : "2006-07-08T05:26:07.000+0000" }, "updated_at" : { "$date" : "2008-08-15T22:23:32.078+0000" }, "creator_id" : { "$oid" : "5b7d367fe9214a0d1608d717" }, "reporter_id" : { "$oid" : "5b7d367fe9214a0d1608d717" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "environment" : "document" },
{ "_id" : { "$oid" : "5b904da85f627d84c8d6b876" }, "external_id" : "VELOCITY-561", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parse failures occur for cases involving a line comment that contains a multi-line comment.", "desc" : "Created a line (amongst several) which contained the following:\n\n## #* *# ${user\n\nThe source of the problem seems to come from having a multi-line comment follow a \nline comment.  Other character sequences after these comments appear to cause\nother subsequence parer error.\n\nThe above example causes the following parser error:\n\nCaused by: org.apache.velocity.exception.ParseErrorException: Encountered \"\\r\\n\" at line 60, column 16.\nWas expecting one of:\n    \"}\" ...\n    <DOT> ...\n    \n\tat org.apache.velocity.Template.process(Template.java:141)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:423)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:341)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:831)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:813)\n\tat org.apache.velocity.app.VelocityEngine.getTemplate(VelocityEngine.java:470)\n\tat iht.mail.velocity.VelocityEmailTemplateFactory.getTemplate(VelocityEmailTemplateFactory.java:280)\n\t... 2 more", "created_at" : { "$date" : "2007-08-13T07:48:13.625+0000" }, "updated_at" : { "$date" : "2008-08-15T22:35:37.595+0000" }, "creator_id" : { "$oid" : "5b7d3680e9214a0d1608d718" }, "reporter_id" : { "$oid" : "5b7d3680e9214a0d1608d718" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows XP Pro, Velocity 1.4 release which is part of spring-framework-1.2.8 download." },
{ "_id" : { "$oid" : "5b904da85f627d84c8d6b882" }, "external_id" : "VELOCITY-559", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Log4j logging configuration guide is outdated/wrong", "desc" : "http://velocity.apache.org/engine/devel/developer-guide.html#configuring_logging\n\nThe Log4j section still claims that \"category\" is supported, when in reality, all has been switched over to \"logger\".  The docs need to be fixed to only refer to use of the runtime.log.logsystem.log4j.logger property and have all \"category\" stuff excised.", "created_at" : { "$date" : "2007-07-17T17:47:34.275+0000" }, "updated_at" : { "$date" : "2008-08-15T22:36:14.001+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353ee9214a0d1608d673" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904da95f627d84c8d6b88e" }, "external_id" : "VELOCITY-528", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity 1.5 raises errors for templates that ran in 1.4.", "desc" : "Migrated from Velocity 1.4 to 1.5.  I have several templates that ran in 1.4 and now fail in 1.5.  I raised this in the mailing list and Nathan Bubna asked me to file a bug.\n\nThis is probably an error in my template, but 1.4 allowed it to execute without complaints.  I might have been lucky that nothing bad happened.  \n\nExisting templates contain the following.\n\n public $method.returnType $method.name(\n #foreach($param in $parameters)\n    ...\n #end\n\nThe intent here is to emit a java method signature for a method named $method.name .  This works in 1.4.\n\nIn Velocity 1.5, an error is thrown indicating that the #foreach is unexpected.  Velocity 1.5 is expecting a method parameter becuase the variable name is terminated by an open paren.\n\nI fixed the problem by adding curly braces to the template as follows:\n public $method.returnType ${method.name}(\n #foreach($param in $parameters)\n    ...\n #end\n\n\nThis is probably a bug in 1.4, and poor coding practice in my template, but given the fact that it did work and now doesn't, there should be some mention of this \"improvement\" in the 1.5 release notes.", "created_at" : { "$date" : "2007-03-12T21:05:04.540+0000" }, "updated_at" : { "$date" : "2008-08-15T22:36:50.015+0000" }, "creator_id" : { "$oid" : "5b7d3616e9214a0d1608d6dc" }, "reporter_id" : { "$oid" : "5b7d3616e9214a0d1608d6dc" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows XP SP2, JDK 1.5" },
{ "_id" : { "$oid" : "5b904daa5f627d84c8d6b8a1" }, "external_id" : "VELOCITY-563", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VTL reference missing logical operators", "desc" : "\n---------- Forwarded message ----------\nFrom: Sasha Force <sasha.force@alcatel-lucent.com>\nDate: Aug 24, 2007 7:08 AM\nSubject: minor Velocity User Guide error\nTo: dev@velocity.apache.org\n\nHello,\n\nNoticed a minor error in the User Guide (or an omission in the VTL Reference).  From the User Guide:\n\nVelocity has logical AND, OR and NOT operators as well. For further information, please see the VTL Reference Guide\n\nTrouble is, logical operators are not covered in the VTL Reference :).  Want to emphasize, though, that other than that I've found the documentation very clear and very helpful.\n\nCheers,\n\nSasha", "created_at" : { "$date" : "2007-08-24T20:58:44.596+0000" }, "updated_at" : { "$date" : "2008-08-15T22:42:43.566+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904daa5f627d84c8d6b8a8" }, "external_id" : "VELOCITY-552", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Lost $ within literal blocks when not followed by alpha", "desc" : "This is probably the same root cause as #355 (lost #s).\nI was happy to find the #literal() directive in the user guide, because I intend to output SH script from Velocity, which could otherwise get messy. Unfortunately, under certain circumstances, $s are being gobbled.\nConsider this VTL fragment:\n#literal()\nexport $VAR=$(echo $testme)\n#end\n\nRun through evaluate, this spits out\nexport $VAR=(echo $testme)\n\nwhich isn't very literal (and is a compilation fault in SH). Even more odd, \n#literal()\nexport $VAR=\\$(echo $testme)\n#end\n\noutputs\nexport $VAR=\\(echo $testme)\n\nDid some further testing on it, and if the $ isn't followed by alpha, it gets gobbled, but only inside a literal block.", "created_at" : { "$date" : "2007-05-31T22:27:34.132+0000" }, "updated_at" : { "$date" : "2008-08-20T16:46:35.807+0000" }, "creator_id" : { "$oid" : "5b7d3684e9214a0d1608d719" }, "reporter_id" : { "$oid" : "5b7d3684e9214a0d1608d719" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows XP or Solaris, JDK 1.4.2_10" },
{ "_id" : { "$oid" : "5b904dab5f627d84c8d6b8b3" }, "external_id" : "VELOCITY-355", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "lost '#'s inside #literal()/#end", "desc" : "I am using VTL (with VPP) to customize a portion of a Perl script. Since Perl\ncode has a lot of dollar signs, I am using #literal()/#end to prevent Velocity\nfrom processing most of the file.  What I find is that single '#' characters\nthat are not followed by alpha text are removed (inside #literal()/#end).\n\nFor example:\n\n  #literal()\n  #!/usr/bin/perl\n  #end\n\nbecomes:\n\n  !/usr/bin/perl\n\nI've tried things like escaping the '#' ('\\#') but that leaves the backslash\n('\\#!/usr/bin/perl' becomes '\\!/usr/bin/perl').  Nothing seems to work.\n\nI can use a #set to define a variable with the value '#!/usr/bin/perl', but I\nwas hoping I would not have to.  It also doesn't help with other single #'s in\nthe file (like Perl comments).  For those I have had to double up the hashes.\n\nI'd be happy to try patching the Velocity source, but I had trouble making heads\nor tails of the parser engine?", "created_at" : { "$date" : "2005-02-16T02:22:44.000+0000" }, "updated_at" : { "$date" : "2008-08-20T19:31:01.023+0000" }, "creator_id" : { "$oid" : "5b7d3685e9214a0d1608d71a" }, "reporter_id" : { "$oid" : "5b7d3685e9214a0d1608d71a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dac5f627d84c8d6b8ce" }, "external_id" : "VELOCITY-439", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Improve Resource existence detection", "desc" : "Depending on the ResourceLoader used, testing the existence of a resource is \nsomewhat expensive, as the resource has to be opened to test for its existence.\n\nI'm proposing the following changes:\n1.\nAdd a new method to org.apache.velocity.runtime.resource.loader.ResourceLoader:\n    public boolean resourceExists(String source) {\n        InputStream is = null;\n        try {\n            is = resourceLoader.getResourceStream(resourceName);\n            if (is != null) {\n                return true;\n            }\n        } catch (ResourceNotFoundException e) {\n        } finally {\n            if (is != null) {\n                try {\n                    is.close();\n                } catch (Exception e) {\n                }\n            }\n        }\n        return false;\n    }\n\nThis method keeps compatibility with all current ResourceLoaders, and can be overriden by subclasses.\n\n\n2. org.apache.velocity.runtime.resource.ResourceManagerImpl\nModify the String getLoaderNameForResource(String resourceName) method to use\nthe new ResourceLoader.resourceExists(String) method.", "created_at" : { "$date" : "2006-05-12T21:50:20.000+0000" }, "updated_at" : { "$date" : "2008-08-20T21:16:55.827+0000" }, "creator_id" : { "$oid" : "5b7d3686e9214a0d1608d71b" }, "reporter_id" : { "$oid" : "5b7d3686e9214a0d1608d71b" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "1.5", "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dad5f627d84c8d6b8e4" }, "external_id" : "VELOCITY-544", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "BooleanPropertyExecutor refers to primitive boolean not object Boolean", "desc" : "note from Will: not sure if this is an actual bug or just a confusion re: the source.  need to investigate.\n\nan example of a user-visible symptom would be helpful.  see Christopher's note.\n\n---------- Forwarded message ----------\nFrom: Adam Bishop (DSLWN) <AdamB@datacom.co.nz>\nDate: May 3, 2007 10:15 PM\nSubject: BooleanPropertyExecutor bug\nTo: dev@velocity.apache.org\n\ngetMethod().getReturnType() != Boolean.TYPE\n\nreturns true if the method return type is Boolean rather than boolean.\n(i.e. it doesn't like the Boolean class, just the boolean primitive)\n\nthe line should be\n\ngetMethod().getReturnType() != Boolean.TYPE &&\ngetMethod().getReturnType()!=Boolean.class\n\nbug exists in 1.3.1 and 1.5\n\n---------------------------------------------------------------------\nTo unsubscribe, e-mail: dev-unsubscribe@velocity.apache.org\nFor additional commands, e-mail: dev-help@velocity.apache.org\n\n\n\n---------- Forwarded message ----------\nFrom: Christopher Schultz <chris@christopherschultz.net>\nDate: May 4, 2007 9:59 AM\nSubject: Re: BooleanPropertyExecutor bug\nTo: Velocity Developers List <dev@velocity.apache.org>\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nAll,\n\nI haven't looked at the code, but introspection often has special cases\nfor primitive types, whereas their wrapper types (java.lang.Boolean, in\nthis case) are handled generically as Objects.\n\nAre we sure that java.lang.Boolean.class is appropriate to check in this\ncase?\n\nAdam did not provide an example of how to demonstrate the existence of\nthe bug... just an assertion that the code was not sufficient.\n\n- -chris\n", "created_at" : { "$date" : "2007-05-06T15:05:10.680+0000" }, "updated_at" : { "$date" : "2008-08-20T23:20:03.111+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dae5f627d84c8d6b8ed" }, "external_id" : "VELOCITY-592", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Valid getter format not recognized by Engine when attempting to retrieve value.", "desc" : "I was using an class I had created in Eclipse to be parsed into a template Velocity.\nIn eclipse I generated getters and setters for my properties, one of which was a boolean variable named \"isDateImportNeeded\"\n\nThe corresponding getter generated was named \"isDateImportNeeded\", however Velocity was unable to retrieve this value in the template because it can only use getters of the form \"getIsDateImportNeeded\"\n\nBoth are valid JavaBeans specification names, so ideally Velocity would support both versions.\n\nThanks!", "created_at" : { "$date" : "2008-04-25T00:57:15.829+0000" }, "updated_at" : { "$date" : "2008-08-20T23:21:02.956+0000" }, "creator_id" : { "$oid" : "5b7d3689e9214a0d1608d71d" }, "reporter_id" : { "$oid" : "5b7d3689e9214a0d1608d71d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows XP SP2, Java 1.6.0_05" },
{ "_id" : { "$oid" : "5b904daf5f627d84c8d6b8f5" }, "external_id" : "VELOCITY-589", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#${var}_bg not merged correctly", "desc" : "#${id}_bg \n\nmerge it with id = 'test'\n\ndoes not merge correctly to \n\n#test_bg \n\nbut to \n\n#test#bg", "created_at" : { "$date" : "2008-03-07T20:47:28.071+0000" }, "updated_at" : { "$date" : "2008-08-20T23:46:18.092+0000" }, "creator_id" : { "$oid" : "5b7d368be9214a0d1608d71e" }, "reporter_id" : { "$oid" : "5b7d368be9214a0d1608d71e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Windows java 6" },
{ "_id" : { "$oid" : "5b904db05f627d84c8d6b8fe" }, "external_id" : "VELOCITY-227", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ResourceFactory not extensible", "desc" : "The class org.apache.velocity.runtime.resource.ResourceFactory provides\nno mechanism for allowing sub-classes of Template or ContentResources\nto be returned.\n\nSince ResourceManagerImpl makes a call to ResourceFactory.getResource(),\nthe only way to override the behavior is to subclass ResourceManagerImpl\nand cut-paste-then-modify the code for loadResource().\n\nAt the very least, moving the ResourceFactory.getResource() call into\na separate, protected method in ResourceManagerImpl would greatly simplify\nsub-classing Templates and/or ContentResources.", "created_at" : { "$date" : "2003-11-18T01:41:26.000+0000" }, "updated_at" : { "$date" : "2008-08-21T00:16:54.563+0000" }, "creator_id" : { "$oid" : "5b7d3552e9214a0d1608d68c" }, "reporter_id" : { "$oid" : "5b7d3552e9214a0d1608d68c" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904db05f627d84c8d6b916" }, "external_id" : "VELOCITY-585", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update URL Resource Loader to Implement Timeout", "desc" : "Since sometimes URLs can be down, or take forever to load, it's important to be able to implement a timeout for them, to avoid threads hanging forever.\n\nI've hacked the URLResourceLoader, as below, to implement this timeout.  I think it would be wise to add a config param to adjust the timeout for the final version.\n\n\npackage com.qwest.velocity.runtime.resource.loader;\n\n/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.    \n */\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.URL;\nimport java.net.URLConnection;\nimport java.util.HashMap;\n\nimport org.apache.commons.collections.ExtendedProperties;\nimport org.apache.commons.lang.StringUtils;\nimport org.apache.velocity.exception.ResourceNotFoundException;\nimport org.apache.velocity.runtime.resource.Resource;\nimport org.apache.velocity.runtime.resource.loader.ResourceLoader;\n\n/**\n * This is a simple URL-based loader.\n * \n * @author <a href=\"mailto:geirm@apache.org\">Geir Magnusson Jr.</a>\n * @author <a href=\"mailto:nbubna@apache.org\">Nathan Bubna</a>\n * @version $Id: URLResourceLoader.java 191743 2005-06-21 23:22:20Z dlr $\n */\npublic class PortalURLResourceLoader extends ResourceLoader {\n\tprivate String[] roots = null;\n\n\tprotected HashMap templateRoots = null;\n\n\t/**\n\t * @see org.apache.velocity.runtime.resource.loader.ResourceLoader#init(org.apache.commons.collections.ExtendedProperties)\n\t */\n\tpublic void init(ExtendedProperties configuration) {\n\t\trsvc.getLog().debug(\"URLResourceLoader : initialization starting.\");\n\n\t\troots = configuration.getStringArray(\"root\");\n\n\t\tfor (int i = 0; i < roots.length; i++) {\n\t\t\trsvc.getLog().info(\"URLResourceLoader : adding root '\" + roots[i] + \"'\");\n\t\t}\n\n\t\t// init the template paths map\n\t\ttemplateRoots = new HashMap();\n\n\t\trsvc.getLog().debug(\"URLResourceLoader : initialization complete.\");\n\t}\n\n\t/**\n\t * Get an InputStream so that the Runtime can build a template with it.\n\t * \n\t * @param name\n\t *            name of template to fetch bytestream of\n\t * @return InputStream containing the template\n\t * @throws ResourceNotFoundException\n\t *             if template not found in the file template path.\n\t */\n\tpublic synchronized InputStream getResourceStream(String name) throws ResourceNotFoundException {\n\t\tif (StringUtils.isEmpty(name)) {\n\t\t\tthrow new ResourceNotFoundException(\"URLResourceLoader : No template name provided\");\n\t\t}\n\n\t\tInputStream inputStream = null;\n\t\tException exception = null;\n\t\tfor (int i = 0; i < roots.length; i++) {\n\t\t\ttry {\n\t\t\t\tURL u = new URL(roots[i] + name);\n\t\t\t\tURLConnection conn = u.openConnection();\n\t\t\t\tconn.setConnectTimeout(10000);\n\t\t\t\tconn.setReadTimeout(10000);\n\t\t\t\tinputStream = conn.getInputStream();\n\n\t\t\t\tif (inputStream != null) {\n\t\t\t\t\tif (rsvc.getLog().isDebugEnabled()) {\n\t\t\t\t\t\trsvc.getLog().debug(\"URLResourceLoader: Found '\" + name + \"' at '\" + roots[i] + \"'\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// save this root for later re-use\n\t\t\t\t\ttemplateRoots.put(name, roots[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} catch (Exception e) {\n\t\t\t\trsvc.getLog().error(\"URLResourceLoader: Exception when looking for '\" + name + \"' at '\" + roots[i] + \"'\");\n\t\t\t\trsvc.getLog().error(e);\n\n\t\t\t\t// only save the first one for later throwing\n\t\t\t\tif (exception == null) {\n\t\t\t\t\texception = e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// if we never found the template\n\t\tif (inputStream == null) {\n\t\t\tString msg;\n\t\t\tif (exception == null) {\n\t\t\t\tmsg = \"URLResourceLoader : Resource '\" + name + \"' not found.\";\n\t\t\t} else {\n\t\t\t\tmsg = exception.getMessage();\n\t\t\t}\n\t\t\t// convert to a general Velocity ResourceNotFoundException\n\t\t\tthrow new ResourceNotFoundException(msg);\n\t\t}\n\n\t\treturn inputStream;\n\t}\n\n\t/**\n\t * Checks to see if a resource has been deleted, moved or modified.\n\t * \n\t * @param resource\n\t *            Resource The resource to check for modification\n\t * @return boolean True if the resource has been modified, moved, or unreachable\n\t */\n\tpublic boolean isSourceModified(Resource resource) {\n\t\tlong fileLastModified = getLastModified(resource);\n\t\t// if the file is unreachable or otherwise changed\n\t\tif (fileLastModified == 0 || fileLastModified != resource.getLastModified()) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Checks to see when a resource was last modified\n\t * \n\t * @param resource\n\t *            Resource the resource to check\n\t * @return long The time when the resource was last modified or 0 if the file can't be reached\n\t */\n\tpublic long getLastModified(Resource resource) {\n\t\t// get the previously used root\n\t\tString name = resource.getName();\n\t\tString root = (String) templateRoots.get(name);\n\n\t\ttry {\n\t\t\t// get a connection to the URL\n\t\t\tURL u = new URL(root + name);\n\t\t\tURLConnection conn = u.openConnection();\n\t\t\tconn.setConnectTimeout(10000);\n\t\t\tconn.setReadTimeout(10000);\n\t\t\treturn conn.getLastModified();\n\t\t} catch (IOException ioe) {\n\t\t\t// the file is not reachable at its previous address\n\t\t\trsvc.getLog().error(\"URLResourceLoader: '\" + name + \"' is no longer reachable at '\" + root + \"'\");\n\t\t\trsvc.getLog().error(ioe);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n}\n", "created_at" : { "$date" : "2008-01-30T17:22:42.655+0000" }, "updated_at" : { "$date" : "2008-08-21T00:34:33.875+0000" }, "creator_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "reporter_id" : { "$oid" : "5b7d3633e9214a0d1608d6e8" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db15f627d84c8d6b91f" }, "external_id" : "VELOCITY-500", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Having to move Log and LogChute objects around pollutes the C'tors", "desc" : "With most logging implementations like log4j or commons-logging, there is a factory class a method can request a Log object using\n\nLogger log = LogFactory.getLogger(\"some foo\");\n\nand there is no need to drag a log object through C'tors into internal code just because one wants to log.debug() from deep inside Velocity. It would be nice if the LogChute code could also sprout some sort of Log Factory to allow this.", "created_at" : { "$date" : "2006-11-20T21:01:17.000+0000" }, "updated_at" : { "$date" : "2008-08-21T01:24:20.655+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2", "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db25f627d84c8d6b929" }, "external_id" : "VELOCITY-391", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide better syntax for converting XML entities", "desc" : "I'm using velocity to persist my applications data in XML format. The problem is\nwith converting special XML characters to entities.\n\nI have read the developers guide here\nhttp://jakarta.apache.org/velocity/developer-guide.html#Velocity%20and%20XML\n\nI'm wondering if the developers would consider some addition to the velocity\nsyntax to help with this instead. I can't help think that generation of XML must\nbe a common requirement for velocity users and a shortcut syntax would help keep\ntemplates looking neater.\n\nHow about the likes of the following to display a field with automatic\nconversion of XML characters to entities.\n\n<p>The clients name is $&clientName</p>\n\nSo the client name John O'Connor becomes\n\n<p>The clients name is John O&apos;Connor</p>\n\n\nThere are alternatives, such as having a specific file type.\n\ne.g. .xvm as opposed to .vm\n\nA secondary advantage to this is that syntax highlighters could be devised to\nrecognise and highlight both the XML and the template code.", "created_at" : { "$date" : "2005-07-08T19:58:05.000+0000" }, "updated_at" : { "$date" : "2008-08-21T01:48:38.773+0000" }, "creator_id" : { "$oid" : "5b7d3690e9214a0d1608d71f" }, "reporter_id" : { "$oid" : "5b7d3690e9214a0d1608d71f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904db35f627d84c8d6b943" }, "external_id" : "VELOCITY-588", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide a an ubespector that allows chaining other uberspectors", "desc" : "In XWiki project we're using Velocity and have a need to write several uberspectors that we'd like to chain (see http://jira.xwiki.org/jira/browse/XWIKI-2182). We're writing a custom uberspector that'll allow chaining other uberspectors but we think that uberspector should best be located in the Velocity project if you're interested.\n\nLet us know what you think and if you agree we can donate it to you or you could create one from scratch if you agree with the use case.\n\nThanks", "created_at" : { "$date" : "2008-03-06T09:15:53.571+0000" }, "updated_at" : { "$date" : "2008-08-21T13:35:43.523+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db35f627d84c8d6b959" }, "external_id" : "VELOCITY-610", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Under load java.lang.NullPointerException", "desc" : "We are getting the following error in our logs under load. I have seen Bug VELOCITY-383 and this seems to be a similar issue\n\nCaused by:\njava.lang.NullPointerException\n        at org.apache.velocity.runtime.parser.node.ASTDirective.init(ASTDirective.java:134)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.init(SimpleNode.java:285)\n        at org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:169)\n        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n        at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n        at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n        at org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n        at org.apache.velocity.runtime.directive.Parse.render(Parse.java:224)\n        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n        at org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:194)\n        at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:170)\n        at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:74)\n        at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:88)\n        at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:318)\n        at org.apache.velocity.Template.merge(Template.java:254)\n        at org.springframework.web.servlet.view.velocity.VelocityView.mergeTemplate(VelocityView.java:555)\n        at org.springframework.web.servlet.view.velocity.VelocityView.doRender(VelocityView.java:500)\n        at org.springframework.web.servlet.view.velocity.VelocityView.renderMergedTemplateModel(VelocityView.java:320)\n        at org.springframework.web.servlet.view.AbstractTemplateView.renderMergedOutputModel(AbstractTemplateView.java:178)\n        at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:249)\n        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1063)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:827)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:736)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:396)\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:350)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at com.elasticpath.commons.filter.impl.CachingControlFilter.doFilter(CachingControlFilter.java:163)\n        at com.elasticpath.sfweb.filters.EpFilterToBeanProxy.doFilter(EpFilterToBeanProxy.java:137)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at com.elasticpath.sfweb.filters.CustomerSessionFilter.doFilter(CustomerSessionFilter.java:68)\n        at com.elasticpath.sfweb.filters.EpFilterToBeanProxy.doFilter(EpFilterToBeanProxy.java:137)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:292)\n        at org.acegisecurity.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116)\n        at org.acegisecurity.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:79)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.ui.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:143)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:246)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:220)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.securechannel.ChannelProcessingFilter.doFilter(ChannelProcessingFilter.java:168)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.util.FilterChainProxy.doFilter(FilterChainProxy.java:173)\n        at org.acegisecurity.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:120)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at com.elasticpath.commons.filter.impl.EncodingFilter.doFilter(EncodingFilter.java:72)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:175)\n        at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:74)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:199)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:282)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:754)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:684)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:876)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)", "created_at" : { "$date" : "2008-08-13T03:34:42.658+0000" }, "updated_at" : { "$date" : "2008-08-22T03:03:44.074+0000" }, "creator_id" : { "$oid" : "5b7d36a3e9214a0d1608d721" }, "reporter_id" : { "$oid" : "5b7d36a3e9214a0d1608d721" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Linux, Jboss 4.0.4" },
{ "_id" : { "$oid" : "5b904db45f627d84c8d6b96a" }, "external_id" : "VELOCITY-102", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add Support for Static Utility Classes", "desc" : "Support for Static Utility Classes is:\n\n1) define namespaces\n  \n  context.defineNamespace(\"Math\").add( java.lang.Math.class  ) ;\n   used as $Math.sin(0)\n\n2) Add / Replace / remove methods in namespace :\n\n  context.getNamespace(\"Math\").add(MyRandom.class.getMethod(\"randomString\",new \nClass[]{int.class}))\n  used as $Math.randomString(12)\n\n3) \"union\" on namespaces\n\n context.defineNamespace(\"Utils\")\n          .add(context.getNamespace(\"Math\"))\n          .add(context.defineNamespace(\"Collections\",Collections.class ) );\n\n used as:\n  $Utils.sin(0)\n  $Utils.sort($list)\n\n4) Global namespace\n\n  context.getGlobalNamespace().add( Math.class ); \n  used as $sin(0)\n\n5) inline namespaces:\n\n #use java.lang.Math as Math\n   $Math.sin(0)\n #end\n\n #with Math\n   $sin(0)\n #end", "created_at" : { "$date" : "2002-08-22T17:20:09.000+0000" }, "updated_at" : { "$date" : "2008-08-22T04:30:15.630+0000" }, "creator_id" : { "$oid" : "5b7d36a4e9214a0d1608d722" }, "reporter_id" : { "$oid" : "5b7d36a4e9214a0d1608d722" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904db55f627d84c8d6b98d" }, "external_id" : "VELOCITY-467", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Throw more exceptions and log less errors", "desc" : "Now that Velocity application exceptions are based on RuntimeException, we have more opportunity to use exceptions to signal application level problems.  I'm particularly concerned about initialization problems that are logged and may be missed.  We need to review all logged error messages and see if it would be more appropriate to throw an exception instead.  Some of these places we may need to leave as is for backwards compatibility reasons.  (e.g. macro in the global macro library doesn't parse properly).\n\nLlewellyn Falco made a good case for this on the dev list recently:\n\nhttp://www.mail-archive.com/velocity-dev@jakarta.apache.org/msg15067.html\n\n#####\nI still would like to put in my vote that sending error's to the log is an incredibly BAD idea.\n\nIf something is not working, it should be LOUDLY shown as an exception.\nIf it is working I don't really need a log.\n\nThe (velocity) log should be there for velocity developers (those programming the actual velocity code) not users.\n\nI don't ever care to see tomcat's log, I care to see the things I log while in tomcat.\n\nMost of all, many many many people do not check the log at all, let alone frequently.\n####", "created_at" : { "$date" : "2006-10-15T09:13:33.000+0000" }, "updated_at" : { "$date" : "2008-09-02T22:04:47.667+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db65f627d84c8d6b9a4" }, "external_id" : "VELOCITY-603", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "improvate #evaluate example", "desc" : "\n---------- Forwarded message ----------\nFrom: Luan Nguyen <luan.min.nguyen@gmail.com>\nDate: Mon, Oct 22, 2007 at 8:56 PM\nSubject: Evaluate Section\nTo: dev@velocity.apache.org\n\n\nHello,In the Evaluate section, there are two different variables: $source1\nand $source.  How can it display \"abc\" when $source is never defined?\n\nEvaluate\n\nThe *#evaluate* directive can be used to dynamically evaluate VTL. This\nallows the template to evaluate a string that is created at render time.\nSuch a string might be used to internationalize the template or to include\nparts of a template from a database.\n\nThe example below will display abc.\n\n#set($source1 = \"abc\")\n#set($select = \"1\")\n#set($dynamicsource = \"$source$select\")\n#evaluate($dynamicsource)\n\n\n\n\n---------- Forwarded message ----------\nFrom: Will Glass-Husain <wglasshusain@gmail.com>\nDate: Tue, Oct 23, 2007 at 9:55 AM\nSubject: Re: Evaluate Section\nTo: Velocity Developers List <dev@velocity.apache.org>\n\n\nThat's a good point though.  Perhaps the example should use concatenation to be clearer. The single quotes prevent evaluation.\n\n#set($dynamicsource = '$source' + \"$select\")\n\nWILL", "created_at" : { "$date" : "2008-07-13T23:38:20.187+0000" }, "updated_at" : { "$date" : "2008-09-02T22:18:39.051+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db65f627d84c8d6b9aa" }, "external_id" : "VELOCITY-571", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Glossary of significant terms and abbreviations", "desc" : "Like most long-lived communities, the Velocity project has over the years developed specific meanings for more broadly used terms. We also have developed a number of sub-projects whose names are not always explanatory of their function. Gather a list of significant terms, names and acronyms used throughout the Velocity documentation and create an alphabetized glossary listing both them with their Velocity-specific definition. ", "created_at" : { "$date" : "2007-12-09T19:20:04.561+0000" }, "updated_at" : { "$date" : "2008-09-02T22:48:27.695+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db75f627d84c8d6b9bc" }, "external_id" : "VELOCITY-395", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Semantics of escaping unclear", "desc" : "I think the semantics of the escaping operator \\ (backslash) are not documented \nclearly. Especially I miss this ones:\n\nWhy generates\n \\$foo ==> $foo\nbut\n \\${foo} ==> \\${foo}\nthis seems inconsistent to me. I expect\n \\${foo} ==> ${foo}\n\nI understand that\n   ${foo:bar}\nraises an error since there are no : (colons)\nallowed in a variable-name.\nBut why raises\n   \\${foo:bar}\nalso an error? I would expect that \\$ disables the function of $\nas an operator, so that the following {..} will not be parsed as\na variable name.\n\nThere should be a simple way to generate something like\n  ${foo:bar}\nor even\n  ${not a variable name at all &%$}\nThe workaround\n   #set($D='$')\n   ${D}{foo:bar}\nis undocumented and REALLY ugly.", "created_at" : { "$date" : "2005-07-14T23:11:28.000+0000" }, "updated_at" : { "$date" : "2008-09-02T23:12:47.336+0000" }, "creator_id" : { "$oid" : "5b7d36abe9214a0d1608d726" }, "reporter_id" : { "$oid" : "5b7d36abe9214a0d1608d726" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904db85f627d84c8d6b9cf" }, "external_id" : "VELOCITY-579", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can not access a member of class X with modifiers \"public\" even if method is public", "desc" : "When upgrading from 1.4 to 1.5 none of my template is working anymore.\n\nFor example :\n\n  [javadoc]  ERROR [console:logVelocityMessage] - ASTMethod.execute() : exception invoking method 'tags' in class com.sun.tools.javadoc.MethodDocImpl\n  [javadoc]  ERROR [console:logVelocityMessage] - java.lang.IllegalAccessException: Class org.apache.velocity.util.introspection.UberspectImpl$VelMethodImpl can not access a member of class com.sun.tools.javadoc.DocImpl with modifiers \"public\"\n\nThe method 'tags()' is public in com.sun.javadoc.Doc, but the implementation is package protected. So the java.lang.reflect.Method object is well returned by the org.apache.velocity.util.introspection.Introspector but not accessible from templates.\nThe same errors occured for example for javax.servlet.http.HttpSession Weblogic's implementation which is not public, but methods are !\n\nIt's not possible to wrap all objects javax.servlet.http.HttpSession into public implementations ... \n\nThe Introspector could call method.setAccessible(true) before returning Method object : if this method has been found, it is a public method !\n", "created_at" : { "$date" : "2007-12-18T10:00:38.291+0000" }, "updated_at" : { "$date" : "2008-09-03T00:44:25.295+0000" }, "creator_id" : { "$oid" : "5b7d36ace9214a0d1608d727" }, "reporter_id" : { "$oid" : "5b7d36ace9214a0d1608d727" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db85f627d84c8d6b9e0" }, "external_id" : "VELOCITY-70", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "public members inherted from non-public classes are not valid references", "desc" : "Hi there,\nI encountered a problem with Velocity when invoking inherited methods of a Java \nclass. I get the \nerror \"org.apache.velocity.runtime.exception.ReferenceException: reference : \ntemplate = screens/Details.vm [line 48,column 1] : $class.getFullName() is not \na valid reference\" if I want to invoke the \"FullName\" method of the \"class\" \nobject. This method is inherited from a superior class. If I call a method \ndefined directly in this class, everything works fine. If I obtain the name of \nthe \"class\" object, I get the correct name.\nIt would be nice, if anyone could help me on this.", "created_at" : { "$date" : "2002-04-30T18:32:34.000+0000" }, "updated_at" : { "$date" : "2008-09-03T01:23:04.205+0000" }, "creator_id" : { "$oid" : "5b7d36ade9214a0d1608d728" }, "reporter_id" : { "$oid" : "5b7d36ade9214a0d1608d728" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904db95f627d84c8d6b9f9" }, "external_id" : "VELOCITY-532", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "$velocityCount in macro not processed", "desc" : "\n\n---------- Forwarded message ----------\nFrom: mraible <matt@raibledesigns.com>\nDate: Mar 22, 2007 11:28 AM\nSubject: Issue with $velocityCount in 1.5\nTo: user@velocity.apache.org\n\n\n\nI've been using Velocity 1.4 for a couple of years now with great success.\nToday, I tried to use Struts Menu 2.4.2 with Velocity 1.5 and found an issue\nwith $velocityCount not being properly processed. My template is below.\n\nThe problem occurs on the following line:\n\n        #if ($velocityCount == $menu.parent.components.size())\n          <li class=\"last\">\n        #else\n\nWith 1.4, $velocityCount turns into a number when the displayCssMenu macro\nis called from #foreach. However, in 1.5, it's never turned into a number.\n\nAny ideas?\n\nThanks,\n\nMatt\n\n#macro( displayCssMenu $menu )\n  #if ($displayer.isAllowed($menu))\n    ## set menu title\n    #set ($title = $displayer.getMessage($menu.title))\n\n    #if (!$menu.url) #set ($url=\"javascript:void(0)\") #else #set\n($url=$menu.url) #end\n\n    ## create a single menu item\n    #if ($menu.components.size() == 0)\n        #if ($velocityCount == $menu.parent.components.size())\n          <li class=\"last\">\n        #else\n          <li>\n        #end\n        #if ($menu.name == $currentMenu)\n           $url ${title}\n        #else\n           $url ${title}\n        #end\n    #else ## create multiple menu items in a menu\n        #if ($menu.components.size() > 0)\n            #set ($hasViewableChildren = false)\n            #foreach ($menuIt in $menu.components)\n                #if ($displayer.isAllowed($menuIt))\n                    #set($hasViewableChildren = true)\n                #end\n            #end\n        #end\n\n        <li#if ($hasViewableChildren) class=\"menubar\"#end>\n           $url ${title}\n    #end\n\n    #if ($menu.components.size() > 0)\n        #if ($hasViewableChildren)\n          <ul>\n        #end\n\n        #foreach ($menuIt in $menu.components)\n            #displayCssMenu($menuIt)\n        #end\n\n        #if ($hasViewableChildren && ($velocityCount ==\n$menu.parent.components.size()))\n          </ul>\n        #else\n          </li>\n        #end\n    #else\n      </li>\n      #if ($velocityCount == $menu.parent.components.size())\n      </ul>\n      #end\n    #end\n  #end\n#end\n\n#displayCssMenu($menu)\n--\nView this message in context: http://www.nabble.com/Issue-with-%24velocityCount-in-1.5-tf3449438.html#a9621118\nSent from the Velocity - User mailing list archive at Nabble.com.\n\n\n---------------------------------------------------------------------\nTo unsubscribe, e-mail: user-unsubscribe@velocity.apache.org\nFor additional commands, e-mail: user-help@velocity.apache.org\n\n\n\n-- \nForio Business Simulations\n \nWill Glass-Husain\nwglass@forio.com\nwww.forio.com\n", "created_at" : { "$date" : "2007-03-25T00:25:40.227+0000" }, "updated_at" : { "$date" : "2008-09-03T06:05:19.352+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904db95f627d84c8d6b9f8" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904dba5f627d84c8d6ba03" }, "external_id" : "VELOCITY-62", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macro scope nesting", "desc" : "A problem with recursing macros is that scopes are not nested \nwhen \"velocimacro.context.localscope\" is set to true.  That is, a get() on a \ncontext does not percolate to a parent context if the get() returns null.  This \nprevents accessing global variables in the context.  The desired behavior \n(IMHO) would be for set()s to be local to the macro, and get()s to percolate up \nto the parent if not found.", "created_at" : { "$date" : "2002-04-10T07:07:01.000+0000" }, "updated_at" : { "$date" : "2008-09-03T18:59:22.294+0000" }, "creator_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "reporter_id" : { "$oid" : "5b7d354ae9214a0d1608d67f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dba5f627d84c8d6ba1a" }, "external_id" : "VELOCITY-229", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity templates should be able to specify their own encoding", "desc" : "Velocity templates should be able to specify their own encoding without\nrequiring external knowledge of the encoding before parsing (as least\nfor all ASCII-compatible encodings). Many other scripting/templating\nsystems (like JSP and python, for example) provide such a mechanism,\nand find it helpful to users when creating multi-language (and encoding) sites.", "created_at" : { "$date" : "2003-11-19T03:31:36.000+0000" }, "updated_at" : { "$date" : "2008-09-04T00:03:26.845+0000" }, "creator_id" : { "$oid" : "5b7d3552e9214a0d1608d68c" }, "reporter_id" : { "$oid" : "5b7d3552e9214a0d1608d68c" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba18" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba19" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dbb5f627d84c8d6ba2e" }, "external_id" : "VELOCITY-576", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Move the section about converting to strings", "desc" : "In the References section of the User Guide it says:\n\nEverything coming to and from a reference is treated as a String object. If there is an object that \nrepresents $foo (such as an Integer object), then Velocity will call its .toString() method to resolve \nthe object into a String.\n\nThis would make more sense if it was at the end of the section on references so that the different\ntypes of objects are introduced before this is.", "created_at" : { "$date" : "2007-12-12T00:26:17.513+0000" }, "updated_at" : { "$date" : "2008-09-04T00:14:18.670+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbc5f627d84c8d6ba37" }, "external_id" : "VELOCITY-574", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VTL Comment Blocks description is not clear", "desc" : "The User Guide says: \n\nThere is a third type of comment, the VTL comment block, which may be used to store\nsuch information as the document author and versioning information:\n#**\nThis is a VTL comment block and\nmay be used to store such information\nas the document author and versioning\ninformation:\n@author\n@version 5\n*#\n\nThe description only says that it can be used to store the information but not why you\nwould want to store the information or how it could be used. Also, the examples should\neither show more of how it is used or there should be an explanation of how to use \n@author and @version.", "created_at" : { "$date" : "2007-12-12T00:03:19.857+0000" }, "updated_at" : { "$date" : "2008-09-04T00:18:34.643+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbc5f627d84c8d6ba40" }, "external_id" : "VELOCITY-575", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Shorthand Notation should be called regular notation", "desc" : "In the User Guide, it shows the \"shorthand\" notation for references but does not\nmention any other notation until the section about formal notation. In the VTL\nReference, it calls the same notation \"regular\" notation. The User Guide should\nbe changed so that it is consistent with the reference. This also prevents confusion\n about calling it shorthand without mentioning any other notations until much later on.", "created_at" : { "$date" : "2007-12-12T00:12:08.228+0000" }, "updated_at" : { "$date" : "2008-09-04T00:24:18.575+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbd5f627d84c8d6ba48" }, "external_id" : "VELOCITY-572", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Need to make escaping examples more clear", "desc" : "In the User Guide, the examples for escaping could be changed to make it easier to understand\nfor newcomers. It would be better if there was an example showing how to escape (with one \nbackslash) and then move on to the more complicated examples.", "created_at" : { "$date" : "2007-12-11T23:48:14.386+0000" }, "updated_at" : { "$date" : "2008-09-04T04:25:14.384+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbe5f627d84c8d6ba51" }, "external_id" : "VELOCITY-573", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Combine the two sections about escaping", "desc" : "It would make more sense to just have one section of the User Guide about escaping. The two \nsections, \"Escaping Valid VTL References\" and \"Escaping VTL Directives\" should be combined\ninto one section where the \"Escaping VTL Directives\" section is now.", "created_at" : { "$date" : "2007-12-11T23:55:30.546+0000" }, "updated_at" : { "$date" : "2008-09-04T05:34:00.300+0000" }, "creator_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "reporter_id" : { "$oid" : "5b7d36aae9214a0d1608d725" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbe5f627d84c8d6ba58" }, "external_id" : "VELOCITY-492", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Maven2 POM for velocity-1.4.jar incorrectly adds the velocity-dep JAR", "desc" : "See http://jira.codehaus.org/browse/MEV-459 and VELOCITY-491", "created_at" : { "$date" : "2006-11-11T12:10:31.000+0000" }, "updated_at" : { "$date" : "2008-09-04T06:05:42.780+0000" }, "creator_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "reporter_id" : { "$oid" : "5b7d3592e9214a0d1608d6af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbf5f627d84c8d6ba61" }, "external_id" : "VELOCITY-543", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "download page refers to nightly builds which don't exist", "desc" : "http://velocity.apache.org/download.cgi\n\nre: section on nightly builds.  we just set this up (or note on the section this is not yet implemented)", "created_at" : { "$date" : "2007-04-30T04:45:27.455+0000" }, "updated_at" : { "$date" : "2008-09-04T06:14:20.129+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dbf5f627d84c8d6ba69" }, "external_id" : "VELOCITY-560", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Should ExtendedProperties.convertProperties instead of ExtendedProperties.putAll", "desc" : "In the developer-guide document (http://velocity.apache.org/engine/releases/velocity-1.5/developer-guide.html), there is a section, which talks about using ExtendedProperties to initialize VelocityEngine (at the bottom of #miscellaneousdetails). \n\nAt least for me, it didn't work as described. Instead of:\n    ExtendedProperties eprops = new ExtendedProperties();\n\n    // if you already have a Properties object do this\n    eprops.putAll(props);\n\nIt should be:\n       ExtendedProperties eprops = null;\n       if (props==null) {\n           eprops = new ExtendedProperties();\n       } else {\n           eprops = convertProperties(props);\n       }\n\nThis is obviously very minor, but may save someone 15 minutes.", "created_at" : { "$date" : "2007-08-02T19:25:58.009+0000" }, "updated_at" : { "$date" : "2008-09-04T06:26:54.533+0000" }, "creator_id" : { "$oid" : "5b7d36c2e9214a0d1608d72b" }, "reporter_id" : { "$oid" : "5b7d36c2e9214a0d1608d72b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "Any" },
{ "_id" : { "$oid" : "5b904dc05f627d84c8d6ba72" }, "external_id" : "VELOCITY-590", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "JarResourceLoader does not accept paths inside JAR files", "desc" : "According to documentation of JarResourceLoader it accepts paths that conform to rules given by java.net.JarUrlConnection. This is however not true as the JarUrlConnection says that the URL has form\n\njar:<url>!/{entry}\n\nThe \"!/\" is mandatory part of the URL. JarResourceLoader however expects the path whitout this suffix and automatically appends it. When conforming URL is given JarResourceLoader makes it invalid\n\neg.\n\n/directory/file.jar!/META-INF/templates/\n\nis scrambled to\n\n/directory/file.jar!/META-INF/templates/!/\n\nwhich is invalid and no templates are found.\n\nI try to package templates along with tools and other code. I put them into /META-INF/templates/ and try to setup the loader so I do not have to prefix template names with \"/META-INF/templates/\".\n\n======\n\nIdeally the JarResourceLoader should not append \"!/\" suffix at all. For compatibility reasons it should do so only if the path does not contain it already.", "created_at" : { "$date" : "2008-03-13T12:29:17.513+0000" }, "updated_at" : { "$date" : "2008-09-04T06:47:41.124+0000" }, "creator_id" : { "$oid" : "5b7d36c5e9214a0d1608d72c" }, "reporter_id" : { "$oid" : "5b7d36c5e9214a0d1608d72c" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc15f627d84c8d6ba81" }, "external_id" : "VELOCITY-437", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Intercept output of objects", "desc" : "Currently, all reference objects in a Velocity template file are put out using the objects toString method, with no means to control this mechanism. I propose to change this by having interceptors that can pick up variables before they are run .toString on, and write them using their own means instead.\n\nIf I figure out how to attach files to this after posting, I will add a patch with all the code necessary to implement this.", "created_at" : { "$date" : "2006-04-11T15:42:31.000+0000" }, "updated_at" : { "$date" : "2008-09-04T09:51:55.795+0000" }, "creator_id" : { "$oid" : "5b7d36c6e9214a0d1608d72d" }, "reporter_id" : { "$oid" : "5b7d36c6e9214a0d1608d72d" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc25f627d84c8d6ba97" }, "external_id" : "VELOCITY-614", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Impossible to escape '#' if followed by text and parenthesis( \"\\#something(Stuff)\" renders with the '\\')", "desc" : "\"#something(Stuff)\" in your templates (without the double quotes) causes a parse error.\n\"\\#something(Stuff)\" in your template (without the double quotes) renders as \"\\#something(Stuff)\"\n\nEither the first line should go through just fine, or the next one should not render the '\\'\n\nThis typically happens when you try to generate JavaDoc for overriding methods.\n\nDon't hesitate to contact me if this is not clear enough or if you are unable to reproduce this issue.", "created_at" : { "$date" : "2008-09-18T07:08:41.007+0000" }, "updated_at" : { "$date" : "2008-09-23T15:02:21.118+0000" }, "creator_id" : { "$oid" : "5b7d36c7e9214a0d1608d72e" }, "reporter_id" : { "$oid" : "5b7d36c7e9214a0d1608d72e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "I don't think it is relevant but still: CPU Intel Pentium D, windows XP SP3, JRE 1.6.0_07, Velocity 1.6-beta1" },
{ "_id" : { "$oid" : "5b904dc25f627d84c8d6baa9" }, "external_id" : "VELOCITY-616", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Escaping of directives does not work if the directive is in curly brackets", "desc" : "To escape a directive, one must precede it with an escape backslash. According to the documentation:\n   \\#if ($foo)\n      \\$bar\n   \\#end\nShould render as\n   #if $foo)\n      $bar\n   #end\nAnd it does. \nHowever, if you enclose the directive in curly brackets, the escape is ignored:\n   \\#{if} ($foo)\n      \\$bar\n   \\#{end}\nIgnores the escape and evaluates to\n   \\\n(assuming $foo is false).", "created_at" : { "$date" : "2008-09-24T06:10:59.741+0000" }, "updated_at" : { "$date" : "2008-09-24T19:00:08.730+0000" }, "creator_id" : { "$oid" : "5b7d36c8e9214a0d1608d72f" }, "reporter_id" : { "$oid" : "5b7d36c8e9214a0d1608d72f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc35f627d84c8d6bab4" }, "external_id" : "VELOCITY-567", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problems with passing parameters with special symbols (like backslash)", "desc" : "When passing path to windows share (in windows) we store double backslashes to properties. But this double backslashes unescaped (by ExtendedPropertySet) and template loading doesn't work properly. \n\nI propose escape all passed string values. Fixing clients will require changes in many other projects (f.e. org.springframework.ui.velocity.VelocityEngineFactory).\n\nThis problem also occurs at RuntimeInstance#initializeProperties and RuntimeInstance#setConfiguration and should be fixed according COLLECTIONS-271", "created_at" : { "$date" : "2007-10-16T12:58:35.076+0000" }, "updated_at" : { "$date" : "2008-09-24T21:36:54.410+0000" }, "creator_id" : { "$oid" : "5b7d36c9e9214a0d1608d730" }, "reporter_id" : { "$oid" : "5b7d36c9e9214a0d1608d730" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc45f627d84c8d6babe" }, "external_id" : "VELOCITY-609", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "current velocity-site subproject produces velocity-site-skin-1.2.3.jar, velocity engine mvn site expects version 1.2.0", "desc" : "I built http://svn.apache.org/repos/asf/velocity/site/site/ with Maven and it installed velocity-site-skin-1.2.3.jar in my local repository.\n\nHowever, I still wasn't able to call \"mvn site\" for http://svn.apache.org/repos/asf/velocity/engine/trunk/ because it expects velocity-site-skin-1.2.0.jar.\n\nAs a quick workaround I just renamed the file in my local repository but there's probably a better way. :) ", "created_at" : { "$date" : "2008-07-25T22:03:43.103+0000" }, "updated_at" : { "$date" : "2008-09-24T21:37:36.718+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc45f627d84c8d6bac6" }, "external_id" : "VELOCITY-608", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Maven build for velocity-site fails because of missing plexus utils dependency", "desc" : "I checked out http://svn.apache.org/repos/asf/velocity/site/ and ran Maven build:\n\nmvn site\n\n-->\n\nC:\\work\\workspace\\other\\velocity-site\\tools\\velocity-site-news-plugin\\target\\generated-sources\\model\nlo\\org\\apache\\velocity\\site\\news\\model\\io\\xpp3\\NewsXpp3Reader.java:[18,31] cannot find symbol\nsymbol  : class ReaderFactory\nlocation: package org.codehaus.plexus.util\n\nC:\\work\\workspace\\other\\velocity-site\\tools\\velocity-site-news-plugin\\target\\generated-sources\\model\nlo\\org\\apache\\velocity\\site\\news\\model\\io\\xpp3\\NewsXpp3Reader.java:[809,24] cannot find symbol\nsymbol  : variable ReaderFactory\nlocation: class org.apache.velocity.site.news.model.io.xpp3.NewsXpp3Reader\n\nC:\\work\\workspace\\other\\velocity-site\\tools\\velocity-site-news-plugin\\target\\generated-sources\\model\nlo\\org\\apache\\velocity\\site\\news\\model\\io\\xpp3\\NewsXpp3Reader.java:[825,24] cannot find symbol\nsymbol  : variable ReaderFactory\nlocation: class org.apache.velocity.site.news.model.io.xpp3.NewsXpp3Reader\n\n---\n\nto fix that, add dependency to plexus-utils in pom.xml:\n\n    <dependency>\n      <groupId>org.codehaus.plexus</groupId>\n      <artifactId>plexus-utils</artifactId>\n      <version>1.5.5</version>\n    </dependency>\n\n\n", "created_at" : { "$date" : "2008-07-25T21:57:36.120+0000" }, "updated_at" : { "$date" : "2008-09-24T23:11:08.491+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc55f627d84c8d6bacd" }, "external_id" : "VELOCITY-613", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong Velocity 1.5 POM file in Maven repository", "desc" : "Velocity's POM file in Maven repository has incorrect groupId:\nhttp://repo1.maven.org/maven2/velocity/velocity/1.5/velocity-1.5.pom\nIt does not match the jar file\nCurrently: <groupId>org.apache.velocity</groupId>\nShould be: <groupId>velocity</groupId>", "created_at" : { "$date" : "2008-08-20T10:36:34.297+0000" }, "updated_at" : { "$date" : "2008-09-25T21:11:44.805+0000" }, "creator_id" : { "$oid" : "5b7d36cce9214a0d1608d731" }, "reporter_id" : { "$oid" : "5b7d36cce9214a0d1608d731" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc65f627d84c8d6bae1" }, "external_id" : "VELOCITY-316", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Workaround the lack of equality in CharSequence.", "desc" : "CharSequence is a nice addition to the Java API,\nhelping to encapsulate implementation details\nand allowing programmers to use StringBuffer,\nmutable strings (such as\nhttp://mg4j.dsi.unimi.it/docs/it/unimi/dsi/mg4j/util/MutableString.html )\nor even their custom classes directly\ninstead of costly process of converting everything into a String.\n\nOne of the remaining drawbacks of the CharSequence\nis the lack of support for the Object#equals method.\nFortunately, in Velocity it can be easily fixed\nin the ASTEQNode and ASTNENode classes.\nExample of the fix is provided in the following patches.\n\n--- org/apache/velocity/runtime/parser/node/original/ASTEQNode.java\tWed Apr \n14 09:26:42 2004\n+++ org/apache/velocity/runtime/parser/node/ASTEQNode.java\tThu Nov 11 14:21:\n03 2004\n@@ -101,6 +101,20 @@\n         }\n         else\n         {\n+          \n+          /*\n+           * Comparison of CharSequence objects.\n+           */\n+          if (left instanceof CharSequence && right instanceof CharSequence)\n+          {\n+            final CharSequence a = (CharSequence) left;\n+            final CharSequence b = (CharSequence) right;\n+            final int aLen = a.length(); final int bLen = b.length();\n+            if( aLen != bLen ) return false;\n+            int n = aLen; while( 0 != n-- ) if( a.charAt( n ) != b.charAt( n ) \n) return false;\n+            return true;\n+          }\n+\n             rsvc.error(\"Error in evaluation of == expression.\"\n                           + \" Both arguments must be of the same Class.\"\n                           + \" Currently left = \" + left.getClass() + \", right = \n\" \n\n\n--- org/apache/velocity/runtime/parser/node/original/ASTNENode.java\tWed Apr \n14 09:26:42 2004\n+++ org/apache/velocity/runtime/parser/node/ASTNENode.java\tThu Nov 11 14:22:\n04 2004\n@@ -74,6 +74,20 @@\n         }\n         else\n         {\n+          \n+          /*\n+           * Comparison of CharSequence objects.\n+           */\n+          if (left instanceof CharSequence && right instanceof CharSequence)\n+          {\n+            final CharSequence a = (CharSequence) left;\n+            final CharSequence b = (CharSequence) right;\n+            final int aLen = a.length(); final int bLen = b.length();\n+            if( aLen != bLen ) return true;\n+            int n = aLen; while( 0 != n-- ) if( a.charAt( n ) != b.charAt( n ) \n) return true;\n+            return false;\n+          }\n+\n             rsvc.error(\"Error in evaluation of != expression.\"\n                           + \" Both arguments must be of the same Class.\"\n                           + \" Currently left = \" + left.getClass() + \", right = \n\" \n\nThe additional check should not have any performance impact,\nsince it is performed where the 'Both arguments must be of the same Class'\nerror was.\n\nI really hope Velocity will incorporate at least that minimal\nsupport for CharSequence, making Java environment\nto be a lot friendlier to some of us.", "created_at" : { "$date" : "2004-11-11T19:58:00.000+0000" }, "updated_at" : { "$date" : "2008-10-01T22:37:55.461+0000" }, "creator_id" : { "$oid" : "5b7d36cde9214a0d1608d732" }, "reporter_id" : { "$oid" : "5b7d36cde9214a0d1608d732" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dc65f627d84c8d6baf4" }, "external_id" : "VELOCITY-620", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Parse error creates an obscure error message", "desc" : "The following incorrect velocity usage:\n\n#macro(foo $a)\n  blaa\n#end\n#foo(\"b\" \"c\")\n\nor ...\n\n#if ($x = \"a\")\n#end\n\nwill create the obscure error message in the exception:\n\n> Bad Reference \"null\" in /foo.vm:18\n\n\n", "created_at" : { "$date" : "2008-10-01T08:47:25.543+0000" }, "updated_at" : { "$date" : "2008-10-02T16:08:48.573+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc75f627d84c8d6bb02" }, "external_id" : "VELOCITY-596", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Changes report JIRA links don't work", "desc" : "Change report\n\nhttp://velocity.apache.org/engine/releases/velocity-1.5/changes-report.html\n\nhas links to JIRA issues, e.g.\n\nNew StringResourceLoader can retrieve templates from repository of in-memory Strings. Fixes VELOCITY-183\nThe link is \nhttps://issues.apache.org/jira/browse/ViewIssue.jspa?key=VELOCITY-183\n\nwhich does not work for me; it needs to be \nhttps://issues.apache.org/jira/browse/VELOCITY-183\n\nI don't know if this is a change in JIRA or a bug in the site generation, but it's annoying that none of the links seem to work ;-)", "created_at" : { "$date" : "2008-05-23T13:19:20.295+0000" }, "updated_at" : { "$date" : "2008-10-03T00:36:33.820+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "http://velocity.apache.org/engine/releases/velocity-1.5/changes-report.html" },
{ "_id" : { "$oid" : "5b904dc85f627d84c8d6bb0e" }, "external_id" : "VELOCITY-619", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "New set modifier so that set only assigns a value when variable is not defined.", "desc" : "Define a new #set modifier such that a variable is only set if it is not defined, like so:\n\n#set($!foo = \"bar\")\n\nIf the '!' character proceeds the variable foo, then $foo will be set with the value of \"bar\" ONLY IF $foo is not defined (is not in the context).  Otherwise if $foo is defined it will remain unchanged.\n\n\n\n", "created_at" : { "$date" : "2008-09-29T14:49:04.907+0000" }, "updated_at" : { "$date" : "2008-10-06T01:28:17.708+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc85f627d84c8d6bb20" }, "external_id" : "VELOCITY-624", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "LogChute's only set log level if specified", "desc" : "The patch changes the behavior of Log4JLogChute and JdkLogChute such that the log level is only set if the coresponding runtime property is set. for example 'runtime.log.logsystem.log4j.logger.level'.  Beforet this change, log level was set to 'WARN' if the level wasn't set with a property, which would override logger config file settings if the logger was configured before initializing velocity.\n\n\n", "created_at" : { "$date" : "2008-10-10T03:41:28.826+0000" }, "updated_at" : { "$date" : "2008-10-10T18:09:57.036+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dc95f627d84c8d6bb28" }, "external_id" : "VELOCITY-622", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Display consistent file and line number format for errors.", "desc" : "The provided patch changes the display of file errors so that it is of one consistent format.  The format implemented is the following:\n\n $filename[line $lnum, column $cnum]\n\nIf the filename is not available then filename is substituted with <unknown file>\n\nA consistent format help tools to detect and process file references in velocity logs and exceptions.\n\n", "created_at" : { "$date" : "2008-10-09T18:57:29.899+0000" }, "updated_at" : { "$date" : "2008-10-10T18:17:26.065+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dca5f627d84c8d6bb30" }, "external_id" : "VELOCITY-625", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macro generates array bounds exception", "desc" : "The following VTL:\n\n#macro(test $a $b)#end #test(\"x\")\n\nGenerates the following exception:\n\nThrew: java.lang.ArrayIndexOutOfBoundsException\nmsg: 1\nthrown at:  org.apache.velocity.runtime.parser.node.SimpleNode.jjtGetChild(SimpleNode.java:172)\n    org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:156)\n    org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:245)\n    org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:178)\n    org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:334)\n    org.apache.velocity.Template.merge(Template.java:328)\n    org.apache.velocity.Template.merge(Template.java:235)\n", "created_at" : { "$date" : "2008-10-10T21:35:12.549+0000" }, "updated_at" : { "$date" : "2008-10-10T22:12:13.719+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dca5f627d84c8d6bb37" }, "external_id" : "VELOCITY-618", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Strict property and method references", "desc" : "The given patch against trunk adds a new option 'runtime.references.strict'.  When set to true, invalid property references will throw a InvalidMethodException.  For example $foo.bar will throw an exception if the object contained in $foo has no such property as bar.  Any kind of reference to bar will cause an exception including:\n\n#if(#foo.bar)\n#set($foo.bar = \"junk\")\n#set($foo.getBar())\netc...\n\n", "created_at" : { "$date" : "2008-09-29T14:10:33.811+0000" }, "updated_at" : { "$date" : "2008-10-12T03:37:11.762+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dcb5f627d84c8d6bb60" }, "external_id" : "VELOCITY-626", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Log to error macro exceptions", "desc" : "This patch logs to error the exceptions that occur within a macro.  This essentially creates a stack trace in the error log of the macro stack levels that contain the exception. For example: (This is with strict reference settings, but the same would be true without strict referencing and an exception was thrown from within the reference call)\n\n#macro(foo1 $f)\n  $f\n#end\n#macro(foo2 $e)\n  #foo1($e)\n#end\n#foo2($x.abc)\n\nWould create a log ouput like so:\n\nERROR (velocity) Variable $x has not been set at /foo.vm[line 7, column 7]\nERROR (velocity) Exception calling reference $f at /foo.vm[line 2, column 3]\nERROR (velocity) Exception in macro #foo1 at /foo.vm[line 5, column 3]\nERROR (velocity) Exception in macro #foo2 at /foo.vm[line 7, column 1]\n\nWithout this it is very difficult to find where an error occurred within nested macros.", "created_at" : { "$date" : "2008-10-12T22:43:52.482+0000" }, "updated_at" : { "$date" : "2008-10-13T17:30:20.846+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dcc5f627d84c8d6bb6a" }, "external_id" : "VELOCITY-627", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#foreach exception reports wrong line number", "desc" : "With the velocity configuration property 'directive.foreach.skip.invalid'  set to false, the following VTL:\n\n#set($x = \"abc\")\n#foreach($i in $x)\n    blaa\n#end\n\nCreates the exception:\n\nUberspect returned a null iterator for #foreach at /foo.vm [line 0, column 0]. $x (abc) is either of wrong type or has an invalid iterator() implementation\n\nWhich contains the wrong line and column numbers.\n\n", "created_at" : { "$date" : "2008-10-12T22:52:11.263+0000" }, "updated_at" : { "$date" : "2008-10-13T17:45:10.836+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dcc5f627d84c8d6bb74" }, "external_id" : "VELOCITY-628", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No template information in set directive error", "desc" : "Given the following VTL:\n\n## \n##\n#set($x = \"#if()\")\n\nthe resulting error message is:\n\n\"Problem parsing String literal.\"\n\nWithout any information about which template and line number.", "created_at" : { "$date" : "2008-10-12T23:03:26.519+0000" }, "updated_at" : { "$date" : "2008-10-13T19:23:38.518+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904db95f627d84c8d6b9f8" }, "external_id" : "VELOCITY-285", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dcd5f627d84c8d6bb7b" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b904db95f627d84c8d6b9f9" }, "effect" : "relates to", "type" : "Reference" } ], "creator_id" : { "$oid" : "5b7d36d8e9214a0d1608d734" }, "desc" : "It seems that there is a bug when we have loop into a recursive macro.\n\nHere is the test I run :\n\n#macro (test_loop $p)\ncall to test_loop ($p)\n#foreach($child in $p)\n    in the loop the param should not be changed : ($p)\n#test_loop($child)\n#end\nreturn\n#end\n\n#set($l1=[\"a\"])\n#set($l = [$l1])\n#test_loop($l)\n\n\nIt produce:\n\ncall to test_loop ([[a]])\n\tin the loop the param should not be changed : ([[a]])\ncall to test_loop ([a])\n\tin the loop the param should not be changed : (a)\ncall to test_loop (a)\nreturn\nreturn\nreturn\n\nIMHO, it should be \ncall to test_loop ([[a]])\n\tin the loop the param should not be changed : ([[a]])\ncall to test_loop ([a])\n\tin the loop the param should not be changed : ([a])\ncall to test_loop (a)\nreturn\nreturn\nreturn\n\nThe difference is in the second recusive call.  I don't know why, but it seems\nthat the instruction #foreach($child in $p) has modified $p that contains the\nvalue of $child.", "reporter_id" : { "$oid" : "5b7d36d8e9214a0d1608d734" }, "title" : "reference within macro and foreach is incorrect", "priority" : "Minor", "status" : "Closed", "environment" : "Operating System: other\nPlatform: Other", "updated_at" : { "$date" : "2008-10-15T01:19:22.941+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2004-07-27T17:24:42.000+0000" } },
{ "_id" : { "$oid" : "5b904dcd5f627d84c8d6bb7b" }, "external_id" : "VELOCITY-630", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5", "1.6-beta1" ], "components" : [ "Engine" ], "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904db95f627d84c8d6b9f8" }, "effect" : "blocks", "type" : "Blocker" } ], "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "desc" : "GIven the following:\n\n#macro(test $a $b)\n #foreach($i in $a) $b #end\n#end\n#test( [1, 2, 3] \"#if($i == 2) yes #else no #end\")\n\nI would expect the output:\n\nno  yes  no\n\nInstead, I get\n\nno  no  no\n\nThe Foreach directive explicitly sets  $i in the localscope.  This change was made for VELOCITY-285 .  Before 285 Velocity correctly gave the results  \"no yes no\" which is svn revision number 471881.\n\n\n", "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "title" : "Pass by name does not work with #foreach within a macro", "priority" : "Major", "status" : "Resolved", "updated_at" : { "$date" : "2008-10-16T17:13:40.967+0000" }, "issue_type" : "Bug", "resolution" : "Fixed", "created_at" : { "$date" : "2008-10-13T00:13:28.188+0000" } },
{ "_id" : { "$oid" : "5b904dcf5f627d84c8d6bba5" }, "external_id" : "VELOCITY-629", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error message for set directive reports wrong line number", "desc" : "Given the following template:\n\n## \n##\n#set($list = [1])\n#set($x = \"$list.get(1)\")\n\nThe MethodInvocationException that report this error reads:\n\nInvocation of method 'get' in class java.util.ArrayList threw exception java.lang.IndexOutOfBoundsException: Index: 1, Size: 1 at /foo.vm[line 1, column 7]\n\nWhich contains an incorrect line number.\n\n", "created_at" : { "$date" : "2008-10-12T23:11:41.382+0000" }, "updated_at" : { "$date" : "2008-10-16T21:30:54.220+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dcf5f627d84c8d6bbb9" }, "external_id" : "VELOCITY-525", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Clean up the logic in SecureIntrospectorImpl to be more readable.", "desc" : "Clean up the logic in SecureIntrospectorImpl to be more readable.", "created_at" : { "$date" : "2007-03-06T11:19:23.578+0000" }, "updated_at" : { "$date" : "2008-10-16T22:07:28.434+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904d375f627d84c8d6af6a" } },
{ "_id" : { "$oid" : "5b904dd05f627d84c8d6bbc0" }, "external_id" : "VELOCITY-631", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VTL Creates parse error, but shouldn't", "desc" : "The following creates a parse exception, but should not:\n\n#macro(test $x)$x#set($i=1)#end\n\nException:\n\nThrew: org.apache.velocity.exception.ParseErrorException\nmsg: Encountered \"=\" at /foo.vm[line 2, column 25]\nWas expecting one of:\n    <RPAREN> ...\n    <WHITESPACE> ...\n    <WHITESPACE> ...\n\n\n", "created_at" : { "$date" : "2008-10-14T08:22:11.372+0000" }, "updated_at" : { "$date" : "2008-10-18T23:01:53.112+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd15f627d84c8d6bbd0" }, "external_id" : "VELOCITY-632", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong capitalisation is used for many anchor references in http://velocity.apache.org/engine/devel/user-guide.html", "desc" : "The wrong capitalisation is used for many anchor references in http://velocity.apache.org/engine/devel/user-guide.html.\n\nFor example, the contents list has a link:\n\nhttp://velocity.apache.org/engine/devel/user-guide.html#references\n\nbut the anchor is actually \"References\", not \"references\"", "created_at" : { "$date" : "2008-10-20T11:13:53.518+0000" }, "updated_at" : { "$date" : "2008-10-20T16:32:47.938+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "http://velocity.apache.org/engine/devel/user-guide.html" },
{ "_id" : { "$oid" : "5b904dd25f627d84c8d6bbd8" }, "external_id" : "VELOCITY-633", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "User Guide does not fully document how integer division is performed.", "desc" : "The Velocity User guide says:\n\n\"When a division operation is performed between two integers, the result will be an integer.\"\n\nIt would be helpful to state what rounding is used, with examples for positive and negative numbers.\n", "created_at" : { "$date" : "2008-10-20T11:49:16.148+0000" }, "updated_at" : { "$date" : "2008-10-20T16:35:58.516+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ], "environment" : "http://velocity.apache.org/engine/devel/user-guide.html" },
{ "_id" : { "$oid" : "5b904dd35f627d84c8d6bbe0" }, "external_id" : "VELOCITY-168", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd35f627d84c8d6bbe1" }, "external_id" : "VELOCITY-392", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Switch to a better log system - slf4j", "desc" : "Since I'm still very unhappy with the current logging workaround in velocity, I\nremoved the complete velocity logsystem stuff and replaced it with slf4j (see\nhttp://slf4j.org/manual.html ; http://slf4j.org/faq.html). So, the final thing\nis a little bit smaller and should be wrt. logging easier to use (i.e. no need\nfor passing runtime svc handles back and forth just to be able to log\nsomething), much faster, safer and more precise and powerful than the old one...\n\nIn case your are interested, I'll attach the patch made against the saturday\nevening svn repository. It basically contains the log changes as well as some\ncode cleaning (i.e. remove/comment out unsed vars/methods, removed unneccessary\ncasts as well as nested else clauses, removed throw XExceptions, which are\nactually not thrown). Finally I switched many log.info into log.debug, since the\nappropriate messages are important for developers only and should not irritate\nthe enduser (who usually doesn't even understand that freak language ;-)).\n\nTo get the thing running out of the box, I modified the buildfile to include\nlog4j.properties in the jar, so that nlog4j aka log4j NG ;-) finds and uses it\nautomatically, if one has not explictly configured it. And of course\nbuild/lib/log4j has been replaced with nlog4j (see\nhttp://www.slf4j.org/nlog4j/download.html)\n\nRegards,\njens.", "created_at" : { "$date" : "2005-07-10T15:22:39.000+0000" }, "updated_at" : { "$date" : "2008-10-27T18:34:35.175+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904dd35f627d84c8d6bbdf" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dd35f627d84c8d6bbe0" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dd45f627d84c8d6bbf3" }, "external_id" : "VELOCITY-466", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Look into maven plugins for ant to use automatic deployment to maven repositories", "desc" : "there are maven plugins that can be driven by ant to automatically deploy the velocity builds to the maven repositories (suggested by Thomas Minor, thanks)", "created_at" : { "$date" : "2006-10-13T16:34:58.000+0000" }, "updated_at" : { "$date" : "2008-10-27T19:47:54.006+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b904dd45f627d84c8d6bbf2" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b904dd45f627d84c8d6bc09" }, "external_id" : "VELOCITY-634", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fix Javadoc link in ChainedInternalContextAdapter", "desc" : "{noformat}\n[WARNING] Javadoc Warnings\n[WARNING] M:\\velocity\\src\\java\\org\\apache\\velocity\\context\\ChainedInternalContextAdapter.java:212: warning - Tag @see: can't find localPut(java.lang.String,java.lang.Object) in org.apache.velocity.context.InternalHousekeepingContext\n[WARNING] M:\\velocity\\src\\java\\org\\apache\\velocity\\runtime\\parser\\ParserTokenManager.java:96: warning - @return tag cannot be used in method with void return type.\n{noformat}\n", "created_at" : { "$date" : "2008-10-27T22:37:05.565+0000" }, "updated_at" : { "$date" : "2008-10-28T04:49:08.221+0000" }, "creator_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "reporter_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine", "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd55f627d84c8d6bc12" }, "external_id" : "VELOCITY-638", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Lock down version of reporting plugins in POM", "desc" : "Leaving plugin versions unspecified (i.e. blindly relying on LATEST) is a bad practice as it sacrifies build reproducibility. Even if the POM itself is not used for the actual build, it would promote best practices to consumers when fixed.", "created_at" : { "$date" : "2008-10-27T23:20:00.938+0000" }, "updated_at" : { "$date" : "2008-10-28T05:29:26.652+0000" }, "creator_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "reporter_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine", "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd55f627d84c8d6bc1a" }, "external_id" : "VELOCITY-635", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Fix POM to state correct dependency on commons-collections", "desc" : "build.properties:\n{noformat}\n# Jars to be downloaded\njar.antlr.version= 2.7.5\njar.avalon-logkit.version= 2.1\njar.commons-collections.version= 3.2.1\n{noformat}\n\nPOM:\n{code:xml}\n<dependency>\n  <groupId>commons-collections</groupId>\n  <artifactId>commons-collections</artifactId>\n  <version>3.1</version>\n</dependency>\n{code}", "created_at" : { "$date" : "2008-10-27T22:41:07.523+0000" }, "updated_at" : { "$date" : "2008-10-28T05:31:06.802+0000" }, "creator_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "reporter_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine", "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd65f627d84c8d6bc22" }, "external_id" : "VELOCITY-174", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "For consideration: #define()...#end directive to define a block of VTL as a reference", "desc" : "* Proposal:\n\n#define( $block_ref )\n ## any VTL / text content here\n ... \n#end\n\nthen you can use it like a reference:\n<html><body> $!block_ref </body></html> / #if( $block_ref ).. #end / and so on\n\n* Justification:\n\n1. Allows template designer to use a more efficient inside -> out approach\n(similar to Nathan's VelocityLayoutServlet)\n2. Keeps macro framework separate (the app developer can still disallow inline\nmacros)\n3. #macros to return blocks of VTL cannot be used like silent references or in\nother directives (like #if)\n4. The multi-line #set proposal requires a quoted value. A #define() block can\ncontain anything (without the need to escape quotes for example).\n5. #define() blocks are proxied (like #macros) and thus change according to the\ncontext after they are defined, something a normal $reference or #set can't do.\n7. Can improve template management by reducing number of unique template components\n8. Can improve template security/errors by reducing the need for bottom tier\ntemplate makers to worry about generic layout code and visa-versa.\n9. Merges the strengths of #macros and $references = best of both worlds\n\n* Usage Example: Custom HTML forms:\n\ntemplate 1. : document_type_1_custom_form_body.vm\n----\n#define( $custom_form_body )\n\n  ## unique form fields here\n\n#end\n#parse(\"main_form_layout.vm\")\n----\n\ntemplate 2 : main_form_layout.vm\n----\n#define( $custom_page_body )\n<form>\n## common form fields here\n\n$!custom_form_body\n\n<input type=\"submit\" value=\"submit\">\n</form>\n\n#end\n#parse(\"main_page_layout.vm\")\n----\n\ntemplate 2 : main_page_layout.vm\n----\n<html><body>\n\n## common page layout html here\n$!custom_page_body\n\n</body></html>\n----\n\nIf the #define() directive was not available a template designer would need to\ndo this:\n\ntemplate 1. : document_type_1_custom_form_body.vm\n----\n#parse(\"main_page_layout_header.vm\")\n#parse(\"main_form_layout_header.vm\")\n ## unique form fields here\n#parse(\"main_form_layout_header.vm\")\n#parse(\"main_page_layout_header.vm\")\n----\n\nNot only is the same output achieved with fewer #parse() directives (3 v 5), the\nunique templates are fewer and easier to manage. Template designers can make\nmany document_type_X templates and need only to define the reference\n$custom_form_body and not worry about the overall page layout. Custom parts of\nthe page are also only optionally required now; the main template can test for a\nreference and display a default block if it isn't defined.", "created_at" : { "$date" : "2003-04-29T10:13:12.000+0000" }, "updated_at" : { "$date" : "2008-10-28T21:33:49.056+0000" }, "creator_id" : { "$oid" : "5b7d36f0e9214a0d1608d736" }, "reporter_id" : { "$oid" : "5b7d36f0e9214a0d1608d736" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904da65f627d84c8d6b84e" }, "effect" : "blocks", "type" : "Blocker" } ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904dd75f627d84c8d6bc43" }, "external_id" : "VELOCITY-642", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Array arguments in method calls are wrapped with an extra array", "desc" : "Velocity 1.6 b2 wraps array arguments of method calls with an extra array causing the calls to fail and making this version incompatible with previous versions.\n\nA simple template, like this, demonstrates the behavior:\n\n#set ($_array = [ 1, 2, 3 ])\n$test.arrayTest($_array.toArray())\n\nDepending on the signature of test.arrayTest() , the template prints:\n\npublic String arrayTest(Object[] array)\n{\n    return java.util.Arrays.deepToString((Object[]) array);\n}\n\n[[1, 2, 3]]\n\npublic String arrayTest(Object... array)\n{\n    return java.util.Arrays.deepToString(array);\n}\n\n[[1, 2, 3]]\n\npublic String arrayTest(Object array)\n{\n    return java.util.Arrays.deepToString((Object[]) array);\n}\n\n[1, 2, 3]\n\nActually, I noticed later that the argument doesn't have to be an array, this version of Velocity seems to wrap any argument into an array if the method expects an array. So maybe this is a feature and not a bug, but it should detect already correct array arguments and leave them intact to keep existing templates working.\n\n-- Ilkka", "created_at" : { "$date" : "2008-11-05T20:04:35.228+0000" }, "updated_at" : { "$date" : "2008-11-05T21:31:22.267+0000" }, "creator_id" : { "$oid" : "5b7d366be9214a0d1608d70a" }, "reporter_id" : { "$oid" : "5b7d366be9214a0d1608d70a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd85f627d84c8d6bc4b" }, "external_id" : "VELOCITY-640", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove broken Anakia example", "desc" : "We should remove the Anakia example from the Velocity examples directory.  It doesn't work (at least when following the instructions) since the lib directory with the supporting jars has disappeared.  And it's not needed since Anakia has spun off into separate project.  Any objections?", "created_at" : { "$date" : "2008-10-28T03:28:54.602+0000" }, "updated_at" : { "$date" : "2008-11-17T18:13:39.340+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd85f627d84c8d6bc52" }, "external_id" : "VELOCITY-639", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update \"upgrade instruction\" section in README.txt", "desc" : "Need to update the README.txt file, specifically the section \"UPGRADING FROM EARLIER RELEASES\" before release of final 1.6.\n\n", "created_at" : { "$date" : "2008-10-28T03:23:26.088+0000" }, "updated_at" : { "$date" : "2008-11-17T19:39:57.250+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd95f627d84c8d6bc58" }, "external_id" : "VELOCITY-641", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "XMLApp example broken", "desc" : "The XML app example doesn't work.  I'm a little confused -- is Xerces supposed to be in the classpath?\n(JDK 1.5 / ant 1.7)\n\n\\velocity-1.6-beta2\\build>ant examples\n\n\\velocity-1.6-beta2\\examples\\xmlapp_example>xmlapp_example.bat\n\nUsing classpath:  .;..\\..\\bin\\velocity-1.6-beta2.jar;..\\..\\bin\\lib\\antlr-2.7.5.jar;..\\..\\bin\\lib\\avalon-logkit-2.1.jar;..\\..\\bin\\l\nib\\commons-collections-3.2.1.jar;..\\..\\bin\\lib\\commons-lang-2.4.jar;..\\..\\bin\\lib\\commons-logging-1.1.jar;..\\..\\bin\\lib\\jdom-1.0.j\nar;..\\..\\bin\\lib\\log4j-1.2.12.jar;..\\..\\bin\\lib\\maven-ant-tasks-2.0.9.jar;..\\..\\bin\\lib\\oro-2.0.8.jar;..\\..\\bin\\lib\\servletapi-2.3\n.jar;..\\..\\bin\\lib\\werken-xpath-0.9.4.jar\nException building Document : org.jdom.JDOMException: Could not load org.apache.xerces.parsers.SAXParser: SAX2 driver class org.apache.xerces.parsers.SAXParser not found: org.apache.xerces.parsers.SAXParser", "created_at" : { "$date" : "2008-10-28T03:37:54.886+0000" }, "updated_at" : { "$date" : "2008-11-17T20:19:13.591+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dd95f627d84c8d6bc5f" }, "external_id" : "VELOCITY-643", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "when escaping directive escape character is emitted as well", "desc" : "Following line in template \n\n  * @see PersistenceManager\\#getObjectById(Object, boolean)\n\nemitted as \n\n   * @see PersistenceManager\\#getObjectById(Object, boolean)\n\nSince It happens in both 1.6-beta1 and beta2", "created_at" : { "$date" : "2008-11-15T22:35:44.139+0000" }, "updated_at" : { "$date" : "2008-11-17T20:44:36.807+0000" }, "creator_id" : { "$oid" : "5b7d36f4e9214a0d1608d739" }, "reporter_id" : { "$oid" : "5b7d36f4e9214a0d1608d739" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dda5f627d84c8d6bc67" }, "external_id" : "VELOCITY-526", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Update our maven POM to match Apache standards.", "desc" : "The following points are open\n\n- POM should extend the standard org.apache POM, this would reduce the amount of configuration from our POM.\n\n- POM and jar should be signed when deployed.\n\n- Strictly spoken, the POM itself can/should be voted on (we did vote on the POM as part of the last release)\n\n- We should also deploy a sources / javadoc jar \n\n- Maybe use the maven-ant tasks (http://maven.apache.org/ant-tasks.html) for deployment .", "created_at" : { "$date" : "2007-03-07T23:52:27.824+0000" }, "updated_at" : { "$date" : "2008-11-17T20:46:11.722+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddb5f627d84c8d6bc71" }, "external_id" : "VELOCITY-636", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove (mandatory) dependency on ANTLR from POM", "desc" : "A dependency on ANTLR 2.7.7 (BTW, the build.properties mentions version 2.7.5 in contrast) has been introduced in [r685386|http://svn.eu.apache.org/viewvc?view=rev&revision=685386]. The commit message (\"add findbugs support to maven build\") as well as the actual compilation indicates that this dependency is not an actual compile-time dependency of the engine. It's not clear to me why it was added in the first place, running \"mvn site\" succeeds without this dependency and the resulting FindBugs reports looks OK (ignoring the various issues it lists). For the sake of a proper class path in client applications of Velocity, this dependency should either be completely removed or at least marked optional (c.f. http://velocity.apache.org/engine/devel/jar-dependencies.html).", "created_at" : { "$date" : "2008-10-27T22:54:56.400+0000" }, "updated_at" : { "$date" : "2008-11-17T22:28:33.354+0000" }, "creator_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "reporter_id" : { "$oid" : "5b7d364ae9214a0d1608d6fa" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine", "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddb5f627d84c8d6bc7a" }, "external_id" : "VELOCITY-644", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong template name in Exception Message", "desc" : "If a reference within a macro causes an Exception, and the macro is defined in a different file, then the Exception message thrown by Velocity reports the name of the calling template file, and not the file that defines the macro.  However, the column number and line number are correct for the macro file.", "created_at" : { "$date" : "2008-11-23T03:08:09.517+0000" }, "updated_at" : { "$date" : "2008-11-24T16:59:45.418+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddc5f627d84c8d6bc86" }, "external_id" : "VELOCITY-649", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "NPE when calling method takes array", "desc" : "NPE caused when calling a method that takes an array:\n\n$foo.bar($bogus)\n\nwhere bar is defined as:\n\npublic void bar(int a[]){};\n\nand $bogus is not defined.\n\n\n\n\n", "created_at" : { "$date" : "2008-11-24T20:54:12.622+0000" }, "updated_at" : { "$date" : "2008-11-24T23:37:26.189+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddd5f627d84c8d6bc90" }, "external_id" : "VELOCITY-550", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocimacros defined in a page are also access by other pages", "desc" : "Hi, I have this weird problem in my velocity pages. I have two different modules on my website, both have a macro (with the same name) defined. For example, I have a macro #settable on module 1 and another #settable on module 2. They have the same name but the content differs slightly from each other. My problem is that soemtimes module1 access the #settable2 or vice versa.\n\nIt never crossed my mind that having the same name would be a problem since they are on different pages. I thought that macro definition should only be local and not global. I was only able to solve it by using this configuration\n\nvelocimacro.permissions.allow.inline.local.scope = true\n\nHowever this may affect other pages, is there another way to address this problem?\n", "created_at" : { "$date" : "2007-05-16T07:48:50.959+0000" }, "updated_at" : { "$date" : "2008-12-04T10:28:26.115+0000" }, "creator_id" : { "$oid" : "5b7d36f7e9214a0d1608d73b" }, "reporter_id" : { "$oid" : "5b7d36f7e9214a0d1608d73b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ddd5f627d84c8d6bc8f" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904d6a5f627d84c8d6b310" }, "external_id" : "VELOCITY-362", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904d6a5f627d84c8d6b311" }, "effect" : "is duplicated by", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b904d8c5f627d84c8d6b5a7" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "creator_id" : { "$oid" : "5b7d36f9e9214a0d1608d73d" }, "desc" : "I think this is a big bug. I've used velocity in my projects, erveything is ok\nbut this. i want to know it's this problem will be resolved in next version? if\nit's not, i have to abandon velocity.\nthe bug is :\nfrom doc:\n This is important to remember if you try to #parse() a template containing\ninline #macro() directives. Because the #parse() happens at runtime, and the\nparser decides if a VM-looking element in the template is a VM at parsetime,\n#parse()-ing a set of VM declarations won't work as expected. To get around\nthis, simply use the velocimacro.library  facility to have Velocity load your\nVMs at startup.", "reporter_id" : { "$oid" : "5b7d36f9e9214a0d1608d73d" }, "title" : "can't load macros in file loaded with #parse", "priority" : "Minor", "status" : "Resolved", "environment" : "Operating System: All\nPlatform: All", "updated_at" : { "$date" : "2008-12-04T16:19:15.552+0000" }, "issue_type" : "Improvement", "resolution" : "Fixed", "created_at" : { "$date" : "2005-02-26T14:50:17.000+0000" } },
{ "_id" : { "$oid" : "5b904dde5f627d84c8d6bcc6" }, "external_id" : "VELOCITY-645", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Value comparisons in strict mode should be strict", "desc" : "In strict mode throw an exception when values cannot be correctly compared instead for ignoring this case.\n\nFor example:\n#set($a = $NULL)\n#set($b = $NULL)\n#if ($a > $b)\n  foobar\n#end\n\n", "created_at" : { "$date" : "2008-11-23T20:16:57.803+0000" }, "updated_at" : { "$date" : "2008-12-23T09:04:06.065+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ddf5f627d84c8d6bcd1" }, "external_id" : "VELOCITY-600", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#foreach & velocityCount", "desc" : "velocityCount = Used in the #foreach() directive, defines the string to be used as the context key for the loop count. A template would access the loop count as $velocityCount.\n\nKnowing current version of the loop counter is very  useful, but something is missing. Very often, when you generate some content base on a model(JavaScript code based on some UI model) you have the need to know if this is the last time when the #foreach block will be executed or not. \n\nExample\n\nYou have a collection of objects Property(bean with key, value fields) and you want to generate a JavaScript object with them. The result should be like this :\n\n{id : 1 , name = \"John\", ...}\n\nyou can generate this with\n\n{\n#foreach($property in $properties)\n   $property.key : \"$property.value\" #if($velocityCount != $properties.size()) , #end\n#end\n}\n\nYou can store $properties.size() of course outside the loop.\n\nThe template will be less verbose if I will have something like that. #if($velocityHasNext) , #end.\n\nInstead of saving only the counter, a new variable called velocityHasNext whould be populated with the result of iterator.hasNext(). This is a minor modification of current #foreach directive\n\nwhile (!maxNbrLoopsExceeded && i.hasNext())\n        {\n            // TODO: JDK 1.4+ -> valueOf()\n            context.localPut(counterName , new Integer(counter));\n            context.localPut(hasNextName , i.hasNext()); <--- here is the change\n            Object value = i.next();\n            context.localPut(elementKey, value);\n\n            /*\n             * If the value is null, use the special null holder context\n             */\n            if( value == null )\n            {\n                if( nullHolderContext == null )\n                {\n                    // lazy instantiation\n                    nullHolderContext = new NullHolderContext(elementKey, context);\n                }\n                node.jjtGetChild(3).render(nullHolderContext, writer);\n            }\n            else\n            {\n                node.jjtGetChild(3).render(context, writer);\n            }\n            counter++;\n\n            // Determine whether we're allowed to continue looping.\n            // ASSUMPTION: counterInitialValue is not negative!\n            maxNbrLoopsExceeded = (counter - counterInitialValue) >= maxNbrLoops;\n        }\n\nalso init should contain\n\npublic void init(RuntimeServices rs, InternalContextAdapter context, Node node)\n        throws TemplateInitException\n    {\n        super.init(rs, context, node);\n\n        counterName = rsvc.getString(RuntimeConstants.COUNTER_NAME);\n        hasNextName = rsvc.getString(RuntimeConstants.HAS_NEXT_NAME);\n        counterInitialValue = rsvc.getInt(RuntimeConstants.COUNTER_INITIAL_VALUE);\n\n       ....\n    }\n\nThis should help creating clear templates(and avoid some mistakes, sometime - like using the wrong collection to test :) ).\n\nThanks.\n \n\n", "created_at" : { "$date" : "2008-06-09T19:41:41.958+0000" }, "updated_at" : { "$date" : "2008-12-27T23:05:00.655+0000" }, "creator_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "reporter_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904ddf5f627d84c8d6bcd0" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904de05f627d84c8d6bcf9" }, "external_id" : "VELOCITY-655", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macro parameter value can't be changed inside a macro", "desc" : "I've detected a problem when changing parameter values inside a macro using velocity engine version 1.6.\n\nIn my use case I have to lower the input string first and then do further processing.\n\nWith version 1.5 of the velocity engine there were no problems to implement this use case.\n\nHere is an example which shows the differences between version 1.5 and 1.6:\n\nTemplate-Code:\n{code}\n#macro(testMacro $x)\n#set ($x = $x.toLowerCase())\n#set ($y = $x.toLowerCase())\nx=$x\ny=$y\n#end\n#testMacro('ABCDEFGHIJKLMNOPQRSTUVWXYZ-Testcase1')\n#testMacro(\"ABCDEFGHIJKLMNOPQRSTUVWXYZ-Testcase2\")\n{code}\n\nResult with Velocity Engine 1.5:\nx=abcdefghijklmnopqrstuvwxyz-testcase1\ny=abcdefghijklmnopqrstuvwxyz-testcase1\nx=abcdefghijklmnopqrstuvwxyz-testcase2\ny=abcdefghijklmnopqrstuvwxyz-testcase2\n\nResult with Velocity Engine 1.6:\nx=ABCDEFGHIJKLMNOPQRSTUVWXYZ-Testcase1\ny=abcdefghijklmnopqrstuvwxyz-testcase1\nx=ABCDEFGHIJKLMNOPQRSTUVWXYZ-Testcase2\ny=abcdefghijklmnopqrstuvwxyz-testcase2\n", "created_at" : { "$date" : "2008-12-09T12:14:56.751+0000" }, "updated_at" : { "$date" : "2008-12-28T21:59:15.658+0000" }, "creator_id" : { "$oid" : "5b7d36ffe9214a0d1608d73e" }, "reporter_id" : { "$oid" : "5b7d36ffe9214a0d1608d73e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.1" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de15f627d84c8d6bd09" }, "external_id" : "VELOCITY-406", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Improved Syntax for Maps and Collections", "desc" : "I would like to see some syntatic sugar for Maps and Collections and perhaps other Objects too. \n(I have read that there will be a syntax for map literals in 1.5, that's a first step.)\n\nI want to have something like in groovy: http://groovy.codehaus.org/Collections\nScroll down to \"Slicing with the subscript operator\".\n\nPS: Please do never implement this terrible confusing groovy map bean syntax, where \"map.foo\" ist equivalent to \"map.get(\"foo\")\".\n", "created_at" : { "$date" : "2005-09-26T18:17:52.000+0000" }, "updated_at" : { "$date" : "2009-01-02T18:35:37.136+0000" }, "creator_id" : { "$oid" : "5b7d3675e9214a0d1608d710" }, "reporter_id" : { "$oid" : "5b7d3675e9214a0d1608d710" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de25f627d84c8d6bd26" }, "external_id" : "VELOCITY-656", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrap ref evaluate exception so vm location is revealed", "desc" : "The following VTL calls the toString() method on the object in $foo:\n\n#if($foo)#end  \n\nIf the toString() method throws an exception, the exception is thrown all the way out of velocity without any indication of where the vtl reference occurred.  This patch wraps the exception with a VelocityException with a message that indicates the location of the offending reference.\n\nHowever, I wonder why toString() is called at all...  the code tests for toString() == null and returns false if so, and true otherwise in the above example vtl.  Why is this test necessary, and why isn't just a non-null object enough for testing?\n\n\n", "created_at" : { "$date" : "2008-12-10T16:25:43.902+0000" }, "updated_at" : { "$date" : "2009-01-03T16:11:37.932+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1", "1.7", "1.6" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de25f627d84c8d6bd3a" }, "external_id" : "VELOCITY-662", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "EventHandler.referenceInsert performance bottleneck", "desc" : "The times resulting from SimpleNode.literal, StrBuilder.append (the top two) and EventHandlerUtil.referenceInsert are due to the following line in ASTReference.render:\n\nvalue = EventHandlerUtil.referenceInsert(rsvc, context, literal(), value);\n\nWhich accounts for nearly 25% of the time, Ouch! Not to mention the many number of StrBuilder objects created. (StrBuilder is called from within literal()) We are always taking the hit for this call even if there is no event handler installed. I havn't looked into it, but will probably just put a conditional around it.", "created_at" : { "$date" : "2009-01-03T20:23:28.773+0000" }, "updated_at" : { "$date" : "2009-01-04T04:43:45.142+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de35f627d84c8d6bd41" }, "external_id" : "VELOCITY-663", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "getAllowRendering() performance bottleneck", "desc" : "getAllowRendering() methods which wraps all calls to the writer within the ASTNode renders and account for 11% of the time. I'm a little surprised by this because it just returns a member, but it may be due to the multiple layers of delegates and interfaces.  From what I can tell, the purpose of this method is to serve the #stop directive (which the documentation claims is for debugging).  I've always thought that #stop stopped execution of the script, but it doesn't, it continues executing the script and doesn't write anything to the writer, Yikes.  I wonder if this shouldn't be implemented like #break, by throwing an exception which is caught at the top.  Execution of the script would stop, and getAllowRendering could be removed.", "created_at" : { "$date" : "2009-01-03T20:24:55.605+0000" }, "updated_at" : { "$date" : "2009-01-04T15:16:16.764+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de35f627d84c8d6bd48" }, "external_id" : "VELOCITY-664", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unnecessary double storing of template text", "desc" : "ASTText makes a copy of the token image and uses the copy to render.  This means that ASTText keeps two copies of the text.  In the majority of cases ASTText can use the token image.", "created_at" : { "$date" : "2009-01-03T20:30:57.734+0000" }, "updated_at" : { "$date" : "2009-01-05T21:10:05.476+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de45f627d84c8d6bd59" }, "external_id" : "VELOCITY-665", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "issues.Velocity614TestCase fails because patch for VELOCITY-71 was removed", "desc" : "In VelocimacroProxy.checkArgs there is no longer check for the validity of macro arguments. As a result, Velocity614TestCase fails. I can't see why we could remove the macro argument check?\n\nOtherwise good job on refactoring the init/checkArgs logic. I was thinking about the same thing. Now there is no synchronized block overhead.", "created_at" : { "$date" : "2009-01-11T11:18:25.614+0000" }, "updated_at" : { "$date" : "2009-01-11T12:03:45.437+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7", "1.6.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de55f627d84c8d6bd61" }, "external_id" : "VELOCITY-668", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Minor performance tweaks based on Findbugs findings", "desc" : "Mainly change two inner classes to static inner classes and a few other slight modifications. See the patch.", "created_at" : { "$date" : "2009-01-19T10:06:30.935+0000" }, "updated_at" : { "$date" : "2009-01-20T22:18:48.979+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de55f627d84c8d6bd6d" }, "external_id" : "VELOCITY-670", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macro escaping inconsistent with forward references", "desc" : "Escaping a macro behaves differently if the macro is forward referenced. for example the following:\n\n#macro(foo)bar#end\n\\#foo\n\ngives result:\n\n#foo\n\nHowever this:\n\n\\#foo\n#macro(foo)bar#end\n\ngives result:\n\n\\#foo\n\n\n", "created_at" : { "$date" : "2009-01-20T12:52:35.246+0000" }, "updated_at" : { "$date" : "2009-01-21T16:38:13.606+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904de55f627d84c8d6bd6c" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904de75f627d84c8d6bd83" }, "external_id" : "VELOCITY-623", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Modify escape behavior in strict mode", "desc" : "provides another property 'runtime.references.strict.escape' that when true modifies the behavior of escaping a reference when in strict mode, see discussion VELOCITY-618.  The behavior is a as follows:\n\n$abc = <exception>    -  If $abc is not defined\n\\$abc = $abc \n\\\\$abc = <exception>  - If $abc is  not defined\n\\\\\\$abc = \\$abc\n\nThe backslash in front of a reference always prevents that reference from being evaluated, and the backslash is removed. This is true wether a reference is in the context or not.\n", "created_at" : { "$date" : "2008-10-10T02:13:25.739+0000" }, "updated_at" : { "$date" : "2009-01-23T11:53:08.156+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904de55f627d84c8d6bd6c" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b904de75f627d84c8d6bd99" }, "external_id" : "VELOCITY-673", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove calling init method from the VelocityEngine non default constructors", "desc" : "Based on the following user group discussion:\n\n\nOn Jan 19, 2009, at 13:44 , lacco wrote:\n\nOkay, it works now: The init method shouldn't be called at all when setting\nproperties by hand... Besides, the servlet context has to be set. My final version:\n\nVelocityEngine ve = new VelocityEngine();\nve.setApplicationAttribute(\"javax.servlet.ServletContext\",\nservletContext);\nve.setProperty(\"resource.loader\", \"webapp\");\nve.setProperty(\"webapp.resource.loader.class\",\n\"org.apache.velocity.tools.view.servlet.WebappLoader\");\nve.setProperty(\"webapp.resource.loader.path\",\n\"/WEB-INF/classes/de/hpi/petrinet/serialization/erdf\");\nTemplate t = ve.getTemplate( \"petrinet.erdf.vm\" );\n\nOn Mon, Jan 19, 2009 at 11:12 PM, Byron Foster <byron@base2.cc> wrote:\n\nYea, I think this is confusing.  Calling the non default constructors for\nVelocityEngine calls the init() method, but calling the default constructor\ndoes not. So, if you call VelocityEngine(props) then you can't set any more\nproperties after that point.\n\nNathan responded:\n\nAgreed.  Let's change that.  Besides, most methods that need Velocity\nto be init'ed will now call it themselves if used before init() has\nbeen called.  There is absolutely no reason to call init from any\nconstructor.\n", "created_at" : { "$date" : "2009-01-20T22:15:08.564+0000" }, "updated_at" : { "$date" : "2009-01-24T14:33:00.483+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de85f627d84c8d6bda0" }, "external_id" : "VELOCITY-669", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Concurrency bug introduced in 1.7-dev", "desc" : "Warning: current SVN head is broken - it fails under heavy load. I don't have time to investigate right now but 1.6.1 release version does not have this bug (1.6.2 release candidate may have it! - I'm not sure what's included there). However, current SVN head fails consistently with my load testing suite when I run it under JRat profiling:\n\n-------------------------------------------------------------------------------\nTest set: org.apache.velocity.test.load.Velocity24LoadTest\n-------------------------------------------------------------------------------\nTests run: 250, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 71.032 sec <<< FAILURE!\ntestRendering(org.apache.velocity.test.load.Velocity24Test)  Time elapsed: 0.125 sec  <<< ERROR!\njava.lang.NullPointerException\n\tat java.io.Writer.write(Writer.java:110)\n\tat org.apache.velocity.runtime.parser.node.ASTText.render_$jrat(ASTText.java:83)\n\tat org.apache.velocity.runtime.parser.node.ASTText.render(ASTText.java)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render_$jrat(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render_$jrat(VelocimacroProxy.java:222)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render_$jrat(RuntimeMacro.java:295)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render_$jrat(RuntimeMacro.java:215)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render_$jrat(ASTDirective.java:198)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render_$jrat(SimpleNode.java:342)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java)\n\tat org.apache.velocity.Template.merge_$jrat(Template.java:340)\n\tat org.apache.velocity.Template.merge(Template.java)\n\tat org.apache.velocity.Template.merge_$jrat(Template.java:248)\n\tat org.apache.velocity.Template.merge(Template.java)\n\tat org.apache.velocity.test.load.Velocity24Test.testRendering_$jrat(Velocity24Test.java:52)\n\tat org.apache.velocity.test.load.Velocity24Test.testRendering(Velocity24Test.java)\n\nAlthough I'm not sure, I strongly suspect that this has got something to do with refactoring done (2009-01-11) for VelocimacroProxy.init. In 1.6.1 the init function initializes the nodeTree variable but if I'm not mistaken, in current SVN head this does not happen(!). It seems that under certain conditions the engine tries to render an ASTText node that has not been initialized (char array is null) which causes this exception. ", "created_at" : { "$date" : "2009-01-19T12:33:49.855+0000" }, "updated_at" : { "$date" : "2009-01-27T17:46:03.207+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904de95f627d84c8d6bdab" }, "external_id" : "VELOCITY-708", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "The Method map does not get created correctly when the inspected class implements interface which itself has a rich inheritance tree", "desc" : "Consider the following implementation\n\npublic interface MySuperInterface() {\n   public getName()[\n}\n\npublic interface MyInterface extends MySuperInterface() { \n}\n\nclass MyClass implements MyInterface {\n .....\n}\n\nIf I provide an instance of MyClass in the context, then engine is unable to resolve reference following reference\n\n$myClasref.name\n\nThe bug is in the following method -> org.apache.velocity.util.introspection.ClassMap.createMethodCache().\n\nThis method does not introspect the super interface.\n\n", "created_at" : { "$date" : "2009-02-23T10:06:38.034+0000" }, "updated_at" : { "$date" : "2009-02-23T15:07:06.207+0000" }, "creator_id" : { "$oid" : "5b7d370fe9214a0d1608d740" }, "reporter_id" : { "$oid" : "5b7d370fe9214a0d1608d740" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.6.2" ], "issue_links" : [  ], "environment" : "ALL" },
{ "_id" : { "$oid" : "5b904de95f627d84c8d6bdb4" }, "external_id" : "VELOCITY-707", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity's pom does not define compile source and target", "desc" : "The pom file does not define compile source and target levels.\nSince the default are, respectively, 1.3 and 1.1, they should be set both to 1.4.\n", "created_at" : { "$date" : "2009-02-23T08:44:31.173+0000" }, "updated_at" : { "$date" : "2009-02-23T15:39:23.277+0000" }, "creator_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "reporter_id" : { "$oid" : "5b7d3710e9214a0d1608d741" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [  ], "environment" : "Maven 2 environment" },
{ "_id" : { "$oid" : "5b904dea5f627d84c8d6bdbe" }, "external_id" : "VELOCITY-705", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Dynamic VTL reference modification directive", "desc" : "Currently EventHandlers are defined in velocity.properties like:\n\neventhandler.referenceinsertion.class =\n\nThe problem is that AFAIK this handler is active in every reference evaluation (and every template). I propose a dynamic setting that can be chained and turned on and off during template rendering.\n\nSyntax might be something like:\n\n#filter($myReferenceModifier)\n\n any VTL here ($foo type references are modified using the class referred by $myReferenceModifier)\n#end\n\nThe basic idea is that you put some classes that implement e.g. ReferenceInsertionEventHandler interface to the Context and then you can use those to filter/modify some selected parts of the template. #filter directive should allow nesting (one #filter directive contain another #filter directive).\n\nIt's probably also necessary to disable filtering for selected elements inside the filter block.\n\nIt might be also useful to be able to limit the amount of reference names that are passed to the filter. Like:\n#filter($myReferenceModifier ['a', 'foo', 'html'])\n\n----\nUse Case for this feature is that often you need to escape form values and other elements to avoid XSS attacks etc. Escaping all references in all templates seems like an overkill (and isn't very performance friendly either). This feature would allow you to do escaping dynamically only for selected elements.\n\nWhat do you think?", "created_at" : { "$date" : "2009-02-21T08:46:11.015+0000" }, "updated_at" : { "$date" : "2009-03-02T06:46:01.255+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904deb5f627d84c8d6bdc5" }, "external_id" : "VELOCITY-680", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "RFC: New #local directive that behaves like #set but puts things into local context in macro rendering", "desc" : "It would be very useful to be able to set variables that are in local macro scope. That is, they do not overwrite \"global\" variables and are thrown away after macro rendering. This would allow people to build macro libraries that do not clash so easily with each other.\n\nThere is some implementation of a \"LocalDirective\" in experimental/localdirective but I didn't quite get it and it doesn't follow the same syntax as #set. I used a few minutes to hack together this alternative implementation which behaves exactly like #set but it puts things in local context only.\n\nThere's only one test case since this is Request-for-Comments type of patch.", "created_at" : { "$date" : "2009-01-22T18:12:57.816+0000" }, "updated_at" : { "$date" : "2009-03-12T16:32:35.140+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dec5f627d84c8d6bde8" }, "external_id" : "VELOCITY-714", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Change ResourceLoader API to return Reader instances instead of InputStreams", "desc" : "Abstract class org.apache.velocity.runtime.resource.loader.ResourceLoader contains method\n\n    public abstract InputStream getResourceStream( String source )\n        throws ResourceNotFoundException;\n\nHowever, in org.apache.velocity.Template.process() there is code (abbreviated):\n\n        try\n        {\n            is = resourceLoader.getResourceStream(name);\n        }\n        catch( ResourceNotFoundException rnfe )\n        {\n            errorCondition = rnfe;\n            throw rnfe;\n        }\n\n        if (is != null)\n        {\n            try\n            {\n                BufferedReader br = new BufferedReader( new InputStreamReader( is, encoding ) );\n                data = rsvc.parse( br, name);\n...\n\nThis seems a bit silly. ResourceLoaders should obviously return Reader instances since those would allow loaders to take content encoding into account. Currently this is problematic especially with DataSourceResourceLoader (VELOCITY-599). If we want to support UTF-8 in DataSourceResourceLoader, with current API we would first have to use ResultSet.getCharacterStream to get a Reader, then read all stuff into a String, then convert it into UTF-8 encoding with getBytes call but then in the Template the whole stuff is then converted back to a Reader. That's a lot of waste.\n\nI think it would make more sense if the ResourceLoader API contained a method:\n\n    public abstract Reader getResource( String source )\n        throws ResourceNotFoundException;\n\n\n", "created_at" : { "$date" : "2009-05-02T14:43:56.337+0000" }, "updated_at" : { "$date" : "2009-05-04T14:10:14.802+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dba5f627d84c8d6ba18" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904dec5f627d84c8d6bde7" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904dec5f627d84c8d6bdf2" }, "external_id" : "VELOCITY-659", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove throwing Exception from method signatures", "desc" : "Remove throwing java.lang.Exception from Velocity methods", "created_at" : { "$date" : "2008-12-29T03:50:18.345+0000" }, "updated_at" : { "$date" : "2009-05-13T21:07:55.316+0000" }, "creator_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "reporter_id" : { "$oid" : "5b7d36cee9214a0d1608d733" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ded5f627d84c8d6be00" }, "external_id" : "VELOCITY-721", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Handle the exception HTTP Error 413 - Request entity too large in the exceptions section of Velocity engine", "desc" : "The following exceptions are currently handled in velocity engine: \n1. ExtendedParseException \n2. MacroOverflowException \n3. MathException \n4. MethodInvocationException\n5. ParseErrorException\n6. ResourceNotFoundException\n7. TemplateInitException\n\nI suggest that another exception RequestEntityTooLarge also be handled by the velocity engine. When the client requests an entity that is too large from the application hosted on the web server, the server throws \"Request  Entity  Too  Large\" exception with the status code 413. \n\nCan this HTTP 413 Request  Entity  Too  Large exception be handled in velocity engine? Please let me know if this suggestion is beneficial. I am frequently getting this error which could be handled.\n\nRegards,\nAruna", "created_at" : { "$date" : "2009-05-28T11:36:02.252+0000" }, "updated_at" : { "$date" : "2009-05-29T05:26:20.824+0000" }, "creator_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "reporter_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.6.2" ], "issue_links" : [  ], "original_time_estimate" : 57600, "environment" : "Windows XP, j2sdk1.4.2_13, " },
{ "_id" : { "$oid" : "5b904dee5f627d84c8d6be08" }, "external_id" : "VELOCITY-722", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unable to download velocity 1.6.2 zip on download.cgi page", "desc" : "Registration has been disabled message on click of velocity 1.6.2 zip on download.cgi page\n\nGo to http://velocity.apache.org/download.cgi \n\nClick on velocity-1.6.2.zip under Binaries and sources section\n\nhttp://bluedogfan.com/wp-signup.php?new=mirrors page is displayed with the message Registration has been disabled.\n\nRefer screenshot (Velocity-1.6.2.zip download.doc) attached\n", "created_at" : { "$date" : "2009-05-29T06:17:06.537+0000" }, "updated_at" : { "$date" : "2009-06-01T05:27:39.654+0000" }, "creator_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "reporter_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.6.2" ], "issue_links" : [  ], "original_time_estimate" : 57600 },
{ "_id" : { "$oid" : "5b904dee5f627d84c8d6be14" }, "external_id" : "VELOCITY-723", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "URL of Velocity link on getting started page on the website needs to be changed", "desc" : "Can we change the url of velocity link on http://velocity.apache.org/engine/devel/getting-started.html page?\n\nThis url will ultimately redirect the user to http://bluedogfan.com/wp-signup.php?new=mirrors page which is useless\n\nSteps to reproduce this bug:\n1. Go to http://velocity.apache.org/engine/devel/getting-started.html \n2. Under downloading velocity section, click on Velocity link\n3. http://velocity.apache.org/download.cgi#engine is displayed\n4. Click on velocity-1.6.2.zip under Binaries and sources section\n5. http://bluedogfan.com/wp-signup.php?new=mirrors page is displayed with the message Registration has been disabled.\n\nTo fix this bug i have changed http://svn.apache.org/repos/asf/velocity/engine/trunk/xdocs/docs/getting-started.xml code. \n\nUnder section dowloading velocity i have changed:\n<a href=\"http://velocity.apache.org/download.cgi#engine\">Velocity</a>\n\nto\n\n<a href=\"http://www.apache.org/dist/velocity/engine\">Velocity</a>\n\nhttp://www.apache.org/dist/velocity/engine URL works. Please let me know your comments on this. Can i checkout and commit this patch?\n\nPlease find attached the modified getting-started.xml code. Also the steps to reproduce the issue has been attached in Gettting Started.doc\n\nRegards,\nAruna", "created_at" : { "$date" : "2009-05-29T07:21:14.633+0000" }, "updated_at" : { "$date" : "2009-06-01T06:03:27.370+0000" }, "creator_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "reporter_id" : { "$oid" : "5b7d3713e9214a0d1608d742" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "1.6.2" ], "issue_links" : [  ], "original_time_estimate" : 3600 },
{ "_id" : { "$oid" : "5b904df05f627d84c8d6be2a" }, "external_id" : "VELOCITY-726", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Add StringResourceLoader", "desc" : "I would like to see an implementation of ResourceLoader that where you can pass a literal String, and that is the template. Something like this:\n\npublic class StringResourceLoader extends ResourceLoader\n{\n\t@Override\n\tpublic void init( ExtendedProperties extendedProperties )\n\t{\n\t}\n\n\t@Override\n\tpublic InputStream getResourceStream( String s ) throws ResourceNotFoundException\n\t{\n\t\treturn new ByteArrayInputStream( s.getBytes() );\n\t}\n\n\t@Override\n\tpublic boolean isSourceModified( Resource resource )\n\t{\n\t\treturn true;\n\t}\n\n\t@Override\n\tpublic long getLastModified( Resource resource )\n\t{\n\t\treturn 0;\n\t}\n}\n\nI tested this and it works, but I am assuming this could be handy for others as well.\n\nOn a side note. Why do you have all this ResourceLoaders and their configuration? Would it not be easier to just create a getTemplate( InputStream ) method, then people can get the inputstream from whereever they want? I had now go through quite some hoops with classloading because I need to use Velocity from a plugin into another system. (For those also struggeling with this, you need to call:\n\nThread.currentThread().setContextClassLoader( getClass().getClassLoader() );\n\nbefore you create your VelocityContext, and use the ClasspathResourceLoader)", "created_at" : { "$date" : "2009-06-11T06:37:52.783+0000" }, "updated_at" : { "$date" : "2009-06-11T14:19:03.592+0000" }, "creator_id" : { "$oid" : "5b7d3716e9214a0d1608d744" }, "reporter_id" : { "$oid" : "5b7d3716e9214a0d1608d744" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df05f627d84c8d6be32" }, "external_id" : "VELOCITY-733", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Not able to interpret .vm(velocity file)", "desc" : "I'm trying to evaluate Quartz application to run on Weblogic Server. When I deploy the Quartz web application through Weblogic workshop it works fine. The problem comes when I package it into a .ear file and deploy it using Weblogic console. The jsp pages gets loaded but the .vm files doesn't. There seems to be some problem with the loading mechanism. ", "created_at" : { "$date" : "2009-08-25T06:02:39.558+0000" }, "updated_at" : { "$date" : "2009-08-25T15:51:12.335+0000" }, "creator_id" : { "$oid" : "5b7d3717e9214a0d1608d745" }, "reporter_id" : { "$oid" : "5b7d3717e9214a0d1608d745" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 172800, "environment" : "WebLogic 10.3.0" },
{ "_id" : { "$oid" : "5b904df15f627d84c8d6be3d" }, "external_id" : "VELOCITY-637", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "JPA ResourceLoader", "desc" : "Provide an JPA ResourceLoader, similar to the DataSource ResourceLoader but allowing for injection of an EntityManager(Factory) with configurable named queries.", "created_at" : { "$date" : "2008-10-27T23:02:06.876+0000" }, "updated_at" : { "$date" : "2009-10-18T17:44:18.668+0000" }, "creator_id" : { "$oid" : "5b7d3719e9214a0d1608d746" }, "reporter_id" : { "$oid" : "5b7d3719e9214a0d1608d746" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df25f627d84c8d6be49" }, "external_id" : "VELOCITY-738", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "It would be useful to know that the error is occurred in which context.", "desc" : "It would be better, if an error message display surroundings of the place where the error is. \nFor example: \nTo display that an \"(\" character is illegal (there are hundreds of those characters in a template)\nbut it would be useful to know that this character occurred in the context \"product.getName()\".", "created_at" : { "$date" : "2009-10-15T08:27:22.158+0000" }, "updated_at" : { "$date" : "2009-11-03T02:54:32.857+0000" }, "creator_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "reporter_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df35f627d84c8d6be5d" }, "external_id" : "VELOCITY-587", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Backslashes throw lexical errors in double-quoted strings", "desc" : "The VTL doesn't currently provide a way to express strings containing a single backslash (\\)\n\n    #set($backslash=\"\\\") \n\nresults in a lexical error during template parsing.\n\n   #set($backslash=\"\\\\\")\n\nresults in $backslash being assigned a string containing two backslashes (\\\\)\n\nIt appears the only workaround available now is to construct a variable containing just  a single backslash with this idiom:\n\n   #set($twobackslashes=\"\\\\\")\n   #set($backslash=$twobackslashes.substring(0,1))\n\nEven if this can't be fixed in the parser, the documentation should be updated to define a preferred idiom for obtaining a string containing a single backslash.\n\njon.\n\nnote: this issue partially duplicates a comment by Guido Deinhammer on issue #454 regarding other escaping issues. I have raised a separate issue, so that this one can be addressed separately, if desired.", "created_at" : { "$date" : "2008-02-11T04:41:08.756+0000" }, "updated_at" : { "$date" : "2010-01-03T15:10:55.204+0000" }, "creator_id" : { "$oid" : "5b7d3720e9214a0d1608d749" }, "reporter_id" : { "$oid" : "5b7d3720e9214a0d1608d749" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.6" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df35f627d84c8d6be5c" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904df55f627d84c8d6be75" }, "external_id" : "VELOCITY-519", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df55f627d84c8d6be76" }, "external_id" : "VELOCITY-520", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "\"\\u0061\" causes lexer exception", "desc" : "The test:\n\n===\n    public void testU() throws Exception {\n        VelocityEngine ve = new VelocityEngine();\n        ve.init();\n        Context context = new VelocityContext();\n\n        StringWriter writer;\n\n        writer = new StringWriter();\n        ve.evaluate(context, writer, \"test\",\"#set($v = \\\"\\\\u0061\\\")$v\");\n        //assertEquals(\"a\", writer.toString());\n    }\n===\n\nI think \"\\u0061\" shoud produce \"a\", see VELOCITY-519. But if not, this should produce string \"\\u0061\", literally, but not exception, as now.", "created_at" : { "$date" : "2007-02-24T00:44:41.481+0000" }, "updated_at" : { "$date" : "2010-01-03T15:12:04.451+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "1.5 beta2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df35f627d84c8d6be5c" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b904df55f627d84c8d6be75" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904df55f627d84c8d6be82" }, "external_id" : "VELOCITY-751", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df55f627d84c8d6be83" }, "external_id" : "VELOCITY-436", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Remove \"Exception\" type throwing.", "desc" : "I have to use Checkstyle coding standards at my job. Some methos of Velocity throw exceptions using the raw \"Exception\" type. So Checkstyle points an error everywhere I use Velocity and, unfortunately, that's a fact I cannot override in my source code. So it would be nice if those \"throws Exception\" are replaced by some Velocity proper exception.", "created_at" : { "$date" : "2006-03-20T21:41:19.000+0000" }, "updated_at" : { "$date" : "2010-01-10T16:12:49.068+0000" }, "creator_id" : { "$oid" : "5b7d3722e9214a0d1608d74a" }, "reporter_id" : { "$oid" : "5b7d3722e9214a0d1608d74a" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df55f627d84c8d6be82" }, "effect" : "is cloned by", "type" : "Cloners" } ], "environment" : "NA" },
{ "_id" : { "$oid" : "5b904df65f627d84c8d6be91" }, "external_id" : "VELOCITY-667", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Regression: Specifying #macro without parenthesis no longer throws VelocityException", "desc" : "With version 1.5, VelocityEngine.mergeTemplate() would throw VelocityException if I specified a grammar error in the template. This is what I was using my unit test to show that parsing would fail:\n\n#macro #macro\n\nNow in 1.6.1, it renders an empty string. Method:\nvelocityEngine.mergeTemplate(templateLocation, velocityContext, writer);", "created_at" : { "$date" : "2009-01-18T21:46:38.434+0000" }, "updated_at" : { "$date" : "2010-02-19T16:33:42.633+0000" }, "creator_id" : { "$oid" : "5b7d3723e9214a0d1608d74d" }, "reporter_id" : { "$oid" : "5b7d3723e9214a0d1608d74d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.2" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df75f627d84c8d6bea1" }, "external_id" : "VELOCITY-666", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Blockmacro support (allows any AST as macro body argument)", "desc" : "Inspired by VELOCITY-583 (BlockMacro support) I implemented the same functionality in a slightly different way.\n\nThe new syntax is:\n\n#@yourMacroName($arg1 $arg2) any valid velocity AST here #end\n\nso basically the syntax is exactly the same as for normal macros except you put that @ prefix to the macro name. That tells Velocity that there's a macro AST body that should be passed to the actual macro.\n\nAnd in the macro you can refer to the passed body 0-N times. Like:\n\n#macro(yourMacroName $foo $bar)\n   $bodyContent\n#end", "created_at" : { "$date" : "2009-01-13T18:17:59.317+0000" }, "updated_at" : { "$date" : "2010-03-30T02:56:20.800+0000" }, "creator_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "reporter_id" : { "$oid" : "5b7d3669e9214a0d1608d708" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7", "1.6.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df75f627d84c8d6bea0" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904df75f627d84c8d6bec0" }, "external_id" : "VELOCITY-764", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Download page http://velocity.apache.org/download.html is empty", "desc" : "Download page http://velocity.apache.org/download.html is empty.\n\nLooks as though a recent change may have occurred.", "created_at" : { "$date" : "2010-05-22T15:48:22.260+0000" }, "updated_at" : { "$date" : "2010-05-25T14:01:17.300+0000" }, "creator_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "reporter_id" : { "$oid" : "5b7d3544e9214a0d1608d679" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Website" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "http://velocity.apache.org/download.html" },
{ "_id" : { "$oid" : "5b904df85f627d84c8d6bec7" }, "external_id" : "VELOCITY-677", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df85f627d84c8d6bec8" }, "external_id" : "VELOCITY-767", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "'$' at end of template raises org.apache.velocity.runtime.parser.TokenMgrError", "desc" : "When parsing a velocity template ending with a '$', the engine raises a org.apache.velocity.runtime.parser.TokenMgrError.\nEven if the '$' is escaped ('\\$')\n\nAnd the message is not really helful : Lexical error: org.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 1, column 16. Encountered: <EOF> after : \"\"\n\n(As a temporary workaround, I append '{esc.d}' at the end of the template if it ends with a '$')", "created_at" : { "$date" : "2010-06-09T09:31:23.175+0000" }, "updated_at" : { "$date" : "2010-06-10T16:30:34.349+0000" }, "creator_id" : { "$oid" : "5b7d3729e9214a0d1608d74e" }, "reporter_id" : { "$oid" : "5b7d3729e9214a0d1608d74e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904df85f627d84c8d6bec7" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b904df95f627d84c8d6bed0" }, "external_id" : "VELOCITY-770", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Infinite loop when upgrade Velocity to 1.6.2", "desc" : "I have replace a velocity from version 1.5 to 1.6.2 and encounter infinite loop when use with IteratorTool\nThis code is worked with version 1.5\n\n#set($limit = 2) \n#set ($listForIter = [1,2,3,4,5,6,7,8,9,10]) \n#set ($numbersSet = $iterator.wrap($listForIter))\n#foreach ($counter in $numbersSet)\n   #if ($counter <= $limit) \n      $numbersSet.more()\n   #end\n#end", "created_at" : { "$date" : "2010-06-28T11:11:59.960+0000" }, "updated_at" : { "$date" : "2010-07-06T08:05:41.000+0000" }, "creator_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "reporter_id" : { "$oid" : "5b7d371be9214a0d1608d747" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.6.x" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904df95f627d84c8d6bed7" }, "external_id" : "VELOCITY-771", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error when creation jar-J2EE with ant build.", "desc" : "Can't build J2EE jar for loading templates from database,\nwith command:\n\nant jar-J2EE\n\nthis is the error:\nBUILD FAILED\nTarget \"jar-J2EE\" does not exist in the project \"Velocity\".\n\n==========================================================\nfrom https://www.hasustorm.com/books/English/John.Wiley.And.Sons.Mastering.Apache.Velocity.eBook-KB.pdf\n\nThe DataSource resource loader, implemented by Velocity's DataSourceResourceLoader\nclass, obtains its resources via physical data source connections\nobtained through a Java DataSource object. An obvious example is a case\nwhere Velocity templates and related resources are obtained from a relational\ndatabase. This resource loader uses all of the resource loader properties, except\nfor resource.loader.path. It also supports several other properties that are\nunique to this type of loader. For more information regarding these properties,\nsee the Velocity's API documentation for its DataSourceResourceLoader class.\nThis resource loader requires J2EE and is not included in the standard Velocity\nbuild.\n\njar-J2EEThis build target compiles a complete Velocity JAR just as in the\ncase of the jar build target, but it also includes the J2EE JAR file. The build\ntarget requires a copy of j2ee.jar in the /build/lib directory or a link. The\ncommand line is:\nant jar-J2EE\n==========================================================\n\n", "created_at" : { "$date" : "2010-08-04T08:29:39.291+0000" }, "updated_at" : { "$date" : "2010-09-01T05:57:40.869+0000" }, "creator_id" : { "$oid" : "5b7d3735e9214a0d1608d74f" }, "reporter_id" : { "$oid" : "5b7d3735e9214a0d1608d74f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dfa5f627d84c8d6bee2" }, "external_id" : "VELOCITY-774", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide #unset directive", "desc" : "Sometimes one wants to use a variable in a certain scope because the further existence might lead to errors. I declared var with #set should be unsettable. See VELOCITY-773 for a iuse case.", "created_at" : { "$date" : "2010-08-26T13:38:53.535+0000" }, "updated_at" : { "$date" : "2010-09-18T00:28:03.534+0000" }, "creator_id" : { "$oid" : "5b7d3736e9214a0d1608d750" }, "reporter_id" : { "$oid" : "5b7d3736e9214a0d1608d750" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dfb5f627d84c8d6beea" }, "external_id" : "VELOCITY-773", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Provide locally scoped #set variables", "desc" : "Consider this snippet:\n<!-- Generated pushbutton groups -->\n#foreach ($group in $form.pushbuttonGroups)\n<div class=\"die-button-group\" style=\"#coordinates($group)\">\n#*\t*##foreach ($groupChild in $group.children)\n#*\t\t*##if (!$velocityHasNext)#set($turnPaddingOff = 'style=\"padding-bottom: 0px;\"')#end\n#*\t\t*##if ($groupChild.class.simpleName == \"Pushbutton\")\n\t#*\t*#<div $!turnPaddingOff>\n\t\t#*\t*#<button type=\"submit\" name=\"$groupChild.name\" value=\"$groupChild.value\" onclick=\"loadSubsequent()\">#label($groupChild.label)</button>\n\t\t\t\t\n\t#*\t*#</div>\n#*\t\t*##end\n#*\t*##end\n</div>\n#end\n\nThere is an inherent bug. After the first run of the outer foreach, the var turnPaddingOff is still available and will always set in the div tag. There is only one workaround. At the end of the outer foreach you have to set it to ''.\n\n#set should be available as a locally scoped thing in #foreach or other constructs.", "created_at" : { "$date" : "2010-08-26T13:30:58.019+0000" }, "updated_at" : { "$date" : "2010-09-18T14:56:50.109+0000" }, "creator_id" : { "$oid" : "5b7d3736e9214a0d1608d750" }, "reporter_id" : { "$oid" : "5b7d3736e9214a0d1608d750" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7-beta1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dfb5f627d84c8d6bef5" }, "external_id" : "VELOCITY-778", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityServlet.loadConfiguration(...) can not resolve propsFile, returns empty Properties", "desc" : "My web.xml contains following code:\n\n<context-param>\n\t<param-name>properties</param-name>\n\t<param-value>WEB-INF/conf/velocity.properties</param-value>\n</context-param>\n\n\nI get following exception and backtrace:\n\njavax.servlet.ServletException: Error configuring the loader: java.io.FileNotFoundException: WEB-INF/conf/velocity.properties (No such file or directory)\n\torg.apache.velocity.servlet.VelocityServlet.init(VelocityServlet.java:213)\n\tpl.put.platon.common.PlatonServlet.init(PlatonServlet.java:173)\n\torg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n\torg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n\torg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n\torg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n\torg.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n\tjava.lang.Thread.run(Thread.java:636)\n\n\nThere is following comment in VelocityServlet code:\n\n        /*\n         * This will attempt to find the location of the properties\n         * file from the relative path to the WAR archive (ie:\n         * docroot). Since JServ returns null for getRealPath()\n         * because it was never implemented correctly, then we know we\n         * will not have an issue with using it this way. I don't know\n         * if this will break other servlet engines, but it probably\n         * shouldn't since WAR files are the future anyways.\n         */\n\n\n\nSo the problem is that config.getInitParameter(INIT_PROPS_KEY) returns:\nWEB-INF/conf/velocity.properties\nwhich (path) doesn't work for Properties.load(...)", "created_at" : { "$date" : "2010-09-24T21:20:16.170+0000" }, "updated_at" : { "$date" : "2010-09-28T16:22:44.780+0000" }, "creator_id" : { "$oid" : "5b7d3738e9214a0d1608d751" }, "reporter_id" : { "$oid" : "5b7d3738e9214a0d1608d751" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dfc5f627d84c8d6bf02" }, "external_id" : "VELOCITY-681", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[regression] Changes on the macro parameters are not persisted outside the macro call", "desc" : "The fix for VELOCITY-615 was too radical, since it completely disables #setting new values to the formal arguments. A minimalistic example that used to work up to 1.6 (but not with 1.6.1) is:\n\n{noformat}\n#macro(myMacro $result)\n  #set($result = 'some value')\n#end\n#myMacro($x)\n$x\n{/noformat}\nwhich prints $x (as an undefined variable).", "created_at" : { "$date" : "2009-01-23T00:56:47.271+0000" }, "updated_at" : { "$date" : "2010-10-11T00:23:09.634+0000" }, "creator_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "reporter_id" : { "$oid" : "5b7d36a2e9214a0d1608d720" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.6.2" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904dfc5f627d84c8d6bf01" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b904dfd5f627d84c8d6bf1e" }, "external_id" : "VELOCITY-779", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "parse #[[#foreach()]]# error", "desc" : "The following VTL\n\n#[[#foreach()]]#\n\nIt should be:\n\n#foreach()\n\nbut exception  :\n\norg.apache.velocity.exception.ParseErrorException: Encountered \"<EOF>\" at /purchase/print/inQueryPrint.vm[line 30, column 18]\nWas expecting one of:\n    \"(\" ...\n    <RPAREN> ...\n    <ESCAPE_DIRECTIVE> ...\n    <SET_DIRECTIVE> ...\n    \"##\" ...\n    \"\\\\\\\\\" ...\n    \"\\\\\" ...\n    <TEXT> ...\n    \"*#\" ...\n    \"*#\" ...\n    <STRING_LITERAL> ...\n    <END> ...\n    <IF_DIRECTIVE> ...\n    <STOP_DIRECTIVE> ...\n    <INTEGER_LITERAL> ...\n    <FLOATING_POINT_LITERAL> ...\n    <WORD> ...\n    <BRACKETED_WORD> ...\n    <IDENTIFIER> ...\n    <DOT> ...\n    \"{\" ...\n    \"}\" ...\n    \n\tat org.apache.velocity.Template.process(Template.java:141)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:446)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:354)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1400)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1380)\n\tat org.apache.velocity.app.VelocityEngine.getTemplate(VelocityEngine.java:401)\n", "created_at" : { "$date" : "2010-09-28T01:55:21.378+0000" }, "updated_at" : { "$date" : "2010-11-06T14:55:13.774+0000" }, "creator_id" : { "$oid" : "5b7d373be9214a0d1608d752" }, "reporter_id" : { "$oid" : "5b7d373be9214a0d1608d752" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.6.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904dfe5f627d84c8d6bf26" }, "external_id" : "VELOCITY-337", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Need translations of new #{else} syntax documentation", "desc" : "Need to update Spanish, Finnish, French versions of the user guide with the \nnew #{directive} syntax.\n\n(also wouldn't hurt to check for consistency with other new items - use svn \ndiff).  Here's the new English copy (from revision 125388)\n\nDirectives always begin with a #. Like references, the name of the directive \nmay be bracketed by a { and a } symbol. This is useful with directives that \nare immediately followed by text. For example the following produces an error: \n   \n #if($a==1)true enough#elseno way!#end\n  \nIn such a case, use the brackets to separate #else from the rest of the line. \n \n #if($a==1)true enough#{else}no way!#end", "created_at" : { "$date" : "2005-01-16T14:08:07.000+0000" }, "updated_at" : { "$date" : "2010-11-06T15:12:09.865+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904dfe5f627d84c8d6bf33" }, "external_id" : "VELOCITY-464", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Finish the user guide", "desc" : "Docbook based user guide.", "created_at" : { "$date" : "2006-10-12T17:39:06.000+0000" }, "updated_at" : { "$date" : "2010-11-06T15:14:02.784+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904dfe5f627d84c8d6bf32" } },
{ "_id" : { "$oid" : "5b904dff5f627d84c8d6bf42" }, "external_id" : "VELOCITY-465", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Finish the developers guide", "desc" : "Docbook based developers guide.", "created_at" : { "$date" : "2006-10-12T17:39:40.000+0000" }, "updated_at" : { "$date" : "2010-11-06T15:14:22.464+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904dfe5f627d84c8d6bf32" } },
{ "_id" : { "$oid" : "5b904dfe5f627d84c8d6bf32" }, "external_id" : "VELOCITY-463", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "desc" : "We have docbook based Documenation coming up at http://svn.apache.org/repos/asf/jakarta/velocity/docbook/trunk\n\nThis should be finished before releasing 1.5.", "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "title" : "Finish the docbook based documentation for Velocity 1.5", "priority" : "Major", "status" : "Resolved", "updated_at" : { "$date" : "2010-11-06T15:14:34.297+0000" }, "issue_type" : "Task", "resolution" : "Fixed", "assignee_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "created_at" : { "$date" : "2006-10-12T17:38:28.000+0000" } },
{ "_id" : { "$oid" : "5b904e005f627d84c8d6bf57" }, "external_id" : "VELOCITY-513", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Unify redundant documentation.", "desc" : "jar-dependencies and build docs contain the same list of jars with slightly different documentation. Unify the list on one page, remove and reference from the other.", "created_at" : { "$date" : "2007-01-30T21:59:14.870+0000" }, "updated_at" : { "$date" : "2010-11-06T15:15:15.233+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.5", "1.6" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b904cfa5f627d84c8d6aa46" } },
{ "_id" : { "$oid" : "5b904e015f627d84c8d6bf64" }, "external_id" : "VELOCITY-611", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Pretty printer/code layout/reformat/minify", "desc" : "I've always wanted to be able to re-layout a piece of generated text. It was a dream of mine since I was a little boy:)\n\nEven if you generate HTML most of the time the result is pretty ugly(not readable) and when it came to generating code(like Java, JavaScript, etc) is really important to have readable code.Especially when your trying to \"debug\" something, it is a lot easier to locate the problem with a \"pretty\" content layout.\n\nIn case of JavaScript it is even more problematic, because different browsers can fail parsing generated JavaScript just because some separators are not on the same line. Of course you can generate your pages, copy the code in http://www.jslint.com/  and validate your code but is kind of .. not handy.Or you could even compress your generated JavaScript(or HTML) to have a smaller content or obfuscate your code a little bit.\n\nI'm pretty sure these needs are not only mine, so if somebody out there already have something (already) implemented(and it can be open sourced) or even suggestions about which library to use(I expect we could re-use some of the existing libraries to do pretty-print, at least HTML, XML it can be done pretty easy and not so easy with JS or Java) please let me know.\n\nI'm planning to create a public project to host this project and any suggestions are welcomed. The library will be designed to be independent of Velocity, so other template libraries could benefit of this work.\n\n\nThanks.\n\n", "created_at" : { "$date" : "2008-08-15T15:22:39.917+0000" }, "updated_at" : { "$date" : "2010-11-06T15:17:12.988+0000" }, "creator_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "reporter_id" : { "$oid" : "5b7d36a4e9214a0d1608d724" }, "issue_type" : "Wish", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Cross platform" },
{ "_id" : { "$oid" : "5b904e025f627d84c8d6bf6b" }, "external_id" : "VELOCITY-756", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "New notation for replacing null values with a specified string", "desc" : "If I have a variable $foo and it is null, I have the option of using the silent notation $!foo for not writing it. But often when genrating HTML pages I want to express that the values is missing, e.g. by a \"-\". That means that I have to write my code like this:\n\n#if($foo)\n  $foo\n#else\n  -\n#end\n\nWouldn't it be great if there were a new option like $?foo (or whatever chararter would be suitable instead of \"?\") that would print the variable $foo if it was not null and otherwise print a predefined character like \"-\".\n\n/Ludwig", "created_at" : { "$date" : "2010-03-08T11:45:25.044+0000" }, "updated_at" : { "$date" : "2010-11-06T15:18:28.362+0000" }, "creator_id" : { "$oid" : "5b7d3744e9214a0d1608d754" }, "reporter_id" : { "$oid" : "5b7d3744e9214a0d1608d754" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e025f627d84c8d6bf74" }, "external_id" : "VELOCITY-769", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity should use Velocity Docbook Framework for documentation.", "desc" : "Velocity should use it's \"Velocity Docbook Framework\" for all it's documentation.\n(eat your own dog food? :) ).", "created_at" : { "$date" : "2010-06-19T14:53:34.211+0000" }, "updated_at" : { "$date" : "2010-11-06T15:20:57.421+0000" }, "creator_id" : { "$oid" : "5b7d3744e9214a0d1608d755" }, "reporter_id" : { "$oid" : "5b7d3744e9214a0d1608d755" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e035f627d84c8d6bf7b" }, "external_id" : "VELOCITY-794", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "can't get the velocity template in networks ", "desc" : "   begin:\n \tproperties.setProperty(Velocity.FILE_RESOURCE_LOADER_PATH, \"FileParentPath\");   \n        \tvelocityEngine = new VelocityEngine(properties);\n when I get VM Template in this way:\n                      template = velocityEngine.getTemplate(\"C:\\xxx\\ABC.vm\" \"GBK\");\n I can get the template object.\nbut when I get VM Template which the path on LAN like this:\n                       template = velocityEngine.getTemplate(\"\\\\CompanyName\\myPC\\xxx\\ABC.vm\" \"GBK\");\nI can't get the template object and catch an error message:\n\n2011-1-7 11:47:00 org.apache.velocity.runtime.log.JdkLogChute log\n: ResourceManager : unable to find resource 'TB_%modelNameInFileName%.java.vm' in any resource loader.\norg.apache.velocity.exception.ResourceNotFoundException: Unable to find resource 'TB_%modelNameInFileName%.java.vm'\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:483)\n\tat org.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:354)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:1400)\n\tat org.apache.velocity.app.VelocityEngine.getTemplate(VelocityEngine.java:422)\n\tat mda.codemachine.core.engine.Builder.build(Builder.java:50)\n\n\nI want create VM LAN Pool for public,so I must do this.\nthank you~\n\n\n\n                       ", "created_at" : { "$date" : "2011-01-07T03:49:34.964+0000" }, "updated_at" : { "$date" : "2011-01-10T01:41:07.251+0000" }, "creator_id" : { "$oid" : "5b7d3745e9214a0d1608d756" }, "reporter_id" : { "$oid" : "5b7d3745e9214a0d1608d756" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "windows xp\neclipse 3.5" },
{ "_id" : { "$oid" : "5b904e045f627d84c8d6bf84" }, "external_id" : "VELOCITY-795", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity.evaluate String - ParseErrorException: Encountered \"<EOF>\" ", "desc" : "When I include an #if statement twice in a velocity template, I get a ParseErrorException.\nIf I remove the first occurance of the #if statement below, there are no errors.\n\n<html>\n<body>\n\nsome text here\n\n#if ($message)\n Message:\n#end\n\nsome more text\n\n#if ($message)\n  Message:\n#end\n\n</body>\n</html>", "created_at" : { "$date" : "2011-01-24T20:34:34.420+0000" }, "updated_at" : { "$date" : "2011-01-25T20:58:05.244+0000" }, "creator_id" : { "$oid" : "5b7d3746e9214a0d1608d757" }, "reporter_id" : { "$oid" : "5b7d3746e9214a0d1608d757" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.7" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Mac OSX, Java 1.5, Velocity 1.7" },
{ "_id" : { "$oid" : "5b904e045f627d84c8d6bfa0" }, "external_id" : "VELOCITY-776", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904e045f627d84c8d6bfa1" }, "external_id" : "VELOCITY-796", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity #parse not parsing content.", "desc" : "The issue is occuring randomly and could be load related.\nThe issue has only appeared since upgrading to Version 1.7.\n\nThe parse element will display all Velccity code it was suppose to parse.\n\nI have a screen shot if required.", "created_at" : { "$date" : "2011-01-28T00:16:12.198+0000" }, "updated_at" : { "$date" : "2011-01-28T16:47:07.339+0000" }, "creator_id" : { "$oid" : "5b7d36a3e9214a0d1608d721" }, "reporter_id" : { "$oid" : "5b7d36a3e9214a0d1608d721" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "1.7" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b904e045f627d84c8d6bfa0" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Linux Server running Apache Web Server  in front of a JBoss 5 Application Server" },
{ "_id" : { "$oid" : "5b904e055f627d84c8d6bfae" }, "external_id" : "VELOCITY-291", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "wish to get property by name", "desc" : "Hello, I have a wish. Could you please give an ability to get object property by\nname. Something like:\n\n#macro(textInput $name)\n<input type=\"text\" name=\"$name\" value=\"$!form.bean.$name\"/>\n#end\n\n($form.bean is JavaBean that has property $name).\n\nNow I have to write macro with one more parameter for passing value.\n\nIt's not allowed now, right?", "created_at" : { "$date" : "2004-08-28T21:28:07.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:06.650+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d686" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e065f627d84c8d6bfbe" }, "external_id" : "VELOCITY-56", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Creating a more lightweight Velocity Framework", "desc" : "I have mixed emotions towards implementing conditions and logic into a \ntemplate.  On one hand, I see how it can greatly simplify building template \nbased documents.  On one hand I think it puts logic where is doesn't belong, \nproviding no compile time validation, and making it difficult to debug. \n\nThe additional classes and resources needed to process this logic makes me \nwonder if Velocity can be broken apart into a lightweight \"core\" framework that \nsupports only merging of data and template, and an \"extended\" framework that \nadds the ability to process instructions such as if, for each, etc.\n\nKeep up the good work.\n\nBest Regards,\n-Matt Nicolls", "created_at" : { "$date" : "2002-03-26T02:44:03.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:06.874+0000" }, "creator_id" : { "$oid" : "5b7d3748e9214a0d1608d758" }, "reporter_id" : { "$oid" : "5b7d3748e9214a0d1608d758" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e065f627d84c8d6bfca" }, "external_id" : "VELOCITY-328", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "I get Exception in thread \"main\" java.lang.NoClassDefFoundError: org/apache/velocity/runtime/log/PrimordialLogSystem when running the app..", "desc" : "iam a new user to this velocity project...\ncan anyone helpme in solving this out...\ni get the exception\nException in thread \"main\" java.lang.NoClassDefFoundError: \norg/apache/velocity/runtime/log/PrimordialLogSystem\nat org.apache.velocity.runtime.RuntimeInstance.<init>(RuntimeInstance.java:119)\nat org.apache.velocity.runtime.RuntimeSingleton.<clinit>\n(RuntimeSingleton.java:95)\nat org.apache.velocity.app.Velocity.init(Velocity.java:93)\nat Example.<init>(Example.java:47)\nat Example.main(Example.java:121)\n\nwhen running the application", "created_at" : { "$date" : "2004-12-15T14:14:14.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:07.622+0000" }, "creator_id" : { "$oid" : "5b7d3749e9214a0d1608d759" }, "reporter_id" : { "$oid" : "5b7d3749e9214a0d1608d759" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e075f627d84c8d6bfd6" }, "external_id" : "VELOCITY-14", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "error in example build documentatio build", "desc" : "in the README.TXT of eg servlet_example it is said to build with \n3) Build this servlet example : build/build.sh examples\nshould be with ant now. Nothing really special but i thought i'd mention.", "created_at" : { "$date" : "2001-08-28T17:08:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:07.132+0000" }, "creator_id" : { "$oid" : "5b7d374be9214a0d1608d75a" }, "reporter_id" : { "$oid" : "5b7d374be9214a0d1608d75a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e085f627d84c8d6bfe3" }, "external_id" : "VELOCITY-93", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "CVS - ant test - failure / JDK 1.4.1, w2kSp2, ant 1.6a", "desc" : "CVS velocity builds ok, but the \"test\" ant task fails.\nThis is w2kSp2 / Cygwin / JDK 1.4.1 / CVS ant \n\n- jari\n\nroot@W2KPICASSO:/cygdrive/d/java/apache/cvs/jakarta-velocity/build$ ant.bat test\nBuildfile: build.xml\n\nenv:\n     [echo] java.home = d:\\java\\sun\\jdk-1.4.1\\jre\n     [echo] user.home = G:\\Documents and Settings\\Administrator.W2KPICASSO.000\n     [echo] java.class.path = d:\\java\\sun\\jdk-1.4.1\n\\lib\\tools.jar;d:\\java\\apache\\jakarta-ant-\ncvsbuild\\lib\\xmlParserAPIs.jar;d:\\java\\apache\\jakarta-ant-\ncvsbuild\\lib\\xercesImpl.jar;d:\\java\\apache\\jakarta-ant-cvsbuild\\lib\\xml-\napis.jar;d:\\java\\apache\\jakarta-ant-cvsbuild\\lib\\ant.jar;d:\\java\\apache\\jakarta-\nant-cvsbuild\\lib\\optional.jar;.;d:\\wbin\\server\\http\\apache\\jakarta-tomcat-4.1.7-\nLE-jdk14\\common\\lib\\servlet.jar;d:\\java\\sun\\jdk-1.4.1\n\\lib\\tools.jar;d:\\java\\sun\\jaf-1.0.2\\activation.jar;d:\\java\\sun\\javamail-1.3\n\\mail.jar;d:\\java\\sun\\bdk-1.1\\infobus.jar;d:\\java\\sun\\jms\\jms1.1\n\\lib\\javax.jms.jar;d:\\java\\sun\\jms\\jms1.1\\lib\\jms.jar;d:\\java\\prg\\jdbc\\pgjdbc2-\n7.3dev.jar;d:\\java\\prg\\jdbc\\mm.mysql-2.0.14-bin.jar;d:\\java\\apache\\jakarta-ant-\ncvsbuild\\lib\\ant.jar;d:\\java\\apache\\cvs\\jakarta-oro\\jakarta-oro-2.0.1-\nDev.jar;d:\\java\\apache\\cvs\\jakarta-regexp\\bin\\jakarta-regexp-\n1.1.jar;d:\\java\\apache\\cvs\\xml-\nxalan\\java\\build\\xalan.jar;d:\\java\\apache\\cvs\\xml-xalan\\java\\bin\\xml-\napis.jar;d:\\java\\apache\\cvs\\xml-\nxerces\\java\\build\\xercesImpl.jar;d:\\java\\apache\\cvs\\xml-\nxerces\\java\\bin\\xercesSamples.jar;d:\\java\\apache\\cvs\\xml-\nxerces\\java\\bin\\xmlParserAPIs.jar;d:\\java\\apache\\cvs\\xml-\nsoap\\java\\build\\lib\\soap.jar;d:\\java\\apache\\cvs\\xml-\nxindice\\java\\lib\\xindice.jar;d:\\java\\apache\\cvs\\jakarta-turbine-\nmaven\\target\\maven.jar\n\n\nprepare:\n     [copy] Copying 192 files to D:\\java\\apache\\cvs\\jakarta-velocity\\bin\\src\n\ncompile:\n    [javac] Compiling 191 source files to D:\\java\\apache\\cvs\\jakarta-\nvelocity\\bin\\classes\n    [javac] D:\\java\\apache\\cvs\\jakarta-\nvelocity\\bin\\src\\org\\apache\\velocity\\app\\tools\\VelocityFormatter.java:87: \nreference to Context is ambiguous, both class \norg.apache.velocity.context.Context in org.apache.velocity.context and class \norg.apache.velocity.Context in org.apache.velocity match\n    [javac]     Context context = null;\n    [javac]     ^\n    [javac] D:\\java\\apache\\cvs\\jakarta-\nvelocity\\bin\\src\\org\\apache\\velocity\\app\\tools\\VelocityFormatter.java:95: \nreference to Context is ambiguous, both class \norg.apache.velocity.context.Context in org.apache.velocity.context and class \norg.apache.velocity.Context in org.apache.velocity match\n    [javac]     public VelocityFormatter(Context context)\n    [javac]                              ^\n    [javac] D:\\java\\apache\\cvs\\jakarta-\nvelocity\\bin\\src\\org\\apache\\velocity\\runtime\\log\\AvalonLogSystem.java:161: \ncannot resolve symbol\n    [javac] symbol  : method setPriority (org.apache.log.Priority.Enum)\n    [javac] location: class org.apache.log.Logger\n    [javac]         logger.setPriority( Priority.DEBUG );\n    [javac]               ^\n    [javac] Note: D:\\java\\apache\\cvs\\jakarta-\nvelocity\\bin\\src\\org\\apache\\velocity\\anakia\\NodeList.java uses or overrides a \ndeprecated API.\n    [javac] Note: Recompile with -deprecation for details.\n    [javac] 3 errors\n\nBUILD FAILED\nfile:d:/java/apache/cvs/jakarta-velocity/build/build.xml:189: Compile failed; \nsee the compiler error output for details.\n\nTotal time: 51 seconds", "created_at" : { "$date" : "2002-07-23T05:54:02.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:07.802+0000" }, "creator_id" : { "$oid" : "5b7d374ee9214a0d1608d75b" }, "reporter_id" : { "$oid" : "5b7d374ee9214a0d1608d75b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e085f627d84c8d6bfef" }, "external_id" : "VELOCITY-91", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Backwards compatability lost on templates with 1.3", "desc" : "With the latest 1.3 download, some templates are failing (with \nReferenceExceptions) that were working perfectly under 1.2, an example of which \nfollows. \n\nI have a method in a utility class which is placed onto the context;\n\n  public static String createMethodLine(String visibility, String methodName, \nList params, Map colData, String returnType, boolean throwsSQLException, \nboolean retrieveByParams);\n\n\nIn the template, I have the following;\n\n  $TGUtils.createMethodLine(\"public\", \"retrieve\", $index.getIndexColumns(), \n$tableData.get($tableName).getColumnData(), \"boolean\", false, true)\n\nwhere $index.getIndexColumns() is a java.util.ArrayList and $tableData.get\n($tableName).getColumnData() is a java.util.TreeMap.\n\nWorks under 1.2 but throws ReferenceExceptions under 1.3 :(", "created_at" : { "$date" : "2002-07-20T08:46:49.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:07.382+0000" }, "creator_id" : { "$oid" : "5b7d374ee9214a0d1608d75c" }, "reporter_id" : { "$oid" : "5b7d374ee9214a0d1608d75c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e095f627d84c8d6c000" }, "external_id" : "VELOCITY-256", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ExtendedPropertiesReader broken on NFS files", "desc" : "Hello, \n \nI am using Velocity (velocity-dep-1.3.1) to generate e-mails on the fly with a \nJava program. \nVelocity is initialized with a custom properties file, which however currently \ndoes not hold any velocity-relevant information. The property file resides on \nan NFS share. \nEverything used to work fine for several weeks but I am now getting \nnullpointer exceptions from velocity when initializing it with the properties \nfile.  This behaviour seemingly started, after I mirrored the harddisc on \nwhich the properties files were on, to a new drive. The NFS export on that \nmachine has not changed at all since it was an exact mirror. Other programs \nhave not differed in behaviour, so this is definitely odd. \nEven more strange to me is that when initializing Velocity with it's own \nproperties file (which means I am not passing any file as an argument to \ninit() ), I still get the nullpointer exception. \n \nWhen copying the (Eclipse) project to my local disc and debug the program from  \nthere, everything works as expected. \n \nThanks for your help. \n \nHere is the stack trace that is being generated: \n \nThread [AWT-EventQueue-0] (Suspended (exception NullPointerException)) \n\tExtendedProperties$PropertiesReader.readProperty() line: 250 [local \nvariables unavailable] \n\tExtendedProperties.load(InputStream, String) line: 467 \n\tExtendedProperties.load(InputStream) line: 429 \n\tExtendedProperties.<init>(String, String) line: 370 \n\tExtendedProperties.<init>(String) line: 352 \n\tRuntimeInstance.init(String) line: 453 \n\tVelocityEngine.init(String) line: 135 \n\tTemplateEngine.<init>() line: 51 \n\tMailHandler.getMailContents(Bogen) line: 361 \n\tMailHandler.sendMails() line: 155 \n\tKommunikationWindow$NachrichtWindow\n$OkCallback.actionPerformed(ActionEvent) line: 470 \n\tJButton(AbstractButton).fireActionPerformed(ActionEvent) line: 1786 \n\tAbstractButton$ForwardActionEvents.actionPerformed(ActionEvent) line: \n1839 \n\tDefaultButtonModel.fireActionPerformed(ActionEvent) line: 420 \n\tDefaultButtonModel.setPressed(boolean) line: 258 \n\tMetalButtonListener(BasicButtonListener).mouseReleased(MouseEvent) \nline: 245 \n\tJButton(Component).processMouseEvent(MouseEvent) line: 5100 \n\tJButton(Component).processEvent(AWTEvent) line: 4897 \n\tJButton(Container).processEvent(AWTEvent) line: 1569 \n\tJButton(Component).dispatchEventImpl(AWTEvent) line: 3615 \n\tJButton(Container).dispatchEventImpl(AWTEvent) line: 1627 \n\tJButton(Component).dispatchEvent(AWTEvent) line: 3477 \n\tLightweightDispatcher.retargetMouseEvent(Component, int, MouseEvent) \nline: 3483 \n\tLightweightDispatcher.processMouseEvent(MouseEvent) line: 3198 \n\tLightweightDispatcher.dispatchEvent(AWTEvent) line: 3128 \n\tKommunikationWindow\n$NachrichtWindow(Container).dispatchEventImpl(AWTEvent) line: 1613 \n\tKommunikationWindow\n$NachrichtWindow(Window).dispatchEventImpl(AWTEvent) line: 1606 \n\tKommunikationWindow$NachrichtWindow(Component).dispatchEvent(AWTEvent) \nline: 3477 \n\tEventQueue.dispatchEvent(AWTEvent) line: 456 \n\tEventDispatchThread.pumpOneEventForHierarchy(int, Component) line: 201 \n\tEventDispatchThread.pumpEventsForHierarchy(int, Conditional, \nComponent) line: 151 \n\tEventDispatchThread.pumpEvents(int, Conditional) line: 145 \n\tEventDispatchThread.pumpEvents(Conditional) line: 137 \n\tEventDispatchThread.run() line: 100", "created_at" : { "$date" : "2004-04-09T18:55:58.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:08.080+0000" }, "creator_id" : { "$oid" : "5b7d374fe9214a0d1608d75d" }, "reporter_id" : { "$oid" : "5b7d374fe9214a0d1608d75d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0a5f627d84c8d6c012" }, "external_id" : "VELOCITY-162", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can Velocity read template files directly from JAR files?", "desc" : "I anticipate to have several hundred Velocity templates in my project.  Can I \nput my template files into directory system in a JAR file and have Velocity get \nthose files directly from the JAR?\n\nIf such feature is not supported yet, Velocity should definitely support it.\n\nRegards,", "created_at" : { "$date" : "2003-04-17T03:57:55.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:08.339+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e0a5f627d84c8d6c01f" }, "external_id" : "VELOCITY-237", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocity stops rendering without any info.", "desc" : "velocity stops rendering without any info.\n\nHow can I get more info about why he exactly stops?", "created_at" : { "$date" : "2003-12-09T00:11:59.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:09.593+0000" }, "creator_id" : { "$oid" : "5b7d3751e9214a0d1608d75e" }, "reporter_id" : { "$oid" : "5b7d3751e9214a0d1608d75e" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0b5f627d84c8d6c02c" }, "external_id" : "VELOCITY-7", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "id and other attributes", "desc" : "I a few cases the html:text or html:select does not support all the attributes \nfrom the HTML spec.\nAn example is:\n<label accesskey='L' for='fname'>Label</label>\n<input name='fieldname' id='fname' type='text'>Default text</input>\nAlt+L will allow jumping to the corresponding field.\nIf you could generate a default 'id' attribute or allow the user to specifiy \none that is passed through only.\n\nMaybe a generic taglib that can be nested inside any other tag and will add the \nattributes to the generated tag.\n<html:attr name='id'>value</html:attr>\n\nI found a similar situation with jsp:plugin which does not allow the id \nattribute, not that you can do anything about this one.", "created_at" : { "$date" : "2001-06-06T13:56:58.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:09.011+0000" }, "creator_id" : { "$oid" : "5b7d3754e9214a0d1608d75f" }, "reporter_id" : { "$oid" : "5b7d3754e9214a0d1608d75f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0b3" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e0c5f627d84c8d6c038" }, "external_id" : "VELOCITY-101", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "\"Velicimacro Miscellany\" example in velocity-user doc does not work with inline macros.", "desc" : "According to the documentation, it should be possible to use a macro in an\ninterpolated string passed to another macro.  However, the example given\ndemonstrates clearly that this does NOT work with inline macros.  The example\ngiven is this:\n\n  #macro( inner $foo )\n    inner : $foo\n  #end\n\n  #macro( outer $foo )\n    #set($bar = \"outerlala\")\n    outer : $foo\n  #end\n\n  #set($bar = 'calltimelala')\n  #outer( \"#inner($bar)\" )\n\nThe result according to the docs should be:\n\n  outer: inner: outerlala\n\nWhat you instead get is:\n\n  outer : #inner(outerlala)\n\nThe macro expansion does work in the following example, where the string\nevaluation is immediate:\n\n  #set ($aref = \"#inner($bar)\")\n\nThe following config settings were used:\n\n  velocimacro.permissions.allow.inline = true\n  velocimacro.permissions.allow.inline.to.replace.global = true\n  velocimacro.permissions.allow.inline.local.scope = true\n  velocimacro.context.localscope = false\n\nBut no single change to these settings made a difference.\n\nIf the inner and outer macros are instead defined in a macro library, the\nexample does work.  But if the template attempts to override the \"inner\" macro,\nit will not work (the original \"inner\" macro from the library will be used). \nChanging the inline.local.scope setting to false did not help.", "created_at" : { "$date" : "2002-08-01T01:54:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:09.299+0000" }, "creator_id" : { "$oid" : "5b7d3755e9214a0d1608d760" }, "reporter_id" : { "$oid" : "5b7d3755e9214a0d1608d760" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.3" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0c5f627d84c8d6c045" }, "external_id" : "VELOCITY-33", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Sealing violation: SAX Parser conflicts", "desc" : "Hi Geir, its me again.\n\nI've a jetty application that uses Velocity as shown below. The application \nworks fine except when it tries to use any flavor of XML, failing with a \n\"sealing violation\" in every case. The symptoms are precisely the same \nnomatter which XML flavor I try. \n\nA small XML test case with just the XML code works fine when run \nstandaline (outside of jetty and velocity). The servlet + velocity works fine if \nall XML related code is removed.\n\nFrom a google search on \"JDOM sealing violation\", the problem is that \nJetty and Velocity are using different XML flavors and that the classloader \nis resolving refs from one to the other, triggering the sealing violation. \n\nThe question is, what to do about it. I've spent a whole day trying various \nguesses, but I've found no way of disentangling them.\n\nI've got xalan, xerces, jdom, crimson, werken.xpath, and god knows what \nothers installed but no idea which ones I should keep.\n\n\tVelocityContext context = new VelocityContext();\n\ttry\n\t{\n\t\tTask thisTask = Task.load(ctx, cid, lid, tid);\n\t\tTask.Page thisPage = thisTask.getPage(ctx, person.id, page);\n\t\tString templatePath = thisPage.getTemplatePath(thisTask).toString();\n\n\t\tjavax.xml.parsers.DocumentBuilderFactory factory =\n\t\t\tjavax.xml.parsers.DocumentBuilderFactory.newInstance();\n\t\tjavax.xml.parsers.DocumentBuilder builder = \nfactory.newDocumentBuilder();\n\t\torg.w3c.dom.Document root = builder.parse(templatePath);\n\n\t\t// Jetty\n\t\t// SAXParserFactory factory = SAXParserFactory.newInstance();\n\t\t// SAXParser parser = factory.newSAXParser();\n\t\t// _parser.parse(url, handler);\n\t\t// Document root = builder.build(templatePath);\n\n\t\t// Velocity\n\t\t// org.jdom.input.SAXBuilder builder = new org.jdom.input.SAXBuilder\n\t\t\t// (  \"org.apache.xerces.parsers.SAXParser\" );\n\t\t// org.jdom.Document root = builder.build(templatePath);\n\n\t\tcontext.put(\"op\", op );\n\t\tcontext.put(\"cid\", cid );\n\t\tcontext.put(\"lid\", lid );\n\t\tcontext.put(\"tid\", tid );\n\t\t// context.put(\"root\", root );\n\t\tcontext.put(\"task\", thisTask );\n\n\t\tTemplate template = Velocity.getTemplate\n\t\t\t(thisPage.getTemplatePath(thisTask).toString());\n\t\ttemplate.merge( context, ctx.getWriter() );\n\t}\n\tcatch( ResourceNotFoundException e )\n\t{ throw new Fault(\"couldn't find page \"+index, e); }\n\tcatch( ParseErrorException e )\n\t{ throw new Fault(\"syntax error in page \"+index, e); }\n\tcatch( MethodInvocationException e )\n\t{ throw new Fault(\"exception in page \"+index, e); }\n\tcatch( Exception e )\n\t{ throw new Fault(\"unexpected exception in page \"+index, e); }\n}", "created_at" : { "$date" : "2002-01-18T01:50:27.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:10.620+0000" }, "creator_id" : { "$oid" : "5b7d3756e9214a0d1608d761" }, "reporter_id" : { "$oid" : "5b7d3756e9214a0d1608d761" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0d5f627d84c8d6c051" }, "external_id" : "VELOCITY-181", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity Template with HTTPRequest object", "desc" : "Hi,\n\nI am having a problem with velocity.\nI am using:\n1. Tomcat version 4.1.18 \n2. velocity-dep-1.3.jar \n3. Java1.4.0( build 1.4.0-b92) \n4. Windows 2000.\n\nI am using velocity template with servlets.\n\nProblem Description:\n1.Whenever one of the parameters for  a method is HTTPRequest object in the \nvelocity template the \n\nlink does not get translated.\n2.If the method has only HTTPRequest object as the parameter it works.\n3.But HTTPRequest in combination with other parameters does not seem to work.\n\nFor Example:\nFollowing DO NOT WORK:\n<h2> <a href=\"$link.getBrowseURL($request, \"A\", 1, 15)\">REQ + String + Int = \nNOT WORKING</a></h2>\n<h2> <a href=\"$link.getBrowseURL( \"A\", 1, 15,$request)\">String + Int + REQ = \nNOT WORKING</a></h2>\n<h2> <a href=\"$link.getBrowseURL( $request,1, 15)\">REQ + Integer = NOT \nWORKING</a> </h2>\n\nFollowing WORK:\n<h2> <a href=\"$link.getBrowseURL(\"A\", 1, 15)\">String + Int = Working</a> </h2>\n<h2> <a href=\"$link.getBrowseURL( 1, 15)\">Only Integer = WORKING </a> </h2>\n<h2> <a href=\"$link.getBrowseURL( $request)\">Only REQ = WORKING</a> </h2>\n\n\nIS this a BUG or mistake on my part.ANY suggestions are welcome.\n\n\nTHANK YOU\nSushma\nFollowing is the code for velocity and servlet.\n+++++++++++++++++++++++++++++homepage3.vm+++++++++++++++++++++++++++++++++++++++\n<html>\n\n<body>\n\n<h2> <a href=\"$link.getBrowseURL($request, \"A\", 1, 15)\"> REQ + String + Int = \nNOT WORKING</a></h2>\n<h2> <a href=\"$link.getBrowseURL( \"A\", 1, 15,$request)\">String + Int + REQ = \nNOT WORKING</a></h2>\n<h2> <a href=\"$link.getBrowseURL( $request,1, 15)\">REQ + Integer = NOT \nWORKING</a> </h2>\n<h2> <a href=\"$link.getBrowseURL(\"A\", 1, 15)\">String + Int = Working</a> </h2>\n<h2> <a href=\"$link.getBrowseURL( 1, 15)\">Only Integer = WORKING </a> </h2>\n<h2> <a href=\"$link.getBrowseURL( $request)\">Only REQ = WORKING</a> </h2>\n\n</body>\n\n</html>\n-----------------------------homepage3.vm---------------------------------------\n\n+++++++++++++++++++++++++++++WorkingServlet.java++++++++++++++++++++++++++++++++\nimport java.text.*;\nimport java.util.*;\nimport java.io.*;\nimport javax.servlet.*;\nimport javax.servlet.http.*;\n\nimport org.apache.velocity.*; \nimport org.apache.velocity.app.Velocity; \nimport org.apache.velocity.context.Context; \nimport org.apache.velocity.runtime.RuntimeSingleton;\nimport org.apache.velocity.util.SimplePool;\nimport org.apache.velocity.exception.*;\n\n\npublic class WorkingServlet extends HttpServlet {\n   String encoding;\n   private  SimplePool writerPool = new SimplePool(40);\n   \n   public void init() throws UnavailableException { \n        String prefix =  getServletContext().getRealPath(\"/\");\n        String file = getInitParameter(\"velocity-init-file\");\n\n\t\tif(file != null) {\n            try {\n\t\t\tString propertiesFile = prefix+file;\n\t\t\tString filePath= prefix;\n            Properties p = new Properties();\n            p.load(new FileInputStream(propertiesFile));\n\n            p.setProperty( Velocity.FILE_RESOURCE_LOADER_PATH,  filePath );\n\n            Velocity.init(p);             \n            encoding = RuntimeSingleton.getString( \nRuntimeSingleton.OUTPUT_ENCODING, \n                                                   \"ISO-8859-1\");\n            } catch (Exception e) {\n                throw new UnavailableException(e.getMessage());\n            } //end of catch\n            \n        }//end of if\n    }//end of init\n    \n\tpublic void doGet(HttpServletRequest request,\n                      HttpServletResponse response)\n        throws IOException, ServletException\n    {  \n\t\tresponse.setContentType(\"text/html\");\n\t\tPrintWriter out = response.getWriter();\n\t\ttry{\n\t   VelocityContext context = new VelocityContext(); \n\n       context.put(\"link\", new WorkingServlet()); \n\t   context.put(\"request\", request); \n\n\t   Template tpl = RuntimeSingleton.getTemplate(\"homepage3.vm\");\n       tpl.merge( context,out);\n\t   }catch (Exception e){\n\t\t}//end of catch\n    }//end of doGet\n\t\n   public String getBrowseURL(HttpServletRequest request,String startStr,int \nstartPt, int fetchCount) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n\n   public String getBrowseURL(String startStr,int startPt, int \nfetchCount,HttpServletRequest request) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n   public String getBrowseURL(HttpServletRequest request, int startPt, int \nfetchCount) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n\n   public String getBrowseURL(String startStr,int startPt, int fetchCount) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n\n   public String getBrowseURL(int startPt, int fetchCount) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n   public String getBrowseURL(HttpServletRequest request) \n   {\n\t   return(\"HEllO REQUEST\");\n   }\n\n\n}//end of class\n\n-----------------------------WorkingServlet.java--------------------------------", "created_at" : { "$date" : "2003-06-09T06:18:45.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:11.956+0000" }, "creator_id" : { "$oid" : "5b7d3757e9214a0d1608d762" }, "reporter_id" : { "$oid" : "5b7d3757e9214a0d1608d762" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0e5f627d84c8d6c05d" }, "external_id" : "VELOCITY-25", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Does not leave character # alone.", "desc" : "Here is an excert from a String that I am using as a template.\n\n\"<#$cgi->objectname#><#/TRIM#>\"\n\nI want velocity to leave this alone because another interpreter will use it.  \nIf I send this to velocity, i get back a:\n\n\"<###$cgi->objectname#><#/TRIM#>\"\n\nif I send \"<\\#$cgi->objectname#><\\#TRIM#>\" to the velocity bean, then I get:\n\"<\\###$cgi->objectname#><#/TRIM#>\"", "created_at" : { "$date" : "2001-11-01T22:44:32.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:11.003+0000" }, "creator_id" : { "$oid" : "5b7d3757e9214a0d1608d763" }, "reporter_id" : { "$oid" : "5b7d3757e9214a0d1608d763" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e0f5f627d84c8d6c071" }, "external_id" : "VELOCITY-163", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "LogManager should use NullLogger as Fallback", "desc" : "To avoid unnecessary dependencies on avalon (which is IMHO not \nready for production use) and making velocity more stable,\norg/apache/velocity/runtime/log/LogManager should use an \n\"always available\" LogSystem, i.e. AFAIK the NullLogger.\n\nIMHO, refusing to work because no known \"LogSystem\" is available,\nis not a very wise design decision...", "created_at" : { "$date" : "2003-04-18T06:21:30.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:12.198+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e0f5f627d84c8d6c07e" }, "external_id" : "VELOCITY-127", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "anakia not portable to windows", "desc" : "it works fine under cygwin, but 1) when I use it under Win2k cmd in the very\nsame directory, I get:\n<< ...dir>ant\nBuildfile: build.xml\n\nprepare:\n\nprepare-error:\n\ndocs:\n\nBUILD FAILED\nfile:C:/Data/MyDocRalf/bin/Java/jars/velocity/jakarta-ant/proposal/ant-site/anak\nia/build.xml:51: Could not create task of type: anakia due to java.lang.NoClassD\nefFoundError: org/apache/commons/collections/ExtendedProperties>>\n\nFurthermore, it appears that in the build.xml \n <anakia basedir=\"${docs.src}\" destdir=\"${docs.dest}/\"\n             extension=\".html\" style=\"./site.vsl\"\n2) the \"./style\" cannot be a property\n3) it appears to be hard-coded that even when all paths (src, dest, templ.path)\nare set to ., style doesn't find \"./style.vsl\" nor \"../style.vsl\" ??", "created_at" : { "$date" : "2003-01-17T02:13:51.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:11:12.434+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e105f627d84c8d6c08b" }, "external_id" : "VELOCITY-254", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "in #foreach: if nulls are encountered last value is returned instead of null", "desc" : "I put an object having a method that returns an array of Integers in the context\nwith contents\n[100,100,NULL,NULL,...]\nThen looping over the contents using\n#foreach ($elt in $Object.List) $!elt #end\n\nALL entries become 100 with output: \n100 100 100 100 (...)\ninstead of the expected\n100 100 \n\nWhen converting all null objects to say new Integer(0) in the \ngetList() body before returning the list, output becomes\n100 100 0 0 0 0 0 \n\nApparently null values are not treated as first citizens,\n\nCheers,\n\nIndra", "created_at" : { "$date" : "2004-03-17T22:24:20.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:43.541+0000" }, "creator_id" : { "$oid" : "5b7d3760e9214a0d1608d764" }, "reporter_id" : { "$oid" : "5b7d3760e9214a0d1608d764" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e105f627d84c8d6c09c" }, "external_id" : "VELOCITY-120", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "search paths ignored when checking timestamps", "desc" : "We have arranged to use the search paths to allow overrides to be made without\nchanging the original versions of the templates.  However, when we turn on\nVelocity caching, the search paths are ignored so long as the file is not\nmodified.  The problem is relativley easy to solve in FileResourceLoader.java;\nI'll attach patches next.", "created_at" : { "$date" : "2002-12-30T19:20:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:43.718+0000" }, "creator_id" : { "$oid" : "5b7d3763e9214a0d1608d765" }, "reporter_id" : { "$oid" : "5b7d3763e9214a0d1608d765" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e115f627d84c8d6c0a8" }, "external_id" : "VELOCITY-105", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ParseErrorException and ResourceNotException not throwed back to the VelocityEngine", "desc" : "When the parser catch a ParseErrorException or a ResourceNotFoundException it \ndoes not throw it back to the VelocityEngine when that exception occurs in a \ntemplate parsed by another template.\n\nMore precisly: in org.apache.velocity.runtime.directive.Parse , the render \nmethod is supposed to throw all three possible Velocity exceptions but it just \ndo so when the calling object is not the Parse object itself , since the \nrecursion call to render(InternalContextAdapter context,Writer writer, Node \nnode)at line #232 in the render method catch Exception but only throw back \nMethodInvokationException, so ParseErrorException and ResourceNotFoundException \nare just logged.", "created_at" : { "$date" : "2002-09-25T04:33:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:43.948+0000" }, "creator_id" : { "$oid" : "5b7d3765e9214a0d1608d766" }, "reporter_id" : { "$oid" : "5b7d3765e9214a0d1608d766" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e125f627d84c8d6c0b0" }, "external_id" : "VELOCITY-367", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Anakia throws NullPointerException if run under Maven with Custom Contexts", "desc" : "The AnakiaTask has the feature to use a custom context object. This is tested in\nthe AnakiaTestCase. However, when running this test (and the AnakiaTask) under\nMaven, it fails with a NullPointerException. The reason is that maven uses a\ndifferent sequence to initialize the AnakiaTask and Context objects and set\ntheir properties. When running under ant, the setFile() method in the Context\nobject is called after setBaseDir() in the AnakiaTask, which allows setFile() to\nresolve the baseDir member. When running under maven, setBasedir() is called\nafter the Context  object has been initialized thus using a null baseDir element\nwhen creating the contextFile element in Context. \n\nWhen using an element outside the current working directory, this leads to\nsubContext.getContextDocument() returning null in line 378, thus resulting in a\nNullPointerException.\n\nThe attached patch adds checks for this condition and throws a BuildExeption. It\nalso defers the creation of the contextDoc member of the context until it is\nactually referenced.", "created_at" : { "$date" : "2005-03-09T17:22:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:44.121+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d675" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e125f627d84c8d6c0b9" }, "external_id" : "VELOCITY-11", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "simple but regretful mistake in YMTD/Taglibs", "desc" : "In the first Velocity sample of YMTD/Taglibs,\nthere is a code as below:\n\n#if ( $number = 7 )\n\nYou need two equals here don't you?\nNot a good place to make a mistake when\nyou are saying Velocity is better because\nyou don't have to write much code.\n\nAnyway, good luck!", "created_at" : { "$date" : "2001-08-08T07:26:52.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:44.735+0000" }, "creator_id" : { "$oid" : "5b7d3768e9214a0d1608d767" }, "reporter_id" : { "$oid" : "5b7d3768e9214a0d1608d767" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e135f627d84c8d6c0c1" }, "external_id" : "VELOCITY-164", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "org.apache.log4j.Category is deprecated", "desc" : "org/apache/velocity/runtime/log/SimpleLog4JLogSystem.java and\norg/apache/velocity/runtime/log/Log4JLogSystem.java the usage\nof Category should should be changed to Logger, since existence\nof Category after the middle of 2003 is undetermined.\n\nsee: http://jakarta.apache.org/log4j/docs/api/org/apache/log4j/Category.html", "created_at" : { "$date" : "2003-04-18T06:58:53.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:44.569+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d676" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e145f627d84c8d6c0cd" }, "external_id" : "VELOCITY-116", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error in Developer Guide", "desc" : "The developer guide, in the section on \"Velocity Configuration Keys and Values,\"\nsays that the default value of resource.loader is \"File\".  Shouldn't that be\n\"file\"?  I am using 1.3.0, and configure the location of the templates with\nthe property \"file.resource.loader.path\".", "created_at" : { "$date" : "2002-11-27T07:01:43.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:44.313+0000" }, "creator_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "reporter_id" : { "$oid" : "5b7d353fe9214a0d1608d674" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e145f627d84c8d6c0d6" }, "external_id" : "VELOCITY-88", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "No documentation on rules used for property lookup", "desc" : "Per mailing list discussion on rules used for property reference lookup, the \ndocumentation should indicate or have examples that describe the rules used \nwhen attempting to retreive the value of the property. \n\nExample (per Geir):\n\n $thing.foo\n\n1) try getFoo()\n2) try getfoo() [for wacky people...]\n3) try get(\"foo\")\n4) try isFoo()", "created_at" : { "$date" : "2002-07-04T03:07:04.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:44.903+0000" }, "creator_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "reporter_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e155f627d84c8d6c0e1" }, "external_id" : "VELOCITY-293", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "velocity.properties and templatePath could not be specified together", "desc" : "In Ant Anakia task ,\nI counld not specify 'templatePath' attribute\nwhen velocity.properties file exists.\n\n I fixed this problem , please check my patch\n\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-velocity/src/java/org/apache/velocity/anakia/AnakiaTask.java,v\nretrieving revision 1.38\ndiff -u -r1.38 AnakiaTask.java\n--- AnakiaTask.java\t20 Mar 2004 03:35:50 -0000\t1.38\n+++ AnakiaTask.java\t6 Sep 2004 10:01:14 -0000\n@@ -19,10 +19,12 @@\n import java.io.BufferedWriter;\n import java.io.File;\n import java.io.FileOutputStream;\n+import java.io.FileInputStream;\n import java.io.OutputStreamWriter;\n import java.io.Writer;\n \n import java.util.StringTokenizer;\n+import java.util.Properties;\n \n import org.apache.tools.ant.BuildException;\n import org.apache.tools.ant.DirectoryScanner;\n@@ -259,16 +261,17 @@\n         Document projectDocument = null;\n         try\n         {\n+            Properties vp = new Properties();\n             if ( velocityPropertiesFile.exists() )\n             {\n-                ve.init(velocityPropertiesFile.getAbsolutePath());\n+                vp.load( new\nFileInputStream(velocityPropertiesFile.getAbsolutePath()) );\n             }\n-            else if (templatePath != null && templatePath.length() > 0)\n+            if (templatePath != null && templatePath.length() > 0)\n             {\n-                ve.setProperty( RuntimeConstants.FILE_RESOURCE_LOADER_PATH,\n+                vp.setProperty(RuntimeConstants.FILE_RESOURCE_LOADER_PATH,\n                     templatePath);\n-                ve.init();\n             }\n+            ve.init(vp);\n \n             // get the last modification of the VSL stylesheet\n             styleSheetLastModified = ve.getTemplate( style ).getLastModified();", "created_at" : { "$date" : "2004-09-06T17:10:21.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:45.887+0000" }, "creator_id" : { "$oid" : "5b7d376ee9214a0d1608d76b" }, "reporter_id" : { "$oid" : "5b7d376ee9214a0d1608d76b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e155f627d84c8d6c0e9" }, "external_id" : "VELOCITY-255", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "maven dependencies wrong for log4j", "desc" : "I checked out the latest velocity source from cvs today.  It did not build.\n\nIt seems that velocity depends on the org.apache.log4j.Logger class, but lists\nits  dependencies in the project.xml file as 1.1.3.  The logger class doesn't\nexist in 1.3.  Upgrading to a later log4j (I used 1.2.8) \"cures\" the problem.\n\nIt appears that the project.xml file isn't used for the \"real\" build; perhaps\nit should be removed?\n\nIn addition, the maven.xml file refers to the default build tag of \"java:jar\".\nThis tag is deprectated; the current tag to use is \"jar:jar\" (at least\nin maven 1.0-rc1...)\n\nHere's a diff of the change to project.xml:\n\n*** project.xml 19 Feb 2004 23:22:25 -0000      1.3\n--- project.xml 21 Mar 2004 20:15:17 -0000\n***************\n*** 161,167 ****\n\n      <dependency>\n        <id>log4j</id>\n!       <version>1.1.3</version>\n      </dependency>\n\n      <dependency>\n--- 161,167 ----\n\n      <dependency>\n        <id>log4j</id>\n!       <version>1.2.8</version>\n      </dependency>\n\n      <dependency>", "created_at" : { "$date" : "2004-03-22T04:16:19.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:45.721+0000" }, "creator_id" : { "$oid" : "5b7d376fe9214a0d1608d76d" }, "reporter_id" : { "$oid" : "5b7d376fe9214a0d1608d76d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e175f627d84c8d6c0f1" }, "external_id" : "VELOCITY-361", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Typo in dev guide(runtime.log.invalid.references)", "desc" : "In the developer guide under \"Velocity Configuration Keys and Values\", the \nexplanation for \"runtime.log.invalid.references\" says:\n  Good thing to turn of in production, ...\nwhere it should say:\n  Good thing to turn off in production, ...", "created_at" : { "$date" : "2005-02-23T15:14:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:46.513+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e175f627d84c8d6c0fa" }, "external_id" : "VELOCITY-334", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Typo in VTL Reference Guide", "desc" : "There is typo in \"References - Methods\" in VTL Reference Guide:\n\"opional parameter list.\"\nApparently it should be \"optional parameter list.\"", "created_at" : { "$date" : "2005-01-11T20:57:29.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:46.117+0000" }, "creator_id" : { "$oid" : "5b7d3771e9214a0d1608d76e" }, "reporter_id" : { "$oid" : "5b7d3771e9214a0d1608d76e" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e185f627d84c8d6c105" }, "external_id" : "VELOCITY-8", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "issue with simple math operations in template", "desc" : "Trying to add up a total amount for prices or such things within a template \nisn't working -- looks like the context variable is resetting itself. I'm using \nthe latest sources from 1.2-dev (20010621)\n\nExamples (two variations of the same thing, chopped out of my source code):\n\n      #set( $totalPrice = 0 )\n      #set( $items = ${bundle.getItems()} )\n      #foreach( $i in $items )\n        #set( $totalPrice = $totalPrice + $i.getPrice() )\n      #end\n      <!-- ${totalPrice} -->\n\n      ##Example 2:\n\n      #set( $items = ${bundle.getItems()} )\n      #foreach( $i in $items )\n        #if( $totalPrice )\n          #set( $totalPrice = $i.getPrice() + $totalPrice )\n        #else\n          #set( $totalPrice = $i.getPrice() )\n        #end\n        <!-- ${totalPrice} -->\n      #end\n\nAssume the items in question being looped through (yes, they are displaying \nproperly) all have a price of $7, and there are 4 of them. The price is \nreturned from a Java object which has a public double getPrice() method defined.\n\nThe first example returns:\n\n<!-- -->\n<!-- -->\n<!-- -->\n<!-- -->\n\nThe second example returns:\n\n<!-- 7.0 -->\n<!-- 7.0 -->\n<!-- 7.0 -->\n<!-- 7.0 -->\n\nObviously, what I wanted was:\n\n<!-- 7.0 -->\n<!-- 14.0 -->\n<!-- 21.0 -->\n<!-- 28.0 -->\n\nMy velocity.properties:\nresource.loader.1.resource.path = e:\\\\path\\\\to\\\\templates\nfile.resource.loader.path = e:\\\\path\\\\to\\\\templates\nfile.resource.loader.modificationCheckInterval = 30\nfile.resource.loader.cache = true\nvelocimacro.permissions.allow.inline = true\nvelocimacro.permissions.allow.inline.local.scope = true\nvelocimacro.context.localscope = false\nparser.pool.size = 20\n\nMy system is Windows NT 4 running JDK1.3 and I'm using this with Tomcat 3.2.1\n\nPlease don't hesitate to contact me if you need a better example (or help \nreproducing this problem). Obviously I got the 2 examples because I created the \nsecond in an attempt to work around the first one. Thanks for your help!", "created_at" : { "$date" : "2001-06-21T18:07:13.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:46.689+0000" }, "creator_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "reporter_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e185f627d84c8d6c10f" }, "external_id" : "VELOCITY-80", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "trying to run servlet_example1", "desc" : "Follow the directions and this the error message I get.  My wev server is\njakarta-tomcat-4.0.3\n\njavax.servlet.ServletException: Cannot allocate servlet instance for path\n/velexamples/servlet/SampleServlet\n\tat org.apache.catalina.servlets.InvokerServlet.serveRequest(InvokerServlet.java:415)\n\tat org.apache.catalina.servlets.InvokerServlet.doGet(InvokerServlet.java:180)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:243)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:190)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.CertificatesValve.invoke(CertificatesValve.java:246)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2343)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:468)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:1012)\n\tat org.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:1107)\n\tat java.lang.Thread.run(Thread.java:536)\n\nroot cause\n\njava.lang.NoClassDefFoundError\n\tat org.apache.velocity.app.Velocity.init(Velocity.java:149)\n\tat org.apache.velocity.servlet.VelocityServlet.initVelocity(VelocityServlet.java:232)\n\tat org.apache.velocity.servlet.VelocityServlet.init(VelocityServlet.java:198)\n\tat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:916)\n\tat org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:653)\n\tat org.apache.catalina.servlets.InvokerServlet.serveRequest(InvokerServlet.java:396)\n\tat org.apache.catalina.servlets.InvokerServlet.doGet(InvokerServlet.java:180)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:243)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:190)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.CertificatesValve.invoke(CertificatesValve.java:246)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2343)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:468)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:1012)\n\tat org.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:1107)\n\tat java.lang.Thread.run(Thread.java:536)", "created_at" : { "$date" : "2002-05-17T20:11:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:46.945+0000" }, "creator_id" : { "$oid" : "5b7d3773e9214a0d1608d770" }, "reporter_id" : { "$oid" : "5b7d3773e9214a0d1608d770" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e195f627d84c8d6c117" }, "external_id" : "VELOCITY-113", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "cannot compare Timestamp.getTime() to 0", "desc" : "I was trying to make a macro to show empty line when $dt (Timestamp) object is \nempty:\n\n#macro ( dateshowempty $dt)\n  #set ($mlsc = $dt.getTime())\n  #if ($mlsc == 0) --.--.---- \n  #else ${dt} \n  #end\ndebug: $mlsc\n#end\n\nArgument is Timestamp object. Macro never prints empty line (--.--.----)\nCondition doesn't work... \nHowever, debug line prints [debug: 0]\n\nPerhaps, it happens because getTime() returns long? \nVelocity cannot compare Long to Integer and condition is wrong forever?\n\nI changed line: #set ($mlsc = $dt.getTime()) to: #set ($mlsc = 0) -- everything OK --\n I saw my empty line (--.--.----)\n\nMaybe I could set $mlsc to long type (something like 0L), but I don't know how to \ndo it...", "created_at" : { "$date" : "2002-11-01T20:26:23.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:46.340+0000" }, "creator_id" : { "$oid" : "5b7d3774e9214a0d1608d771" }, "reporter_id" : { "$oid" : "5b7d3774e9214a0d1608d771" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e1a5f627d84c8d6c11f" }, "external_id" : "VELOCITY-378", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Possibly wrong explanation in doc: \"Templates may live in subdirectories\"", "desc" : "In developer guide located at http://jakarta.apache.org/velocity/developer-\nguide.html, explanation regarding with \"<name>.resource.loader.path\" \nsays \"Templates may live in subdirectories of this root.\" \n\nFollowing this guidance, I created a subdirectory within root directroy which \nis set with \"file.resource.loader.path\" in velocity.properties. Then put \nmytemplate.vm file in subdirectory. After I ran my application, Velocity threw \na ResourceNotFoundException. When I put mytemplate.vm into root directory, it \nworks fine.", "created_at" : { "$date" : "2005-05-14T21:42:22.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:47.906+0000" }, "creator_id" : { "$oid" : "5b7d3775e9214a0d1608d772" }, "reporter_id" : { "$oid" : "5b7d3775e9214a0d1608d772" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e1a5f627d84c8d6c127" }, "external_id" : "VELOCITY-386", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "path setting Error", "desc" : "When I try to set a new path for the ResourrceManager, it does not get set.\nExample:\n\n//working directory is \"/home/ntb/serverPath\"\n\nvelocityEngine = new VelocityEngine();\nvelocityEngine.addProperty(\"path\",\"/home/ntb/VelocityTest/\");\nvelocityEngine.init();\n\nTemplate template= velocityEngine.getTemplate(\"wwwroot/WEB-INF/Velocity/x.vm\");\n\nEven if the file \"/home/ntb/VelocityTest/wwwroot/WEB-INF/Velocity/x.vm\" does\nexist,An exception is returned. \nAfter looking into your code, I can see that the ResourceManager is looking for\n\".wwwroot/WEB-INF/Velocity/x.vm\", which is incorect. I think the bug is in\nResourceManagerImpl.initialize (The configuration is well set, it has a path\nproperty pointing to my required directory, but the resulting recourceLoader\nstill has the path set to \".\".", "created_at" : { "$date" : "2005-06-27T22:33:15.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:47.137+0000" }, "creator_id" : { "$oid" : "5b7d3776e9214a0d1608d773" }, "reporter_id" : { "$oid" : "5b7d3776e9214a0d1608d773" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e1b5f627d84c8d6c130" }, "external_id" : "VELOCITY-282", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "properties file name change not documented", "desc" : "In velocity 1.4 the properties file name specified in the init-param/name value \nin web.xml was \"properties\" as is now \"org.apache.velocity.properties.\"  \nNeither the online site docs nor the bundled documents have this change in \nplace.  Took going through the code manually to determine how my configuration \nhad changed.  May also want to list this change in the change log.", "created_at" : { "$date" : "2004-07-15T02:10:04.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:48.791+0000" }, "creator_id" : { "$oid" : "5b7d3777e9214a0d1608d774" }, "reporter_id" : { "$oid" : "5b7d3777e9214a0d1608d774" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e1c5f627d84c8d6c13a" }, "external_id" : "VELOCITY-37", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Several more typos in the User Guide", "desc" : "Hi,\n\nI ran the User Guide HTML (taken from the Velocity Web site) through a spell \nchecker and found the following typos.  However, I did not verify whether or \nnot any of these have already been fixed in the latest XML version of the file.\n\nTypo: \"... methods that return boolean - the intrspection infrastructure...\"\nFix:  \"... methods that return boolean - the introspection infrastructure...\"\n\nTypo: \"... Velocity's numeric comparisons are contrained to...\"\nFix:  \"... Velocity's numeric comparisons are constrained to...\"\n\nTypo: \"# variable refernce\"\nFix:  \"# variable reference\"\n\nTypo: \"This could be useful for targetting output...\"\nFix:  \"This could be useful for targeting output...\"\n\nTypo: \"A Velocimacro could take any number number of arguments...\"\nFix:  \"A Velocimacro could take any number of arguments...\"\n\nTypo: \"... rendered from the '\\\\' preceeding the...\"\nFix:  \"... rendered from the '\\\\' preceding the...\"\n\nTypo: \"... different line than the text beacsue there...\"\nFix:  \"... different line than the text because there...\"\n\nTypo: \"... so the final \\\\, preeceding...\"\nFix:  \"... so the final \\\\, preceding...\"\n\nTypo: \"... latter exmaple the arg...\"\nFix:  \"... latter example the arg...\"\n\nTypo: \"... or to set a new referece, just...\"\nFix:  \"... or to set a new reference, just...\"\n\nThanks,\nKevin Hammond", "created_at" : { "$date" : "2002-02-19T03:52:34.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:48.329+0000" }, "creator_id" : { "$oid" : "5b7d3777e9214a0d1608d775" }, "reporter_id" : { "$oid" : "5b7d3777e9214a0d1608d775" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e1c5f627d84c8d6c141" }, "external_id" : "VELOCITY-160", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Pooled VelocityWriters in VelocityServlet do not release Writer until recycled", "desc" : "Based on some memory debugging with Tomcat and ServletExec servlet engines, we \nhave noticed that the VelocityWriter objects in the VelocityServlet keep a \nreference to the OutputStreamWriter when placed into the SimplePool until the \nVelocityWriter object is removed from the pool and recycled. The effect of \nthis retained reference causes the response and request objects to remain in \nmemeory and, depending on the implementation, the attributes for the request \nand response objects remain as well. \n\nBy removing the reference to the OutputStreamWriter from the VelocityWriter \n(i.e. setting it to null) before placing it back into the pool, the system \nwill be able to reclaim the request and response objects. Although this would \nnot be noticed much on a busy system where there are requests exhausting the \npooled objects, when activity drops and many VelocityWriters are retained in \nthe pool, this can cause large amounts of memory to be wasted until the \nVelocityWriter is recycled if request attributes to large objects are still \nretained.\n\nIn the finally block of the mergeTemplate method, the VelocityWriter could be \nrecycled with a null value for the Writer *before* being placed into the pool \n(or some other *reset* method could be added to the VW):\n\n                    vw.flush();\n                    vw.recycle( null ); // or vw.reset();\n                    writerPool.put(vw);", "created_at" : { "$date" : "2003-04-11T18:48:40.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:48.145+0000" }, "creator_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "reporter_id" : { "$oid" : "5b7d376ce9214a0d1608d769" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e1d5f627d84c8d6c14a" }, "external_id" : "VELOCITY-123", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error messages missing!", "desc" : "I tried to recreate http://jakarta.apache.org/ant/faq.html with anakia, so I\ncopied http://cvs.apache.org/viewcvs.cgi/~checkout~/jakarta-ant/xdocs/faq.xml\nand\nhttp://cvs.apache.org/viewcvs.cgi/~checkout~/jakarta-ant/xdocs/stylesheets/faq.vsl\ninto my local \"jakarta-velocity/examples/anakia\" i.e. the corresponding\nsudirectories.\n\ncd build; ant\nBuildfile: build.xml\n\nprepare:\n\nprepare-error:\n\ndocs:\n   [anakia] Transforming into: ...jakarta-\nvelocity\\examples\\anakia_rh\\docs\n   [anakia] Input:  faq.xml\n   [anakia] Output: ...jakarta-velocity\\ex\namples\\anakia_rh\\docs\\faq.html\n\nBUILD SUCCESSFUL\nTotal time: 4 seconds\n\nBut while the faq.xml's size is 42k, the created faq.html is virutally empty.\nAnd no error message appeared?\n1) How can I convince ant/anakia to be more verbose?\n\nI see in http://jakarta.apache.org/ant/faq.html#creating-faq that I should have\ndocs.xml and jakarta-site2, but I find neither of the two under\nhttp://cvs.apache.org/viewcvs.cgi/jakarta-ant/xdocs/ ?", "created_at" : { "$date" : "2003-01-10T16:20:10.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:48.967+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e1e5f627d84c8d6c156" }, "external_id" : "VELOCITY-306", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "JavaDocs on Velocity web site apply to outdated 1.3.1 version", "desc" : "Looks like the JavaDocs are out of date.  They should be for the 1.4 release, \nbut are actually JavaDocs for version 1.3.1", "created_at" : { "$date" : "2004-10-21T01:33:56.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:49.571+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e1e5f627d84c8d6c15e" }, "external_id" : "VELOCITY-292", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Can't refer to inherited methods using $bean.getWhatever() syntax", "desc" : "I have a class structure where most of my beans extend a class that provides  \ngetPrefix() and getVersion() methods. I added the reference $bean.getPrefix() to \none of my Velocity templates and it wasn't able to resolve the value. I had used \nthe bean elsewhere in the same template so I know that it was in the context and \nassociated with the name \"bean\". I may have just missed something in the \ndocumentation about this, but it is a real issue for me as I would have to \npropogate down all the super class methods to all of the extending beans.", "created_at" : { "$date" : "2004-09-02T03:23:50.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:49.148+0000" }, "creator_id" : { "$oid" : "5b7d377be9214a0d1608d776" }, "reporter_id" : { "$oid" : "5b7d377be9214a0d1608d776" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e1f5f627d84c8d6c166" }, "external_id" : "VELOCITY-89", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "1.3 templates incompatible with ones that worked on 1.2", "desc" : "First off, Velocity is absolutely excellent! Been using it since the first\nrelease, and have definitely not regretted the decision to use this instead of\nJSP/Webmacro/etc.\n\nI downloaded Velocity 1.3, and unfortunately there appears to be a bug in this\nrelease, running code which works just fine on 1.2.\n\nFirst, I added to the Context a utility class that I use frequently under the\nname 'utility', which basically has the following:\n\n  public Object arrayGet( Collection c, int index ) {\n    return arrayGet( c.toArray(), index );\n  }\n\n  public Object arrayGet( Object[] array, int index ) {\n    if ( index >= 0 && index < array.length ) {\n      return array[ index ];\n    }\n    else {\n      return null;\n    }\n  }\n\n(don't ask - it solved a problem for me in the past and it's worked great ever\nsince)\n\nNext, an example template might have:\n#set ( $colour_tablelines = [\"#FFFFFF\",\"lightblue\"] )\n#set ($count = 0)\n#foreach($c in $items)\n  #set( $currentcol = $count % 2 )\n  #set( $backcolour = ${utility.arrayGet( ${colour_tablelines},$currentcol )} )\n  <tr bgcolor=\"$!{backcolour}\">\n... etc etc\n  </tr>\n#end\n\nThe idea, of course, is to alternate the colours of the lines to make the page\neasier to read. Perhaps not an optimal solution, but it worked great with every\nrelease of Velocity <= 1.2.\n\nUnfortunately with 1.3, I get the following in my log instead:\nMon Jul 08 11:45:04 EDT 2002  [error] RHS of #set statement is null. Context\nwill not be modified. mytemplate.vm [line 250, column 1]\n\nMon Jul 08 11:45:04 EDT 2002   [warn]\norg.apache.velocity.runtime.exception.ReferenceException: reference : template =\nmytemplate.vm [line 268,column 18] : ${backcolour} is not a valid reference.\n\nWhile I'm definitely open to suggestions as to how to make this code a bit\ncleaner, the underlying problem is that I have many templates and changing them\nall would be a lot of work. I'd prefer if it were possible to maintain\ncompatibility with previous releases of Velocity. For now, I am noting this\nissue and continuing with my testing to see if there are any more incompatibilities.\n\nThanks for your efforts!", "created_at" : { "$date" : "2002-07-08T23:04:17.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:49.386+0000" }, "creator_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "reporter_id" : { "$oid" : "5b7d3772e9214a0d1608d76f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e205f627d84c8d6c176" }, "external_id" : "VELOCITY-398", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Servlet 2.3 compile errors in VelocityServletTest.java", "desc" : "The inner classes MockServletContext and MockHttpServletResponse of the class\norg.apache.velocity.test.VelocityServletTest do not implement some abstract\nmethods from the base class:\n\nMockServletContext:\n   public String getServletContextName()\n\n   public Set getResourcePaths(String)\n\n\nMockHttpServletResponse:\n   public void resetBuffer()\n\n   public String getContentType()\n\n   public void setCharacterEncoding(String)", "created_at" : { "$date" : "2005-09-11T18:32:09.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:50.953+0000" }, "creator_id" : { "$oid" : "5b7d377de9214a0d1608d777" }, "reporter_id" : { "$oid" : "5b7d377de9214a0d1608d777" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e205f627d84c8d6c181" }, "external_id" : "VELOCITY-323", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "YMTD webpage - incorrect screenshot", "desc" : "The screenshots found at\n\nhttp://jakarta.apache.org/velocity/ymtd/images/hello-jsp.gif\nhttp://jakarta.apache.org/velocity/ymtd/images/hello-velocity.gif \n\nare incorrect. \n\n\"hello-jsp.gif\" does not show any text at all. \n\"hello-velocity.gif\" shows the unprocessed velocity markup.", "created_at" : { "$date" : "2004-11-28T00:30:02.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:50.348+0000" }, "creator_id" : { "$oid" : "5b7d377fe9214a0d1608d778" }, "reporter_id" : { "$oid" : "5b7d377fe9214a0d1608d778" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e215f627d84c8d6c18b" }, "external_id" : "VELOCITY-43", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "can't parse text immediately after #else", "desc" : "I need to have a macro that returns a string with no newlines or \nleading/trailing spaces. The problem I found was that something like:\n\n#macro( test2 $n)\n#if($n<5)small#elselarge#end\n#end\n\ndoes not recognize the #else token. It produces the string \"small#elselarge\" \nor \"\"", "created_at" : { "$date" : "2002-03-18T12:31:11.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:50.772+0000" }, "creator_id" : { "$oid" : "5b7d3780e9214a0d1608d779" }, "reporter_id" : { "$oid" : "5b7d3780e9214a0d1608d779" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e225f627d84c8d6c19c" }, "external_id" : "VELOCITY-13", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Passing Integer to velocimacro with formal notation does not work", "desc" : "The velocity user's guide states:\n--------8<---------------------\nVelocimacros can take as arguments any of the following VTL elements : \n\nReference : anything that starts with '$' \nString literal : something like \"$foo\" or 'hello' \nNumber literal : 1, 2 etc \nIntegerRange : [ 1..2] or [$foo .. $bar] \nObjectArray : [ \"a\", \"b\", \"c\"] \nboolean value true \nboolean value false\n\"\n----------8<---------------------\n\nSo I constructed the following macro:\n\n\n#macro(getIcon $name $num)\n## int gets converted to string when passed\n#if ($num > 0)\n\ticon-${name}-on.gif\n#else\n\ticon-${name}-off.gif\n#end\n#end\n\n... and called it like this:\n\n#getIcon( 'mail' ${numMail} )\n\n... where $numMail was an Integer object with a value greater than zero\n\nin the macro, it always thought $num was null.\n\nuntil I did this:\n\n#getIcon( 'mail' $numMail )\n\n.. then it worked.\n\nThe formal notation didn't work, even though the doc says:\n\" Reference : anything that starts with '$' \"\n\n\nEither the doc should clarify or the behaviour should be fixed to include \nformal notation.", "created_at" : { "$date" : "2001-08-29T20:41:16.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:50.588+0000" }, "creator_id" : { "$oid" : "5b7d364be9214a0d1608d6fb" }, "reporter_id" : { "$oid" : "5b7d364be9214a0d1608d6fb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904e225f627d84c8d6c1a8" }, "external_id" : "VELOCITY-331", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[typo] shmoo or schmoo", "desc" : "I don't know which spelling is correct, but there are two variations of \nshmoo/schmoo.\n\nIn the distribution, schmoo outnumbers shmoo 34 to 4.  Google says schmoo 760 \nto shmoo 459.  I'll assume schmoo is correct and submit a patch.\n\n## BTW, how is it pronounced?", "created_at" : { "$date" : "2005-01-04T07:01:17.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:51.369+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e235f627d84c8d6c1b3" }, "external_id" : "VELOCITY-236", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "vtl-reference-guide.xml #set example is wrong.", "desc" : "From vtl-reference-guide.xml l.138:\n      <li>Variable reference: #set( $monkey = \"bill\" )</li>\nBut I think this should read \n      <li>Variable reference: #set( $monkey = $bill )</li>\n\nThanks.", "created_at" : { "$date" : "2003-12-06T22:22:31.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:51.540+0000" }, "creator_id" : { "$oid" : "5b7d3793e9214a0d1608d77a" }, "reporter_id" : { "$oid" : "5b7d3793e9214a0d1608d77a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e245f627d84c8d6c1bd" }, "external_id" : "VELOCITY-61", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Problems embedding line comments inside block comments", "desc" : "If you have a regular comment inside a block comment, you will see \"#*\" (the\nstart characters of the block comment) appear on the page.", "created_at" : { "$date" : "2002-04-03T06:05:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:51.191+0000" }, "creator_id" : { "$oid" : "5b7d3794e9214a0d1608d77b" }, "reporter_id" : { "$oid" : "5b7d3794e9214a0d1608d77b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e245f627d84c8d6c1cf" }, "external_id" : "VELOCITY-16", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "ANT href on this webpage (Install) is bad", "desc" : "On page: http://jakarta.apache.org.ant/\n\nShould be: http://jakarta.apache.org/ant/\n\nTrivial but should be fixed. This is my first filed bug, so please excuse any \nproblems with component/version settings.", "created_at" : { "$date" : "2001-09-26T01:09:22.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:51.951+0000" }, "creator_id" : { "$oid" : "5b7d3795e9214a0d1608d77c" }, "reporter_id" : { "$oid" : "5b7d3795e9214a0d1608d77c" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e255f627d84c8d6c1d7" }, "external_id" : "VELOCITY-97", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "CVS velocity-tools - JDK 1.4.1 - dvsl errors ResourceManager : unable to find resource", "desc" : "FYI,\n\nthe ant build reports ok, but there are many [dvsl]  [error] messages,\nwhcih you might want to look. I have no idea what do they mean, so I'm \npassing this info to you.\n\nEnv:\n\nW2k Sp2\nWin32 JDK 1.4.1\nCygwin 1.3.1\nCVS ant - 1.6a\n\n- Jari\n\nroot@W2KPICASSO:/cygdrive/d/java/apache/cvs/jakarta-velocity-tools$ ant.bat\nBuildfile: build.xml\n\nview:\n\ninit:\n     [echo] -------- velocity-tools-view 0.8 --------\n\nprepare:\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\view\\target\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\classes\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\conf\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\javadoc\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\view\\docs\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\docs\\javadoc-velservlet\n\nstatic:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\conf\n\ncompile:\n    [javac] Compiling 16 source files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\classes\n     [copy] Copying 3 files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\target\\classes\n\njar:\n      [jar] Building jar: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\velocity-tools-view-0.8.jar\n\ninstall-jar:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-tools\\lib\n\ndocs:\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\xdocs\\velservlet.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\docs\\velservlet.html\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\xdocs\\velservlet.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\docs\\velservlet-printer.html\n\njavadocs:\n  [javadoc] Generating Javadoc\n  [javadoc] Javadoc execution\n  [javadoc] Loading source files for package org.apache.velocity.tools.view...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.context...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.i18n...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.servlet...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.tools...\n  [javadoc] Constructing Javadoc information...\n  [javadoc] Standard Doclet version 1.4.1\n\n  [javadoc] Building tree for all the packages and classes...\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n\njavadocs-velservlet:\n  [javadoc] Generating Javadoc\n  [javadoc] Javadoc execution\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.context...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.servlet...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.tools...\n  [javadoc] Constructing Javadoc information...\n  [javadoc] Standard Doclet version 1.4.1\n\n  [javadoc] Building tree for all the packages and classes...\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n\nexamples:\n     [copy] Copying 6 files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\examples\\simple\\WEB-INF\\lib\n\ninit:\n\nprepare:\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\examples\\simple\\WEB-INF\\classes\n\ncompile:\n    [javac] Compiling 1 source file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\examples\\simple\\WEB-INF\\classes\n\nwar:\n      [jar] Building jar: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\view\\examples\\simple.war\n     [echo]                                                   \n     [echo]                                                   \n     [echo]   A WAR file (Web ARchive) was created for you in \n     [echo]   the directory above. (/examples)  It is called  \n     [echo]                                                   \n     [echo]       simple.war                                  \n     [echo]                                                   \n     [echo]   To use it with Tomcat, copy the .war file to    \n     [echo]   the webapps directory in the Tomcat tree        \n     [echo]   (assuming a standard Tomcat installation)  and  \n     [echo]   then restart Tomcat.  To access the page        \n     [echo]   point you browser to                            \n     [echo]                                                   \n     [echo]      http://localhost:8080/simple/index.vm        \n     [echo]                                                   \n     [echo]   If you have any questions, don't hesitate to    \n     [echo]   ask on the Velocity user list.                  \n\nall:\n\nall:\n\nlibrary:\n\ninit:\n     [echo] -------- velocity-tools-library 0.3 --------\n\nprepare:\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\tools\\docs\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\javadoc\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\tools\\target\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\target\\classes\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\target\\conf\n\nstatic:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\target\\conf\n\ncompile:\n    [javac] Compiling 4 source files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\target\\classes\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\target\\classes\n\njar:\n      [jar] Building jar: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\velocity-tools-library-0.3.jar\n\ninstall-jar:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-tools\\lib\n\ndocs:\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\DateTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\DateTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\MathTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\MathTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\ParameterParser.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\ParameterParser.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\ToolLoader.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\ToolLoader.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\index.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\index.html\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\DateTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\DateTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\MathTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\MathTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\ParameterParser.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\ParameterParser-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\ToolLoader.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\ToolLoader-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\xdocs\\index.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\tools\\docs\\index-printer.html\n\njavadocs:\n  [javadoc] Generating Javadoc\n  [javadoc] Javadoc execution\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.context...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.servlet...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.tools...\n  [javadoc] Loading source files for package org.apache.velocity.tools.tools...\n  [javadoc] Constructing Javadoc information...\n  [javadoc] Standard Doclet version 1.4.1\n\n  [javadoc] Building tree for all the packages and classes...\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n\nall:\n\nstruts:\n\ninit:\n     [echo] -------- velocity-tools-struts 0.9 --------\n\nprepare:\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\struts\\docs\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\struts\\target\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\classes\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\conf\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\javadoc\n\nstatic:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\conf\n\ncompile:\n    [javac] Compiling 5 source files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\classes\n    [javac] D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\src\\java\\org\\apache\\velocity\\tools\\struts\\LinkTool.java:501: \nwarning: encode(java.lang.String) in java.net.URLEncoder has been deprecated\n    [javac]             out.append(URLEncoder.encode(key));\n    [javac]                                  ^\n    [javac] D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\src\\java\\org\\apache\\velocity\\tools\\struts\\LinkTool.java:503: \nwarning: encode(java.lang.String) in java.net.URLEncoder has been deprecated\n    [javac]             out.append(URLEncoder.encode(String.valueOf(value)));\n    [javac]                                  ^\n    [javac] 2 warnings\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\target\\classes\n\njar:\n      [jar] Building jar: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\velocity-tools-struts-0.9.jar\n\ninstall-jar:\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-tools\\lib\n\ndocs:\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\ErrorsTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\ErrorsTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\FormTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\FormTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\LinkTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\LinkTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\MessageTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\MessageTool.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\StrutsTools.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\StrutsTools.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\index.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\index.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\userguide.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\userguide.html\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\ErrorsTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\ErrorsTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\FormTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\FormTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\LinkTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\LinkTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\MessageTool.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\MessageTool-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\StrutsTools.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\StrutsTools-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\index.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\index-printer.html\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\xdocs\\userguide.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\docs\\userguide-printer.html\n\njavadocs:\n  [javadoc] Generating Javadoc\n  [javadoc] Javadoc execution\n  [javadoc] Loading source files for package org.apache.velocity.tools.struts...\n  [javadoc] Constructing Javadoc information...\n  [javadoc] Standard Doclet version 1.4.1\n\n  [javadoc] Building tree for all the packages and classes...\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n\nexamples:\n     [copy] Copying 10 files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\struts\\WEB-INF\\lib\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\struts\\WEB-INF\\build-lib\n     [copy] Copying 18 files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\struts\\doc\\javadoc\n\ninit:\n     [echo] -------- VelocityStruts Example --------\n\ncompile:\n    [javac] Compiling 10 source files to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\struts\\WEB-INF\\classes\n     [copy] Copying 1 file to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\struts\\WEB-INF\\classes\n\nwar:\n      [jar] Building jar: D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\struts\\examples\\velstruts.war\n\nall:\n\nall:\n\ninit:\n     [echo] -------- VelocityTools --------\n\nprepare:\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\docs\n    [mkdir] Created dir: D:\\java\\apache\\cvs\\jakarta-velocity-tools\\docs\\javadoc\n\nstatic:\n\ndocs:\n     [dvsl] Loading stylesheet D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\site.dvsl\n     [dvsl]  [error] ResourceManager : unable to find \nresource 'VM_global_library.vm' in any resource loader.\n     [dvsl] Transforming into D:\\java\\apache\\cvs\\jakarta-velocity-tools\\docs\n     [dvsl] Processing D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\xdocs\\index.xml to D:\\java\\apache\\cvs\\jakarta-velocity-\ntools\\docs\\index.html\n\njavadocs:\n  [javadoc] Generating Javadoc\n  [javadoc] Javadoc execution\n  [javadoc] Loading source files for package org.apache.velocity.tools.view...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.context...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.i18n...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.servlet...\n  [javadoc] Loading source files for package \norg.apache.velocity.tools.view.tools...\n  [javadoc] Loading source files for package org.apache.velocity.tools.struts...\n  [javadoc] Loading source files for package org.apache.velocity.tools.tools...\n  [javadoc] Constructing Javadoc information...\n  [javadoc] Standard Doclet version 1.4.1\n\n  [javadoc] Building tree for all the packages and classes...\n  [javadoc] Building index for all the packages and classes...\n  [javadoc] Building index for all classes...\n\nall:\n\nBUILD SUCCESSFUL\nTotal time: 2 minutes 18 seconds", "created_at" : { "$date" : "2002-07-24T06:16:53.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:51.779+0000" }, "creator_id" : { "$oid" : "5b7d374ee9214a0d1608d75b" }, "reporter_id" : { "$oid" : "5b7d374ee9214a0d1608d75b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e255f627d84c8d6c1df" }, "external_id" : "VELOCITY-270", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "XML content size issue", "desc" : "I have an XML in which one tag has content more than 50K. When I try to render\nthe content using Velocity, somehow the first 16K content(exactly) is getting\nskipped. How do I get rid of this? This is causing a major issue in my application.", "created_at" : { "$date" : "2004-05-20T23:13:54.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:52.132+0000" }, "creator_id" : { "$oid" : "5b7d3796e9214a0d1608d77d" }, "reporter_id" : { "$oid" : "5b7d3796e9214a0d1608d77d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e265f627d84c8d6c1e6" }, "external_id" : "VELOCITY-244", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Broken Link to API in developer guide", "desc" : "In the \"Using Velocity with Servlets\" section, the link under \"Javadoc API\ndocumentation\" which points to\nhttp://jakarta.apache.org/velocity/apidocs/index.html is broken and the sentence\nseems to end oddly... perhaps \"Deployment\" is supposed to be a sub-section heading?\n\n\"For further information, please see the Javadoc API documentation. Deployment\"\n\nhttp://jakarta.apache.org/velocity/api/index.html seems to be the correct link.", "created_at" : { "$date" : "2004-01-07T01:13:02.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:52.757+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e275f627d84c8d6c1f0" }, "external_id" : "VELOCITY-170", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "TOOLS: Documentation update proposal", "desc" : "This is the first two patches, the rest of the proposed changes \nare 'additions' because I organized the docs into three directories. Yes, I \nrealize that the src tree was consolidated; however, it just didn't make as \nmuch sense to stuff all the docs into a single directory. Afterall, despite \nhaving a single src tree, there are STILL package branches - so I am simply \nmimicing that structure.\n\nTimo", "created_at" : { "$date" : "2003-04-25T03:27:30.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:52.990+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e275f627d84c8d6c1fd" }, "external_id" : "VELOCITY-134", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity-Tools / ErrorTools patch", "desc" : "// Add method to return \"global\" error name.\n\n    /**\n     * <p>Returns the default \"Global\" category name that can be used with\n     * messages that are not associated with a particular property.</p>\n     *\n     * <p>This is the value of\n     * <code>org.apache.struts.action.ActionErrors.GLOBAL_ERROR</code></p>\n     */\n    public String getGlobal()\n    {\n        return StrutsUtils.getGlobalErrorName();\n    }\n\n// Add method to return ActionErrors object. \n\n    /**\n     * <p>Exposes the ActionErrors object underlying this request.</p>\n     *\n     * @return The ActionErrors object.\n     */\n    public ActionErrors getErrors()\n    {\n        return errors;\n    }", "created_at" : { "$date" : "2003-02-04T08:13:56.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:52.556+0000" }, "creator_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "reporter_id" : { "$oid" : "5b7d3799e9214a0d1608d77e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e285f627d84c8d6c20b" }, "external_id" : "VELOCITY-109", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "failed to call overloaded method in foreach loop when item changes class type", "desc" : "1 create a class with two overloaded methods like\npublic class Helper {\n   public String getFoo(Integer v) { return \"int \"+v; }\n   public String getFoo(String v) { return \"str \"+v; }\n}\n2. put an instance of Helper and a collection containing two items of \ndifferent types\ncol = new ArrayList();\ncol.add(new Integer(100));\ncol.add(\"STRVALUE\");\nctx.put(\"helper\", new Helper());\nctx.put(\"col\", col);\n3. in a template, do\n#foreach ( $item in $col )\n${helper.getFoo($item)\n#end\n4. evaluate the template and you should see\nint 100\n${helper.getFoo($item)\n\nThe error: the second item should invoke getFoo(String) but it apparently \nfails and causing the invocation failure.", "created_at" : { "$date" : "2002-10-15T14:39:57.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:52.381+0000" }, "creator_id" : { "$oid" : "5b7d379ae9214a0d1608d77f" }, "reporter_id" : { "$oid" : "5b7d379ae9214a0d1608d77f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e295f627d84c8d6c215" }, "external_id" : "VELOCITY-74", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "DateTool.getDate( ) calls itself...", "desc" : "DateTool.getDate() calls getDate() instead of new Date(), generating a \nStackOverflowError...obviously a typo... The patch follows.\n\ndiff -ur jakarta-velocity-\ntools/tools/src/java/org/apache/velocity/tools/tools/DateTool.java patched-\ntools/tools/src/java/org/apache/velocity/tools/tools/DateTool.java\n--- jakarta-velocity-\ntools/tools/src/java/org/apache/velocity/tools/tools/DateTool.java Mon Apr 15 \n20:30:28 2002\n+++ patched-tools/tools/src/java/org/apache/velocity/tools/tools/DateTool.java  \nTue May  7 01:57:57 2002\n@@ -99,7 +99,7 @@\n      */\n     public static Date getDate()\n     {\n-        return getDate();\n+        return new Date();\n     }", "created_at" : { "$date" : "2002-05-07T07:17:17.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:53.973+0000" }, "creator_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "reporter_id" : { "$oid" : "5b7d354ee9214a0d1608d683" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e2a5f627d84c8d6c21e" }, "external_id" : "VELOCITY-3", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "prerequisites link suggestion plus questions", "desc" : "Hi I saw your project mentioned at Slashdot.org and came to check things out. I \nspent a while to find what was needed to start. \n\nI think others may benefit from a prominent prerequisites link? It looks like \nsome sort of servlet runner or app server and web server framework may be \nrequired?  \n\nI'm also curious to know if there are VTL tags to allow for easy DB connection \nand querying? Also, the various successful platform deployments would be cool \nto know - e.g. does it work on BSD w/ Tomcat, Resin, Apache, etc. \n\nThanks,\n\nBill Moss", "created_at" : { "$date" : "2001-04-13T23:04:34.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:53.794+0000" }, "creator_id" : { "$oid" : "5b7d379ce9214a0d1608d781" }, "reporter_id" : { "$oid" : "5b7d379ce9214a0d1608d781" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e2a5f627d84c8d6c226" }, "external_id" : "VELOCITY-396", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Typo in Default velocity.properties", "desc" : "At org.apache.velocity.runtime.defaults.velocity.properties\n runtime.log.invalid.reference = true\nshould be read \n runtime.log.invalid.references = true\naccording to org.apache.velocity.runtime.RuntimeConstants\n\nThanks.", "created_at" : { "$date" : "2005-07-15T18:36:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:54.208+0000" }, "creator_id" : { "$oid" : "5b7d379de9214a0d1608d782" }, "reporter_id" : { "$oid" : "5b7d379de9214a0d1608d782" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e2b5f627d84c8d6c230" }, "external_id" : "VELOCITY-190", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] Anakia Custom Context Support", "desc" : "This update allows the customization of the velocity context in addition to the \ndefault $project context.\n\nFor example the user can now do:\n\n<anakia ...>\n    <context name=\"myContext\" file=\"myCustomContext.xml\">\n    <context ...>\n</anakia>\n\nFiles Changed Are (there are two new files):\n\n/build/testcases.xml\n/src/java/org/apache/velocity/anakia/AnakiaTask.java\n/src/java/org/apache/velocity/test/AnakiaTestCase.java\n/test/anakia/compare/index.context.html (new)\n/test/anakia/results/index.context.html (new)\n/test/anakia/xdocs/stylesheets/site_contexts.vsl", "created_at" : { "$date" : "2003-07-09T03:27:20.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:54.812+0000" }, "creator_id" : { "$oid" : "5b7d3551e9214a0d1608d68b" }, "reporter_id" : { "$oid" : "5b7d3551e9214a0d1608d68b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Anakia" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e2c5f627d84c8d6c246" }, "external_id" : "VELOCITY-205", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Macro names that start with the 'set' cause VTL parse errors", "desc" : "The VTL parser does not differentiate between a macro name that starts with the\nword 'set' and the '#set' directive.\n\nExample:\n\n#macro( setPageAttributes )\n...\n#end\n\nUsing #setPageAttributes() results in a Velocity parse error (as follows).\n\nEncountered \"PageAttributes\" at line ..., column ....\nWas expecting one of:\n    \"(\" ...\n    <WHITESPACE> ...", "created_at" : { "$date" : "2003-09-09T00:07:19.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:54.996+0000" }, "creator_id" : { "$oid" : "5b7d379ee9214a0d1608d784" }, "reporter_id" : { "$oid" : "5b7d379ee9214a0d1608d784" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e2c5f627d84c8d6c24f" }, "external_id" : "VELOCITY-185", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] ant test-encoding fails on Windows", "desc" : "Ant test fails on Windows (specifically ant test-encoding) due to a problem \nmatching newlines between the result of parsing \"encodingtest2.vm\" and the \nexpected result \"encodingtest2.cmp\".\n\nApparently, WinCVS translates Unix newline (LF) to the Windows newline (CR LF) \nwhen checking out the files.  But the file \"encodingtest2.cmp\" already has \nnewlines in the windows format CR LF.  When it's checked out to a Win machine, \nthis turns into CR CR LF.  The result file (generated by the Velocity test), \ngenerates CR LF for newline.\n\nAccording to the Java Spec, the unusual case of CR CR LF should be treated as \na single newline [1], along with CR LF and LF.    The Velocity test is smart \nenough to normalize newlines (to make CR LF the same as LF).  But does not \ntreat CR CR LF as a newline.  Thus the compare file doesn't match the result \nfile and the test fails.\n\nGot all that?\n\nOne solution would be to use CygWin CVS, which preserves the Unix newline \n(LF), or check the box in WinCVS \"Checkout files with the Unix LF\".\n\nA better solution is to change the routine in Velocity test \n(normalizeNewlines) that normalizes the newlines, to treat the following as \nequivalent newlines LF (unix), CR LF (win), and CR CR LF (win mistranslated).  \nThe one-line patch is attached,\n\nWILL\n\n[1] \nhttp://java.sun.com/docs/books/jls/second_edition/html/lexical.doc.html#231571", "created_at" : { "$date" : "2003-06-22T12:29:09.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:54.389+0000" }, "creator_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "reporter_id" : { "$oid" : "5b7d353de9214a0d1608d66e" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e2d5f627d84c8d6c259" }, "external_id" : "VELOCITY-125", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Jakarta Site HOWTO documentation references a non-extant velocity.properties file", "desc" : "I got jakarta-site2 and it appears that the documentation as per the above URL\nis out of date: The file you mention no longer exists?", "created_at" : { "$date" : "2003-01-10T17:43:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:54.565+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e2e5f627d84c8d6c262" }, "external_id" : "VELOCITY-335", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error passing double into method", "desc" : "A reference that passes a double value into a Java method errors.\n\nThe VTL source for this is:\n----------------------\n#set ($x = 0.19)\n$auditCalculator.weightedScores($audit, 1, $x)\n\nNow, the #set is line 24 (for stack trace that follows). This is a testing case, as the 0.19 value was coded \ndirectly in the method call as a constant. $auditCalculator is a custom-written tool object with a \nmethod signature:\n    public double weightedScores(Audit audit, int section, double weight)\n\n\nRelevant stack trace:\n------------------\nCaused by: org.apache.velocity.exception.ParseErrorException: Lexical error: \norg.apache.velocity.runtime.parser.TokenMgrError: Lexical error at line 24, column 14.  Encountered: \n\"1\" (49), after : \".\"\n\tat org.apache.velocity.Template.process(Template.java:141)\n\tat \norg.apache.velocity.runtime.resource.ResourceManagerImpl.loadResource(ResourceManagerImpl.java:\n423)\n\tat \norg.apache.velocity.runtime.resource.ResourceManagerImpl.getResource(ResourceManagerImpl.java:\n341)\n\tat org.apache.velocity.runtime.RuntimeInstance.getTemplate(RuntimeInstance.java:831)\n\tat org.apache.velocity.runtime.RuntimeSingleton.getTemplate(RuntimeSingleton.java:303)", "created_at" : { "$date" : "2005-01-15T02:35:39.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:55.169+0000" }, "creator_id" : { "$oid" : "5b7d37a3e9214a0d1608d785" }, "reporter_id" : { "$oid" : "5b7d37a3e9214a0d1608d785" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Mac OS X 10.3\nPlatform: Macintosh" },
{ "_id" : { "$oid" : "5b904e2e5f627d84c8d6c26b" }, "external_id" : "VELOCITY-239", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#foreach (${item} in ${list}) behavior inconsistent with #foreach ($item in $list)", "desc" : "1) #foreach (${item} in ${list})\n\n2) #foreach ($item in $list)\n\nIs there a practical reason why the first notation fails to populate $item?\n\nI'm guessing it's purely a technical reason (doesn't get parsed properly, \nmaybe creates a variable named \"{item}\" instead).", "created_at" : { "$date" : "2003-12-20T06:25:17.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:55.998+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e2f5f627d84c8d6c274" }, "external_id" : "VELOCITY-201", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Japanese translations site moved", "desc" : "Japanese translations site for Velocity had been moved as follows:\n\nold: http://www.ingrid.org/jajakarta/velocity/velocity-1.2-rc2/docs-\nja/index.html\nnew: http://www.jajakarta.org/velocity/\n\nPlease change the hyperlink in the Velocity site.", "created_at" : { "$date" : "2003-08-28T11:23:59.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:55.443+0000" }, "creator_id" : { "$oid" : "5b7d3771e9214a0d1608d76e" }, "reporter_id" : { "$oid" : "5b7d3771e9214a0d1608d76e" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e2f5f627d84c8d6c27c" }, "external_id" : "VELOCITY-283", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "MethodInvocationException is handled inconsistently", "desc" : "It appears that the exception handling is different depending on whether the\nmethod is invoked as a passed parameter to a velocimacro or just in a template.\n\nEx.\n\n#doTextLink( ${myObj.exception})\n\n${myObj.exception}\n\nThe first #doTextLink macro will throw an exception, but it will be logged and\nignored. However, the second invocation will throw the exception properly.\n\nI have a patch that should fix this behavior. The exception just needs to be\nrethrown up the call stack. A small signature change to a couple of methods.\n\nThanks,\n\nMike Rettig", "created_at" : { "$date" : "2004-07-21T02:37:48.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:56.775+0000" }, "creator_id" : { "$oid" : "5b7d3564e9214a0d1608d69e" }, "reporter_id" : { "$oid" : "5b7d3564e9214a0d1608d69e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e305f627d84c8d6c285" }, "external_id" : "VELOCITY-192", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#if directory and long values", "desc" : "When using ($if x == 1), and x is of type long, then Velocity tries to compare x\nas type Long and 1 as type Integer, resulting in the following message in the\nerrorlog:\n\nError in evaluation of == expression. Both arguments must be of the same Class.\nCurrently left = class java.lang.Long, right = class java.lang.Integer.", "created_at" : { "$date" : "2003-07-17T22:51:13.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:56.421+0000" }, "creator_id" : { "$oid" : "5b7d37a8e9214a0d1608d786" }, "reporter_id" : { "$oid" : "5b7d37a8e9214a0d1608d786" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "1.5" ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e315f627d84c8d6c28f" }, "external_id" : "VELOCITY-41", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "parsing VTL directives", "desc" : "If the template contains the javadoc tag \"@see package.class#member\", and the\nmember begins with a VTL directive name (SessionBean#setSessionContext, for\nexample) the parser produces the following exception.\n\norg.apache.velocity.runtime.parser.ParseException: Encountered \"SessionContext\"\nat line 31, column 34.\nWas expecting one of:\n    \"(\" ...\n    <WHITESPACE> ...\n    \n\tat org.apache.velocity.runtime.parser.Parser.generateParseException(Parser.java:3409)\n\tat org.apache.velocity.runtime.parser.Parser.jj_consume_token(Parser.java:3293)\n\tat org.apache.velocity.runtime.parser.Parser.SetDirective(Parser.java:1511)\n\tat org.apache.velocity.runtime.parser.Parser.Statement(Parser.java:300)\n\tat org.apache.velocity.runtime.parser.Parser.process(Parser.java:248)\n\tat org.apache.velocity.runtime.parser.Parser.parse(Parser.java:103)\n\tat org.apache.velocity.runtime.RuntimeInstance.parse(RuntimeInstance.java:669)", "created_at" : { "$date" : "2002-03-07T19:55:57.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:56.593+0000" }, "creator_id" : { "$oid" : "5b7d37a9e9214a0d1608d787" }, "reporter_id" : { "$oid" : "5b7d37a9e9214a0d1608d787" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e315f627d84c8d6c297" }, "external_id" : "VELOCITY-143", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "VelocityLayoutServlet assumes that $layout will be a String", "desc" : "This means that if the designer puts a non-string into the context under the\nname \"layout\" then the servlet will throw a ClassCastException (which hides the\nreal error - an incorrect object in the context)\n\nMy preference would be to use a toString on the object (if it exists).\n\nIf there is an accidental object in the context named \"layout\", the servlet will\nprint a moderately useful message ('Can't load template\n\"layout/java.util.AbstractList$Itr@11121f6\"'), and fall back to the standard layout\n\n(You could instead check the type of the context object, but that would require\nthat $layout had to be a String, and it's probably more useful to just require\nthat toString() returns something useful.)", "created_at" : { "$date" : "2003-02-18T12:14:04.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:56.179+0000" }, "creator_id" : { "$oid" : "5b7d37aae9214a0d1608d788" }, "reporter_id" : { "$oid" : "5b7d37aae9214a0d1608d788" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e325f627d84c8d6c2a0" }, "external_id" : "VELOCITY-351", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Compilation error with jdk1.5.0_01", "desc" : "when i am building the file in velocity using ant then it give error by \ncompiling classes that enum is keyword not identifier. i am using jdk1.5.0_01", "created_at" : { "$date" : "2005-02-02T17:10:12.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:58.907+0000" }, "creator_id" : { "$oid" : "5b7d37aae9214a0d1608d789" }, "reporter_id" : { "$oid" : "5b7d37aae9214a0d1608d789" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.4" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e335f627d84c8d6c2a8" }, "external_id" : "VELOCITY-40", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Escaping examples wrong", "desc" : "On page:\nhttp://jakarta.apache.org/velocity/user-guide.html\n\n## The following line defines $email in this template:\n#set( $email = \"foo\" )\n$email\n\\$email\n\\\\$email\n\\\\\\$email\n\ndoes not render as the documentation states\n\nfoo\n$email\n\\$email\n\\\\$email\n\nbut rather\n\nfoo\n$email\n\\foo\n\\$email\n\nThe same error is also faithfully reproduced in the Finnish User Manual\nhttp://jakarta.apache.org/velocity/user-guide_fi.html", "created_at" : { "$date" : "2002-03-06T16:02:51.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:58.723+0000" }, "creator_id" : { "$oid" : "5b7d37abe9214a0d1608d78a" }, "reporter_id" : { "$oid" : "5b7d37abe9214a0d1608d78a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e335f627d84c8d6c2b2" }, "external_id" : "VELOCITY-148", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "allow for multi-line string literals / macro parameters arguments similar to m4", "desc" : "From: Ralf Hauser [ralfhauser@gmx.ch]\nTo: Geir Magnusson Jr.\nCc: velocity-user@jakarta.apache.org; billb@progress.com;\ndidge@foundrylogic.com\nSubject: RE: Allowing NEWLINE in #set for readability\n\nGeir, \n\nThanks for the quick answer. The below with the \"+\"es looks doable. I am about\nto convert to velocity/vpp coming from m4\n(http://www.gnu.org/manual/m4-1.4/m4.html).\nm4's commenting structure with a different begin ` and end ' syntax is very\nconvenient for nesting and handles newlines very conveniently. Conversely to\nBill's quoting proposal with single quotes etc., (see also\nhttp://jakarta.apache.org/velocity/user-guide.html#Velocimacro%20Miscellany), I\nsuggest that text inside such quotes still gets rendered.\n\nBill had further ideas (e.g. a \"connect\" directive) on the vpp mailing list -->\nsee http://sourceforge.net/mailarchive/message.php?msg_id=4015929.\n\nThx r.\n> -----Original Message-----\n> From: Geir Magnusson Jr. [mailto:geirm@optonline.net]\n> Sent: Samstag, 1. Mrz 2003 00:24\n> To: hauser@acm.org\n> Subject: Re: Allowing NEWLINE in #set for readability\n> \n> > Geir,\n> >\n> > over a year ago\n> >\n(http://archives.apache.org/eyebrowse/ReadMsg?listName=velocity-user@jakarta.apache.org&msgNo=5879),\nyou hinted at this being potentially  \n> > possible; I am\n> > now using velocity-dep-1.3.1-rc2.jar and get the below. Does this mean\n> > velocity still doesn't support\n> > multi-line string literals?\n> \n> no, not yet.  We were trying to come to some conclusion for string cat,  \n> so you could do\n> \n> #set($foo = \"foo \" +\n>     \"bar\"\n>   + \"woogie\")\n> \n> which would make you happy?", "created_at" : { "$date" : "2003-03-08T13:49:43.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:58.496+0000" }, "creator_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "reporter_id" : { "$oid" : "5b7d35efe9214a0d1608d6ce" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e345f627d84c8d6c2b9" }, "external_id" : "VELOCITY-345", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Ant Task properties and Context Objects docs for Texen.", "desc" : "The Texen documentations should have some documentation of the Ant Task \nproperties and Context Objects.  (Like Anakia)", "created_at" : { "$date" : "2005-01-23T22:01:46.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:59.916+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Texen" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e345f627d84c8d6c2c2" }, "external_id" : "VELOCITY-211", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "counter. should be directive.foreach.counter. in vtl-reference-guide", "desc" : "FROM http://jakarta.apache.org/velocity/vtl-reference-guide.html:\n> counter.name = velocityCount\n> counter.initial.value = 0\n\nFROM http://jakarta.apache.org/velocity/user-guide.html#Loops:\n> directive.foreach.counter.name = velocityCount\n> directive.foreach.counter.initial.value = 1\n\nSearching the archives seems to show that the second form is the correct \nform, and that the vtl-reference-guide needs to be updated.\n\nhttp://www.mail-archive.com/velocity-user@jakarta.apache.org/msg06023.html", "created_at" : { "$date" : "2003-10-02T21:29:10.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:59.307+0000" }, "creator_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "reporter_id" : { "$oid" : "5b7d3545e9214a0d1608d67a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e355f627d84c8d6c2cb" }, "external_id" : "VELOCITY-29", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "There is a typo in source code of velocity", "desc" : "There is a typo \"WIDHT\" found in http source code of the servlet_example1 \nfile_example.vm in a Velocity.", "created_at" : { "$date" : "2001-11-19T23:45:59.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:59.493+0000" }, "creator_id" : { "$oid" : "5b7d37afe9214a0d1608d78b" }, "reporter_id" : { "$oid" : "5b7d37afe9214a0d1608d78b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e365f627d84c8d6c2d4" }, "external_id" : "VELOCITY-17", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "boolean error in org.apache.velocity.runtime.log.LogManager.createLogSystem()", "desc" : "error in org.apache.velocity.runtime.log.LogManager.createLogSystem:  in \nboolean expression for entry into \"if\" block:  if (claz != null || claz.length\n() > 0 ) -- this will obviously give a null pointer exception if (claz == null).", "created_at" : { "$date" : "2001-10-15T23:16:50.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:59.136+0000" }, "creator_id" : { "$oid" : "5b7d3547e9214a0d1608d67d" }, "reporter_id" : { "$oid" : "5b7d3547e9214a0d1608d67d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.1-rc2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e365f627d84c8d6c2e0" }, "external_id" : "VELOCITY-18", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Assigning null value to variable appears to be a no-op", "desc" : "I created an array with alternating null and non-null values:\n\n        context.put(\"test\", new String[] { null, \"a\", null, \"b\", null });\n\nIn the vm file, I have this code:\n\n    #foreach ($x in $test)\n    element: $x\n    #if ($x)conditional: $x\n    #end\n\nHere is the output:\n\n    element: $x\n    element: a\n    conditional: a\n    element: a\n    conditional: a\n    element: b\n    conditional: b\n    element: b\n    conditional: b\n\nI believe the correct output would be:\n\n    element: $x\n    element: a\n    conditional: a\n    element: $x\n    element: b\n    conditional: b\n    element: $x\n\nIn other words, once a variable has a non-null value, it looks as if\nthe assignment of a null value is handled incorrectly, leaving the\nvalue of the variable unchanged.\n\nJack Orenstein", "created_at" : { "$date" : "2001-10-16T20:06:01.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:22:59.743+0000" }, "creator_id" : { "$oid" : "5b7d37b2e9214a0d1608d78c" }, "reporter_id" : { "$oid" : "5b7d37b2e9214a0d1608d78c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e385f627d84c8d6c2e9" }, "external_id" : "VELOCITY-15", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity should use default encoding if not configured", "desc" : "Property 'input.encoding', 'output.encoding' are now both set to ISO-8859-1.  \nThis makes velocity use this encoding even on localized OSes (ie, Chinese \nversion of Windows, Unixes with LC_ALL or etc set to locales other than en).\nThis isn't the desired behavior.  Using system property \"file.encoding\" will do \nthe right thing.", "created_at" : { "$date" : "2001-08-30T07:42:41.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:01.940+0000" }, "creator_id" : { "$oid" : "5b7d37b3e9214a0d1608d78d" }, "reporter_id" : { "$oid" : "5b7d37b3e9214a0d1608d78d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e385f627d84c8d6c2f2" }, "external_id" : "VELOCITY-142", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Velocity is lacking in many points to be a powerful template engine.", "desc" : "I am currently attempting to use Velocity to generate various codes.  At first \nlook, Velocity looks like the ultimate template engine.  However, when you put \nVelocity to the test, you realize that there are key features missing.  I list \nsome of those features below.  The missing features are related to the Velocity \nlanguage.  The language is missing many features usually found in modern script \nlanguages like JScript, Perl, Python..etc. I would suggest to use a language \nlike Rhino (JScript engine written in Java) as a language engine for Velocity.  \nThis would overcome all the problems with the current version of Velocity.\n\nHere is a list of problems with Velocity language.\n1 - There is no variable scoping.  This is a problem because it prevents proper \nencapsulation.  One cannot write fully modular macros or functions.  Global \nvariables are overwriting each other.\n\n2 - Velocity does not support Object Orientation.  All modern scripting \nlanguages support OO.\n\nRegards,\nColbert Philippe", "created_at" : { "$date" : "2003-02-15T02:10:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:01.080+0000" }, "creator_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "reporter_id" : { "$oid" : "5b7d35b1e9214a0d1608d6bd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Testing" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e395f627d84c8d6c2fa" }, "external_id" : "VELOCITY-346", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "apache and jakarta site no longer uses Anakia", "desc" : "jakarta-site2 now uses XSLT instead of Anakia.  The Anakia documentation needs \nto be updated as such.\n\n## Actually, it is now in SVN as http://svn.apache.org/repos/asf/jakarta/site/", "created_at" : { "$date" : "2005-01-29T00:18:30.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:02.539+0000" }, "creator_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "reporter_id" : { "$oid" : "5b7d353ee9214a0d1608d672" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows 2000\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e395f627d84c8d6c303" }, "external_id" : "VELOCITY-332", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Typo in docs", "desc" : "Change $messages.exist to $messages.exist() in example for getAll()", "created_at" : { "$date" : "2005-01-05T03:32:37.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:02.294+0000" }, "creator_id" : { "$oid" : "5b7d37b8e9214a0d1608d78e" }, "reporter_id" : { "$oid" : "5b7d37b8e9214a0d1608d78e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Windows XP\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e3a5f627d84c8d6c30b" }, "external_id" : "VELOCITY-240", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#stop doesn't work in #if clause or velocimacro", "desc" : "<snip>\n#if ( true )\n    #stop\n#end \n</snip>\n\nWhen I used the script above, the following error occurs:\n\nEncountered \"\" at line 2, column 5. Was expecting one of: \"(\" ... ... ... ...\n\"\\\\\\\\\" ... \"\\\\\" ... ... ... \"*#\" ... \"*#\" ... ... ... \"if\" ... \"elseif\" ... ...\n\"stop\" ... ... ... ... ... \"{\" ... \"}\" ... \n\nThe following script yields the same problem:\n\n<snip>\n#macro( stopme )\n    #stop\n#end\n</snip>\n\nThe #stop functionality is great if say, a validation failed and we need to\nredirect, or #parse another page without parsing the rest of the current script,\nfor example:\n\n<snip>\n#if (!$request.parameter)\n    #parse ('Error.vm')\n    #stop\n#end\n\n#* Other code here *#\n</snip>\n\nElse, a complicated #else statement is required. This will be bad for many\nprecondition verifications", "created_at" : { "$date" : "2003-12-29T11:11:43.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:02.112+0000" }, "creator_id" : { "$oid" : "5b7d37b8e9214a0d1608d78f" }, "reporter_id" : { "$oid" : "5b7d37b8e9214a0d1608d78f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e3b5f627d84c8d6c312" }, "external_id" : "VELOCITY-46", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Line comment in the last line causes parse error", "desc" : "If the very last line of template contains line comment (foo ## bar<EOF>) the parser throws \nlexical error. Tried with 1.2 Stable and 1.3 Nightly 03/22.", "created_at" : { "$date" : "2002-03-23T17:08:17.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:02.694+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e3c5f627d84c8d6c327" }, "external_id" : "VELOCITY-397", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Use of variable 'enum' in Parser.java generates compile error", "desc" : "In org.apache.velocity.runtime.parser.Parser, method jj_add_error_token, the\nvariable name 'enum' is used. This gives compile problems in java 1.5, as in\nthis java version, enum is a keyword.", "created_at" : { "$date" : "2005-09-11T18:11:00.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:03.121+0000" }, "creator_id" : { "$oid" : "5b7d377de9214a0d1608d777" }, "reporter_id" : { "$oid" : "5b7d377de9214a0d1608d777" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e3d5f627d84c8d6c345" }, "external_id" : "VELOCITY-47", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Wrong parameter passing to macro will not result in parse error", "desc" : "Input:\n  #macro (foo $a)\n  [$a]\n  #end\n  #foo(red)\n\nOutput:\n  [$a]\n\nAFAIK #foo(red) \nmeans nothing (#foo('red') or #foo($red) does).", "created_at" : { "$date" : "2002-03-23T17:14:53.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:03.828+0000" }, "creator_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "reporter_id" : { "$oid" : "5b7d3638e9214a0d1608d6ef" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.2" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e3e5f627d84c8d6c34e" }, "external_id" : "VELOCITY-87", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Incorrect Rendering (String with spaces not shown completely )", "desc" : "In the velocity template, I am using $userBean.fullName and it is only\ndisplaying the first name after rendering.  The data is set properly\nin the bean as a String with firstname and lastname.\n\nI am using Struts with Velocity and I downloaded the velstruts.zip from \nthe site http://jakarta.apache.org/struts/resources.html.  \n\nI can't proceed without a fix for this.", "created_at" : { "$date" : "2002-06-20T00:40:59.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:03.287+0000" }, "creator_id" : { "$oid" : "5b7d37bee9214a0d1608d791" }, "reporter_id" : { "$oid" : "5b7d37bee9214a0d1608d791" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0-Release" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e3f5f627d84c8d6c360" }, "external_id" : "VELOCITY-177", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "TOOLS - xdoc link updates", "desc" : "Broken internal links (based on old multiple-tree directory structure).\n\nFixed with two patches:\n\nIndex: index.xml\n===================================================================\nRCS file: /home/cvspublic/jakarta-velocity-tools/xdocs/view/index.xml,v\nretrieving revision 1.1\ndiff -u -r1.1 index.xml\n--- index.xml   26 Apr 2003 01:21:49 -0000      1.1\n+++ index.xml   2 May 2003 20:54:26 -0000\n@@ -39,7 +39,7 @@\n\n     <p>A typical application use-case is to provide the view rendering layer \nfor\n     a Servlet-based web application framework. The\n-    <a href=\"../../struts/docs/index.html\">VelocityStruts</a> subproject\n+    <a href=\"../struts/\">VelocityStruts</a> subproject\n     uses the approach to bring Velocity templates to the Struts application \nframework.</p>\n   </section>\n\n\n------------------\nIndex: userguide.xml\n===================================================================\nRCS file: /home/cvspublic/jakarta-velocity-tools/xdocs/struts/userguide.xml,v\nretrieving revision 1.1\ndiff -u -r1.1 userguide.xml\n--- userguide.xml       26 Apr 2003 01:22:02 -0000      1.1\n+++ userguide.xml       2 May 2003 20:56:08 -0000\n@@ -123,7 +123,7 @@\n         to render the web application views in Struts applications.</p>\n\n         <p>Setup is almost identical to the standard\n-        <a href=\"../../view/docs/index.html#Installation\">VelocityViewServlet \ninstallation</a>,\n+        <a href=\"../view/index.html#Installation\">VelocityViewServlet \ninstallation</a>,\n         please review that for more details. The extended \nVelocityLayoutServlet, or any\n         custom extension, can also be used with Struts. (That particular \nservlet adds\n         the ability to reuse shared html layout across multiple pages.)</p>", "created_at" : { "$date" : "2003-05-03T03:58:47.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:04.792+0000" }, "creator_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "reporter_id" : { "$oid" : "5b7d356ce9214a0d1608d6a6" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3.1" ], "components" : [ "Documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e405f627d84c8d6c369" }, "external_id" : "VELOCITY-6", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "#if in #foreach seems to be caching results in Velocity 1.1 rc1", "desc" : "Using this code:\n\n---8<---\n\nimport java.io.*;\nimport java.util.*;\n\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.Template;\nimport org.apache.velocity.exception.*;\nimport org.apache.velocity.app.Velocity;\n\npublic class VelTest {\n\n  public static void main(String[] args) {\n\n    Template template = null;\n\n    try {\n      Properties props = new Properties();\n      props.setProperty(\"file.resource.loader.path\", args[0]);\n      Velocity.init(props);\n      VelocityContext context = new VelocityContext();\n      HashMap map = new HashMap();\n      map.put(\"wonka\", \"werfl\");\n      map.put(\"wertheimer\", \"wiffen\");\n      map.put(\"wicken\", \"witch\");\n      map.put(\"wooble\", new Integer(3767));\n      map.put(\"wablle\", new Long(System.currentTimeMillis()));\n      context.put(\"name\", map);\n      context.put(\"nameKeys\", map.keySet());\n      template = Velocity.getTemplate(args[1]);\n      StringWriter sw = new StringWriter();\n      template.merge(context, sw);\n      System.out.println(\"template output: \"+sw);\n    } catch(ResourceNotFoundException rnfe) {\n      System.out.println(\"Can't find your template!\");\n    } catch(ParseErrorException pee) {\n      System.out.println(\"Your template has a syntax error: \"+pee);\n    } catch(Exception e) {\n      System.out.println(\"Something bad happened: \"+e);\n    }\n  }\n}\n\n---8<---\n\nAnd using this template:\n\n---8<---\n\n<HTML>\n<BODY>\nHello. This is about the object \\$name whose value is $name\n\\$name is actually a $name.getClass().getName()\nName is $name.size() in size\n\n<ul>\n#foreach ($element in $nameKeys)\n  <li>key=$element value=$name.get($element)</li>\n#if ($name.get($element).getClass().getName().equals(\"java.lang.String\"))\n    The value is a String type\n  #else if\n($name.get($element).getClass().getName().equals(\"java.lang.Integer\"))\n    The value is an Integer type\n  #end\n#end\n</ul>\n</BODY>\n</HTML>\n\n---8<---\n\nI get this output:\n\n---8<---\n\n<HTML>\n<BODY>\nHello. This is about the object $name whose value is {wicken=witch,\nwonka=werfl, wooble=3767, wablle=990844112188, wertheimer=wiffen}\n$name is actually a java.util.HashMap \nName is 5 in size\n\n<ul>\n<li>key=wicken value=witch</li>\nThe value is a String type\n    <li>key=wonka value=werfl</li>\nThe value is a String type\n    <li>key=wooble value=3767</li>\nif (true)\n    The value is an Integer type\n    <li>key=wablle value=990844112188</li>\nif (false)\n    The value is an Integer type\n    <li>key=wertheimer value=wiffen</li>\nThe value is a String type\n  </ul>\n</BODY>\n</HTML>\n\n---8<---\n\nNotice the weird \"if(false)\" diddly-doos in there.", "created_at" : { "$date" : "2001-05-26T02:35:08.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:04.429+0000" }, "creator_id" : { "$oid" : "5b7d37c0e9214a0d1608d793" }, "reporter_id" : { "$oid" : "5b7d37c0e9214a0d1608d793" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.0b3" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e415f627d84c8d6c372" }, "external_id" : "VELOCITY-131", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "calling Velocity.setProperty() is not immutable", "desc" : "Calling Velocity.setProperty() does not appear to work after the call to \nVelocity.init(), but it does work before.  Example:\n\n   public void ejbCreate() {\n      mLogger.info(\"Creating Velocity Template Engine\");\n\n      // initialize velocity template engine (currently using singleton model)\n      try {\n         Properties p = new Properties();\n         p.setProperty(\"file.resource.loader.cache\", \"true\");\t\t\t\n\t\t\t\t// cache resources\n         p.setProperty(\"file.resource.loader.modificationCheckInterval\",\"0\");\t\n\t// don't poll for changes\n         p.setProperty(\"file.resource.loader.path\",\n         LCFConfig.getApplicationContext().getRealPath(\"/\") + \"templates/\");\n\t// load files from templates folder\n\n         // hook Velocity into custom log4j wrapper to reduce spamming the logs \nat the INFO level\n         // (wrapper demotes log INFO messages to DEBUG)\n         p.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM_CLASS, \nVelocityLogger.class.getName());\n         p.setProperty(\"runtime.log.logsystem.log4j.category\", \nContentGeneratorBean.class.toString());\n\n         // configure and initialize velocity\n         Velocity.init(p);\n\n         // reset velocity logger to it's log4j default to allow post init \nmessages (parse errors, etc through)\n         // NOTE:  THIS DOES NOT APPEAR TO HAVE ANY EFFECT.\n         Velocity.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM_CLASS,\n            \"org.apache.velocity.runtime.log.SimpleLog4JLogSystem\");\n      }\n      catch (Exception e) {\n         mLogger.error(\"Velocity initialization: general exception: \" + e);\n         return;\n      }\n   }", "created_at" : { "$date" : "2003-01-25T05:35:44.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:04.175+0000" }, "creator_id" : { "$oid" : "5b7d37c1e9214a0d1608d794" }, "reporter_id" : { "$oid" : "5b7d37c1e9214a0d1608d794" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e415f627d84c8d6c37b" }, "external_id" : "VELOCITY-107", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Method call fails", "desc" : "We are using Velocity as a part of TDK 2.1.  The sample vm file below works \nfine with the bundled velocity library velocity-1.2-dev.jar but breaks when we \nupgrade to velocity-1.2, velocity-1.3, velocity-1.3.1-rc1, or velocity-1.3.1-\nrc2.  The upgrade is necessary because we are passing objects of anonymous \nclasses into the context, which 1.2-dev does not handle well and velocity-1.2 \nupwards handles correctly.\n\nBelow is a sample vm file that demonstrates this strange behavior.  We are \nusing menubar as tool to pull role-specific menubars, which is a miniversion of \njava.awt.MenuBar, implementing just enough methods to iterate through the menu \nand menuitem objects.  It's import to use index to get the menu/menuitem within \nits container object because we are passing the menubar object to a macro which \ngenerates javascript-driven pull-down menus.  The call $menu.getItem(j) throws \na ReferenceException.\n\n###########################################################\n\n#set ($bar = $menubar.getMenuBar(\"author\"))\nmenu bar name is $bar.Name<br/>\nmenus are\n<ol>\n#set ($last = $bar.MenuCount - 1)\n#foreach ($i in [0..$last])\n  #set ($menu = $bar.getMenu($i))\n  <li>$menu.Label with items\n  <ol>\n  #set ($itemlast = $menu.ItemCount - 1)\n  #foreach ($j in [0..$itemlast])\n    #set ($item = $menu.getItem(j))\n    <li>$item.Label has path $item.ActionCommand\n  #end\n  </ol>\n#end\n</ol>\n\n<hr/>\n\n<ol>\n#foreach ($menu in $bar.Menus)\n  <li>$menu.Label with items\n  <ol>\n  #foreach ($item in $menu.Items)\n    <li>$item.Label has path $item.ActionCommand\n  #end\n  </ol>\n#end\n</ol>\n\n###########################################################\n\nThis vm file is rendered into something like this:\n\nmenu bar name is author\nmenus are \n1. Test with items \n    1. $item.Label has path $item.ActionCommand \n    2. $item.Label has path $item.ActionCommand \n2. Classroom with items \n    1. $item.Label has path $item.ActionCommand \n    2. $item.Label has path $item.ActionCommand \n\n--------------------------------------------------------------------------------\n\n1. Test with items \n    1. Create has path /author/test/create \n    2. View has path /author/test/view \n2. Classroom with items \n    1. Create has path /author/classroom/create \n    2. View has path /author/classroom/view", "created_at" : { "$date" : "2002-10-09T13:48:06.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:04.003+0000" }, "creator_id" : { "$oid" : "5b7d37c2e9214a0d1608d795" }, "reporter_id" : { "$oid" : "5b7d37c2e9214a0d1608d795" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Linux\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e545f627d84c8d6c4ae" }, "external_id" : "VELOCITY-115", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Methods cannot be invoked from vm", "desc" : "Method findMethod(String name, Object[] params) of \norg.apache.velocity.util.introspection.ClassMap\nfails under some circumstances.\n\n-->\n\nTwonk twonk = calcDistance( params, parameterTypes ) is null \n\n-->\n\nprivate Twonk MethodMap.calcDistance( Object[] set, Class[] base )\n{\n\t//...\n    if ( !base[i].isAssignableFrom( set[i].getClass() ))\n        return null;\t// place breakpoint here\n\t//...\n}\n\n\n--- IOrder.java ---\npackage velocitybug;\n\npublic interface IOrder\n{\n\tpublic void say();\n}\n-------------------\n\n\n--- TheOrder.java ---\npackage velocitybug;\n\npublic class TheOrder implements IOrder\n{\n\tpublic TheOrder()\n\t{\n\t}\n\n\tpublic void say()\n\t{\n\t\tSystem.out.println(\"Hello\");\n\t}\n}\n---------------------\n\n\n--- TheCollection.java ---\npackage velocitybug;\n\npublic class TheCollection\n{\n\tpublic TheCollection()\n\t{\n\t}\n\t\n\tpublic void aWorks(String s, int i)\n\t{\n\t\tSystem.out.println(\"a works\");\n\t}\n\t\n\tpublic void bWorks(IOrder o, String s)\n\t{\n\t\tSystem.out.println(\"b works\");\n\t}\n\t\n\tpublic void doesNotWork(IOrder o, int i)\n\t{\n\t\tSystem.out.println(\"does not work\");\n\t}\n}\n---------------------------\n\n\n--- invokeBug ---\n\tpublic void invokeBug()\n\t{\n\t\tVelocityContext l_context;\n\t\tTemplate        l_template;\n\t\tPrintWriter     l_writer;\n\n\n\t\ttry\n\t\t{\n\t\t\tVelocity.init(\"velocity.properties\");\n\n\t\t\tl_context = new VelocityContext();\n\n\t\t\tl_context.internalPut(\"TheOrder\", new TheOrder());\n\t\t\tl_context.internalPut(\"TheCollection\", new TheCollection\n());\n\n\n\t\t\tl_template = Velocity.getTemplate(\"VelocityBug.vm\");\n\t\t\tl_writer   = new PrintWriter(System.out);\n\n\t\t\tl_template.merge(l_context, l_writer);\n\n\t\t\tl_writer.flush();\n\t\t\tl_writer.close();\n\t\t}\n\t\tcatch (Exception l_e)\n\t\t{\n\t\t\tl_e.printStackTrace();\n\t\t}\n\t}\n-------------------\n\n\n--- VelocityBug.vm ---\n$TheCollection.aWorks(\"Hello\", 4711)\n$TheCollection.bWorks($TheOrder, \"World\")\n$TheCollection.doesNotWork($TheOrder, 4712)\n----------------------", "created_at" : { "$date" : "2002-11-21T00:32:27.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:11.758+0000" }, "creator_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "reporter_id" : { "$oid" : "5b7d37e6e9214a0d1608d7a9" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "1.4" ], "issue_links" : [  ], "environment" : "Operating System: All\nPlatform: PC" },
{ "_id" : { "$oid" : "5b904e585f627d84c8d6c4da" }, "external_id" : "VELOCITY-242", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "[PATCH] Decimals in velocity", "desc" : "Hi,\n\nfinally we got it together - the infamous \"decimal number patch\" evolved \nand here is the (hopefully) final patch to enable decimal numbers (and \nbyte, short, long and BigInteger btw.) in velocity. This patch contains:\n\n- Decimal literals (by Will Glass-Husain)\n   Now you can type things like #set ($foo = 3.14)\n- All arithmetic operations (+ - / *) now work with all Number-types\n   available. Modulo (%) works with all except BigDecimal (there is no\n   such method :)\n- All comparators (< > == != <= >=) work with all Number-types\n- A new type called TemplateNumber (o.a.v.util.TemplateNumber) is\n   available which is treated as a Number in arithmetic operations and\n   comparisons. (by Will Glass-Husain)\n   I am not sure about this one though. But Will had good reasons to\n   implement it - I think I just need some kind of \"refreshing\" on that\n   ;)\n\nThe patch is against the current head (Geir, you gave me a hard time \nduring the last days, since you changed the Parser.jjt quite often, so \nthat I had to incorporate the changes quite some times ;)\n\nAdditionally some implementation details:\n-----------------------------------------\n\nAll aritmetic operations and comparisons are delegated to a new class \n(o.a.v.runtime.parser.MathUtils). All operations are done using \nprimitives (as far as possible) and NOT BigInteger / BigDecimal like the \nfirst proposal did. I added overflow checking all along the way (where \npossible). In addition to that I removed the \"paradigm of the smallest \ntype\" where add (new Integer(1), new Integer(2)) would result in a \nByte(3). Now types are preserved as far as possible (overflow, mixing of \ntypes). You find a lot of documentation about that in the javadoc \n(MathUtils.java). Finally, overall, there should be no performance drawback.\nThere are also some new testcases and existing ones are updated (mostly \ntemplate based like math.vm).\n\nSo we (I hope Will doesn't mind me talking in his name) think this patch \nwill increase the usability of velocity a lot and hope that the others \nlike it too.\n\nOpen for discussion...\n\nRegards\nPeter", "created_at" : { "$date" : "2004-01-03T12:44:41.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:12.178+0000" }, "creator_id" : { "$oid" : "5b7d356be9214a0d1608d6a5" }, "reporter_id" : { "$oid" : "5b7d356be9214a0d1608d6a5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.5" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: Other" },
{ "_id" : { "$oid" : "5b904e5a5f627d84c8d6c4fa" }, "external_id" : "VELOCITY-72", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "context utility method calls are not thread safe", "desc" : "I am running a system that produces dynamic HTML output for many concurrent\nusers.  I have set up a set of velocity templates to takes a data model that\nhas been computed for a user, and produces the HTML output.  I have one\nprocess that has initialized Velocity with parser.pool.size=20 and 20 threads\nthat concurrently execute the following:\n\n   Velocity.mergeTemplate(myfile.vtl, \"ISO8859-1\", context, writer)\n\nwhere context and writer are created anew for every execution of this line.\nI absolutely guarentee that the data placed in the context is completely\nseperate and different for each execution/thread.  Hence one thread accessing\ndata in the context cannot affect another thread accessing data in a different \ncontext.  Despite this, I am getting what appears to be random output.  When I\nexecute this system with only one thread, I always get the correct results.  \nWhen I run with multiple threads, I periodically get altered results.\n    I have reduced the templates down to one which seems to be the main culprit.\n\n#foreach ($key in $DO.history())\n  $key\n  $Parts.part1($key) $Parts.part2($key) $Parts.part3($key)\n#end\n\nIn this case, $DO.history returns a vector of strings.  $Parts is a utility\npackage in which part1, 2, and 3 return portions of the specified string.\nThey are static functions which simply use the indexOf and substring methods\non String.  They do not reference ANY global attributes.  In fact I placed \nSystem.out.println in the part methods and was able to show that the part\nmethod was indeed returning the correct part.  However the resulting Velocity\noutput seemed to be outputting the wrong data!  It appears to be confusing the\noutput of $Parts.partx from one thread for the output in another!  I attempted\nto look at the velocity code but was not able to quickly determine where I\nshould be looking.  Does anybody have a clue on this one?\n                             Regards,\n                                  Ivan Bella\n                                  (ivan.bella@capita.com)", "created_at" : { "$date" : "2002-05-07T03:03:10.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:12.787+0000" }, "creator_id" : { "$oid" : "5b7d37ede9214a0d1608d7ac" }, "reporter_id" : { "$oid" : "5b7d37ede9214a0d1608d7ac" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: Solaris\nPlatform: Sun" },
{ "_id" : { "$oid" : "5b904e6f5f627d84c8d6c64c" }, "external_id" : "VELOCITY-86", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "Error during startup: Can't find 'VM_global_library.vm'.", "desc" : "When Velocity starts, an error indicating VM_global_library.vm cannot be found \nis generated at \"error\" level. It does not seem to prevent proper behavior and \nI couldn't tell from querying BugZilla whether this problem has been addressed.\n\nAndy Riedel\nariedel@xadra.com\n\n2002-06-17 18:26:02,312 [main] INFO  VelocityEngine - \n**************************************************************\n2002-06-17 18:26:02,322 [main] INFO  VelocityEngine - Starting Jakarta Velocity \nv1.3-rc1\n2002-06-17 18:26:02,332 [main] INFO  VelocityEngine - RuntimeInstance \ninitializing.\n2002-06-17 18:26:02,342 [main] INFO  VelocityEngine - Default Properties File: \norg\\apache\\velocity\\runtime\\defaults\\velocity.properties\n2002-06-17 18:26:02,352 [main] INFO  VelocityEngine - Trying to use logger \nclass org.apache.velocity.runtime.log.SimpleLog4JLogSystem\n2002-06-17 18:26:02,362 [main] INFO  VelocityEngine - Using logger class \norg.apache.velocity.runtime.log.SimpleLog4JLogSystem\n2002-06-17 18:26:02,382 [main] INFO  VelocityEngine - Default ResourceManager \ninitializing. (class org.apache.velocity.runtime.resource.ResourceManagerImpl)\n2002-06-17 18:26:02,402 [main] INFO  VelocityEngine - Resource Loader \nInstantiated: org.apache.velocity.runtime.resource.loader.FileResourceLoader\n2002-06-17 18:26:02,412 [main] INFO  VelocityEngine - FileResourceLoader : \ninitialization starting.\n2002-06-17 18:26:02,422 [main] INFO  VelocityEngine - FileResourceLoader : \nadding path '../../skins/default'\n2002-06-17 18:26:02,432 [main] INFO  VelocityEngine - FileResourceLoader : \ninitialization complete.\n2002-06-17 18:26:02,452 [main] INFO  VelocityEngine - ResourceCache : \ninitialized. (class org.apache.velocity.runtime.resource.ResourceCacheImpl)\n2002-06-17 18:26:02,462 [main] INFO  VelocityEngine - Default ResourceManager \ninitialization complete.\n2002-06-17 18:26:02,472 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Literal\n2002-06-17 18:26:02,492 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Macro\n2002-06-17 18:26:02,502 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Parse\n2002-06-17 18:26:02,522 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Include\n2002-06-17 18:26:02,532 [main] INFO  VelocityEngine - Loaded System Directive: \norg.apache.velocity.runtime.directive.Foreach\n2002-06-17 18:26:02,712 [main] INFO  VelocityEngine - Created: 20 parsers.\n2002-06-17 18:26:02,722 [main] INFO  VelocityEngine - Velocimacro : \ninitialization starting.\n2002-06-17 18:26:02,732 [main] INFO  VelocityEngine - Velocimacro : adding VMs \nfrom VM library template : VM_global_library.vm\n2002-06-17 18:26:02,753 [main] ERROR VelocityEngine - ResourceManager : unable \nto find resource 'VM_global_library.vm' in any resource loader.\n2002-06-17 18:26:02,763 [main] INFO  VelocityEngine - Velocimacro : error \nusing  VM library template VM_global_library.vm : \norg.apache.velocity.exception.ResourceNotFou\nndException: Unable to find resource 'VM_global_library.vm'\n2002-06-17 18:26:02,783 [main] INFO  VelocityEngine - Velocimacro :  VM library \ntemplate macro registration complete.\n2002-06-17 18:26:02,793 [main] INFO  VelocityEngine - Velocimacro : allowInline \n= true : VMs can be defined inline in templates\n2002-06-17 18:26:02,823 [main] INFO  VelocityEngine - Velocimacro : \nallowInlineToOverride = false : VMs defined inline may NOT replace previous VM \ndefinitions\n2002-06-17 18:26:02,823 [main] INFO  VelocityEngine - Velocimacro : \nallowInlineLocal = false : VMs defined inline will be  global in scope if \nallowed.\n2002-06-17 18:26:02,833 [main] INFO  VelocityEngine - Velocimacro : messages \non  : VM system will output logging messages\n2002-06-17 18:26:02,853 [main] INFO  VelocityEngine - Velocimacro : autoload \noff  : VM system will not automatically reload global library macros\n2002-06-17 18:26:02,863 [main] INFO  VelocityEngine - Velocimacro : \ninitialization complete.\n2002-06-17 18:26:02,873 [main] INFO  VelocityEngine - Velocity successfully \nstarted.", "created_at" : { "$date" : "2002-06-18T08:51:59.000+0000" }, "updated_at" : { "$date" : "2011-02-11T11:23:29.660+0000" }, "creator_id" : { "$oid" : "5b7d360ae9214a0d1608d6d5" }, "reporter_id" : { "$oid" : "5b7d360ae9214a0d1608d6d5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.3-rc1" ], "components" : [ "Engine" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Operating System: other\nPlatform: All" },
{ "_id" : { "$oid" : "5b904e985f627d84c8d6c8d4" }, "external_id" : "VELOCITY-812", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b904ecc5f627d84c8d6cc42" }, "external_id" : "VELOCITY-718", "issue_system_id" : { "$oid" : "5b904cf35f627d84c8d6a9fb" }, "title" : "multi-thread merge causes 100% cpu", "desc" : "I cannot reproduce this at will, and have only seen it the once but if someone more familiar with the code than me could take a look that would be appreciated.  I have several threads calling Template.merge, and somehow here they got locked up somewhere and caused a 100% cpu loop hang between them.  Here's a thread dump after several hours of getting nowhere.\n\nFull thread dump Java HotSpot(TM) Server VM (1.5.0_08-b03 mixed mode):\n\n\"RMI ConnectionExpiration-[162.11.2.155:46163]\" daemon prio=10 tid=0x01a58838 nid=0x91 waiting on condition [0xaf701000..0xaf701888]\n\tat java.lang.Thread.sleep(Native Method)\n\tat sun.rmi.transport.tcp.TCPChannel$Reaper.run(TCPChannel.java:446)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"GC Daemon\" daemon prio=2 tid=0x018972f8 nid=0x33 in Object.wait() [0xaf801000..0xaf801988]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb92ae8b0> (a sun.misc.GC$LatencyLock)\n\tat sun.misc.GC$Daemon.run(GC.java:100)\n\t- locked <0xb92ae8b0> (a sun.misc.GC$LatencyLock)\n\n\"RMI RenewClean-[162.11.2.155:46163]\" daemon prio=10 tid=0x01d83578 nid=0x32 in Object.wait() [0xaf901000..0xaf901a08]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb92ae980> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:116)\n\t- locked <0xb92ae980> (a java.lang.ref.ReferenceQueue$Lock)\n\tat sun.rmi.transport.DGCClient$EndpointEntry$RenewCleanThread.run(DGCClient.java:501)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-1-thread-3\" prio=10 tid=0x01d64fa0 nid=0x31 waiting on condition [0xafa01000..0xafa01888]\n\tat sun.misc.Unsafe.park(Native Method)\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:118)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1767)\n\tat java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)\n\tat java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:470)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:674)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-1-thread-2\" prio=10 tid=0x00f7edb0 nid=0x30 waiting on condition [0xafb01000..0xafb01908]\n\tat sun.misc.Unsafe.park(Native Method)\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:118)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1767)\n\tat java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)\n\tat java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:470)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:674)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-1-thread-1\" prio=10 tid=0x020574a8 nid=0x2f waiting on condition [0xafc01000..0xafc01788]\n\tat sun.misc.Unsafe.park(Native Method)\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:118)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1767)\n\tat java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)\n\tat java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:470)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:674)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-10\" prio=10 tid=0x01da9d38 nid=0x2e runnable [0xafcff000..0xafd01808]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-9\" prio=10 tid=0x0064b100 nid=0x2d runnable [0xafdff000..0xafe01688]\n\tat java.util.HashMap.put(HashMap.java:420)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:271)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-8\" prio=10 tid=0x0064b7b0 nid=0x2c runnable [0xafeff000..0xaff01708]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-7\" prio=10 tid=0x01d2d1d8 nid=0x2b runnable [0xb0000000..0xb0001988]\n\tat java.util.HashMap.put(HashMap.java:420)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:271)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-6\" prio=10 tid=0x0153a960 nid=0x2a runnable [0xb0100000..0xb0101a08]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-5\" prio=10 tid=0x00d8d1d0 nid=0x29 runnable [0xb01ff000..0xb0201888]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-4\" prio=10 tid=0x00f30d30 nid=0x28 runnable [0xb0300000..0xb0301908]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-3\" prio=10 tid=0x00b35ed0 nid=0x27 runnable [0xb03ff000..0xb0401788]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-2\" prio=10 tid=0x006ca6d0 nid=0x26 runnable [0xb04ff000..0xb0501808]\n\tat java.util.HashMap.get(HashMap.java:346)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:248)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"pool-2-thread-1\" prio=10 tid=0x007b0d88 nid=0x25 runnable [0xb0bff000..0xb0c01688]\n\tat java.util.HashMap.put(HashMap.java:420)\n\tat org.apache.velocity.util.introspection.ClassMap$MethodCache.get(ClassMap.java:271)\n\tat org.apache.velocity.util.introspection.ClassMap.findMethod(ClassMap.java:102)\n\tat org.apache.velocity.util.introspection.IntrospectorBase.getMethod(IntrospectorBase.java:105)\n\tat org.apache.velocity.util.introspection.Introspector.getMethod(Introspector.java:94)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.discover(PropertyExecutor.java:118)\n\tat org.apache.velocity.runtime.parser.node.PropertyExecutor.<init>(PropertyExecutor.java:56)\n\tat org.apache.velocity.util.introspection.UberspectImpl.getPropertyGet(UberspectImpl.java:246)\n\tat org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:148)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:252)\n\tat org.apache.velocity.runtime.parser.node.ASTReference.render(ASTReference.java:332)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)\n\tat org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)\n\tat org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:364)\n\tat org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)\n\tat org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)\n\tat org.apache.velocity.Template.merge(Template.java:328)\n\tat org.apache.velocity.Template.merge(Template.java:235)\n\tat com.formicary.financial.model2murex.velocity.VelocityTradeWriter.generateMxml(VelocityTradeWriter.java:149)\n\tat com.formicary.financial.model2murex.MurexSink.writeTrades(MurexSink.java:63)\n\tat com.formicary.financial.model2murex.EnhancingMurexSink.writeTrades(EnhancingMurexSink.java:18)\n\tat com.formicary.financial.oldcode.murexsink.BothMurexSinks.writeTrades(BothMurexSinks.java:46)\n\tat com.formicary.financial.migration.Migration.migrate(Migration.java:111)\n\tat com.formicary.financial.migration.Migration.access$100(Migration.java:37)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:313)\n\tat com.formicary.financial.migration.Migration$MigrationTask.call(Migration.java:280)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:269)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:123)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00861128 nid=0x22 in Object.wait() [0xb0601000..0xb0601a08]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x0085b7d8 nid=0x21 in Object.wait() [0xb0701000..0xb0701888]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x0085b028 nid=0x20 in Object.wait() [0xb0801000..0xb0801908]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00861ea0 nid=0x1f in Object.wait() [0xb0901000..0xb0901788]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00648718 nid=0x1e in Object.wait() [0xb0a01000..0xb0a01808]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb81de0e0> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"Timer-1\" daemon prio=10 tid=0x009d6520 nid=0x1c in Object.wait() [0xb0b01000..0xb0b01708]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8258028> (a java.util.TaskQueue)\n\tat java.lang.Object.wait(Object.java:474)\n\tat java.util.TimerThread.mainLoop(Timer.java:483)\n\t- locked <0xb8258028> (a java.util.TaskQueue)\n\tat java.util.TimerThread.run(Timer.java:462)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00a618f0 nid=0x1a in Object.wait() [0xb0d01000..0xb0d01a08]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x0087eef0 nid=0x19 in Object.wait() [0xb0e01000..0xb0e01888]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00ecd1c8 nid=0x18 in Object.wait() [0xb0f01000..0xb0f01908]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00eccf60 nid=0x17 in Object.wait() [0xb1001000..0xb1001788]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"PoolExecutor\" daemon prio=10 tid=0x00c19ee0 nid=0x16 in Object.wait() [0xb1101000..0xb1101808]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat java.lang.Object.wait(Object.java:474)\n\tat com.swiftmq.client.thread.ThreadPoolImpl.getNextTask(Unknown Source)\n\t- locked <0xb8207070> (a com.swiftmq.client.thread.ThreadPoolImpl)\n\tat com.swiftmq.client.thread.PoolExecutor.run(Unknown Source)\n\n\"Timer-0\" daemon prio=10 tid=0x00d64c80 nid=0x15 in Object.wait() [0xb1201000..0xb1201688]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb80a9008> (a java.util.TaskQueue)\n\tat java.lang.Object.wait(Object.java:474)\n\tat java.util.TimerThread.mainLoop(Timer.java:483)\n\t- locked <0xb80a9008> (a java.util.TaskQueue)\n\tat java.util.TimerThread.run(Timer.java:462)\n\n\"Low Memory Detector\" daemon prio=10 tid=0x001803c0 nid=0x13 runnable [0x00000000..0x00000000]\n\n\"CompilerThread1\" daemon prio=10 tid=0x0017f308 nid=0x12 waiting on condition [0x00000000..0xb3980ac4]\n\n\"CompilerThread0\" daemon prio=10 tid=0x0017e498 nid=0x11 waiting on condition [0x00000000..0xb3a80894]\n\n\"AdapterThread\" daemon prio=10 tid=0x0017d608 nid=0x10 waiting on condition [0x00000000..0x00000000]\n\n\"Signal Dispatcher\" daemon prio=10 tid=0x0017c9a8 nid=0xf waiting on condition [0x00000000..0x00000000]\n\n\"Finalizer\" daemon prio=10 tid=0x00171b98 nid=0xe in Object.wait() [0xb3d81000..0xb3d81808]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb80114d0> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:116)\n\t- locked <0xb80114d0> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:132)\n\tat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)\n\n\"Reference Handler\" daemon prio=10 tid=0x00171628 nid=0xd in Object.wait() [0xb3e81000..0xb3e81688]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0xb800e6f0> (a java.lang.ref.Reference$Lock)\n\tat java.lang.Object.wait(Object.java:474)\n\tat java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)\n\t- locked <0xb800e6f0> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=10 tid=0x000385c8 nid=0x1 waiting on condition [0xffbee000..0xffbee8a0]\n\tat sun.misc.Unsafe.park(Native Method)\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:118)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1767)\n\tat java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)\n\tat java.util.concurrent.ExecutorCompletionService.take(ExecutorCompletionService.java:136)\n\tat com.formicary.financial.migration.Migration.main(Migration.java:201)\n\tat com.formicary.financial.migration.tools.exotics.KtpfMigrator.call(KtpfMigrator.java:44)\n\tat com.formicary.financial.migration.tools.exotics.KtpfMigrator.main(KtpfMigrator.java:26)\n\n\"VM Thread\" prio=10 tid=0x0016ef68 nid=0xc runnable \n\n\"GC task thread#0 (ParallelGC)\" prio=10 tid=0x000b9cf0 nid=0x4 runnable \n\n\"GC task thread#1 (ParallelGC)\" prio=10 tid=0x000ba730 nid=0x5 runnable \n\n\"GC task thread#2 (ParallelGC)\" prio=10 tid=0x000bb170 nid=0x6 runnable \n\n\"GC task thread#3 (ParallelGC)\" prio=10 tid=0x000bbbb0 nid=0x7 runnable \n\n\"GC task thread#4 (ParallelGC)\" prio=10 tid=0x000bc5f0 nid=0x8 runnable \n\n\"GC task thread#5 (ParallelGC)\" prio=10 tid=0x000bd030 nid=0x9 runnable \n\n\"GC task thread#6 (ParallelGC)\" prio=10 tid=0x000bda70 nid=0xa runnable \n\n\"GC task thread#7 (ParallelGC)\" prio=10 tid=0x000becb8 nid=0xb runnable \n\n\"VM Periodic Task Thread\" prio=10 tid=0x00182050 nid=0x14 waiting on condition \n", "created_at" : { "$date" : "2009-05-19T07:57:47.485+0000" }, "updated_at" : { "$date" : "2018-01-07T15:33:10.701+0000" }, "creator_id" : { "$oid" : "5b7d393ee9214a0d1608d817" }, "reporter_id" : { "$oid" : "5b7d393ee9214a0d1608d817" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "1.6.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "2.0", "1.7", "1.6.x" ], "issue_links" : [  ], "environment" : "Solaris 1.5.0_08-b03" },
{ "_id" : { "$oid" : "5b7d514c5f627d6b0586ad68" }, "external_id" : "ZOOKEEPER-917", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader election selected incorrect leader", "desc" : "We had three nodes running zookeeper:\n  * 192.168.130.10\n  * 192.168.130.11\n  * 192.168.130.14\n\n192.168.130.11 failed, and was replaced by a new node 192.168.130.13 (automated startup). The new node had not participated in any zookeeper quorum previously. The node 192.148.130.11 was permanently removed from service and could not contribute to the quorum any further (powered off).\n\nDNS entries were updated for the new node to allow all the zookeeper servers to find the new node.\n\nThe new node 192.168.130.13 was selected as the LEADER, despite the fact that it had not seen the latest zxid.\n\nThis particular problem has not been verified with later versions of zookeeper, and no attempt has been made to reproduce this problem as yet.", "created_at" : { "$date" : "2010-11-03T12:33:32.450+0000" }, "updated_at" : { "$date" : "2011-11-19T01:01:09.749+0000" }, "creator_id" : { "$oid" : "5b7d514ce9214a0d1608d901" }, "reporter_id" : { "$oid" : "5b7d514ce9214a0d1608d901" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.2.2" ], "components" : [ "leaderElection", "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Cloudera distribution of zookeeper (patched to never cache DNS entries)\nDebian lenny" },
{ "_id" : { "$oid" : "5b7d514d5f627d6b0586ad84" }, "external_id" : "ZOOKEEPER-777", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "setting acl on a non existant node should return no node error", "desc" : "currently it just returns successfully, but the acl can't be retrieved, and if any value is being stored, its overwritten when the node is created.", "created_at" : { "$date" : "2010-05-21T15:52:54.999+0000" }, "updated_at" : { "$date" : "2011-11-19T01:07:44.348+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.1", "3.3.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d514d5f627d6b0586ad94" }, "external_id" : "ZOOKEEPER-546", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add \"diskless\" ensemble support", "desc" : "In some cases there is no need to have the ZK data persisted to disk. For example if all you are doing is group membership and leadership\nelection the data is totally ephemeral, storing on disk is unnecessary. We've also seen cases where any non-ephemeral data can be\neasily recovered (say configuration data that's generated/read and loaded into zk) and there is less need to worry about recovery of the\ndata in the case of catastrophic failure (meaning _all_ replicas are lost, remember, recovery is automatic if 2n+1 servers and <= n servers\nfail, even if > n fail manual recovery is still possible as long as at least 1 replica, or replica backup can be recovered)\n\nIn these cases it makes sense to have a \"diskless\" zookeeper ensemble. The result should be improved write performance\nan less moving parts (no disk to fail!), simplifiying ops in cases where this can be applied.\n", "created_at" : { "$date" : "2009-10-08T16:40:26.685+0000" }, "updated_at" : { "$date" : "2011-11-19T01:18:09.346+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d514e5f627d6b0586ad9c" }, "external_id" : "ZOOKEEPER-1271", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "testEarlyLeaderAbandonment failing on solaris - clients not retrying connection", "desc" : "See:\nhttps://builds.apache.org/view/S-Z/view/ZooKeeper/job/ZooKeeper_branch34_solaris/1/testReport/junit/org.apache.zookeeper.server.quorum/QuorumPeerMainTest/testEarlyLeaderAbandonment/\n\nNotice that the clients attempt to connect before the servers have bound, then 30 seconds later, after seemingly no further client activity we see:\n\n2011-10-28 21:40:56,828 [myid:] - INFO  [main-SendThread(localhost:11227):ClientCnxn$SendThread@1057] - Client session timed out, have not heard from server in 30032ms for sessionid 0x0, closing socket connection and attempting reconnect\n\n\nI believe this is different from ZOOKEEPER-1270 because in the 1270 case it seems like the clients are attempting to connect but the servers are not accepting (notice the stat commands are being dropped due to no server running)", "created_at" : { "$date" : "2011-10-28T22:33:08.449+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:58.433+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d514e5f627d6b0586ad9b" }, "effect" : "is broken by", "type" : "Regression" } ] },
{ "_id" : { "$oid" : "5b7d514f5f627d6b0586adc6" }, "external_id" : "ZOOKEEPER-957", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCleanup.sh doesn't do anything", "desc" : "Somebody left some echo statements in the zkCleanup.sh which prevents the java commands from actually running.\n\nPatch coming forthwith.", "created_at" : { "$date" : "2010-12-13T17:09:05.998+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:58.141+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51505f627d6b0586add3" }, "external_id" : "ZOOKEEPER-900", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51505f627d6b0586add4" }, "external_id" : "ZOOKEEPER-902", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix findbug issue in trunk \"Malicious code vulnerability\"", "desc" : "https://hudson.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/970/artifact/trunk/findbugs/zookeeper-findbugs-report.html#Warnings_MALICIOUS_CODE\n\nMalicious code vulnerability Warnings\n\nCode\tWarning\nMS\torg.apache.zookeeper.server.quorum.LeaderElection.epochGen isn't final but should be", "created_at" : { "$date" : "2010-10-18T17:41:49.757+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:58.863+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51505f627d6b0586add3" }, "effect" : "is part of", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d51515f627d6b0586ae0a" }, "external_id" : "ZOOKEEPER-788", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add server id to message logs", "desc" : "As discussed on IRC. The log visualisation needs some way of determining which server made which log. If the log segment is taken for a time period where no elections take place, there is no way to determine the id of the server.", "created_at" : { "$date" : "2010-06-17T16:45:45.459+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:58.652+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51515f627d6b0586ae1e" }, "external_id" : "ZOOKEEPER-1051", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SIGPIPE in Zookeeper 0.3.* when send'ing after cluster disconnection", "desc" : "In libzookeeper_mt, if your process is going rather slowly (such as when running it in Valgrind's Memcheck) or you are using gdb with breakpoints, you can occasionally get SIGPIPE when trying to send a message to the cluster. For example:\n\n==12788==\n==12788== Process terminating with default action of signal 13 (SIGPIPE)\n==12788==    at 0x3F5180DE91: send (in /lib64/libpthread-2.5.so)\n==12788==    by 0x7F060AA: ??? (in /usr/lib64/libzookeeper_mt.so.2.0.0)\n==12788==    by 0x7F06E5B: zookeeper_process (in /usr/lib64/libzookeeper_mt.so.2.0.0)\n==12788==    by 0x7F0D38E: ??? (in /usr/lib64/libzookeeper_mt.so.2.0.0)\n==12788==    by 0x3F5180673C: start_thread (in /lib64/libpthread-2.5.so)\n==12788==    by 0x3F50CD3F6C: clone (in /lib64/libc-2.5.so)\n==12788==\n\nThis is probably not the behavior we would like, since we handle server disconnections after a failed call to send. To fix this, there are a few options we could use. For BSD environments, we can tell a socket to never send SIGPIPE with send using setsockopt:\n\nsetsockopt(sd, SOL_SOCKET, SO_NOSIGPIPE, (void *)&set, sizeof(int));\n\nFor Linux environments, we can add a MSG_NOSIGNAL flag to every send call that says to not send SIGPIPE on a bad file descriptor.\n\nFor more information, see: http://stackoverflow.com/questions/108183/how-to-prevent-sigpipes-or-handle-them-properly", "created_at" : { "$date" : "2011-04-21T13:56:15.309+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:59.156+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.3.2", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_links" : [  ], "original_time_estimate" : 7200 },
{ "_id" : { "$oid" : "5b7d51525f627d6b0586ae32" }, "external_id" : "ZOOKEEPER-937", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test -e not available on solaris /bin/sh", "desc" : "test -e FILENAME is not support on /bin/sh in solaris. This is used in bin/zkEnv.sh. We can substitute test -f FILENAME. Attaching a patch.", "created_at" : { "$date" : "2010-11-19T22:12:26.124+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:59.751+0000" }, "creator_id" : { "$oid" : "5b7d5152e9214a0d1608d903" }, "reporter_id" : { "$oid" : "5b7d5152e9214a0d1608d903" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1", "3.3.0", "3.3.2" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5152e9214a0d1608d903" }, "issue_links" : [  ], "environment" : "SunOS xxx 5.10 Generic_142901-13 i86pc i386 i86pc Solaris\n" },
{ "_id" : { "$oid" : "5b7d51535f627d6b0586ae45" }, "external_id" : "ZOOKEEPER-881", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeperServer.loadData loads database twice", "desc" : "zkDb.loadDataBase() is called twice at the beginning of loadData().  It shouldn't have any negative affects, but is unnecessary.   A patch should be trivial.", "created_at" : { "$date" : "2010-09-28T23:41:03.456+0000" }, "updated_at" : { "$date" : "2011-11-23T19:21:59.531+0000" }, "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51545f627d6b0586ae5a" }, "external_id" : "ZOOKEEPER-1165", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "better eclipse support in tests", "desc" : "The Eclipse test runner tries to run tests from all classes that inherit from TestCase. However, this class is inherited by at least one class (org.apache.zookeeper.test.system.BaseSysTest) that has no test cases as it is used as infrastructure for other real test cases. This patch annotates that class with @Ignore, which causes the class to be Ignored. Also, due to the way annotations are not inherited by default, this patch will not affect classes that inherit from this class.", "created_at" : { "$date" : "2011-08-29T22:08:07.120+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:00.944+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "Eclipse" },
{ "_id" : { "$oid" : "5b7d51545f627d6b0586ae6c" }, "external_id" : "ZOOKEEPER-981", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hang in zookeeper_close() in the multi-threaded C client", "desc" : "I saw a hang once when my C++ application called the zookeeper_close() method of the multi-threaded Zookeeper client library.  The stack trace of the hung thread was the following:\n\n{quote}\nThread 8 (Thread 5644):\n#0  0x00007f5d7bb5bbe4 in __lll_lock_wait () from /lib/libpthread.so.0\n#1  0x00007f5d7bb59ad0 in pthread_cond_broadcast@@GLIBC_2.3.2 () from /lib/libpthread.so.0\n#2  0x00007f5d793628f6 in unlock_completion_list (l=0x32b4d68) at .../zookeeper/src/c/src/mt_adaptor.c:66\n#3  0x00007f5d79354d4b in free_completions (zh=0x32b4c80, callCompletion=1, reason=-116) at .../zookeeper/src/c/src/zookeeper.c:1069\n#4  0x00007f5d79355008 in cleanup_bufs (zh=0x32b4c80, callCompletion=1, rc=-116) at .../thirdparty/zookeeper/src/c/src/zookeeper.c:1125\n#5  0x00007f5d79353200 in destroy (zh=0x32b4c80) at .../thirdparty/zookeeper/src/c/src/zookeeper.c:366\n#6  0x00007f5d79358e0e in zookeeper_close (zh=0x32b4c80) at .../zookeeper/src/c/src/zookeeper.c:2326\n#7  0x00007f5d79356d18 in api_epilog (zh=0x32b4c80, rc=0) at .../zookeeper/src/c/src/zookeeper.c:1661\n#8  0x00007f5d79362f2f in adaptor_finish (zh=0x32b4c80) at .../zookeeper/src/c/src/mt_adaptor.c:205\n#9  0x00007f5d79358c8c in zookeeper_close (zh=0x32b4c80) at .../zookeeper/src/c/src/zookeeper.c:2297 \n...\n{quote}\n\nThe omitted part of the stack trace is entirely within my application, and contains no other calls to/from the Zookeeper client.  In particular, I am not calling zookeeper_close() from within a completion handler or any of the library's threads.\n\nI haven't been able to reproduce this, and when I encountered this I wasn't capturing logging from the client library, so unfortunately I don't have any more information at this time.  But I will update this JIRA if I see it again.", "created_at" : { "$date" : "2011-02-01T20:23:01.578+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:00.382+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_links" : [  ], "environment" : "Debian Squeeze, Linux 2.6.32-5, x86_64" },
{ "_id" : { "$oid" : "5b7d51555f627d6b0586ae9e" }, "external_id" : "ZOOKEEPER-992", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "MT Native Version of Windows C Client ", "desc" : "This is an extention of the work in  https://issues.apache.org/jira/browse/ZOOKEEPER-859\n", "created_at" : { "$date" : "2011-02-17T16:29:24.571+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:00.589+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_links" : [  ], "environment" : "Windows 32" },
{ "_id" : { "$oid" : "5b7d51565f627d6b0586af00" }, "external_id" : "ZOOKEEPER-500", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Async methods shouldnt throw exceptions", "desc" : "Async methods like asyncLedgerCreate and Open shouldnt be throwing InterruptedException and BKExceptions. \n\nThe present method signatures lead to messy application code since one is forced to have error handling code in 2 places: inside the callback to handler a non-OK return code, and outside for handling the exceptions thrown by the call. \n\nThere should be only one way to indicate error conditions, and that should be through a non-ok return code to the callback.", "created_at" : { "$date" : "2009-08-05T23:01:48.651+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:00.127+0000" }, "creator_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "reporter_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51575f627d6b0586af0f" }, "external_id" : "ZOOKEEPER-1083", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Javadoc for WatchedEvent not being generated", "desc" : "See title.", "created_at" : { "$date" : "2011-05-31T16:23:44.759+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:01.482+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51585f627d6b0586af1c" }, "external_id" : "ZOOKEEPER-934", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d511a5f627d6b0586a9dc" }, "external_id" : "ZOOKEEPER-880", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511a5f627d6b0586a9dd" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51585f627d6b0586af1c" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51585f627d6b0586af1d" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "created_at" : { "$date" : "2010-09-27T23:40:46.374+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "updated_at" : { "$date" : "2011-11-23T19:22:01.703+0000" }, "title" : "QuorumCnxManager$SendWorker grows without bounds", "issue_type" : "Bug", "desc" : "We're seeing an issue where one server in the ensemble has a steady growing number of QuorumCnxManager$SendWorker threads up to a point where the OS runs out of native threads, and at the same time we see a lot of exceptions in the logs.  This is on 3.2.2 and our config looks like:\n\n{noformat}\ntickTime=3000\ndataDir=/somewhere_thats_not_tmp\nclientPort=2181\ninitLimit=10\nsyncLimit=5\nserver.0=sv4borg9:2888:3888\nserver.1=sv4borg10:2888:3888\nserver.2=sv4borg11:2888:3888\nserver.3=sv4borg12:2888:3888\nserver.4=sv4borg13:2888:3888\n{noformat}\n\nThe issue is on the first server. I'm going to attach threads dumps and logs in moment.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51595f627d6b0586af90" }, "external_id" : "ZOOKEEPER-867", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClientTest is failing on hudson - fd cleanup", "desc" : "client cleanup test is failing on hudson. fd count is off.", "created_at" : { "$date" : "2010-09-07T07:29:12.811+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:01.250+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d515a5f627d6b0586af9a" }, "external_id" : "ZOOKEEPER-1027", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d515a5f627d6b0586af9b" }, "external_id" : "ZOOKEEPER-1150", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix for this patch to compile on windows...", "desc" : "fix for this patch to compile on windows...", "created_at" : { "$date" : "2011-08-10T15:58:59.997+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:02.347+0000" }, "creator_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "reporter_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_type" : "Sub-task", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d515a5f627d6b0586af9a" } },
{ "_id" : { "$oid" : "5b7d515b5f627d6b0586afab" }, "external_id" : "ZOOKEEPER-1063", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Dubious synchronization in Zookeeper and ClientCnxnSocketNIO classes", "desc" : "Synchronization around dataWatches, existWatches and childWatches in Zookeeper is incorrect.\nSynchronization around outgoingQueue and pendingQueue in ClientCnxnSocketNIO is incorrect.\nSynchronization around selector and key sets in ClientCnxnSocketNIO seems odd.", "created_at" : { "$date" : "2011-05-17T21:34:09.995+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:02.689+0000" }, "creator_id" : { "$oid" : "5b7d515be9214a0d1608d909" }, "reporter_id" : { "$oid" : "5b7d515be9214a0d1608d909" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d515be9214a0d1608d909" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f35f627d6b0586a7b8" }, "external_id" : "ZOOKEEPER-961", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "fix_versions" : [ "3.3.4", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f35f627d6b0586a7b9" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d514ee9214a0d1608d902" }, "created_at" : { "$date" : "2010-12-21T16:07:16.368+0000" }, "priority" : "Critical", "desc" : "Let's say you're using connection string \"127.0.0.1:2182/foo\".\n1) put a childrenchanged watch on relative / (that is, on absolute path /foo)\n2) stop the zk server\n3) start the zk server\n4) at this point, the client recovers the connection, and should have put back a watch on relative path /, but instead the client puts a watch on the *absolute* path /\n- if some other client adds or removes a node under /foo, nothing will happen\n- if some other client adds or removes a node under /, then you will get an error from the zk client library (string operation error)", "reporter_id" : { "$oid" : "5b7d515be9214a0d1608d90a" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d515be9214a0d1608d90a" }, "updated_at" : { "$date" : "2011-11-23T19:22:02.120+0000" }, "title" : "Watch recovery after disconnection when connection string contains a prefix", "issue_type" : "Bug", "environment" : "Windows 32 bits", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d515c5f627d6b0586b00e" }, "external_id" : "ZOOKEEPER-884", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove LedgerSequence references from BookKeeper documentation and comments in tests ", "desc" : "We no longer use LedgerSequence, so we need to remove references in documentation and comments sprinkled throughout the code.", "created_at" : { "$date" : "2010-10-01T09:11:25.955+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:02.506+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d515d5f627d6b0586b01a" }, "external_id" : "ZOOKEEPER-1046", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Creating a new sequential node results in a ZNODEEXISTS error", "desc" : "On several occasions, I've seen a create() with the sequential flag set fail with a ZNODEEXISTS error, and I don't think that should ever be possible.  In past runs, I've been able to closely inspect the state of the system with the command line client, and saw that the parent znode's cversion is smaller than the sequential number of existing children znode under that parent.  In one example:\n\n{noformat}\n[zk:<ip:port>(CONNECTED) 3] stat /zkrsm\ncZxid = 0x5\nctime = Mon Jan 17 18:28:19 PST 2011\nmZxid = 0x5\nmtime = Mon Jan 17 18:28:19 PST 2011\npZxid = 0x1d819\ncversion = 120710\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0x0\ndataLength = 0\nnumChildren = 2955\n{noformat}\n\nHowever, the znode /zkrsm/000000000000002d_record0000120804 existed on disk.\n\nIn a recent run, I was able to capture the Zookeeper logs, and I will attach them to this JIRA.  The logs are named as nodeX.<zxid_prefixes>.log, and each new log represents an application process restart.\n\nHere's the scenario:\n\n# There's a cluster with nodes 1,2,3 using zxid 0x3.\n# All three nodes restart, forming a cluster of zxid 0x4.\n# Node 3 restarts, leading to a cluster of 0x5.\n\nAt this point, it seems like node 1 is the leader of the 0x5 epoch.  In its log (node1.0x4-0x5.log) you can see the first (of many) instances of the following message:\n\n{noformat}\n2011-04-11 21:16:12,607 16649 [ProcessThread:-1] INFO org.apache.zookeeper.server.PrepRequestProcessor  - Got user-level KeeperException when processing sessionid:0x512f466bd44e0002 type:create cxid:0x4da376ab zxid:0xfffffffffffffffe txntype:unknown reqpath:n/a Error Path:/zkrsm/00000000000000b2_record0001761440 Error:KeeperErrorCode = NodeExists for /zkrsm/00000000000000b2_record0001761440\n{noformat}\n\nThis then repeats forever as my application isn't expecting to ever get this error message on a sequential node create, and just continually retries.  The message even transfers over to node3.0x5-0x6.log once the 0x6 epoch comes into play.\n\nI don't see anything terribly fishy in the transition between the epochs; the correct snapshots seem to be getting transferred, etc.  Unfortunately I don't have a ZK snapshot/log that exhibits the problem when starting with a fresh system.\n\nSome oddities you might notice in these logs:\n* Between epochs 0x3 and 0x4, the zookeeper IDs of the nodes changed due to a bug in our application code.  (They are assigned randomly, but are supposed to be consistent across restarts.)\n* We manage node membership dynamically, and our application restarts the ZooKeeperServer classes whenever a new node wants to join (without restarting the entire application process).  This is why you'll see messages like the following in node1.0x4-0x5.log before a new election begins:\n{noformat}\n2011-04-11 21:16:00,762 4804 [QuorumPeer:/0.0.0.0:2888] INFO org.apache.zookeeper.server.quorum.Learner  - shutdown called\n{noformat}\n* There is in fact one of these dynamic membership changes in node1.0x4-0x5.log, just before the 0x4 epoch is formed.  I'm not sure how this would be related though, as no transactions are done during this period.", "created_at" : { "$date" : "2011-04-12T22:24:19.329+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:03.075+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.3.2" ], "components" : [ "server" ], "labels" : [ "sequence" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ], "environment" : "A 3 node-cluster running Debian squeeze." },
{ "_id" : { "$oid" : "5b7d515e5f627d6b0586b08d" }, "external_id" : "ZOOKEEPER-975", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "new peer goes in LEADING state even if ensemble is online", "desc" : "Scenario:\n1. 2 of the 3 ZK nodes are online\n2. Third node is attempting to join\n3. Third node unnecessarily goes in \"LEADING\" state\n4. Then third goes back to LOOKING (no majority of followers) and finally goes to FOLLOWING state.\n\n\nWhile going through the logs I noticed that a peer C that is trying to\njoin an already formed cluster goes in LEADING state. This is because\nQuorumCnxManager of A and B sends the entire history of notification\nmessages to C. C receives the notification messages that were\nexchanged between A and B when they were forming the cluster.\n\nIn FastLeaderElection.lookForLeader(), due to the following piece of\ncode, C quits lookForLeader assuming that it is supposed to lead.\n\n740                             //If have received from all nodes, then terminate\n741                             if ((self.getVotingView().size() == recvset.size()) &&\n742                                     (self.getQuorumVerifier().getWeight(proposedLeader) != 0)){\n743                                 self.setPeerState((proposedLeader == self.getId()) ?\n744                                         ServerState.LEADING: learningState());\n745                                 leaveInstance();\n746                                 return new Vote(proposedLeader, proposedZxid);\n747\n748                             } else if (termPredicate(recvset,\n\n\nThis can cause:\n1.  C to unnecessarily go in LEADING state and wait for tickTime * initLimit and then restart the FLE.\n\n2. C waits for 200 ms (finalizeWait) and then considers whatever\nnotifications it has received to make a decision. C could potentially\ndecide to follow an old leader, fail to connect to the leader, and\nthen restart FLE. See code below.\n\n752                             if (termPredicate(recvset,\n753                                     new Vote(proposedLeader, proposedZxid,\n754                                             logicalclock))) {\n755 \n756                                 // Verify if there is any change in the proposed leader\n757                                 while((n = recvqueue.poll(finalizeWait,\n758                                         TimeUnit.MILLISECONDS)) != null){\n759                                     if(totalOrderPredicate(n.leader, n.zxid,\n760                                             proposedLeader, proposedZxid)){\n761                                         recvqueue.put(n);\n762                                         break;\n763                                     }\n764                                 }\n\n\n\nIn general, this does not affect correctness of FLE since C will\neventually go back to FOLLOWING state (A and B won't vote for\nC). However, this delays C from joining the cluster. This can in turn\naffect recovery time of an application.\n\n\nProposal: A and B should send only the latest notification (most\nrecent) instead of the entire history. Does this sound reasonable?\n\n\n\n", "created_at" : { "$date" : "2011-01-14T12:29:33.071+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:03.282+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d515f5f627d6b0586b0dc" }, "external_id" : "ZOOKEEPER-921", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkPython incorrectly checks for existence of required ACL elements", "desc" : "Calling {{zookeeper.create()}} seems, under certain circumstances, to be corrupting a subsequent call to Python's {{logging}} module.\n\nSpecifically, if the node does not exist (but its parent does), I end up with a traceback like this when I try to make the logging call:\n\n{noformat}\nTraceback (most recent call last):\n  File \"zktest.py\", line 21, in <module>\n    logger.error(\"Boom?\")\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/logging/__init__.py\", line 1046, in error\n    if self.isEnabledFor(ERROR):\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/logging/__init__.py\", line 1206, in isEnabledFor\n    return level >= self.getEffectiveLevel()\n  File \"/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/logging/__init__.py\", line 1194, in getEffectiveLevel\n    while logger:\nTypeError: an integer is required\n{noformat}\n\nBut if the node already exists, or the parent does not exist, I get the appropriate NodeExists or NoNode exceptions.\n\nI'll be attaching a test script that can be used to reproduce this behavior.", "created_at" : { "$date" : "2010-11-08T08:51:59.599+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:03.842+0000" }, "creator_id" : { "$oid" : "5b7d515fe9214a0d1608d90b" }, "reporter_id" : { "$oid" : "5b7d515fe9214a0d1608d90b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1", "3.4.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d515fe9214a0d1608d90b" }, "issue_links" : [  ], "environment" : "Mac OS X 10.6.4, included Python 2.6.1" },
{ "_id" : { "$oid" : "5b7d50dc5f627d6b0586a610" }, "external_id" : "ZOOKEEPER-808", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a612" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a611" }, "effect" : "requires", "type" : "Required" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "created_at" : { "$date" : "2010-07-10T14:38:08.919+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "updated_at" : { "$date" : "2011-11-23T19:22:03.512+0000" }, "title" : "Web-based Administrative Interface", "issue_type" : "New Feature", "desc" : "Implement a web-based administrative interface that should allow the user to perform all the tasks that can be done using the interactive shell (zkCli.sh) from a browser. It should also display cluster and individual server info extracted using the 4letter word commands. \n\nI'm going to build starting from the http://github.com/phunt/zookeeper_dashboard implemented by Patrick Hunt. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51615f627d6b0586b107" }, "external_id" : "ZOOKEEPER-854", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "BookKeeper does not compile due to changes in the ZooKeeper code", "desc" : "BookKeeper does not compile due to changes in the NIOServerCnxn class of ZooKeeper.", "created_at" : { "$date" : "2010-08-19T20:04:45.535+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:03.664+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51625f627d6b0586b114" }, "external_id" : "ZOOKEEPER-1299", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add winconfig.h file to ignore in release audit.", "desc" : "We need to add the winconfig.h to ignores in release audits.", "created_at" : { "$date" : "2011-11-16T06:53:42.741+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:04.992+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51635f627d6b0586b11b" }, "external_id" : "ZOOKEEPER-1270", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "testEarlyLeaderAbandonment failing intermittently, quorum formed, no serving.", "desc" : "Looks pretty serious - quorum is formed but no clients can attach. Will attach logs momentarily.\n\nThis test was introduced in the following commit (all three jira commit at once):\nZOOKEEPER-335. zookeeper servers should commit the new leader txn to their logs.\nZOOKEEPER-1081. modify leader/follower code to correctly deal with new leader\nZOOKEEPER-1082. modify leader election to correctly take into account current", "created_at" : { "$date" : "2011-10-28T22:25:36.207+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:04.609+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51635f627d6b0586b11a" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d51645f627d6b0586b171" }, "external_id" : "ZOOKEEPER-1246", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Dead code in PrepRequestProcessor catch Exception block", "desc" : "This is a regression introduced by ZOOKEEPER-965 (multi transactions). The catch(Exception e) block in PrepRequestProcessor.pRequest contains an if block with condition request.getHdr() != null. This condition will always evaluate to false since the changes in ZOOKEEPER-965.\n\nThis is caused by a change in sequence: Before ZK-965, the txnHeader was set _before_ the deserialization of the request. Afterwards the deserialization happens before request.setHdr is set. So the following RequestProcessors won't see the request as a failed one but as a Read request, since it doesn't have a hdr set.\n\nNotes:\n- it is very bad practice to catch Exception. The block should rather catch IOException\n- The check whether the TxnHeader is set in the request is used at several places to see whether the request is a read or write request. It isn't obvious for a newby, what it means whether a request has a hdr set or not.\n- at the beginning of pRequest the hdr and txn of request are set to null. However there is no chance that these fields could ever not be null at this point. The code however suggests that this could be the case. There should rather be an assertion that confirms that these fields are indeed null. The practice of doing things \"just in case\", even if there is no chance that this case could happen, is a very stinky code smell and means that the code isn't understandable or trustworthy.\n- The multi transaction switch case block in pRequest is very hard to read, because it missuses the request.{hdr|txn} fields as local variables.", "created_at" : { "$date" : "2011-10-25T09:57:51.640+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:04.392+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d51655f627d6b0586b1a5" }, "external_id" : "ZOOKEEPER-464", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Need procedure to garbage collect ledgers", "desc" : "An application using BookKeeper is likely to use a large number of ledgers over time. Such an application might not need all ledgers created over time and might want to delete some of these ledgers to free up some space on bookies. The idea of this jira is to implement a procedure that enables an application to garbage-collect unwanted ledgers.\n\nTo garbage-collect a ledger, we need to delete the ledger metadata on ZooKeeper, and delete the ledger data on corresponding bookies. ", "created_at" : { "$date" : "2009-07-13T20:20:34.751+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:04.798+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51665f627d6b0586b1d4" }, "external_id" : "ZOOKEEPER-1160", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test timeouts are too small", "desc" : "in reviewing some tests that weren't passing i notices that the tick time was 2ms rather than the normal 2000ms. i think this is causing tests to fail on some slow/overloaded machines.", "created_at" : { "$date" : "2011-08-23T05:03:21.062+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:05.778+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51665f627d6b0586b1d3" } },
{ "_id" : { "$oid" : "5b7d51675f627d6b0586b1e7" }, "external_id" : "ZOOKEEPER-1094", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Small improvements to LeaderElection and Vote classes", "desc" : "1. o.a.z.q.Vote is a struct-style class, whose fields are public and not final. \n\nIn general, we should prefer making the fields of these kind of classes final, and hiding them behind getters for the following reasons:\n\n* Marking them as final allows clients of the class not to worry about any synchronisation when accessing the fields\n* Hiding them behind getters allows us to change the implementation of the class without changing the API. \n\nObject creation is very cheap. It's ok to create new Votes rather than mutate existing ones. \n\n2. Votes are mainly used in the LeaderElection class. In this class a map of addresses to votes is passed in to countVotes, which modifies the map contents inside an iterator (and therefore changes the object passed in by reference). This is pretty gross, so at the same time I've slightly refactored this method to return information about the number of validVotes in the ElectionResult class, which is returned by countVotes. \n\n3. The previous implementation of countVotes was quadratic in the number of votes. It is possible to do this linearly. No real speed-up is expected as a result, but it salves the CS OCD in me :)\n\n", "created_at" : { "$date" : "2011-06-13T22:14:32.707+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:05.347+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51685f627d6b0586b200" }, "external_id" : "HADOOP-6255", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51685f627d6b0586b201" }, "external_id" : "ZOOKEEPER-999", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create an package integration project", "desc" : "This goal of this ticket is to generate a set of RPM/debian package which integrate well with RPM sets created by HADOOP-6255.", "created_at" : { "$date" : "2011-02-22T01:36:14.826+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:05.531+0000" }, "creator_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "reporter_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51685f627d6b0586b1fe" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51685f627d6b0586b1ff" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51685f627d6b0586b200" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "Java 6, RHEL/Ubuntu" },
{ "_id" : { "$oid" : "5b7d51695f627d6b0586b287" }, "external_id" : "ZOOKEEPER-1034", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "perl bindings should automatically find the zookeeper c-client headers", "desc" : "Installing Net::ZooKeeper from cpan or the zookeeper distribution tarballs will always fail due to not finding c-client header files.  In conjunction with ZOOKEEPER-1033 update perl bindings to look for c-client header files in INCDIR/zookeeper/\n\na.k.a. make installs of Net::ZooKeeper via cpan/cpanm/whatever *just work*, assuming you've already got the zookeeper c client installed.", "created_at" : { "$date" : "2011-03-27T20:45:50.690+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:05.956+0000" }, "creator_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "reporter_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50dc5f627d6b0586a611" }, "external_id" : "ZOOKEEPER-809", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a612" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a610" }, "effect" : "is required by", "type" : "Required" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "created_at" : { "$date" : "2010-07-10T15:18:29.658+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "updated_at" : { "$date" : "2011-11-23T19:22:05.200+0000" }, "title" : "Improved REST Interface", "issue_type" : "Improvement", "desc" : "I would like to extend the existing REST Interface to also support:\n* configuration\n* ephemeral znodes\n* watches - PubSubHubbub \n* ACLs \n* basic authentication\n\nI want to do this because when building web applications that talks directly to ZooKeeper a REST API it's a lot easier to use (there is no protocol mismatch) than an API that uses persistent connections. I plan to use the improved version to build a web-based administrative interface. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d516b5f627d6b0586b2cb" }, "external_id" : "ZOOKEEPER-1192", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader.waitForEpochAck() checks waitingForNewEpoch instead of checking electionFinished", "desc" : "A follower/leader should block in Leader.waitForEpochAck() until either electingFollowers contains a quorum and electionFinished=true or until a timeout occurs. A timeout means that a quorum of followers didn't ack the epoch on time, which is an error. \n\nBut the check in Leader.waitForEpochAck() is \"if (waitingForNewEpoch) throw...\" and this will never be triggered, even if the wait statement just timed out,  because Leader.getEpochToPropose() completes and sets waitingForNewEpoch to false before Leader.waitForEpochAck() is invoked.\n\nInstead of \"if (waitingForNewEpoch) throw\" the condition in Leader.waitForEpochAck() should be \"if (!electionFinished) throw\".\nThe guarded block introduced in ZK-1191 should be checking !electionFinished.\n\n", "created_at" : { "$date" : "2011-09-19T02:00:24.303+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:06.417+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516b5f627d6b0586b2e8" }, "external_id" : "ZOOKEEPER-1097", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Quota is not correctly rehydrated on snapshot reload", "desc" : "traverseNode in DataTree will never actually traverse the limit nodes properly.", "created_at" : { "$date" : "2011-06-16T14:07:44.375+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:06.217+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516c5f627d6b0586b312" }, "external_id" : "ZOOKEEPER-1268", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "problems with read only mode, intermittent test failures and ERRORs in the log", "desc" : "I'm having a lot problems testing the 3.4.0 release candidate (0). I'm seeing frequent failures in RO unit tests, also the solaris tests are broken on jenkins, some of which is due to RO mode:\nhttps://builds.apache.org/view/S-Z/view/ZooKeeper/job/ZooKeeper_trunk_solaris/30/#showFailuresLink\n\nI'm also seeing ERROR level messages in the logs during test runs that are a result of attempting to start RO mode.\n\nGiven this is a new feature, one that could be very disruptive, I think we need to control whether the feature is enabled or not through a config option (system prop is fine), disabled by default.\n\nI'll look at the RO mode tests to see if I can find the cause of the failures on solaris, but I may also turn off these tests for the time being. (I need to look at this further).\n\n\nI'm marking this as a blocker for 3.4.0, Mahadev LMK if you feel similarly or whether I should be shooting for 3.4.1 with this. (or perhaps I'm just way off in general).\n\n", "created_at" : { "$date" : "2011-10-28T18:01:05.605+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:06.590+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516d5f627d6b0586b321" }, "external_id" : "ZOOKEEPER-798", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fixup loggraph for FLE changes", "created_at" : { "$date" : "2010-06-29T13:01:25.048+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:06.770+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d516d5f627d6b0586b320" } },
{ "_id" : { "$oid" : "5b7d516d5f627d6b0586b32e" }, "external_id" : "BOOKKEEPER-20", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516d5f627d6b0586b32f" }, "external_id" : "ZOOKEEPER-1086", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper test jar has non mavenised dependency.", "desc" : "The zookeeper test jar, (zookeeper-<version>-test.jar) depends on accessive.jar which is not available in maven. This is problematic for projects using the test jar (i.e. hedwig). ", "created_at" : { "$date" : "2011-06-01T10:52:19.998+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:07.944+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d516d5f627d6b0586b32e" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d516e5f627d6b0586b348" }, "external_id" : "ZOOKEEPER-1058", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix typo in opToString for getData", "desc" : "fix Request getData to print that instead of getDate", "created_at" : { "$date" : "2011-05-04T00:34:45.179+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:07.755+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516f5f627d6b0586b356" }, "external_id" : "ZOOKEEPER-1168", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper fails to run with IKVM", "desc" : "OS: Windows 64-bit\nJRE: IKVM 7.0.4258\n\nIKVM 7.0.4258 does not support ManagementFactory.getPlatformMBeanServer(); It will throw a java.lang.Error.\n", "created_at" : { "$date" : "2011-08-31T19:52:13.698+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:07.601+0000" }, "creator_id" : { "$oid" : "5b7d516fe9214a0d1608d90e" }, "reporter_id" : { "$oid" : "5b7d516fe9214a0d1608d90e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "jmx" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d516fe9214a0d1608d90e" }, "issue_links" : [  ], "original_time_estimate" : 86400, "environment" : "All Architectures. Running with IKVM and OpenJDK instead of Sun JDK 6." },
{ "_id" : { "$oid" : "5b7d51705f627d6b0586b36e" }, "external_id" : "BOOKKEEPER-30", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51705f627d6b0586b36f" }, "external_id" : "ZOOKEEPER-1111", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMXEnv uses System.err instead of logging", "desc" : "As stated in the title, org.apache.zookeeper.test.JMXEnv uses System.err.println to output traces. This makes for a lot of noise on the console when you run the tests. It has a logging object already, so it should use that instead.", "created_at" : { "$date" : "2011-06-30T08:51:00.653+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:07.359+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51705f627d6b0586b36e" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51705f627d6b0586b37d" }, "external_id" : "ZOOKEEPER-766", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "forrest recipes docs don't mention the lock/queue recipe implementations available in the release", "desc" : "Update the forrest recipes docs to point to the recipe implementations (where available).", "created_at" : { "$date" : "2010-05-05T19:04:27.610+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:07.005+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "documentation", "recipes" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51715f627d6b0586b388" }, "external_id" : "ZOOKEEPER-1136", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NEW_LEADER should be queued not sent to match the Zab 1.0 protocol on the twiki", "desc" : "the NEW_LEADER message was sent at the beginning of the sync phase in Zab pre1.0, but it must be at the end in Zab 1.0. if the protocol is 1.0 or greater we need to queue rather than send the packet.", "created_at" : { "$date" : "2011-07-26T16:58:51.440+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:08.627+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51725f627d6b0586b3a4" }, "external_id" : "ZOOKEEPER-1134", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClientCnxnSocket string comparison using == rather than equals", "desc" : "Noticed string comparison using == rather than equals.", "created_at" : { "$date" : "2011-07-22T22:18:55.050+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:08.182+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51725f627d6b0586b3b1" }, "external_id" : "ZOOKEEPER-783", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "committedLog in ZKDatabase is not properly synchronized", "desc" : "ZKDatabase.getCommittedLog() returns a reference to the LinkedList<Proposal> committedLog in ZKDatabase. This is then iterated over by at least one caller. \n\nI have seen a bug that causes a NPE in LinkedList.clear on committedLog, which I am pretty sure is due to the lack of synchronization. This bug has not been apparent in normal ZK operation, but in code that I have that starts and stops a ZK server in process repeatedly (clear() is called from ZooKeeperServerMain.shutdown()). \n\nIt's better style to defensively copy the list in getCommittedLog, and to synchronize on the list in ZKDatabase.clear.\n\n", "created_at" : { "$date" : "2010-06-01T19:22:43.910+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:08.911+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51735f627d6b0586b3c1" }, "external_id" : "ZOOKEEPER-746", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "learner outputs session id to log in dec (should be hex)", "desc" : "usability issue, should be in hex:\n\n2010-04-21 11:31:13,827 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11354:Learner@95] - Revalidating client: 83353578391797760\n", "created_at" : { "$date" : "2010-04-21T22:10:46.489+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:08.382+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51745f627d6b0586b3d0" }, "external_id" : "ZOOKEEPER-1208", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral node not removed after the client session is long gone", "desc" : "Copying from email thread.\n\n\nWe found our ZK server in a state where an ephemeral node still exists after\na client session is long gone. I used the cons command on each ZK host to\nlist all connections and couldn't find the ephemeralOwner id. We are using\nZK 3.3.3. Has anyone seen this problem?\n\nI got the following information from the logs.\n\nThe node that still exists is /kafka-tracking/consumers/UserPerformanceEvent-<host>/owners/UserPerformanceEvent/529-7\n\nI saw that the ephemeral owner is 86167322861045079 which is session id 0x13220b93e610550.\n\nAfter searching in the transaction log of one of the ZK servers found that session expired\n\n9/22/11 12:17:57 PM PDT session 0x13220b93e610550 cxid 0x74 zxid 0x601bd36f7 closeSession null\n\nOn digging further into the logs I found that there were multiple sessions created in quick succession and every session tried to create the same node. But i verified that the sessions were closed and opened in order\n9/22/11 12:17:56 PM PDT session 0x13220b93e610550 cxid 0x0 zxid 0x601bd36b5 createSession 6000\n9/22/11 12:17:57 PM PDT session 0x13220b93e610550 cxid 0x74 zxid 0x601bd36f7 closeSession null\n9/22/11 12:17:58 PM PDT session 0x13220b93e610551 cxid 0x0 zxid 0x601bd36f8 createSession 6000\n9/22/11 12:17:59 PM PDT session 0x13220b93e610551 cxid 0x74 zxid 0x601bd373a closeSession null\n9/22/11 12:18:00 PM PDT session 0x13220b93e610552 cxid 0x0 zxid 0x601bd373e createSession 6000\n9/22/11 12:18:01 PM PDT session 0x13220b93e610552 cxid 0x6c zxid 0x601bd37a0 closeSession null\n9/22/11 12:18:02 PM PDT session 0x13220b93e610553 cxid 0x0 zxid 0x601bd37e9 createSession 6000\n9/22/11 12:18:03 PM PDT session 0x13220b93e610553 cxid 0x74 zxid 0x601bd382b closeSession null\n9/22/11 12:18:04 PM PDT session 0x13220b93e610554 cxid 0x0 zxid 0x601bd383c createSession 6000\n9/22/11 12:18:05 PM PDT session 0x13220b93e610554 cxid 0x6a zxid 0x601bd388f closeSession null\n9/22/11 12:18:06 PM PDT session 0x13220b93e610555 cxid 0x0 zxid 0x601bd3895 createSession 6000\n9/22/11 12:18:07 PM PDT session 0x13220b93e610555 cxid 0x6a zxid 0x601bd38cd closeSession null\n9/22/11 12:18:10 PM PDT session 0x13220b93e610556 cxid 0x0 zxid 0x601bd38d1 createSession 6000\n9/22/11 12:18:11 PM PDT session 0x13220b93e610557 cxid 0x0 zxid 0x601bd38f2 createSession 6000\n9/22/11 12:18:11 PM PDT session 0x13220b93e610557 cxid 0x51 zxid 0x601bd396a closeSession null\n\nHere is the log output for the sessions that tried creating the same node\n\n9/22/11 12:17:54 PM PDT session 0x13220b93e61054f cxid 0x42 zxid 0x601bd366b create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:17:56 PM PDT session 0x13220b93e610550 cxid 0x42 zxid 0x601bd36ce create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:17:58 PM PDT session 0x13220b93e610551 cxid 0x42 zxid 0x601bd3711 create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:18:00 PM PDT session 0x13220b93e610552 cxid 0x42 zxid 0x601bd3777 create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:18:02 PM PDT session 0x13220b93e610553 cxid 0x42 zxid 0x601bd3802 create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:18:05 PM PDT session 0x13220b93e610554 cxid 0x44 zxid 0x601bd385d create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:18:07 PM PDT session 0x13220b93e610555 cxid 0x44 zxid 0x601bd38b0 create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n9/22/11 12:18:11 PM PDT session 0x13220b93e610557 cxid 0x52 zxid 0x601bd396b create '/kafka-tracking/consumers/UserPerformanceEvent-<hostname>/owners/UserPerformanceEvent/529-7\n\nLet me know if you need additional information.\n", "created_at" : { "$date" : "2011-09-28T04:35:47.557+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:11.531+0000" }, "creator_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "reporter_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51755f627d6b0586b3fc" }, "external_id" : "ZOOKEEPER-993", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Code improvements", "desc" : "In the file org.apache.zookeeper.server.quorum.FastLeaderElection.java for methods like totalOrderPredicate and termPredicate, which return boolean, the code is as below :\n\nif (condition)\n      return true;\nelse\n      return false;\n\nI feel, it would be better if the condition itself is returned.\ni.e., return condition.\n\nThe same thing holds good else where if applicable.", "created_at" : { "$date" : "2011-02-17T18:31:27.505+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:11.792+0000" }, "creator_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "reporter_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.3.2" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "issue_links" : [  ], "original_time_estimate" : 1800, "environment" : "Linux box, Eclipse IDE, " },
{ "_id" : { "$oid" : "5b7d51765f627d6b0586b40d" }, "external_id" : "ZOOKEEPER-772", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython segfaults when watcher from async get children is invoked.", "desc" : "When utilizing the zkpython async get children api with a watch, i consistently get segfaults when the watcher is invoked to process events. ", "created_at" : { "$date" : "2010-05-10T14:42:21.215+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:11.978+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ], "environment" : "ubuntu lucid (10.04) / zk trunk" },
{ "_id" : { "$oid" : "5b7d51775f627d6b0586b42d" }, "external_id" : "ZOOKEEPER-1206", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Sequential node creation does not use always use digits in node name given certain Locales.", "desc" : "While I always expect to be able to parse a sequential node by looking for digits, under some locals you end up with non digits - for example: n_\n\nIt looks like the problem is around line 236 in PrepRequestProcessor:\n\n{code}\n                if (createMode.isSequential()) {\n                    path = path + String.format(\"%010d\", parentCVersion);\n                }\n{code}\n\nInstead we should pass Locale.ENGLISH to the format call.\n\n{code}\n                if (createMode.isSequential()) {\n                    path = path + String.format(Locale.ENGLISH, \"%010d\", parentCVersion);\n                }\n{code}\n\nLucene/Solr tests with random Locales, and some of my tests that try and inspect the node name and order things expect to find digits - currently my leader election recipe randomly fails when the wrong locale pops up.", "created_at" : { "$date" : "2011-09-27T16:26:16.812+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:12.533+0000" }, "creator_id" : { "$oid" : "5b7d5177e9214a0d1608d90f" }, "reporter_id" : { "$oid" : "5b7d5177e9214a0d1608d90f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5177e9214a0d1608d90f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51775f627d6b0586b449" }, "external_id" : "ZOOKEEPER-1074", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh is missing nohup/sleep, which are necessary for remote invocation", "desc" : "zkServer.sh is missing nohup and \"sleep 1\" when starting the background daemon.\n\nThis is fine normally, however when running the server remotely via ssh this causes the process to not run successfully (it starts but immediately exits).\n\nI'll be submitting a patch for this shortly.\n", "created_at" : { "$date" : "2011-05-25T18:27:39.401+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:12.898+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51785f627d6b0586b454" }, "external_id" : "ZOOKEEPER-864", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hedwig C++ client improvements", "desc" : "I changed the socket code to use boost asio. Now the client only creates one thread, and all operations are non-blocking. \n\nTests are now automated, just run \"make check\".\n", "created_at" : { "$date" : "2010-09-03T14:42:45.569+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:12.255+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51795f627d6b0586b474" }, "external_id" : "ZOOKEEPER-1025", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCli is overly sensitive to to spaces.", "desc" : "Here's an example: \n\nI do an ls to get znode names. I try to stat a znode.  \n{code}\n[zk: localhost:3181(CONNECTED) 1] ls /flume-nodes\n[nodes0000000002, nodes0000000001, nodes0000000000, nodes0000000005, nodes0000000004, nodes0000000003]\n[zk: localhost:3181(CONNECTED) 3] stat /flume-nodes/nodes0000000002 \ncZxid = 0xb\nctime = Sun Mar 20 23:24:03 PDT 2011\n... (success)\n{code}\n\nHere's something that almost looks the same.  Notice the extra space infront of the znode name.\n\n{code}\n[zk: localhost:3181(CONNECTED) 2] stat  /flume-nodes/nodes0000000002\nCommand failed: java.lang.IllegalArgumentException: Path length must be > 0\n{code}\n\nThis seems like unexpected behavior.", "created_at" : { "$date" : "2011-03-22T00:40:50.743+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:13.145+0000" }, "creator_id" : { "$oid" : "5b7d5179e9214a0d1608d910" }, "reporter_id" : { "$oid" : "5b7d5179e9214a0d1608d910" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51795f627d6b0586b473" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d517a5f627d6b0586b48c" }, "external_id" : "ZOOKEEPER-814", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "monitoring scripts are missing apache license headers", "desc" : "Andrei, I just realized that src/contrib/monitoring files are missing apache license headers.  Please add them (in particular any script files like python, see similar files in svn for examples - in some cases like README it's not strictly necessary.) \n\nYou can run the RAT tool to verify (see build.xml or http://incubator.apache.org/rat/)\n", "created_at" : { "$date" : "2010-07-14T06:59:31.921+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:13.555+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d517a5f627d6b0586b499" }, "external_id" : "ZOOKEEPER-844", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "handle auth failure in java client", "desc" : "ClientCnxn.java currently has the following code:\n  if (replyHdr.getXid() == -4) {\n                // -2 is the xid for AuthPacket\n                // TODO: process AuthPacket here\n                if (LOG.isDebugEnabled()) {\n                    LOG.debug(\"Got auth sessionid:0x\"\n                            + Long.toHexString(sessionId));\n                }\n                return;\n            }\n\nAuth failures appear to cause the server to disconnect but the client never gets a proper state change or notification that auth has failed, which makes handling this scenario very difficult as it causes the client to go into a loop of sending bad auth, getting disconnected, trying to reconnect, sending bad auth again, over and over. \n", "created_at" : { "$date" : "2010-08-12T16:05:02.313+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:13.910+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c75f627d6b0586a4e5" }, "external_id" : "ZOOKEEPER-418", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50c75f627d6b0586a4e6" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "created_at" : { "$date" : "2009-05-27T07:10:50.257+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "resolution" : "Won't Fix", "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "updated_at" : { "$date" : "2011-11-23T19:22:13.346+0000" }, "title" : "Need nifty zookeeper browser", "issue_type" : "Bug", "desc" : "It would be very nice to have a browser that would allow the state of a Zoo to be examined.  Even nice would be such a utility that showed changes in real time.\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d517c5f627d6b0586b4d0" }, "external_id" : "ZOOKEEPER-1201", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Clean SaslServerCallbackHandler.java", "desc" : "Severe code style issues.", "created_at" : { "$date" : "2011-09-22T18:02:38.557+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:14.340+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51285f627d6b0586aade" }, "effect" : "incorporates", "type" : "Incorporates" } ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d517d5f627d6b0586b4e9" }, "external_id" : "ZOOKEEPER-1166", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Please add a few svn:ignore properties", "desc" : "Please add a couple svn:ignore properties to make dealing with the code slightly easier.\n\nAt the root, please add an svn:ignore property for \"build\" so that the default build directory for eclipse is excluded.\n\nAt src/java/lib, please add an svn:ignore property for \"*.jar\" so that jars acquired by ivy are ignored.", "created_at" : { "$date" : "2011-08-29T23:59:23.454+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:14.913+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 3600 },
{ "_id" : { "$oid" : "5b7d517d5f627d6b0586b4fe" }, "external_id" : "ZOOKEEPER-977", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "passing null for path_buffer in zoo_create", "desc" : "it is unclear from the comments for zoo_create if a NULL can be passed for path_buffer.", "created_at" : { "$date" : "2011-01-19T19:43:53.984+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:14.696+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d517e5f627d6b0586b50e" }, "external_id" : "ZOOKEEPER-1033", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client should install includes into INCDIR/zookeeper, not INCDIR/c-client-src", "desc" : "header files are installed into foo/include/c-client-src/, which doesn't indicate a relationship with zookeeper and doesn't correspond to foo/lib/libzookeeper*\n\nheader files should be installed into foo/include/zookeeper/ as this is the common practice.", "created_at" : { "$date" : "2011-03-27T20:40:09.658+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:14.117+0000" }, "creator_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "reporter_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d517e5f627d6b0586b50d" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d517f5f627d6b0586b534" }, "external_id" : "ZOOKEEPER-735", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cppunit test testipv6 assumes that the machine is ipv6 enabled.", "desc" : "The test should be fixed so that it runs only if ipv6 is enabled and does not run if ipv6 is not enabled.", "created_at" : { "$date" : "2010-04-07T21:26:46.532+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:14.514+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51805f627d6b0586b540" }, "external_id" : "ZOOKEEPER-1212", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh stop action is not conformat with LSB para 20.2InitScriptActions", "desc" : "According to LSB Core para 20.2:\n==================================================================================\nOtherwise, theexit statusshall benonzero, asdefinedbelow.\nInadditiontostraightforwardsuccess,thefollowingsituationsare\nalsotobeconsideredsuccessful:\n restartingaservice(insteadofreloadingit)withtheforcereloadargument\n runningstartonaservicealreadyrunning\n runningstoponaservicealreadystoppedornotrunning\n runningrestartonaservicealreadystoppedornotrunning\n runningtryrestartonaservicealreadystoppedornotrunning\n==================================================================================\n\nYet, zkServer.sh fails on stop if it can't find a PID file:\n\n{noformat}\nstop)\n    echo -n \"Stopping zookeeper ... \"\n    if [ ! -f \"$ZOOPIDFILE\" ]\n    then\n      echo \"error: could not find file $ZOOPIDFILE\"\n      exit 1\n    else\n      $KILL -9 $(cat \"$ZOOPIDFILE\")\n      rm \"$ZOOPIDFILE\"\n      echo STOPPED\n      exit 0\n    fi\n{noformat}", "created_at" : { "$date" : "2011-10-03T20:24:24.143+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:15.679+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0", "3.5.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51805f627d6b0586b556" }, "external_id" : "HBASE-2966", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51805f627d6b0586b557" }, "external_id" : "ZOOKEEPER-846", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper client doesn't shut down cleanly on the close call", "desc" : "Using HBase 0.20.6 (with HBASE-2473) we encountered a situation where Regionserver\nprocess was shutting down and seemed to hang.\n\nHere is the bottom of region server log:\nhttp://pastebin.com/YYawJ4jA\n\nzookeeper-3.2.2 is used.\n\nHere is relevant portion from jstack - I attempted to attach jstack twice in my email to dev@hbase.apache.org but failed:\n\n\"DestroyJavaVM\" prio=10 tid=0x00002aabb849c800 nid=0x6c60 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"regionserver/10.32.42.245:60020\" prio=10 tid=0x00002aabb84ce000 nid=0x6c81 in Object.wait() [0x0000000043755000]\n   java.lang.Thread.State: WAITING (on object monitor)\n        at java.lang.Object.wait(Native Method)\n        - waiting on <0x00002aaab76633c0> (a org.apache.zookeeper.ClientCnxn$Packet)\n        at java.lang.Object.wait(Object.java:485)\n        at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1099)\n        - locked <0x00002aaab76633c0> (a org.apache.zookeeper.ClientCnxn$Packet)\n        at org.apache.zookeeper.ClientCnxn.close(ClientCnxn.java:1077)\n        at org.apache.zookeeper.ZooKeeper.close(ZooKeeper.java:505)\n        - locked <0x00002aaabf5e0c30> (a org.apache.zookeeper.ZooKeeper)\n        at org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper.close(ZooKeeperWrapper.java:681)\n        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:654)\n        at java.lang.Thread.run(Thread.java:619)\n\n\"main-EventThread\" daemon prio=10 tid=0x0000000043474000 nid=0x6c80 waiting on condition [0x00000000413f3000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00002aaabf6e9150> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)\n        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:158)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1987)\n        at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:399)\n        at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:414)\n", "created_at" : { "$date" : "2010-08-12T17:19:53.973+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:15.054+0000" }, "creator_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "reporter_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.2.2" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51805f627d6b0586b556" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d4f5f5f627d6b058682f2" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51815f627d6b0586b572" }, "external_id" : "ZOOKEEPER-636", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "configure.ac has instructions which override the contents of CFLAGS and CXXFLAGS.", "desc" : "The information mustn't be overridden.\nThe template like CFLAGS=\"$CFLAGS -some-option\" should be used.", "created_at" : { "$date" : "2009-12-29T13:52:06.934+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:15.507+0000" }, "creator_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "reporter_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "c client", "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f79e9214a0d1608d879" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51825f627d6b0586b594" }, "external_id" : "ZOOKEEPER-1152", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Exceptions thrown from handleAuthentication can cause buffer corruption issues in NIOServer", "desc" : "Exceptions thrown by an AuthenticationProvider's handleAuthentication method will not be caught, and can cause the buffers in the NIOServer to not read requests fully or properly. Any exceptions thrown here should be caught and treated as auth failure. ", "created_at" : { "$date" : "2011-08-12T20:27:37.410+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:16.398+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51835f627d6b0586b5a2" }, "external_id" : "ZOOKEEPER-1013", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh usage message should mention all startup options", "desc" : "currently the \"Usage\" message for zkServer shows:\n\n  echo \"Usage: $0 {start|stop|restart|status}\" \n\nBut it seems to me that it should show the other startup options as well, which are currently: start-foreground, upgrade, print-cmd.\n\n", "created_at" : { "$date" : "2011-03-11T20:28:02.671+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:16.834+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [  ], "original_time_estimate" : 300 },
{ "_id" : { "$oid" : "5b7d51835f627d6b0586b5ae" }, "external_id" : "ZOOKEEPER-603", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython should do a better job of freeing memory under error conditions", "desc" : "The general pattern is that the construction of a collection might fail, but the module is not freeing the memory that it has already allocated. Exceptions that are raised during this process aren't always propagated back to the Python side either. \n\n", "created_at" : { "$date" : "2009-12-01T19:27:49.461+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:16.222+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5183e9214a0d1608d913" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51845f627d6b0586b5bc" }, "external_id" : "ZOOKEEPER-908", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove code duplication and inconsistent naming in ClientCnxn.Packet creation", "desc" : "rename record -> request (since their is a counterpart record named \"response\")\nrename header -> requestHeader (to distinguish from responseHeader)\n\nremove ByteBuffer creation code from primeConnection() method and use the duplicate code in the Packet constructor. Therefor the Bytebuffer bb parameter could also be removed from the constructor's parameters.", "created_at" : { "$date" : "2010-10-21T10:02:59.768+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:17.268+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d51855f627d6b0586b5cf" }, "external_id" : "ZOOKEEPER-913", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Version parser fails to parse \"3.3.2-dev\" from build.xml.", "desc" : "Cannot build 3.3.1 from release tarball do to VerGen parser inability to parse \"3.3.2-dev\".\n\nversion-info:\n     [java] All version-related parameters must be valid integers!\n     [java] Exception in thread \"main\" java.lang.NumberFormatException: For input string: \"2-dev\"\n     [java] \tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n     [java] \tat java.lang.Integer.parseInt(Integer.java:481)\n     [java] \tat java.lang.Integer.parseInt(Integer.java:514)\n     [java] \tat org.apache.zookeeper.version.util.VerGen.main(VerGen.java:131)\n     [java] Java Result: 1\n", "created_at" : { "$date" : "2010-10-26T06:50:16.166+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:17.761+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86a" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51865f627d6b0586b5ed" }, "external_id" : "ZOOKEEPER-790", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Last processed zxid set prematurely while establishing leadership", "desc" : "The leader code is setting the last processed zxid to the first of the new epoch even before connecting to a quorum of followers. Because the leader code sets this value before connecting to a quorum of followers (Leader.java:281) and the follower code throws an IOException (Follower.java:73) if the leader epoch is smaller, we have that when the false leader drops leadership and becomes a follower, it finds a smaller epoch and kills itself.", "created_at" : { "$date" : "2010-06-22T16:47:56.833+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:17.505+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51865f627d6b0586b5ec" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51875f627d6b0586b64c" }, "external_id" : "ZOOKEEPER-787", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "groupId in deployed pom is wrong", "desc" : "The pom deployed to repo1.maven.org has the project declared like this:\n\n<groupId>org.apache.zookeeper</groupId>\n<artifactId>zookeeper</artifactId>\n<packaging>jar</packaging>\n<version>3.3.1</version>\n\nBut it is deployed here: http://repo2.maven.org/maven2/org/apache/hadoop/zookeeper/3.3.1\n\nSo either the groupId needs to change or the location it is deployed to needs to be changed because having them different results in bad behavior.  If you specify the correct groupId in your own pom/ivy files you can't even download zookeeper because it's not where your pom says it is and if you use the \"incorrect\" groupId then you can download zookeeper but then ivy complains about:\n\n[error] :: problems summary ::\n[error] :::: ERRORS\n[error] \t\tpublic: bad organisation found in http://repo1.maven.org/maven2/org/apache/hadoop/zookeeper/3.3.1/zookeeper-3.3.1.pom: expected='org.apache.hadoop' found='org.apache.zookeeper'\n", "created_at" : { "$date" : "2010-06-10T16:46:55.409+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:17.017+0000" }, "creator_id" : { "$oid" : "5b7d5187e9214a0d1608d914" }, "reporter_id" : { "$oid" : "5b7d5187e9214a0d1608d914" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51875f627d6b0586b64b" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d51885f627d6b0586b65d" }, "external_id" : "ZOOKEEPER-1104", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "CLONE - In QuorumTest, use the same \"for ( .. try { break } catch { } )\" pattern in testFollowersStartAfterLeaders as in testSessionMove.", "desc" : "Patrick Hunt writes: \n\n\"Such uses of sleep [used in testFollowersStartAfterLeader] are just asking for trouble. Take a look at the use\nof sleep in testSessionMove in the same class for a better way to do\nthis. I had gone through all the tests a while back, replacing all the\n\"sleep(x)\" with something like this testSessionMove pattern (retry\nwith a max limit that's very long). During reviews we should look for\nanti-patterns like this and address them before commit.\"\n\nSo, modify testFollowersStartAfterLeaders to use the same retrying approach that testSessionMove uses.", "created_at" : { "$date" : "2011-06-22T18:21:39.386+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:19.668+0000" }, "creator_id" : { "$oid" : "5b7d5188e9214a0d1608d918" }, "reporter_id" : { "$oid" : "5b7d5188e9214a0d1608d918" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51885f627d6b0586b65c" }, "effect" : "is cloned by", "type" : "Cloners" } ] },
{ "_id" : { "$oid" : "5b7d51885f627d6b0586b671" }, "external_id" : "ZOOKEEPER-1087", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ForceSync VM arguement not working when set to \"no\"", "desc" : "Cannot use forceSync=no to asynchronously write transaction logs. This is a critical bug, please address it ASAP. More details:\n\nThe class org.apache.zookeeper.server.persistence.FileTxnLog initializes forceSync property in a static block. However, the static variable is defined after the static block with a default value of true. Therefore, the value of the variable can never be false. Please move the declaration of the variable before the static block.", "created_at" : { "$date" : "2011-06-06T20:09:54.569+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:19.256+0000" }, "creator_id" : { "$oid" : "5b7d5188e9214a0d1608d919" }, "reporter_id" : { "$oid" : "5b7d5188e9214a0d1608d919" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5188e9214a0d1608d91a" }, "issue_links" : [  ], "original_time_estimate" : 300 },
{ "_id" : { "$oid" : "5b7d51895f627d6b0586b6a3" }, "external_id" : "ZOOKEEPER-773", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log visualisation", "desc" : "Zkgraph is a log viewer for zookeeper. It can handle transaction logs and message logs. There are currently two view.\n \n  a) Server view\n     The server view shows the interactions between the different servers in an ensemble. The X axis represents time. \n        * Exceptions show up as red dots. Hovering your mouse over them will give you more details of the exception\n\t* The colour of the line represents the election state of the server. \n\t   - orange means LOOKING for leader\n\t   - dark green means the server is the leader\n\t   - light green means the server is following a leader\n\t   - yellow means there isn't enough information to determine the state of the server. \n\t* The gray arrows denote election messages between servers. Pink dashed arrows are messages that were sent but never delivered.\n\n   b) Session view\n      The session view shows the lifetime of sessions on a server. Use the time filter to narrow down the view. Any more than about 2000 events will take a long time to view in your browser. \n      The Y axis represents time in this case. Each line is a session. The black dots represent events on the session. You can click on the black dots for more details of the event.\n\n2 - Compiling & Running\n\nRun \"ant jar\" in src/contrib/zkgraph/. This will download all dependencies and compile all the zkgraph code.\n\nOnce compilation has finished, you can run it the the zkgraph.sh script in src/contrib/zkgraph/bin. This will start and embedded web server on you machine. Navigate to http://localhost:8182/graph/main.html.\n", "created_at" : { "$date" : "2010-05-11T15:20:18.662+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:19.513+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51885f627d6b0586b65c" }, "external_id" : "ZOOKEEPER-1103", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "tests" ], "fix_versions" : [ "3.3.4", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51885f627d6b0586b65d" }, "effect" : "is cloned by", "type" : "Cloners" } ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "created_at" : { "$date" : "2011-06-21T21:23:53.477+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "updated_at" : { "$date" : "2011-11-23T19:22:20.445+0000" }, "title" : "In QuorumTest, use the same \"for ( .. try { break } catch { } )\" pattern in testFollowersStartAfterLeaders as in testSessionMove.", "issue_type" : "Improvement", "desc" : "Patrick Hunt writes: \n\n\"Such uses of sleep [used in testFollowersStartAfterLeader] are just asking for trouble. Take a look at the use\nof sleep in testSessionMove in the same class for a better way to do\nthis. I had gone through all the tests a while back, replacing all the\n\"sleep(x)\" with something like this testSessionMove pattern (retry\nwith a max limit that's very long). During reviews we should look for\nanti-patterns like this and address them before commit.\"\n\nSo, modify testFollowersStartAfterLeaders to use the same retrying approach that testSessionMove uses.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d518b5f627d6b0586b6f3" }, "external_id" : "ZOOKEEPER-1238", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d518b5f627d6b0586b6f4" }, "external_id" : "ZOOKEEPER-1049", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Session expire/close flooding renders heartbeats to delay significantly", "desc" : "Let's say we have 100 clients (group A) already connected to three-node ZK ensemble with session timeout of 15 second.  And we have 1000 clients (group B) already connected to the same ZK ensemble, all watching several nodes (with 15 second session timeout)\n\nConsider a case in which All clients in group B suddenly hung or deadlocked (JVM OOME) all at the same time. 15 seconds later, all sessions in group B gets expired, creating session closing stampede. Depending on the number of this clients in group B, all request/response ZK ensemble should process get delayed up to 8 seconds (1000 clients we have tested).\n\nThis delay causes some clients in group A their sessions expired due to delay in getting heartbeat response. This causes normal servers to drop out of clusters. This is a serious problem in our installation, since some of our services running batch servers or CI servers creating the same scenario as above almost everyday.\n\nI am attaching a graph showing ping response time delay.\n\nI think ordering of creating/closing sessions and ping exchange isn't important (quorum state machine). at least ping request / response should be handle independently (different queue and different thread) to keep realtime-ness of ping.\n\nAs a workaround, we are raising session timeout to 50 seconds.\nBut this causes max. failover of cluster to significantly increased, thus initial QoS we promised cannot be met.\n\n\n\n\n\n\n\n", "created_at" : { "$date" : "2011-04-16T03:42:55.931+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:20.716+0000" }, "creator_id" : { "$oid" : "5b7d518be9214a0d1608d91b" }, "reporter_id" : { "$oid" : "5b7d518be9214a0d1608d91b" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d518be9214a0d1608d91b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d518b5f627d6b0586b6f3" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "CentOS 5.3, three node ZK ensemble" },
{ "_id" : { "$oid" : "5b7d51585f627d6b0586af23" }, "external_id" : "ZOOKEEPER-1006", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3" ], "components" : [ "tests" ], "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2011-03-03T17:38:18.493+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-11-23T19:22:20.927+0000" }, "title" : "QuorumPeer \"Address already in use\" -- regression in 3.3.3", "issue_type" : "Bug", "desc" : "CnxManagerTest.testWorkerThreads \n\nSee attachment, this is the first time I've seen this test fail, and it's failed 2 out of the last three test runs.\n\nNotice (attachment) once this happens the port never becomes available.\n\n{noformat}\n2011-03-02 15:53:12,425 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11245:NIOServerCnxn$Factory@251] - Accepted socket connection from /172.29.6.162:51441\n2011-03-02 15:53:12,430 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11245:NIOServerCnxn@639] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n2011-03-02 15:53:12,430 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11245:NIOServerCnxn@1435] - Closed socket connection for client /172.29.6.162:51441 (no session established for client)\n2011-03-02 15:53:12,430 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:11241:Follower@82] - Exception when following the leader\njava.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:375)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:84)\n\tat org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n\tat org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:148)\n\tat org.apache.zookeeper.server.quorum.Learner.registerWithLeader(Learner.java:267)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:66)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:645)\n2011-03-02 15:53:12,431 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11241:Follower@165] - shutdown called\njava.lang.Exception: shutdown Follower\n\tat org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:165)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:649)\n2011-03-02 15:53:12,432 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11241:QuorumPeer@621] - LOOKING\n2011-03-02 15:53:12,432 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11241:FastLeaderElection@663] - New election. My id =  0, Proposed zxid = 0\n2011-03-02 15:53:12,433 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 0 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 0 (n.sid), LOOKING (my state)\n2011-03-02 15:53:12,433 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 0 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 0 (n.sid), LOOKING (my state)\n2011-03-02 15:53:12,433 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 0 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 0 (n.sid), LOOKING (my state)\n2011-03-02 15:53:12,633 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 0 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 0 (n.sid), LOOKING (my state)\n2011-03-02 15:53:12,633 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11245:QuorumPeer@655] - LEADING\n2011-03-02 15:53:12,636 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11245:Leader@54] - TCP NoDelay set to: true\n2011-03-02 15:53:12,638 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:11245:ZooKeeperServer@151] - Created server with tickTime 1000 minSessionTimeout 2000 maxSessionTimeout 20000 datadir /var/lib/hudson/workspace/CDH3-ZooKeeper-3.3.3_sles/build/test/tmp/test9001250572426375869.junit.dir/version-2 snapdir /var/lib/hudson/workspace/CDH3-ZooKeeper-3.3.3_sles/build/test/tmp/test9001250572426375869.junit.dir/version-2\n2011-03-02 15:53:12,639 - ERROR [QuorumPeer:/0:0:0:0:0:0:0:0:11245:Leader@133] - Couldn't bind to port 11245\njava.net.BindException: Address already in use\n\tat java.net.PlainSocketImpl.socketBind(Native Method)\n\tat java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n\tat java.net.ServerSocket.bind(ServerSocket.java:319)\n\tat java.net.ServerSocket.<init>(ServerSocket.java:185)\n\tat java.net.ServerSocket.<init>(ServerSocket.java:97)\n\tat org.apache.zookeeper.server.quorum.Leader.<init>(Leader.java:131)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.makeLeader(QuorumPeer.java:512)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:657)\n{noformat}\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d518c5f627d6b0586b74a" }, "external_id" : "ZOOKEEPER-898", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C Client might not cleanup correctly during close", "desc" : "I was looking through the c-client code and noticed a situation where a counter can be incorrectly incremented and a small memory leak can occur.\n\nIn zookeeper.c : add_completion(), if close_requested is true, then the completion will not be queued.  But at the end, outstanding_sync is still incremented and free() never called on the newly allocated completion_list_t.  \n\nI will submit for review a diff that I believe corrects this issue.", "created_at" : { "$date" : "2010-10-14T19:35:57.620+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:20.045+0000" }, "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d516d5f627d6b0586b320" }, "external_id" : "ZOOKEEPER-789", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2010-06-18T21:01:19.257+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2011-11-23T19:22:20.254+0000" }, "title" : "Improve FLE log messages", "issue_type" : "Improvement", "desc" : "Notification messages are quite important to determine what is going with leader election. The main idea of this improvement is name the fields we output in notification log messages.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d518e5f627d6b0586b779" }, "external_id" : "ZOOKEEPER-1082", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "modify leader election to correctly take into account current epoch", "desc" : "when comparing zxids for leader election, the current epoch of the peer needs to be taken into account.", "created_at" : { "$date" : "2011-05-30T15:16:45.685+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:21.703+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51865f627d6b0586b5ec" } },
{ "_id" : { "$oid" : "5b7d518f5f627d6b0586b788" }, "external_id" : "ZOOKEEPER-1142", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "incorrect stat output", "desc" : "stat output seems to be missing some end of line:\n\n{noformat}\necho stat |nc c0309 2181\nZookeeper version: 3.4.0--1, built on 08/02/2011 22:25 GMT\nClients:\n /172.29.81.91:33378[0](queued=0,recved=1,sent=0\nLatency min/avg/max: 0/28/252\nReceived: 246844\nSent: 266737\nOutstanding: 0\nZxid: 0x4000508c2\nMode: follower\nNode count: 4\n{noformat}\n\nMultiple clients end up on the same line (missing newline)", "created_at" : { "$date" : "2011-08-03T00:29:06.612+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:21.553+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51905f627d6b0586b795" }, "external_id" : "ZOOKEEPER-1069", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Calling shutdown() on a QuorumPeer too quickly can lead to a corrupt log", "desc" : "I've only seen this happen once.  In order to restart Zookeeper with a new set of servers, we have a wrapper class that calls shutdown() on an existing QuorumPeer, and then starts a new one with a new set of servers.  Specifically, our shutdown code looks like this:\n\n{code}\n  synchronized(_quorum_peer) {\n    _quorum_peer.shutdown();\n    FastLeaderElection fle = (FastLeaderElection) _quorum_peer.getElectionAlg();\n    fle.shutdown();  // I think this is unnecessary\n    try {\n      _quorum_peer.getTxnFactory().commit();\n    } catch (java.nio.channels.ClosedChannelException e) {\n      // ignore\n    }\n  }\n{code}\n\nOne time, our wrapper class started one QuorumPeer, and then had to shut it down and start a new one very soon after the QuorumPeer transitioned into a FOLLOWING state.  When the new QuorumPeer tried to read in the latest log from disk, it encountered a bogus magic number of all zeroes:\n\n{noformat}\n2011-05-18 22:42:29,823 10467 [pool-1-thread-2] FATAL org.apache.zookeeper.server.quorum.QuorumPeer  - Unable to load database on disk\njava.io.IOException: Transaction log: /var/cloudnet/data/zookeeper/version-2/log.700000001 has invalid magic number 0 != 1514884167\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:510)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:527)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:493)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:576)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:479)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:454)\n        at org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:325)\n        at org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:126)\n        at org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:222)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:398)\n...\n2011-05-18 22:42:29,823 10467 [pool-1-thread-2] ERROR com.nicira.onix.zookeeper.Zookeeper  - Unexpected exception\njava.lang.RuntimeException: Unable to run quorum server \n        at org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:401)\n        at com.nicira.onix.zookeeper.Zookeeper.StartZookeeper(Zookeeper.java:198)\n        at com.nicira.onix.zookeeper.Zookeeper.RestartZookeeper(Zookeeper.java:277)\n        at com.nicira.onix.zookeeper.ZKRPCService.setServers(ZKRPC.java:83)\n        at com.nicira.onix.zookeeper.Zkrpc$ZKRPCService.callMethod(Zkrpc.java:8198)\n        at com.nicira.onix.rpc.RPC$10.run(RPC.java:534)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\nCaused by: java.io.IOException: Transaction log: /var/cloudnet/data/zookeeper/version-2/log.700000001 has invalid magic number 0 != 1514884167\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:510)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:527)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:493)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:576)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:479)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:454)\n        at org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:325)\n        at org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:126)\n        at org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:222)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:398)\n        ... 8 more\n{noformat}\n\nI looked into the code a bit, and I believe the problem comes from the fact that QuorumPeer.shutdown() does not join() on this before returning.  Here's the scenario I think can happen:\n\n# QuorumPeer.run() notices it is in the FOLLOWING state, makes a new Follower, and calls Follower.followLeader(), which starts connecting to the leader.\n# In the main program thread, QuorumPeer.shutdown() is called.\n# Through a complicated series of calls, this eventually leads to FollowerZooKeeperServer.shutdown() being called.\n# This method calls SyncRequestProcess.shutdown(), which joins on this and returns.  However, it's possible that the SyncRequestProcessor thread hasn't yet been started because followLeader() hasn't yet called Learner.syncWithLeader(), which hasn't yet called ZooKeeperServer.startup(), which actually starts the thread.  Thus, the join would have no request, though a requestOfDeath is added to the queued requests list (possibly behind other requests).\n# Back in the main thread, FileTxnSnapLog.commit() is called, which doesn't do much because the processor hasn't processed anything yet.\n# Finally, ZooKeeperServer.startup is called in the QuorumPeer.run() thread, starting up the SyncRequestProcessor thread.\n# That thread appends some request to the log.  The log doesn't exist yet, so it creates a new one, padding it with zeroes.\n# Now either the SyncRequestProcessor hits the requestOfDeath or the whole QuorumPeer object is deleted.  It exits that thread without ever committing the log to disk (or the new QuorumPeer tries to read the log before the old thread gets to commit anything), and the log ends up with all zeroes instead of a proper magic number.\n\nI haven't yet looked into whether there's an easy way to join() on the QuorumPeer thread from shutdown(), so that it won't go on to start the processor threads after it's been shutdown.  I wanted to check with the group first and see if anyone else agrees this could be a problem.\n\nI marked this as minor since I think almost no one else uses Zookeeper this way, but it's pretty important to me personally.\n\nI will upload a log file showing this behavior shortly.", "created_at" : { "$date" : "2011-05-23T23:53:31.183+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:21.908+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "quorum", "server" ], "labels" : [ "shutdown", "persistence" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d518f5f627d6b0586b794" }, "effect" : "duplicates", "type" : "Duplicate" } ], "environment" : "Linux, ZK 3.3.3, 3-node cluster." },
{ "_id" : { "$oid" : "5b7d51905f627d6b0586b7c8" }, "external_id" : "ZOOKEEPER-897", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C Client seg faults during close", "desc" : "We observed a crash while closing our c client.  It was in the do_io() thread that was processing as during the close() call.\n\n#0  queue_buffer (list=0x6bd4f8, b=0x0, add_to_front=0) at src/zookeeper.c:969\n#1  0x000000000046234e in check_events (zh=0x6bd480, events=<value optimized out>) at src/zookeeper.c:1687\n#2  0x0000000000462d74 in zookeeper_process (zh=0x6bd480, events=2) at src/zookeeper.c:1971\n#3  0x0000000000469c34 in do_io (v=0x6bd480) at src/mt_adaptor.c:311\n#4  0x00007ffff7bc59ca in start_thread () from /lib/libpthread.so.0\n#5  0x00007ffff6f706fd in clone () from /lib/libc.so.6\n#6  0x0000000000000000 in ?? ()\n\nWe tracked down the sequence of events, and the cause is that input_buffer is being freed from a thread other than the do_io thread that relies on it:\n\n1. do_io() call check_events()\n2. if(events&ZOOKEEPER_READ) branch executes\n3. if (rc > 0) branch executes\n4. if (zh->input_buffer != &zh->primer_buffer) branch executes\n.....in the meantime......\n     5. zookeeper_close() called\n     6. if (inc_ref_counter(zh,0)!=0) branch executes\n     7. cleanup_bufs() is called\n     8. input_buffer is freed at the end\n..... back to check_events().........\n9. queue_events() is called on a NULL buffer.\n\nI believe the patch is to only call free_completions() in zookeeper_close() and not cleanup_bufs().  The original reason cleanup_bufs() was added was to call any outstanding synhcronous completions, so only free_completions (which is guarded) is needed.  I will submit a patch for review with this change.", "created_at" : { "$date" : "2010-10-14T19:26:06.675+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:21.328+0000" }, "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51915f627d6b0586b7df" }, "external_id" : "ZOOKEEPER-1189", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "For an invalid snapshot file(less than 10bytes size) RandomAccessFile stream is leaking.", "desc" : "When loading the snapshot, ZooKeeper will consider only the 'snapshots with atleast 10 bytes size'. Otherwsie it will ignore and just return without closing the RandomAccessFile.\n\n{noformat}\nUtil.isValidSnapshot() having the following logic. \n       // Check for a valid snapshot\n        RandomAccessFile raf = new RandomAccessFile(f, \"r\");\n        // including the header and the last / bytes\n        // the snapshot should be atleast 10 bytes\n        if (raf.length() < 10) {\n            return false;\n        }\n{noformat}\n\nSince the snapshot file validation logic is outside try block, it won't go to the finally block and will be leaked.\n\nSuggestion: Move the validation logic to the try/catch block.", "created_at" : { "$date" : "2011-09-16T14:29:05.822+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:22.355+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51925f627d6b0586b7fa" }, "external_id" : "ZOOKEEPER-919", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral nodes remains in one of ensemble after deliberate SIGKILL", "desc" : "I was testing stability of Zookeeper ensemble for production deployment. Three node ensemble cluster configuration.\nIn a loop, I kill/restart three Zookeeper clients that created one ephemeral node each, and at the same time,\nI killed Java process on one of ensemble (dont' know if it was a leader or not). Then I restarted Zookeeper on the server,\n\nIt turns out that on two zookeeper ensemble servers, all the ephemeral nodes are gone (it should), but on the newly started\nZookeeper server, the two old ephemeral nodes stayed.  The zookeeper didn't restart in standalone mode since new ephemeral\nnodes gets created on all ensemble servers. \nI captured the log.\n\n\n2010-11-04 17:48:50,201 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:17288:NIOServerCnxn$Factory@250] - Accepted socket connection from /10.25.131.21:11191\n2010-11-04 17:48:50,202 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:17288:NIOServerCnxn@776] - Client attempting to establish new session at /10.25.131.21:11191\n2010-11-04 17:48:50,203 - INFO  [CommitProcessor:1:NIOServerCnxn@1579] - Established session 0x12c160c31fc000b with negotiated timeout 30000 for client /10.25.131.21:11191\n2010-11-04 17:48:50,206 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:17288:NIOServerCnxn@633] - EndOfStreamException: Unable to read additional data from client sessionid 0x12c160c31fc000b, likely client has closed socket\n2010-11-04 17:48:50,207 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:17288:NIOServerCnxn@1434] - Closed socket connection for client /10.25.131.21:11191 which had sessionid 0x12c160c31fc000b\n2010-11-04 17:48:50,207 - ERROR [CommitProcessor:1:NIOServerCnxn@444] - Unexpected Exception:\njava.nio.channels.CancelledKeyException\n        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n        at sun.nio.ch.SelectionKeyImpl.interestOps(SelectionKeyImpl.java:59)\n        at org.apache.zookeeper.server.NIOServerCnxn.sendBuffer(NIOServerCnxn.java:417)\n        at org.apache.zookeeper.server.NIOServerCnxn.sendResponse(NIOServerCnxn.java:1508)\n        at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:367)\n        at org.apache.zookeeper.server.quorum.CommitProcessor.run(CommitProcessor.java:73)\n", "created_at" : { "$date" : "2010-11-04T13:43:21.307+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:22.523+0000" }, "creator_id" : { "$oid" : "5b7d518be9214a0d1608d91b" }, "reporter_id" : { "$oid" : "5b7d518be9214a0d1608d91b" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.3.3", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51925f627d6b0586b7f9" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "Linux CentOS 5.3 64bit, JDK 1.6.0-22\nSLES 11" },
{ "_id" : { "$oid" : "5b7d51935f627d6b0586b82b" }, "external_id" : "ZOOKEEPER-764", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Observer elected leader due to inconsistent voting view", "desc" : "In ZOOKEEPER-690, we noticed that an observer was being elected, and Henry proposed a patch to fix the issue. However, it seems that the patch does not solve the issue one user (Alan Cabrera) has observed. Given that we would like to fix this issue, and to work separately with Alan to determine the problem with his setup, I'm creating this jira and re-posting Henry's patch.", "created_at" : { "$date" : "2010-05-04T21:41:07.938+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:22.736+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51935f627d6b0586b82a" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51935f627d6b0586b83b" }, "external_id" : "HADOOP-6666", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50c35f627d6b0586a4c8" }, "external_id" : "ZOOKEEPER-724", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "tests" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50505f627d6b0586981e" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51935f627d6b0586b83b" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2010-03-23T21:54:03.403+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-11-23T19:22:22.891+0000" }, "title" : "Improve junit test integration - log harness information", "issue_type" : "Improvement", "desc" : "Currently we have ad-hoc logging (log4j) of setup/teardown and test start/end. Without this information it's often difficult to determine\nwhat's going on (major milestones) in the logs relative to the tests performed.\n\nIn junit 4.x \"@Rule\" annotations have been added that allow this to be done much more easily. This patch will add this.\n\nIn particular we can access the test name easily during setup/teardown and the test itself. Additionally we can log more information on\nsuccess/failure of each test.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51945f627d6b0586b849" }, "external_id" : "ZOOKEEPER-1028", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "In python bindings, zookeeper.set2() should return a stat dict but instead returns None", "desc" : "There is a small bug in the python bindings, specifically with the zookeeper.set2() call. This method should return a stat dictionary, but actually returns None. The fix is a one-character change to zookeeper.c such that the return value is '&stat' rather than 'stat'.", "created_at" : { "$date" : "2011-03-24T20:26:04.374+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:23.304+0000" }, "creator_id" : { "$oid" : "5b7d5194e9214a0d1608d91d" }, "reporter_id" : { "$oid" : "5b7d5194e9214a0d1608d91d" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "contrib-bindings" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5194e9214a0d1608d91d" }, "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "All environments." },
{ "_id" : { "$oid" : "5b7d51955f627d6b0586b862" }, "external_id" : "ZOOKEEPER-994", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "\"eclipse\" target in the build script doesnot include libraray required for test classes in the classpath", "desc" : "The \"eclipse\" target in the zoo-keeper build script doesn't include the accessive.jar present in the folder /src/java/libtest in the .classpath file. But the accessive.jar is being referenced from a couple of test classes.\nHowever, the build is successful :)\n", "created_at" : { "$date" : "2011-02-17T19:38:49.082+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:23.474+0000" }, "creator_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "reporter_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5105e9214a0d1608d8d8" }, "issue_links" : [  ], "original_time_estimate" : 1800, "environment" : "Linux box, Eclipse IDE" },
{ "_id" : { "$oid" : "5b7d51965f627d6b0586b873" }, "external_id" : "ZOOKEEPER-741", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "root level create on REST proxy fails", "desc" : "Create /foo using the REST proxy fails.\n\nAlso upgrade to the latest Jersey/Grizzly while we are at it (fixes for func/security)", "created_at" : { "$date" : "2010-04-14T17:12:17.828+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:23.078+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51965f627d6b0586b87f" }, "external_id" : "ZOOKEEPER-749", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "OSGi metadata not included in binary only jar", "desc" : "See this JIRA/comment for background:\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-425?focusedCommentId=12859697&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12859697\n\nbasically the issue is that OSGi metadata is included in the legacy jar (zookeeper-<version>.jar) but not in the binary only\njar (zookeeper-<version>-bin.jar) which is eventually deployed to the maven repo.\n", "created_at" : { "$date" : "2010-04-22T16:21:07.105+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:23.990+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51965f627d6b0586b87e" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51965f627d6b0586b87d" }, "effect" : "incorporates", "type" : "Incorporates" } ] },
{ "_id" : { "$oid" : "5b7d51975f627d6b0586b88e" }, "external_id" : "ZOOKEEPER-1030", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51975f627d6b0586b88f" }, "external_id" : "ZOOKEEPER-1073", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "address a documentation issue in ZOOKEEPER-1030", "desc" : "ZOOKEEPER-1030 updated the generated docs, not the source docs. I'll submit a patch to address in the src.", "created_at" : { "$date" : "2011-05-25T17:52:08.061+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:24.195+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51975f627d6b0586b88e" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51985f627d6b0586b89c" }, "external_id" : "ZOOKEEPER-1059", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stat command isses on non-existing node causes NPE ", "desc" : "*stat* command issues on non existing zookeeper node,causes NPE to the client.\n{noformat}\n[zk: localhost:2181(CONNECTED) 2] stat /invalidPath\nException in thread \"main\" java.lang.NullPointerException\n        at org.apache.zookeeper.ZooKeeperMain.printStat(ZooKeeperMain.java:131)\n        at org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:723)\n        at org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:582)\n        at org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:354)\n        at org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:312)\n        at org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:271)\n\n{noformat}", "created_at" : { "$date" : "2011-05-04T10:50:42.099+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:24.354+0000" }, "creator_id" : { "$oid" : "5b7d5198e9214a0d1608d91e" }, "reporter_id" : { "$oid" : "5b7d5198e9214a0d1608d91e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5198e9214a0d1608d91e" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510f5f627d6b0586a92a" }, "external_id" : "ZOOKEEPER-1109", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3", "3.3.1", "3.3.0", "3.3.2" ], "components" : [ "quorum" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d510f5f627d6b0586a92b" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "created_at" : { "$date" : "2011-06-24T04:48:18.960+0000" }, "original_time_estimate" : 259200, "priority" : "Critical", "desc" : "*Problem* Zookeeper is not shut down completely when dataDir disk space is full and ZK Cluster went into unserviceable state.\n \n\n*Scenario*\nIf the leader zookeeper disk is made full, the zookeeper is trying to shutdown. But it is waiting indefinitely while shutting down the SyncRequestProcessor thread.\n\n*Root Cause* \nthis.join() is invoked in the same thread where System.exit(11) has been triggered.\n\nWhen disk space full happens, It got the exception as follows 'No space left on device' and invoked System.exit(11) from the SyncRequestProcessor thread(The following logs shows the same). Before exiting JVM, ZK will execute the ShutdownHook of QuorumPeerMain and the flow comes to SyncRequestProcessor.shutdown(). Here this.join() is invoked in the same thread where System.exit(11) has been invoked.\n", "reporter_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "updated_at" : { "$date" : "2011-11-23T19:22:24.926+0000" }, "title" : "Zookeeper service is down when SyncRequestProcessor meets any exception.", "issue_type" : "Bug", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51925f627d6b0586b7f9" }, "external_id" : "ZOOKEEPER-962", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "fix_versions" : [ "3.3.3", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51925f627d6b0586b7fa" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5110e9214a0d1608d8e4" }, "created_at" : { "$date" : "2010-12-21T18:42:59.384+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "updated_at" : { "$date" : "2011-11-23T19:22:24.763+0000" }, "title" : "leader/follower coherence issue when follower is receiving a DIFF", "issue_type" : "Bug", "desc" : "From mailing list:\nIt seems like we rely on the LearnerHandler thread startup to capture all of the missing committed\ntransactions in the SNAP or DIFF, but I don't see anything (especially in the DIFF case) that\nis preventing us for committing more transactions before we actually start forwarding updates\nto the new follower.\n\nLet me explain using my example from ZOOKEEPER-919. Assume we have quorum already, so the\nleader can be processing transactions while my follower is starting up.\n\nI'm a follower at zxid N-5, the leader is at N. I send my FOLLOWERINFO packet to the leader\nwith that information. The leader gets the proposals from its committed log (time T1), then\nsyncs on the proposal list (LearnerHandler line 267. Why? It's a copy of the underlying proposal\nlist... this might be part of our problem). I check to see if the peerLastZxid is within my\nmax and min committed log and it is, so I'm going to send a diff. I set the zxidToSend to\nbe the maxCommittedLog at time T3 (we already know this is sketchy), and forward the proposals\nfrom my copied proposal list starting at the peerLastZxid+1 up to the last proposal transaction\n(as seen at time T1).\n\nAfter I have queued up all those diffs to send, I tell the leader to startFowarding updates\nto this follower (line 308). \n\nSo, let's say that at time T2 I actually swap out the leader to the thread that is handling\nthe various request processors, and see that I got enough votes to commit zxid N+1. I commit\nN+1 and so my maxCommittedLog at T3 is N+1, but this proposal is not in the list of proposals\nthat I got back at time T1, so I don't forward this diff to the client. Additionally, I processed\nthe commit and removed it from my leader's toBeApplied list. So when I call startForwarding\nfor this new follower, I don't see this transaction as a transaction to be forwarded. \n\nThere's one problem. Let's also imagine, however, that I commit N+1 at time T4. The maxCommittedLog\nvalue is consistent with the max of the diff packets I am going to send the follower. But,\nI still committed N+1 and removed it from the toBeApplied list before calling startFowarding\nwith this follower. How does the follower get this transaction? Does it?\n\nTo put it another way, here is the thread interaction, hopefully formatted so you can read\nit...\n\n\t\tLearnerHandlerThread\t\t\t\t\tRequestProcessorThread\nT1(LH):\tget list of proposals (COPY)\nT2(RPT):\t\t\t\t\t\t\t\tcommit N+1, remove from toBeApplied\nT3(LH):\tget maxCommittedLog\nT4(LH):\tsend diffs from view at T1\nT5(LH):\tstartForwarding\n\n\nOr\nT1(LH):\tget list of proposals (COPY)\nT2(LH):\tget maxCommittedLog\nT3(RPT):\t\t\t\t\t\t\t\tcommit N+1, remove from toBeApplied\nT4(LH):\tsend diffs from view at T1\nT5(LH):\tstartFowarding\n\n\nI'm trying to figure out what, if anything, keeps the requests from being committed, removed,\nand never seen by the follower before it fully starts up. \n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d519a5f627d6b0586b916" }, "external_id" : "ZOOKEEPER-904", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "super digest is not actually acting as a full superuser", "desc" : "The documentation states:\nNew in 3.2:  Enables a ZooKeeper ensemble administrator to access the znode hierarchy as a \"super\" user. In particular no ACL checking occurs for a user authenticated as super.\n\nHowever, if a super user does something like:\nzk.setACL(\"/\", Ids.READ_ACL_UNSAFE, -1);\n\nthe super user is now bound by read-only ACL. This is not what I would expect to see given the documentation. It can be fixed by moving the chec for the \"super\" authId in PrepRequestProcessor.checkACL to before the for(ACL a : acl) loop.", "created_at" : { "$date" : "2010-10-19T20:44:01.011+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:24.586+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d519c5f627d6b0586b929" }, "external_id" : "ZOOKEEPER-1169", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix compiler (eclipse) warnings in (generated) jute code", "desc" : "Fixes for compiled jute parser:\n- missing generic types\n- added @SuppressWarnings(\"unused\") because javacc adds a dead throws clause at the\n      end of functions.\n\nFixes for code compiled by jute compiler:\n- remove import java.util.* and use full ref to java.util.Arrays\n\nOne warning fixed in non-compiled code:\nsrc/java/main/org/apache/jute/compiler/JRecord.java\n\nRationale: The warnings in your IDE (eclipse) get useless if there are tons of them. This patch reduces many of them. Another issue with patch will reduce them to 8.", "created_at" : { "$date" : "2011-09-02T18:39:10.923+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:25.564+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d519c5f627d6b0586b937" }, "external_id" : "ZOOKEEPER-1153", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Deprecate AuthFLE and LE", "desc" : "I propose we mark these as deprecated in 3.4.0 and remove them in the following release.", "created_at" : { "$date" : "2011-08-15T09:33:07.502+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:25.335+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d519d5f627d6b0586b946" }, "external_id" : "ZOOKEEPER-1042", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Generate zookeeper test jar for maven installation", "desc" : "Bookkeeper and hedwig both need access to zookeeper test classes. This JIRA is to provide that.", "created_at" : { "$date" : "2011-03-31T15:37:40.203+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:25.824+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51025f627d6b0586a87a" } },
{ "_id" : { "$oid" : "5b7d50ff5f627d6b0586a827" }, "external_id" : "ZOOKEEPER-1018", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.2" ], "components" : [ "c client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ff5f627d6b0586a828" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "created_at" : { "$date" : "2011-03-15T12:47:55.343+0000" }, "original_time_estimate" : 7200, "priority" : "Minor", "desc" : "After determining all of the addresses in the get_addrs function in the C client, the connection is permuted using the following code:\n\n        setup_random();\n        /* Permute */\n        for(i = 0; i < zh->addrs_count; i++) {\n            struct sockaddr_storage *s1 = zh->addrs + random()%zh->addrs_count;\n            struct sockaddr_storage *s2 = zh->addrs + random()%zh->addrs_count;\n            if (s1 != s2) {\n                struct sockaddr_storage t = *s1;\n                *s1 = *s2;\n                *s2 = t;\n            }\n        }\n\nNot only does this shuffle produce an uneven permutation, but it is half as efficient as the Fisher-Yates shuffle which produces an unbiased one. It seems like it would be a simple fix to increase the randomness and efficiency of the shuffle by switching over to using Fisher-Yates.", "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "updated_at" : { "$date" : "2011-11-23T19:22:25.198+0000" }, "title" : "The connection permutation in get_addrs uses a weak and inefficient shuffle", "issue_type" : "Improvement", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d519f5f627d6b0586b98e" }, "external_id" : "ZOOKEEPER-1203", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper systest is missing Junit Classes ", "desc" : "For running these tests, I am following instructions on https://github.com/apache/zookeeper/blob/trunk/src/java/systest/README.txt \n\nIn Step 4, when I try to run java -jar build/contrib/fatjar/zookeeper-<version>-fatjar.jar systest org.apache.zookeeper.test.system.SimpleSysTest , it throws the following error,\n\nException in thread \"main\" java.lang.NoClassDefFoundError: junit/framework/TestCase\n\nThe problem is that zookeeper-dev-fatjar.jar does not contain the TestCase class.\n\nPatrick Hunt suggested that adding <zipgroupfileset dir=\"${zk.root}/build/test/lib\" includes=\"*.jar\" /> to fatjar/build.xml should solve the problem and it does.", "created_at" : { "$date" : "2011-09-23T22:44:59.022+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:26.620+0000" }, "creator_id" : { "$oid" : "5b7d519fe9214a0d1608d91f" }, "reporter_id" : { "$oid" : "5b7d519fe9214a0d1608d91f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d519fe9214a0d1608d91f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d511f5f627d6b0586aa30" }, "external_id" : "ZOOKEEPER-1055", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51a05f627d6b0586b9a0" }, "effect" : "is blocked by", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d511e5f627d6b0586aa06" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "created_at" : { "$date" : "2011-04-26T21:08:47.328+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "updated_at" : { "$date" : "2011-11-23T19:22:26.208+0000" }, "title" : "check for duplicate ACLs in addACL() and create()", "issue_type" : "Bug", "desc" : "actual result:\n\n\n[zk: (CONNECTED) 0] create /test2 'test2' digest:test:test:cdrwa,digest:test:test:cdrwa\nCreated /test2\n[zk: (CONNECTED) 1] getAcl /test2\n'digest,'test:test\n: cdrwa\n'digest,'test:test\n: cdrwa\n[zk: (CONNECTED) 2]\n\nbut getAcl should only have a single entry.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51a15f627d6b0586b9d4" }, "external_id" : "ZOOKEEPER-1124", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Multiop submitted to non-leader always fails due to timeout", "desc" : "The new Multiop support added under zookeeper-965 fails every single time if the multiop is submitted to a non-leader in quorum mode. In standalone mode it always works properly and this bug only presents itself in quorum mode (with 2 or more nodes). After 12 hours of debugging (*sigh*) it turns out to be a really simple fix. There are a couple of missing case statements inside FollowerRequestProcessor.java and ObserverRequestProcessor.java to ensure that multiop is forwarded to the leader for commit. I've attached a patch that fixes this problem.\n\nIt's probably worth nothing that zookeeper-965 has already been committed to trunk. But this is a fatal flaw that will prevent multiop support from working properly and as such needs to get committed to 3.4.0 as well. Is there a way to tie these two cases together in some way?", "created_at" : { "$date" : "2011-07-13T16:17:58.307+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:26.030+0000" }, "creator_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "reporter_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51a15f627d6b0586b9d3" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "all" },
{ "_id" : { "$oid" : "5b7d51a25f627d6b0586b9f5" }, "external_id" : "ZOOKEEPER-985", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Test BookieRecoveryTest fails on trunk.", "desc" : "The unit test fails on trunk on my mac. I think this might be the same on other platforms as well. Ill attach the error logs.", "created_at" : { "$date" : "2011-02-09T19:24:51.381+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:26.843+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "environment" : "Darwin moststock-lm 9.7.0 Darwin Kernel Version 9.7.0: Tue Mar 31 22:52:17 PDT 2009; root:xnu-1228.12.14~1/RELEASE_I386 i386 (mac)." },
{ "_id" : { "$oid" : "5b7d51a15f627d6b0586b9d3" }, "external_id" : "ZOOKEEPER-965", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51a15f627d6b0586b9d4" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50f45f627d6b0586a7c2" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "created_at" : { "$date" : "2010-12-28T00:18:46.679+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "updated_at" : { "$date" : "2011-11-23T19:22:26.427+0000" }, "title" : "Need a multi-update command to allow multiple znodes to be updated safely", "issue_type" : "New Feature", "desc" : "The basic idea is to have a single method called \"multi\" that will accept a list of create, delete, update or check objects each of which has a desired version or file state in the case of create.  If all of the version and existence constraints can be satisfied, then all updates will be done atomically.\n\nTwo API styles have been suggested.  One has a list as above and the other style has a \"Transaction\" that allows builder-like methods to build a set of updates and a commit method to finalize the transaction.  This can trivially be reduced to the first kind of API so the list based API style should be considered the primitive and the builder style should be implemented as syntactic sugar.\n\nThe total size of all the data in all updates and creates in a single transaction should be limited to 1MB.\n\nImplementation-wise this capability can be done using standard ZK internals.  The changes include:\n\n- update to ZK clients to all the new call\n\n- additional wire level request\n\n- on the server, in the code that converts transactions to idempotent form, the code should be slightly extended to convert a list of operations to idempotent form.\n\n- on the client, a down-rev server that rejects the multi-update should be detected gracefully and an informative exception should be thrown.\n\nTo facilitate shared development, I have established a github repository at https://github.com/tdunning/zookeeper  and am happy to extend committer status to anyone who agrees to donate their code back to Apache.  The final patch will be attached to this bug as normal.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51a55f627d6b0586bb0e" }, "external_id" : "ZOOKEEPER-909", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Extract NIO specific code from ClientCnxn", "desc" : "This patch is mostly the same patch as my last one for ZOOKEEPER-823 minus everything Netty related. This means this patch only extract all NIO specific code in the class ClientCnxnSocketNIO which extends ClientCnxnSocket.\nI've redone this patch from current trunk step by step now and couldn't find any logical error. I've already done a couple of successful test runs and will continue to do so this night.\n\nIt would be nice, if we could apply this patch as soon as possible to trunk. This allows us to continue to work on the netty integration without blocking the ClientCnxn class. Adding Netty after this patch should be only a matter of adding the ClientCnxnSocketNetty class with the appropriate test cases.\n\nYou could help me by reviewing the patch and by running it on whatever test server you have available. Please send me any complete failure log you should encounter to thomas at koch point ro. Thx!\n\nUpdate: Until now, I've collected 8 successful builds in a row!", "created_at" : { "$date" : "2010-10-21T13:26:47.124+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:27.744+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50e95f627d6b0586a6f9" } },
{ "_id" : { "$oid" : "5b7d51a65f627d6b0586bb45" }, "external_id" : "ZOOKEEPER-822", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader election taking a long time  to complete", "desc" : "Created a 3 node cluster.\n\n1 Fail the ZK leader\n2. Let leader election finish. Restart the leader and let it join the \n3. Repeat \n\nAfter a few rounds leader election takes anywhere 25- 60 seconds to finish. Note- we didn't have any ZK clients and no new znodes were created.\n\nzoo.cfg is shown below:\n\n#Mon Jul 19 12:15:10 UTC 2010\nserver.1=192.168.4.12\\:2888\\:3888\nserver.0=192.168.4.11\\:2888\\:3888\nclientPort=2181\ndataDir=/var/zookeeper\nsyncLimit=2\nserver.2=192.168.4.13\\:2888\\:3888\ninitLimit=5\ntickTime=2000\n\nI have attached logs from two nodes that took a long time to form the cluster after failing the leader. The leader was down anyways so logs from that node shouldn't matter.\nLook for \"START HERE\". Logs after that point should be of our interest.", "created_at" : { "$date" : "2010-07-19T15:51:01.628+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:27.259+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f75f627d6b0586a7e3" }, "external_id" : "ZOOKEEPER-769", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.0" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f75f627d6b0586a7e4" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "created_at" : { "$date" : "2010-05-06T18:01:46.082+0000" }, "priority" : "Major", "desc" : "In short: it seems leader can treat observers as quorum members.\n\nSteps to repro:\n\n1. Server configuration: 3 voters, 2 observers (attached).\n2. Bring up 2 voters and one observer. It's enough for quorum.\n3. Shut down the one from the quorum who is the follower.\n\nAs I understand, expected result is that leader will start a new election round so that to regain quorum.\nBut the real situation is that it just says goodbye to that follower, and is still operable. (When I'm shutting down 3rd one -- observer -- leader starts trying to regain a quorum).\n\n(Expectedly, if on step 3 we shut down the leader, not the follower, remaining follower starta new leader election, as it should be).", "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "updated_at" : { "$date" : "2011-11-23T19:22:27.092+0000" }, "title" : "Leader can treat observers as quorum members", "issue_type" : "Bug", "environment" : "Ubuntu Karmic x64", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51a85f627d6b0586bbcd" }, "external_id" : "ZOOKEEPER-754", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "numerous misspellings \"succesfully\"", "desc" : "When testing the debian package of zookeeper with the standard tool \"lintian\", it fills my screen with complains about the misspelling of \"succesfully\" in several places of the zkpython contrib. Please be so kind to correct this, when you touch the code the next time. Thanks!", "created_at" : { "$date" : "2010-04-27T12:57:27.784+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:27.444+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib-bindings", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51a85f627d6b0586bbe2" }, "external_id" : "ZOOKEEPER-465", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ledger size in bytes", "desc" : "It is currently easy to know how many entries a ledger has, but there is no easy way to know the total number of bytes in a ledger. The idea of this jira is to add a method that gives the number of bytes in a closed ledger. My current idea is to simply have the writer counting the number of bytes written and store it to ZooKeeper.  ", "created_at" : { "$date" : "2009-07-13T20:24:41.567+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:27.908+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51a95f627d6b0586bc1a" }, "external_id" : "ZOOKEEPER-1143", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "quorum send & recv workers are missing thread names", "desc" : "Simplifies debugging.", "created_at" : { "$date" : "2011-08-03T21:27:00.480+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:28.872+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51aa5f627d6b0586bc26" }, "external_id" : "ZOOKEEPER-1138", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "release audit failing for a number of new files", "desc" : "I'm seeing a number of problems in the release audit output for 3.4.0, these must be fixed before 3.4.0 release:\n\n{noformat}\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/contrib/ZooInspector/config/defaultConnectionSettings.cfg\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/contrib/ZooInspector/config/defaultNodeVeiwers.cfg\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/contrib/ZooInspector/licences/epl-v10.html\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/c/Cli.vcproj\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/c/include/winconfig.h\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/c/include/winstdint.h\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/c/zookeeper.sln\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/c/zookeeper.vcproj\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/huebrowser/zkui/src/zkui/static/help/index.html\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/huebrowser/zkui/src/zkui/static/js/package.yml\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/log4j.properties\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/date.format.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/g.bar.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/g.dot.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/g.line.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/g.pie.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/g.raphael.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/raphael.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/loggraph/web/org/apache/zookeeper/graph/resources/yui-min.js\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/monitoring/JMX-RESOURCES\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/zooinspector/config/defaultConnectionSettings.cfg\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/zooinspector/config/defaultNodeVeiwers.cfg\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/zooinspector/lib/log4j.properties\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/contrib/zooinspector/licences/epl-v10.html\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/java/test/org/apache/zookeeper/MultiTransactionRecordTest.java\n[rat:report]  !????? /grid/0/hudson/hudson-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/build/zookeeper-3.4.0/src/java/test/org/apache/zookeeper/server/quorum/LearnerTest.java\nLines that start with ????? in the release audit report indicate files that do not have an Apache license header.\n{noformat}\n", "created_at" : { "$date" : "2011-07-27T20:04:23.541+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:28.473+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51aa5f627d6b0586bc31" }, "external_id" : "ZOOKEEPER-1101", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Upload zookeeper-test maven artifacts to maven repository.", "desc" : "These are generated by ant package since ZOOKEEPER-1042, they just need to be pushed to a maven repo. Bookkeeper requires this package to build.", "created_at" : { "$date" : "2011-06-21T17:15:16.007+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:28.630+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ab5f627d6b0586bc3c" }, "external_id" : "ZOOKEEPER-963", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make Forrest work with JDK6", "desc" : "It's possible to make Forrest work with JDK6 by disabling sitemap validation\nin the forrest.properties file. See FOR-984 and PIG-1508 for more details.", "created_at" : { "$date" : "2010-12-23T08:34:39.437+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:28.089+0000" }, "creator_id" : { "$oid" : "5b7d51abe9214a0d1608d922" }, "reporter_id" : { "$oid" : "5b7d51abe9214a0d1608d922" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d51abe9214a0d1608d922" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51ab5f627d6b0586bc3b" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51ac5f627d6b0586bc4d" }, "external_id" : "ZOOKEEPER-967", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Server side decoding and function dispatch", "desc" : "This would include making the server catch the request and hand it down to the actual transaction code", "created_at" : { "$date" : "2010-12-29T07:05:18.367+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:28.325+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51a15f627d6b0586b9d3" } },
{ "_id" : { "$oid" : "5b7d51ac5f627d6b0586bc54" }, "external_id" : "ZOOKEEPER-1076", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some quorum tests are unnecessarily extending QuorumBase", "desc" : "Some tests are unnecessarily extending QuorumBase. Typically this is not a big issue, but it may cause more servers than necessary to be started (harder to debug a failing test in particular).\n", "created_at" : { "$date" : "2011-05-25T22:19:48.130+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:29.154+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ad5f627d6b0586bc68" }, "external_id" : "ZOOKEEPER-1291", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "AcceptedEpoch not updated at leader before it proposes the epoch to followers", "desc" : "It is possible that a leader proposes an epoch e and a follower adopts it by setting acceptedEpoch to e but the leader itself hasn't yet done so. \n\nWhile I'm not sure this contradicts Zab (there is no description of where the leader actually sets its acceptedEpoch), it is very counter intuitive.\n\nThe fix is to set acceptedEpoch in getEpochToPropose, i.e., before anyone LearnerHandler passes the getEpochToPropose barrier.\n\nThe fix is done as part of ZK-1264", "created_at" : { "$date" : "2011-11-05T20:01:40.617+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:29.384+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51ad5f627d6b0586bc67" } },
{ "_id" : { "$oid" : "5b7d51ae5f627d6b0586bc72" }, "external_id" : "ZOOKEEPER-907", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Spurious \"KeeperErrorCode = Session moved\" messages", "desc" : "The sync request does not set the session owner in Request.\n\nAs a result, the leader keeps printing:\n2010-07-01 10:55:36,733 - INFO  [ProcessThread:-1:PrepRequestProcessor@405] - Got user-level KeeperException when processing sessionid:0x298d3b1fa90000 type:sync: cxid:0x6 zxid:0xfffffffffffffffe txntype:unknown reqpath:/ Error Path:null Error:KeeperErrorCode = Session moved\n", "created_at" : { "$date" : "2010-10-20T18:27:19.110+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:29.006+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51ae5f627d6b0586bc71" }, "effect" : "is blocked by", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d50e35f627d6b0586a66a" }, "external_id" : "ZOOKEEPER-893", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "fix_versions" : [ "3.3.2", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50575f627d6b05869907" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50e3e9214a0d1608d8c6" }, "priority" : "Critical", "created_at" : { "$date" : "2010-10-11T07:15:55.382+0000" }, "original_time_estimate" : 3600, "updated_at" : { "$date" : "2011-11-23T19:22:29.720+0000" }, "environment" : "Linux 2.6.16\n4x Intel(R) Xeon(R) CPU X3320  @ 2.50GHz\njava version \"1.6.0_17\"\nJava(TM) SE Runtime Environment (build 1.6.0_17-b04)\nJava HotSpot(TM) Server VM (build 14.3-b01, mixed mode)", "reporter_id" : { "$oid" : "5b7d50e3e9214a0d1608d8c6" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e3e9214a0d1608d8c6" }, "issue_type" : "Bug", "title" : "ZooKeeper high cpu usage when invalid requests", "desc" : "When ZooKeeper receives certain illegally formed messages on the internal communication port (:4181 by default), it's possible for ZooKeeper to enter an infinite loop which causes 100% cpu usage. It's related to ZOOKEEPER-427, but that patch does not resolve all issues.\n\nfrom: src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java \n\nthe two affected parts:\n===========\nint length = msgLength.getInt();                                                        \nif(length <= 0) {                                                                       \n    throw new IOException(\"Invalid packet length:\" + length);                           \n} \n===========\n\n\n===========\nwhile (message.hasRemaining()) {                                                    \n    temp_numbytes = channel.read(message);                                          \n    if(temp_numbytes < 0) {                                                         \n        throw new IOException(\"Channel eof before end\");                            \n    }                                                                               \n    numbytes += temp_numbytes;                                                      \n} \n===========\n\nhow to replicate this bug:\n\nperform an nmap portscan against your zookeeper server: \"nmap -sV -n your.ip.here -p4181\"\nwait for a while untill you see some messages in the logfile and then you will see 100% cpu usage. It does not recover from this situation. With my patch, it does not occur anymore", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51b05f627d6b0586bcb5" }, "external_id" : "ZOOKEEPER-882", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Startup loads last transaction from snapshot", "desc" : "On startup, the server first loads the latest snapshot, and then loads from the log starting at the last transaction in the snapshot.  It should begin from one past that last transaction in the log.  I will attach a possible patch.", "created_at" : { "$date" : "2010-09-28T23:46:36.080+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:29.552+0000" }, "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51b15f627d6b0586bcde" }, "external_id" : "ZOOKEEPER-1091", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "when the chrootPath of ClientCnxn is not null and the Watches of zooKeeper is not null and the method primeConnection(SelectionKey k) of ClientCnxn Occurred again for some reason ,then the wrong watcher clientPath is sended to server", "desc" : "if the chrootPath of ClientCnxn is not null and the Watches of zooKeeper is not null; and then for some reason(like zookeeper server stop and start), the zookeeper client will primeConnection to server again and tell server the watcher path,but the path is wrong,it show be serverpath but not clientpath;if the wrong watcher clientPath is sended to server,\nthe exception will occurr, the exceptions:\n\n2011-06-10 04:33:16,935 [pool-2-thread-30-SendThread(DB1-6:2181)] WARN  org.apache.zookeeper.ClientCnxn - Session 0x5302c4403a30232 for server DB1-6/192.168.1.6:2181, unexpected error, closing socket connection and attempting reconnect\njava.lang.StringIndexOutOfBoundsException: String index out of range: -6\n\tat java.lang.String.substring(String.java:1937)\n\tat java.lang.String.substring(String.java:1904)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:794)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:881)\n\tat org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1130)\n ", "created_at" : { "$date" : "2011-06-10T03:21:23.876+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:30.401+0000" }, "creator_id" : { "$oid" : "5b7d51b1e9214a0d1608d923" }, "reporter_id" : { "$oid" : "5b7d51b1e9214a0d1608d923" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "Linux version 2.6.18-194.el5 (mockbuild@builder10.centos.org) (gcc version 4.1.2 20080704 (Red Hat 4.1.2-48)) #1 SMP Fri Apr 2 14:58:14 EDT 2010" },
{ "_id" : { "$oid" : "5b7d51b15f627d6b0586bce8" }, "external_id" : "ZOOKEEPER-968", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Database multi-update", "desc" : "This includes the database operations themselves", "created_at" : { "$date" : "2010-12-29T07:06:10.833+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:30.686+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51a15f627d6b0586b9d3" } },
{ "_id" : { "$oid" : "5b7d51865f627d6b0586b5ec" }, "external_id" : "ZOOKEEPER-335", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.1.0" ], "components" : [ "server" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51b25f627d6b0586bcf4" }, "effect" : "breaks", "type" : "Regression" }, { "issue_id" : { "$oid" : "5b7d51865f627d6b0586b5ed" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-03-04T18:55:48.570+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2011-11-23T19:22:30.010+0000" }, "title" : "zookeeper servers should commit the new leader txn to their logs.", "issue_type" : "Bug", "desc" : "currently the zookeeper followers do not commit the new leader election. This will cause problems in a failure scenarios with a follower acking to the same leader txn id twice, which might be two different intermittent leaders and allowing them to propose two different txn's of the same zxid.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51935f627d6b0586b82a" }, "external_id" : "ZOOKEEPER-690", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51935f627d6b0586b82b" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2010-03-09T01:42:31.306+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Cannot Reproduce", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2011-11-23T19:22:30.851+0000" }, "title" : "AsyncTestHammer test fails on hudson.", "issue_type" : "Bug", "desc" : "the hudson test failed on http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/2/testReport/. There are huge set of cancelledkeyexceptions in the logs. Still going through the logs to find out the reason for failure.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51b45f627d6b0586bd93" }, "external_id" : "ZOOKEEPER-662", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Too many CLOSE_WAIT socket state on a server", "desc" : "I have a zookeeper cluster with 5 servers, zookeeper version 3.2.1, here is the content in the configure file, zoo.cfg\n\n======\n# The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial \n# synchronization phase can take\ninitLimit=5\n# The number of ticks that can pass between \n# sending a request and getting an acknowledgement\nsyncLimit=2\n# the directory where the snapshot is stored.\ndataDir=./data/\n# the port at which the clients will connect\nclientPort=8181\n\n# zookeeper cluster list\nserver.100=10.23.253.43:8887:8888\nserver.101=10.23.150.29:8887:8888\nserver.102=10.23.247.141:8887:8888\nserver.200=10.65.20.68:8887:8888\nserver.201=10.65.27.21:8887:8888\n=====\n\nBefore the problem happened, the server.200 was the leader. Yesterday morning, I found the there were many sockets with the state of CLOSE_WAIT on the clientPort (8181),  the total was over about 120. Because of these CLOSE_WAIT, the server.200 could not accept more connections from the clients. The only thing I can do under this situation is restart the server.200, at about 2010-02-01 06:06:35. The related log is attached to the issue.", "created_at" : { "$date" : "2010-02-02T02:57:18.903+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:30.223+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.1" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ], "environment" : "Linux 2.6.9" },
{ "_id" : { "$oid" : "5b7d51795f627d6b0586b473" }, "external_id" : "ZOOKEEPER-997", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.2" ], "components" : [ "java client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51795f627d6b0586b474" }, "effect" : "duplicates", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "created_at" : { "$date" : "2011-02-21T19:05:17.996+0000" }, "priority" : "Trivial", "desc" : "ZkClient ignores command if there are any space in front of it.\n\nFor example:   ls /\ncauses following output (note space in front of ls)\n\nZooKeeper -server host:port cmd args\n        connect host:port\n        get path [watch]\n        ls path [watch]\n...\n", "reporter_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d3933e9214a0d1608d811" }, "updated_at" : { "$date" : "2011-11-23T19:22:31.913+0000" }, "title" : "ZkClient ignores command if there are any space in front of it", "issue_type" : "Improvement", "environment" : "CentOS release 5.5 (Final)", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51b55f627d6b0586bdb2" }, "external_id" : "HADOOP-7092", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51b55f627d6b0586bdb3" }, "external_id" : "ZOOKEEPER-976", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper startup script doesn't use JAVA_HOME", "desc" : "From bug filed on CDH: https://issues.cloudera.org/browse/DISTRO-47 - moving it to this jira to address:\n\n------------------------------------------------------\nBug filed by \"grep.alex\" at http://getsatisfaction.com/cloudera/topics/cdh3b3_zookeeper_startup_script_doesnt_use_java_home\n\nOn RedHat 5 (using the RPM installer) I was able to install and run all the Hadoop components. The Zookeeper install was fine, but it wouldn't start:\n\n{noformat}\n[root@aholmes-desktop init.d]# ./hadoop-zookeeper start \nJMX enabled by default \nUsing config: /etc/zookeeper/zoo.cfg \nStarting zookeeper ... \nSTARTED \n[root@aholmes-desktop init.d]# Exception in thread \"main\" java.lang.NoSuchMethodError: method java.lang.management.ManagementFactory.getPlatformMBeanServer with signature ()Ljavax.management.MBeanServer; was not found. \nat org.apache.zookeeper.jmx.ManagedUtil.registerLog4jMBeans(ManagedUtil.java:48 \n...\n{noformat} \n\nAfter some digging around I found the cause - the Zookeeper startup script (/usr/lib/zookeeper/bin/zkServer.sh ) uses the java found in the path, whereas the other startup scripts use JAVA_HOME. In my case I had the default RHEL5 1.4 JDK in the path, and the 1.6 JDK RPM's installed under /usr/java, hence the above error, which I'm guessing is a fairly common setup.\n\nIn my opinion all the startup scripts should all use the same mechanism to determine where to pick java.", "created_at" : { "$date" : "2011-01-18T01:36:16.625+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:31.321+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51b55f627d6b0586bdb2" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51b65f627d6b0586bdc7" }, "external_id" : "ZOOKEEPER-966", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Client side for multi", "desc" : "This is jus the client side of the code up to and including the serialization of requests.", "created_at" : { "$date" : "2010-12-29T07:04:27.079+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:31.677+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51a15f627d6b0586b9d3" } },
{ "_id" : { "$oid" : "5b7d51b75f627d6b0586bdcf" }, "external_id" : "ZOOKEEPER-796", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh should support an external PIDFILE variable", "desc" : "So currently the pid file has to be tied to the datadirectory when starting zkServer.sh. It would be good to be able to break them up.", "created_at" : { "$date" : "2010-06-28T22:02:04.839+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:31.014+0000" }, "creator_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "reporter_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51b75f627d6b0586bdeb" }, "external_id" : "ZOOKEEPER-1081", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "modify leader/follower code to correctly deal with new leader", "desc" : "the leader and follower code need to be modified to correctly handle and log epoch changes", "created_at" : { "$date" : "2011-05-30T15:15:45.884+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:32.341+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51865f627d6b0586b5ec" } },
{ "_id" : { "$oid" : "5b7d51b85f627d6b0586bdfc" }, "external_id" : "ZOOKEEPER-1117", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper 3.3.3 fails to build with gcc >= 4.6.1 on Debian/Ubuntu", "desc" : "zookeeper 3.3.3 (and 3.3.1) fails to build on Debian and Ubuntu systems with gcc >= 4.6.1:\n\n/bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I./include -I./tests -I./generated -Wall -Werror -g -O2 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c  -fPIC -DPIC -o .libs/zookeeper.o\nsrc/zookeeper.c: In function 'getaddrs':\nsrc/zookeeper.c:455:13: error: variable 'port' set but not used [-Werror=unused-but-set-variable]\ncc1: all warnings being treated as errors\n\nSee http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=625441 for more information.", "created_at" : { "$date" : "2011-07-05T14:50:48.125+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:32.985+0000" }, "creator_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "reporter_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "issue_links" : [  ], "environment" : "Ubuntu Developement Release (11.10/Oneiric Ocelot), Debian Unstable (sid)" },
{ "_id" : { "$oid" : "5b7d51b95f627d6b0586be1a" }, "external_id" : "ZOOKEEPER-839", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "deleteRecursive does not belong to the other methods", "desc" : "DeleteRecursive has been committed to trunk already as a method to the \nzookeeper class. So in the API it has the same level as the atomic operations \ncreate, delete, getData, setData, etc. The user must get the false impression, \nthat deleteRecursive is also an atomic operation.\nIt would be better to have deleteRecursive in some helper class but not that \ndeep in zookeeper's core code. Maybe I'd like to have another policy on how to \nreact if deleteRecursive fails in the middle of its work?", "created_at" : { "$date" : "2010-08-11T14:53:14.904+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:32.815+0000" }, "creator_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "reporter_id" : { "$oid" : "5b7d50d8e9214a0d1608d8c1" }, "issue_type" : "Sub-task", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" } },
{ "_id" : { "$oid" : "5b7d51ba5f627d6b0586be35" }, "external_id" : "ZOOKEEPER-870", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper trunk build broken.", "desc" : "the zookeeper current trunk build is broken mostly due to some netty changes. This is causing a huge backlog of PA's and other impediments to the review process. For now I plan to disable the test and fix them as part of 3.4 later.", "created_at" : { "$date" : "2010-09-14T22:16:29.707+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:32.123+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51bb5f627d6b0586be43" }, "external_id" : "ZOOKEEPER-1020", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Implement function in C client to determine which host you're currently connected to.", "desc" : "On occasion it might be useful to determine which host your Zookeeper client is currently connected to, be it for debugging purposes or otherwise. A possible signature for that function:\n\nconst char* zoo_get_connected_host(zhandle_t *zh, char *buffer, size_t buffer_size, unsigned short *port);\n\nClients could use it like below:\n\n  char buffer[33];\n  unsigned short port = 0;\n  if (!zoo_get_connected_host(zh, buffer, sizeof(buffer), &port))\n    return EXIT_FAILURE;\n\n  printf(\"The connected host is: %s:%d\\n\", buffer, port);", "created_at" : { "$date" : "2011-03-15T14:39:48.888+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:33.963+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51075f627d6b0586a8ac" }, "external_id" : "ZOOKEEPER-775", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib" ], "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2010-05-18T04:21:30.824+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2011-11-23T19:22:33.305+0000" }, "title" : "A large scale pub/sub system", "issue_type" : "New Feature", "desc" : "we have developed a large scale pub/sub system based on ZooKeeper and BookKeeper.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51bc5f627d6b0586bea6" }, "external_id" : "ZOOKEEPER-722", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh uses sh's builtin echo on BSD, behaves incorrectly.", "desc" : "zkServer.sh output the PID of the zookeeper process with:\necho -n $! > \"$ZOOPIDFILE\"\n\nThis uses -n which sh's builtin echo does not support. From echo's manpage.\n<snip>\n     Some shells may provide a builtin echo command which is similar or identical to this utility.  Most notably, the builtin echo in sh(1) does not accept\n     the -n option.  Consult the builtin(1) manual page.\n</snip>\n\nThis means that echo -n PID > ZOOPIDFILE will mean the contents of ZOOPIDFILE will be \"-n PID\". This stops zkServer.sh stop from working correctly.", "created_at" : { "$date" : "2010-03-22T14:49:42.212+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:33.659+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ], "environment" : "Mac OS X" },
{ "_id" : { "$oid" : "5b7d51bd5f627d6b0586bec1" }, "external_id" : "ZOOKEEPER-734", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumPeerTestBase.java and ZooKeeperServerMainTest.java do not handle windows path correctly", "desc" : "While runniing \"ant test-core-java\" QuorumPeerTestBase.java and ZooKeeperServerMainTest.java fail. The problem seems to be in ZookeeperserverMainTest.java:MainThread():66 and in QuorumPeerBaseTest.java:MainThread:76.\n\nFileWriter.write() writes windows path to the conf file. Java does not like windows path. Therefore, the test complains that it cannot find myid and fails. \n\nSolution - convert windows path to UNIX path. This worked for me on windows.  Diffs are attached below. Solution not tested on Linux since for some reason build is failing (due to problems not related to this change).\n\n\nvmc-floorb-dhcp116-114:/opt/zksrc/zookeeper-3.3.0/src/java/test/org/apache/zookeeper/server # svn diff\nIndex: ZooKeeperServerMainTest.java\n===================================================================\n--- ZooKeeperServerMainTest.java\t(revision 931240)\n+++ ZooKeeperServerMainTest.java\t(working copy)\n@@ -61,7 +61,8 @@\n             if (!dataDir.mkdir()) {\n                 throw new IOException(\"unable to mkdir \" + dataDir);\n             }\n-            fwriter.write(\"dataDir=\" + dataDir.toString() + \"\\n\");\n+            String data = dataDir.toString().replace('\\\\', '/');\n+            fwriter.write(\"dataDir=\" + data + \"\\n\");\n \n             fwriter.write(\"clientPort=\" + clientPort + \"\\n\");\n             fwriter.flush();\nIndex: quorum/QuorumPeerTestBase.java\n===================================================================\n--- quorum/QuorumPeerTestBase.java\t(revision 931240)\n+++ quorum/QuorumPeerTestBase.java\t(working copy)\n@@ -73,7 +73,8 @@\n             if (!dataDir.mkdir()) {\n                 throw new IOException(\"Unable to mkdir \" + dataDir);\n             }\n-            fwriter.write(\"dataDir=\" + dataDir.toString() + \"\\n\");\n+            String data = dataDir.toString().replace('\\\\', '/');\n+            fwriter.write(\"dataDir=\" + data + \"\\n\");\n \n             fwriter.write(\"clientPort=\" + clientPort + \"\\n\");\n             fwriter.write(quorumCfgSection + \"\\n\");", "created_at" : { "$date" : "2010-04-06T22:43:57.242+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:33.484+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ], "environment" : "Windows 32-bit" },
{ "_id" : { "$oid" : "5b7d51be5f627d6b0586bed0" }, "external_id" : "ZOOKEEPER-1090", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Race condition while taking snapshot can lead to not restoring data tree correctly", "desc" : "I think I have found a bug in the snapshot mechanism.\n\nThe problem occurs because dt.lastProcessedZxid is not synchronized (or rather set before the data tree is modified):\n\nFileTxnSnapLog:\n{code}\n    public void save(DataTree dataTree,\n            ConcurrentHashMap<Long, Integer> sessionsWithTimeouts)\n        throws IOException {\n        long lastZxid = dataTree.lastProcessedZxid;\n        LOG.info(\"Snapshotting: \" + Long.toHexString(lastZxid));\n        File snapshot=new File(\n                snapDir, Util.makeSnapshotName(lastZxid));\n        snapLog.serialize(dataTree, sessionsWithTimeouts, snapshot);   <=== the Datatree may not have the modification for lastProcessedZxid\n    }\n{code}\n\nDataTree:\n{code}\n    public ProcessTxnResult processTxn(TxnHeader header, Record txn) {\n        ProcessTxnResult rc = new ProcessTxnResult();\n\n        String debug = \"\";\n        try {\n            rc.clientId = header.getClientId();\n            rc.cxid = header.getCxid();\n            rc.zxid = header.getZxid();\n            rc.type = header.getType();\n            rc.err = 0;\n            if (rc.zxid > lastProcessedZxid) {\n                lastProcessedZxid = rc.zxid;\n            }\n            [...modify data tree...]           \n }\n{code}\nThe lastProcessedZxid must be set after the modification is done.\n\nAs a result, if server crashes after taking the snapshot (and the snapshot does not contain change corresponding to lastProcessedZxid) restore will not restore the data tree correctly:\n{code}\npublic long restore(DataTree dt, Map<Long, Integer> sessions,\n            PlayBackListener listener) throws IOException {\n        snapLog.deserialize(dt, sessions);\n        FileTxnLog txnLog = new FileTxnLog(dataDir);\n        TxnIterator itr = txnLog.read(dt.lastProcessedZxid+1); <=== Assumes lastProcessedZxid is deserialized\n }\n{code}\n\n\nI have had offline discussion with Ben and Camille on this. I will be posting the discussion shortly.", "created_at" : { "$date" : "2011-06-09T14:24:06.527+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:34.132+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [ "persistence", "server", "snapshot" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d518f5f627d6b0586b794" }, "external_id" : "ZOOKEEPER-1060", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "components" : [ "quorum" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51905f627d6b0586b795" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "created_at" : { "$date" : "2011-05-10T19:32:58.807+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "updated_at" : { "$date" : "2011-11-23T19:22:37.090+0000" }, "title" : "QuorumPeer takes a long time to shutdown", "issue_type" : "Bug", "desc" : "This problem is seen only if you have ZooKeeper embedded in your application. QuorumPeerMain.initializeAndRun() does a quorumPeer.join() before exiting.\n\nQuorumPeer.shutdown() tries to cleanup everything, but it does not interrupt itself. As a result, a if the peer is running FLE, it might be waiting to receive notifications (recvqueue.poll()) in FastLeaderElection. Therefore, quorumPeer.join() will wait until the peer wakes up from poll().\n\nThe fix is simple - call this.interrupt() in QuorumPeer.shutdown().", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51bf5f627d6b0586befa" }, "external_id" : "ZOOKEEPER-1052", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Findbugs warning in QuorumPeer.ResponderThread.run()", "desc" : "{noformat}\nREC \tException is caught when Exception is not thrown in org.apache.zookeeper.server.quorum.QuorumPeer$ResponderThread.run()\n{noformat}", "created_at" : { "$date" : "2011-04-24T13:45:34.376+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:37.557+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c05f627d6b0586bf05" }, "external_id" : "ZOOKEEPER-861", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Missing the test SSL certificate used for running junit tests.", "desc" : "The Hedwig code checked into Apache is missing a test SSL certificate file used for running the server junit tests.  We need this file otherwise the tests that use this (e.g. TestHedwigHub) will fail.", "created_at" : { "$date" : "2010-09-02T17:40:49.657+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:37.764+0000" }, "creator_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "reporter_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c15f627d6b0586bf14" }, "external_id" : "ZOOKEEPER-1140", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "server shutdown is not stopping threads", "desc" : "Near the end of QuorumZxidSyncTest there are tons of threads running - 115 \"ProcessThread\" threads, similar numbers of SessionTracker.\n\nAlso I see ~100 ReadOnlyRequestProcessor - why is this running as a separate thread? (henry/flavio?)\n\n", "created_at" : { "$date" : "2011-07-29T16:49:37.972+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:38.015+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c25f627d6b0586bf2e" }, "external_id" : "ZOOKEEPER-785", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : " Zookeeper 3.3.1 shouldn't infinite loop if someone creates a server.0 line", "desc" : "The following config causes an infinite loop\n\n[zoo.cfg]\ntickTime=2000\ndataDir=/var/zookeeper/\nclientPort=2181\ninitLimit=10\nsyncLimit=5\nserver.0=localhost:2888:3888\n\nOutput:\n\n2010-06-01 16:20:32,471 - INFO [main:QuorumPeerMain@119] - Starting quorum peer\n2010-06-01 16:20:32,489 - INFO [main:NIOServerCnxn$Factory@143] - binding to port 0.0.0.0/0.0.0.0:2181\n2010-06-01 16:20:32,504 - INFO [main:QuorumPeer@818] - tickTime set to 2000\n2010-06-01 16:20:32,504 - INFO [main:QuorumPeer@829] - minSessionTimeout set to -1\n2010-06-01 16:20:32,505 - INFO [main:QuorumPeer@840] - maxSessionTimeout set to -1\n2010-06-01 16:20:32,505 - INFO [main:QuorumPeer@855] - initLimit set to 10\n2010-06-01 16:20:32,526 - INFO [main:FileSnap@82] - Reading snapshot /var/zookeeper/version-2/snapshot.c\n2010-06-01 16:20:32,547 - INFO [Thread-1:QuorumCnxManager$Listener@436] - My election bind port: 3888\n2010-06-01 16:20:32,554 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@620] - LOOKING\n2010-06-01 16:20:32,556 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@649] - New election. My id = 0, Proposed zxid = 12\n2010-06-01 16:20:32,558 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@689] - Notification: 0, 12, 1, 0, LOOKING, LOOKING, 0\n2010-06-01 16:20:32,560 - WARN [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@623] - Unexpected exception\njava.lang.NullPointerException\nat org.apache.zookeeper.server.quorum.FastLeaderElection.totalOrderPredicate(FastLeaderElection.java:496)\nat org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:709)\nat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:621)\n2010-06-01 16:20:32,560 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@620] - LOOKING\n2010-06-01 16:20:32,560 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@649] - New election. My id = 0, Proposed zxid = 12\n2010-06-01 16:20:32,561 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@689] - Notification: 0, 12, 2, 0, LOOKING, LOOKING, 0\n2010-06-01 16:20:32,561 - WARN [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@623] - Unexpected exception\njava.lang.NullPointerException\nat org.apache.zookeeper.server.quorum.FastLeaderElection.totalOrderPredicate(FastLeaderElection.java:496)\nat org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:709)\nat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:621)\n2010-06-01 16:20:32,561 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@620] - LOOKING\n2010-06-01 16:20:32,562 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@649] - New election. My id = 0, Proposed zxid = 12\n2010-06-01 16:20:32,562 - INFO [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@689] - Notification: 0, 12, 3, 0, LOOKING, LOOKING, 0\n2010-06-01 16:20:32,562 - WARN [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@623] - Unexpected exception\njava.lang.NullPointerException\n\n\nThings like HBase require that the zookeeper servers be listed in the zoo.cfg. This is a bug on their part, but zookeeper shouldn't null pointer in a loop though.\n", "created_at" : { "$date" : "2010-06-02T22:51:50.629+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:38.284+0000" }, "creator_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "reporter_id" : { "$oid" : "5b7d50dee9214a0d1608d8c3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "Tested in linux with a new jvm" },
{ "_id" : { "$oid" : "5b7d51c25f627d6b0586bf59" }, "external_id" : "ZOOKEEPER-821", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add ZooKeeper version information to zkpython", "desc" : "Since installing and using ZooKeeper I've built and installed no less than four versions of the zkpython bindings.  It would be really helpful if the module had a '__version__' attribute to easily tell which version is currently in use.", "created_at" : { "$date" : "2010-07-16T21:30:56.957+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:38.436+0000" }, "creator_id" : { "$oid" : "5b7d51c2e9214a0d1608d92a" }, "reporter_id" : { "$oid" : "5b7d51c2e9214a0d1608d92a" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d51c2e9214a0d1608d92a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c35f627d6b0586bf76" }, "external_id" : "ZOOKEEPER-859", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Native Windows version of C client", "desc" : "Use windows sockets and the win32 API for implementing the c client.  This would be only useful for the \"single-threaded\" model, where the IO waiting is taken care of in the calling code.", "created_at" : { "$date" : "2010-08-31T18:52:49.220+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:38.661+0000" }, "creator_id" : { "$oid" : "5b7d51c3e9214a0d1608d92b" }, "reporter_id" : { "$oid" : "5b7d51c3e9214a0d1608d92b" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d51c3e9214a0d1608d92b" }, "issue_links" : [  ], "environment" : "Windows 7, 64-bit" },
{ "_id" : { "$oid" : "5b7d51c45f627d6b0586bf81" }, "external_id" : "ZOOKEEPER-853", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make zookeeper.is_unrecoverable return True or False and not an integer", "desc" : "This is a patch that fixes a TODO from the python zookeeper extension, it makes {{zookeeper.is_unrecoverable}} return {{True}} or {{False}} and not an integer. ", "created_at" : { "$date" : "2010-08-19T13:07:01.345+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:38.934+0000" }, "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c55f627d6b0586bf90" }, "external_id" : "ZOOKEEPER-1141", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython fails tests under python 2.4", "desc" : "\"ant test\" under python 2.4 is failing due to a small issue in the test code - using a new feature introduced in 2.5.\n\nI have a small patch which addresses this, after which I was able to compile and run the tests successfully under python 2.4.\n", "created_at" : { "$date" : "2011-08-02T23:31:40.819+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:39.538+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c65f627d6b0586bf9d" }, "external_id" : "ZOOKEEPER-1239", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add logging/stats to identify fsync stalls", "desc" : "We don't have any logging to identify fsync stalls. It's a somewhat common occurrence (after gc/swap issues) when trying to diagnose pipeline stalls - where outstanding requests start piling up and operational latency increases.\n\nWe should have some sort of logging around this. e.g. if the fsync time exceeds some limit then log a warning, something like that.\n\nIt would also be useful to publish \"stat\" information related to this. min/avg/max latency for fsync.\n\nThis should also be exposed through JMX.\n\n\n", "created_at" : { "$date" : "2011-10-21T23:48:57.298+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:39.297+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c65f627d6b0586bfb0" }, "external_id" : "ZOOKEEPER-720", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Use zookeeper-{version}-sources.jar instead of zookeeper-{version}-src.jar to publish sources in the Maven repository", "desc" : "The artifact with the sources to be published in the Maven repository should be named ${artifactId}-${version}-sources.jar not ${artifactId}-${version}-src.jar.\n\nSee also: http://maven.apache.org/guides/mini/guide-central-repository-upload.html and ZOOKEEPER-224", "created_at" : { "$date" : "2010-03-21T08:04:47.971+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:39.695+0000" }, "creator_id" : { "$oid" : "5b7d510be9214a0d1608d8e0" }, "reporter_id" : { "$oid" : "5b7d510be9214a0d1608d8e0" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "labels" : [ "maven" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d510be9214a0d1608d8e0" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51c75f627d6b0586bfc2" }, "external_id" : "ZOOKEEPER-712", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Bookie recovery", "desc" : "Recover the ledger fragments of a bookie once it crashes.", "created_at" : { "$date" : "2010-03-18T15:39:08.027+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:39.122+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.3", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51c75f627d6b0586bfc1" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d517e5f627d6b0586b50d" }, "external_id" : "ZOOKEEPER-494", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d517e5f627d6b0586b50e" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d5065e9214a0d1608d8a8" }, "created_at" : { "$date" : "2009-08-02T19:07:19.640+0000" }, "priority" : "Trivial", "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "updated_at" : { "$date" : "2011-11-23T19:22:39.842+0000" }, "title" : "zookeeper should install include headers in /usr/local/include/zookeeper", "issue_type" : "Improvement", "desc" : "Hello,\n\nCurrently all the c client header files get installed under /usr/local/include/c-client-src . Ideally they should get installed in /usr/local/include/zookeeper .", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51c95f627d6b0586bff3" }, "external_id" : "ZOOKEEPER-1146", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "significant regression in client (c/python) performance", "desc" : "I tried running my latency tester against trunk, in so doing I noticed that the C/Python (not sure which yet) client performance has seriously degraded since 3.3.3.\n\nThe first run (below) is with released 3.3.3 client against a 3 server ensemble running released 3.3.3 server code. The second run is the exact same environment (same ensemble), however using trunk c/zkpython client.\n\nNotice:\n\n1) in the first run operations are approx 10ms/write, 0.25ms/read - which is pretty much what's expected.\n\n2) however in the second run we are seeing 50ms/operation regardless of read or write.\n\n{noformat}\n[phunt@c0309 zk-smoketest-3.3.3]$ PYTHONPATH=lib.linux-x86_64-2.6/ LD_LIBRARY_PATH=lib.linux-x86_64-2.6/ python26 ./zk-latencies.py --servers \"c0309:2181,c0310:2181,c0311:2181\" --znode_size=100 --znode_count=100 --timeout=5000 --synchronous\nConnecting to c0309:2181\nConnected in 16 ms, handle is 0\nConnecting to c0310:2181\nConnected in 16 ms, handle is 1\nConnecting to c0311:2181\nConnected in 15 ms, handle is 2\nTesting latencies on server c0309:2181 using syncronous calls\ncreated     100 permanent znodes  in    959 ms (9.599378 ms/op 104.173415/sec)\nset         100           znodes  in    933 ms (9.332101 ms/op 107.157002/sec)\nget         100           znodes  in     27 ms (0.270889 ms/op 3691.551589/sec)\ndeleted     100 permanent znodes  in    881 ms (8.812950 ms/op 113.469388/sec)\ncreated     100 ephemeral znodes  in    956 ms (9.564152 ms/op 104.557103/sec)\nwatched     100           znodes  in     26 ms (0.264361 ms/op 3782.707587/sec)\ndeleted     100 ephemeral znodes  in    881 ms (8.819292 ms/op 113.387792/sec)\nnotif       100           watches in    999 ms (9.994299 ms/op 100.057038/sec)\nTesting latencies on server c0310:2181 using syncronous calls\ncreated     100 permanent znodes  in    964 ms (9.640460 ms/op 103.729490/sec)\nset         100           znodes  in    933 ms (9.332800 ms/op 107.148981/sec)\nget         100           znodes  in     29 ms (0.299308 ms/op 3341.036650/sec)\ndeleted     100 permanent znodes  in    886 ms (8.864651 ms/op 112.807603/sec)\ncreated     100 ephemeral znodes  in    958 ms (9.585140 ms/op 104.328161/sec)\nwatched     100           znodes  in     30 ms (0.300801 ms/op 3324.459240/sec)\ndeleted     100 ephemeral znodes  in    886 ms (8.865030 ms/op 112.802779/sec)\nnotif       100           watches in   1000 ms (10.000212 ms/op 99.997878/sec)\nTesting latencies on server c0311:2181 using syncronous calls\ncreated     100 permanent znodes  in    958 ms (9.582071 ms/op 104.361569/sec)\nset         100           znodes  in    935 ms (9.359350 ms/op 106.845024/sec)\nget         100           znodes  in     25 ms (0.252700 ms/op 3957.263893/sec)\ndeleted     100 permanent znodes  in    891 ms (8.913291 ms/op 112.192013/sec)\ncreated     100 ephemeral znodes  in    958 ms (9.584489 ms/op 104.335246/sec)\nwatched     100           znodes  in     25 ms (0.251091 ms/op 3982.627356/sec)\ndeleted     100 ephemeral znodes  in    891 ms (8.915379 ms/op 112.165730/sec)\nnotif       100           watches in   1000 ms (10.000508 ms/op 99.994922/sec)\nLatency test complete\n[phunt@c0309 zk-smoketest-3.3.3]$ cd ../zk-smoketest-trunk/\n[phunt@c0309 zk-smoketest-trunk]$ PYTHONPATH=lib.linux-x86_64-2.6/ LD_LIBRARY_PATH=lib.linux-x86_64-2.6/ python26 ./zk-latencies.py --servers \"c0309:2181,c0310:2181,c0311:2181\" --znode_size=100 --znode_count=100 --timeout=5000 --synchronous\nConnecting to c0309:2181\nConnected in 31 ms, handle is 0\nConnecting to c0310:2181\nConnected in 16 ms, handle is 1\nConnecting to c0311:2181\nConnected in 16 ms, handle is 2\nTesting latencies on server c0309:2181 using syncronous calls\ncreated     100 permanent znodes  in   5099 ms (50.999281 ms/op 19.608119/sec)\nset         100           znodes  in   5066 ms (50.665429 ms/op 19.737324/sec)\nget         100           znodes  in   4009 ms (40.093150 ms/op 24.941916/sec)\ndeleted     100 permanent znodes  in   5040 ms (50.404449 ms/op 19.839519/sec)\ncreated     100 ephemeral znodes  in   5124 ms (51.249170 ms/op 19.512511/sec)\nwatched     100           znodes  in   4051 ms (40.514441 ms/op 24.682557/sec)\ndeleted     100 ephemeral znodes  in   5048 ms (50.484939 ms/op 19.807888/sec)\nnotif       100           watches in   1000 ms (10.004182 ms/op 99.958199/sec)\nTesting latencies on server c0310:2181 using syncronous calls\ncreated     100 permanent znodes  in   5115 ms (51.157510 ms/op 19.547472/sec)\nset         100           znodes  in   5056 ms (50.568910 ms/op 19.774996/sec)\nget         100           znodes  in   4099 ms (40.999382 ms/op 24.390612/sec)\ndeleted     100 permanent znodes  in   5041 ms (50.418010 ms/op 19.834182/sec)\ncreated     100 ephemeral znodes  in   5083 ms (50.835850 ms/op 19.671157/sec)\nwatched     100           znodes  in   4100 ms (41.003261 ms/op 24.388304/sec)\ndeleted     100 ephemeral znodes  in   5058 ms (50.581930 ms/op 19.769906/sec)\nnotif       100           watches in   1000 ms (10.005081 ms/op 99.949219/sec)\nTesting latencies on server c0311:2181 using syncronous calls\ncreated     100 permanent znodes  in   5099 ms (50.992720 ms/op 19.610642/sec)\nset         100           znodes  in   5091 ms (50.916569 ms/op 19.639972/sec)\nget         100           znodes  in   4099 ms (40.996401 ms/op 24.392385/sec)\ndeleted     100 permanent znodes  in   5066 ms (50.669601 ms/op 19.735699/sec)\ncreated     100 ephemeral znodes  in   5124 ms (51.249208 ms/op 19.512496/sec)\nwatched     100           znodes  in   4099 ms (40.999141 ms/op 24.390755/sec)\ndeleted     100 ephemeral znodes  in   5049 ms (50.498819 ms/op 19.802443/sec)\nnotif       100           watches in    999 ms (9.997852 ms/op 100.021486/sec)\nLatency test complete\n{noformat}", "created_at" : { "$date" : "2011-08-04T17:21:13.579+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:40.681+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ca5f627d6b0586c009" }, "external_id" : "ZOOKEEPER-804", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c unit tests failing due to \"assertion cptr failed\"", "desc" : "I'm seeing this frequently:\n\n     [exec] Zookeeper_simpleSystem::testPing : elapsed 18006 : OK\n     [exec] Zookeeper_simpleSystem::testAcl : elapsed 1022 : OK\n     [exec] Zookeeper_simpleSystem::testChroot : elapsed 3145 : OK\n     [exec] Zookeeper_simpleSystem::testAuth ZooKeeper server started : elapsed 25687 : OK\n     [exec] zktest-mt: /home/phunt/dev/workspace/gitzk/src/c/src/zookeeper.c:1952: zookeeper_process: Assertion `cptr' failed.\n     [exec] make: *** [run-check] Aborted\n     [exec] Zookeeper_simpleSystem::testHangingClient\n\nMahadev can you take a look?\n", "created_at" : { "$date" : "2010-07-05T20:35:49.830+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:40.855+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50c95f627d6b0586a509" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "gcc 4.4.3, ubuntu lucid lynx, dual core laptop (intel)" },
{ "_id" : { "$oid" : "5b7d51ca5f627d6b0586c02e" }, "external_id" : "ZOOKEEPER-782", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Incorrect C API documentation for Watches", "desc" : " The C API Doxygen documentation states:\n\n\" .... If the client is ever disconnected from the service, even if the\n  disconnection is temporary, the watches of the client will be removed from\n  the service, so a client must treat a disconnect notification as an implicit\n  trigger of all outstanding watches.\"\n\nThis is incorrect as of v.3. Watches are only lost and need to be re-registered when a session times out. When a normal disconnection occurs watches are reset automatically on reconnection.\n\nThe documentation in zookeeper.h needs to be updated to correct this explanation.", "created_at" : { "$date" : "2010-05-31T20:47:30.744+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:40.301+0000" }, "creator_id" : { "$oid" : "5b7d50f7e9214a0d1608d8ce" }, "reporter_id" : { "$oid" : "5b7d50f7e9214a0d1608d8ce" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "c client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51cb5f627d6b0586c03d" }, "external_id" : "ZOOKEEPER-719", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add throttling to BookKeeper client", "desc" : "Add throttling to client to control the rate of operations to bookies. ", "created_at" : { "$date" : "2010-03-19T17:35:11.359+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:40.477+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51cc5f627d6b0586c064" }, "external_id" : "ZOOKEEPER-1139", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "jenkins is reporting two warnings, fix these", "desc" : "cleanup jenkins report, currently 2 compiler warnings being reported.\n", "created_at" : { "$date" : "2011-07-27T21:42:05.018+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:41.772+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ad5f627d6b0586bc67" }, "external_id" : "ZOOKEEPER-1264", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3", "3.4.0", "3.5.0" ], "components" : [ "tests" ], "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51cd5f627d6b0586c06f" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "created_at" : { "$date" : "2011-10-28T04:23:28.192+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-11-23T19:22:41.542+0000" }, "title" : "FollowerResyncConcurrencyTest failing intermittently", "issue_type" : "Bug", "desc" : "The FollowerResyncConcurrencyTest test is failing intermittently. \n\nsaw the following on 3.4:\n{noformat}\njunit.framework.AssertionFailedError: Should have same number of\nephemerals in both followers expected:<11741> but was:<14001>\n       at org.apache.zookeeper.test.FollowerResyncConcurrencyTest.verifyState(FollowerResyncConcurrencyTest.java:400)\n       at org.apache.zookeeper.test.FollowerResyncConcurrencyTest.testResyncBySnapThenDiffAfterFollowerCrashes(FollowerResyncConcurrencyTest.java:196)\n       at org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)\n{noformat}\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51ce5f627d6b0586c0d5" }, "external_id" : "ZOOKEEPER-983", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "running zkServer.sh start remotely using ssh hangs", "desc" : "If zkServer.sh is run remotely using ssh as follows ssh will \"hang\" - i.e. not complete/return once the server is started. This is even though zkServer.sh starts the java vm in the background.\n\n$ ssh <host> \"zkServer.sh start\"\n\nthis is due to the following issue:\n\nhttp://www.slac.stanford.edu/comp/unix/ssh_faq.html#logoff_hangs\n\n", "created_at" : { "$date" : "2011-02-03T05:21:01.053+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:41.337+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.2" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51cf5f627d6b0586c0e7" }, "external_id" : "ZOOKEEPER-792", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython memory leak", "desc" : "We recently upgraded zookeeper from 3.2.1 to 3.3.1, now we are seeing less client deadlock on session expiration, which is a definite plus!\n\nUnfortunately we are seeing memory leak that requires our zk clients to be restarted every half-day. Valgrind result:\n\n==8804== 25 (12 direct, 13 indirect) bytes in 1 blocks are definitely lost in loss record 255 of 670\n==8804==    at 0x4021C42: calloc (vg_replace_malloc.c:418)\n==8804==    by 0x5047B42: parse_acls (zookeeper.c:369)\n==8804==    by 0x5047EF6: pyzoo_create (zookeeper.c:1009)\n==8804==    by 0x40786CC: PyCFunction_Call (in /usr/lib/libpython2.4.so.1.0)\n==8804==    by 0x40B31DC: PyEval_EvalFrame (in /usr/lib/libpython2.4.so.1.0)\n==8804==    by 0x40B4485: PyEval_EvalCodeEx (in /usr/lib/libpython2.4.so.1.0)\n", "created_at" : { "$date" : "2010-06-24T21:36:54.382+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:41.041+0000" }, "creator_id" : { "$oid" : "5b7d5183e9214a0d1608d913" }, "reporter_id" : { "$oid" : "5b7d5183e9214a0d1608d913" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5183e9214a0d1608d913" }, "issue_links" : [  ], "environment" : "vmware workstation - guest OS:Linux python:2.4.3" },
{ "_id" : { "$oid" : "5b7d51d05f627d6b0586c0ff" }, "external_id" : "ZOOKEEPER-731", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper#delete  , #create - async versions miss a verb in the javadoc ", "desc" : "    /**\n     * The Asynchronous version of delete. \"The request doesn't  *missing* actually until\n     * the asynchronous callback is called.\"\n     */\n    public void delete(final String path, int version, VoidCallback cb, Object ctx) .. \n\n\nAlso some information in the javadoc about how to instantiate the callback objects / context would be useful . \n", "created_at" : { "$date" : "2010-03-26T23:12:47.541+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:41.993+0000" }, "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51d15f627d6b0586c121" }, "external_id" : "ZOOKEEPER-958", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Flag to turn off autoconsume in hedwig c++ client", "desc" : "Currently the hedwig cpp client will automatically send a consume message to the server when the calling client indicated that it has received the message. If the client wants to queue the messages and not acknowledge them to the server immediately, they need to block, which means interfering with any other running callbacks. ", "created_at" : { "$date" : "2010-12-15T09:18:22.220+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:42.190+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50f45f627d6b0586a7c1" }, "external_id" : "ZOOKEEPER-794", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "fix_versions" : [ "3.3.2", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51d15f627d6b0586c131" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50d85f627d6b0586a5fa" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d51d1e9214a0d1608d92e" }, "created_at" : { "$date" : "2010-06-26T02:47:15.527+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d51d1e9214a0d1608d92e" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d51d1e9214a0d1608d92e" }, "updated_at" : { "$date" : "2011-11-23T19:22:42.367+0000" }, "title" : "Callbacks are not invoked when the client is closed", "issue_type" : "Bug", "desc" : "I noticed that ZooKeeper has different behaviors when calling synchronous or asynchronous actions on a closed ZooKeeper client.\nActually a synchronous call will throw a \"session expired\" exception while an asynchronous call will do nothing. No exception, no callback invocation.\n\nActually, even if the EventThread receives the Packet with the session expired err code, the packet is never processed since the thread has been killed by the ventOfDeath. So the call back is not invoked.\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51d25f627d6b0586c16f" }, "external_id" : "ZOOKEEPER-797", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client source with AI_ADDRCONFIG cannot be compiled with early glibc", "desc" : "c client source with AI_ADDRCONFIG cannot be compiled with early glibc (before 2.3.3)", "created_at" : { "$date" : "2010-06-29T04:06:51.369+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:42.871+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_links" : [  ], "environment" : "linux 2.6.9" },
{ "_id" : { "$oid" : "5b7d51d35f627d6b0586c17c" }, "external_id" : "ZOOKEEPER-738", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper.jute.h fails to compile with -pedantic ", "desc" : "/home/y/include/zookeeper/zookeeper.jute.h:96: error: extra semicolon\n/home/y/include/zookeeper/zookeeper.jute.h:158: error: extra semicolon\n/home/y/include/zookeeper/zookeeper.jute.h:288: error: extra semicolon\n\nthe code generator needs to be updated to not output a naked semi\n", "created_at" : { "$date" : "2010-04-10T21:17:56.367+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:42.640+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d51d3e9214a0d1608d92f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51d45f627d6b0586c18b" }, "external_id" : "ZOOKEEPER-1145", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ObserverTest.testObserver fails at particular point after several runs of ant junt.run -Dtestcase=ObserverTest", "desc" : "Use the attached repeat.sh to run ObserverTest repeatedly by doing: \n\nsrc/repeat.sh ObserverTest\n\nThe test will will fail eventually after a few iterations; should be only a few minutes.\n\nThe line that fails in the test is: \n\nzk = new ZooKeeper(\"127.0.0.1:\" + CLIENT_PORT_OBS,\n                ClientBase.CONNECTION_TIMEOUT, this);\n\nAttached as out.txt is the output showing a successful run, for comparison, followed by a failed run.\n\n\nNote that in the seconds before the test fails, in the following lines, that there is a 24 second gap in time (between 22:13:02 and 22:13:26):\n\nbq.\n[junit] 2011-08-03 22:13:02,167 [myid:3] - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:11229:ZooKeeperServer@833] - Client attempting to establish new session at /127.0.0.1:46929\n[junit] 2011-08-03 22:13:26,003 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:11228:Leader@419] - Shutting down\n[junit] 2011-08-03 22:13:26,003 [myid:2] - INFO  [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:11228:Leader@425] - Shutdown called\n[junit] java.lang.Exception: shutdown Leader! reason: Only 0 followers, need 1\n\n\n", "created_at" : { "$date" : "2011-08-03T22:36:07.070+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:43.408+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51d45f627d6b0586c18a" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d51d45f627d6b0586c19b" }, "external_id" : "ZOOKEEPER-1156", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log truncation truncating log too much - can cause data loss", "desc" : "The log truncation relies on position calculation for a particular zxid to figure out the new size of the log file. There is a bug in PositionInputStream implementation which skips counting the bytes in the log which have value 0. This can lead to underestimating the actual log size. The log records which should be there can get truncated, leading to data loss on the participant which is executing the trunc.\n\nClients can see different values depending on whether they connect to the node on which trunc was executed. ", "created_at" : { "$date" : "2011-08-18T17:48:07.943+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:43.938+0000" }, "creator_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "reporter_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "quorum", "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_links" : [  ], "original_time_estimate" : 86400 },
{ "_id" : { "$oid" : "5b7d510e5f627d6b0586a926" }, "external_id" : "ZOOKEEPER-1107", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d510e5f627d6b0586a927" }, "effect" : "is superceded by", "type" : "Supercedes" } ], "assignee_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "created_at" : { "$date" : "2011-06-23T14:48:22.304+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d51d5e9214a0d1608d930" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d51d5e9214a0d1608d930" }, "updated_at" : { "$date" : "2011-11-23T19:22:43.554+0000" }, "title" : "automating log and snapshot cleaning", "issue_type" : "New Feature", "desc" : "I like to have ZK itself manage the amount of snapshots and logs kept,  instead of relying on the PurgeTxnLog utility.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51d65f627d6b0586c1eb" }, "external_id" : "ZOOKEEPER-800", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zoo_add_auth returns ZOK if zookeeper handle is in ZOO_CLOSED_STATE", "desc" : "This happened when I called zoo_add_auth() immediately after zookeeper_init(). It took me a while to figure out that authentication actually failed since zoo_add_auth() returned ZOK. It should return ZINVALIDSTATE instead. \n\n--Michi", "created_at" : { "$date" : "2010-06-29T23:26:03.448+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:43.007+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51d75f627d6b0586c1fd" }, "external_id" : "ZOOKEEPER-774", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Recipes tests are slightly outdated: they do not compile against JUnit 4.8", "desc" : "As title", "created_at" : { "$date" : "2010-05-12T21:31:11.733+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:43.242+0000" }, "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "recipes" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51dd5f627d6b0586c20f" }, "external_id" : "ZOOKEEPER-1119", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer stop command incorrectly reading comment lines in zoo.cfg", "desc" : "Hello, adding the following commented-out dataDir to the zoo.cfg file (keeping the default one provided active):\n\n{noformat}\n# the directory where the snapshot is stored.\n# dataDir=test123/data\ndataDir=/export/crawlspace/mahadev/zookeeper/server1/data\n{noformat}\n\nand then running sh zkServer.sh stop is showing that the program is incorrectly reading the commented-out dataDir:\n\n{noformat}\ngmazza@gmazza-work:~/dataExt3/apps/zookeeper-3.3.3/bin$ sh zkServer.sh stop\nJMX enabled by default\nUsing config: /media/NewDriveExt3_/apps/zookeeper-3.3.3/bin/../conf/zoo.cfg\nStopping zookeeper ... \nerror: could not find file test123/data\n/export/crawlspace/mahadev/zookeeper/server1/data/zookeeper_server.pid\ngmazza@gmazza-work:~/dataExt3/apps/zookeeper-3.3.3/bin$ \n{noformat}\n\nIf I change the commented-out line in zoo.cfg to \"test123456/data\" and run the stop command again I get:\nerror: could not find file test123456/data\n\nshowing that it's incorrectly doing a run-time read of the commented-out lines.  (Difficult to completely confirm, but this problem  doesn't appear to occur with the start command, only the stop one.)\n", "created_at" : { "$date" : "2011-07-07T10:33:08.798+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:44.388+0000" }, "creator_id" : { "$oid" : "5b7d51dde9214a0d1608d931" }, "reporter_id" : { "$oid" : "5b7d51dde9214a0d1608d931" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "Ubuntu Linux 10.04, JDK 6" },
{ "_id" : { "$oid" : "5b7d50e45f627d6b0586a698" }, "external_id" : "ZOOKEEPER-888", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bindings", "c client" ], "fix_versions" : [ "3.3.3", "3.3.2", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e45f627d6b0586a699" }, "effect" : "is duplicated by", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d51de5f627d6b0586c222" }, "effect" : "duplicates", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c8" }, "created_at" : { "$date" : "2010-10-06T13:26:52.880+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c8" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c8" }, "updated_at" : { "$date" : "2011-11-23T19:22:44.576+0000" }, "title" : "c-client / zkpython: Double free corruption on node watcher", "issue_type" : "Bug", "desc" : "the c-client / zkpython wrapper invokes already freed watcher callback\n\nsteps to reproduce:\n  0. start a zookeper server on your machine\n  1. run the attached python script\n  2. suspend the zookeeper server process (e.g. using `pkill -STOP -f org.apache.zookeeper.server.quorum.QuorumPeerMain` )\n  3. wait until the connection and the node observer fired with a session event\n  4. resume the zookeeper server process  (e.g. using `pkill -CONT -f org.apache.zookeeper.server.quorum.QuorumPeerMain` )\n\n-> the client tries to dispatch the node observer function again, but it was already freed -> double free corruption", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51965f627d6b0586b87d" }, "external_id" : "ZOOKEEPER-750", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "fix_versions" : [ "3.3.1", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51965f627d6b0586b87f" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2010-04-22T16:45:27.391+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-11-23T19:22:44.751+0000" }, "title" : "move maven artifacts into \"dist-maven\" subdir of the release (package target)", "issue_type" : "Bug", "desc" : "The maven artifacts are currently (3.3.0) put into the toplevel of the release. This causes confusion\namonst new users (ie \"which jar do I use?\"). Also the naming of the bin jar is wrong for maven (to put\nonto the maven repo it must be named without the -bin) which adds extra burden for the release\nmanager. Putting into a subdir fixes this and makes it explicit what's being deployed to maven repo.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51df5f627d6b0586c24c" }, "external_id" : "ZOOKEEPER-763", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Deadlock on close w/ zkpython / c client", "desc" : "deadlocks occur if we attempt to close a handle while there are any outstanding async requests (aget, acreate, etc). Normally on close both the io thread terminates and the completion thread are terminated and joined, however w\\ith outstanding async requests, the completion thread won't be in a joinable state, and we effectively hang when the main thread does the join.\n\nafaics ideal behavior would be on close of a handle, to effectively clear out any remaining callbacks and let the completion thread terminate.\n\ni've tried adding some bookkeeping to within a python client to guard against closing while there is an outstanding async completion request, but its an imperfect solution since even after the python callback is executed there is still a window for deadlock before the completion thread finishes the callback.\n\na simple example to reproduce the deadlock is attached.", "created_at" : { "$date" : "2010-05-04T13:09:43.434+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:44.170+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ], "environment" : "ubuntu 10.04, zookeeper 3.3.0 and trunk" },
{ "_id" : { "$oid" : "5b7d51e05f627d6b0586c270" }, "external_id" : "ZOOKEEPER-1154", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Data inconsistency when the node(s) with the highest zxid is not present at the time of leader election", "desc" : "If a participant with the highest zxid (lets call it A) isn't present during leader election, a participant with a lower zxid (say B) might be chosen as a leader. When A comes up, it will replay the log with that higher zxid. The change that was in that higher zxid will only be visible to the clients connecting to the participant A, but not to other participants.\n\nI was able to reproduce this problem by\n1. connect debugger to B and C and suspend them, so they don't write anything\n2. Issue an update to the leader A.\n3. After a few seconds, crash all servers (A,B,C)\n4. Start B and C, let the leader election take place\n5. Start A.\n6. You will find that the update done in step 2 is visible on A but not on B,C, hence the inconsistency.\n\nBelow is a more detailed analysis of what is happening in the code.\n\n\nInitial Condition\n1.\tLets say there are three nodes in the ensemble A,B,C with A being the leader\n2.\tThe current epoch is 7. \n3.\tFor simplicity of the example, lets say zxid is a two digit number, with epoch being the first digit.\n4.\tThe zxid is 73\n5.\tAll the nodes have seen the change 73 and have persistently logged it.\n\nStep 1\nRequest with zxid 74 is issued. The leader A writes it to the log but there is a crash of the entire ensemble and B,C never write the change 74 to their log.\n\nStep 3\nB,C restart, A is still down\nB,C form the quorum\nB is the new leader. Lets say  B minCommitLog is 71 and maxCommitLog is 73\nepoch is now 8, zxid is 80\nRequest with zxid 81 is successful. On B, minCommitLog is now 71, maxCommitLog is 81\n\nStep 4\nA starts up. It applies the change in request with zxid 74 to its in-memory data tree\nA contacts B to registerAsFollower and provides 74 as its ZxId\nSince 71<=74<=81, B decides to send A the diff. B will send to A the proposal 81.\n\n\nProblem:\nThe problem with the above sequence is that A's data tree has the update from request 74, which is not correct. Before getting the proposals 81, A should have received a trunc to 73. I don't see that in the code. If the maxCommitLog on B hadn't bumped to 81 but had stayed at 73, that case seems to be fine.\n", "created_at" : { "$date" : "2011-08-15T17:36:07.100+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.186+0000" }, "creator_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "reporter_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_links" : [  ], "original_time_estimate" : 1814400 },
{ "_id" : { "$oid" : "5b7d51e15f627d6b0586c29a" }, "external_id" : "ZOOKEEPER-1108", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Various bugs in zoo_add_auth in C", "desc" : "3 issues:\nIn zoo_add_auth: there is a race condition:\n   2940     // [ZOOKEEPER-800] zoo_add_auth should return ZINVALIDSTATE if\n   2941     // the connection is closed.\n   2942     if (zoo_state(zh) == 0) {\n   2943         return ZINVALIDSTATE;\n   2944     }\nwhen we do zookeeper_init, the state is initialized to 0 and above we check if state = 0 then throw exception.\nThere is a race condition where the doIo thread is slow and has not changed the state to CONNECTING, then you end up returning back ZKINVALIDSTATE.\nThe problem is we use 0 for CLOSED state and UNINITIALIZED state. in case of uninitialized case it should let it go through.\n\n2nd issue:\n\nAnother Bug: in send_auth_info, the check is not correct\n\nwhile (auth->next != NULL) { //--BUG: in cases where there is only one auth in the list, this will never send that auth, as its next will be NULL \n   rc = send_info_packet(zh, auth); \n   auth = auth->next; \n}\n\nFIX IS:\ndo { \n  rc = send_info_packet(zh, auth); \n  auth = auth->next; \n } while (auth != NULL); //this will make sure that even if there is one auth ,that will get sent.\n\n3rd issue:\n   2965     add_last_auth(&zh->auth_h, authinfo);\n   2966     zoo_unlock_auth(zh);\n   2967\n   2968     if(zh->state == ZOO_CONNECTED_STATE || zh->state == ZOO_ASSOCIATING_STATE)\n   2969         return send_last_auth_info(zh);\n\nif it is connected, we only send the last_auth_info, which may be different than the one we added, as we unlocked it before sending it.\n\n", "created_at" : { "$date" : "2011-06-23T21:02:34.026+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.338+0000" }, "creator_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "reporter_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51e25f627d6b0586c2d6" }, "external_id" : "ZOOKEEPER-1068", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Documentation and default config suggest incorrect location for Zookeeper state", "desc" : "Documentation and default config suggest /var/zookeeper as a value for dataDir. This practice is, strictly speaking, incompatible with UNIX/Linux filesystem layout standards (e.g. http://www.s-gms.ms.edus.si/cgi-bin/man-cgi?filesystem+5 , http://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/index.html  ). \n\nEven though Zookeeper use is not limited to UNIX-like OSes I'd recommend that we change references to /var/zookeeper to /var/lib/zookeeper", "created_at" : { "$date" : "2011-05-23T23:08:12.766+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.732+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "scripts", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51cd5f627d6b0586c06f" }, "external_id" : "ZOOKEEPER-1282", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "fix_versions" : [ "3.4.0", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51ad5f627d6b0586bc67" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "parent_issue_id" : { "$oid" : "5b7d51ad5f627d6b0586bc67" }, "created_at" : { "$date" : "2011-11-02T22:33:55.641+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.020+0000" }, "title" : "Learner.java not following Zab 1.0 protocol - setCurrentEpoch should be done upon receipt of NEWLEADER (before acking it) and not upon receipt of UPTODATE", "issue_type" : "Sub-task", "desc" : "according to https://cwiki.apache.org/confluence/display/ZOOKEEPER/Zab1.0\nphase 2 part 2, \"Once it receives NEWLEADER(e) it atomically applies\nthe new state and sets f.currentEpoch =e. \"\n\n\nIn Learner.java self.setCurrentEpoch(newEpoch) is done after receiving\nUPTODATE and not before acking the NEWLEADER message as should be.\n\n                case Leader.UPTODATE:\n                    if (!snapshotTaken) {\n                        zk.takeSnapshot();\n                    }\n                    self.cnxnFactory.setZooKeeperServer(zk);\n                    break outerLoop;\n                case Leader.NEWLEADER: // it will be NEWLEADER in v1.0\n                    zk.takeSnapshot();\n                    snapshotTaken = true;\n                    writePacket(new QuorumPacket(Leader.ACK,\nnewLeaderZxid, null, null), true);\n                    break;\n                }\n            }\n        }\n        long newEpoch = ZxidUtils.getEpochFromZxid(newLeaderZxid);\n        self.setCurrentEpoch(newEpoch);", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51e35f627d6b0586c2f1" }, "external_id" : "ZOOKEEPER-820", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update c unit tests to ensure \"zombie\" java server processes don't cause failure", "desc" : "When the c unit tests are run sometimes the server doesn't shutdown at the end of the test, this causes subsequent tests (hudson esp) to fail.\n\n1) we should try harder to make the server shut down at the end of the test, I suspect this is related to test failing/cleanup\n2) before the tests are run we should see if the old server is still running and try to shut it down\n", "created_at" : { "$date" : "2010-07-16T16:00:32.560+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.874+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d25f627d6b0586a5d8" }, "external_id" : "ZOOKEEPER-744", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a612" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a60f" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50d25f627d6b0586a5d9" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "created_at" : { "$date" : "2010-04-19T20:14:42.193+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "updated_at" : { "$date" : "2011-11-23T19:22:45.565+0000" }, "title" : "Add monitoring four-letter word", "issue_type" : "New Feature", "desc" : "Filing a feature request based on a zookeeper-user discussion.\n\nZookeeper should have a new four-letter word that returns key-value pairs appropriate for importing to a monitoring system (such as Ganglia which has a large installed base)\n\nThis command should initially export the following:\n\n(a) Count of instances in the ensemble.\n(b) Count of up-to-date instances in the ensemble.\n\nBut be designed such that in the future additional data can be added. For example, the output could define the statistic in a comment, then print a key \"space character\" value line:\n\n\"\"\"\n# Total number of instances in the ensemble\nzk_ensemble_instances_total 5\n# Number of instances currently participating in the quorum.\nzk_ensemble_instances_active 4\n\"\"\"\n\nFrom the mailing list:\n\n\"\"\"\nDate: Mon, 19 Apr 2010 12:10:44 -0700\nFrom: Patrick Hunt <phunt@apache.org>\nTo: zookeeper-user@hadoop.apache.org\nSubject: Re: Recovery issue - how to debug?\n\nOn 04/19/2010 11:55 AM, Travis Crawford wrote:\n> It would be a lot easier from the operations perspective if the leader\n> explicitly published some health stats:\n>\n> (a) Count of instances in the ensemble.\n> (b) Count of up-to-date instances in the ensemble.\n>\n> This would greatly simplify monitoring&  alerting - when an instance\n> falls behind one could configure their monitoring system to let\n> someone know and take a look at the logs.\n\nThat's a great idea. Please enter a JIRA for this - a new 4 letter word \nand JMX support. It would also be a great starter project for someone \ninterested in becoming more familiar with the server code.\n\nPatrick\n\"\"\"", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51635f627d6b0586b11a" }, "external_id" : "ZOOKEEPER-1194", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "fix_versions" : [ "3.4.0", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51635f627d6b0586b11b" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "created_at" : { "$date" : "2011-09-20T00:10:08.471+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "updated_at" : { "$date" : "2011-11-23T19:22:46.083+0000" }, "title" : "Two possible race conditions during leader establishment", "issue_type" : "Bug", "desc" : "Leader.getEpochToPropose() and Leader.waitForNewEpoch() act as barriers - they make sure that a leader/follower can return from calling the method only once connectingFollowers (or electingFollowers) contain a quorum. But these methods don't make sure that the leader itself is in connectingFollowers/electingFollowers. So the leader didn't necessarily reach the barrier when followers pass it. This can cause the following problems:\n\n1. If the leader is not in connectingFollowers when a LearnerHandler returns from getEpochToPropose(), then the epoch sent by the leader to the follower might be smaller than the leader's own last accepted epoch.\n\n2. If the leader is not in electingFollowers when LearnerHandler returns from waitForNewEpoch() then the leader will send a NEWLEADER message to followers, and the followers will respond, but it is possible that the NEWLEADER message is not in outstandingProposals when these NEWLEADER  acks arrive, which will cause the NEWLEADER acks to be dropped.\n\n\nTo fix this I propose to explicitly check that the leader is in connectingFollowers/electingFollowers before anyone can pass these barriers.\n\n\n\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51d45f627d6b0586c18a" }, "external_id" : "ZOOKEEPER-1144", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51a05f627d6b0586b9a0" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51d45f627d6b0586c18b" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "created_at" : { "$date" : "2011-08-03T22:35:49.802+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "updated_at" : { "$date" : "2011-11-23T19:22:46.251+0000" }, "title" : "ZooKeeperServer not starting on leader due to a race condition", "issue_type" : "Bug", "desc" : "I have found one problem that is causing QuorumPeerMainTest:testQuorum to fail. This test uses 2 ZK servers. \n\nThe test is failing because leader is not starting ZooKeeperServer after leader election. so everything halts.\n\nWith the new changes, the server is now started in Leader.processAck() which is called from LeaderHandler. processAck() starts ZooKeeperServer if majority have acked NEWLEADER. The leader puts its ack in the the ackSet in Leader.lead(). Since processAck() is called from LearnerHandler it can happen that the learner's ack is processed before the leader is able to put its ack in the ackSet. When LearnerHandler invokes processAck(), the ackSet for newLeaderProposal will not have quorum (in this case 2). As a result, the ZooKeeperServer is never started on the Leader.\n\nThe leader needs to ensure that its ack is put in ackSet before starting LearnerCnxAcceptor or invoke processAck() itself after adding to ackSet. I haven't had time to go through the ZAB2 changes so I am not too familiar with the code. Can Ben/Flavio fix this?", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51e75f627d6b0586c36d" }, "external_id" : "ZOOKEEPER-905", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "enhance zkServer.sh for easier zookeeper automation-izing", "desc" : "zkServer.sh is good at starting zookeeper and figuring out the right options to pass along.\n\nunfortunately if you want to wrap zookeeper startup/shutdown in any significant way, you have to reimplement a bunch of the logic there.\n\nthe attached patch addresses a couple simple issues:\n1. add a 'start-foreground' option to zkServer.sh - this allows things that expect to manage a foregrounded process (daemontools, launchd, etc) to use zkServer.sh instead of rolling their own to launch zookeeper\n\n2. add a 'print-cmd' option to zkServer.sh - rather than launching zookeeper from the script, just give me the command you'd normally use to exec zookeeper.  I found this useful when writing automation to start/stop zookeeper as part of smoke testing zookeeper-based applications\n\n3. Deal more gracefully with supplying alternate configuration files to zookeeper - currently the script assumes all config files reside in $ZOOCFGDIR - also useful for smoke testing\n\n4. communicate extra info (\"JMX enabled\") about zookeeper on STDERR rather than STDOUT (necessary for #2)\n\n5. fixes an issue on macos where readlink doesn't have the '-f' option.\n\n", "created_at" : { "$date" : "2010-10-19T21:48:02.418+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:46.689+0000" }, "creator_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "reporter_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5169e9214a0d1608d90d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51e85f627d6b0586c38f" }, "external_id" : "ZOOKEEPER-758", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython segfaults on invalid acl with missing key", "desc" : "Currently when setting an acl, there is a minimal parse to ensure that its a list of dicts, however if one of the dicts is missing a required key, the subsequent usage doesn't check for it, and will segfault.. for example using an acl of [{\"schema\":id, \"id\":world, permissions:PERM_ALL}] will segfault if used, because the scheme key is missing (its been purposefully typo'd to schema in example). \n\nI've expanded the check_acl macro to include verifying that all keys are present and added some unit tests against trunk in the attachments.", "created_at" : { "$date" : "2010-04-29T01:28:10.877+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:46.429+0000" }, "creator_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "reporter_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0", "3.4.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_links" : [  ], "environment" : "ubuntu lucid (10.04)" },
{ "_id" : { "$oid" : "5b7d51e85f627d6b0586c3a4" }, "external_id" : "ZOOKEEPER-1007", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "iarchive leak in C client", "desc" : "On line 1957, zookeeper_process() returns without cleaning up the \"ia\" buffer that was previously allocated.  I don't know how often this code path is taken, but I thought it was worth reporting.  I will attach a simple patch shortly.", "created_at" : { "$date" : "2011-03-04T21:42:58.770+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:47.054+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51e95f627d6b0586c3ba" }, "external_id" : "ZOOKEEPER-742", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Deallocatng None on writes", "desc" : "On write operations, getting:\n\nFatal Python error: deallocating None\nAborted\n\nThis error happens on write operations only.  Here's the backtrace:\n\nFatal Python error: deallocating None\n\nProgram received signal SIGABRT, Aborted.\n0x000000383fc30215 in raise () from /lib64/libc.so.6\n(gdb) bt\n#0  0x000000383fc30215 in raise () from /lib64/libc.so.6\n#1  0x000000383fc31cc0 in abort () from /lib64/libc.so.6\n#2  0x00002adbd0be8189 in Py_FatalError () from /usr/lib64/libpython2.4.so.1.0\n#3  0x00002adbd0bc7493 in PyEval_EvalFrame () from /usr/lib64/libpython2.4.so.1.0\n#4  0x00002adbd0bcab66 in PyEval_EvalFrame () from /usr/lib64/libpython2.4.so.1.0\n#5  0x00002adbd0bcbfe5 in PyEval_EvalCodeEx () from /usr/lib64/libpython2.4.so.1.0\n#6  0x00002adbd0bcc032 in PyEval_EvalCode () from /usr/lib64/libpython2.4.so.1.0\n#7  0x00002adbd0be8729 in ?? () from /usr/lib64/libpython2.4.so.1.0\n#8  0x00002adbd0be9bd8 in PyRun_SimpleFileExFlags () from /usr/lib64/libpython2.4.so.1.0\n#9  0x00002adbd0bf000d in Py_Main () from /usr/lib64/libpython2.4.so.1.0\n#10 0x000000383fc1d974 in __libc_start_main () from /lib64/libc.so.6\n#11 0x0000000000400629 in _start ()\n", "created_at" : { "$date" : "2010-04-15T23:21:08.062+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:47.255+0000" }, "creator_id" : { "$oid" : "5b7d504ee9214a0d1608d89d" }, "reporter_id" : { "$oid" : "5b7d504ee9214a0d1608d89d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.0", "3.2.2" ], "components" : [ "contrib-bindings", "c client", "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51e95f627d6b0586c3b9" }, "effect" : "is blocked by", "type" : "Blocker" } ], "environment" : "Redhat Enterprise 5.4 (python 2.4.3), Mac OS X 10.5.8 (python 2.5.1)" },
{ "_id" : { "$oid" : "5b7d514e5f627d6b0586ad9b" }, "external_id" : "ZOOKEEPER-1174", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3" ], "components" : [ "java client" ], "fix_versions" : [ "3.3.4", "3.4.0", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d514e5f627d6b0586ad9c" }, "effect" : "breaks", "type" : "Regression" }, { "issue_id" : { "$oid" : "5b7d51ea5f627d6b0586c3d5" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "created_at" : { "$date" : "2011-09-08T18:47:42.742+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "updated_at" : { "$date" : "2011-11-23T19:22:48.850+0000" }, "title" : "FD leak when network unreachable", "issue_type" : "Bug", "desc" : "In the socket connection logic there are several errors that result in bad behavior.  The basic problem is that a socket is registered with a selector unconditionally when there are nuances that should be dealt with.  First, the socket may connect immediately.  Secondly, the connect may throw an exception.  In either of these two cases, I don't think that the socket should be registered.\n\nI will attach a test case that demonstrates the problem.  I have been unable to create a unit test that exhibits the problem because I would have to mock the low level socket libraries to do so.  It would still be good to do so if somebody can figure out a good way.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51eb5f627d6b0586c412" }, "external_id" : "ZOOKEEPER-1171", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "fix build for java 7", "desc" : "I tried testing out zk on java 7 (not yet officially supported) but I ran into a road block due to the build failing. Patch coming next.", "created_at" : { "$date" : "2011-09-02T19:35:51.709+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:48.638+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51eb5f627d6b0586c421" }, "external_id" : "ZOOKEEPER-855", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "clientPortBindAddress should be clientPortAddress", "desc" : "The server documentation states that the configuration parameter for binding to a specific ip address is clientPortBindAddress.  The code believes the parameter is clientPortAddress.  The documentation for 3.3.X versions needs changed to reflect the correct parameter .  This parameter was added in ZOOKEEPER-635.", "created_at" : { "$date" : "2010-08-26T14:49:18.956+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:48.175+0000" }, "creator_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "reporter_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.1", "3.3.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e4e9214a0d1608d8c9" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51e95f627d6b0586c3b9" }, "external_id" : "ZOOKEEPER-631", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bindings" ], "fix_versions" : [ "3.3.1", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51e95f627d6b0586c3ba" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d51de5f627d6b0586c222" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2009-12-16T23:08:48.506+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "updated_at" : { "$date" : "2011-11-23T19:22:48.418+0000" }, "title" : "zkpython's C code could do with a style clean-up", "issue_type" : "Improvement", "desc" : "Inconsistent formatting / use of parenthesis / some error checking - all need fixing. \n\nAlso, the documentation in the header file could do with a reformat. \n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51685f627d6b0586b1ff" }, "external_id" : "ZOOKEEPER-1190", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [ "build" ], "fix_versions" : [ "3.4.0", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51685f627d6b0586b201" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "created_at" : { "$date" : "2011-09-17T00:30:19.902+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2011-11-23T19:22:49.937+0000" }, "title" : "ant package is not including many of the bin scripts in the package (zkServer.sh for example)", "issue_type" : "Bug", "desc" : "run \"ant package\" and look in the build/zookeeper-<version>/bin directory. many of the bin scripts are missing.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51ee5f627d6b0586c459" }, "external_id" : "ZOOKEEPER-891", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow non-numeric version strings", "desc" : "Non-numeric version strings (eg -dev) or -are not currently accepted, you either get an error (Invalid version number format, must be \"x.y.z\") or if you pass x.y.z-dev or x.y.z+1 you'll get a NumberFormatException.  Would be useful to allow non-numeric versions. \n\n{noformat}\nversion-info:\n     [java] All version-related parameters must be valid integers!\n     [java] Exception in thread \"main\" java.lang.NumberFormatException: For input string: \"3-dev\"\n     [java] \tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)\n     [java] \tat java.lang.Integer.parseInt(Integer.java:458)\n     [java] \tat java.lang.Integer.parseInt(Integer.java:499)\n     [java] \tat org.apache.zookeeper.version.util.VerGen.main(VerGen.java:131)\n     [java] Java Result: 1\n{noformat}", "created_at" : { "$date" : "2010-10-08T01:38:49.572+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:49.466+0000" }, "creator_id" : { "$oid" : "5b7d51eee9214a0d1608d932" }, "reporter_id" : { "$oid" : "5b7d51eee9214a0d1608d932" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51875f627d6b0586b64b" }, "external_id" : "ZOOKEEPER-813", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "build" ], "fix_versions" : [ "3.3.2", "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51875f627d6b0586b64c" }, "effect" : "duplicates", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d5187e9214a0d1608d915" }, "created_at" : { "$date" : "2010-07-12T07:14:10.246+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d5187e9214a0d1608d915" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d5187e9214a0d1608d915" }, "updated_at" : { "$date" : "2011-11-23T19:22:49.048+0000" }, "title" : "maven install is broken due to incorrect organisation", "issue_type" : "Bug", "desc" : "SBT doesn't like the pom file for zookeeper because while it's under the \"org.apache.hadoop\" directory, it's organisation is actually \"org.apache.zookeeper\". A simple fix for this is to just change \"org.apache.zookeeper\" to \"org.apache.hadoop\".", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d51ef5f627d6b0586c469" }, "external_id" : "ZOOKEEPER-862", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hedwig created ledgers with hardcoded Bookkeeper ensemble and quorum size.  Make these a server config parameter instead.", "desc" : "Hedwig code right now when using Bookkeeper as the persistence store is hardcoding the number of bookie servers in the ensemble and quorum size.  This is used the first time a ledger is created.  This should be exposed as a server configuration parameter instead.", "created_at" : { "$date" : "2010-09-02T17:47:23.958+0000" }, "updated_at" : { "$date" : "2011-11-23T19:22:49.675+0000" }, "creator_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "reporter_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-hedwig" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d505fe9214a0d1608d8a4" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f05f627d6b0586c472" }, "external_id" : "ZOOKEEPER-1308", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Guaranteed NPE in WriteLock recipe", "desc" : "{code}\n        public boolean execute() throws KeeperException, InterruptedException {\n            do {\n                if (id == null) {\n                    long sessionId = zookeeper.getSessionId();\n                    String prefix = \"x-\" + sessionId + \"-\";\n                    // lets try look up the current ID if we failed \n                    // in the middle of creating the znode\n                    findPrefixInChildren(prefix, zookeeper, dir);\n                    idName = new ZNodeName(id);\n                }\n{code}\n\nZNodeName will throw an NPE if id is null.", "created_at" : { "$date" : "2011-11-24T13:43:45.869+0000" }, "updated_at" : { "$date" : "2011-11-24T13:48:24.135+0000" }, "creator_id" : { "$oid" : "5b7d5177e9214a0d1608d90f" }, "reporter_id" : { "$oid" : "5b7d5177e9214a0d1608d90f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "recipes" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f05f627d6b0586c476" }, "external_id" : "ZOOKEEPER-1301", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "backport patches related to the zk startup script from 3.4 to 3.3 release ", "created_at" : { "$date" : "2011-11-16T20:00:51.733+0000" }, "updated_at" : { "$date" : "2011-11-29T17:54:37.271+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.4" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4" ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f15f627d6b0586c48c" }, "external_id" : "ZOOKEEPER-1283", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "building 3.3 branch fails with Ant 1.8.2 (success with 1.7.1 though)", "desc" : "I tried to compile 3.3.3 or the current 3.3 branch head, in both cases using ant 1.8.2 fails, however 1.7.0 is successful\n\nhere's the error:\n{noformat}\nTestsuite: org.apache.zookeeper.VerGenTest\nTests run: 1, Failures: 1, Errors: 0, Time elapsed: 0.009 sec\n\nTestcase: warning took 0.001 sec\n\tFAILED\nClass org.apache.zookeeper.VerGenTest has no public constructor TestCase(String name) or TestCase()\njunit.framework.AssertionFailedError: Class org.apache.zookeeper.VerGenTest has no public constructor TestCase(String name) or TestCase()\n{noformat}\n", "created_at" : { "$date" : "2011-11-03T05:35:25.483+0000" }, "updated_at" : { "$date" : "2011-11-29T17:54:43.763+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f25f627d6b0586c497" }, "external_id" : "ZOOKEEPER-1306", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hang in zookeeper_close()", "desc" : "With patch ZOOKEEPER-981,  I saw another problem. Hang in zookeeper_close() again. here is the stack:\n(gdb) bt\n#0 0x000000302b80adfb in __lll_mutex_lock_wait () from /lib64/tls/libpthread.so.0\n#1 0x000000302b1307a8 in main_arena () from /lib64/tls/libc.so.6\n#2 0x000000302b910230 in stack_used () from /lib64/tls/libpthread.so.0\n#3 0x000000302b808dde in pthread_cond_broadcast@@GLIBC_2.3.2 () from /lib64/tls/libpthread.so.0\n#4 0x00000000006b4ce8 in adaptor_finish (zh=0x6902060) at src/mt_adaptor.c:217\n#5 0x00000000006b0fd0 in zookeeper_close (zh=0x6902060) at src/zookeeper.c:2297\n(gdb) p zh->ref_counter\n$5 = 1\n(gdb) p zh->close_requested\n$6 = 1\n(gdb) p *zh\n$7 = {fd = 110112576, hostname = 0x6903620 \"\", addrs = 0x0, addrs_count = 1,\nwatcher = 0x62e5dc <doris::meta_register_mgr_t::register_mgr_watcher(_zhandle*, int, int, char const*, void*)>, last_recv = {tv_sec = 1321510694, tv_usec = 552835}, last_send = {tv_sec = 1321510694, tv_usec = 552886}, last_ping = {tv_sec = 1321510685, tv_usec = 774869}, next_deadline = { tv_sec = 1321510704, tv_usec = 547831}, recv_timeout = 30000, input_buffer = 0x0, to_process = {head = 0x0, last = 0x0, lock = {__m_reserved = 0,\n__m_count = 0, __m_owner = 0x0, __m_kind = 0, __m_lock = {__status = 0, __spinlock = 0}}}, to_send = {head = 0x0, last = 0x0, lock = {\n__m_reserved = 0, __m_count = 0, __m_owner = 0x0, __m_kind = 1, __m_lock = {__status = 0, __spinlock = 0}}}, sent_requests = {head = 0x0, last = 0x0,\ncond = {__c_lock = {_status = 1, __spinlock = -1}, __c_waiting = 0x0, __padding = '\\0' <repeats 15 times>, __align = 0}, lock = {_m_reserved = 0,\n__m_count = 0, __m_owner = 0x0, __m_kind = 0, __m_lock = {__status = 0, __spinlock = 0}}}, completions_to_process = {head = 0x2aefbff800,\nlast = 0x2af0e05f40, cond = {__c_lock = {__status = 592705486850, __spinlock = -1}, __c_waiting = 0x45,\n_padding = \"E\\000\\000\\000\\000\\000\\000\\000\\220\\006\\000\\000\\000\", __align = 296352743424}, lock = {_m_reserved = 1, __m_count = 0,\n__m_owner = 0x1000026ca, __m_kind = 0, __m_lock = {__status = 0, __spinlock = 0}}}, connect_index = 0, client_id = {client_id = 86551148676999146, passwd = \"G\\233\\213\\f202\\002\\034\"}, last_zxid = 82057372, outstanding_sync = 0, primer_buffer = {buffer = 0x6902290 \"\", len = 40, curr_offset = 44, next = 0x0}, primer_storage = {len = 36, protocolVersion = 0, timeOut = 30000, sessionId = 86551148676999146, passwd_len = 16, passwd = \"G\\233\\213\\f202\\002\\034\"},\nprimer_storage_buffer = \"\\000\\000\\000$\\000\\000\\000\\000\\000\\000u0\\0013}000\\000\\000\\020G\\233\\213\\f202\\002\\034\", state = 0, context = 0x0,\nauth_h = {auth = 0x0, lock = {__m_reserved = 0, __m_count = 0, __m_owner = 0x0, __m_kind = 0, __m_lock = {__status = 0, __spinlock = 0}}},\nref_counter = 1, close_requested = 1, adaptor_priv = 0x0, socket_readable = {tv_sec = 0, tv_usec = 0}, active_node_watchers = 0x6901520,\nactive_exist_watchers = 0x69015d0, active_child_watchers = 0x6902ef0, chroot = 0x0}\nI think the ref_counter is suposed to be 2 or 3 or 4 here. it seems not correct. I think maybe we should increase the ref_counter before we set zh->close_request=1, otherwise the do_io thread and do_completion thread may release the handler just after we set zh->close_request and before we increase zh->ref_counter. Thanks again", "created_at" : { "$date" : "2011-11-19T07:02:45.018+0000" }, "updated_at" : { "$date" : "2011-11-29T21:52:06.339+0000" }, "creator_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "reporter_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d51f2e9214a0d1608d933" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f35f627d6b0586c4a1" }, "external_id" : "ZOOKEEPER-1289", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Multi Op Watch Events", "desc" : "Caches built on top of zookeeper clients can become inconsistent because of lack of multi op watches. Our clients receive watch notifications for paths one at a time, and in their watch handling, invalidate the path in the cache. However, the cache now has an inconsistent view of zookeeper, since it is receiving the notifications one at a time. In general, the watch handling semantics do not conform with the idea of a multi op. If changes can be made to multiple paths atomically, all clients should be notified of that change atomically.", "created_at" : { "$date" : "2011-11-05T01:48:47.996+0000" }, "updated_at" : { "$date" : "2011-11-30T23:08:39.712+0000" }, "creator_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "reporter_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f45f627d6b0586c4a6" }, "external_id" : "ZOOKEEPER-1312", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add a \"getChildrenWithStat\" operation", "desc" : "It would be extremely useful to be able to have a \"getChildrenWithStat\" method.  This method would behave exactly the same as getChildren but in addition to returning the list of all child znode names it would also return a Stat for each child.  I'm sure there are quite a few use cases for this but it could save a lot of extra reads for my application.", "created_at" : { "$date" : "2011-11-30T23:46:39.691+0000" }, "updated_at" : { "$date" : "2011-12-03T00:54:18.460+0000" }, "creator_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "reporter_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f55f627d6b0586c4bd" }, "external_id" : "ZOOKEEPER-321", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "optmize session tracking in zookeeper.", "desc" : "sometimes a lot of zookeeper clients are read only. For such clients we do not need the session tracking in zookeeper. Getting rid of session tracking for such clients will help us sclae much better.", "created_at" : { "$date" : "2009-02-19T02:23:32.422+0000" }, "updated_at" : { "$date" : "2011-12-05T05:28:28.562+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.2" ], "components" : [ "c client", "server", "java client" ], "labels" : [ "session" ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f55f627d6b0586c4d5" }, "external_id" : "ZOOKEEPER-1004", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "TestClient.cc:363: Assertion: equality assertion failed", "desc" : "Jenkins (Hudson) shows an error when running test-cppunit. I am not able to replicate this error on my own build machine, so I am unable to diagnose. Perhaps someone with access to the Apache Jenkins. Please see attached output from https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/163//console (click on \"full\" to see the attached output if your browser can handle that much text).\n\n", "created_at" : { "$date" : "2011-03-01T00:14:22.364+0000" }, "updated_at" : { "$date" : "2011-12-05T22:57:20.170+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f65f627d6b0586c4db" }, "external_id" : "ZOOKEEPER-1325", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Log maxClientCnxn warning in INFO level", "desc" : "When Hbase client ZooKeeperWatcher gets ConnectionLossException (/hbase/rs or /hbase), it is very hard debug the ZK server log if ZK server has started using log4j INFO level.\nWhen maxClientCnxn limit is reached for a single client (at the socket level), it will be nice to log it in INFO level instead of WARN. It will help hbase clients (Region server, HMaster, and HBase cient lib) to debug the issue in production.\n\n{code}\n\n3.4 - src/java/main/org/apache/zookeeper/server/NIOServerCnxnFactory.java \n3.3.4 - src/java/main/org/apache/zookeeper/server/NIOServerCnxn.java\n\n public void run() {\n        while (!ss.socket().isClosed()) {\n            try {\n                        ...\n                        ...\n                \n                        if (maxClientCnxns > 0 && cnxncount >= maxClientCnxns){\n                            LOG.info(\"Too many connections from \" + ia\n                                     + \" - max is \" + maxClientCnxns );\n                            sc.close();\n                        } \n                        ... \n    }\n\n{code}", "created_at" : { "$date" : "2011-12-09T22:09:43.091+0000" }, "updated_at" : { "$date" : "2011-12-09T23:36:24.121+0000" }, "creator_id" : { "$oid" : "5b7d51f6e9214a0d1608d936" }, "reporter_id" : { "$oid" : "5b7d51f6e9214a0d1608d936" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.3", "3.3.4", "3.4.0" ], "components" : [ "server" ], "labels" : [ "noob" ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f65f627d6b0586c4e1" }, "external_id" : "ZOOKEEPER-982", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh won't start zookeeper on an ubuntu 10.10 system due to a bug in the startup script.", "desc" : "When running \"zkServer.sh start\" I get these error messages:\n\n====\n$sudo sh  bin/zkServer.sh start\nMX enabled by default\nbin/zkServer.sh: 69: cygpath: not found\nUsing config: \ngrep: : No such file or directory\nStarting zookeeper ... \nSTARTED\n$ Invalid config, exiting abnormally\n====\n\nThe \"Invalid config...\" text is output from the server which terminates immediately after this message has been printed.\n\nThe fix is easy:   Inside zkServer.sh change the line\n====\nif $cygwin\n====\n\ninto\n\n====\nif [ -n \"$cygwin\" ]\n====\n\nThis fixes the problem and makes the server run\n\n\n", "created_at" : { "$date" : "2011-02-02T09:52:58.364+0000" }, "updated_at" : { "$date" : "2011-12-12T17:47:55.453+0000" }, "creator_id" : { "$oid" : "5b7d51f6e9214a0d1608d937" }, "reporter_id" : { "$oid" : "5b7d51f6e9214a0d1608d937" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f75f627d6b0586c4f2" }, "external_id" : "ZOOKEEPER-1220", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "./zkCli.sh 'create' command is throwing ArrayIndexOutOfBoundsException", "desc" : "Few problems while executing create command,\n \nIf we will give command like \n \n1)[zk: localhost:2181(CONNECTED) 0] create -s -e /node1\n{noformat}\n       Exception in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: 4\n\tat org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:692)\n\tat org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:593)\n\tat org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:365)\n\tat org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:323)\n\tat org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:282)\n{noformat}\n      but actually it should create emphemeral sequential node.\n\n2)[zk: localhost:2181(CONNECTED) 0] create -s -e\n{noformat}\n    Exception in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: 3\n{noformat}\n    here it should print the list of commands that is the default behaviour of zkCli for invalid/incomplete commands.\n\n3)[zk: localhost:2181(CONNECTED) 3] create -s -e \"data\"\n{noformat}\n     Exception in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: 4\n{noformat}\n     here command is wrong so it should print list of commnads. . \n\n4)[zk: localhost:2181(CONNECTED) 0] create /node1\n    zkCli is treating it as a invalid command.because for args.length  check (3)is their but behaviour is \n    if user haven't given any of the option it should create persistent node.\n\t  {noformat}\n\t  if (cmd.equals(\"create\") && args.length >= 3) {\n            int first = 0;\n            CreateMode flags = CreateMode.PERSISTENT;\n{noformat}", "created_at" : { "$date" : "2011-10-12T10:47:43.536+0000" }, "updated_at" : { "$date" : "2011-12-15T11:58:22.058+0000" }, "creator_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "reporter_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f85f627d6b0586c520" }, "external_id" : "ZOOKEEPER-1232", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "remove unused o.a.z.server.util.Profiler", "desc" : "The class is not used and it rather harms to suggest to people that this would be the right way to do micro-benchmarks on the JVM. It even harms to suggest that micro-benchmarks are the right way to approach Java performance issues.\n\nQuote from http://code.google.com/p/caliper/wiki/JavaMicrobenchmarks\n\"Why would I ever write a microbenchmark then?\n\nMost of the time, you shouldn't! Instead, slavishly follow a principle of simple, clear coding that avoids clever optimizations. This is the type of code that JITs of the present and future are most likely to know how to optimize themselves. And that's a job which truly should be theirs, not yours. \"\n\nTools to do microbenchmarks:\nhttp://code.google.com/p/caliper/ (from the team that also does Guava, the Google Java library, recommended by Joshua Bloch himself)\nhttp://hype-free.blogspot.com/2010/01/choosing-java-profiler.html\nhttp://www.infoq.com/articles/java-profiling-with-open-source\nhttp://java.net/projects/japex\n\n\nJoshua Bloch on Performance Anxiety:\nhttp://java.dzone.com/articles/joshua-bloch-performance (follow link to parleys)\n\n\n", "created_at" : { "$date" : "2011-10-17T09:34:24.551+0000" }, "updated_at" : { "$date" : "2011-12-15T11:58:30.527+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51f95f627d6b0586c52c" }, "external_id" : "ZOOKEEPER-756", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some cleanup and improvements for zooinspector", "desc" : "Copied from the already closed ZOOKEEPER-678:\n\n* specify the exact URL, where the icons are from. It's best to include the link also in the NOTICE.txt file.\n\n\nIt seems, that zooinspector finds it's icons only if the icons folder is in the current path. But when I install zooinspector as part of the Zookeeper Debian package, I want to be able to call it regardless of the current path.\nCould you use getRessources or something so that I can point to the icons location from the wrapper shell script?\n\nCan I place the zooinspector config files in /etc/zookeeper/zooinspector/ ? Could I give zooinspector a property to point to the config file location?\n\nThere are several places, where viewers is missspelled as \"Veiwers\". Please do a case insensitive search for \"veiw\" to correct these. Even the config file \"defaultNodeVeiwers.cfg\" is missspelled like this. This has the potential to confuse the hell out of people when debugging something!\n", "created_at" : { "$date" : "2010-04-28T07:03:51.726+0000" }, "updated_at" : { "$date" : "2011-12-15T11:58:30.328+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib" ], "labels" : [ "zooinspector" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51fa5f627d6b0586c595" }, "external_id" : "ZOOKEEPER-1329", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Lock recipe sorts sequenced children incorrectly", "desc" : "The lock recipe sorts sequenced children lexicographically.  When the sequence number wraps, a lexicographical comparison will always place 2147483648 ahead of -2147483649, place -2147483648 ahead of -2147483649, and place -1 ahead of -2.  Clearly, we want 2147483648 < -2147483649, -2147483649 < -2147483648, and -2 placed ahead of -1, since those sequence numbers were generated in that order.\n\nI suggest that the sequence numbers be converted to unsigned numbers before being compared in the comparison functor that gets passed to qsort().\n\nThis leaves us with another issue.  When comparing unsigned sequence numbers, there is a slim chance that 4294967296 < 0.  So, I suggest that a fudge range be used, say, the number of nodes in the quorum * some fudge factor, in order to handle this comparison.\n\nPlease close this if I'm way off base here.", "created_at" : { "$date" : "2011-12-16T00:04:48.639+0000" }, "updated_at" : { "$date" : "2011-12-16T00:05:12.041+0000" }, "creator_id" : { "$oid" : "5b7d51fae9214a0d1608d939" }, "reporter_id" : { "$oid" : "5b7d51fae9214a0d1608d939" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "recipes" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Mac OS X Version 10.6.8\nDarwin emcclure-lt-mac.local 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386\nHomebrew 0.8" },
{ "_id" : { "$oid" : "5b7d51fb5f627d6b0586c597" }, "external_id" : "ZOOKEEPER-1319", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Missing data after restarting+expanding a cluster", "desc" : "I've been trying to update to ZK 3.4.0 and have had some issues where some data become inaccessible after adding a node to a cluster.  My use case is a bit strange (as explained before on this list) in that I try to grow the cluster dynamically by having an external program automatically restart Zookeeper servers in a controlled way whenever the list of participating ZK servers needs to change.  This used to work just fine in 3.3.3 (and before), so this represents a regression.\n\nThe scenario I see is this:\n\n1) Start up a 1-server ZK cluster (the server has ZK ID 0).\n2) A client connects to the server, and makes a bunch of znodes, in particular a znode called \"/membership\".\n3) Shut down the cluster.\n4) Bring up a 2-server ZK cluster, including the original server 0 with its existing data, and a new server with ZK ID 1.\n5) Node 0 has the highest zxid and is elected leader.\n6) A client connecting to server 1 tries to \"get /membership\" and gets back a -101 error code (no such znode).\n7) The same client then tries to \"create /membership\" and gets back a -110 error code (znode already exists).\n8) Clients connecting to server 0 can successfully \"get /membership\".\n\nI will attach a tarball with debug logs for both servers, annotating where steps #1 and #4 happen.  You can see that the election involves a proposal for zxid 110 from server 0, but immediately following the election server 1 has these lines:\n\n2011-12-05 17:18:48,308 9299 [QuorumPeer[myid=1]/127.0.0.1:2901] WARN org.apache.zookeeper.server.quorum.Learner  - Got zxid 0x100000001 expected 0x1\n2011-12-05 17:18:48,313 9304 [SyncThread:1] INFO org.apache.zookeeper.server.persistence.FileTxnLog  - Creating new log file: log.100000001\n\nPerhaps that's not relevant, but it struck me as odd.  At the end of server 1's log you can see a repeated cycle of getData->create->getData as the client tries to make sense of the inconsistent responses.\n\nThe other piece of information is that if I try to use the on-disk directories for either of the servers to start a new one-node ZK cluster, all the data are accessible.\n\nI haven't tried writing a program outside of my application to reproduce this, but I can do it very easily with some of my app's tests if anyone needs more information.", "created_at" : { "$date" : "2011-12-06T03:06:10.836+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:57.890+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [ "data", "cluster" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "Linux (Debian Squeeze)" },
{ "_id" : { "$oid" : "5b7d51fb5f627d6b0586c5c3" }, "external_id" : "ZOOKEEPER-1315", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper_init always reports sessionPasswd=<hidden>", "desc" : "zookeeper_init always reports sessionPasswd=<hidden> even when it's empty.", "created_at" : { "$date" : "2011-12-04T10:31:17.996+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:58.109+0000" }, "creator_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "reporter_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.4", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51fc5f627d6b0586c5d4" }, "external_id" : "ZOOKEEPER-1316", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper_init leaks memory if chroot is just '/'", "desc" : "zookeeper_init does not free strdup'ed memory when chroot is just '/'.\n", "created_at" : { "$date" : "2011-12-04T13:34:33.877+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:58.459+0000" }, "creator_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "reporter_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51fd5f627d6b0586c5e4" }, "external_id" : "ZOOKEEPER-1311", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper test jar is broken", "desc" : "In http://repo1.maven.org/maven2/org/apache/zookeeper/zookeeper/3.4.0/ the test jar cannot be accessed by maven. \n\nThere are two possible solutions to this. \na) rename zookeeper-3.4.0-test.jar to zookeeper-3.4.0-tests.jar and remove zookeeper-3.4.0-test.pom*\nWith this, the maven can access the test jar with\n\n{code}\n     <dependency>\n       <groupId>org.apache.zookeeper</groupId>\n       <artifactId>zookeeper</artifactId>\n       <version>3.4.0</version>\n       <type>test-jar</type>\n       <scope>test</scope>\n     </dependency>\n{code}\n\nb) Alternatively, zookeeper test could be it's own submodule. To do this, it must be deployed in the following layout\n{code}\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.jar\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.jar.md5\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.jar.sha1\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.pom\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.pom.md5\n./org/apache/zookeeper/zookeeper-test/3.4.0-BK-SNAPSHOT/zookeeper-test-3.4.0.pom.sha1\n{code}\n\nThis can then be accessed by maven with\n{code}\n     <dependency>\n       <groupId>org.apache.zookeeper</groupId>\n       <artifactId>zookeeper-test</artifactId>\n       <version>3.4.0</version>\n       <scope>test</scope>\n     </dependency>\n{code}\n\n\nI think a) is the better solution.\n", "created_at" : { "$date" : "2011-11-30T18:04:06.345+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:58.630+0000" }, "creator_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "reporter_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50c6e9214a0d1608d8b7" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51fe5f627d6b0586c5f3" }, "external_id" : "ZOOKEEPER-1269", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Multi deserialization issues", "desc" : "From the mailing list:\n\nFileTxnSnapLog.restore contains a code block handling a NODEEXISTS failure during deserialization. The problem is explained there in a code comment. The code block however is only executed for a CREATE txn, not for a multiTxn containing a CREATE.\n\nEven if the mentioned code block would also be executed for multi transactions, it needs adaption for multi transactions. What, if after the first failed transaction in a multi txn during deserialization, there would be subsequent transactions in the same multi that would also have failed?\nWe don't know, since the first failed transaction hides the information about the remaining transactions.\n", "created_at" : { "$date" : "2011-10-28T21:34:37.027+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:58.321+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51fe5f627d6b0586c610" }, "external_id" : "ZOOKEEPER-1317", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Possible segfault in zookeeper_init", "desc" : "zookeeper_init does not check the return value of strdup(index_chroot).\nWhen it returns NULL, it causes segfault when it try to strlen(zh->chroot).", "created_at" : { "$date" : "2011-12-04T13:48:10.434+0000" }, "updated_at" : { "$date" : "2011-12-17T01:33:59.004+0000" }, "creator_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "reporter_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.3.3", "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d51f5e9214a0d1608d935" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51ff5f627d6b0586c61f" }, "external_id" : "ZOOKEEPER-1332", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper data is not in sync with quorum in the mentioned scenario", "desc" : "Please check the below mentioned scenario:-\n\n1. Configure 3 zookeeper servers in quorum\n2. Start zk1 (F) and zk2(L) from a java client create a node(client connect to zk2)\n3. Stop the zk2 (L) \n4. Start the zk3, Now FLE is successful but zookeeper-3 is not having the node created \n\nIn step 4 Zookeeper-3 is getting a diff from the leader\n\n2011-12-19 20:15:59,379 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:Environment@98] - Server environment:user.home=/root\n2011-12-19 20:15:59,379 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:Environment@98] - Server environment:user.dir=/home/amith/OpenSrc/zookeeper/zookeeper3/bin\n2011-12-19 20:15:59,381 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:ZooKeeperServer@168] - Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir ../dataDir/version-2 snapdir ../dataDir/version-2\n2011-12-19 20:15:59,382 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:Follower@63] - FOLLOWING - LEADER ELECTION TOOK - 102\n2011-12-19 20:15:59,403 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:Learner@322] - Getting a diff from the leader 0x10000000a\n2011-12-19 20:15:59,449 [myid:3] - WARN  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:Learner@372] - Got zxid 0x10000000a expected 0x1\n2011-12-19 20:15:59,450 [myid:3] - INFO  [QuorumPeer[myid=3]/0:0:0:0:0:0:0:0:2183:FileTxnSnapLog@255] - Snapshotting: 10000000a\n\nbut in the diff all the required data is not obtained ...!\n\nHere I think zookeeper-3 should get snapshot from leader and not Diff", "created_at" : { "$date" : "2011-12-19T09:32:11.136+0000" }, "updated_at" : { "$date" : "2011-12-19T12:03:12.027+0000" }, "creator_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "reporter_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.1" ], "issue_links" : [  ], "environment" : "3 zookeeper quorum" },
{ "_id" : { "$oid" : "5b7d52005f627d6b0586c623" }, "external_id" : "ZOOKEEPER-1215", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client persisted cache", "desc" : "Motivation:\n1.  Reduce the impact of client restarts on zookeeper by implementing a persisted cache, and only fetching deltas on restart\n2.  Reduce unnecessary calls to zookeeper.\n3.  Improve performance of gets by caching on the client\n4.  Allow for larger caches than in memory caches.\n\nBehavior Change:\nZookeeper clients will not have the option to specify a folder path where it can cache zookeeper gets.  If they do choose to cache results, the zookeeper library will check the persisted cache before actually sending a request to zookeeper.  Watches will automatically be placed on all gets in order to invalidate the cache.  Alternatively, we can add a cache flag to the get API - thoughts?  On reconnect or restart, zookeeper clients will check the version number of each entries into its persisted cache, and will invalidate any old entries.  In checking version number, zookeeper clients will also place a watch on those files.  In regards to watches, client watch handlers will not fire until the invalidation step is completed, which may slow down client watch handling. Since setting up watches on all files is necessary on initialization, initialization will likely slow down as well.\n\nAPI Change:\nThe zookeeper library will expose a new init interface that specifies a folder path to the cache.  A new get API will specify whether or not to use cache, and whether or not stale data is safe to return if the connection is down.\n\nDesign:\nThe zookeeper handler structure will now include a cache_root_path (possibly null) string to cache all gets, as well as a bool for whether or not it is okay to serve stale data.  Old API calls will default to a null path (which signifies no cache), and signify that it is not okay to serve stale data.\n\nThe cache will be located at a cache_root_path.  All files will be placed at cache_root_path/file_path.  The cache will be an incomplete copy of everything that is in zookeeper, but everything in the cache will have the same relative path from the cache_root_path that it has as a path in zookeeper.  Each file in the cache will include the Statstructure and the file contents.\n\nzoo_get will check the zookeeper handler to determine whether or not it has a cache.  If it does, it will first go to the path to the persisted cache and append the get path.  If the file exists and it is not invalidated, the zookeeper client will read it and return its value.  If the file does not exist or is invalidated, the zookeeper library will perform the same get as is currently designed.  After getting the results, the library will place the value in the persisted cache for subsequent reads.  zoo_set will automatically invalidate the path in the cache.\n\nIf caching is requested, then on each zoo_get that goes through to zookeeper, a watch will be placed on the path. A cache watch handler will handle all watch events by invalidating the cache, and placing another watch on it.  Client watch handlers will handle the watch event after the cache watch handler.  The cache watch handler will not call zoo_get, because it is assumed that the client watch handlers will call zoo_get if they need the fresh data as soon as it is invalidated (which is why the cache watch handler must be executed first).\n\nAll updates to the cache will be done on a separate thread, but will be queued in order to maintain consistency in the cache.  In addition, all client watch handlers will not be fired until the cache watch handler completes its invalidation write in order to ensure that client calls to zoo_get in the watch event handler are done after the invalidation step.  This means that a client watch handler could be waiting on SEVERAL writes before it can be fired off, since all writes are queued.\n\nWhen a new connection is made, if a zookeeper handler has a cache, then that cache will be scanned in order to find all leaf nodes.  Calls will be made to zookeeper to check if all of these nodes still exist, and if they do, what their version number is.  Any inconsistencies in version will result in the cache invalidating the out of date files.  Any files that no longer exist will be deleted from the cache.\n \nIf a connection fails, and a zoo_get call is made on a zookeeper handler that has a cache associated with it, and that cache tolerates stale data, then the stale data will be returned from cache - otherwise, all zoo_gets will error out as they do today.", "created_at" : { "$date" : "2011-10-06T21:19:20.619+0000" }, "updated_at" : { "$date" : "2011-12-21T17:05:56.847+0000" }, "creator_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "reporter_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52005f627d6b0586c630" }, "external_id" : "ZOOKEEPER-1341", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "problem handling invalid multi op in processTxn", "desc" : "The handling of an invalid multi op in org.apache.zookeeper.server.DataTree.processTxn(TxnHeader, Record) is unusual, looks wrong to me.\n\nIn particular an IOException is thrown and then essentially ignored, it seems to me we should fail the operation properly instead. This will be more important if we add new op types going fwd.\n\nUse of assert is a bit suspect as well, however perhaps it's fine... not sure. (we don't explicitly turn on assertions in our tests so not sure how useful it is regardless)\n\nAlso notice that the catch of IOException is ignoring the result. It seems to me that handling this exception should be localized to the multi block (separate it out to it's own method seems like a good idea).\n\nWe should add a test for this case.", "created_at" : { "$date" : "2011-12-22T19:55:48.935+0000" }, "updated_at" : { "$date" : "2011-12-22T19:55:48.935+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52015f627d6b0586c631" }, "external_id" : "ZOOKEEPER-1292", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLETest is flaky", "desc" : "testLE in FLETest is convoluted, difficult to read, and doesn't test FLE appropriately. The goal of this jira is to clean it up and propose a more reasonable test case.", "created_at" : { "$date" : "2011-11-07T21:46:40.255+0000" }, "updated_at" : { "$date" : "2011-12-24T10:57:26.943+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52025f627d6b0586c646" }, "external_id" : "ZOOKEEPER-1089", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh status does not work due to invalid option of nc", "desc" : "The nc command used by zkServer.sh does not have the \"-q\" option on some linux versions ( I have checked RedHat/Fedora and FreeBSD).", "created_at" : { "$date" : "2011-06-09T13:57:16.209+0000" }, "updated_at" : { "$date" : "2011-12-28T10:58:21.821+0000" }, "creator_id" : { "$oid" : "5b7d51cee9214a0d1608d92d" }, "reporter_id" : { "$oid" : "5b7d51cee9214a0d1608d92d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52025f627d6b0586c66a" }, "external_id" : "ZOOKEEPER-1331", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Typo in docs: acheive -> achieve", "desc" : "Found this typo while reading docs.  Attaching SVN patch", "created_at" : { "$date" : "2011-12-19T07:10:54.362+0000" }, "updated_at" : { "$date" : "2011-12-28T10:58:22.063+0000" }, "creator_id" : { "$oid" : "5b7d5202e9214a0d1608d93a" }, "reporter_id" : { "$oid" : "5b7d5202e9214a0d1608d93a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.2.2" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5202e9214a0d1608d93a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52035f627d6b0586c67d" }, "external_id" : "ZOOKEEPER-1326", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The CLI commands \"delete\" and \"rmr\" are confusing. Can we have \"delete\" + \"deleteall\" instead?", "desc" : "ZOOKEEPER-729 introduced 'rmr' for recursive 'delete' operations on a given node. Going by the unix convention, wouldn't it be much better if we were to have an 'rm' if there was an 'rmr' added?\n\nThe current set is confusing. Or should we have 'delete' and 'deleteall' or summat?\n\nI know this is a nitpick, but I just dislike to see bad keywords used for commands.\n\nI'm OK to produce a backwards-compatible patch if this is acceptable.", "created_at" : { "$date" : "2011-12-11T19:56:10.682+0000" }, "updated_at" : { "$date" : "2011-12-28T16:13:37.972+0000" }, "creator_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "reporter_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_type" : "Wish", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52035f627d6b0586c67c" }, "effect" : "supercedes", "type" : "Supercedes" } ] },
{ "_id" : { "$oid" : "5b7d52045f627d6b0586c693" }, "external_id" : "ZOOKEEPER-730", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52035f627d6b0586c67c" }, "external_id" : "ZOOKEEPER-729", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52035f627d6b0586c67d" }, "effect" : "is superceded by", "type" : "Supercedes" }, { "issue_id" : { "$oid" : "5b7d52045f627d6b0586c693" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "created_at" : { "$date" : "2010-03-26T19:30:44.281+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50a8e9214a0d1608d8b3" }, "updated_at" : { "$date" : "2011-12-28T16:13:38.318+0000" }, "title" : "Recursively delete a znode  - zkCli.sh rmr /node", "issue_type" : "New Feature", "desc" : "Recursively delete a given znode in zookeeper, from the command-line. \n\nNew operation \"rmr\" added to zkclient. \n\n$ ./zkCli.sh rmr /node ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52055f627d6b0586c6dc" }, "external_id" : "ZOOKEEPER-1262", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Documentation for Lock recipe has major flaw", "desc" : "The recipe for Locks documented here: http://zookeeper.apache.org/doc/trunk/recipes.html#sc_recipes_Locks doesn't deal with the problem of create() succeeding but the server crashing before the result is returned. As written, if the server crashes before the result is returned the client can never know what sequential node was created for it. The way to deal with this is to embed the session ID in the node name. The Lock implementation in the ZK distro does this. But, the documentation will lead implementors to write bad code.", "created_at" : { "$date" : "2011-10-27T21:46:26.889+0000" }, "updated_at" : { "$date" : "2011-12-28T21:18:40.365+0000" }, "creator_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "reporter_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52065f627d6b0586c704" }, "external_id" : "ZOOKEEPER-1223", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C recipes includes <zookeeper.h> instead of <zookeeper/zookeeper.h>", "desc" : "according to ZOOKEEPER-1033, headers will be installed into \"PREFIX/zookeeper\" directory.\ni guess theses includes may also needed to be changed ? ", "created_at" : { "$date" : "2011-10-13T03:51:31.884+0000" }, "updated_at" : { "$date" : "2011-12-29T16:17:04.705+0000" }, "creator_id" : { "$oid" : "5b7d5129e9214a0d1608d8f5" }, "reporter_id" : { "$oid" : "5b7d5129e9214a0d1608d8f5" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "recipes" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 7200, "environment" : "CentOS 5" },
{ "_id" : { "$oid" : "5b7d52075f627d6b0586c706" }, "external_id" : "ZOOKEEPER-805", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52075f627d6b0586c708" }, "external_id" : "ZOOKEEPER-737", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some 4 letter words may fail with netcat (nc)", "desc" : "nc closes the write channel as soon as it's sent it's information, for example \"echo stat|nc localhost 2181\"\nin general this is fine, however the server code will close the socket as soon as it receives notice that nc has\nclosed it's write channel. if not all the 4 letter word result has been written back to the client yet, this will cause\nsome or all of the result to be lost - ie the client will not see the full result. this was introduced in 3.3.0 as part\nof a change to reduce blocking of the selector by long running 4letter words.\n\nhere's an example of the logs from the server during this\n\necho -n stat | nc localhost 2181\n2010-04-09 21:55:36,124 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:42179\n2010-04-09 21:55:36,124 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@968] - Processing stat command from /127.0.0.1:42179\n2010-04-09 21:55:36,125 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@606] - EndOfStreamException: Unable to read additional data from client sessionid 0x0, likely client has closed socket\n2010-04-09 21:55:36,125 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1286] - Closed socket connection for client /127.0.0.1:42179 (no session established for client)\n[phunt@gsbl90850 zookeeper-3.3.0]$ 2010-04-09 21:55:36,126 - ERROR [Thread-15:NIOServerCnxn@422] - Unexpected Exception: \njava.nio.channels.CancelledKeyException\n\tat sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n\tat sun.nio.ch.SelectionKeyImpl.interestOps(SelectionKeyImpl.java:59)\n\tat org.apache.zookeeper.server.NIOServerCnxn.sendBuffer(NIOServerCnxn.java:395)\n\tat org.apache.zookeeper.server.NIOServerCnxn$SendBufferWriter.checkFlush(NIOServerCnxn.java:907)\n\tat org.apache.zookeeper.server.NIOServerCnxn$SendBufferWriter.flush(NIOServerCnxn.java:945)\n\tat java.io.BufferedWriter.flush(BufferedWriter.java:236)\n\tat java.io.PrintWriter.flush(PrintWriter.java:276)\n\tat org.apache.zookeeper.server.NIOServerCnxn$2.run(NIOServerCnxn.java:1089)\n2010-04-09 21:55:36,126 - ERROR [Thread-15:NIOServerCnxn$Factory$1@82] - Thread Thread[Thread-15,5,main] died\njava.nio.channels.CancelledKeyException\n\tat sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n\tat sun.nio.ch.SelectionKeyImpl.interestOps(SelectionKeyImpl.java:64)\n\tat org.apache.zookeeper.server.NIOServerCnxn$SendBufferWriter.wakeup(NIOServerCnxn.java:927)\n\tat org.apache.zookeeper.server.NIOServerCnxn$SendBufferWriter.checkFlush(NIOServerCnxn.java:909)\n\tat org.apache.zookeeper.server.NIOServerCnxn$SendBufferWriter.flush(NIOServerCnxn.java:945)\n\tat java.io.BufferedWriter.flush(BufferedWriter.java:236)\n\tat java.io.PrintWriter.flush(PrintWriter.java:276)\n\tat org.apache.zookeeper.server.NIOServerCnxn$2.run(NIOServerCnxn.java:1089)\n", "created_at" : { "$date" : "2010-04-10T21:13:23.975+0000" }, "updated_at" : { "$date" : "2011-12-29T23:08:07.754+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.1", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52075f627d6b0586c707" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52075f627d6b0586c706" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52085f627d6b0586c756" }, "external_id" : "ZOOKEEPER-1323", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client doesn't compile on freebsd", "desc" : "EAI_NODATA and EAI_ADDRFAMILY have been deprecated in FreeBSD. I'm getting this error:\n\nsrc/zookeeper.c: In function `getaddrinfo_errno':\nsrc/zookeeper.c:446: error: `EAI_NODATA' undeclared (first use in this function)\nsrc/zookeeper.c:446: error: (Each undeclared identifier is reported only once\nsrc/zookeeper.c:446: error: for each function it appears in.)\nsrc/zookeeper.c: In function `getaddrs':\nsrc/zookeeper.c:581: error: `EAI_ADDRFAMILY' undeclared (first use in this function)\n\nI'll submit a patch.\n\n--Michi", "created_at" : { "$date" : "2011-12-09T01:28:16.547+0000" }, "updated_at" : { "$date" : "2011-12-29T23:46:53.970+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.2", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ], "environment" : "freebsd 6.4" },
{ "_id" : { "$oid" : "5b7d52085f627d6b0586c762" }, "external_id" : "ZOOKEEPER-1333", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NPE in FileTxnSnapLog when restarting a cluster", "desc" : "I think a NPE was created in the fix for https://issues.apache.org/jira/browse/ZOOKEEPER-1269\n\nLooking in DataTree.processTxn(TxnHeader header, Record txn) it seems likely that if rc.err != Code.OK then rc.path will be null. \n\nI'm currently working on a minimal test case for the bug, I'll attach it to this issue when it's ready.\n\njava.lang.NullPointerException\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.processTransaction(FileTxnSnapLog.java:203)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:150)\n\tat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:223)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.loadDataBase(QuorumPeer.java:418)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:410)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:151)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:111)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)\n\n\n", "created_at" : { "$date" : "2011-12-20T01:24:33.917+0000" }, "updated_at" : { "$date" : "2011-12-29T23:46:54.220+0000" }, "creator_id" : { "$oid" : "5b7d5208e9214a0d1608d93d" }, "reporter_id" : { "$oid" : "5b7d5208e9214a0d1608d93d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.2", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52095f627d6b0586c788" }, "external_id" : "ZOOKEEPER-1345", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add a .gitignore file with general exclusions and Eclipse project files excluded", "desc" : "I tried looking for an .gitignore file in the ZK sources but I could not find one.\n\nPreferably, we could add one with the following:\n\n{code}\n#\t.classpath\n#\t.eclipse/\n#\t.project\n#\t.revision/\n#\t.settings/\n#\tbuild/\n#\tsrc/c/generated/\n#\tsrc/java/generated/\n#\tsrc/java/lib/ant-eclipse-1.0-jvm1.2.jar\n#\tsrc/java/lib/ivy-2.2.0.jar\n{code}\n\nTo avoid losing much when doing \"git clean -fd\" and the likes while cleaning up the working repo dirs during development. This will aid those who use git mirrors for contributions a lot.", "created_at" : { "$date" : "2011-12-29T16:29:28.116+0000" }, "updated_at" : { "$date" : "2011-12-31T10:57:46.971+0000" }, "creator_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "reporter_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520a5f627d6b0586c795" }, "external_id" : "ZOOKEEPER-1229", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client hashtable_remove redundantly calls hash function", "desc" : "hashtable_remove appears to call the hash function in consecutive lines. As hash functions are generally cpu intensive, using the hashvalue returned from the first call will result in a performance improvement.\n\n{noformat}\nvoid * /* returns value associated with key */\nhashtable_remove(struct hashtable *h, void *k)\n...\n    unsigned int hashvalue, index;\n\n    hashvalue = hash(h,k);\n    index = indexFor(h->tablelength,hash(h,k));\n    pE = &(h->table[index]);\n    e = *pE;\n{noformat}", "created_at" : { "$date" : "2011-10-15T08:05:16.952+0000" }, "updated_at" : { "$date" : "2011-12-31T10:57:46.804+0000" }, "creator_id" : { "$oid" : "5b7d520ae9214a0d1608d93e" }, "reporter_id" : { "$oid" : "5b7d520ae9214a0d1608d93e" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d95f627d6b0586a604" }, "external_id" : "ZOOKEEPER-14", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50da5f627d6b0586a605" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-06-10T21:14:24.467+0000" }, "updated_at" : { "$date" : "2012-01-03T14:38:30.799+0000" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "priority" : "Major", "title" : "Connect timeouts not calculated properly", "issue_type" : "Bug", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1948097&group_id=209147&atid=1008544\n\nThere should be a better connection between connect timeout, ping timeout, and session timeout. On the Java client it is sessionTimeout/hostsList.length. On the C client it's just the readTimeout. There is also an arbitrary delay when we find that all the hosts are down.\n\nWe should come up with a good consistent story for the connect timeout. Since we leave sessionTimeout/3 ms for recovery from a down server, it seems most reasonable to have something like sessionTimeout/(3*hostsList.length).", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d520b5f627d6b0586c7a3" }, "external_id" : "ZOOKEEPER-1050", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zooinspector shell scripts do not work", "desc" : "* zooInspector-dev.sh uses DOS line endings.  Dash at least chokes on this.\n* zooInspector.sh has an errant ; in the classpath.\n\nAlso there really isn't a reason to hard code the zookeeper version needed in lib. Just use a glob.\n", "created_at" : { "$date" : "2011-04-21T00:46:22.316+0000" }, "updated_at" : { "$date" : "2012-01-06T10:57:24.570+0000" }, "creator_id" : { "$oid" : "5b7d520be9214a0d1608d93f" }, "reporter_id" : { "$oid" : "5b7d520be9214a0d1608d93f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "contrib" ], "labels" : [ "zooinspector" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5114e9214a0d1608d8ea" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520c5f627d6b0586c7b7" }, "external_id" : "ZOOKEEPER-1293", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove unused readyToStart from Leader.java", "desc" : "After ZOOKEEPER-1194 readyToStart is no longer used.", "created_at" : { "$date" : "2011-11-09T05:31:14.780+0000" }, "updated_at" : { "$date" : "2012-01-07T01:24:22.104+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520d5f627d6b0586c7cf" }, "external_id" : "ZOOKEEPER-1343", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "getEpochToPropose should check if lastAcceptedEpoch is greater or equal than epoch", "desc" : "The following block in Leader.getEpochToPropose:\n\n{noformat}\nif (lastAcceptedEpoch > epoch) {\n\tepoch = lastAcceptedEpoch+1;\n}\n{noformat}\n\nneeds to be fixed, since it doesn't increment the epoch variable in the case epoch != -1 (initial value) and lastAcceptedEpoch is equal. The fix trivial and corresponds to changing > with >=. ", "created_at" : { "$date" : "2011-12-23T12:44:25.347+0000" }, "updated_at" : { "$date" : "2012-01-09T22:50:23.567+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520d5f627d6b0586c7f5" }, "external_id" : "ZOOKEEPER-1351", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "invalid test verification in MultiTransactionTest", "desc" : "tests such as org.apache.zookeeper.test.MultiTransactionTest.testWatchesTriggered() are incorrect. Two issues I see\n\n1) zk.sync is async, there is no guarantee that the watcher will be called subsequent to sync returning\n\n{noformat}\n        zk.sync(\"/\", null, null);\n        assertTrue(watcher.triggered); /// incorrect assumption\n{noformat}\n\nThe callback needs to be implemented, only once the callback is called can we verify the trigger.\n\n2) trigger is not declared as volatile, even though it will be set in the context of a different thread (eventthread)\n\nSee https://builds.apache.org/view/S-Z/view/ZooKeeper/job/ZooKeeper-trunk-solaris/91/testReport/junit/org.apache.zookeeper.test/MultiTransactionTest/testWatchesTriggered/\nfor an example of a false positive failure\n\n{noformat}\njunit.framework.AssertionFailedError\n\tat org.apache.zookeeper.test.MultiTransactionTest.testWatchesTriggered(MultiTransactionTest.java:236)\n\tat org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)\n{noformat}\n", "created_at" : { "$date" : "2012-01-04T22:55:46.025+0000" }, "updated_at" : { "$date" : "2012-01-16T03:56:46.821+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520e5f627d6b0586c800" }, "external_id" : "ZOOKEEPER-1358", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "In StaticHostProviderTest.java, testNextDoesNotSleepForZero tests that hostProvider.next(0) doesn't sleep by checking that the latency of this call is less than 10sec", "desc" : "should check for something smaller, perhaps 1ms or 5ms", "created_at" : { "$date" : "2012-01-10T01:46:31.180+0000" }, "updated_at" : { "$date" : "2012-01-16T03:56:46.977+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d520f5f627d6b0586c80e" }, "external_id" : "ZOOKEEPER-1302", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "patch to create rpm/deb on 3.3 branch", "desc" : "backport zookeeper-999 patch to 3.3 branch and add zookeeper-setup-conf.sh to enable zk quorum setup", "created_at" : { "$date" : "2011-11-16T21:41:00.330+0000" }, "updated_at" : { "$date" : "2012-01-17T21:28:07.925+0000" }, "creator_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "reporter_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4fdde9214a0d1608d88c" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52105f627d6b0586c818" }, "external_id" : "ZOOKEEPER-1365", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Removing a duplicate function and another minor cleanup in QuorumPeer.java", "desc" : "- getMyId() and getId() in QuorumPeer are doing the same thing\n- QuorumPeer.quorumPeers is being read directly from outside QuorumPeer, although we have the getter QuorumPeers.getView(). \n\nThe purpose of this cleanup is to later be able to change more easily the way QuorumPeer manages its list of peers (to support dynamic changes in this list).", "created_at" : { "$date" : "2012-01-19T01:11:37.612+0000" }, "updated_at" : { "$date" : "2012-01-20T01:12:19.035+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52105f627d6b0586c821" }, "external_id" : "ZOOKEEPER-1368", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper c client get apis crash if zhandle is null", "desc" : "Although wget, awget, wexists, awexists, wgetchildren, awgetchildren will return ZBADARGUMENTS when zh is null, the get APIs will crash if you request a watch, as they dereference the zh without checking for null in order to get the watch function.", "created_at" : { "$date" : "2012-01-22T04:06:11.399+0000" }, "updated_at" : { "$date" : "2012-01-23T20:11:12.944+0000" }, "creator_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "reporter_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 604800 },
{ "_id" : { "$oid" : "5b7d52115f627d6b0586c823" }, "external_id" : "ZOOKEEPER-1369", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Mock access to time-related methods", "desc" : "As we began to discuss in ZOOKEEPER-1366, it would be great to have the ability to mock out time methods anywhere to help with deterministic, more efficient testing. \n\nThe general idea is to have a 'mock clock' that any thread can interact with as though it were the real clock. Time would typically be advanced by an independent thread of control (normally the thread that the test is running in). \n\nThere are two main method calls that interact with the JVM clock:\n\n# {{System.currentTimeMillis}} - very easy to mock\n# {{Thread.sleep}} - slightly harder, since the mock clock would need to keep an ordered list of threads that need to be woken up and release a barrier for each one as time was advanced. \n\nOther implicit methods, such as setting the socket rx timeout, are probably too hard to mock and are out of scope for this ticket. \n", "created_at" : { "$date" : "2012-01-23T20:47:09.937+0000" }, "updated_at" : { "$date" : "2012-01-23T20:47:09.937+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52125f627d6b0586c824" }, "external_id" : "ZOOKEEPER-1372", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "stat reports inconsistent zxids across servers after a leader change", "desc" : "I started a 2 server ensemble, made some changes to znodes, then shutdown the cluster. \n\nI then removed the datadir from the original leader. \n\nI then restarted the entire ensemble. \n\nafter this the new leader has a zxid of 0x400000000 while the follower reported a zxid of 0x300000007 (the last zxid of the old epoch). This was via stat. \n\nI then connected a client to the ensemble, subsequent to which the zxid was again in sync. The data all seemed fine, but stat was reporting invalid information until a client connected.\n\n", "created_at" : { "$date" : "2012-01-24T01:33:15.486+0000" }, "updated_at" : { "$date" : "2012-01-24T01:33:15.486+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.2" ], "components" : [ "quorum" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52125f627d6b0586c825" }, "external_id" : "ZOOKEEPER-973", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bind() could fail on Leader because it does not setReuseAddress on its ServerSocket ", "desc" : "setReuseAddress(true) should be used below.\n\n    Leader(QuorumPeer self,LeaderZooKeeperServer zk) throws IOException {\n        this.self = self;\n        try {\n            ss = new ServerSocket(self.getQuorumAddress().getPort());\n        } catch (BindException e) {\n            LOG.error(\"Couldn't bind to port \"\n                    + self.getQuorumAddress().getPort(), e);\n            throw e;\n        }\n        this.zk=zk;\n    }\n\n", "created_at" : { "$date" : "2011-01-05T06:47:52.723+0000" }, "updated_at" : { "$date" : "2012-01-24T10:59:50.924+0000" }, "creator_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "reporter_id" : { "$oid" : "5b7d50e7e9214a0d1608d8cb" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52135f627d6b0586c83f" }, "external_id" : "ZOOKEEPER-1012", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "support distinct JVMFLAGS for zookeeper server in zkServer.sh and zookeeper client in zkCli.sh", "desc" : "1. Sometimes you might want to run zkServer.sh with different JVMFLAGS than for clients. Make zkServer.sh consult the SERVER_JVMFLAGS variable and, if it exists, add it to the beginning of the existing JVMFLAGS setting.\n\n2. Sometimes you might want to run zkCli.sh with different JVMFLAGS than for servers. Make zkCli.sh consult the CLIENT_JVMFLAGS variable and, if it exists, add it to the beginning of the existing JVMFLAGS setting.", "created_at" : { "$date" : "2011-03-11T20:12:40.674+0000" }, "updated_at" : { "$date" : "2012-01-27T01:58:56.747+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "New Feature", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52135f627d6b0586c83e" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "original_time_estimate" : 300 },
{ "_id" : { "$oid" : "5b7d52145f627d6b0586c858" }, "external_id" : "ZOOKEEPER-747", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add C# generation to Jute", "desc" : "The following patch adds a new language, C#, to the Jute code generation.  The code that is generated does have a dependency on a third party library, Jon Skeet's MiscUtil, which is Apache licensed.  The library is necessary because C# does not provide big endian support in the base class libraries.\n\nAs none of the existing Jute code has any unit tests, I have not added tests for this patch.", "created_at" : { "$date" : "2010-04-22T03:17:33.431+0000" }, "updated_at" : { "$date" : "2012-01-30T17:25:20.647+0000" }, "creator_id" : { "$oid" : "5b7d5214e9214a0d1608d940" }, "reporter_id" : { "$oid" : "5b7d5214e9214a0d1608d940" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "jute" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d5214e9214a0d1608d940" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52145f627d6b0586c874" }, "external_id" : "ZOOKEEPER-661", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add Ruby bindings", "desc" : "Add Ruby bindings to the ZooKeeper distribution.\n\nRuby presents special threading difficulties for asynchronous ZK calls (aget, watchers, etc).  It looks like the simplest workaround is to patch the ZK C API.\n\nProposed approach will be described in comment.\n\nPlease use this ticket for discussion and suggestions.\n", "created_at" : { "$date" : "2010-01-30T18:42:39.630+0000" }, "updated_at" : { "$date" : "2012-02-03T17:02:51.476+0000" }, "creator_id" : { "$oid" : "5b7d504be9214a0d1608d89b" }, "reporter_id" : { "$oid" : "5b7d504be9214a0d1608d89b" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "contrib-bindings" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "MRI Ruby 1.9\nJRuby 1.4" },
{ "_id" : { "$oid" : "5b7d52155f627d6b0586c887" }, "external_id" : "ZOOKEEPER-1348", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper 3.4.2 C client incorrectly reports string version of 3.4.1", "desc" : "When running the 3.4.2 C client, it shows the following output:\n\nClient environment:zookeeper.version=zookeeper C client 3.4.1\n\nThis should show \"3.4.2\" not \"3.4.1\". The problem looks to be caused by stale autoconf files in the C directory. \n\ngrep -R \"zookeeper C client 3.4.1\" *                                                                                                                                                                     \n\nautom4te.cache/output.0:@%:@ Generated by GNU Autoconf 2.59 for zookeeper C client 3.4.1.\nautom4te.cache/output.0:PACKAGE_STRING='zookeeper C client 3.4.1'\nautom4te.cache/output.0:\\`configure' configures zookeeper C client 3.4.1 to adapt to many kinds of systems.\nautom4te.cache/output.0:     short | recursive ) echo \"Configuration of zookeeper C client 3.4.1:\";;\nautom4te.cache/output.1:@%:@ Generated by GNU Autoconf 2.59 for zookeeper C client 3.4.1.\nautom4te.cache/output.1:PACKAGE_STRING='zookeeper C client 3.4.1'\nautom4te.cache/output.1:\\`configure' configures zookeeper C client 3.4.1 to adapt to many kinds of systems.\nautom4te.cache/output.1:     short | recursive ) echo \"Configuration of zookeeper C client 3.4.1:\";;\nconfig.h:#define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:| #define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.log:PACKAGE_STRING='zookeeper C client 3.4.1'\nconfig.log:#define PACKAGE_STRING \"zookeeper C client 3.4.1\"\nconfig.status:s,@PACKAGE_STRING@,zookeeper C client 3.4.1,;t t\nconfig.status:${ac_dA}PACKAGE_STRING${ac_dB}PACKAGE_STRING${ac_dC}\"zookeeper C client 3.4.1\"${ac_dD}\nconfig.status:${ac_uA}PACKAGE_STRING${ac_uB}PACKAGE_STRING${ac_uC}\"zookeeper C client 3.4.1\"${ac_uD}\nconfigure:# Generated by GNU Autoconf 2.59 for zookeeper C client 3.4.1.\nconfigure:PACKAGE_STRING='zookeeper C client 3.4.1'\nconfigure:\\`configure' configures zookeeper C client 3.4.1 to adapt to many kinds of systems.\nconfigure:     short | recursive ) echo \"Configuration of zookeeper C client 3.4.1:\";;\nBinary file libzkmt_la-zookeeper.o matches\nMakefile:PACKAGE_STRING = zookeeper C client 3.4.1\n", "created_at" : { "$date" : "2011-12-31T02:58:03.750+0000" }, "updated_at" : { "$date" : "2012-02-06T08:20:35.524+0000" }, "creator_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "reporter_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.2" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52165f627d6b0586c88f" }, "external_id" : "ZOOKEEPER-1370", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add logging changes in Release Notes needed for clients because of ZOOKEEPER-850.", "created_at" : { "$date" : "2012-01-24T00:28:23.504+0000" }, "updated_at" : { "$date" : "2012-02-06T10:29:36.525+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52165f627d6b0586c893" }, "external_id" : "ZOOKEEPER-1338", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "class cast exceptions may be thrown by multi ErrorResult class (invalid equals)", "desc" : "There's a bug in ErrorResult and perhaps some of the other OpResult equals methods in multi.", "created_at" : { "$date" : "2011-12-22T00:30:25.828+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:03.558+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52185f627d6b0586c8a5" }, "external_id" : "ZOOKEEPER-1322", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cleanup/fix logging in Quorum code.", "desc" : "While triaging ZOOKEEPER-1319 I updated the code with the attached patch in order to help debug what was going on with that issue. I think it would be useful to include these changes in the project itself. ff to include in 3.4.1 or push to 3.5.0.\n\nYou should verify this with TRACE logging turned on in addition to INFO (default).", "created_at" : { "$date" : "2011-12-08T00:47:53.291+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:03.883+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52185f627d6b0586c8be" }, "external_id" : "ZOOKEEPER-1340", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "multi problem - typical user operations are generating ERROR level messages in the server", "desc" : "Multi operations run by users are generating ERROR level messages in the server log even though they are typical user level operations that are not in any way impacting the server, example:\n\n{noformat}\n2011-12-22 09:55:06,538 [myid:] - ERROR [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@545] - >>>> Got user-level KeeperException when processing sessionid:0x13466e9828c0000 type:multi cxid:0x3 zxid:0x2 txntype:2 reqpath:n/a Error Path:/nonexisting Error:KeeperErrorCode = NoNode for /nonexisting\n2011-12-22 09:55:06,538 [myid:] - ERROR [ProcessThread(sid:0 cport:-1)::PrepRequestProcessor@549] - >>>> ABORTING remaing MultiOp ops\n{noformat}\n\nThis is misleading. We should demote these messages to INFO level at the highest. (this is what we do for other such user operations, e.g. nonode)\n", "created_at" : { "$date" : "2011-12-22T18:03:07.479+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:03.250+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52195f627d6b0586c8cd" }, "external_id" : "ZOOKEEPER-1327", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "there are still remnants of hadoop urls", "desc" : "there are still hadoop urls and references to zookeeper lists under the hadoop project in the sources.", "created_at" : { "$date" : "2011-12-13T04:25:33.783+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:04.614+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5203e9214a0d1608d93b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521a5f627d6b0586c8f0" }, "external_id" : "ZOOKEEPER-1337", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "multi's \"Transaction\" class is missing tests.", "desc" : "Add tests for zookeeper client transaction() method.", "created_at" : { "$date" : "2011-12-22T00:19:59.746+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:04.486+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Test", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521b5f627d6b0586c906" }, "external_id" : "ZOOKEEPER-1336", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "javadoc for multi is confusing, references functionality that doesn't seem to exist ", "desc" : "There's this in org.apache.zookeeper.ZooKeeper.multi(Iterable<Op>)\n\n{noformat}\n     * Executes multiple Zookeeper operations or none of them.  On success, a list of results is returned.\n     * On failure, only a single exception is returned.  If you want more details, it may be preferable to\n     * use the alternative form of this method that lets you pass a list into which individual results are\n     * placed so that you can zero in on exactly which operation failed and why.\n{noformat}\n\nWhat is the \"alternate form of this method\" that's being referred to? Seems like we should add this functionality, or at the very least update the javadoc. (I don't think this is referring to Transaction, although the docs there are pretty thin)\n\n", "created_at" : { "$date" : "2011-12-21T23:24:38.478+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:04.339+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521b5f627d6b0586c91b" }, "external_id" : "ZOOKEEPER-1353", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client test suite fails consistently", "desc" : "When the c client test suite, zktest-mt, is run, it fails with this:\n\ntests/TestZookeeperInit.cc:233: Assertion: equality assertion failed [Expected: 2, Actual  : 22]\n\nThis was also reported in 3.3.1 here:\n\nhttp://www.mail-archive.com/zookeeper-dev@hadoop.apache.org/msg08914.html\n\nThe C client tests are making some assumptions that are not valid. getaddrinfo may have, at one time, returned ENOENT instead of EINVAL for the host given in the test. The assertion should simply be that EINVAL | ENOENT are given, so that builds on platforms which return ENOENT for this are not broken.\n\n", "created_at" : { "$date" : "2012-01-06T21:42:50.652+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:04.157+0000" }, "creator_id" : { "$oid" : "5b7d521be9214a0d1608d946" }, "reporter_id" : { "$oid" : "5b7d521be9214a0d1608d946" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.4" ], "components" : [ "c client", "tests" ], "labels" : [ "patch", "test" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d521be9214a0d1608d946" }, "issue_links" : [  ], "original_time_estimate" : 300, "environment" : "Ubuntu precise (dev release), amd64" },
{ "_id" : { "$oid" : "5b7d521c5f627d6b0586c932" }, "external_id" : "ZOOKEEPER-1352", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "server.InvalidSnapshotTest is using connection timeouts that are too short", "desc" : "InvalidSnapshotTest is using connection timeouts that are too short, see this false failure:\nhttps://builds.apache.org/job/ZooKeeper_branch33_solaris/65/testReport/junit/org.apache.zookeeper.server/InvalidSnapshotTest/testInvalidSnapshot/\n\n{noformat}\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /invalidsnap-0\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:90)\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:42)\n\tat org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:643)\n\tat org.apache.zookeeper.server.InvalidSnapshotTest.testInvalidSnapshot(InvalidSnapshotTest.java:71)\n{noformat}\n\nAlso in looking at the test itself it could use some cleanup (reuse features from ClientBase test utils)", "created_at" : { "$date" : "2012-01-05T19:12:19.840+0000" }, "updated_at" : { "$date" : "2012-02-06T10:58:04.028+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.4" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521d5f627d6b0586c945" }, "external_id" : "ZOOKEEPER-1123", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Can't connect to ZooKeeper server with the C client library from Solaris: connect() call fails.", "desc" : "I have a C app that runs on Solaris and connects to ZooKeeper which I run on Linux (just a single server instance, that's just a development setup).\n\nUpon calling zookeeper_init() I get logs that say connect() call fails. TCP-wise the client sends RST packet instead of the third part of the three-way handshake. Traced client syscalls below.\n\nSometimes the client is able to establish a connection - after half an hour of trying, or even longer. \n\nLogs\n====\n\nThe client logs:\n\n2011-07-11 16:20:22,954:13148(0xf):ZOO_ERROR@handle_socket_error_msg@1501: Socket [10.10.1.71:2181] zk retcode=-4, errno=0(Error 0): connect() call failed\n\nThe server logs:\n\n2011-07-11 16:20:22,950 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /10.10.9.27:34017                                                           \n2011-07-11 16:20:22,955 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@634] - EndOfStreamException: Unable to read additional data from client sessionid 0x0, likely client has closed socket     \n2011-07-11 16:20:22,955 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1435] - Closed socket connection for client /10.10.9.27:34017 (no session established for client)           \n\nSyscalls in the client:\n\n/15:    3516.6191       so_socket(PF_INET, SOCK_STREAM, IPPROTO_IP, \"\", SOV_DEFAULT) = 11                 \n/15:    3516.6192       setsockopt(11, tcp, TCP_NODELAY, 0xFD8A8ECC, 4, SOV_DEFAULT) = 0                  \n/15:    3516.6193       fcntl(11, F_GETFL)                              = 2                               \n/15:    3516.6194       fcntl(11, F_SETFL, FWRITE|FNONBLOCK)            = 0                               \n/15:    3516.6194       connect(11, 0x0813BA30, 16, SOV_DEFAULT)        Err#150 EINPROGRESS               \n/15:    3516.6195       write(2, \" 2 0 1 1 - 0 7 - 1 2   1\".., 23)      = 23                              \n <<< SNIP writing log message >>>                             \n/15:    3516.6204       write(2, \"\\n\", 1)                               = 1                               \n/15:    3516.6205       close(11)                                       = 0 \n\n\nWhat does work:\n===============\n\nUsing Java client on the same Solaris machine works without any problems. Connecting to the Linux server using C client library on Linux works OK (though I tested it within one box, via loopback interface).", "created_at" : { "$date" : "2011-07-12T11:03:06.878+0000" }, "updated_at" : { "$date" : "2012-02-08T19:28:58.349+0000" }, "creator_id" : { "$oid" : "5b7d521de9214a0d1608d947" }, "reporter_id" : { "$oid" : "5b7d521de9214a0d1608d947" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Client: Solaris 5.10, x86 machine.\nServer: Linux Fedora 14" },
{ "_id" : { "$oid" : "5b7d521d5f627d6b0586c947" }, "external_id" : "ZOOKEEPER-1321", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add number of client connections metric in JMX and srvr", "desc" : "The related conversation on the zookeeper user mailing list is here - http://apache.markmail.org/message/4jjcmooniowwugu2?q=+list:org.apache.hadoop.zookeeper-user\n\nIt is useful to be able to monitor the number of disconnect operations on a client. This is generally indicative of a client going through large number of GC and hence disconnecting way too often from a zookeeper cluster. \n\nToday, this information is only indirectly exposed as part of the stat command which requires counting the results. That's alot of work for the server to do just to get connection count. \n\nFor monitoring purposes, it will be useful to have this exposed through JMX and 4lw srvr.\n", "created_at" : { "$date" : "2011-12-07T16:19:11.986+0000" }, "updated_at" : { "$date" : "2012-02-11T00:16:38.812+0000" }, "creator_id" : { "$oid" : "5b7d521de9214a0d1608d949" }, "reporter_id" : { "$oid" : "5b7d521de9214a0d1608d949" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.2" ], "components" : [  ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d521de9214a0d1608d949" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521e5f627d6b0586c979" }, "external_id" : "ZOOKEEPER-1389", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "it would be nice if start-foreground used exec $JAVA in order to get rid of the intermediate shell process", "desc" : "A log of daemon management tools expect a process itself to be running as a child instead of a grand-child. It would be nice if we had an option for that in zkServer.sh", "created_at" : { "$date" : "2012-02-08T19:42:33.425+0000" }, "updated_at" : { "$date" : "2012-02-16T10:55:20.708+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.2" ], "components" : [ "server", "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.3.5", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521f5f627d6b0586c986" }, "external_id" : "ZOOKEEPER-1396", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create zoo_append API", "desc" : "I was trying to append data to a znode from the C library and I realized the workflow for that is pretty unfortunate. Essentially you need to do the following:\n\n- call zoo_exists to get the Stat structure which contains the data length of the znode\n- Allocate that many bytes plus how many you are adding to the znode dynamically in a buffer\n- call zoo_get to get the data for the znode\n- append the data you are append'ing to the znode in your local buffer\n- call zoo_set to set the data back into the znode\n\nIf between the zoo_set and the zoo_get the data changes, sorry! You have to start from scratch. For a case where multiple consumers are trying to append data to a znode, this can become a nuisance. If there existed a zoo_append API, the workflow would become:\n\n- call zoo_append to append the data into the znode\n- If that fails, call zoo_set to create the znode with the data\n\nAssuming zoo_append wouldn't create the znode. This would mean fewer round trips against the server and simpler code. Even the Java library, which wouldn't need to worry about calling zoo_exists, would have one fewer round trip in the typical case.\n\nIs this a typical workflow for people? Would anyone else find this API valuable?", "created_at" : { "$date" : "2012-02-22T01:36:11.166+0000" }, "updated_at" : { "$date" : "2012-02-22T01:36:11.166+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d521f5f627d6b0586c987" }, "external_id" : "ZOOKEEPER-1399", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Binary Jar in zookeeper-3.3.4 displays wrong version when run", "desc" : "When you start up zookeeper using the jar in zookeeper-3.3.4.tar.gz, it prints a 3.3.3 version string:\n\nserver.ZooKeeperServer  - Server environment:zookeeper.version=3.3.3-1203054, built on 11/17/2011 05:47 GMT\nserver.ZooKeeperServer  - Server environment:java.class.path=/usr/lib/zookeeper/apache-rat-tasks-0.6.jar:/usr/lib/zookeeper/commons-lang-2.4.jar:/usr/lib/zookeeper/commons-cli-1.1.jar:/usr/lib/zookeeper/log4j-1.2.15.jar:/usr/lib/zookeeper/commons-collections-3.2.jar:/usr/lib/zookeeper/apache-rat-core-0.6.jar:/usr/lib/zookeeper/jline-0.9.94.jar:/usr/lib/zookeeper/zookeeper-3.3.4.jar:/etc/zookeeper\n\nI assume this is due to a build problem of some form. (Rebuilding the jar from the tarball fixes the version).\n", "created_at" : { "$date" : "2012-02-23T02:16:32.430+0000" }, "updated_at" : { "$date" : "2012-02-23T02:16:32.430+0000" }, "creator_id" : { "$oid" : "5b7d521fe9214a0d1608d94a" }, "reporter_id" : { "$oid" : "5b7d521fe9214a0d1608d94a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.4" ], "components" : [ "build", "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52205f627d6b0586c988" }, "external_id" : "ZOOKEEPER-1393", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper client exists() javadoc incorrectly states watcher(s) will be triggered on node deletion", "desc" : "I found it very misleading that the javadoc for the exists() calls that take a boolean or a Watcher state that 'The watch will be triggered by a successful operation that creates/delete the node or sets the data on the node.'\n\nWhat I've seen from descriptions of bugs (older but this is this references it http://zookeeper-user.578899.n2.nabble.com/Exists-Watch-Triggered-by-Delete-td1490893.html) and my own personal usage is that watchers set on exists() are triggered when a non-existing node is now created or an existing node is changed.  They are NOT triggered when the node already exists and is deleted.\n\nhttp://zookeeper.apache.org/doc/r3.4.3/api/index.html", "created_at" : { "$date" : "2012-02-15T19:11:15.403+0000" }, "updated_at" : { "$date" : "2012-02-25T18:41:42.414+0000" }, "creator_id" : { "$oid" : "5b7d5220e9214a0d1608d94b" }, "reporter_id" : { "$oid" : "5b7d5220e9214a0d1608d94b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.2" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 1200 },
{ "_id" : { "$oid" : "5b7d52215f627d6b0586c98c" }, "external_id" : "ZOOKEEPER-1309", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Creating a new ZooKeeper client can leak file handles", "desc" : "If there is an IOException thrown by the constructor of ClientCnxn then file handles are leaked because of the initialization of the Selector which is never closed.\n\n    final Selector selector = Selector.open();\n\nIf there is an abnormal exit from the constructor then the Selector is not closed and file handles are leaked.  You can easily see this by setting the hosts string to garbage (\"qwerty\", \"asdf\", etc.) and then try to open a new ZooKeeper connection.  I've observed the same behavior in production when there were DNS issues where the host names of the ensemble can no longer be resolved and the application servers quickly run out of handles attempting to (re)connect to zookeeper.", "created_at" : { "$date" : "2011-11-29T02:03:52.794+0000" }, "updated_at" : { "$date" : "2012-02-27T00:32:13.486+0000" }, "creator_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "reporter_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.4" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.5" ], "assignee_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52225f627d6b0586c9bd" }, "external_id" : "HADOOP-8019", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52225f627d6b0586c9be" }, "external_id" : "ZOOKEEPER-1386", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "avoid flaky URL redirection in \"ant javadoc\" : replace \"http://java.sun.com/javase/6/docs/api/\" with \"http://download.oracle.com/javase/6/docs/api/\" ", "desc" : "It seems that the current javadoc.link.java value, http://java.sun.com/javase/6/docs/api/, redirects (via HTTP 301) to http://download.oracle.com/javase/6/docs/api/. This redirect does not always work apparently, causing the URL fetch to fail. This causes an additional javadoc warning: \n\njavadoc: warning - Error fetching URL: http://java.sun.com/javase/6/docs/api/package-list\n\nwhich can in turn cause Jenkins to give a -1 to an otherwise OK build (see e.g. https://issues.apache.org/jira/browse/ZOOKEEPER-1373?focusedCommentId=13199456&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13199456). \n\n", "created_at" : { "$date" : "2012-02-03T19:14:37.967+0000" }, "updated_at" : { "$date" : "2012-02-28T00:23:06.667+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.3.5", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52225f627d6b0586c9bd" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52225f627d6b0586c9cc" }, "external_id" : "ZOOKEEPER-1354", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "AuthTest.testBadAuthThenSendOtherCommands fails intermittently", "desc" : "I'm seeing the following intermittent failure:\n\n{noformat}\njunit.framework.AssertionFailedError: Should have called my watcher expected:<1> but was:<0>\n\tat org.apache.zookeeper.test.AuthTest.testBadAuthThenSendOtherCommands(AuthTest.java:89)\n\tat org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)\n{noformat}\n\nThe following commit introduced this test:\n\nbq. ZOOKEEPER-1152. Exceptions thrown from handleAuthentication can cause buffer corruption issues in NIOServer. (camille via breed)\n\n+            Assert.assertEquals(\"Should have called my watcher\",\n+                    1, authFailed.get());\n\nI think it's due to either a) the code is not waiting for the\nnotification to be propagated, or 2) the message doesn't make it back\nfrom the server to the client prior to the socket or the clientcnxn\nbeing closed.\n\nWhat do you think, should I just wait for the notification to arrive? or do you think it's 2). ?\n\n", "created_at" : { "$date" : "2012-01-07T01:10:24.276+0000" }, "updated_at" : { "$date" : "2012-03-02T03:21:33.811+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52235f627d6b0586c9de" }, "external_id" : "ZOOKEEPER-1405", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "leader election recipe sample code - dispatchEvent invocations can get out of order", "desc" : "Since the process method is not synchronized in org.apache.zookeeper.recipes.election.LeaderElectionSupport, therefore there is a race condition where events coming in from the watch may overtake the events dispatched during the start method. \n\nA solution to ensure that events dispatched during the start method are handled before any watch-based events is to make the process method synchronized.", "created_at" : { "$date" : "2012-03-05T13:42:15.705+0000" }, "updated_at" : { "$date" : "2012-03-06T12:10:55.369+0000" }, "creator_id" : { "$oid" : "5b7d5223e9214a0d1608d94c" }, "reporter_id" : { "$oid" : "5b7d5223e9214a0d1608d94c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "recipes" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52245f627d6b0586c9e0" }, "external_id" : "ZOOKEEPER-1161", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Provide an option for disabling auto-creation of the data directory", "desc" : "Currently if ZK starts and doesn't see and existing dataDir it tries to create it. There should be an option to tweak this behavior. As for default, my personal opinion is to NOW allow autocreate.", "created_at" : { "$date" : "2011-08-24T20:17:43.563+0000" }, "updated_at" : { "$date" : "2012-03-07T10:58:06.654+0000" }, "creator_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "reporter_id" : { "$oid" : "5b7d5109e9214a0d1608d8da" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server", "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52245f627d6b0586c9ff" }, "external_id" : "ZOOKEEPER-1415", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper broadcasts host's hostname instead of IP when ecf.exported.containerfactoryargs property is not set", "desc" : "Not setting the ecf.exported.containerfactoryargs property when publishing an OSGi service through Zookeeper results in the service being published under the host's hostname instead of its IP. This means that hosts not able to correctly resolve that hostname cannot connect to its ZooKeeper instance. It would be desirable to use the IP instead of the hostname when that property is purposely left blank e.g. when it is unknown where the application will be deployed.", "created_at" : { "$date" : "2012-03-14T19:06:41.371+0000" }, "updated_at" : { "$date" : "2012-03-14T19:06:41.371+0000" }, "creator_id" : { "$oid" : "5b7d5224e9214a0d1608d94d" }, "reporter_id" : { "$oid" : "5b7d5224e9214a0d1608d94d" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "osgi" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Any OS, any Java version. The issue presents itself when using the osgi bundles org.apache.hadoop.zookeeper and org.eclipse.ecf.provider.zookeeper inside an Eclipse Equinox framework. I did not test on any other versions." },
{ "_id" : { "$oid" : "5b7d52255f627d6b0586ca00" }, "external_id" : "ZOOKEEPER-1390", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "some expensive debug code not protected by a check for debug", "desc" : "there is some expensive debug code in DataTree.processTxn() that formats transactions for debugging that are very expensive but are only used when errors happen and when debugging is turned on.", "created_at" : { "$date" : "2012-02-10T05:12:45.448+0000" }, "updated_at" : { "$date" : "2012-03-17T16:07:08.674+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52255f627d6b0586ca12" }, "external_id" : "ZOOKEEPER-1401", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Extract generally useful client utilities from CLI code  ", "desc" : "There are a bunch of things that would be useful/reusable from ZK Java client, such as ACL parsing. Also, it would be nice to see other utilities for dealing with path creation (\"mkdir -p ...\") readily available for clients rather than implementing in downstream projects. Some of this can be seen in HIVE-2712.\n", "created_at" : { "$date" : "2012-02-24T18:12:54.919+0000" }, "updated_at" : { "$date" : "2012-03-17T19:59:26.138+0000" }, "creator_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "reporter_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52255f627d6b0586ca11" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52265f627d6b0586ca15" }, "external_id" : "ZOOKEEPER-1397", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove BookKeeper documentation links", "desc" : "BookKeeper is now a subproject and its documentation is maintained in the site of the subproject. Consequently, we should remove the links in the zookeeper documentation pages or at least point to the documentation of the subproject site.", "created_at" : { "$date" : "2012-02-22T08:20:56.528+0000" }, "updated_at" : { "$date" : "2012-03-17T23:11:56.901+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52275f627d6b0586ca22" }, "external_id" : "ZOOKEEPER-1344", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper client multi-update command is not considering the Chroot request", "desc" : "For example: \nI have created a ZooKeeper client with subtree as \"10.18.52.144:2179/apps/X\". Now just generated OP command for the creation of zNode \"/myId\". When the client creates the path \"/myid\", the ZooKeeper server is actually be creating the path as \"/myid\" instead of creating as \"/apps/X/myid\"\n\nExpected output: zNode has to be created as \"/apps/X/myid\"", "created_at" : { "$date" : "2011-12-26T13:36:28.490+0000" }, "updated_at" : { "$date" : "2012-03-18T04:54:23.776+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52285f627d6b0586ca48" }, "external_id" : "ZOOKEEPER-1320", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add the feature to zookeeper allow client limitations by ip.", "desc" : "Add the feature to zookeeper so that administrator can set the list of ips that limit which nodes can connect to the zk servers and which connected clients can operate on data.", "created_at" : { "$date" : "2011-12-06T10:43:04.072+0000" }, "updated_at" : { "$date" : "2012-03-18T06:28:43.245+0000" }, "creator_id" : { "$oid" : "5b7d51f5e9214a0d1608d934" }, "reporter_id" : { "$oid" : "5b7d51f5e9214a0d1608d934" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [ "client,server,limited,ipfilter" ], "resolution" : "Incomplete", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d51f5e9214a0d1608d934" }, "issue_links" : [  ], "original_time_estimate" : 604800, "environment" : "Linux version 2.6.18-164.el5 (gcc version 4.1.2 20080704 (Red Hat 4.1.2-46)), jdk-1.6.0_17" },
{ "_id" : { "$oid" : "5b7d52285f627d6b0586ca5f" }, "external_id" : "ZOOKEEPER-1403", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCli.sh script quoting issue", "desc" : "The zkCli.sh script included with zookeeper doesn't quote its parameters\ncorrectly when passing them on to the java program. \n\nThis causes issues with arguments with spaces and such.\n", "created_at" : { "$date" : "2012-03-02T11:12:37.826+0000" }, "updated_at" : { "$date" : "2012-03-18T11:00:39.611+0000" }, "creator_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "reporter_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.3" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d51b8e9214a0d1608d928" }, "issue_links" : [  ], "environment" : "Ubuntu/Debian" },
{ "_id" : { "$oid" : "5b7d52295f627d6b0586ca6d" }, "external_id" : "ZOOKEEPER-1406", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "dpkg init scripts don't restart - missing check_priv_sep_dir", "desc" : "The included init.d script for dpkg creation doesn't restart.\n\nIt exits with the following error:\n\n{quote}\n\\# /etc/init.d/zookeeper restart\n/etc/init.d/zookeeper: 127: check_privsep_dir: not found\n{quote}\n\nAlso the actual zkServer.sh line in restart has a path of .../bin/ rather than .../sbin/\n\n", "created_at" : { "$date" : "2012-03-06T09:14:03.218+0000" }, "updated_at" : { "$date" : "2012-03-18T11:00:40.048+0000" }, "creator_id" : { "$oid" : "5b7d5229e9214a0d1608d950" }, "reporter_id" : { "$oid" : "5b7d5229e9214a0d1608d950" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5229e9214a0d1608d950" }, "issue_links" : [  ], "environment" : "Linux Ubuntu 10.4 lucid - presumably affects debian too, but not tested here" },
{ "_id" : { "$oid" : "5b7d522a5f627d6b0586ca7d" }, "external_id" : "ZOOKEEPER-1377", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add support for dumping a snapshot file content (similar to LogFormatter)", "desc" : "We have LogFormatter but not SnapshotFormatter. I've added this, patch momentarily.", "created_at" : { "$date" : "2012-01-27T18:45:20.850+0000" }, "updated_at" : { "$date" : "2012-03-18T22:26:02.982+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d522a5f627d6b0586ca8e" }, "external_id" : "ZOOKEEPER-1275", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper client is only caller of server.DataTree.copyStat()", "desc" : "This static method should be moved out of the o.a.z.server package. To my knowledge it is the only coupling of ZK client code to server code and the server doesn't even call this method.", "created_at" : { "$date" : "2011-11-01T10:01:40.666+0000" }, "updated_at" : { "$date" : "2012-03-19T06:18:47.768+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "build", "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51415f627d6b0586ac74" } },
{ "_id" : { "$oid" : "5b7d522b5f627d6b0586ca99" }, "external_id" : "ZOOKEEPER-1384", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "test-cppunit overrides LD_LIBRARY_PATH and fails if gcc is in non-standard location", "desc" : "On Linux with gcc installed in /usr/local and the libs in /usr/local/lib64, test-core-cppunit fails because zktest-st is unable to find the right libstdc++.\n\nbuild.xml is overriding the environment LD_LIBRARY_PATH instead of appending to it. This should be changed to match the treatment of PATH by appending the desired extra path.", "created_at" : { "$date" : "2012-02-01T00:51:33.297+0000" }, "updated_at" : { "$date" : "2012-03-19T11:00:02.427+0000" }, "creator_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "reporter_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.2" ], "components" : [ "build", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d522c5f627d6b0586caa9" }, "external_id" : "ZOOKEEPER-1419", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader election never settles for a 5-node cluster", "desc" : "We have a situation where it seems to my untrained eye that leader election never finishes for a 5-node cluster.  In this test, all nodes are ZK 3.4.3 and running on the same server (listening on different ports, of course).  The nodes have server IDs of 0, 1, 2, 3, 4.  The test brings up the cluster in different configurations, adding in a new node each time.  We embed ZK in our application, so when we shut a node down and restart it with a new configuration, it all happens in a single JVM process.  Here's our server startup code (for the case where there's more than one node in the cluster):\n\n{code}\nif (servers.size() > 1) {\n    _log.debug(\"Starting Zookeeper server in quorum server mode\");\n\n    _quorum_peer = new QuorumPeer();\n    synchronized(_quorum_peer) {\n        _quorum_peer.setClientPortAddress(clientAddr);\n        _quorum_peer.setTxnFactory(log);\n        _quorum_peer.setQuorumPeers(servers);\n        _quorum_peer.setElectionType(_election_alg);\n        _quorum_peer.setMyid(_server_id);\n        _quorum_peer.setTickTime(_tick_time);\n        _quorum_peer.setInitLimit(_init_limit);\n        _quorum_peer.setSyncLimit(_sync_limit);\n        QuorumVerifier quorumVerifier =\n            new QuorumMaj(servers.size());\n        _quorum_peer.setQuorumVerifier(quorumVerifier);\n        _quorum_peer.setCnxnFactory(_cnxn_factory);\n        _quorum_peer.setZKDatabase(new ZKDatabase(log));\n        _quorum_peer.start();\n    }\n} else {\n    _log.debug(\"Starting Zookeeper server in single server mode\");\n    _zk_server = new ZooKeeperServer();\n    _zk_server.setTxnLogFactory(log);\n    _zk_server.setTickTime(_tick_time);\n    _cnxn_factory.startup(_zk_server);\n}\n{code}\n\nAnd here's our shutdown code:\n\n{code}\nif (_quorum_peer != null) {\n    synchronized(_quorum_peer) {\n        _quorum_peer.shutdown();\n        FastLeaderElection fle =\n            (FastLeaderElection) _quorum_peer.getElectionAlg();\n        fle.shutdown();\n        try {\n            _quorum_peer.getTxnFactory().commit();\n        } catch (java.nio.channels.ClosedChannelException e) {\n            // ignore\n        }\n    }\n} else {\n    _cnxn_factory.shutdown();\n    _zk_server.getTxnLogFactory().commit();\n}\n{code}\n\nThe test steps through the following scenarios in quick succession:\n\nRun 1: Start a 1-node cluster, servers=[0]\nRun 2: Start a 2-node cluster, servers=[0,3]\nRun 3: Start a 3-node cluster, servers=[0,1,3]\nRun 4: Start a 4-node cluster, servers=[0,1,2,3]\nRun 5: Start a 5-node cluster, servers=[0,1,2,3,4]\n\nIt appears that run 5 never elects a leader -- the nodes just keep spewing messages like this (example from node 0):\n\n{noformat}\n2012-03-14 16:23:12,775 13308 [WorkerSender[myid=0]] DEBUG org.apache.zookeeper.server.quorum.QuorumCnxManager  - There is a connection already for server 2\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - Sending Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), 3 (recipient), 0 (myid), 0x2 (n.peerEpoch)\n2012-03-14 16:23:12,776 13309 [WorkerSender[myid=0]] DEBUG org.apache.zookeeper.server.quorum.QuorumCnxManager  - There is a connection already for server 3\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - Sending Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), 4 (recipient), 0 (myid), 0x2 (n.peerEpoch)\n2012-03-14 16:23:12,776 13309 [WorkerSender[myid=0]] DEBUG org.apache.zookeeper.server.quorum.QuorumCnxManager  - There is a connection already for server 4\n2012-03-14 16:23:12,776 13309 [WorkerReceiver[myid=0]] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - Receive new notification message. My id = 0\n2012-03-14 16:23:12,776 13309 [WorkerReceiver[myid=0]] INFO org.apache.zookeeper.server.quorum.FastLeaderElection  - Notification: 4 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)\n2012-03-14 16:23:12,776 13309 [WorkerReceiver[myid=0]] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - Receive new notification message. My id = 0\n2012-03-14 16:23:12,776 13309 [WorkerReceiver[myid=0]] INFO org.apache.zookeeper.server.quorum.FastLeaderElection  - Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - Adding vote: from=1, proposed leader=3, proposed zxid=0x0, proposed election epoch=0x1\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - id: 3, proposed id: 3, zxid: 0x0, proposed zxid: 0x0\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - id: 3, proposed id: 3, zxid: 0x0, proposed zxid: 0x0\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - id: 3, proposed id: 3, zxid: 0x0, proposed zxid: 0x0\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - id: 4, proposed id: 3, zxid: 0x0, proposed zxid: 0x0\n2012-03-14 16:23:12,776 13309 [QuorumPeer[myid=0]/127.0.0.1:2900] DEBUG org.apache.zookeeper.server.quorum.FastLeaderElection  - id: 4, proposed id: 3, zxid: 0x0, proposed zxid: 0x0\n{noformat}\n\nI'm guessing this means that nodes 3 and 4 are fighting over leadership, but I don't know enough about the leader election code to debug this any further.  Attaching a tarball with the logs for each run and the data directories for each node (though I don't think any data is being written to ZK during the test).", "created_at" : { "$date" : "2012-03-16T00:07:45.489+0000" }, "updated_at" : { "$date" : "2012-03-20T01:19:02.335+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ], "environment" : "64-bit Linux, all nodes running on the same machine (different ports)" },
{ "_id" : { "$oid" : "5b7d522c5f627d6b0586cad1" }, "external_id" : "ZOOKEEPER-1429", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Response packet caching for get request", "desc" : "Motivation:\nIn our scalability testing, we have a large number of clients watching for data changes. All of them fetch data immediately when a watch is fired. We found that GC consumes significant amount of CPU time in this scenario. In our prototype, we added packet caching for getData() request and found that GC time reduced by 40%. GC that we used is Concurrent Mark Sweep Collector. \n\nDesign and Implementation:\nSimilar to our prototype, we plan to add packet caching for getData() request using LRU caching. The cache stores serializes response (data + stat) in form of ByteBuffer indexed by its pathname. The cache entry is invalidated when there is a set request that affect the data. \nThe data structure that we plan to use for LRU cache is CacheBuilder [http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/CacheBuilder.html] because it provides many tunable features that we try and use in the future. Currently, the eviction policy will be based on memory size. Otherwise, we can implement it using LinkedHashMap if we do not want to rely on external library.  \n", "created_at" : { "$date" : "2012-03-21T17:58:43.635+0000" }, "updated_at" : { "$date" : "2012-03-21T17:58:43.635+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [ "performance" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d522d5f627d6b0586cad2" }, "external_id" : "ZOOKEEPER-1418", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Just a bug in the tutorial code on the website", "desc" : "When I ran the Queue example from here: http://zookeeper.apache.org/doc/trunk/zookeeperTutorial.html\nThe producer created entries of the form:  /app1/element0000000001...\nbut the consumer tried to consume of the form:  /app1/element1...\n\nadding a patch with the file attached.", "created_at" : { "$date" : "2012-03-15T21:11:54.009+0000" }, "updated_at" : { "$date" : "2012-03-22T14:49:10.141+0000" }, "creator_id" : { "$oid" : "5b7d522de9214a0d1608d953" }, "reporter_id" : { "$oid" : "5b7d522de9214a0d1608d953" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522de9214a0d1608d953" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51b25f627d6b0586bcf4" }, "external_id" : "ZOOKEEPER-1278", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d522e5f627d6b0586cae1" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51865f627d6b0586b5ec" }, "effect" : "is broken by", "type" : "Regression" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2011-11-02T16:54:43.577+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2012-03-23T00:36:10.190+0000" }, "title" : "acceptedEpoch not handling zxid rollover in lower 32bits", "issue_type" : "Bug", "desc" : "When the lower 32bits of a zxid \"roll over\" (zxid is a 64 bit number, however the upper 32 are considered the epoch number) the epoch number (upper 32 bits) are incremented and the lower 32 start at 0 again.\n\nThis should work fine, however, afaict, in the current 3.4/3.5 the acceptedEpoch/currentEpoch files are not being updated for this case.\n\nSee ZOOKEEPER-335 for changes from 3.3 branch.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d522e5f627d6b0586caed" }, "external_id" : "ZOOKEEPER-1434", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCli crashes with NPE on stat of non-existent path", "desc" : "In the command line client (zkCli.sh), when I do\n\n{noformat}\nstat /non-existent\n{noformat}\n\nthe client crashes with\n\n{noformat}\nException in thread \"main\" java.lang.NullPointerException\n\tat org.apache.zookeeper.ZooKeeperMain.printStat(ZooKeeperMain.java:130)\n\tat org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:722)\n\tat org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:581)\n\tat org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:353)\n\tat org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:311)\n\tat org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:270)\n{noformat}\n", "created_at" : { "$date" : "2012-03-27T00:06:47.132+0000" }, "updated_at" : { "$date" : "2012-03-27T00:41:27.696+0000" }, "creator_id" : { "$oid" : "5b7d522ee9214a0d1608d954" }, "reporter_id" : { "$oid" : "5b7d522ee9214a0d1608d954" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5225e9214a0d1608d94f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50855f627d6b05869ecc" }, "external_id" : "ZOOKEEPER-653", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum", "server" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50855f627d6b05869ecd" }, "effect" : "is blocked by", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2010-01-22T18:07:26.752+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2012-03-29T11:40:30.515+0000" }, "title" : "hudson failure in LETest", "issue_type" : "Bug", "desc" : "http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/675/testReport/org.apache.zookeeper.test/LETest/testLE/\n\njunit.framework.AssertionFailedError: Threads didn't join\n\tat org.apache.zookeeper.test.LETest.testLE(LETest.java:116)\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52305f627d6b0586cb09" }, "external_id" : "ZOOKEEPER-1435", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cap space usage of default log4j rolling policy", "desc" : "Our current log4j log rolling policy (for ROLLINGFILE) doesn't cap the max logging space used. This can be a problem in production systems. See similar improvements recently made in hadoop: HADOOP-8149\n\nFor ROLLINGFILE only, I believe we should change the default threshold to INFO and cap the max space to something reasonable, say 5g (max file size of 256mb, max file count of 20). These will be the defaults in log4j.properties, which you would also be able to override from the command line.", "created_at" : { "$date" : "2012-03-28T16:33:08.551+0000" }, "updated_at" : { "$date" : "2012-03-30T01:08:39.021+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52305f627d6b0586cb08" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52305f627d6b0586cb16" }, "external_id" : "ZOOKEEPER-1438", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMX MBeans for client connections can be orphaned", "desc" : "I have a functional test that extends from ClientBase, which I'm using to stress test a piece of software that uses ZK underneath. In this test, I want to simulate disconnection events, so I fire up a thread which calls \"serverFactory.closeAll()\" every 50ms. The clients themselves churn through a lot of sessions as part of the test. When the test completes, the ClientBase teardown method fails, since it sees one or two MBeans \"left over\" from earlier elapsed sessions.", "created_at" : { "$date" : "2012-03-30T04:49:08.476+0000" }, "updated_at" : { "$date" : "2012-03-30T04:49:08.476+0000" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.2" ], "components" : [ "jmx" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52315f627d6b0586cb17" }, "external_id" : "ZOOKEEPER-1433", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve ZxidRolloverTest (test seems flakey)", "desc" : "In our jenkins job to run the ZooKeeper unit tests, org.apache.zookeeper.server.ZxidRolloverTest sometimes fails.\n\nE.g.,\n\n{noformat}\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /foo0\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:90)\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:42)\n\tat org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:815)\n\tat org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:843)\n\tat org.apache.zookeeper.server.ZxidRolloverTest.checkNodes(ZxidRolloverTest.java:154)\n\tat org.apache.zookeeper.server.ZxidRolloverTest.testRolloverThenRestart(ZxidRolloverTest.java:211)\n{noformat}\n", "created_at" : { "$date" : "2012-03-26T20:00:43.891+0000" }, "updated_at" : { "$date" : "2012-03-30T11:07:35.401+0000" }, "creator_id" : { "$oid" : "5b7d522ee9214a0d1608d954" }, "reporter_id" : { "$oid" : "5b7d522ee9214a0d1608d954" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52325f627d6b0586cb2c" }, "external_id" : "ZOOKEEPER-578", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ResponderThread should be able to use TCP or UDP", "desc" : "The ResponderThread, which responds to inquiries for the current leader, currently only uses UDP. It also only runs for electionAlg=0. \n\nObservers will eventually require that a ResponderThread runs for all election types. However, this introduces a UDP dependency which some installations do not want. This would also allow such installations to use electionAlg=0 (although this is not a big win as it is the least sophisticated election algorithm). \n\nTherefore we should be able to toggle ResponderThread to use either TCP or UDP. Since UDP is more performant, it probably makes sense to retain it. So I propose to choose between the two at startup time using a configuration flag responderTCP=true.\n\nFixing this issue exposed ZOOKEEPER-569, on which this JIRA depends. ", "created_at" : { "$date" : "2009-11-11T18:37:27.465+0000" }, "updated_at" : { "$date" : "2012-04-03T21:16:10.630+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52325f627d6b0586cb30" }, "external_id" : "ZOOKEEPER-1447", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Per-connection network throttling to improve QoS", "desc" : "Some clients maybe a heavy bandwidth user. It is possible for the total network traffic to reach NIC capacity and service quality start to degrade. We don't want these clients to affect the QoS of other clients sharing the same server.  \n\nIn this improvement, we are going to add per-connection throttling mechanism which will slow down the network activity of clients with high bandwidth usage. We will add configurable parameter to limit maximum bandwidth which will be used to serve client requests. All client get equal amount of bandwidth when system approach its network capacity limit. When the system in under-utilize, throttling has no effect.  ", "created_at" : { "$date" : "2012-04-16T23:56:32.162+0000" }, "updated_at" : { "$date" : "2012-04-16T23:56:32.162+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52335f627d6b0586cb33" }, "external_id" : "ZOOKEEPER-1307", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkCli.sh is exiting when an Invalid ACL exception is thrown from setACL command through client", "desc" : "use consoleClient (zkCli.sh) and issue setAcl /temp abc\n[zk: XX.XX.XX.XX:XXXX(CONNECTED) 17] setAcl /temp abc\nabc does not have the form scheme:id:perm\nException in thread \"main\" org.apache.zookeeper.KeeperException$InvalidACLException: KeeperErrorCode = InvalidACL\n        at org.apache.zookeeper.ZooKeeper.setACL(ZooKeeper.java:1172)\n        at org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:717)\n        at org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:582)\n        at org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:354)\n        at org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:312)\n        at org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:271)\nlinux-xxx:/zookeeper1/bin #\n\nif any InvalidACLException is thrown then client is exiting.\nclient should be able to handle this kind of issues\n\n", "created_at" : { "$date" : "2011-11-23T09:07:13.837+0000" }, "updated_at" : { "$date" : "2012-04-23T17:17:37.673+0000" }, "creator_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "reporter_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52335f627d6b0586cb31" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52335f627d6b0586cb32" }, "effect" : "is superceded by", "type" : "Supercedes" } ], "environment" : "zkCli.sh" },
{ "_id" : { "$oid" : "5b7d52345f627d6b0586cb46" }, "external_id" : "ZOOKEEPER-1451", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C API improperly logs getaddrinfo failures on Linux when using glibc", "desc" : "This is how the code currently logs getaddrinfo errors:\n\n{quote}\n                errno = getaddrinfo_errno(rc);\n                LOG_ERROR((\"getaddrinfo: %s\\n\", strerror(errno)));\n{quote}\n\nOn Linux, specifically when using glibc, there is a better function for logging getaddrinfo errors called gai_strerror. An example:\n\n{quote}\n                LOG_ERROR((\"getaddrinfo: %s\\n\", gai_strerror(rc)));\n{quote}\n\nIt doesn't miss a lot of cases like the errno based version does.", "created_at" : { "$date" : "2012-04-19T18:04:57.732+0000" }, "updated_at" : { "$date" : "2012-04-25T20:29:44.443+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_links" : [  ], "environment" : "Linux when using glibc" },
{ "_id" : { "$oid" : "5b7d52345f627d6b0586cb51" }, "external_id" : "ZOOKEEPER-1395", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "node-watcher double-free redux", "desc" : "This is basically the same issue as ZOOKEEPER-888 and ZOOKEEPER-740 (the latter is open as I write this, but it was superseded by the fix that went in with 888). The problem still exists after the ZOOKEEPER-888 patch, however; it's just more difficult to trigger:\n\n1) Zookeeper notices connection loss, schedules watcher_dispatch\n2) Zookeeper notices session loss, schedules watcher_dispatch\n3) watcher_dispatch runs for connection loss\n4) pywatcher is freed due to is_unrecoverable being true\n5) watcher_dispatch runs for session loss\n6) PyObject_CallObject attempts to run freed pywatcher with varying bad results\n\nThe fix is easy, the dispatcher should act on the state it is given, not the state of the world when it runs. (Patch attached). Reliably triggering the crash is tricky due to the race, but it's not theoretical.", "created_at" : { "$date" : "2012-02-21T20:01:48.553+0000" }, "updated_at" : { "$date" : "2012-04-25T23:37:13.272+0000" }, "creator_id" : { "$oid" : "5b7d521fe9214a0d1608d94a" }, "reporter_id" : { "$oid" : "5b7d521fe9214a0d1608d94a" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.4" ], "components" : [ "contrib-bindings", "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d521fe9214a0d1608d94a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52355f627d6b0586cb65" }, "external_id" : "ZOOKEEPER-1010", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove or move ManagedUtil to contrib, because it has direct log4j dependencies", "desc" : "Please move ManagedUtil out of the way. It has direct dependencies on log4j api.", "created_at" : { "$date" : "2011-03-08T21:37:30.137+0000" }, "updated_at" : { "$date" : "2012-04-25T23:48:53.023+0000" }, "creator_id" : { "$oid" : "5b7d5187e9214a0d1608d916" }, "reporter_id" : { "$oid" : "5b7d5187e9214a0d1608d916" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d52355f627d6b0586cb64" } },
{ "_id" : { "$oid" : "5b7d52355f627d6b0586cb6f" }, "external_id" : "ZOOKEEPER-1432", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add javadoc and debug logging for checkACL() method in PrepRequestProcessor", "desc" : "I have a need for more logging in the checkACL() method and thought I'd add a javadoc section for the function too, while I am there.", "created_at" : { "$date" : "2012-03-23T23:04:59.481+0000" }, "updated_at" : { "$date" : "2012-04-26T08:38:12.402+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [ "security" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52335f627d6b0586cb31" }, "external_id" : "ZOOKEEPER-1391", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.2" ], "components" : [ "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52335f627d6b0586cb33" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5225e9214a0d1608d94f" }, "created_at" : { "$date" : "2012-02-13T01:41:08.298+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "updated_at" : { "$date" : "2012-04-26T08:47:45.601+0000" }, "title" : "zkCli dies on NoAuth", "issue_type" : "Bug", "desc" : "[zk: localhost:2181(CONNECTED) 1] create /sasltest/n4 c sasl:notme@EXAMPLE.COM:cdrwa\nCreated /sasltest/n4\n[zk: localhost:2181(CONNECTED) 2] ls /sasltest/n4                                   \nException in thread \"main\" org.apache.zookeeper.KeeperException$NoAuthException: KeeperErrorCode = NoAuth for /sasltest/n4\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:113)\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n\tat org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1448)\n\tat org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1476)\n\tat org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:717)\n\tat org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:593)\n\tat org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:365)\n\tat org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:323)\n\tat org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:282)\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52375f627d6b0586cb98" }, "external_id" : "ZOOKEEPER-1439", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c sdk: core in log_env for lack of checking the output argument *pwp* of getpwuid_r", "desc" : "Man of getpwuid_r \"return a pointer to a passwd structure, or NULL if the matching entry is not found or an error occurs\",\n\"The getpwnam_r() and getpwuid_r() functions return zero on success.\", it means entry may not be found when getpwuid_r success.\n\nIn log_env of zookeeper.c in c sdk:\n  {{if (!getpwuid_r(uid, &pw, buf, sizeof(buf), &pwp)) {}}\n    {{LOG_INFO((\"Client environment:user.home=%s\", pw.pw_dir));}}\n  {{}}}\npwp is not checked to ensure entry is found, pw.pw_dir is not initialized in this case, core happens in LOG_INFO.", "created_at" : { "$date" : "2012-04-01T08:15:53.083+0000" }, "updated_at" : { "$date" : "2012-04-27T11:00:37.463+0000" }, "creator_id" : { "$oid" : "5b7d5237e9214a0d1608d956" }, "reporter_id" : { "$oid" : "5b7d5237e9214a0d1608d956" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5" ], "components" : [ "c client" ], "labels" : [ "zookeeper" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5237e9214a0d1608d956" }, "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "linux" },
{ "_id" : { "$oid" : "5b7d52385f627d6b0586cba5" }, "external_id" : "ZOOKEEPER-1456", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "sessions cannot specify whether they require kerberos authenticated sessions or not", "desc" : "When creating a session there is no way for a client to specify that they require a kerberos (via sasl) authenticated session. Similarly there is no way to request an unauthenticated session if kerberos has been configured at the jvm level.", "created_at" : { "$date" : "2012-04-26T17:17:16.064+0000" }, "updated_at" : { "$date" : "2012-04-27T14:42:49.634+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52385f627d6b0586cba4" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52385f627d6b0586cba7" }, "external_id" : "ZOOKEEPER-1457", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral node deleted for unexpired sessions", "desc" : "This week, we saw a potential bug with zookeeper 3.3.4. In an attempt to adding a separate disk for zookeeper transaction logs, our SysOps team threw new disks at all the zookeeper servers in our production cluster at around the same time. Right after this, we saw degraded performance on our zookeeper cluster. And yes, I agree that this degraded behavior is expected and we could've done a better job and upgraded one server at a time. Al though, the observed impact was that ephemeral nodes got deleted without session expiration on the zookeeper clients. \n\nLet me try and describe what I've observed from the Kafka and ZK server logs - Kafka client has a session established with ZK, say Session A, that it has been using successfully. At the time of the degraded ZK performance issue, Session A expires. Kafka's ZkClient tries to establish another session with ZK. After 9 seconds, it establishes a session, say Session B and tries to use it for creating a znode. This operation fails with a NodeExists error since another session, say session C, has created that znode. This is considered OK since ZkClient retries an operation transparently if it gets disconnected and sometimes you can get NodeExists. But then later, session C expires and hence the ephemeral node is deleted from ZK. This leads to unexpected errors in Kafka since its session, Session B, is still valid and hence it expects the znode to be there. The issue is that session C was established, created the znode and expired, without the zookeeper client on Kafka ever knowing about it. \n\n", "created_at" : { "$date" : "2012-04-26T19:25:43.816+0000" }, "updated_at" : { "$date" : "2012-04-30T19:00:34.640+0000" }, "creator_id" : { "$oid" : "5b7d521de9214a0d1608d949" }, "reporter_id" : { "$oid" : "5b7d521de9214a0d1608d949" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.4" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52395f627d6b0586cbac" }, "external_id" : "ZOOKEEPER-1458", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Parent's cversion doesn't match the sequence number that get assigned to a child node with the SEQUENTIAL flag on.", "desc" : "If I have a child delete op interleaving two child create ops, the second child create will nevertheless have the path suffix incremented only by 1 rather than by 2. Is this expected? The 3.3.5 version takes into account the delete and increments the sequence by 2.\n\nPrepRequestProcessor uses the parent's cversion to generate the child's sequence suffix. However it appears that this particular cversion only counts \"create\" operations and it doesn't take into account the deletes. Strangely enough, the parent stats returned by getData() show the correct cversion with all the creates and deletes accounted for.\n\nIt looks like the first cversion comes from the ChangeRecord for the parent node stuck in ZooKeeperServer.outstandingChangesForPath map. And the second one (returned by getData(), that is) comes from the DataTree.\n\nHere's a simple example that reproduces the situation.\n\nzk.create(\"/parent\", null, OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);\nStat stat = new Stat();\n\nzk.getData(\"/parent\", false, stat);\nstat.getCVersion(); // returns 0 -- expected;\n\nString actualPath = zk.create(\"/parent/child\", null, OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);\n// actualPath is \"/parent/child0000000000\" -- expected.\n\nzk.getData(\"/parent\", false, stat);\nstat.getCVersion(); // returns 1 -- expected;\n\nzk.getData(actualPath, false, stat);\nzk.delete(actualPath,stat.getVersion()); // delete the child node\n\nzk.getData(\"/parent\", false, stat);\nstat.getCVersion(); // returns 2;\n\n// create another child\nactualPath = zk.create(\"/parent/child\", null, OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);\n// returned \"/parent/child0000000001\" but expected \"/parent/child0000000002\"\n\nzk.getData(\"/parent\", false, stat);\nstat.getCVersion(); // returns 3;", "created_at" : { "$date" : "2012-04-30T01:00:30.393+0000" }, "updated_at" : { "$date" : "2012-04-30T23:10:10.480+0000" }, "creator_id" : { "$oid" : "5b7d5239e9214a0d1608d957" }, "reporter_id" : { "$oid" : "5b7d5239e9214a0d1608d957" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "All" },
{ "_id" : { "$oid" : "5b7d523a5f627d6b0586cbb2" }, "external_id" : "ZOOKEEPER-1305", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper.c:prepend_string func can dereference null ptr", "desc" : "All the callers of the function prepend_string make a call to prepend_string before checking that zhandle_t *zh is not null. At the top of prepend_string, zh is dereferenced without checking for a null ptr:\n\nstatic char* prepend_string(zhandle_t *zh, const char* client_path) {\n    char *ret_str;\n    if (zh->chroot == NULL)\n        return (char *) client_path;\n\nI propose fixing this by adding the check here in prepend_string:\n\nstatic char* prepend_string(zhandle_t *zh, const char* client_path) {\n    char *ret_str;\n    if (zh==NULL || zh->chroot == NULL)\n        return (char *) client_path;\n", "created_at" : { "$date" : "2011-11-18T18:23:33.597+0000" }, "updated_at" : { "$date" : "2012-05-03T02:06:44.289+0000" }, "creator_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "reporter_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.4.1", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d523a5f627d6b0586cbb1" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "original_time_estimate" : 1800, "environment" : "All" },
{ "_id" : { "$oid" : "5b7d523b5f627d6b0586cbcc" }, "external_id" : "ZOOKEEPER-1310", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C Api should use state CONNECTION_LOSS", "desc" : "I would like to ZooKeeper let know my watcher (which I'm giving to zookeeeper_init) about CONNECTION_LOSS, right the given watcher doesn't know that connection is lost due to what I can't do my stuff.\n\nWhat you think? If so I could try to create a patch.", "created_at" : { "$date" : "2011-11-30T12:47:56.157+0000" }, "updated_at" : { "$date" : "2012-05-06T04:51:21.567+0000" }, "creator_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "reporter_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d523c5f627d6b0586cbd8" }, "external_id" : "ZOOKEEPER-1339", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C clien doesn't build with --enable-debug", "desc" : "When I'm trying to build 3.4.1 c client with --enable-debug switch I'm getting following error:\n\n{code}\nmake  all-am\nmake[1]: Entering directory `/home/jlekstan/zookeeper-3.4.1/src/c'\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF \".deps/zookeeper.Tpo\" -c -o zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c; \\\n\tthen mv -f \".deps/zookeeper.Tpo\" \".deps/zookeeper.Plo\"; else rm -f \".deps/zookeeper.Tpo\"; exit 1; fi\nmkdir .libs\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c  -fPIC -DPIC -o .libs/zookeeper.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zookeeper.lo -MD -MP -MF .deps/zookeeper.Tpo -c src/zookeeper.c -o zookeeper.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT recordio.lo -MD -MP -MF \".deps/recordio.Tpo\" -c -o recordio.lo `test -f 'src/recordio.c' || echo './'`src/recordio.c; \\\n\tthen mv -f \".deps/recordio.Tpo\" \".deps/recordio.Plo\"; else rm -f \".deps/recordio.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT recordio.lo -MD -MP -MF .deps/recordio.Tpo -c src/recordio.c  -fPIC -DPIC -o .libs/recordio.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT recordio.lo -MD -MP -MF .deps/recordio.Tpo -c src/recordio.c -o recordio.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT zookeeper.jute.lo -MD -MP -MF \".deps/zookeeper.jute.Tpo\" -c -o zookeeper.jute.lo `test -f 'generated/zookeeper.jute.c' || echo './'`generated/zookeeper.jute.c; \\\n\tthen mv -f \".deps/zookeeper.jute.Tpo\" \".deps/zookeeper.jute.Plo\"; else rm -f \".deps/zookeeper.jute.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zookeeper.jute.lo -MD -MP -MF .deps/zookeeper.jute.Tpo -c generated/zookeeper.jute.c  -fPIC -DPIC -o .libs/zookeeper.jute.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zookeeper.jute.lo -MD -MP -MF .deps/zookeeper.jute.Tpo -c generated/zookeeper.jute.c -o zookeeper.jute.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT zk_log.lo -MD -MP -MF \".deps/zk_log.Tpo\" -c -o zk_log.lo `test -f 'src/zk_log.c' || echo './'`src/zk_log.c; \\\n\tthen mv -f \".deps/zk_log.Tpo\" \".deps/zk_log.Plo\"; else rm -f \".deps/zk_log.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zk_log.lo -MD -MP -MF .deps/zk_log.Tpo -c src/zk_log.c  -fPIC -DPIC -o .libs/zk_log.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zk_log.lo -MD -MP -MF .deps/zk_log.Tpo -c src/zk_log.c -o zk_log.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT zk_hashtable.lo -MD -MP -MF \".deps/zk_hashtable.Tpo\" -c -o zk_hashtable.lo `test -f 'src/zk_hashtable.c' || echo './'`src/zk_hashtable.c; \\\n\tthen mv -f \".deps/zk_hashtable.Tpo\" \".deps/zk_hashtable.Plo\"; else rm -f \".deps/zk_hashtable.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zk_hashtable.lo -MD -MP -MF .deps/zk_hashtable.Tpo -c src/zk_hashtable.c  -fPIC -DPIC -o .libs/zk_hashtable.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT zk_hashtable.lo -MD -MP -MF .deps/zk_hashtable.Tpo -c src/zk_hashtable.c -o zk_hashtable.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT st_adaptor.lo -MD -MP -MF \".deps/st_adaptor.Tpo\" -c -o st_adaptor.lo `test -f 'src/st_adaptor.c' || echo './'`src/st_adaptor.c; \\\n\tthen mv -f \".deps/st_adaptor.Tpo\" \".deps/st_adaptor.Plo\"; else rm -f \".deps/st_adaptor.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT st_adaptor.lo -MD -MP -MF .deps/st_adaptor.Tpo -c src/st_adaptor.c  -fPIC -DPIC -o .libs/st_adaptor.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT st_adaptor.lo -MD -MP -MF .deps/st_adaptor.Tpo -c src/st_adaptor.c -o st_adaptor.o >/dev/null 2>&1\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o libzkst.la   zookeeper.lo recordio.lo zookeeper.jute.lo zk_log.lo zk_hashtable.lo st_adaptor.lo -lm \nar cru .libs/libzkst.a .libs/zookeeper.o .libs/recordio.o .libs/zookeeper.jute.o .libs/zk_log.o .libs/zk_hashtable.o .libs/st_adaptor.o\nranlib .libs/libzkst.a\ncreating libzkst.la\n(cd .libs && rm -f libzkst.la && ln -s ../libzkst.la libzkst.la)\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT hashtable_itr.lo -MD -MP -MF \".deps/hashtable_itr.Tpo\" -c -o hashtable_itr.lo `test -f 'src/hashtable/hashtable_itr.c' || echo './'`src/hashtable/hashtable_itr.c; \\\n\tthen mv -f \".deps/hashtable_itr.Tpo\" \".deps/hashtable_itr.Plo\"; else rm -f \".deps/hashtable_itr.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT hashtable_itr.lo -MD -MP -MF .deps/hashtable_itr.Tpo -c src/hashtable/hashtable_itr.c  -fPIC -DPIC -o .libs/hashtable_itr.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT hashtable_itr.lo -MD -MP -MF .deps/hashtable_itr.Tpo -c src/hashtable/hashtable_itr.c -o hashtable_itr.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT hashtable.lo -MD -MP -MF \".deps/hashtable.Tpo\" -c -o hashtable.lo `test -f 'src/hashtable/hashtable.c' || echo './'`src/hashtable/hashtable.c; \\\n\tthen mv -f \".deps/hashtable.Tpo\" \".deps/hashtable.Plo\"; else rm -f \".deps/hashtable.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT hashtable.lo -MD -MP -MF .deps/hashtable.Tpo -c src/hashtable/hashtable.c  -fPIC -DPIC -o .libs/hashtable.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -Wall -Werror -g -O0 -D_GNU_SOURCE -MT hashtable.lo -MD -MP -MF .deps/hashtable.Tpo -c src/hashtable/hashtable.c -o hashtable.o >/dev/null 2>&1\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o libhashtable.la   hashtable_itr.lo hashtable.lo  \nar cru .libs/libhashtable.a .libs/hashtable_itr.o .libs/hashtable.o\nranlib .libs/libhashtable.a\ncreating libhashtable.la\n(cd .libs && rm -f libhashtable.la && ln -s ../libhashtable.la libhashtable.la)\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o libzookeeper_st.la -rpath /usr/local/lib -no-undefined -version-info 2 -export-symbols-regex '(zoo_|zookeeper_|zhandle|Z|format_log_message|log_message|logLevel|deallocate_|zerror|is_unrecoverable)'  libzkst.la libhashtable.la \ngenerating symbol list for `libzookeeper_st.la'\n/usr/bin/nm -B   ./.libs/libzkst.a ./.libs/libhashtable.a | sed -n -e 's/^.*[ \t]\\([ABCDGIRSTW][ABCDGIRSTW]*\\)[ \t][ \t]*\\([_A-Za-z][_A-Za-z0-9]*\\)$/\\1 \\2 \\2/p' | /bin/sed 's/.* //' | sort | uniq > .libs/libzookeeper_st.exp\ngrep -E -e \"(zoo_|zookeeper_|zhandle|Z|format_log_message|log_message|logLevel|deallocate_|zerror|is_unrecoverable)\" \".libs/libzookeeper_st.exp\" > \".libs/libzookeeper_st.expT\"\nmv -f \".libs/libzookeeper_st.expT\" \".libs/libzookeeper_st.exp\"\necho \"{ global:\" > .libs/libzookeeper_st.ver\n cat .libs/libzookeeper_st.exp | sed -e \"s/\\(.*\\)/\\1;/\" >> .libs/libzookeeper_st.ver\n echo \"local: *; };\" >> .libs/libzookeeper_st.ver\n gcc -shared  -Wl,--whole-archive ./.libs/libzkst.a ./.libs/libhashtable.a -Wl,--no-whole-archive  -lm  -Wl,-soname -Wl,libzookeeper_st.so.2 -Wl,-version-script -Wl,.libs/libzookeeper_st.ver -o .libs/libzookeeper_st.so.2.0.0\n(cd .libs && rm -f libzookeeper_st.so.2 && ln -s libzookeeper_st.so.2.0.0 libzookeeper_st.so.2)\n(cd .libs && rm -f libzookeeper_st.so && ln -s libzookeeper_st.so.2.0.0 libzookeeper_st.so)\nrm -fr .libs/libzookeeper_st.lax\nmkdir .libs/libzookeeper_st.lax\nrm -fr .libs/libzookeeper_st.lax/libzkst.a\nmkdir .libs/libzookeeper_st.lax/libzkst.a\n(cd .libs/libzookeeper_st.lax/libzkst.a && ar x /home/jlekstan/zookeeper-3.4.1/src/c/./.libs/libzkst.a)\nrm -fr .libs/libzookeeper_st.lax/libhashtable.a\nmkdir .libs/libzookeeper_st.lax/libhashtable.a\n(cd .libs/libzookeeper_st.lax/libhashtable.a && ar x /home/jlekstan/zookeeper-3.4.1/src/c/./.libs/libhashtable.a)\nar cru .libs/libzookeeper_st.a   .libs/libzookeeper_st.lax/libzkst.a/zookeeper.o .libs/libzookeeper_st.lax/libzkst.a/st_adaptor.o .libs/libzookeeper_st.lax/libzkst.a/recordio.o .libs/libzookeeper_st.lax/libzkst.a/zk_hashtable.o .libs/libzookeeper_st.lax/libzkst.a/zk_log.o .libs/libzookeeper_st.lax/libzkst.a/zookeeper.jute.o  .libs/libzookeeper_st.lax/libhashtable.a/hashtable_itr.o .libs/libzookeeper_st.lax/libhashtable.a/hashtable.o \nranlib .libs/libzookeeper_st.a\nrm -fr .libs/libzookeeper_st.lax\ncreating libzookeeper_st.la\n(cd .libs && rm -f libzookeeper_st.la && ln -s ../libzookeeper_st.la libzookeeper_st.la)\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.lo -MD -MP -MF \".deps/libzkmt_la-zookeeper.Tpo\" -c -o libzkmt_la-zookeeper.lo `test -f 'src/zookeeper.c' || echo './'`src/zookeeper.c; \\\n\tthen mv -f \".deps/libzkmt_la-zookeeper.Tpo\" \".deps/libzkmt_la-zookeeper.Plo\"; else rm -f \".deps/libzkmt_la-zookeeper.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.lo -MD -MP -MF .deps/libzkmt_la-zookeeper.Tpo -c src/zookeeper.c  -fPIC -DPIC -o .libs/libzkmt_la-zookeeper.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.lo -MD -MP -MF .deps/libzkmt_la-zookeeper.Tpo -c src/zookeeper.c -o libzkmt_la-zookeeper.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-recordio.lo -MD -MP -MF \".deps/libzkmt_la-recordio.Tpo\" -c -o libzkmt_la-recordio.lo `test -f 'src/recordio.c' || echo './'`src/recordio.c; \\\n\tthen mv -f \".deps/libzkmt_la-recordio.Tpo\" \".deps/libzkmt_la-recordio.Plo\"; else rm -f \".deps/libzkmt_la-recordio.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-recordio.lo -MD -MP -MF .deps/libzkmt_la-recordio.Tpo -c src/recordio.c  -fPIC -DPIC -o .libs/libzkmt_la-recordio.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-recordio.lo -MD -MP -MF .deps/libzkmt_la-recordio.Tpo -c src/recordio.c -o libzkmt_la-recordio.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.jute.lo -MD -MP -MF \".deps/libzkmt_la-zookeeper.jute.Tpo\" -c -o libzkmt_la-zookeeper.jute.lo `test -f 'generated/zookeeper.jute.c' || echo './'`generated/zookeeper.jute.c; \\\n\tthen mv -f \".deps/libzkmt_la-zookeeper.jute.Tpo\" \".deps/libzkmt_la-zookeeper.jute.Plo\"; else rm -f \".deps/libzkmt_la-zookeeper.jute.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.jute.lo -MD -MP -MF .deps/libzkmt_la-zookeeper.jute.Tpo -c generated/zookeeper.jute.c  -fPIC -DPIC -o .libs/libzkmt_la-zookeeper.jute.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zookeeper.jute.lo -MD -MP -MF .deps/libzkmt_la-zookeeper.jute.Tpo -c generated/zookeeper.jute.c -o libzkmt_la-zookeeper.jute.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_log.lo -MD -MP -MF \".deps/libzkmt_la-zk_log.Tpo\" -c -o libzkmt_la-zk_log.lo `test -f 'src/zk_log.c' || echo './'`src/zk_log.c; \\\n\tthen mv -f \".deps/libzkmt_la-zk_log.Tpo\" \".deps/libzkmt_la-zk_log.Plo\"; else rm -f \".deps/libzkmt_la-zk_log.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_log.lo -MD -MP -MF .deps/libzkmt_la-zk_log.Tpo -c src/zk_log.c  -fPIC -DPIC -o .libs/libzkmt_la-zk_log.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_log.lo -MD -MP -MF .deps/libzkmt_la-zk_log.Tpo -c src/zk_log.c -o libzkmt_la-zk_log.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_hashtable.lo -MD -MP -MF \".deps/libzkmt_la-zk_hashtable.Tpo\" -c -o libzkmt_la-zk_hashtable.lo `test -f 'src/zk_hashtable.c' || echo './'`src/zk_hashtable.c; \\\n\tthen mv -f \".deps/libzkmt_la-zk_hashtable.Tpo\" \".deps/libzkmt_la-zk_hashtable.Plo\"; else rm -f \".deps/libzkmt_la-zk_hashtable.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_hashtable.lo -MD -MP -MF .deps/libzkmt_la-zk_hashtable.Tpo -c src/zk_hashtable.c  -fPIC -DPIC -o .libs/libzkmt_la-zk_hashtable.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-zk_hashtable.lo -MD -MP -MF .deps/libzkmt_la-zk_hashtable.Tpo -c src/zk_hashtable.c -o libzkmt_la-zk_hashtable.o >/dev/null 2>&1\nif /bin/bash ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-mt_adaptor.lo -MD -MP -MF \".deps/libzkmt_la-mt_adaptor.Tpo\" -c -o libzkmt_la-mt_adaptor.lo `test -f 'src/mt_adaptor.c' || echo './'`src/mt_adaptor.c; \\\n\tthen mv -f \".deps/libzkmt_la-mt_adaptor.Tpo\" \".deps/libzkmt_la-mt_adaptor.Plo\"; else rm -f \".deps/libzkmt_la-mt_adaptor.Tpo\"; exit 1; fi\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-mt_adaptor.lo -MD -MP -MF .deps/libzkmt_la-mt_adaptor.Tpo -c src/mt_adaptor.c  -fPIC -DPIC -o .libs/libzkmt_la-mt_adaptor.o\n gcc -DHAVE_CONFIG_H -I. -I. -I. -I./include -I./tests -I./generated -DTHREADED -g -O0 -D_GNU_SOURCE -MT libzkmt_la-mt_adaptor.lo -MD -MP -MF .deps/libzkmt_la-mt_adaptor.Tpo -c src/mt_adaptor.c -o libzkmt_la-mt_adaptor.o >/dev/null 2>&1\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o libzkmt.la   libzkmt_la-zookeeper.lo libzkmt_la-recordio.lo libzkmt_la-zookeeper.jute.lo libzkmt_la-zk_log.lo libzkmt_la-zk_hashtable.lo libzkmt_la-mt_adaptor.lo -lm \nar cru .libs/libzkmt.a .libs/libzkmt_la-zookeeper.o .libs/libzkmt_la-recordio.o .libs/libzkmt_la-zookeeper.jute.o .libs/libzkmt_la-zk_log.o .libs/libzkmt_la-zk_hashtable.o .libs/libzkmt_la-mt_adaptor.o\nranlib .libs/libzkmt.a\ncreating libzkmt.la\n(cd .libs && rm -f libzkmt.la && ln -s ../libzkmt.la libzkmt.la)\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o libzookeeper_mt.la -rpath /usr/local/lib -no-undefined -version-info 2 -export-symbols-regex '(zoo_|zookeeper_|zhandle|Z|format_log_message|log_message|logLevel|deallocate_|zerror|is_unrecoverable)'  libzkmt.la libhashtable.la -lpthread \ngenerating symbol list for `libzookeeper_mt.la'\n/usr/bin/nm -B   ./.libs/libzkmt.a ./.libs/libhashtable.a | sed -n -e 's/^.*[ \t]\\([ABCDGIRSTW][ABCDGIRSTW]*\\)[ \t][ \t]*\\([_A-Za-z][_A-Za-z0-9]*\\)$/\\1 \\2 \\2/p' | /bin/sed 's/.* //' | sort | uniq > .libs/libzookeeper_mt.exp\ngrep -E -e \"(zoo_|zookeeper_|zhandle|Z|format_log_message|log_message|logLevel|deallocate_|zerror|is_unrecoverable)\" \".libs/libzookeeper_mt.exp\" > \".libs/libzookeeper_mt.expT\"\nmv -f \".libs/libzookeeper_mt.expT\" \".libs/libzookeeper_mt.exp\"\necho \"{ global:\" > .libs/libzookeeper_mt.ver\n cat .libs/libzookeeper_mt.exp | sed -e \"s/\\(.*\\)/\\1;/\" >> .libs/libzookeeper_mt.ver\n echo \"local: *; };\" >> .libs/libzookeeper_mt.ver\n gcc -shared  -Wl,--whole-archive ./.libs/libzkmt.a ./.libs/libhashtable.a -Wl,--no-whole-archive  -lm -lpthread  -Wl,-soname -Wl,libzookeeper_mt.so.2 -Wl,-version-script -Wl,.libs/libzookeeper_mt.ver -o .libs/libzookeeper_mt.so.2.0.0\n(cd .libs && rm -f libzookeeper_mt.so.2 && ln -s libzookeeper_mt.so.2.0.0 libzookeeper_mt.so.2)\n(cd .libs && rm -f libzookeeper_mt.so && ln -s libzookeeper_mt.so.2.0.0 libzookeeper_mt.so)\nrm -fr .libs/libzookeeper_mt.lax\nmkdir .libs/libzookeeper_mt.lax\nrm -fr .libs/libzookeeper_mt.lax/libzkmt.a\nmkdir .libs/libzookeeper_mt.lax/libzkmt.a\n(cd .libs/libzookeeper_mt.lax/libzkmt.a && ar x /home/jlekstan/zookeeper-3.4.1/src/c/./.libs/libzkmt.a)\nrm -fr .libs/libzookeeper_mt.lax/libhashtable.a\nmkdir .libs/libzookeeper_mt.lax/libhashtable.a\n(cd .libs/libzookeeper_mt.lax/libhashtable.a && ar x /home/jlekstan/zookeeper-3.4.1/src/c/./.libs/libhashtable.a)\nar cru .libs/libzookeeper_mt.a   .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-zk_hashtable.o .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-zookeeper.o .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-zk_log.o .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-zookeeper.jute.o .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-recordio.o .libs/libzookeeper_mt.lax/libzkmt.a/libzkmt_la-mt_adaptor.o  .libs/libzookeeper_mt.lax/libhashtable.a/hashtable_itr.o .libs/libzookeeper_mt.lax/libhashtable.a/hashtable.o \nranlib .libs/libzookeeper_mt.a\nrm -fr .libs/libzookeeper_mt.lax\ncreating libzookeeper_mt.la\n(cd .libs && rm -f libzookeeper_mt.la && ln -s ../libzookeeper_mt.la libzookeeper_mt.la)\nif gcc -DHAVE_CONFIG_H -I. -I. -I.  -I./include -I./tests -I./generated  -Wall -Werror  -g -O0 -D_GNU_SOURCE -MT cli.o -MD -MP -MF \".deps/cli.Tpo\" -c -o cli.o `test -f 'src/cli.c' || echo './'`src/cli.c; \\\n\tthen mv -f \".deps/cli.Tpo\" \".deps/cli.Po\"; else rm -f \".deps/cli.Tpo\"; exit 1; fi\n/bin/bash ./libtool --tag=CC --mode=link gcc -Wall -Werror  -g -O0 -D_GNU_SOURCE   -o cli_st  cli.o libzookeeper_st.la \ngcc -Wall -Werror -g -O0 -D_GNU_SOURCE -o .libs/cli_st cli.o  ./.libs/libzookeeper_st.so -lm \n./.libs/libzookeeper_st.so: undefined reference to `hashtable_iterator_value'\n./.libs/libzookeeper_st.so: undefined reference to `hashtable_iterator_key'\ncollect2: ld returned 1 exit status\nmake[1]: *** [cli_st] Error 1\nmake[1]: Leaving directory `/home/jlekstan/zookeeper-3.4.1/src/c'\nmake: *** [all] Error 2\n{code}", "created_at" : { "$date" : "2011-12-22T10:00:55.153+0000" }, "updated_at" : { "$date" : "2012-05-08T18:04:59.338+0000" }, "creator_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "reporter_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.1" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d523ce9214a0d1608d95b" }, "issue_links" : [  ], "environment" : "Ubuntu 11.04" },
{ "_id" : { "$oid" : "5b7d523c5f627d6b0586cbff" }, "external_id" : "ZOOKEEPER-1464", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document that event notification is single threaded in java/c client implementations", "desc" : "The docs don't currently mention that there's a single thread delivering watches. Callee's should be aware of this, typically means don't make blocking calls (esp on other events!) and to limit time in the routine.", "created_at" : { "$date" : "2012-05-09T20:41:52.765+0000" }, "updated_at" : { "$date" : "2012-05-09T20:41:52.765+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d523d5f627d6b0586cc00" }, "external_id" : "ZOOKEEPER-1463", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "external inline function is not compatible with C99", "desc" : "There is a use of external inline function in zookeeper hashtable_itr.h file, which is not compatible with C99. This causes problem when compiling with other library like code coverage library.\n---\nhashtable_itr.h:37: error: 'cov_v_cab2c78b' is static but used in inline\nfunction 'hashtable_iterator_key' which is not static\n---\n\nThe easy fix would be put the following line in hashtable_itr.c which ignores this inline warning.\n#pragma GCC diagnostic ignored \"-Winline\"", "created_at" : { "$date" : "2012-05-07T21:52:51.568+0000" }, "updated_at" : { "$date" : "2012-05-11T05:26:49.963+0000" }, "creator_id" : { "$oid" : "5b7d523ce9214a0d1608d95c" }, "reporter_id" : { "$oid" : "5b7d523ce9214a0d1608d95c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5" ], "components" : [ "build" ], "labels" : [ "inline", "external" ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d523ce9214a0d1608d95c" }, "issue_links" : [  ], "original_time_estimate" : 360, "environment" : "debian linux x64" },
{ "_id" : { "$oid" : "5b7d523e5f627d6b0586cc16" }, "external_id" : "ZOOKEEPER-1318", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "In Python binding, get_children (and get and exists, and probably others) with expired session doesn't raise exception properly", "desc" : "In Python binding, get_children (and get and exists, and probably others) with expired session doesn't raise exception properly.\n\n\n>>> zookeeper.state(h)\n-112\n>>> zookeeper.get_children(h, '/')\nTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\nSystemError: error return without exception set\n\nLet me know if you'd like me to work on a patch.", "created_at" : { "$date" : "2011-12-04T19:06:03.323+0000" }, "updated_at" : { "$date" : "2012-05-11T11:00:44.507+0000" }, "creator_id" : { "$oid" : "5b7d514ae9214a0d1608d900" }, "reporter_id" : { "$oid" : "5b7d514ae9214a0d1608d900" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ], "environment" : "Mac OS X (at least)" },
{ "_id" : { "$oid" : "5b7d523e5f627d6b0586cc2f" }, "external_id" : "ZOOKEEPER-642", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "\"exceeded deadline by N ms\" floods logs", "desc" : "More important zookeeper warnings are drown out by the following several times per minute:\n\n2010-01-12 17:39:57,227:22317(0x4147eb90):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 13ms\n\nPerhaps this is an issue with the way virtualized systems manage gettimeofday results?\n\nMaybe the current 10ms threshold could be pushed up a bit.  I notice that 95% of the messages are below 50ms.\n\nIs there an obvious configuration change that I can make to fix this?\n\nconfig file below:\n\n# The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial\n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between\n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\ndataDir=/mnt/zookeeper\n# the port at which the clients will connect\nclientPort=2181\n\nserver.1=hbase.1:2888:3888\nserver.2=hbase.2:2888:3888\nserver.3=hbase.3:2888:3888\nserver.4=hbase.4:2888:3888\nserver.5=hbase.5:2888:3888\n", "created_at" : { "$date" : "2010-01-13T01:52:42.146+0000" }, "updated_at" : { "$date" : "2012-05-11T11:00:44.276+0000" }, "creator_id" : { "$oid" : "5b7d523ee9214a0d1608d95e" }, "reporter_id" : { "$oid" : "5b7d523ee9214a0d1608d95e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.1" ], "components" : [ "c client" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5147e9214a0d1608d8ff" }, "issue_links" : [  ], "environment" : "virtualized linux - ec2 - ubuntu" },
{ "_id" : { "$oid" : "5b7d523f5f627d6b0586cc52" }, "external_id" : "ZOOKEEPER-1467", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d523f5f627d6b0586cc53" }, "external_id" : "ZOOKEEPER-1420", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Kerberos principal to user mapping / authorization", "desc" : "ZOOKEEPER-938 introduces server configuration options to perform a rudimentary mapping from Kerberos principal to user name:\n\nkerberos.removeHostFromPrincipal\nkerberos.removeRealmFromPrincipal\n\nThose are sufficient to make things work for HBase and other server clusters where we cannot include the host name portion into the znode ACL, but it would be better to support a more standard approach to perform the mapping with finer grained control (i.e. do this only for specific matching principals).\n\nMapping in Hadoop: https://ccp.cloudera.com/display/CDHDOC/Appendix+C+-+Configuring+the+Mapping+from+Kerberos+Principals+to+Short+Names\n\nAs an alternative, a matching option at the time of ACL check that can be controlled by the process assigning ACLs to znodes could also serve the purpose. For example, principals:\n\nuser/host1@TEST.DOMAIN\nuser/host2@TEST.DOMAIN\n\nwould have access to a znode with ACL set as:\n\nsasl:user/host*@TEST.DOMAIN:cdrwa\n\nThis would not require ZK server configuration, but add more runtime overhead.\n", "created_at" : { "$date" : "2012-03-16T01:21:47.779+0000" }, "updated_at" : { "$date" : "2012-05-17T18:41:52.920+0000" }, "creator_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "reporter_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d523f5f627d6b0586cc52" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52405f627d6b0586cc56" }, "external_id" : "ZOOKEEPER-1468", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Accurately name znode count in \"four-letter words\"", "desc" : "The 'stat' and 'srvr' four-letter word commands refer to \"Node Count\" as the number of znodes, but this is an ambiguous label (cluster nodes? znodes?) I suggest renaming the label to \"ZNode Count\", or something similar.\n\nThis will break existing parsers of the commands' output.", "created_at" : { "$date" : "2012-05-18T17:38:58.040+0000" }, "updated_at" : { "$date" : "2012-05-18T17:38:58.040+0000" }, "creator_id" : { "$oid" : "5b7d5240e9214a0d1608d960" }, "reporter_id" : { "$oid" : "5b7d5240e9214a0d1608d960" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52405f627d6b0586cc57" }, "external_id" : "ZOOKEEPER-1470", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython: close() should delete any watcher", "desc" : "When calling zookeeper.close(handle), any connection watcher for the handle is not deleted. This is a source of memory leaks for applications that create and close lots of connections. Its damage can be mitigated to some degree by changing the watcher to some function that won't keep references to instances alive before calling close.\n\nThe fix is just to add a free_pywatcher(..) call in the close sequence. Alternatively you could allow set_watcher(handle, None) as a way of deleting the watcher, but it's probably best to take care of it on close too.", "created_at" : { "$date" : "2012-05-20T17:00:34.970+0000" }, "updated_at" : { "$date" : "2012-05-20T18:31:43.199+0000" }, "creator_id" : { "$oid" : "5b7d5240e9214a0d1608d961" }, "reporter_id" : { "$oid" : "5b7d5240e9214a0d1608d961" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "contrib-bindings" ], "labels" : [ "python", "memory_leak" ], "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 3600 },
{ "_id" : { "$oid" : "5b7d52415f627d6b0586cc5a" }, "external_id" : "ZOOKEEPER-765", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add python example script", "desc" : "When adding some zookeeper-based functionality to a python script I had to figure everything out without guidance, which while doable, would have been a lot easier with an example. I extracted a skeleton program structure out with hopes its useful to others (maybe add as an example in the source or wiki?).\n\nThis script does an aget() and sets a watch, and hopefully illustrates what's going on, and where to plug in your application code that gets run when the znode changes.\n\nThere are probably some bugs, which if we fix now and provide a well-reviewed example hopefully others will not run into the same mistakes.", "created_at" : { "$date" : "2010-05-04T22:59:14.129+0000" }, "updated_at" : { "$date" : "2012-05-21T07:17:19.469+0000" }, "creator_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "reporter_id" : { "$oid" : "5b7d50d1e9214a0d1608d8be" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bindings", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52415f627d6b0586cc59" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52415f627d6b0586cc59" }, "external_id" : "ZOOKEEPER-395", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52415f627d6b0586cc5a" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "created_at" : { "$date" : "2009-05-08T23:59:24.391+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "updated_at" : { "$date" : "2012-05-21T07:17:19.411+0000" }, "title" : "Python bindings", "issue_type" : "New Feature", "desc" : "ZooKeeper doesn't have Python bindings. Having them would be useful, and would complement the extant Perl bindings. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52435f627d6b0586ccaf" }, "external_id" : "ZOOKEEPER-1472", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "WatchedEvent class missing from documentation", "desc" : "org.apache.zookeeper.WatchedEvent is missing from the 3.3.5 documentation.", "created_at" : { "$date" : "2012-05-25T14:34:01.390+0000" }, "updated_at" : { "$date" : "2012-05-25T14:34:01.390+0000" }, "creator_id" : { "$oid" : "5b7d5243e9214a0d1608d962" }, "reporter_id" : { "$oid" : "5b7d5243e9214a0d1608d962" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.5" ], "components" : [ "documentation" ], "labels" : [ "documentation" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52435f627d6b0586ccb0" }, "external_id" : "ZOOKEEPER-1446", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C API makes it difficult to implement a timed wait_until_connected method correctly", "desc" : "When using the C API, one might feel inclined to create a zookeeper_wait_until_connected method which waits for some amount for a connected state event to occur. The code might look like the following (didn't actually compile this):\n\n//------\nstatic pthread_mutex_t kConnectedMutex = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t kConnectedCondvar = PTHREAD_COND_INITIALIZER;\n\nint zookeeper_wait_until_connected(zhandle_t* zk, const struct timespec* timeout)\n{\n  struct timespec abstime;\n  clock_gettime(TIMER_ABSTIME, &abstime);\n  abstime->tv_sec += timeout->tv_sec;\n  abstime->tv_nsec += timeout->tv_nsec;\n\n  pthread_mutex_lock(&kConnectedMutex);\n  if (zoo_state(zk) == ZOO_CONNECTED_STATE) {\n    return 1;\n  }\n\n  pthread_cond_timedwait(&kConnectedCondvar, &kConnectedMutex, &abstime);\n  int state = zoo_state(zk);\n  return (state == ZOO_CONNECTED_STATE);\n}\n\nvoid zookeeper_session_callback(zhandle_t* zh, int type, int state, const char* path, void* arg)\n{\n  pthread_mutex_lock(&kConnectedMutex);\n  if (type == ZOO_SESSION_EVENT && state == ZOO_CONNECTED_STATE) {\n    pthread_cond_broadcast(&kConnectedCondvar);\n  }\n}\n//-----\n\nThat would work fine (assuming I didn't screw anything up), except that pthread_cond_timedwait can spuriously wakeup, making you not actually wait the desired timeout. The solution to this is to loop until the condition is met, which might look like the following:\n\n//---\n  int state = zoo_state(zk);\n  int result = 0;\n  while ((state == ZOO_CONNECTING_STATE || state == ZOO_ASSOCIATING_STATE) && result != ETIMEDOUT) {\n    result = pthread_cond_timedwait(&kConnectedCondvar, &kConnectedMutex, &abstime);\n    state = zoo_state(zk);\n  }\n//---\n\nThat would work fine, except the state might be valid and connecting, yet not ZOO_CONNECTING_STATE or ZOO_ASSOCIATING_STATE, it might be 0 or, as implemented recently courtesy of zookeeper-1108, 999. Checking for those states causes your code to rely upon an implementation detail of zookeeper, a problem highlighted by that implementation detail changing recently. Is there any way this behavior can become documented (via a ZOO_INITIALIZED_STATE or something like that), or is there any way this behavior can be supported by the library itself?\n", "created_at" : { "$date" : "2012-04-12T19:59:57.355+0000" }, "updated_at" : { "$date" : "2012-05-30T20:30:29.951+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.3", "3.3.5" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52445f627d6b0586ccb3" }, "external_id" : "ZOOKEEPER-1436", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add ZOO_TIMED_OUT_STATE sesion event to notify client about timeout during reconnection", "desc" : "The zookeeper c client knows how long its session will last, and periodically pings in order to keep that session alive. However, if it loses connection, it hops from ensemble member to ensemble member trying to reform the session - even after the session timeout expires.\n\nThis patch at a new session event (ZOO_TIMED_OUT_STATE) that notifies the user that the session timeout has passed, and we have been unable to reconnect. The event is one-shot per disconnection and get generated from the C-client library itself. The server has no knowledge of this event.  \n\nExample use cases:\n1. Client can try to reconnect to a different set of observers if it unable to connect to the original set of observers.\n\n2. Client can quickly stop acting as an active server, since other server may already taken over the active role while it is trying to reconnect. \n", "created_at" : { "$date" : "2012-03-29T01:07:42.025+0000" }, "updated_at" : { "$date" : "2012-06-01T01:41:50.852+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "c client" ], "labels" : [ "patch" ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52455f627d6b0586ccc3" }, "external_id" : "ZOOKEEPER-1412", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "java client watches inconsistently triggered on reconnect", "desc" : "I've observed an inconsistent behavior in java client watches. The inconsistency relates to the behavior after the client reconnects to the zookeeper ensemble.\n\nAfter the client reconnects to the ensemble only those watches should trigger which should have been triggered also if the connections was not lost. This means if I watch for changes in node /foo and there is no change there than my watch should not be triggered on reconnecting to the ensemble.\nThis is not always the case in the java client.\n\nI've debugged the issues and I could locate the case when the watch is always triggered on reconnect. This is consistently happening if I connect to a follower in the ensemble and I don't do any operation which goes through the leader.\nLooking at the code I see that the client stores the lastzxid and sends that with its request. This is 0 on startup and will be updated everytime from the server replies. This lastzxid is also sent to the server after reconnect together with watches. The server decides which watch to trigger based on this lastzxid probably because that should mean the last known state of the client. If this lastzxid is 0 than all the watches are triggered.\nI've checked why is this lastzxid 0. I thought it shouldn't be since there was already a request to the server to set the watch and in the reply the server could have sent back the zxid but it turns out that it sends just 0. Looking at the server code I see that for requests which doesn't go through the leader the follower server just sends back the same zxid that the client sent.", "created_at" : { "$date" : "2012-03-12T09:13:24.048+0000" }, "updated_at" : { "$date" : "2012-06-04T23:33:58.244+0000" }, "creator_id" : { "$oid" : "5b7d5214e9214a0d1608d941" }, "reporter_id" : { "$oid" : "5b7d5214e9214a0d1608d941" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.3.4", "3.4.2", "3.4.3", "3.4.1", "3.3.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.3.5", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52455f627d6b0586ccc2" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52455f627d6b0586cce5" }, "external_id" : "ZOOKEEPER-1484", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Missing znode found in the follower", "desc" : "We noticed that one of the follower fail to restart due to missing parent node\n\n{noformat}\n2012-05-29 15:44:41,037 [myid:9] - INFO [main:FileSnap@83] - Reading snapshot /var/facebook/zeus-server/data/global-ropt.0/version-2/snapshot.3d001f19c9\n2012-05-29 15:44:43,300 [myid:9] - ERROR [main:FileTxnSnapLog@220] - Parent /phpunittest/1862297546 missing for /phpunittest/1862297546/dir1\n2012-05-29 15:44:43,302 [myid:9] - ERROR [main:QuorumPeer@488] - Unable to load database on disk\njava.io.IOException: Failed to process transaction type: 1 error: KeeperErrorCode = NoNode for /phpunittest/1862297546\n{noformat}\n\nWe believed that the root cause is due to bugs in follower sync-up logic. Due to race condition, the follower may miss some proposals. The log below show that the follower see the commit message but it haven't seen this proposal before\n{noformat}\n2012-05-15 15:11:27,449 [myid:13] - WARN [QuorumPeer[myid=13]/0.0.0.0:2182:Learner@378] - Got zxid 0x3c00282dc9 expected 0x3c00282dca\n{noformat}\n\nI can reproduce this by keep running FollowerResyncConcurrencyTest until failure occurs. I suspected that the root caused is due to how we handle toBeApplied and outstandingProposals in the leader. \n\n1. In-flight proposals is removed from outstandingProposal before it is added to toBeApplied. Most of the problem I seen so far seem to caused by this gap.\n2. startForwarding() iterate through outstandingProposal without locking PrepRequestProcessor properly, so there is possibility of missing in-flight proposal. \n\n", "created_at" : { "$date" : "2012-06-11T21:36:58.782+0000" }, "updated_at" : { "$date" : "2012-06-16T02:04:34.560+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52465f627d6b0586ccea" }, "external_id" : "ZOOKEEPER-1487", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "if log4j.properties configuration parameters is not override  by system properties then zookeeper not able to  create log file.", "desc" : "In [ZOOKEEPER-980|https://issues.apache.org/jira/browse/ZOOKEEPER-980] for log4j.properties provide some  properties that may be overridden using system properties. \nFor example\nJVMFLAGS=\"-Dzookeeper.root.logger=DEBUG,CONSOLE,ROLLINGFILE -Dzookeeper.console.threshold=DEBUG\" bin/zkServer.sh start\nBut if we not override these property using system properties then zookeeper not able to create log file means these property not taking default value.  \n", "created_at" : { "$date" : "2012-06-15T05:57:02.353+0000" }, "updated_at" : { "$date" : "2012-06-18T14:07:11.267+0000" }, "creator_id" : { "$oid" : "5b7d5246e9214a0d1608d963" }, "reporter_id" : { "$oid" : "5b7d5246e9214a0d1608d963" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52475f627d6b0586ccee" }, "external_id" : "ZOOKEEPER-1431", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkpython: async calls leak memory", "desc" : "I'm seeing a memory leakage when using the \"aget\" method.\n\nIt leaks tuples and dicts, both containing \"stats\".\n\n", "created_at" : { "$date" : "2012-03-23T07:11:07.357+0000" }, "updated_at" : { "$date" : "2012-06-19T11:00:22.517+0000" }, "creator_id" : { "$oid" : "5b7d5247e9214a0d1608d964" }, "reporter_id" : { "$oid" : "5b7d5247e9214a0d1608d964" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50c8e9214a0d1608d8b9" }, "issue_links" : [  ], "original_time_estimate" : 3600, "environment" : "RHEL 6.0, self-built from 3.3.3 sources" },
{ "_id" : { "$oid" : "5b7d51155f627d6b0586a99a" }, "external_id" : "ZOOKEEPER-667", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.2" ], "components" : [ "java client" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51155f627d6b0586a997" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2010-02-11T19:26:56.890+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2012-06-20T10:39:39.833+0000" }, "title" : "java client doesn't allow ipv6 numeric connect string", "issue_type" : "Bug", "desc" : "The java client doesn't handle ipv6 numeric addresses as they are colon (:) delmited. After splitting the host/port on : we look for the port as the second entry in the array rather than the last entry in the array.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52495f627d6b0586cd20" }, "external_id" : "ZOOKEEPER-1492", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "leader cannot switch to LOOKING state when lost the majority", "desc" : "When a follower leave the cluster, and the cluster cannot achieve a majority, the leader should get out from Leading stat and get into Looking state, but if the there are some observers, the leader will not get away and the client cannot use the cluster.\n\neg:\n\nThe servers config:\n\nserver.1=z1:2888:3888\nserver.2=z2:2888:3888\nserver.3=z3:2888:3888:observer\n\nAt first, 1,2,3 are all started, it's all ok, 2 is the leader, but at this time, if 1 is stopped, 2 will not leave the Leading state, and client cannot connect to cluster.\n\nI think the problem is:\n(Leader.java  method:lead)\n\nLine 388-407\n                syncedSet.add(self.getId());\n                synchronized (learners) {\n                    for (LearnerHandler f : learners) {\n                        if (f.synced()) {\n                            syncedCount++;\n                            syncedSet.add(f.getSid());\n                        }\n                        f.ping();\n                    }\n                }\n              if (!tickSkip && !self.getQuorumVerifier().containsQuorum(syncedSet)) {\n                //if (!tickSkip && syncedCount < self.quorumPeers.size() / 2) {\n                    // Lost quorum, shutdown\n                  // TODO: message is wrong unless majority quorums used\n                    shutdown(\"Only \" + syncedCount + \" followers, need \"\n                            + (self.getVotingView().size() / 2));\n                    // make sure the order is the same!\n                    // the leader goes to looking\n                    return;\n              } \n\nThe code add all learners' ping to syncedSet, and I think at this place, only followers should be added to syncedSet, so the method 'containsQuorum' can figure out the majority.", "created_at" : { "$date" : "2012-06-20T12:51:21.699+0000" }, "updated_at" : { "$date" : "2012-06-20T14:18:21.279+0000" }, "creator_id" : { "$oid" : "5b7d5249e9214a0d1608d967" }, "reporter_id" : { "$oid" : "5b7d5249e9214a0d1608d967" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 604800, "environment" : "eclipse linux" },
{ "_id" : { "$oid" : "5b7d524a5f627d6b0586cd25" }, "external_id" : "ZOOKEEPER-1137", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "AuthFLE is throwing NPE when servers are configured with different election ports.", "desc" : "AuthFLE is throwing NPE when servers are configured with different election ports.\n\n*Configuration*\n{noformat}\nserver.1 = 10.18.52.25:2888:3888\nserver.2 = 10.18.52.205:2889:3889\nserver.3 = 10.18.52.144:2899:3890\n{noformat}\n\n*Logs*\n{noformat}\n2011-07-22 16:06:22,404 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:65170:AuthFastLeaderElection@844] - Election tally\n2011-07-22 16:06:29,483 - ERROR [WorkerSender Thread: 6:NIOServerCnxn$Factory$1@81] - Thread Thread[WorkerSender Thread: 6,5,main] died\njava.lang.NullPointerException\n\tat org.apache.zookeeper.server.quorum.AuthFastLeaderElection$Messenger$WorkerSender.process(AuthFastLeaderElection.java:488)\n\tat org.apache.zookeeper.server.quorum.AuthFastLeaderElection$Messenger$WorkerSender.run(AuthFastLeaderElection.java:432)\n\tat java.lang.Thread.run(Thread.java:619)\n2011-07-22 16:06:29,583 - ERROR [WorkerSender Thread: 1:NIOServerCnxn$Factory$1@81] - Thread Thread[WorkerSender Thread: 1,5,main] died\njava.lang.NullPointerException\n{noformat}\n\n", "created_at" : { "$date" : "2011-07-27T13:02:20.531+0000" }, "updated_at" : { "$date" : "2012-06-20T22:27:56.436+0000" }, "creator_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "reporter_id" : { "$oid" : "5b7d510fe9214a0d1608d8e3" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "leaderElection" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 86400 },
{ "_id" : { "$oid" : "5b7d524d5f627d6b0586cd40" }, "external_id" : "HBASE-6058", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d524d5f627d6b0586cd41" }, "external_id" : "ZOOKEEPER-1381", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add a method to get the zookeeper server version from the client", "desc" : "Zookeeper client API is designed to be server version agnostic as much as possible, so we can have new clients with old servers (or the opposite). But there is today no simple way for a client to know what's the server version. This would be very useful in order to;\n- check the compatibility (ex: 'multi' implementation available since 3.4 while 3.4 clients API supports 3.3 servers as well)\n- have different implementation depending on the server functionalities\n\nA workaround (proposed by Mahadev Konar) is do \"echo stat | nc hostname clientport\" and parse the output to get the version. The output is, for example:\n-----------------------\nZookeeper version: 3.4.2--1, built on 01/30/2012 17:43 GMT\nClients:\n /127.0.0.1:54951[0](queued=0,recved=1,sent=0)\n\nLatency min/avg/max: 0/0/0\nReceived: 1\nSent: 0\nOutstanding: 0\nZxid: 0x500000001\nMode: follower\nNode count: 7\n--------------------\n", "created_at" : { "$date" : "2012-01-30T21:31:22.607+0000" }, "updated_at" : { "$date" : "2012-06-28T08:10:05.093+0000" }, "creator_id" : { "$oid" : "5b7d524de9214a0d1608d968" }, "reporter_id" : { "$oid" : "5b7d524de9214a0d1608d968" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.2" ], "components" : [ "c client", "server", "java client", "documentation" ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d524d5f627d6b0586cd3f" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52385f627d6b0586cba4" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d524d5f627d6b0586cd40" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "all" },
{ "_id" : { "$oid" : "5b7d51665f627d6b0586b1d3" }, "external_id" : "ZOOKEEPER-1157", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3" ], "components" : [ "tests" ], "labels" : [ "test" ], "created_at" : { "$date" : "2011-08-19T19:58:48.002+0000" }, "updated_at" : { "$date" : "2012-06-29T17:11:46.699+0000" }, "reporter_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "creator_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "priority" : "Minor", "title" : "Some of the tests timeout or cause JVM crash", "issue_type" : "Bug", "desc" : "The following tests are consistently timing out for me, and sometimes they crash the JVM. We need to look at these tests and make sure they pass consistently, otherwise they provide no value.\n\norg.apache.zookeeper.test.AsyncHammerTest\norg.apache.zookeeper.test.FollowerResyncConcurrencyTest\norg.apache.zookeeper.test.ObserverQuorumHammerTest\norg.apache.zookeeper.test.QuorumHammerTest\norg.apache.zookeeper.test.QuorumTest\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52505f627d6b0586cd5c" }, "external_id" : "ZOOKEEPER-1466", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumCnxManager.shutdown missing synchronization", "desc" : "org.apache.zookeeper.server.quorum.QuorumCnxManager.shutdown is not being synchronized even though it's accessed by multiple threads.", "created_at" : { "$date" : "2012-05-15T17:21:53.443+0000" }, "updated_at" : { "$date" : "2012-06-30T11:01:09.877+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.3.5", "3.4.0", "3.5.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52515f627d6b0586cd68" }, "external_id" : "ZOOKEEPER-1454", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document how to run autoreconf if cppunit is installed in a non-standard directory", "desc" : "By default, the source distribution of cppunit is installed under /usr/local. When you run {{autoreconf -if}}, you get an error like this:\n\n{code}\n$ autoreconf -if\nconfigure.ac:37: warning: macro `AM_PATH_CPPUNIT' not found in library\nconfigure.ac:37: warning: macro `AM_PATH_CPPUNIT' not found in library\nconfigure.ac:37: error: possibly undefined macro: AM_PATH_CPPUNIT\n      If this token and others are legitimate, please use m4_pattern_allow.\n      See the Autoconf documentation.\nautoreconf: /usr/local/bin/autoconf failed with exit status: 1\n{code}\n\nThis is because {{cppunit.m4}} is installed under /usr/local/share/aclocal, but aclocal only looks at {{/usr/share/aclocal-$VERSION}} and {{/usr/share/aclocal}} assuming it was configured with {{--prefix=/usr}}. There are 3 ways to specify additional paths.\n\n1. Set {{ACLOCAL}}. \n\n{code}\nACLOCAL=\"aclocal -I /usr/local/share/aclocal\" autoreconf -if \n{code}\n\n2. Set {{ACLOCAL_PATH}}. \n\n{code}\nACLOCAL_PATH=/usr/local/share/aclocal autoreconf -if\n{code}\n\n3. Set {{ACLOCAL_FLAGS}}. \n\n{code}\nACLOCAL_FLAGS=\"-I /usr/local/share/aclocal\" autoreconf -if\n{code}\n\nApparently older versions of autoreconf don't respect ACLOCAL_PATH or ACLOCAL_FLAGS, so using ACLOCAL is probably the best way to fix it. I'll update src/c/README to document this. \n\n--Michi", "created_at" : { "$date" : "2012-04-25T21:18:38.704+0000" }, "updated_at" : { "$date" : "2012-06-30T11:01:10.463+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52515f627d6b0586cd75" }, "external_id" : "ZOOKEEPER-1471", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Jute generates invalid C++ code", "desc" : "There are 2 issues with the current jute generated C++ code.\n\n1. Variable declaration for JRecord is incorrect. It looks something like this:\n{code} \n    Id id;\n{code}\nIt should be like this instead:\n{code} \n org::apache::zookeeper::data::Id mid;\n{code}\n\n2. The header file declares all the variables (except for JRecord ones) with \"m\" prefix, but the .cc file doesn't use the prefix. ", "created_at" : { "$date" : "2012-05-21T01:10:35.544+0000" }, "updated_at" : { "$date" : "2012-06-30T11:01:10.848+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "jute" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52525f627d6b0586cd81" }, "external_id" : "ZOOKEEPER-1210", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Can't build ZooKeeper RPM with RPM >= 4.6.0 (i.e. on RHEL 6 and Fedora >= 10)", "desc" : "I was trying to build the zookeeper RPM (basically, `ant rpm -Dskip.contrib=1`), using build scripts that were recently merged from the work on the ZOOKEEPER-999 issue.\n\nThe final stage, i.e. running rpmbuild failed. From what I understand it mixed BUILD and BUILDROOT subdirectories in /tmp/zookeeper_package_build_tkadlubo/, leaving BUILDROOT empty, and placing everything in BUILD.\n\nThe full build log is at http://pastebin.com/0ZvUAKJt (Caution: I cut out long file listings from running tar -xvvf).", "created_at" : { "$date" : "2011-09-28T14:20:21.231+0000" }, "updated_at" : { "$date" : "2012-06-30T11:01:10.083+0000" }, "creator_id" : { "$oid" : "5b7d521de9214a0d1608d947" }, "reporter_id" : { "$oid" : "5b7d521de9214a0d1608d947" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "build" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d521de9214a0d1608d947" }, "issue_links" : [  ], "environment" : "Tested to fail on both Centos 6.0 and Fedora 14" },
{ "_id" : { "$oid" : "5b7d52535f627d6b0586cda2" }, "external_id" : "ZOOKEEPER-1490", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : " If the configured log directory does not exist zookeeper will not start. Better to create the directory and start", "desc" : "if the configured log directory does not exists zookeeper will not start. Better to create the directory and start\nin zkEnv.sh we can change as follows\n\nif [ \"x${ZOO_LOG_DIR}\" = \"x\" ]\nthen\n    ZOO_LOG_DIR=\".\"\n   else\n    if [ ! -w \"$ZOO_LOG_DIR\" ] ; then\n        mkdir -p \"$ZOO_LOG_DIR\"\n    fi\nfi\n \n\n", "created_at" : { "$date" : "2012-06-19T04:10:41.322+0000" }, "updated_at" : { "$date" : "2012-06-30T11:01:10.681+0000" }, "creator_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "reporter_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52545f627d6b0586cdbb" }, "external_id" : "ZOOKEEPER-1474", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52545f627d6b0586cdbc" }, "external_id" : "HADOOP-7211", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52545f627d6b0586cdbd" }, "external_id" : "ZOOKEEPER-1236", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Security uses proprietary Sun APIs", "desc" : "See HADOOP-7211 - Recent kerberos integration resulted in the same issue in ZK.\n\n{noformat}\n    [javac] /home/phunt/dev/zookeeper/src/java/main/org/apache/zookeeper/server/auth/KerberosName.java:88: warning: sun.security.krb5.KrbException is Sun proprietary API and may be removed in a future release\n    [javac]     } catch (KrbException ke) {\n{noformat}", "created_at" : { "$date" : "2011-10-20T16:05:02.861+0000" }, "updated_at" : { "$date" : "2012-07-04T18:25:38.952+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.4.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5254e9214a0d1608d96b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdbc" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdbb" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdba" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52545f627d6b0586cddf" }, "external_id" : "ZOOKEEPER-1507", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "review reading epoch files, improve logging", "desc" : "When reading an epoch file we should log (error level) any problems encountered.\n\norg.apache.zookeeper.server.quorum.QuorumPeer.readLongFromFile(String)\n\nAt the same time let's verify the call paths are handled properly.", "created_at" : { "$date" : "2012-07-06T17:00:28.762+0000" }, "updated_at" : { "$date" : "2012-07-06T17:00:28.762+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52555f627d6b0586cde0" }, "external_id" : "ZOOKEEPER-1508", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Reliable standalone mode through redundant databases", "desc" : "Currently ZooKeeper requires 3 servers to provide both reliability and availability. This is fine for large internet scale clusters, but there are lots of two node clusters that could benefit from ZooKeeper.  There are also single server use cases where it is highly desirable to have ZooKeeper survive a disk failure, but availability is not as important. \n\nThis feature would allow the configuration of multiple destinations for logs and snapshots. A transaction is committed when a majority of the log writes complete successfully. If one log gets an error on write, then it is taken offline until an administrator brings it online or replaces it with a new destination. ZooKeeper continues to run as long as a quorum of disks can be written.\n\nHigh availability can be provided with a two node cluster. When the ZooKeeper node dies, the  disks are switched to the surviving node and a new ZooKeeper starts. Faster switch over can be done if there is an observer already running in the new node.\n", "created_at" : { "$date" : "2012-07-09T23:12:12.474+0000" }, "updated_at" : { "$date" : "2012-07-12T21:54:52.934+0000" }, "creator_id" : { "$oid" : "5b7d5255e9214a0d1608d96d" }, "reporter_id" : { "$oid" : "5b7d5255e9214a0d1608d96d" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Single server with multiple disks or two node cluster with multiple shared disks" },
{ "_id" : { "$oid" : "5b7d52565f627d6b0586cde5" }, "external_id" : "ZOOKEEPER-1511", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Symbolic nodes", "desc" : "Zookeeper currently allows two type of nodes: EPHEMERAL and PERSISTENT. If the node or node data needs to be referenced from other nodes, entire node needs to be copied to new location. There is no relation between the original and copied nodes. Symbolic nodes like in unix directory structure would keep the nodes and node data in sync.\n\nUse case:\nWhile implementing managed clusters for micro shards strategy, client can register by creating Ephemeral nodes. The master process can then create new symbolic nodes along with other clients nodes for next set of processes to watch. If the client goes down, the ephemeral node cleans itself along with symbolic node. There could be different set of watchers on symbolic nodes which would then get notified.", "created_at" : { "$date" : "2012-07-17T18:33:49.702+0000" }, "updated_at" : { "$date" : "2012-07-17T18:33:49.702+0000" }, "creator_id" : { "$oid" : "5b7d5256e9214a0d1608d96e" }, "reporter_id" : { "$oid" : "5b7d5256e9214a0d1608d96e" }, "issue_type" : "Wish", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52565f627d6b0586cde6" }, "external_id" : "ZOOKEEPER-1465", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cluster availability following new leader election takes a long time with large datasets - is correlated to dataset size", "desc" : "When re-electing a new leader of a cluster, it takes a long time for the cluster to become available if the dataset is large\n\nTest Data\n----------\n650mb snapshot size\n20k nodes of varied size \n3 member cluster \n\nOn 3.4.x branch (http://svn.apache.org/repos/asf/zookeeper/branches/branch-3.4?r=1244779)\n------------------------------------------------------------------------------------------\n\nTakes 3-4 minutes to bring up a cluster from cold \nTakes 40-50 secs to recover from a leader failure \nTakes 10 secs for a new follower to join the cluster \n\nUsing the 3.3.5 release on the same hardware with the same dataset\n-----------------------------------------------------------------\n\nTakes 10-20 secs to bring up a cluster from cold \nTakes 10 secs to recover from a leader failure \nTakes 10 secs for a new follower to join the cluster \n\nI can see from the logs in 3.4.x that once a new leader is elected, it pushes a new snapshot to each of the followers who need to save it before they ack the leader who can then mark the cluster as available. \n\nThe kit being used is a low spec vm so the times taken are not relevant per se - more the fact that a snapshot is always sent even through there is no difference between the persisted state on each peer.\nNo data is being added to the cluster while the peers are being restarted.\n\n\n\n\n\n\n", "created_at" : { "$date" : "2012-05-10T14:47:11.914+0000" }, "updated_at" : { "$date" : "2012-07-18T00:33:19.575+0000" }, "creator_id" : { "$oid" : "5b7d5256e9214a0d1608d96f" }, "reporter_id" : { "$oid" : "5b7d5256e9214a0d1608d96f" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52575f627d6b0586ce20" }, "external_id" : "ZOOKEEPER-1427", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Writing to local files is done non-atomically", "desc" : "Currently, the writeLongToFile() function opens the file for truncate, writes the new data, syncs, and then closes. If the process crashes after opening the file but before writing the new data, the file may be left empty, causing ZK to \"forget\" an earlier promise. Instead, it should use RandomAccessFile to avoid truncating.", "created_at" : { "$date" : "2012-03-19T21:25:48.802+0000" }, "updated_at" : { "$date" : "2012-07-18T11:01:52.644+0000" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52585f627d6b0586ce4c" }, "external_id" : "ZOOKEEPER-1489", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Data loss after truncate on transaction log", "desc" : "The truncate method on the transaction log in the class org.apache.zookeeper.server.persistence.FileTxnLog will reduce the file size to the required amount without either closing or re-positioning the logStream (which could also be dangerous since the truncate method is not synchronized against concurrent writes to the log).\n\nThis causes the next append to that log to create a small \"hole\" in the file which java would interpret as binary zeroes when reading it. This then causes to the FileTxnIterator.next() implementation to detect the end of the log file too early.\n\nI'll attach a small maven project with one junit test which can be used to reproduce the issue. Due to the blackbox nature of the test it will run for roughly 50 seconds unfortunately. \n\nSteps to reproduce:\n- Start an ensemble of zookeeper servers with at least 3 participants\n- Create one entry and the remove one of the servers from the ensemble temporarily (e.g. zk-2)\n- Create another entry which is hence only reflected on zk-1 and zk-3\n- Take zk-1 out of the ensemble without shutting it down (that is important, I did that by interrupting the network connection to that node) and clean zk-3\n- Bring back zk-2 and zk-3 so that they form a quorum\n- Allow zk-1 to connect again\n- zk-1 will receive a TRUNC message from zk-2 since zk-1 is now a minority knowing about that second node creation event\n- Create a third node\n- Force zk-1 to become master somehow\n- That third node will be gone\n", "created_at" : { "$date" : "2012-06-18T09:09:37.801+0000" }, "updated_at" : { "$date" : "2012-07-18T11:01:52.875+0000" }, "creator_id" : { "$oid" : "5b7d5120e9214a0d1608d8f2" }, "reporter_id" : { "$oid" : "5b7d5120e9214a0d1608d8f2" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "environment" : "Tested on Ubuntu 12.04 and CentOS 6, should be reproducible elsewhere" },
{ "_id" : { "$oid" : "5b7d52595f627d6b0586ce87" }, "external_id" : "ZOOKEEPER-1486", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "A couple of bugs in the tutorial code", "desc" : "Hi, \nThere are two problems with the barrier example code in the tutorial:\n\n1) A znode created by a process in the function enter() is created with SEQUENTIAL suffix, however, the name of a znode deleted in the function leave() doesn't have this suffix. Actually, the leave() function tries to delete a nonexistent node => a KeeperException is thrown, which is caught silently => the process terminates without waiting for the barrier. \n\n2) It seems that the very idea of leaving the barrier by deleting ephemeral nodes is problematic. Consider the following scenario: there are two clients: C1 and C2. \n - C1 enters the barrier, creates a znode /b1/C1, checks that it's alone and starts waiting for the second client to come. \n - C2 enters the barrier and creates a znode /b1/C2 - the notification to C1 is sent but still not delivered.\n - C2 observes that there are enough children to /b1, enters the barrier, executes its own operations and invokes leave() procedure.\n - during the leave() procedure C2 removes its znode /b1/C2 and exits.\n - when the notification about C2's arrival finally arrives to C1, C1 checks the children of /b1 and doesn't find C2's znode: C1 is stuck. \nThe solution to this data race would be to create special znodes for leaving the barrier, similarly to the way they are created for entering the barrier. \n\nThanks,\nDima", "created_at" : { "$date" : "2012-06-12T21:07:44.535+0000" }, "updated_at" : { "$date" : "2012-07-20T22:11:33.093+0000" }, "creator_id" : { "$oid" : "5b7d5259e9214a0d1608d970" }, "reporter_id" : { "$oid" : "5b7d5259e9214a0d1608d970" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d525a5f627d6b0586ce89" }, "external_id" : "ZOOKEEPER-1515", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Long reconnect timeout if leader failed.", "desc" : "In zookeeper 3.3.5 in file src/java/main/org/apache/zookeeper/server/quorum/Learner.java:325 you may see Thread.sleep(1000);\n\nThis is always happens after leader failure or restart. Zookeeper reelects new leader and all followers try to connect to it. But first attempt always fails because of \"Connection refused\":\n\n{quote}\n2012-07-23 18:55:48,159 - WARN  [QuorumPeer:/0.0.0.0:2181:Learner@229] - Unexpected exception, tries=0, connecting to web329.local/192.168.1.74:2888\njava.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)\n\tat java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)\n\tat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n\tat java.net.Socket.connect(Socket.java:529)\n\tat org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:221)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:65)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:645)\n{quote}\n\nI propose to change this line to the next code:\n\n{code:title=Learner.java|borderStyle=solid}\nif (tries > 0) {\n    Thread.sleep(self.tickTime);\n}\n{code}\n\nThis way first reconnect attempt will be done immediately, other will wait for tick time (this is good semantic change, I suppose).\n\nThe result of this change - leader reelection time lowered from >1500ms to 300-400ms with 50ms tick time. This is pretty important for our production environment and will not break any existing installations.", "created_at" : { "$date" : "2012-07-24T05:58:49.157+0000" }, "updated_at" : { "$date" : "2012-07-25T05:45:15.298+0000" }, "creator_id" : { "$oid" : "5b7d525ae9214a0d1608d971" }, "reporter_id" : { "$oid" : "5b7d525ae9214a0d1608d971" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.5" ], "components" : [ "quorum", "leaderElection", "server" ], "labels" : [ "patch", "performance" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Gentoo linux, but every environment is affected." },
{ "_id" : { "$oid" : "5b7d525a5f627d6b0586ce91" }, "external_id" : "ZOOKEEPER-1516", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Configurable finalizeWait for FastLeaderElection", "desc" : "FastLeaderElection has final static int finalizeWait = 200. This is time to wait after successful leader election. I don't know what could happen, but 200ms is too slow for production environment under heavy load.\n\nI changed it to 20ms and everything still works for me.\n\nI propose to make this value configurable with default value of 200 to not affect current installations.\n\nCombined with #ZOOKEEPER-1515 it could improve leader election and make it 10x times faster: 1500ms -> 180ms including 100ms for 2 faileed new leader connections.", "created_at" : { "$date" : "2012-07-24T11:21:49.955+0000" }, "updated_at" : { "$date" : "2012-07-25T05:50:55.913+0000" }, "creator_id" : { "$oid" : "5b7d525ae9214a0d1608d971" }, "reporter_id" : { "$oid" : "5b7d525ae9214a0d1608d971" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.5" ], "components" : [ "quorum", "leaderElection", "server" ], "labels" : [ "performance" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Gentoo linux, any environment is affected." },
{ "_id" : { "$oid" : "5b7d50e15f627d6b0586a65b" }, "external_id" : "ZOOKEEPER-873", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e15f627d6b0586a65c" }, "effect" : "incorporates", "type" : "Incorporates" } ], "created_at" : { "$date" : "2010-09-15T15:57:06.681+0000" }, "updated_at" : { "$date" : "2012-07-25T18:46:33.389+0000" }, "reporter_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "creator_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "priority" : "Minor", "title" : "Performance oriented leader election (POLE)", "issue_type" : "New Feature", "desc" : "Currently, the leader is elected based on the length of its history. In heterogeneous settings, other processes can be better suited to serve as a leader, e.g., the process running on the node with best links to a majority. POLE (Performance Oriented Leader Election)  will  be a leader election implementation that takes into account multiple factors when selecting the leader.\n   ", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d525c5f627d6b0586ce98" }, "external_id" : "ZOOKEEPER-1444", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Idle session-less connections never time out", "desc" : "A socket connection to the server on which a session is not created will never time out. A misbehaving client that opens and leaks connections without creating sessions will hold open file descriptors on the server.\n\nThe existing timeout code is implemented at the session level, but the servers also should track and expire connections at the connection level. Proposed solution is to pull the timeout data structure handling code (hashmap of expiry time to sets of objects, simple monotonically incrementing nextExpirationTime) from SessionTrackerImpl into its own class in order to share it with connection level timeouts to be implemented in NIOServerCnxnFactory. Connections can be assigned a small initial timeout (proposing something small, like 3s) until a session is created, at which point the ServerCnxn session timeout can be used instead.", "created_at" : { "$date" : "2012-04-10T01:08:24.821+0000" }, "updated_at" : { "$date" : "2012-07-27T05:17:55.295+0000" }, "creator_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "reporter_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.2", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50d25f627d6b0586a5c4" }, "external_id" : "ZOOKEEPER-517", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50d15f627d6b0586a5bd" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "created_at" : { "$date" : "2009-08-25T23:32:42.446+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2012-07-27T05:18:57.180+0000" }, "title" : "NIO factory fails to close connections when the number of file handles run out.", "issue_type" : "Bug", "desc" : "The code in NIO factory is such that if we fail to accept a connection due to some reasons (too many file handles maybe one of them) we do not close the connections that are in CLOSE_WAIT. We need to call an explicit close on these sockets and then close them. One of the solutions might be to move doIO before accpet so that we can still close connection even if we cannot accept connections.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d523a5f627d6b0586cbb1" }, "external_id" : "ZOOKEEPER-1461", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.5" ], "components" : [ "c client" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d523a5f627d6b0586cbb2" }, "effect" : "duplicates", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "created_at" : { "$date" : "2012-05-01T20:35:44.450+0000" }, "original_time_estimate" : 0, "priority" : "Major", "desc" : "prepend_string, called before any checks for NULL in the c client for many API functions, has this line (zookeeper 3.3.5):\n\n    if (zh->chroot == NULL)\n\nThat means that before you check for NULL, you are dereferencing the pointer. This bug does not exist in the 3.4.* branch for whatever reason, but it still remains in the 3.3.* line. A patch which fixes it would make the line as follows:\n\n    if (zh == NULL || zh->chroot == NULL)\n\nI would do that for you, but I don't know how to patch the 3.3.5 branch.", "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "updated_at" : { "$date" : "2012-07-29T05:37:01.406+0000" }, "title" : "Zookeeper C client doesn't check for NULL before dereferencing in prepend_string", "issue_type" : "Improvement", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d525e5f627d6b0586ced4" }, "external_id" : "ZOOKEEPER-1110", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c interface zookeeper_close close fd too quickly.", "desc" : "The correct step about close client is the client send CLOSE_OP to the server, wait for several seconds, the server will process the terminal request and close the fd.\nBut the zookeeper_close interface is wrong, because the adaptor_send_queue(zh, 3000) (line 2332), will first wait the timeout then send the request.\nThe right order is first send the request then wait the timeout. I change as follow:\n$svn diff src/c/src/zookeeper.c\nIndex: src/c/src/zookeeper.c\n===================================================================\n--- src/c/src/zookeeper.c       (revision 1140451)\n+++ src/c/src/zookeeper.c       (working copy)\n@@ -2329,7 +2329,8 @@\n\n         /* make sure the close request is sent; we set timeout to an arbitrary\n          * (but reasonable) number of milliseconds since we want the call to block*/\n-        rc=adaptor_send_queue(zh, 3000);\n+        rc=adaptor_send_queue(zh, 0);\n+        sleep(3);\n     }else{\n         LOG_INFO((\"Freeing zookeeper resources for sessionId=%#llx\\n\",\n                 zh->client_id.client_id));\n ", "created_at" : { "$date" : "2011-06-29T05:30:27.128+0000" }, "updated_at" : { "$date" : "2012-07-29T05:37:26.206+0000" }, "creator_id" : { "$oid" : "5b7d525ee9214a0d1608d972" }, "reporter_id" : { "$oid" : "5b7d525ee9214a0d1608d972" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 1800, "environment" : "linux platform." },
{ "_id" : { "$oid" : "5b7d525f5f627d6b0586cede" }, "external_id" : "ZOOKEEPER-1521", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LearnerHandler initLimit/syncLimit problems specifying follower socket timeout limits", "desc" : "branch 3.3: The leader is expecting the follower to initialize in syncLimit time rather than initLimit. In LearnerHandler run line 395 (branch33) we look for the ack from the follower with a timeout of syncLimit.\n\nbranch 3.4+: seems like ZOOKEEPER-1136 introduced a regression while attempting to fix the problem. It sets the timeout as initLimit however it never sets the timeout to syncLimit once the ack is received.", "created_at" : { "$date" : "2012-07-26T15:44:38.998+0000" }, "updated_at" : { "$date" : "2012-07-29T11:02:03.187+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d525f5f627d6b0586ceee" }, "external_id" : "ZOOKEEPER-1500", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Nagios check always returns OK when the critical and warning values are the same", "desc" : "The plugin requires a difference between the warning and critical value for the checks to work. If the values are the same, OK is always returned.\n\nI can't figure out how to attach a file to this ticket in JIRA, so here's a minimal inline patch that at least lets the admin know it's not working:\n\n{noformat}\nIndex: src/contrib/monitoring/check_zookeeper.py\n===================================================================\n--- src/contrib/monitoring/check_zookeeper.py\t(revision 1357335)\n+++ src/contrib/monitoring/check_zookeeper.py\t(working copy)\n@@ -57,6 +57,10 @@\n             print >>sys.stderr, 'Invalid values for \"warning\" and \"critical\".'\n             return 2\n \n+        if warning == critical:\n+            print >>sys.stderr, '\"warning\" and \"critical\" cannot have the same value.'\n+            return 2\n+\n         if opts.key is None:\n             print >>sys.stderr, 'You should specify a key name.'\n             return 2\n{noformat}\n", "created_at" : { "$date" : "2012-07-04T17:10:34.318+0000" }, "updated_at" : { "$date" : "2012-07-31T22:37:28.234+0000" }, "creator_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "reporter_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52605f627d6b0586cef1" }, "external_id" : "ZOOKEEPER-1518", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Mailing List link is broken in the Zookeeper documentation", "desc" : "Mailing List link under Miscellaneous section from the Zookeeper documentation is broken.\nFollowing is the link:\nhttp://zookeeper.apache.org/mailing_lists.html", "created_at" : { "$date" : "2012-07-25T09:28:26.233+0000" }, "updated_at" : { "$date" : "2012-08-01T19:09:42.337+0000" }, "creator_id" : { "$oid" : "5b7d5260e9214a0d1608d975" }, "reporter_id" : { "$oid" : "5b7d5260e9214a0d1608d975" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52605f627d6b0586cef7" }, "external_id" : "ZOOKEEPER-1524", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "use more standard junit annotation \"@Before\" in SaslXTests rather than static blocks", "desc" : "The following tests:\n\nAuthTest.java\nSaslAuthFailTest.java\nSaslAuthDesignatedClientTest.java\nSaslAuthFailDesignatedClientTest.java\nSaslAuthMissingClientConfigTest.java\nSaslAuthTest.java\n\nuse \"static {..}\" blocks to initialize system properties and files prior to the test runs. As Patrick points out in ZOOKEEPER-1503, we should instead use JUnit's @Before annotation:\n\n\nhttp://junit.sourceforge.net/javadoc/org/junit/Before.html\n\nrather than static blocks, to make our tests more consistent and easier to understand.", "created_at" : { "$date" : "2012-08-01T19:39:35.858+0000" }, "updated_at" : { "$date" : "2012-08-01T19:56:01.560+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52605f627d6b0586cef6" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52615f627d6b0586cefb" }, "external_id" : "ZOOKEEPER-1522", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "intermittent failures in Zab test due to NPE in recursiveDelete test function", "desc" : "The jdk7 test job on jenkins is failing intermittently with \n\n{noformat}\njava.lang.NullPointerException\n\tat org.apache.zookeeper.server.quorum.Zab1_0Test.recursiveDelete(Zab1_0Test.java:917)\n\tat org.apache.zookeeper.server.quorum.Zab1_0Test.recursiveDelete(Zab1_0Test.java:918)\n\tat org.apache.zookeeper.server.quorum.Zab1_0Test.recursiveDelete(Zab1_0Test.java:918)\n\tat org.apache.zookeeper.server.quorum.Zab1_0Test.testPopulatedLeaderConversation(Zab1_0Test.java:419)\n\tat org.apache.zookeeper.server.quorum.Zab1_0Test.testUnnecessarySnap(Zab1_0Test.java:483)\n{noformat}\n\nSeems to not be handling the case where the file is deleted out from under. Also the recursive deletes should be at the very end of the finally I would think.", "created_at" : { "$date" : "2012-07-30T22:27:53.457+0000" }, "updated_at" : { "$date" : "2012-08-01T21:12:00.341+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52625f627d6b0586cf05" }, "external_id" : "ZOOKEEPER-1517", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper follower closed", "desc" : "I have Hadoop and Zookeeper installed \n\nthe zoo.cfg is :\n\ntickTime=2000\ndataDir=/home/hduser/zookeeper/conf\nclientPort=2181\ninitLimit=10\nsyncLimit=5\nserver.1=rsmm-master:2888:3888\nserver.2=rsmm-slave-1:2888:3888\nserver.3=rsmm-slave-2:2888:3888\nserver.4=rsmm-slave-3:2888:3888\nserver.5=rsmm-slave-4:2888:3888\n\n=====================================\nI tried to start zookeeper, \n./zkServer.sh start\n./zkServer.sh status\n\nJMX enabled by default\nUsing config: /home/hduser/zookeeper/bin/../conf/zoo.cfg\nMode: follower\n\n\n\nThe follower (rsmm-slave-4) logs complain: \n\n012-07-24 20:29:35,903 - WARN  [Thread-9:QuorumCnxManager$RecvWorker@727] - Connection broken for id 5, my id = 2, error = java.io.IOException: Channel eof\n2012-07-24 20:29:35,904 - WARN  [Thread-9:QuorumCnxManager$RecvWorker@730] - Interrupting SendWorker\n2012-07-24 20:29:35,905 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@82] - Exception when following the leader\njava.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:84)\n\tat org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n\tat org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:148)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:78)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:645)\n2012-07-24 20:29:35,905 - WARN  [Thread-8:QuorumCnxManager$SendWorker@633] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2094)\n\tat java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:370)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:622)\n2012-07-24 20:29:35,907 - WARN  [Thread-8:QuorumCnxManager$SendWorker@642] - Send worker leaving thread\n2012-07-24 20:29:35,907 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@165] - shutdown called\njava.lang.Exception: shutdown Follower\n\tat org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:165)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:649)\n2012-07-24 20:29:35,913 - INFO  [FollowerRequestProcessor:2:FollowerRequestProcessor@93] - FollowerRequestProcessor exited loop!\n2012-07-24 20:29:35,914 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FinalRequestProcessor@370] - shutdown of request processor complete\n2012-07-24 20:29:35,914 - INFO  [CommitProcessor:2:CommitProcessor@148] - CommitProcessor exited loop!\n2012-07-24 20:29:35,915 - INFO  [SyncThread:2:SyncRequestProcessor@151] - SyncRequestProcessor exited!\n2012-07-24 20:29:35,916 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), FOLLOWING (my state)\n2012-07-24 20:29:35,916 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@621] - LOOKING\n2012-07-24 20:29:35,918 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.100000000\n2012-07-24 20:29:35,919 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@663] - New election. My id =  2, Proposed zxid = 4294967296\n2012-07-24 20:29:35,919 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,920 - WARN  [WorkerSender Thread:QuorumCnxManager@384] - Cannot open channel to 5 at election address rsmm-slave-4/109.123.121.27:3888\njava.net.ConnectException: Connection refused\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:592)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:118)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:371)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:340)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:360)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:333)\n\tat java.lang.Thread.run(Thread.java:679)\n2012-07-24 20:29:35,920 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,922 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,926 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 4 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,928 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,932 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,936 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:36,137 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@655] - LEADING\n2012-07-24 20:29:36,141 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Leader@55] - TCP NoDelay set to: true\n2012-07-24 20:29:36,143 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@154] - Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /home/hduser/zookeeper/conf/version-2 snapdir /home/hduser/zookeeper/conf/version-2\n2012-07-24 20:29:36,147 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.100000000\n2012-07-24 20:29:36,148 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileTxnSnapLog@254] - Snapshotting: 100000000\n2012-07-24 20:29:37,149 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@249] - Follower sid: 4 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@1c74f37\n2012-07-24 20:29:37,150 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@273] - Synchronizing with Follower sid: 4 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:29:37,151 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,152 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@249] - Follower sid: 1 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@a17083\n2012-07-24 20:29:37,153 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@273] - Synchronizing with Follower sid: 1 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 100000000\n2012-07-24 20:29:37,154 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x100000000  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,156 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@249] - Follower sid: 3 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@16fe0f4\n2012-07-24 20:29:37,156 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@273] - Synchronizing with Follower sid: 3 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:29:37,157 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,159 - WARN  [LearnerHandler-/109.123.121.26:34087:Leader@492] - Commiting zxid 0x200000000 from /109.123.121.24:2888 not first!\n2012-07-24 20:29:37,160 - WARN  [LearnerHandler-/109.123.121.26:34087:Leader@494] - First is 0\n2012-07-24 20:29:37,172 - INFO  [LearnerHandler-/109.123.121.26:34087:Leader@518] - Have quorum of supporters; starting up and setting last processed zxid: 8589934592\n2012-07-24 20:30:40,397 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,397 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,398 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,400 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,641 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@249] - Follower sid: 5 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@15663a2\n2012-07-24 20:30:40,642 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@273] - Synchronizing with Follower sid: 5 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:30:40,642 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x200000000\n\n2012-07-24 20:30:37,768 - INFO  [main:QuorumPeerConfig@90] - Reading configuration from: /home/hduser/zookeeper/bin/../conf/zoo.cfg\n2012-07-24 20:30:37,774 - INFO  [main:QuorumPeerConfig@310] - Defaulting to majority quorums\n2012-07-24 20:30:37,792 - INFO  [main:QuorumPeerMain@119] - Starting quorum peer\n2012-07-24 20:30:37,820 - INFO  [main:NIOServerCnxn$Factory@143] - binding to port 0.0.0.0/0.0.0.0:2181\n2012-07-24 20:30:37,845 - INFO  [main:QuorumPeer@819] - tickTime set to 2000\n2012-07-24 20:30:37,845 - INFO  [main:QuorumPeer@830] - minSessionTimeout set to -1\n2012-07-24 20:30:37,846 - INFO  [main:QuorumPeer@841] - maxSessionTimeout set to -1\n2012-07-24 20:30:37,846 - INFO  [main:QuorumPeer@856] - initLimit set to 10\n2012-07-24 20:30:37,863 - INFO  [main:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.0\n2012-07-24 20:30:37,895 - INFO  [Thread-1:QuorumCnxManager$Listener@473] - My election bind port: 3888\n2012-07-24 20:30:37,909 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@621] - LOOKING\n2012-07-24 20:30:37,912 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@663] - New election. My id =  5, Proposed zxid = 0\n2012-07-24 20:30:37,923 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,923 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,924 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,924 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,925 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@721] - Updating proposal\n2012-07-24 20:30:37,928 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 5 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,929 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,929 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,931 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 1 (n.round), LOOKING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,932 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,932 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LEADING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,933 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,933 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,934 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,935 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,935 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,936 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,937 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LEADING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,937 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,938 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,938 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LEADING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,938 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,939 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,939 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LEADING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,939 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,940 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 4 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,941 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,941 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,941 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,942 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,942 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:37,942 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:30:38,143 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@643] - FOLLOWING\n2012-07-24 20:30:38,150 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@80] - TCP NoDelay set to: true\n2012-07-24 20:30:38,157 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:zookeeper.version=3.3.5-1301095, built on 03/15/2012 19:48 GMT\n2012-07-24 20:30:38,157 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:host.name=rsmm-slave-4\n2012-07-24 20:30:38,158 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.version=1.6.0_23\n2012-07-24 20:30:38,158 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.vendor=Sun Microsystems Inc.\n2012-07-24 20:30:38,158 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.home=/usr/lib/jvm/java-6-openjdk/jre\n2012-07-24 20:30:38,159 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.class.path=/home/hduser/zookeeper/bin/../build/classes:/home/hduser/zookeeper/bin/../build/lib/*.jar:/home/hduser/zookeeper/bin/../zookeeper-3.3.5.jar:/home/hduser/zookeeper/bin/../lib/log4j-1.2.15.jar:/home/hduser/zookeeper/bin/../lib/jline-0.9.94.jar:/home/hduser/zookeeper/bin/../src/java/lib/*.jar:/home/hduser/zookeeper/bin/../conf:\n2012-07-24 20:30:38,159 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.library.path=/usr/lib/jvm/java-6-openjdk/jre/lib/i386/client:/usr/lib/jvm/java-6-openjdk/jre/lib/i386:/usr/lib/jvm/java-6-openjdk/jre/../lib/i386:/usr/java/packages/lib/i386:/usr/lib/jni:/lib:/usr/lib\n2012-07-24 20:30:38,159 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.io.tmpdir=/tmp\n2012-07-24 20:30:38,159 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.compiler=<NA>\n2012-07-24 20:30:38,160 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.name=Linux\n2012-07-24 20:30:38,160 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.arch=i386\n2012-07-24 20:30:38,160 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.version=3.0.0-12-generic\n2012-07-24 20:30:38,160 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.name=hduser\n2012-07-24 20:30:38,160 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.home=/home/hduser\n2012-07-24 20:30:38,161 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.dir=/home/hduser/zookeeper/bin\n2012-07-24 20:30:38,162 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@154] - Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /home/hduser/zookeeper/conf/version-2 snapdir /home/hduser/zookeeper/conf/version-2\n2012-07-24 20:30:38,175 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@294] - Getting a snapshot from leader\n2012-07-24 20:30:38,179 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@326] - Setting leader epoch 2\n2012-07-24 20:30:38,180 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileTxnSnapLog@254] - Snapshotting: 200000000\n2012-07-24 20:30:46,564 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:41116\n2012-07-24 20:30:46,569 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1237] - Processing srvr command from /127.0.0.1:41116\n2012-07-24 20:30:46,573 - INFO  [Thread-10:NIOServerCnxn@1435] - Closed socket connection for client /127.0.0.1:41116 (no session established for client)\n2012-07-24 20:33:27,407 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:41118\n2012-07-24 20:33:27,408 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1237] - Processing srvr command from /127.0.0.1:41118\n2012-07-24 20:33:27,411 - INFO  [Thread-11:NIOServerCnxn@1435] - Closed socket connection for client /127.0.0.1:41118 (no session established for client)\n2012-07-24 20:47:21,659 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:41126\n2012-07-24 20:47:21,660 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1237] - Processing srvr command from /127.0.0.1:41126\n2012-07-24 20:47:21,663 - INFO  [Thread-12:NIOServerCnxn@1435] - Closed socket connection for client /127.0.0.1:41126 (no session established for client)\n==================================\n\nwhile the leader 's log shows\n\n2012-07-24 20:22:33,769 - INFO  [main:QuorumPeerConfig@90] - Reading configuration from: /home/hduser/zookeeper/bin/../conf/zoo.cfg\n2012-07-24 20:22:33,776 - INFO  [main:QuorumPeerConfig@310] - Defaulting to majority quorums\n2012-07-24 20:22:33,795 - INFO  [main:QuorumPeerMain@119] - Starting quorum peer\n2012-07-24 20:22:33,827 - INFO  [main:NIOServerCnxn$Factory@143] - binding to port 0.0.0.0/0.0.0.0:2181\n2012-07-24 20:22:33,854 - INFO  [main:QuorumPeer@819] - tickTime set to 2000\n2012-07-24 20:22:33,854 - INFO  [main:QuorumPeer@830] - minSessionTimeout set to -1\n2012-07-24 20:22:33,855 - INFO  [main:QuorumPeer@841] - maxSessionTimeout set to -1\n2012-07-24 20:22:33,855 - INFO  [main:QuorumPeer@856] - initLimit set to 10\n2012-07-24 20:22:33,874 - INFO  [main:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.100000000\n2012-07-24 20:22:33,905 - INFO  [Thread-1:QuorumCnxManager$Listener@473] - My election bind port: 3888\n2012-07-24 20:22:33,923 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@621] - LOOKING\n2012-07-24 20:22:33,926 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@663] - New election. My id =  2, Proposed zxid = 4294967296\n2012-07-24 20:22:33,935 - INFO  [WorkerSender Thread:QuorumCnxManager@183] - Have smaller server identifier, so dropping the connection: (3, 2)\n2012-07-24 20:22:33,935 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 1 (n.round), LOOKING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,936 - INFO  [WorkerSender Thread:QuorumCnxManager@183] - Have smaller server identifier, so dropping the connection: (4, 2)\n2012-07-24 20:22:33,937 - INFO  [WorkerSender Thread:QuorumCnxManager@183] - Have smaller server identifier, so dropping the connection: (5, 2)\n2012-07-24 20:22:33,938 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,939 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), FOLLOWING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,941 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,941 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,942 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), FOLLOWING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,943 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), FOLLOWING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,945 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LEADING (n.state), 5 (n.sid), LOOKING (my state)\n2012-07-24 20:22:33,945 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LEADING (n.state), 5 (n.sid), FOLLOWING (my state)\n2012-07-24 20:22:33,946 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@643] - FOLLOWING\n2012-07-24 20:22:33,952 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@80] - TCP NoDelay set to: true\n2012-07-24 20:22:33,959 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:zookeeper.version=3.3.5-1301095, built on 03/15/2012 19:48 GMT\n2012-07-24 20:22:33,960 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:host.name=rsmm-slave-1\n2012-07-24 20:22:33,960 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.version=1.6.0_23\n2012-07-24 20:22:33,960 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.vendor=Sun Microsystems Inc.\n2012-07-24 20:22:33,961 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.home=/usr/lib/jvm/java-6-openjdk/jre\n2012-07-24 20:22:33,961 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.class.path=/home/hduser/zookeeper/bin/../build/classes:/home/hduser/zookeeper/bin/../build/lib/*.jar:/home/hduser/zookeeper/bin/../zookeeper-3.3.5.jar:/home/hduser/zookeeper/bin/../lib/log4j-1.2.15.jar:/home/hduser/zookeeper/bin/../lib/jline-0.9.94.jar:/home/hduser/zookeeper/bin/../src/java/lib/*.jar:/home/hduser/zookeeper/bin/../conf:\n2012-07-24 20:22:33,961 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.library.path=/usr/lib/jvm/java-6-openjdk/jre/lib/i386/client:/usr/lib/jvm/java-6-openjdk/jre/lib/i386:/usr/lib/jvm/java-6-openjdk/jre/../lib/i386:/usr/java/packages/lib/i386:/usr/lib/jni:/lib:/usr/lib\n2012-07-24 20:22:33,961 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.io.tmpdir=/tmp\n2012-07-24 20:22:33,962 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:java.compiler=<NA>\n2012-07-24 20:22:33,962 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.name=Linux\n2012-07-24 20:22:33,962 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.arch=i386\n2012-07-24 20:22:33,962 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:os.version=3.0.0-12-generic\n2012-07-24 20:22:33,962 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.name=hduser\n2012-07-24 20:22:33,963 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.home=/home/hduser\n2012-07-24 20:22:33,963 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97] - Server environment:user.dir=/home/hduser/zookeeper/bin\n2012-07-24 20:22:33,965 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@154] - Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /home/hduser/zookeeper/conf/version-2 snapdir /home/hduser/zookeeper/conf/version-2\n2012-07-24 20:22:33,977 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@291] - Getting a diff from the leader 0x100000000\n2012-07-24 20:22:33,981 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Learner@326] - Setting leader epoch 1\n2012-07-24 20:22:33,983 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileTxnSnapLog@254] - Snapshotting: 100000000\n2012-07-24 20:22:40,102 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:41400\n2012-07-24 20:22:40,106 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1237] - Processing srvr command from /127.0.0.1:41400\n2012-07-24 20:22:40,109 - INFO  [Thread-10:NIOServerCnxn@1435] - Closed socket connection for client /127.0.0.1:41400 (no session established for client)\n2012-07-24 20:29:35,903 - WARN  [Thread-9:QuorumCnxManager$RecvWorker@727] - Connection broken for id 5, my id = 2, error = java.io.IOException: Channel eof\n2012-07-24 20:29:35,904 - WARN  [Thread-9:QuorumCnxManager$RecvWorker@730] - Interrupting SendWorker\n2012-07-24 20:29:35,905 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@82] - Exception when following the leader\njava.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:84)\n\tat org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n\tat org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:148)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:78)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:645)\n2012-07-24 20:29:35,905 - WARN  [Thread-8:QuorumCnxManager$SendWorker@633] - Interrupted while waiting for message on queue\njava.lang.InterruptedException\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2017)\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2094)\n\tat java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:370)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:622)\n2012-07-24 20:29:35,907 - WARN  [Thread-8:QuorumCnxManager$SendWorker@642] - Send worker leaving thread\n2012-07-24 20:29:35,907 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@165] - shutdown called\njava.lang.Exception: shutdown Follower\n\tat org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:165)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:649)\n2012-07-24 20:29:35,913 - INFO  [FollowerRequestProcessor:2:FollowerRequestProcessor@93] - FollowerRequestProcessor exited loop!\n2012-07-24 20:29:35,914 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FinalRequestProcessor@370] - shutdown of request processor complete\n2012-07-24 20:29:35,914 - INFO  [CommitProcessor:2:CommitProcessor@148] - CommitProcessor exited loop!\n2012-07-24 20:29:35,915 - INFO  [SyncThread:2:SyncRequestProcessor@151] - SyncRequestProcessor exited!\n2012-07-24 20:29:35,916 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), FOLLOWING (my state)\n2012-07-24 20:29:35,916 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@621] - LOOKING\n2012-07-24 20:29:35,918 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.100000000\n2012-07-24 20:29:35,919 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@663] - New election. My id =  2, Proposed zxid = 4294967296\n2012-07-24 20:29:35,919 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,920 - WARN  [WorkerSender Thread:QuorumCnxManager@384] - Cannot open channel to 5 at election address rsmm-slave-4/109.123.121.27:3888\njava.net.ConnectException: Connection refused\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:592)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:118)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:371)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:340)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:360)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:333)\n\tat java.lang.Thread.run(Thread.java:679)\n2012-07-24 20:29:35,920 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,922 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,926 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 4 (n.leader), 0 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,928 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 4 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,932 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-24 20:29:35,936 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-24 20:29:36,137 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumPeer@655] - LEADING\n2012-07-24 20:29:36,141 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Leader@55] - TCP NoDelay set to: true\n2012-07-24 20:29:36,143 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@154] - Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /home/hduser/zookeeper/conf/version-2 snapdir /home/hduser/zookeeper/conf/version-2\n2012-07-24 20:29:36,147 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileSnap@82] - Reading snapshot /home/hduser/zookeeper/conf/version-2/snapshot.100000000\n2012-07-24 20:29:36,148 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FileTxnSnapLog@254] - Snapshotting: 100000000\n2012-07-24 20:29:37,149 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@249] - Follower sid: 4 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@1c74f37\n2012-07-24 20:29:37,150 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@273] - Synchronizing with Follower sid: 4 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:29:37,151 - INFO  [LearnerHandler-/109.123.121.26:34087:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,152 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@249] - Follower sid: 1 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@a17083\n2012-07-24 20:29:37,153 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@273] - Synchronizing with Follower sid: 1 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 100000000\n2012-07-24 20:29:37,154 - INFO  [LearnerHandler-/109.123.121.23:41659:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x100000000  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,156 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@249] - Follower sid: 3 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@16fe0f4\n2012-07-24 20:29:37,156 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@273] - Synchronizing with Follower sid: 3 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:29:37,157 - INFO  [LearnerHandler-/109.123.121.25:54707:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x100000000\n2012-07-24 20:29:37,159 - WARN  [LearnerHandler-/109.123.121.26:34087:Leader@492] - Commiting zxid 0x200000000 from /109.123.121.24:2888 not first!\n2012-07-24 20:29:37,160 - WARN  [LearnerHandler-/109.123.121.26:34087:Leader@494] - First is 0\n2012-07-24 20:29:37,172 - INFO  [LearnerHandler-/109.123.121.26:34087:Leader@518] - Have quorum of supporters; starting up and setting last processed zxid: 8589934592\n2012-07-24 20:30:40,397 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 5 (n.leader), 0 (n.zxid), 1 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,397 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,398 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,400 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 2 (n.leader), 4294967296 (n.zxid), 2 (n.round), LOOKING (n.state), 5 (n.sid), LEADING (my state)\n2012-07-24 20:30:40,641 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@249] - Follower sid: 5 : info : org.apache.zookeeper.server.quorum.QuorumPeer$QuorumServer@15663a2\n2012-07-24 20:30:40,642 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@273] - Synchronizing with Follower sid: 5 maxCommittedLog =0 minCommittedLog = 0 peerLastZxid = 0\n2012-07-24 20:30:40,642 - INFO  [LearnerHandler-/109.123.121.27:34526:LearnerHandler@357] - Sending snapshot last zxid of peer is 0x0  zxid of leader is 0x200000000sent zxid of db as 0x200000000\n2012-07-24 20:49:19,788 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn$Factory@251] - Accepted socket connection from /127.0.0.1:41403\n2012-07-24 20:49:19,789 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1237] - Processing srvr command from /127.0.0.1:41403\n2012-07-24 20:49:19,791 - INFO  [Thread-18:NIOServerCnxn@1435] - Closed socket connection for client /127.0.0.1:41403 (no session established for client)", "created_at" : { "$date" : "2012-07-24T12:52:45.833+0000" }, "updated_at" : { "$date" : "2012-08-03T00:30:28.913+0000" }, "creator_id" : { "$oid" : "5b7d5262e9214a0d1608d976" }, "reporter_id" : { "$oid" : "5b7d5262e9214a0d1608d976" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [ "3.3.5" ], "issue_links" : [  ], "environment" : "zookeeper version 3.3.5\nHadoop version 0.20.205.0" },
{ "_id" : { "$oid" : "5b7d52635f627d6b0586cf0f" }, "external_id" : "ZOOKEEPER-1514", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FastLeaderElection - leader ignores the round information when joining a quorum", "desc" : "In the following case we have a 3 server ensemble.\n\nInitially all is well, zk3 is the leader.\n\nHowever zk3 fails, restarts, and rejoins the quorum as the new leader (was the old leader, still the leader after re-election)\n\nThe existing two followers, zk1 and zk2 rejoin the new quorum again as followers of zk3.\n\nzk1 then fails, the datadirectory is deleted (so it has no state whatsoever) and restarted. However zk1 can never rejoin the quorum (even after an hour). During this time zk2 and zk3 are serving properly.\n\nLater all three servers are later restarted and properly form a functional quourm.\n\n\nHere are some interesting log snippets. Nothing else of interest was seen in the logs during this time:\n\nzk3. This is where it becomes the leader after failing initially (as the leader). Notice the \"round\" is ahead of zk1 and zk2:\n\n{noformat}\n2012-07-18 17:19:35,423 - INFO  [QuorumPeer:/0.0.0.0:2181:FastLeaderElection@663] - New election. My id =  3, Proposed zxid = 77309411648\n2012-07-18 17:19:35,423 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 77309411648 (n.zxid), 832 (n.round), LOOKING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-18 17:19:35,424 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 73014444480 (n.zxid), 831 (n.round), FOLLOWING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-18 17:19:35,424 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 73014444480 (n.zxid), 831 (n.round), FOLLOWING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-18 17:19:35,424 - INFO  [QuorumPeer:/0.0.0.0:2181:QuorumPeer@655] - LEADING\n{noformat}\n\nzk1 which won't come back. Notice that zk3 is reporting the round as 831, while zk2 thinks that the round is 832:\n\n{noformat}\n2012-07-18 17:31:12,015 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 1 (n.leader), 77309411648 (n.zxid), 1 (n.round), LOOKING (n.state), 1 (n.sid), LOOKING (my state)\n2012-07-18 17:31:12,016 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 73014444480 (n.zxid), 831 (n.round), LEADING (n.state), 3 (n.sid), LOOKING (my state)\n2012-07-18 17:31:12,017 - INFO  [WorkerReceiver Thread:FastLeaderElection@496] - Notification: 3 (n.leader), 77309411648 (n.zxid), 832 (n.round), FOLLOWING (n.state), 2 (n.sid), LOOKING (my state)\n2012-07-18 17:31:15,219 - INFO  [QuorumPeer:/0.0.0.0:2181:FastLeaderElection@697] - Notification time out: 6400\n{noformat}\n", "created_at" : { "$date" : "2012-07-20T00:52:33.669+0000" }, "updated_at" : { "$date" : "2012-08-03T10:55:21.471+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.4" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52645f627d6b0586cf30" }, "external_id" : "ZOOKEEPER-1425", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add version command to the zookeeper client shell", "desc" : "the client shell is missing a version command. Should return the version e.g. \"3.5.0\"", "created_at" : { "$date" : "2012-03-18T06:31:02.214+0000" }, "updated_at" : { "$date" : "2012-08-05T15:50:13.751+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "scripts", "java client" ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52645f627d6b0586cf39" }, "external_id" : "ZOOKEEPER-1526", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc", "desc" : "I added another listitem documenting the filename arg of the JavaExample code.", "created_at" : { "$date" : "2012-08-09T20:50:17.972+0000" }, "updated_at" : { "$date" : "2012-08-09T20:50:17.972+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52655f627d6b0586cf3a" }, "external_id" : "ZOOKEEPER-1542", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh start fails but exit status 0", "desc" : "zkServer.sh\n\n     99     nohup $JAVA \"-Dzookeeper.log.dir=${ZOO_LOG_DIR}\" \"-Dzookeeper.root.logger=${ZOO_LOG4J_PROP}\" \\\n    100     -cp \"$CLASSPATH\" $JVMFLAGS $ZOOMAIN \"$ZOOCFG\" > \"$_ZOO_DAEMON_OUT\" 2>&1 < /dev/null &\n\nCannot capture exit status of a background process.\n\n    101     if [ $? -eq 0 ]\n    102     then\n    103       if /bin/echo -n $! > \"$ZOOPIDFILE\"\n    104       then\n    105         sleep 1\n    106         echo STARTED\n    107       else\n    108         echo FAILED TO WRITE PID\n    109         exit 1\n    110       fi\n    111     else\n    112       echo SERVER DID NOT START\n    113       exit 1\n    114     fi\n", "created_at" : { "$date" : "2012-08-24T18:53:55.050+0000" }, "updated_at" : { "$date" : "2012-08-24T19:00:45.446+0000" }, "creator_id" : { "$oid" : "5b7d5265e9214a0d1608d978" }, "reporter_id" : { "$oid" : "5b7d5265e9214a0d1608d978" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.6" ], "components" : [ "scripts" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windwos7 + Cygwin" },
{ "_id" : { "$oid" : "5b7d52665f627d6b0586cf3d" }, "external_id" : "ZOOKEEPER-1537", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "registration page not accepting capital letters", "desc" : "1.Type zookeeper URL in the address bar to go to home page of it.\n2.For new users, click on \"new user\" and it will open a registration form.\n3.Give your full name in capital letters as mentioned.\n4.Even though I give capital letters it is not accepting and is giving an error message as \"PLEASE TYPE CAPITAL LETTERS\"", "created_at" : { "$date" : "2012-08-17T14:20:18.042+0000" }, "updated_at" : { "$date" : "2012-08-30T05:39:02.108+0000" }, "creator_id" : { "$oid" : "5b7d5266e9214a0d1608d979" }, "reporter_id" : { "$oid" : "5b7d5266e9214a0d1608d979" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [ "c client" ], "labels" : [ "performance" ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 1510560, "environment" : "WINDOWS XP, MOZILLA FIREFOX, 500 GB HARD DISK, 2 GB RAM\n" },
{ "_id" : { "$oid" : "5b7d52665f627d6b0586cf42" }, "external_id" : "ZOOKEEPER-1536", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client : memory leak in winport.c", "desc" : "At line 99 in winport.c, use windows API \"InitializeCriticalSection\" but never call \"DeleteCriticalSection\"", "created_at" : { "$date" : "2012-08-16T03:13:13.972+0000" }, "updated_at" : { "$date" : "2012-08-31T11:02:19.042+0000" }, "creator_id" : { "$oid" : "5b7d5266e9214a0d1608d97a" }, "reporter_id" : { "$oid" : "5b7d5266e9214a0d1608d97a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5266e9214a0d1608d97a" }, "issue_links" : [  ], "environment" : "windows7" },
{ "_id" : { "$oid" : "5b7d52675f627d6b0586cf4d" }, "external_id" : "ZOOKEEPER-1481", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "allow the C cli to run exists with a watcher", "desc" : "Adds a wexists command and also improves the stdout (type string rather than just the number). Granted wexists is more for testing purposes than strictly necessary (we have exists already) but but still worthwhile to add imo.", "created_at" : { "$date" : "2012-06-08T23:07:16.992+0000" }, "updated_at" : { "$date" : "2012-08-31T11:02:19.123+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52605f627d6b0586cef6" }, "external_id" : "ZOOKEEPER-1503", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "fix_versions" : [ "3.5.0", "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52685f627d6b0586cf57" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52605f627d6b0586cef7" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "created_at" : { "$date" : "2012-07-05T18:03:20.026+0000" }, "priority" : "Major", "desc" : "https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1120//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html", "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "updated_at" : { "$date" : "2012-09-01T02:12:10.154+0000" }, "title" : "remove redundant JAAS configuration code in SaslAuthTest and SaslAuthFailTest", "issue_type" : "Improvement", "environment" : "In SaslAuthTest and SaslAuthFail test, we set the JAAS configuration twice with the same text string. This is confusing and redundant, since we need only set it once.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52685f627d6b0586cf68" }, "external_id" : "ZOOKEEPER-1328", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Misplaced assertion for the test case 'FLELostMessageTest' and not identifying misfunctions", "desc" : "Assertion for testLostMessage is kept inside the thread.run() method. Due to this the assertion failure will not be reflected in the main testcase. \nI have observed the test case is still passing in case of the assert failure or misfunction. Instead, the assertion can be moved to the test case - testLostMessage.\n\n{noformat}\nclass LEThread extends Thread {\n          public void run(){\n                peer.setCurrentVote(v);\n                LOG.info(\"Finished election: \" + i + \", \" + v.getId());\n                Assert.assertTrue(\"State is not leading.\", peer.getPeerState() == ServerState.LEADING);\n             } \n{noformat}", "created_at" : { "$date" : "2011-12-13T05:46:14.032+0000" }, "updated_at" : { "$date" : "2012-09-03T11:01:35.890+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Test", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.0" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52695f627d6b0586cf84" }, "external_id" : "ZOOKEEPER-1544", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "System.exit() calls on interrupted SyncThread", "desc" : "We have a test framework at Lucene/Solr which attempts to interrupt threads that leak out of a single class (suite) scope. The problem we're facing is that ZooKeeper's SyncThread is doing this:\n{code}\n>>             LOG.fatal(\"Severe unrecoverable error, exiting\", t);\n>>             System.exit(11);\n{code}\n\nIs this terminating the JVM really needed here? Could it be made optional with a system property or even removed entirely? Currently it aborts the entire JUnit runner and prevents successive tests from continuing.\n\n", "created_at" : { "$date" : "2012-09-03T14:01:32.225+0000" }, "updated_at" : { "$date" : "2012-09-03T16:03:07.330+0000" }, "creator_id" : { "$oid" : "5b7d3a18e9214a0d1608d83f" }, "reporter_id" : { "$oid" : "5b7d3a18e9214a0d1608d83f" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.3.6" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526a5f627d6b0586cf8a" }, "external_id" : "ZOOKEEPER-1545", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "very odd issue about zookeeper when deploy two web application in one tomcat", "desc" : "if I deploy two application(both use zookeeper) to same tomcat,zookeeper in one app will inexplicable disconnect when tomcat startup.\n\nfollowing is my code,it is very simple:\n\npublic class ZKTester implements InitializingBean, Watcher {\n\n    private ZooKeeper hZooKeeper;\n\n    public void afterPropertiesSet() throws Exception {\n        hZooKeeper = new ZooKeeper(\"localhost:2181\", 300000, this);\n    }\n\n    public void process(WatchedEvent event) {\n        System.out.println(\"**************\" + event);\n    }\n\nand the spring config file:\n\n<bean id=\"zooTester\" class=\"com.abc.framework.cluster.ZKTester\"/>\n\nAnd following is tomcat's startup log:\n\n...\n**************WatchedEvent state:Disconnected type:None path:null\n**************WatchedEvent state:Expired type:None path:null\n...\n", "created_at" : { "$date" : "2012-09-04T06:20:15.688+0000" }, "updated_at" : { "$date" : "2012-09-04T06:20:15.688+0000" }, "creator_id" : { "$oid" : "5b7d526ae9214a0d1608d97c" }, "reporter_id" : { "$oid" : "5b7d526ae9214a0d1608d97c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "OS:windows 7 32\nzookeeper 3.4.3\ntomcat 7.0.29\n" },
{ "_id" : { "$oid" : "5b7d526a5f627d6b0586cf8b" }, "external_id" : "ZOOKEEPER-1380", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkperl: _zk_release_watch doesn't remove items properly from the watch list", "desc" : "The doubly linked list of watches is not updated properly if a watch is taken out from the middle of the chain.\nThe item after the item which is taken out will receive null pointer for the previous element! This will make the doubly linked list inconsistent and can lead to segfault or infinite loop when the doubly linked list is iterated later.", "created_at" : { "$date" : "2012-01-30T17:14:17.338+0000" }, "updated_at" : { "$date" : "2012-09-07T11:01:51.416+0000" }, "creator_id" : { "$oid" : "5b7d5214e9214a0d1608d941" }, "reporter_id" : { "$oid" : "5b7d5214e9214a0d1608d941" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3", "3.4.2", "3.3.4", "3.4.0", "3.4.1" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5214e9214a0d1608d941" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526b5f627d6b0586cf99" }, "external_id" : "ZOOKEEPER-1501", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Nagios plugin always returns OK when it cannot connect to zookeeper", "desc" : "Returning OK under such conditions is really not good...", "created_at" : { "$date" : "2012-07-04T17:14:54.988+0000" }, "updated_at" : { "$date" : "2012-09-07T11:01:51.362+0000" }, "creator_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "reporter_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d525fe9214a0d1608d974" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526b5f627d6b0586cfa6" }, "external_id" : "HBASE-6099", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526b5f627d6b0586cfa7" }, "external_id" : "ZOOKEEPER-1475", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Messages about missing JAAS configuration should not be logged at WARN level", "desc" : "Messages about unconfigured JAAS settings probably should not be logged at WARN level because it's intentional if the user is not using any SASL based security features. The user may conclude that security is not optional, or that the missing JAAS configuration is behind failures that have an unrelated cause. Perhaps INFO level instead.", "created_at" : { "$date" : "2012-05-31T19:08:39.935+0000" }, "updated_at" : { "$date" : "2012-09-10T04:26:11.505+0000" }, "creator_id" : { "$oid" : "5b7d5254e9214a0d1608d96c" }, "reporter_id" : { "$oid" : "5b7d5254e9214a0d1608d96c" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d526b5f627d6b0586cfa6" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d526c5f627d6b0586cfab" }, "external_id" : "ZOOKEEPER-1494", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client: socket leak after receive timeout in zookeeper_interest()", "desc" : "In zookeeper_interest(), we set zk->fd to -1 without closing it when timeout happens. Instead we should let handle_socket_error_msg() function take care of closing the socket properly.\n\n--Michi", "created_at" : { "$date" : "2012-06-22T19:56:13.591+0000" }, "updated_at" : { "$date" : "2012-09-10T11:01:44.142+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.2", "3.3.5" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526d5f627d6b0586cfcd" }, "external_id" : "ZOOKEEPER-1543", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Bad sessionId/password combo should return auth failure", "desc" : "When connecting to a server with a valid session id, but invalid password, Zookeeper disconnects with a SESSION_EXPIRED error. This is blatantly false, its actually the wrong password. Returning a SESSION_EXPIRED in this case is also not documented anywhere.\n\nThis makes debugging this issue an absolute nightmare, since the server has already lead you down the wrong track (trying to figure out why the session is expired, but it isn't).\n\nThere's already an AUTH_FAILURE error, why not return that?", "created_at" : { "$date" : "2012-08-31T18:40:16.950+0000" }, "updated_at" : { "$date" : "2012-09-10T23:34:06.783+0000" }, "creator_id" : { "$oid" : "5b7d526de9214a0d1608d97e" }, "reporter_id" : { "$oid" : "5b7d526de9214a0d1608d97e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3", "3.5.0", "3.3.6" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "All" },
{ "_id" : { "$oid" : "5b7d526e5f627d6b0586cfd1" }, "external_id" : "ZOOKEEPER-1361", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader.lead iterates over 'learners' set without proper synchronisation", "desc" : "This block:\n\n{code}\nHashSet<Long> followerSet = new HashSet<Long>();\nfor(LearnerHandler f : learners)\n    followerSet.add(f.getSid());\n{code}\n\nis executed without holding the lock on learners, so if there were ever a condition where a new learner was added during the initial sync phase, I'm pretty sure we'd see a concurrent modification exception. Certainly other parts of the code are very careful to lock on learners when iterating. \n\nIt would be nice to use a {{ConcurrentHashMap}} to hold the learners instead, but I can't convince myself that this wouldn't introduce some correctness bugs. For example the following:\n\nLearners contains A, B, C, D\nThread 1 iterates over learners, and gets as far as B.\nThread 2 removes A, and adds E.\nThread 1 continues iterating and sees a learner view of A, B, C, D, E\n\nThis may be a bug if Thread 1 is counting the number of synced followers for a quorum count, since at no point was A, B, C, D, E a correct view of the quorum.\n\nIn practice, I think this is actually ok, because I don't think ZK makes any strong ordering guarantees on learners joining or leaving (so we don't need a strong serialisability guarantee on learners) but I don't think I'll make that change for this patch. Instead I want to clean up the locking protocols on the follower / learner sets - to avoid another easy deadlock like the one we saw in ZOOKEEPER-1294 - and to do less with the lock held; i.e. to copy and then iterate over the copy rather than iterate over a locked set. ", "created_at" : { "$date" : "2012-01-13T17:43:38.637+0000" }, "updated_at" : { "$date" : "2012-09-17T05:04:15.059+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.2" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d526f5f627d6b0586cff4" }, "external_id" : "ZOOKEEPER-1496", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral node not getting cleared even after client has exited", "desc" : "In one of the tests we performed, came across a case where the ephemeral node was not getting cleared from zookeeper though the client exited.\n\nZk version: 3.4.3\n\nEphemeral node still exists in Zookeeper: \n\nHOST-xx-xx-xx-55:/home/Jun25_LR/install/zookeeper/bin # date \n\nTue Jun 26 16:07:04 IST 2012 \nHOST-xx-xx-xx-55:/home/Jun25_LR/install/zookeeper/bin # ./zkCli.sh -server xx.xx.xx.55:2182 \nConnecting to xx.xx.xx.55:2182 \nWelcome to ZooKeeper! \nJLine support is enabled \n[zk: xx.xx.xx.55:2182(CONNECTING) 0] \nWATCHER:: \n\nWatchedEvent state:SyncConnected type:None path:null \n\n[zk: xx.xx.xx.55:2182(CONNECTED) 0] get /hadoop-ha/hacluster/ActiveStandbyElectorLock \n\nhaclusternn2HOSt-xx-xx-xx-102  \ncZxid = 0x200000075 \nctime = Tue Jun 26 13:10:19 IST 2012 \nmZxid = 0x200000075 \nmtime = Tue Jun 26 13:10:19 IST 2012 \npZxid = 0x200000075 \ncversion = 0 \ndataVersion = 0 \naclVersion = 0 \nephemeralOwner = 0x1382791d4e50004 \ndataLength = 42 \nnumChildren = 0 \n[zk: xx.xx.xx.55:2182(CONNECTED) 1] \n\nGrepped logs at ZK side for session \"0x1382791d4e50004\" - close session and later create coming before closesession processed. \n\nHOSt-xx-xx-xx-91:/home/Jun25_LR/install/zookeeper/logs # grep -E \"/hadoop-ha/hacluster/ActiveStandbyElectorLock|0x1382791d4e50004\" *|grep 0x200000074 \n2012-06-26 13:10:18,834 [myid:3] - DEBUG [ProcessThread(sid:3 cport:-1)::CommitProcessor@171] - Processing request:: sessionid:0x1382791d4e50004 type:closeSession cxid:0x0 zxid:0x200000074 txntype:-11 reqpath:n/a \n2012-06-26 13:10:19,892 [myid:3] - DEBUG [ProcessThread(sid:3 cport:-1)::Leader@716] - Proposing:: sessionid:0x1382791d4e50004 type:closeSession cxid:0x0 zxid:0x200000074 txntype:-11 reqpath:n/a \n2012-06-26 13:10:19,919 [myid:3] - DEBUG [LearnerHandler-/xx.xx.xx.102:13846:CommitProcessor@161] - Committing request:: sessionid:0x1382791d4e50004 type:closeSession cxid:0x0 zxid:0x200000074 txntype:-11 reqpath:n/a \n2012-06-26 13:10:20,608 [myid:3] - DEBUG [CommitProcessor:3:FinalRequestProcessor@88] - Processing request:: sessionid:0x1382791d4e50004 type:closeSession cxid:0x0 zxid:0x200000074 txntype:-11 reqpath:n/a \n\nHOSt-xx-xx-xx-91:/home/Jun25_LR/install/zookeeper/logs # grep -E \"/hadoop-ha/hacluster/ActiveStandbyElectorLock|0x1382791d4e50004\" *|grep 0x200000075 \n2012-06-26 13:10:19,893 [myid:3] - DEBUG [ProcessThread(sid:3 cport:-1)::CommitProcessor@171] - Processing request:: sessionid:0x1382791d4e50004 type:create cxid:0x2 zxid:0x200000075 txntype:1 reqpath:n/a \n2012-06-26 13:10:19,920 [myid:3] - DEBUG [ProcessThread(sid:3 cport:-1)::Leader@716] - Proposing:: sessionid:0x1382791d4e50004 type:create cxid:0x2 zxid:0x200000075 txntype:1 reqpath:n/a \n2012-06-26 13:10:20,278 [myid:3] - DEBUG [LearnerHandler-/xx.xx.xx.102:13846:CommitProcessor@161] - Committing request:: sessionid:0x1382791d4e50004 type:create cxid:0x2 zxid:0x200000075 txntype:1 reqpath:n/a \n2012-06-26 13:10:20,752 [myid:3] - DEBUG [CommitProcessor:3:FinalRequestProcessor@88] - Processing request:: sessionid:0x1382791d4e50004 type:create cxid:0x2 zxid:0x200000075 txntype:1 reqpath:n/a \n\n\n Close session and create requests coming almost parallely. \n\n\nEnv:\nHadoop setup.\nWe were using Namenode HA with bookkeeper as shared storage and auto failover enabled.\nNN102 was active and NN55 was standby. \nFailoverController at 102 got shut down due to ZK connection error. \nThe lock-ActiveStandbyElectorLock created (ephemeral node) by this failovercontroller is not cleared from ZK\n", "created_at" : { "$date" : "2012-06-28T10:24:35.179+0000" }, "updated_at" : { "$date" : "2012-09-17T11:02:06.787+0000" }, "creator_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "reporter_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d50dc5f627d6b0586a60f" }, "external_id" : "ZOOKEEPER-799", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50dc5f627d6b0586a612" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d50d25f627d6b0586a5d8" }, "effect" : "requires", "type" : "Required" } ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "created_at" : { "$date" : "2010-06-29T21:13:36.539+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bc" }, "updated_at" : { "$date" : "2012-09-17T13:21:12.266+0000" }, "title" : "Add tools and recipes for monitoring as a contrib", "issue_type" : "New Feature", "desc" : "Tools and Recipes for Monitoring ZooKeeper using Cacti, Nagios or Ganglia. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52705f627d6b0586d043" }, "external_id" : "ZOOKEEPER-1539", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Tests in QuorumUtil.startAll() and JMXenv", "desc" : "Consider the following test:\n\n@Test\npublic void newTest() throws Exception {\n    QuorumUtil qu = new QuorumUtil(3);\n    qu.startAll();\n}\n\nAlthough it doesn't seem like we're checking anything at all here, this test actually fails. There is a JMXEnv.ensureAll test invoked from startAll(). It passes for QuorumUtil(1) or QuorumUtil(2) servers but fails for any larger number. Besides the fact that there's a bug in the tests, I think we should call the function differently if we want to invoke tests in it, or alternatively remove these tests or make them optional using some parameter.\n", "created_at" : { "$date" : "2012-08-22T04:59:48.802+0000" }, "updated_at" : { "$date" : "2012-09-23T01:49:43.151+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52135f627d6b0586c83e" }, "external_id" : "ZOOKEEPER-1376", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.3", "3.3.4" ], "components" : [ "scripts" ], "labels" : [ "newbie" ], "fix_versions" : [ "3.4.5", "3.3.7" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52135f627d6b0586c83f" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d5271e9214a0d1608d982" }, "created_at" : { "$date" : "2012-01-27T01:39:03.074+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2012-09-24T18:29:14.352+0000" }, "title" : "zkServer.sh does not correctly check for $SERVER_JVMFLAGS", "issue_type" : "Bug", "desc" : "It will always include it even if not defined, although not much harm.\n\nif [ \"x$SERVER_JVMFLAGS\" ]\nthen\nJVMFLAGS=\"$SERVER_JVMFLAGS $JVMFLAGS\"\nfi\n\nshould use the std idiom.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52685f627d6b0586cf57" }, "external_id" : "ZOOKEEPER-1497", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "server" ], "labels" : [ "security" ], "fix_versions" : [ "3.5.0", "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52605f627d6b0586cef6" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52725f627d6b0586d056" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52385f627d6b0586cba4" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5271e9214a0d1608d983" }, "created_at" : { "$date" : "2012-07-03T21:08:28.429+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5271e9214a0d1608d983" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5271e9214a0d1608d983" }, "updated_at" : { "$date" : "2012-09-26T18:17:37.721+0000" }, "title" : "Allow server-side SASL login with JAAS configuration to be programmatically set (rather than only by reading JAAS configuration file)", "issue_type" : "Improvement", "desc" : "Currently the CnxnFactory checks for \"java.security.auth.login.config\" to decide whether or not enable SASL.\n* zookeeper/server/NIOServerCnxnFactory.java\n* zookeeper/server/NettyServerCnxnFactory.java\n** configure() checks for \"java.security.auth.login.config\"\n*** If present start the new Login(\"Server\", SaslServerCallbackHandler(conf))\n\nBut since the SaslServerCallbackHandler does the right thing just checking if getAppConfigurationEntry() is empty, we can allow SASL with JAAS configuration to be programmatically just checking weather or not a configuration entry is present instead of \"java.security.auth.login.config\".\n(Something quite similar was done for the SaslClient in ZOOKEEPER-1373)", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52725f627d6b0586d096" }, "external_id" : "ZOOKEEPER-1555", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ACLs are not respected for node deletion", "desc" : "Any session can delete nodes with restricted ACLs.", "created_at" : { "$date" : "2012-10-03T15:59:10.903+0000" }, "updated_at" : { "$date" : "2012-10-03T16:08:26.087+0000" }, "creator_id" : { "$oid" : "5b7d5272e9214a0d1608d984" }, "reporter_id" : { "$oid" : "5b7d5272e9214a0d1608d984" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52735f627d6b0586d09b" }, "external_id" : "ZOOKEEPER-1566", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "progress  quits duo to zxid  not in order", "desc" : "2012-10-17 15:04:28,006 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@116] - Got  0x3800000002 expected 0x3800000001\n2012-10-17 15:04:28,007 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@116] - Got zxid 0x3800000001 expected 0x3800000003\n2012-10-17 15:04:28,007 - WARN  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:Follower@116] - Got zxid 0x3800000003 expected 0x3800000002\n2012-10-17 15:04:28,009 - FATAL [QuorumPeer:/0:0:0:0:0:0:0:0:2181:FollowerZooKeeperServer@112] - Committing zxid 0x3800000003 but next pending txn 0x3800000001", "created_at" : { "$date" : "2012-10-17T10:09:35.622+0000" }, "updated_at" : { "$date" : "2012-10-17T10:11:52.755+0000" }, "creator_id" : { "$oid" : "5b7d5273e9214a0d1608d985" }, "reporter_id" : { "$oid" : "5b7d5273e9214a0d1608d985" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52745f627d6b0586d09e" }, "external_id" : "ZOOKEEPER-1567", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "JMX can't be disabled with zkEnv.sh", "desc" : "zkServer.sh looks for JMX variables before \"including\" zkEnv.sh, this way you can not disable JMX with scripts which zkEnv.sh \"includes\".\n\nPatch included.", "created_at" : { "$date" : "2012-10-17T18:34:40.837+0000" }, "updated_at" : { "$date" : "2012-10-17T19:09:17.864+0000" }, "creator_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "reporter_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Patch Available", "affects_versions" : [ "3.4.4" ], "components" : [ "scripts" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52745f627d6b0586d0a6" }, "external_id" : "ZOOKEEPER-1560", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper client hangs on creation of large nodes", "desc" : "To reproduce, try creating a node with 0.5M of data using java client. The test will hang waiting for a response from the server. See the attached patch for the test that reproduces the issue.\n\nIt seems that ZOOKEEPER-1437 introduced a few issues to {{ClientCnxnSocketNIO.doIO}} that prevent {{ClientCnxnSocketNIO}} from sending large packets that require several invocations of {{SocketChannel.write}} to complete. The first issue is that the call to {{outgoingQueue.removeFirstOccurrence(p);}} removes the packet from the queue even if the packet wasn't completely sent yet.  It looks to me that this call should be moved under {{if (!pbb.hasRemaining())}} The second issue is that {{p.createBB()}} is reinitializing {{ByteBuffer}} on every iteration, which confuses {{SocketChannel.write}}. And the third issue is caused by extra calls to {{cnxn.getXid()}} that increment xid on every iteration and confuse the server.\n", "created_at" : { "$date" : "2012-10-10T23:45:05.870+0000" }, "updated_at" : { "$date" : "2012-10-31T23:00:47.081+0000" }, "creator_id" : { "$oid" : "5b7d5274e9214a0d1608d986" }, "reporter_id" : { "$oid" : "5b7d5274e9214a0d1608d986" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0", "3.4.4" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5271e9214a0d1608d982" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52745f627d6b0586d0a5" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52755f627d6b0586d0fd" }, "external_id" : "ZOOKEEPER-1547", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Test robustness of client using SASL in the presence of dropped requests", "desc" : "ZK clients send SASL packets to ZK servers as request packets. However, what if the server does not responds to the client's SASL packets with responses? In this scenario, the server does not actually close the connection to the client, it simply fails to respond to SASL requests. Make sure the client can cope with this behavior.\n\nBackground:\n\nIn ZOOKEEPER-1437, Ben writes: \n\n\"[I]t would be great to add a test that simply drops responses to clients without closing connections.\"\n\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-1437?focusedCommentId=13447477&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13447477\n\nAlso in ZOOKEEPER-1437 Rakesh writes: \"I could see DisconnectableZooKeeper.disconnect() has network delays/partition simulation logic.\"\n\nhttps://issues.apache.org/jira/browse/ZOOKEEPER-1437?focusedCommentId=13445704&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13445704\n\n", "created_at" : { "$date" : "2012-09-04T20:42:32.119+0000" }, "updated_at" : { "$date" : "2012-11-06T05:13:27.273+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52755f627d6b0586d0fc" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52765f627d6b0586d103" }, "external_id" : "ZOOKEEPER-1577", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Update website with info on how to report security bugs ", "desc" : "The website should be updated with information on how to report potential security vulnerabilities. In Hadoop land we have a private security list that anyone case post to that we point to on our list page: Hadoop example http://hadoop.apache.org/general_lists.html#Security.", "created_at" : { "$date" : "2012-11-08T03:46:21.960+0000" }, "updated_at" : { "$date" : "2012-11-08T03:46:21.960+0000" }, "creator_id" : { "$oid" : "5b7d51eee9214a0d1608d932" }, "reporter_id" : { "$oid" : "5b7d51eee9214a0d1608d932" }, "issue_type" : "Task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52765f627d6b0586d104" }, "external_id" : "ZOOKEEPER-1493", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C Client: zookeeper_process doesn't invoke completion callback if zookeeper_close has been called", "desc" : "In ZOOKEEPER-804, we added a check in zookeeper_process() to see if zookeeper_close() has been called. This was to avoid calling assert(cptr) on a NULL pointer, as dequeue_completion() returns NULL if the sent_requests queue has been cleared by free_completion() from zookeeper_close(). However, we should still call the completion if it is not NULL. ", "created_at" : { "$date" : "2012-06-20T20:47:58.199+0000" }, "updated_at" : { "$date" : "2012-11-21T10:12:57.708+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.3.5" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.6", "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52775f627d6b0586d11b" }, "external_id" : "ZOOKEEPER-1588", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Write Mechanism of Apache Zookeeper and Neociclo Accord", "created_at" : { "$date" : "2012-11-22T17:19:11.412+0000" }, "updated_at" : { "$date" : "2012-11-22T17:28:03.535+0000" }, "creator_id" : { "$oid" : "5b7d5277e9214a0d1608d988" }, "reporter_id" : { "$oid" : "5b7d5277e9214a0d1608d988" }, "issue_type" : "Test", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52785f627d6b0586d120" }, "external_id" : "ZOOKEEPER-1589", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Documentation list has wrong numbering", "desc" : "Check the version numbers of the documentation links on the project front page:\n\n{noformat}\n    Release 3.4.5(stable)\n    Release 3.4.5(current)\n{noformat}", "created_at" : { "$date" : "2012-11-22T21:07:31.624+0000" }, "updated_at" : { "$date" : "2012-11-28T06:41:31.080+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52785f627d6b0586d125" }, "external_id" : "ZOOKEEPER-1590", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Patch to add zk.updateServerList(newServerList) broke the build", "desc" : "Here is the related output of jenkins:\n\n{noformat}\nvalidate-xdocs:\n     [exec] /home/jenkins/jenkins-slave/workspace/ZooKeeper-trunk/trunk/src/docs/src/documentation/content/xdocs/zookeeperProgrammers.xml:578:5: The element type \"para\" must be terminated by the matching end-tag \"</para>\".\n     [exec] \n     [exec] BUILD FAILED\n     [exec] /home/jenkins/tools/forrest/latest/main/targets/validate.xml:135: Could not validate document /home/jenkins/jenkins-slave/workspace/ZooKeeper-trunk/trunk/src/docs/src/documentation/content/xdocs/zookeeperProgrammers.xml\n     [exec] \n{noformat}", "created_at" : { "$date" : "2012-11-27T20:08:26.327+0000" }, "updated_at" : { "$date" : "2012-11-28T11:07:22.192+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52795f627d6b0586d131" }, "external_id" : "ZOOKEEPER-1591", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Windows build is broken because inttypes.h doesn't exist", "desc" : "addrvec.h includes inttypes.h, but it is not present in the windows build environment.\n\nhttps://builds.apache.org/job/ZooKeeper-trunk-WinVS2008/596/console\n\nf:\\hudson\\hudson-slave\\workspace\\zookeeper-trunk-winvs2008\\trunk\\src\\c\\src\\addrvec.h(22): fatal error C1083: Cannot open include file: 'inttypes.h': No such file or directory ", "created_at" : { "$date" : "2012-11-27T23:32:12.686+0000" }, "updated_at" : { "$date" : "2012-12-01T11:03:32.241+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "issue_links" : [  ], "environment" : "Windows" },
{ "_id" : { "$oid" : "5b7d527a5f627d6b0586d13d" }, "external_id" : "ZOOKEEPER-1595", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Sockets should be read until exhausted", "desc" : "{{doIO}} method in {{NIOServerCnxn}} should read (and write too) until {{read}}/{{write}} returns 0.\nIt's a common practice when working with non-blocking sockets. When an underlying system call (multiplexer) signals, that socket is readable, one should {{recv(2)}} all data from kernel buffer until {{recv}} fails with {{EAGAIN}} or {{EWOULDBLOCK}}.\n\nPatch does two things (I know it's not a good idea to mix several changes, but I could stand it):\n* splits {{doIO}} into {{doRead}} and {{doWrite}}\n* wraps reading with {{while (true)}}\n\nIt's pretty easy to instrument the code with a counter and print how many loops we performed until the socket was not readable again.\n\nI wrote a simple python script (http://pastebin.com/N5ifM330) which creates 6000 nodes with 5k data each, having 20 concurrent create requests in progress through one connnection.\nWith this script and strace attached to JVM I counted epoll_wait syscalls during the test and I got ~9500 before vs ~8000 after.\nRun time measurement is very rough, but it's around ~19 secs. before vs 17.5 after.", "created_at" : { "$date" : "2012-12-03T07:46:38.645+0000" }, "updated_at" : { "$date" : "2012-12-11T21:16:43.246+0000" }, "creator_id" : { "$oid" : "5b7d523ee9214a0d1608d95d" }, "reporter_id" : { "$oid" : "5b7d523ee9214a0d1608d95d" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [ "newbie", "performance" ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Tested on Linux x64 with Oracle JDK6" },
{ "_id" : { "$oid" : "5b7d527a5f627d6b0586d14a" }, "external_id" : "ZOOKEEPER-721", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Minor cleanup related to the log4j version change from 1.2.15 -> 1.2.16", "desc" : "The generated Maven pom.xml file contains:\n\n{code}\n<dependency>\n  <groupId>log4j</groupId>\n  <artifactId>log4j</artifactId>\n  <version>1.2.15</version>\n  <scope>compile</scope>\n</dependency>\n{code}\n\nIt would be better to have:\n\n{code}\n<dependency>\n  <groupId>log4j</groupId>\n  <artifactId>log4j</artifactId>\n  <version>1.2.15</version>\n  <scope>compile</scope>\n  <exclusions>\n    <exclusion>\n      <groupId>javax.jms</groupId>\n      <artifactId>jms</artifactId>\n    </exclusion>\n    <exclusion>\n      <groupId>com.sun.jdmk</groupId>\n      <artifactId>jmxtools</artifactId>\n    </exclusion>\n    <exclusion>\n      <groupId>com.sun.jmx</groupId>\n      <artifactId>jmxri</artifactId>\n    </exclusion>\n    <exclusion>\n      <groupId>javax.mail</groupId>\n      <artifactId>mail</artifactId>\n    </exclusion>\n  </exclusions> \n</dependency>\n{code}\n\nThis would avoid to people depending on ZooKeeper artifacts the pain to exclude such \"broken\" dependencies by themselves.\n\nA similar issue is discussed in HADOOP-6629, although I am not clear on how to solve fix it using Ivy.", "created_at" : { "$date" : "2010-03-21T08:25:09.415+0000" }, "updated_at" : { "$date" : "2012-12-12T11:05:16.797+0000" }, "creator_id" : { "$oid" : "5b7d510be9214a0d1608d8e0" }, "reporter_id" : { "$oid" : "5b7d510be9214a0d1608d8e0" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "build" ], "labels" : [ "ivy", "maven" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d527ae9214a0d1608d989" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d527b5f627d6b0586d165" }, "external_id" : "ZOOKEEPER-1587", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Provide simple way to determine IP address of an ephemeral znode's owner", "desc" : "Occasionally I've run into operational cases where an ephemeral znode exists, and is held by some client, but it's not clear which client is the holder. By getting the znode from the shell, one can find the session ID, but as far as I'm aware the only way to reverse that to an IP is by grepping logs, etc.", "created_at" : { "$date" : "2012-11-22T00:31:08.864+0000" }, "updated_at" : { "$date" : "2012-12-13T08:09:27.835+0000" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d527b5f627d6b0586d164" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d527c5f627d6b0586d16a" }, "external_id" : "HBASE-1316", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d527b5f627d6b0586d164" }, "external_id" : "ZOOKEEPER-829", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d527c5f627d6b0586d16a" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d527b5f627d6b0586d165" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "created_at" : { "$date" : "2010-07-29T17:25:19.017+0000" }, "updated_at" : { "$date" : "2012-12-13T08:09:27.831+0000" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "priority" : "Major", "title" : "Add /zookeeper/sessions/* to allow inspection/manipulation of client sessions", "issue_type" : "New Feature", "desc" : "For some use cases in HBase (HBASE-1316 in particular) we'd like the ability to forcible expire someone else's ZK session. Patrick and I discussed on IRC and came up with an idea of creating nodes in /zookeeper/sessions/<session id> that can be read in order to get basic stats about a session, and written in order to manipulate one. The manipulation we need in HBase is the ability to write a command like \"kill\", but others might be useful as well.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d527d5f627d6b0586d183" }, "external_id" : "ZOOKEEPER-1491", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Help for create command in zkCli is misleading", "desc" : "When I type help the shell, I see the following for the create command.\n\n{noformat}\ncreate [-s] [-e] path data acl\n{noformat}\n\nHowever, the ACL is optional.  So I think the usage message should look like the following.\n\n{noformat}\ncreate [-s] [-e] path data [acl]\n{noformat}\n\n", "created_at" : { "$date" : "2012-06-19T18:59:21.352+0000" }, "updated_at" : { "$date" : "2012-12-13T22:19:51.478+0000" }, "creator_id" : { "$oid" : "5b7d527de9214a0d1608d98b" }, "reporter_id" : { "$oid" : "5b7d527de9214a0d1608d98b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d527d5f627d6b0586d188" }, "external_id" : "ZOOKEEPER-1404", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "leader election pseudo code probably incorrect", "desc" : "The pseudo code for leader election in the recipes.html page of 3.4.3 documentation is the following...\n\n{quote}\nLet ELECTION be a path of choice of the application. To volunteer to be a leader: \n\n1.Create znode z with path \"ELECTION/guid-n_\" with both SEQUENCE and EPHEMERAL flags;\n\n2.Let C be the children of \"ELECTION\", and i be the sequence number of z;\n\n3.Watch for changes on \"ELECTION/guid-n_j\", where j is the {color:red}*smallest*{color} sequence number such that j < i and n_j is a znode in C;\n\nUpon receiving a notification of znode deletion: \n\n1.Let C be the new set of children of ELECTION; \n\n2.If z is the smallest node in C, then execute leader procedure;\n\n3.Otherwise, watch for changes on \"ELECTION/guid-n_j\", where j is the {color:red}*smallest*{color} sequence number such that j < i and n_j is a znode in C; \n{quote}\n\n\nI think, in both third steps *highest* should appear instead of {color:red}*smallest*{color}.\n", "created_at" : { "$date" : "2012-03-05T12:05:16.045+0000" }, "updated_at" : { "$date" : "2012-12-14T22:11:14.647+0000" }, "creator_id" : { "$oid" : "5b7d5223e9214a0d1608d94c" }, "reporter_id" : { "$oid" : "5b7d5223e9214a0d1608d94c" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d527d5f627d6b0586d187" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d527d5f627d6b0586d187" }, "external_id" : "ZOOKEEPER-1483", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3" ], "components" : [ "documentation" ], "fix_versions" : [ "3.5.0", "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d527d5f627d6b0586d188" }, "effect" : "duplicates", "type" : "Duplicate" } ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "created_at" : { "$date" : "2012-06-11T21:09:01.588+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d527ee9214a0d1608d98c" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d527ee9214a0d1608d98c" }, "updated_at" : { "$date" : "2012-12-14T22:11:14.654+0000" }, "title" : "Fix leader election recipe documentation", "issue_type" : "Bug", "desc" : "The leader election recipe documentation suggest that to avoid the herd effect a client process volunteering for leadership via child znode [i] under the leader election path [/leader] must only watch the the SMALLEST znode [j] from a different client process such that [j < i]. \n\nThis will NOT avoid the herd effect as many clients will end up watching the same znode[j] where j is the next-in-sequence number greater than the number of the current leader.\n\nSpecifically in Step 3 of the Election procedure here http://zookeeper.apache.org/doc/trunk/recipes.html#sc_leaderElection\n\nThis \"where j is the SMALLEST sequence number\" should be changed to this\n\"where j is the LARGEST sequence number\"\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d527e5f627d6b0586d1a0" }, "external_id" : "ZOOKEEPER-1120", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "recipes haven't been built in distribution package", "desc" : "I have download zookeeper-3.3.3.tar.gz,and have not found zookeeper-recipes.jar in dist-maven,so I try to build it myself\n\nD:\\packages\\zookeeper-3.3.3\\recipes\\lock>ant\nBuildfile: D:\\packages\\zookeeper-3.3.3\\recipes\\lock\\build.xml\n\nBUILD FAILED\nD:\\packages\\zookeeper-3.3.3\\recipes\\lock\\build.xml:19: Cannot find D:\\packages\\zookeeper-3.3.3\\recipes\\build-recipes.xml imported from D:\\packages\\zookeeper-3.3.3\\recipes\\lock\\build.xml\n\nTotal time: 0 seconds\n\n\n\nrecipes/build-recipes.xml doesn't include in zookeeper-3.3.3.tar.gz", "created_at" : { "$date" : "2011-07-08T00:49:41.285+0000" }, "updated_at" : { "$date" : "2012-12-15T02:09:23.798+0000" }, "creator_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "reporter_id" : { "$oid" : "5b7d504ce9214a0d1608d89c" }, "issue_type" : "Task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "build", "recipes" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d527f5f627d6b0586d1b2" }, "external_id" : "ZOOKEEPER-1602", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "a change to QuorumPeerConfig's API broke compatibility with HBase", "desc" : "The following patch broke an API that's in use by HBase. Otherwise current trunk compiles fine when used by hbase:\n\nbq. ZOOKEEPER-1411. Consolidate membership management, distinguish between static and dynamic configuration parameters (Alex Shraer via breed)\n\nConsidering it a blocker even though it's not really a \"public\" API. If possible we should add back \"getServers\" method on QuorumPeerConfig to reduce friction for the hbase team.\n", "created_at" : { "$date" : "2012-12-15T00:40:58.482+0000" }, "updated_at" : { "$date" : "2012-12-16T11:04:20.312+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52805f627d6b0586d1be" }, "external_id" : "ZOOKEEPER-1335", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add support for --config to zkEnv.sh to specify a config directory different than what is expected", "desc" : "zkEnv.sh expects ZOOCFGDIR env variable set. If not it looks for the conf dir in the ZOOKEEPER_PREFIX dir or in /etc/zookeeper. It would be great if we can support --config option where at run time you could specify a different config directory. We do the same thing in hadoop.\n\nWith this you should be able to do\n\n/usr/sbin/zkServer.sh --config /some/conf/dir start|stop", "created_at" : { "$date" : "2011-12-20T21:56:58.609+0000" }, "updated_at" : { "$date" : "2012-12-17T11:04:42.389+0000" }, "creator_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "reporter_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52805f627d6b0586d1d5" }, "external_id" : "ZOOKEEPER-1605", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make RMI port configurable", "desc" : "JMX uses two ports, the JMX remote port and the RMI server port. The default JMX agent allows you to configure the JMX remote port, via the com.sun.management.jmxremote.port system property, but the RMI server port is randomized at runtime. It's possible to create custom agent that can set the RMI port to a configurable value:\n\nhttp://olegz.wordpress.com/2009/03/23/jmx-connectivity-through-the-firewall/\n\nMaking the RMI port configurable is critical to being able to monitor ZK with JMX through a firewall.", "created_at" : { "$date" : "2012-12-19T12:40:12.733+0000" }, "updated_at" : { "$date" : "2012-12-19T18:58:16.231+0000" }, "creator_id" : { "$oid" : "5b7d5280e9214a0d1608d98e" }, "reporter_id" : { "$oid" : "5b7d5280e9214a0d1608d98e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "jmx" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52815f627d6b0586d1d7" }, "external_id" : "ZOOKEEPER-1505", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Multi-thread CommitProcessor", "desc" : "CommitProcessor has a single thread that both pulls requests off its queues and runs all downstream processors. This is noticeably inefficient for read-intensive workloads, which could be run concurrently. The trick is handling write transactions. I propose multi-threading this code according to the following two constraints\n\n  - each session must see its requests responded to in order\n  - all committed transactions must be handled in zxid order, across all sessions\n\nI believe these cover the only constraints we need to honor. In particular, I believe we can relax the following:\n\n  - it does not matter if the read request in one session happens before or after the write request in another session\n\nWith these constraints, I propose the following threads\n\n  - 1    primary queue servicing/work dispatching thread\n  - 0-N  assignable worker threads, where a given session is always assigned to the same worker thread\n\nBy assigning sessions always to the same worker thread (using a simple sessionId mod number of worker threads), we guarantee the first constraint-- requests we push onto the thread queue are processed in order. The way we guarantee the second constraint is we only allow a single commit transaction to be in flight at a time--the queue servicing thread blocks while a commit transaction is in flight, and when the transaction completes it clears the flag.\n\nOn a 32 core machine running Linux 2.6.38, achieved best performance with 32 worker threads for a 56% +/- 5% improvement in throughput (this improvement was measured on top of that for ZOOKEEPER-1504, not in isolation).\n\nNew classes introduced in this patch are:\n\n    WorkerService (also in ZOOKEEPER-1504): ExecutorService wrapper that makes worker threads daemon threads and names then in an easily debuggable manner. Supports assignable threads (as used here) and non-assignable threads (as used by NIOServerCnxnFactory).\n", "created_at" : { "$date" : "2012-07-05T23:30:00.465+0000" }, "updated_at" : { "$date" : "2012-12-22T20:42:42.944+0000" }, "creator_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "reporter_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.5.0", "3.4.4" ], "components" : [ "server" ], "labels" : [ "scaling", "performance" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52745f627d6b0586d0a5" }, "external_id" : "ZOOKEEPER-1561", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.5.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52755f627d6b0586d0fc" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52745f627d6b0586d0a6" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2012-10-11T07:43:57.687+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "updated_at" : { "$date" : "2012-12-24T04:18:07.240+0000" }, "title" : "Zookeeper client may hang on a server restart", "issue_type" : "Bug", "desc" : "In the doIO method of ClientCnxnSocketNIO\n{noformat}\n if (p != null) {\n                    outgoingQueue.removeFirstOccurrence(p);\n                    updateLastSend();\n                    if ((p.requestHeader != null) &&\n                            (p.requestHeader.getType() != OpCode.ping) &&\n                            (p.requestHeader.getType() != OpCode.auth)) {\n                        p.requestHeader.setXid(cnxn.getXid());\n                    }\n                    p.createBB();\n                    ByteBuffer pbb = p.bb;\n                    sock.write(pbb);\n                    if (!pbb.hasRemaining()) {\n                        sentCount++;\n                        if (p.requestHeader != null\n                                && p.requestHeader.getType() != OpCode.ping\n                                && p.requestHeader.getType() != OpCode.auth) {\n                            pending.add(p);\n                        }\n                    }\n{noformat}\nWhen the sock.write(pbb) method throws an exception, the packet will not be cleanup(not in outgoingQueue nor in pendingQueue). If the client wait for it, it will wait forever...", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52835f627d6b0586d20e" }, "external_id" : "ZOOKEEPER-1127", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Auth completion are called for every registered auth, and auths are never removed from the auth list. (even after they are processed).", "desc" : "When we get a auth response, every time we process any auth_response, we call ALL the auth completions (might be registered by different add_auth_info calls). we should be calling only the one that the request came from? I guess we dont know for which request the response corresponds to? If the requests are processed in FIFO and response are got in order then may be we can figure out which add_auth info request the response corresponds to.\n\nAlso , we never remove entries from the auth_list\n\nAlso the logging is misleading. \n<code>\n  1206     if (rc) {\n   1207         LOG_ERROR((\"Authentication scheme %s failed. Connection closed.\",\n   1208                    zh->auth_h.auth->scheme));\n   1209     }\n   1210     else {\n   1211         LOG_INFO((\"Authentication scheme %s succeeded\", zh->auth_h.auth->scheme));\n</code>\nIf there are multiple auth_info in the auth_list , we always print success/failure for ONLY the first one. So if I had two auths for scehmes, ABCD and EFGH and my auth scheme EFGH failed, the logs will still say ABCD failed\n", "created_at" : { "$date" : "2011-07-18T18:50:48.505+0000" }, "updated_at" : { "$date" : "2012-12-26T07:10:12.035+0000" }, "creator_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "reporter_id" : { "$oid" : "5b7d5113e9214a0d1608d8e9" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52835f627d6b0586d211" }, "external_id" : "ZOOKEEPER-1611", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cbcfhbf vfgbfb", "created_at" : { "$date" : "2012-12-27T06:23:16.757+0000" }, "updated_at" : { "$date" : "2012-12-27T08:57:46.955+0000" }, "creator_id" : { "$oid" : "5b7d5283e9214a0d1608d98f" }, "reporter_id" : { "$oid" : "5b7d5283e9214a0d1608d98f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52845f627d6b0586d215" }, "external_id" : "ZOOKEEPER-1563", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Wrong solution - unable to build under Windows with Visual Studio", "desc" : "When I try to open zookeeper.sln the VS wants me to convert the project. While the convertion is taking place I'm getting a message:\n\n\"A file with the name: \"[path]\\zookeeper.vcxproj\" already exists on disk.\nDo you want to overwrite the project and its imported property sheets\"\n\nAnd after it I get next message with same text but it is about Cli.vxproj\n\nNo matter If I click yes or no the coverting process fails, both projects (Cli and zookeeper) are marked as unavailable.\n\nIf I close VS and open the zookeeper.sln once again it wants me to convert but now if I answer yes the projects are again unavailable but if I answer no the projects are available but are empty.", "created_at" : { "$date" : "2012-10-13T14:55:44.513+0000" }, "updated_at" : { "$date" : "2012-12-28T12:35:51.741+0000" }, "creator_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "reporter_id" : { "$oid" : "5b7d523be9214a0d1608d959" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.4" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows 7 x64\nVisual Studio C++ 2010 Express" },
{ "_id" : { "$oid" : "5b7d50ef5f627d6b0586a728" }, "external_id" : "ZOOKEEPER-762", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a72a" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d52855f627d6b0586d21b" }, "effect" : "is related to", "type" : "Reference" } ], "parent_issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "created_at" : { "$date" : "2010-05-03T20:54:46.367+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d50f7e9214a0d1608d8ce" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d50f7e9214a0d1608d8ce" }, "updated_at" : { "$date" : "2012-12-29T23:47:28.653+0000" }, "title" : "Allow dynamic addition/removal of server nodes in the client API", "issue_type" : "Sub-task", "desc" : "Currently the list of zookeeper servers needs to be provided to the client APIs at construction time, and cannot be changed without a complete shutdown/restart of the client API. However, there are scenarios that require the server list to be updated, such as removal or addition of a ZK cluster node, and it would be nice if the list could be updated via a simple API call.\n\nThe general approach (in the Java client) would be to \"RemoveServer()/AddServer()\" functions for Zookeeper that calls down to ClientCnxn, where they are just maintained in a list. Of course if\nthe server being removed is the one currently connected, we'd need to disconnect, but a simple call to disconnect() seems like it would resolve that and trigger the automatic re-connection logic.\nAn equivalent change could be made in the C code. \n\nThis change would also make dynamic cluster membership in ZOOKEEPER-107 easier to implement.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52865f627d6b0586d227" }, "external_id" : "ZOOKEEPER-1614", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zoo_multi c MT client windows crash", "desc" : "The windows C MultiThreaded client crashes when usng the zoo_multi APis.  The underlying is that the mutex and condition variables need to be initialized with pthread_cond_init and pthread_mutex_init.\n\nAttached are the files I've modified to make this work.  In the modified files I've added a \"multi\" command to cli that when Cli.exe (mt build) is run on window's without the rest of the fixes will crash.", "created_at" : { "$date" : "2013-01-02T23:36:55.459+0000" }, "updated_at" : { "$date" : "2013-01-02T23:42:30.230+0000" }, "creator_id" : { "$oid" : "5b7d5286e9214a0d1608d990" }, "reporter_id" : { "$oid" : "5b7d5286e9214a0d1608d990" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Windows C MT client" },
{ "_id" : { "$oid" : "5b7d52875f627d6b0586d22d" }, "external_id" : "ZOOKEEPER-1498", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zab1.0 sends NEWLEADER packet twice", "desc" : "In pre-Zab1.0, we would process the NEWLEADER packet in registerWithLeader. Now we only process it in syncWithLeader, and in certain circumstances (the first follower of a new leader) it seems like we get 2 of them, which causes 2 snapshots to be taken one right after another. Not sure whether we should ignore taking the snapshot the second time, or not send two packets, or what. ", "created_at" : { "$date" : "2012-07-03T21:25:43.686+0000" }, "updated_at" : { "$date" : "2013-01-04T02:29:39.965+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.3", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52875f627d6b0586d232" }, "external_id" : "ZOOKEEPER-1612", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper unable to recover and start once datadir disk is full and disk space cleared", "desc" : "Once zookeeper data dir disk becomes full, the process gets shut down.\n{noformat}\n2012-12-14 13:22:26,959 [myid:2] - ERROR [QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:2181:ZooKeeperServer@276] - Severe unrecoverable error, exiting\njava.io.IOException: No space left on device\n\tat java.io.FileOutputStream.writeBytes(Native Method)\n\tat java.io.FileOutputStream.write(FileOutputStream.java:282)\n\tat java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n\tat java.io.BufferedOutputStream.write(BufferedOutputStream.java:109)\n\tat java.util.zip.CheckedOutputStream.write(CheckedOutputStream.java:56)\n\tat java.io.DataOutputStream.write(DataOutputStream.java:90)\n\tat java.io.FilterOutputStream.write(FilterOutputStream.java:80)\n\tat org.apache.jute.BinaryOutputArchive.writeBuffer(BinaryOutputArchive.java:119)\n\tat org.apache.zookeeper.server.DataNode.serialize(DataNode.java:168)\n\tat org.apache.jute.BinaryOutputArchive.writeRecord(BinaryOutputArchive.java:123)\n\tat org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:1115)\n\tat org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:1130)\n\tat org.apache.zookeeper.server.DataTree.serializeNode(DataTree.java:1130)\n\tat org.apache.zookeeper.server.DataTree.serialize(DataTree.java:1179)\n\tat org.apache.zookeeper.server.util.SerializeUtils.serializeSnapshot(SerializeUtils.java:138)\n\tat org.apache.zookeeper.server.persistence.FileSnap.serialize(FileSnap.java:213)\n\tat org.apache.zookeeper.server.persistence.FileSnap.serialize(FileSnap.java:230)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.save(FileTxnSnapLog.java:242)\n\tat org.apache.zookeeper.server.ZooKeeperServer.takeSnapshot(ZooKeeperServer.java:274)\n\tat org.apache.zookeeper.server.quorum.Learner.syncWithLeader(Learner.java:407)\n\tat org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:82)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:759)\n{noformat}\n\nLater disk space is cleared and zk started again. Startup of zk fails as it is not able to read snapshot properly. (Since load from disk failed it is not able to join peers in the quorum and get a snapshot diff)\n{noformat}\n\n2012-12-14 16:20:31,489 [myid:2] - INFO  [main:FileSnap@83] - Reading snapshot ../dataDir/version-2/snapshot.1000000042\n2012-12-14 16:20:31,564 [myid:2] - ERROR [main:QuorumPeer@472] - Unable to load database on disk\njava.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:375)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.persistence.FileHeader.deserialize(FileHeader.java:64)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:558)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:577)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:543)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:625)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:529)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:504)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:341)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:132)\n\tat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:223)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.loadDataBase(QuorumPeer.java:436)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:428)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:152)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:111)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)\n2012-12-14 16:20:31,566 [myid:2] - ERROR [main:QuorumPeerMain@89] - Unexpected exception, exiting abnormally\njava.lang.RuntimeException: Unable to run quorum server \n\tat org.apache.zookeeper.server.quorum.QuorumPeer.loadDataBase(QuorumPeer.java:473)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.start(QuorumPeer.java:428)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:152)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:111)\n\tat org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)\nCaused by: java.io.EOFException\n\tat java.io.DataInputStream.readInt(DataInputStream.java:375)\n\tat org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\tat org.apache.zookeeper.server.persistence.FileHeader.deserialize(FileHeader.java:64)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:558)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:577)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:543)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:625)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.init(FileTxnLog.java:529)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.<init>(FileTxnLog.java:504)\n\tat org.apache.zookeeper.server.persistence.FileTxnLog.read(FileTxnLog.java:341)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:132)\n\n {noformat}\n\n\n", "created_at" : { "$date" : "2012-12-27T06:57:06.833+0000" }, "updated_at" : { "$date" : "2013-01-16T18:37:45.865+0000" }, "creator_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "reporter_id" : { "$oid" : "5b7d5253e9214a0d1608d96a" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52885f627d6b0586d239" }, "external_id" : "ZOOKEEPER-1554", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52885f627d6b0586d23a" }, "external_id" : "ZOOKEEPER-1550", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeperSaslClient does not finish anonymous login on OpenJDK", "desc" : "On OpenJDK, {{javax.security.auth.login.Configuration.getConfiguration}} does not throw an exception.  {{ZooKeeperSaslClient.clientTunneledAuthenticationInProgress}} uses an exception from that method as a proxy for \"this client is not configured to use SASL\" and as a result no commands can be sent, since it is still waiting for auth to complete.\n\n[Link to mailing list discussion|http://comments.gmane.org/gmane.comp.java.zookeeper.user/2667]\n\nThe relevant bit of logs from OpenJDK and Oracle versions of 'connect and do getChildren(\"/\")':\n\n{code:title=OpenJDK}\nINFO [main] 2012-09-25 14:02:24,545 com.socrata.Main Waiting for connection...\nDEBUG [main] 2012-09-25 14:02:24,548 com.socrata.zookeeper.ZooKeeperProvider Waiting for connected-state...\nINFO [main-SendThread(mike.local:2181)] 2012-09-25 14:02:24,576 org.apache.zookeeper.ClientCnxn Opening socket connection to server mike.local/10.0.2.106:2181. Will not attempt to authenticate using SASL (unknown error)\nINFO [main-SendThread(mike.local:2181)] 2012-09-25 14:02:24,584 org.apache.zookeeper.ClientCnxn Socket connection established to mike.local/10.0.2.106:2181, initiating session\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:24,586 org.apache.zookeeper.ClientCnxn Session establishment request sent on mike.local/10.0.2.106:2181\nINFO [main-SendThread(mike.local:2181)] 2012-09-25 14:02:24,600 org.apache.zookeeper.ClientCnxn Session establishment complete on server mike.local/10.0.2.106:2181, sessionid = 0x139ff2e85b60005, negotiated timeout = 40000\nDEBUG [main-EventThread] 2012-09-25 14:02:24,614 com.socrata.zookeeper.ZooKeeperProvider ConnectionStateChanged(Connected)\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:24,636 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:37,923 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:37,924 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:37,924 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,260 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,260 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,261 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,261 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,261 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,265 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:/ serverPath:/ finished:false header:: 0,12  replyHeader:: 0,0,0 request:: '/,F  response:: v{} until SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,265 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nDEBUG [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,266 org.apache.zookeeper.ClientCnxnSocketNIO deferring non-priming packet: clientPath:null serverPath:null finished:false header:: -2,11  replyHeader:: null request:: null response:: nulluntil SASL authentication completes.\nINFO [main-SendThread(mike.local:2181)] 2012-09-25 14:02:51,266 org.apache.zookeeper.ClientCnxn Client session timed out, have not heard from server in 26668ms for sessionid 0x139ff2e85b60005, closing socket connection and attempting reconnect\nDEBUG [main-EventThread] 2012-09-25 14:02:51,377 com.socrata.zookeeper.ZooKeeperProvider ConnectionStateChanged(Disconnected)\n{code}\n\n{code:title=Oracle}\nINFO [main] 2012-09-25 14:03:16,315 com.socrata.Main Waiting for connection...\nDEBUG [main] 2012-09-25 14:03:16,319 com.socrata.zookeeper.ZooKeeperProvider Waiting for connected-state...\nINFO [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,335 org.apache.zookeeper.ClientCnxn Opening socket connection to server 10.0.2.106/10.0.2.106:2181. Will not attempt to authenticate using SASL (Unable to locate a login configuration)\nINFO [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,344 org.apache.zookeeper.ClientCnxn Socket connection established to 10.0.2.106/10.0.2.106:2181, initiating session\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,346 org.apache.zookeeper.ClientCnxn Session establishment request sent on 10.0.2.106/10.0.2.106:2181\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,347 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,351 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nINFO [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,368 org.apache.zookeeper.ClientCnxn Session establishment complete on server 10.0.2.106/10.0.2.106:2181, sessionid = 0x139ff2e85b60006, negotiated timeout = 40000\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,371 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,371 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-EventThread] 2012-09-25 14:03:16,385 com.socrata.zookeeper.ZooKeeperProvider ConnectionStateChanged(Connected)\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,417 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,417 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,417 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,418 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,418 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,431 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,438 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,443 org.apache.zookeeper.ClientCnxn Reading reply sessionid:0x139ff2e85b60006, packet:: clientPath:/ serverPath:/ finished:false header:: 1,12  replyHeader:: 1,8292982,0  request:: '/,F  response:: v{'ro,'row-index,'zkbtest,'consumers,'reindex,'hotstandby,'bigdir,'vs,'orestes,'eurybates,'shardedcly,'row-locks,'id-counter,'zookeeper,'cly,'locks,'rwlocks,'tickets,'brokers},s{0,0,0,0,0,61,0,0,0,19,8292893}\nDEBUG [main-SendThread(10.0.2.106:2181)] 2012-09-25 14:03:16,444 org.apache.zookeeper.client.ZooKeeperSaslClient Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\nOK(Set(cly, row-locks, hotstandby, locks, tickets, bigdir, zkbtest, row-index, reindex, id-counter, eurybates, vs, rwlocks, shardedcly, brokers, consumers, zookeeper, orestes, ro),0,0,0,0,0,61,0,0,0,19,8292893)\n{code}", "created_at" : { "$date" : "2012-09-26T16:32:37.233+0000" }, "updated_at" : { "$date" : "2013-01-16T19:00:21.852+0000" }, "creator_id" : { "$oid" : "5b7d5288e9214a0d1608d991" }, "reporter_id" : { "$oid" : "5b7d5288e9214a0d1608d991" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.4.4" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.5" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d236" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d239" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d238" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d237" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52895f627d6b0586d257" }, "external_id" : "ZOOKEEPER-1617", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper version error log info ?", "desc" : "    2012-12-31 10:51:41,562-[TS] INFO main-EventThread org.I0Itec.zkclient.ZkClient - zookeeper state changed (Disconnected)  \n    2012-12-31 10:51:43,008-[TS] INFO main-SendThread(17.22.17.1:2181) org.apache.zookeeper.ClientCnxn - Opening socket connection to server /17.22.17.1:2181. Will not attempt to authenticate using SASL (unknown error)  \n    2012-12-31 10:51:43,009-[TS] INFO main-SendThread(17.22.17.1:2181) org.apache.zookeeper.ClientCnxn - Socket connection established to /17.22.17.1:2181, initiating session  \n    2012-12-31 10:51:43,011-[TS] WARN main-SendThread(17.22.17.1:2181) org.apache.zookeeper.ClientCnxnSocket - Connected to an old server; r-o mode will be unavailable  \n    2012-12-31 10:51:43,011-[TS] INFO main-SendThread(17.22.17.1:2181) org.apache.zookeeper.ClientCnxn - Session establishment complete on server /17.22.17.1:2181, sessionid = 0x13b8a23254100be, negotiated timeout = 6000  \n    2012-12-31 10:51:43,012-[TS] INFO main-EventThread org.I0Itec.zkclient.ZkClient - zookeeper state changed (SyncConnected)  \n    2012-12-31 10:51:47,012-[TS] INFO main-SendThread(17.22.17.1:2181) org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 4002ms for sessionid 0x13b8a23254100be, closing socket connection and attempting reconnect  \n\n\nzookeeper client is 3.4.4\nzookeeper server is 3.3.4\n\nuser 3.4.4 client connection 3.3.4 server", "created_at" : { "$date" : "2013-01-09T10:46:51.496+0000" }, "updated_at" : { "$date" : "2013-01-22T22:40:08.600+0000" }, "creator_id" : { "$oid" : "5b7d5289e9214a0d1608d992" }, "reporter_id" : { "$oid" : "5b7d5289e9214a0d1608d992" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52895f627d6b0586d25b" }, "external_id" : "ZOOKEEPER-1625", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zkServer.sh is looking for clientPort in config file, but it may no longer be there with ZK-1411", "desc" : "zkServer.sh is currently looking for \"clientPort\" entry in the static configuration file and uses it to contact the server. \n\nWith ZOOKEEPER-1411 clientPort is part of the dynamic configuration, and may appear in the separate dynamic configuration file. The \"clientPort\" entry may no longer be in the static config file. \n\nWith the proposed patch zkServer.sh first looks in the old (static) config file, then if clientPort is not there, it figures out the id of the server by looking at myid file, and then using that id finds the client port in the dynamic config file. ", "created_at" : { "$date" : "2013-01-19T21:33:56.625+0000" }, "updated_at" : { "$date" : "2013-01-23T19:24:32.376+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "blocks", "type" : "Blocker" }, { "issue_id" : { "$oid" : "5b7d52895f627d6b0586d25a" }, "effect" : "is broken by", "type" : "Regression" } ] },
{ "_id" : { "$oid" : "5b7d528a5f627d6b0586d26b" }, "external_id" : "ZOOKEEPER-1608", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add support for key-value store as optional storage engine", "desc" : "Problem:\n1. ZooKeeper need to load the entire dataset into its memory. So the total data size and number of znode are limited by the amount of available memory.\n2. We want to minimize ZooKeeper down time, but found that it is bound by snapshot loading and writing time. The bigger the database, the longer it take for the system to recover. The worst case is that if the data size grow too large and initLimit wasn't update accordingly, the quorum won't form after failure.  \n\nImplementation: (still work in progress)\n\n1. Create a new type of DataTree that supported key-value storage as backing store. Our current candidate backing store is Oracle's Berkeley DB Java Edition\n\n2. There is no need to use snapshot facility for this type of DataTree. Since doing a sync write of lastProcessedZxid into the backing store is the same as taking a snapshot. However, the system still use txnlog as before. The system can be considered as having only a single snapshot. It has to rely on backing store to detect data corruption and recovery.  \n\n3. There is no need to do any per-node locking. CommitProcessor (ZOOKEEPER-1505) prevents concurrent read and write to reach the DataTree. The DataTree is also accessed by PrepRequestProcessor (to create ChangeRecord), but I believe that read and write to the same znode cannot happens concurrently.\n\n4. There are 3 types of data which is required to be persisted in backing store: ACLs, znodes and sessions. However, we also store other data reduce oDataTree initialization time or serialization cost such as list of node's children and list of ephemeral node. \n\n5. Each Zookeeper's txn may translate into multiple actions on the DataTree. For example, creating a node may result in  AddingZNODE, AddingChildren and AddingEphemeralNode. However, as a long as these operations are idempotent, there is no need to group them into a transaction. So txns can be replayed on DataTree without corrupting the data. This also means that the system don't need key-value store that support transaction semantic. Currently, only operations related to quota break this assumption because it use increment operation.    \n\n6. SNAP protocol is supported so the ensemble can be upgraded online. In the future we may add extend SNAP protocol to send raw data file in order to save CPU cost when sending large database.", "created_at" : { "$date" : "2012-12-22T05:29:09.308+0000" }, "updated_at" : { "$date" : "2013-01-24T19:22:17.247+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528b5f627d6b0586d26e" }, "external_id" : "ZOOKEEPER-1619", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow spaces in URL", "desc" : "Currently, spaces are not allowed in the url.  This format will work.\n\n{code}\n10.10.1.1:2181,10.10.1.2:2181/usergrid\n{code}\n\nThis format will not (notice the spaces around the comma)\n\n{code}\n10.10.1.1:2181 , 10.10.1.2:2181/usergrid\n{code}\n\nPlease add a trim to both the port and the hostname parsing.", "created_at" : { "$date" : "2013-01-11T15:57:16.534+0000" }, "updated_at" : { "$date" : "2013-01-25T06:55:01.028+0000" }, "creator_id" : { "$oid" : "5b7d528be9214a0d1608d994" }, "reporter_id" : { "$oid" : "5b7d528be9214a0d1608d994" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d510ae9214a0d1608d8dc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528b5f627d6b0586d280" }, "external_id" : "ZOOKEEPER-1628", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Documented list of allowable characters in ZK doc not in line with code", "desc" : "The documented set of allowable characters in ZooKeeper node names in the Programmer's Guide is not entirely in line with the code.\n\nThe range of non-printable ASCII characters in the doc ends too early (i.e. 0x19 instead of 0x1F).\n\nThe range checking code in PathUtils also includes off-by-one errors, so that characters that are on the border of being unallowable are actually allowed by the code.", "created_at" : { "$date" : "2013-01-24T14:19:42.049+0000" }, "updated_at" : { "$date" : "2013-01-25T07:09:06.433+0000" }, "creator_id" : { "$oid" : "5b7d528be9214a0d1608d995" }, "reporter_id" : { "$oid" : "5b7d528be9214a0d1608d995" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client", "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d528be9214a0d1608d995" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528c5f627d6b0586d28b" }, "external_id" : "ZOOKEEPER-1601", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "document changes for multi-threaded CommitProcessor and NIOServerCnxn", "desc" : "ZOOKEEPER-1504 and ZOOKEEPER-1505 introduce changes that should be documented - such as new configuration parameters/defaults, etc... We should also verify that nothing else needs to be changed in the documentation related to these changes.", "created_at" : { "$date" : "2012-12-12T07:08:28.074+0000" }, "updated_at" : { "$date" : "2013-01-25T20:24:49.691+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528d5f627d6b0586d29b" }, "external_id" : "ZOOKEEPER-1630", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "collect the zk connects/disconnects every  cycle and report it to controller. ", "desc" : "Helix agent must collect the zk connects/disconnects and use the health check framework to convey the information. COntroller must disable the nodes are connecting/disconnecting frequently", "created_at" : { "$date" : "2013-01-26T00:25:06.804+0000" }, "updated_at" : { "$date" : "2013-01-26T00:28:40.339+0000" }, "creator_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "reporter_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528d5f627d6b0586d29f" }, "external_id" : "ZOOKEEPER-1631", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "cppunit test TestOperations.cc fails", "desc" : "I tried running \"make run-check\" on the cppunit tests, and got the following error:\n\n{code}\ntests/TestOperations.cc:270: Assertion: equality assertion failed [Expected: 1, Actual : 0]\ntests/TestOperations.cc:339: Assertion: assertion failed [Expression: timeMock==zh->last_recv]\ntests/TestOperations.cc:407: Assertion: equality assertion failed [Expected: 1, Actual : 0]\ntests/TestOperations.cc:212: Assertion: equality assertion failed [Expected: -7, Actual : 0]\n{code}\n\nI thought this might be an environment issue, but I was able to reproduce it on both Ubuntu 12.04 and OpenSUSE 12.1", "created_at" : { "$date" : "2013-01-29T19:19:19.812+0000" }, "updated_at" : { "$date" : "2013-01-29T19:19:19.812+0000" }, "creator_id" : { "$oid" : "5b7d528de9214a0d1608d996" }, "reporter_id" : { "$oid" : "5b7d528de9214a0d1608d996" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.6" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528e5f627d6b0586d2a0" }, "external_id" : "ZOOKEEPER-1637", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Intermittent Segfault with zkpython in pyzoo_exists  ", "desc" : "We are getting an intermittent segfault.  This is OSX, zookeeper compiled using brew.  I've tried 3.4.3 - 3.4.5.\n\nI used GDB to get the following backtrace:\n\n{code}\nProgram received signal EXC_BAD_ACCESS, Could not access memory. \nReason: 13 at address: 0x0000000000000000 \n[Switching to process 10366 thread 0x1d03] \n0x00007fff8e0984f0 in strlen () \n(gdb) backtrace \n#0 0x00007fff8e0984f0 in strlen () \n#1 0x00000001004983cc in prepend_string () \n#2 0x0000000100498451 in Request_path_init () \n#3 0x0000000100499e94 in zoo_awexists () \n#4 0x000000010049a036 in zoo_wexists () \n#5 0x000000010048170b in pyzoo_exists () \n#6 0x000000010008c5d8 in PyEval_EvalFrameEx () \n#7 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#8 0x000000010008ee6c in PyEval_EvalCode () \n#9 0x000000010008be0a in PyEval_EvalFrameEx () \n#10 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#11 0x000000010008ee6c in PyEval_EvalCode () \n#12 0x000000010008be0a in PyEval_EvalFrameEx () \n#13 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#14 0x000000010002cabf in PyClassMethod_New () \n#15 0x000000010000bd32 in PyObject_Call () \n#16 0x000000010008c5ec in PyEval_EvalFrameEx () \n#17 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#18 0x000000010002cabf in PyClassMethod_New () \n#19 0x000000010000bd32 in PyObject_Call () \n#20 0x000000010001a6e9 in PyInstance_New () \n#21 0x000000010000bd32 in PyObject_Call () \n#22 0x0000000100055c5d in _PyObject_SlotCompare () \n#23 0x000000010000bd32 in PyObject_Call () \n#24 0x000000010008bf63 in PyEval_EvalFrameEx () \n#25 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#26 0x000000010008ee6c in PyEval_EvalCode () \n#27 0x000000010008be0a in PyEval_EvalFrameEx () \n#28 0x000000010008edf7 in PyEval_EvalCode () \n#29 0x000000010008be0a in PyEval_EvalFrameEx () \n#30 0x000000010008ecd8 in PyEval_EvalCodeEx () \n#31 0x000000010002cabf in PyClassMethod_New () \n#32 0x000000010000bd32 in PyObject_Call () \n#33 0x000000010001a6e9 in PyInstance_New () \n#34 0x000000010000bd32 in PyObject_Call () \n#35 0x0000000100087c40 in PyEval_CallObjectWithKeywords () \n#36 0x00000001000b940d in initthread () \n#37 0x00007fff8e0448bf in _pthread_start () \n#38 0x00007fff8e047b75 in thread_start () \n{code}\n\n", "created_at" : { "$date" : "2013-02-01T20:29:21.827+0000" }, "updated_at" : { "$date" : "2013-02-03T07:32:11.521+0000" }, "creator_id" : { "$oid" : "5b7d528ee9214a0d1608d997" }, "reporter_id" : { "$oid" : "5b7d528ee9214a0d1608d997" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.3", "3.4.5", "3.4.4" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528e5f627d6b0586d2a2" }, "external_id" : "ZOOKEEPER-706", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d528e5f627d6b0586d2a3" }, "external_id" : "ZOOKEEPER-1644", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add support for compressed SetWatches packet", "desc" : "On reconnect with a server to restore its session, a client have to send all watched paths via SetWatches packet to the server. This can be potentially large and exceeded server-side buffer (jute.maxbuffer) causing the session to fail. We have 2 concerns.\n\n1. We can increase jute.maxbuffer to arbitrarily size as a simple workaround, but, in our use case, the number of watch is going to keep growing\n\n2. If a large number of clients get disconnected at once, the server may receive a large amount data over network because of the flood of SetWatches packet. \n\nIn our case, the watch paths should by highly compressible. So our current plan is to add a new type of request which is a compressed set watch request. It should be possible to support multiple compression schemes. We are probably going to use snappy compression but may add support for gzip as a default to minimize external dependency requirement.  \n\nFeel free to comment if you have any suggestion.", "created_at" : { "$date" : "2013-02-11T22:13:04.038+0000" }, "updated_at" : { "$date" : "2013-02-16T00:42:36.661+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "server", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d528e5f627d6b0586d2a2" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d528f5f627d6b0586d2a7" }, "external_id" : "ZOOKEEPER-1600", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral node not getting deleted", "desc" : "Closing of session is not deleting all the ephemeral nodes. \n\n(Eg: From the log, session Id:0x23b6ad21d160000 creates two ephemerals(/CONFIGNODE/NP2147483647 and /ACTIVE/192.168.11.94) but when the session expires, only /CONFIGNODE/NP2147483647 is getting deleted)", "created_at" : { "$date" : "2012-12-10T06:43:48.508+0000" }, "updated_at" : { "$date" : "2013-02-16T01:21:43.568+0000" }, "creator_id" : { "$oid" : "5b7d528fe9214a0d1608d998" }, "reporter_id" : { "$oid" : "5b7d528fe9214a0d1608d998" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52905f627d6b0586d2ae" }, "external_id" : "ZOOKEEPER-1641", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Using slope=positive results in a jagged ganglia graph of packets rcvd/sent", "desc" : "The ganglia python module uses 'slope=positive' when submitting zk_packets_received and zk_packets_sent.  This results in a graph that is jagged (alternating valid results with zeros) at the highest resolution and under-represents the actual value at all averaged resolutions (>1hr).\n\nThe module should be changed to calculate the delta in requests and report requests per second instead.", "created_at" : { "$date" : "2013-02-06T18:17:35.593+0000" }, "updated_at" : { "$date" : "2013-02-16T11:02:39.481+0000" }, "creator_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "reporter_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52915f627d6b0586d2ba" }, "external_id" : "ZOOKEEPER-1383", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create update throughput quotas and add hard quota limits", "desc" : "Quotas exist for size (node count and size in bytes); it would be useful to track and support quotas on update throughput (bytes per second) as well. This can be tracked on both a node/subtree level for quota support as well as on the server level for monitoring.\n\nIn addition, the existing quotas log a warning when they are exceeded but allow the transaction to proceed (soft quotas). It would also be useful to support a corresponding set of hard quota limits that fail the transaction.\n", "created_at" : { "$date" : "2012-02-01T00:09:13.462+0000" }, "updated_at" : { "$date" : "2013-02-20T02:05:21.204+0000" }, "creator_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "reporter_id" : { "$oid" : "5b7d522be9214a0d1608d951" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52915f627d6b0586d2d6" }, "external_id" : "ZOOKEEPER-806", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cluster management with Zookeeper - Norbert", "desc" : "Hello, we have built a cluster management layer on top of Zookeeper here at the SNA team at LinkedIn: \n\nhttp://sna-projects.com/norbert/\n\nWe were wondering ways for collaboration as this is a very useful application of zookeeper.", "created_at" : { "$date" : "2010-07-07T14:44:59.666+0000" }, "updated_at" : { "$date" : "2013-02-22T05:48:00.826+0000" }, "creator_id" : { "$oid" : "5b7d5291e9214a0d1608d99a" }, "reporter_id" : { "$oid" : "5b7d5291e9214a0d1608d99a" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Later", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52925f627d6b0586d2dd" }, "external_id" : "ZOOKEEPER-1640", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "dynamically load command objects in zk", "desc" : "In class org.apache.zookeeper.ZooKeeperMain.java,\nnew CloseCommand().addToMap(commandMapCli);\nnew CreateCommand().addToMap(commandMapCli);\nnew DeleteCommand().addToMap(commandMapCli);\nnew DeleteAllCommand().addToMap(commandMapCli);\n// Depricated: rmr\nnew DeleteAllCommand(\"rmr\").addToMap(commandMapCli);\nnew SetCommand().addToMap(commandMapCli);\nnew GetCommand().addToMap(commandMapCli);\nnew LsCommand().addToMap(commandMapCli);\nnew Ls2Command().addToMap(commandMapCli);\nnew GetAclCommand().addToMap(commandMapCli);\nnew SetAclCommand().addToMap(commandMapCli);\nnew StatCommand().addToMap(commandMapCli);\nnew SyncCommand().addToMap(commandMapCli);\nnew SetQuotaCommand().addToMap(commandMapCli);\nnew ListQuotaCommand().addToMap(commandMapCli);\nnew DelQuotaCommand().addToMap(commandMapCli);\nnew AddAuthCommand().addToMap(commandMapCli);\n\nThe above code is not flexible for command object scalability. It's better to refine the code to load and create the command objects dynamically.", "created_at" : { "$date" : "2013-02-05T09:21:41.598+0000" }, "updated_at" : { "$date" : "2013-02-26T08:49:13.923+0000" }, "creator_id" : { "$oid" : "5b7d5292e9214a0d1608d99b" }, "reporter_id" : { "$oid" : "5b7d5292e9214a0d1608d99b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [ "patch" ], "resolution" : "Not A Problem", "fix_versions" : [ "3.4.5" ], "assignee_id" : { "$oid" : "5b7d5292e9214a0d1608d99b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52935f627d6b0586d2f7" }, "external_id" : "ZOOKEEPER-1618", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Disconnected event when stopping leader process", "desc" : "Running a three node ZK cluster I stop/kill the leader node.\nImmediately all connected clients will receive a Disconnected event, a second or so later an event with SyncConnected is received.\nKilling a follower will not produce the same issue/event.\n\nThe application/clients have been implemented to manage Disconnected events so they survive.\nI however expected the ZK client to manage the hickup during the election process. \nThis produces quite a lot of logging in large clusters that have many services relying on ZK.\nIn some cases we may loose a few requests as we need a working ZK cluster to execute those requests.\n\nIMHO it's not really full high availability if the ZK cluster momentarily takes a dive due to that the leader goes away.\nNo matter how much redundancy one uses in form of ZK instances one still may get processing errors during leader election.\n\nI've verified this behavior in both 3.4.4 and 3.4.5", "created_at" : { "$date" : "2013-01-09T11:15:49.682+0000" }, "updated_at" : { "$date" : "2013-02-26T10:35:37.775+0000" }, "creator_id" : { "$oid" : "5b7d5293e9214a0d1608d99c" }, "reporter_id" : { "$oid" : "5b7d5293e9214a0d1608d99c" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.5", "3.4.4" ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux SLES\njava version \"1.6.0_31\"" },
{ "_id" : { "$oid" : "5b7d52935f627d6b0586d302" }, "external_id" : "ZOOKEEPER-1658", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Support SRV records", "desc" : "We want to make client configuration easy so the quorum is just a single A rrset with multiple IP addresses. This isn't ideal because we need to hard-code the IPs off our zookeeper servers and they already have domain names. If zookeeper supported SRV, we could just do:\n\n  _zookeeper.example.com. 86400 IN SRV 10 60 2181 worker1\n  _zookeeper.example.com. 86400 IN SRV 10 20 2181 worker2\n  _zookeeper.example.com. 86400 IN SRV 10 10 2181 worker3\n\nand -Dhbase.zookeeper.quorum=example.com", "created_at" : { "$date" : "2013-03-03T12:12:45.945+0000" }, "updated_at" : { "$date" : "2013-03-03T12:12:45.945+0000" }, "creator_id" : { "$oid" : "5b7d5293e9214a0d1608d99d" }, "reporter_id" : { "$oid" : "5b7d5293e9214a0d1608d99d" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "dns", "zookeeper" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52945f627d6b0586d303" }, "external_id" : "ZOOKEEPER-1113", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "QuorumMaj counts the number of ACKs but does not check who sent the ACK", "desc" : "If a server connects to the leader as follower, it will be allowed to vote (with QuorumMaj) even if it is not a follower in the current configuration,\nas the leader does not care who sends the ACK - it only counts the number of ACKs.\n", "created_at" : { "$date" : "2011-06-30T23:00:54.392+0000" }, "updated_at" : { "$date" : "2013-03-07T06:46:11.034+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "is contained by", "type" : "Container" } ], "parent_issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" } },
{ "_id" : { "$oid" : "5b7d52955f627d6b0586d321" }, "external_id" : "ZOOKEEPER-1652", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52955f627d6b0586d322" }, "external_id" : "ZOOKEEPER-1476", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52955f627d6b0586d323" }, "external_id" : "ZOOKEEPER-1661", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Random (?) 5s delay when establishing connection", "desc" : "I have a client connecting to ZooKeeper and I am sometimes seeing a 5s delay before the opening of the socket connection:\n\nHere is the output on the client side:\n{noformat}\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:zookeeper.version=3.4.5-1392090, built on 09/30/2012 17:52 GMT\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:host.name=xeon\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.version=1.6.0_41\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.vendor=Apple Inc.\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.home=/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home\n2013/03/07 10:53:48.729 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.class.path=/local/java/lib/tools.jar:lib/ant-1.8.4.jar:lib/ant-antlr-1.8.4.jar:lib/ant-junit-1.8.4.jar:lib/ant-launcher-1.8.4.jar:lib/antlr-2.7.7.jar:lib/asm-4.0.jar:lib/asm-analysis-4.0.jar:lib/asm-commons-4.0.jar:lib/asm-tree-4.0.jar:lib/asm-util-4.0.jar:lib/commons-cli-1.2.jar:lib/groovy-2.0.7.jar:lib/groovy-ant-2.0.7.jar:lib/groovy-groovydoc-2.0.7.jar:lib/groovy-templates-2.0.7.jar:lib/groovy-xml-2.0.7.jar:lib/jackson-annotations-2.1.4.jar:lib/jackson-core-2.1.4.jar:lib/jackson-databind-2.1.4.jar:lib/jline-0.9.94.jar:lib/json-20090211.jar:lib/jul-to-slf4j-1.6.2.jar:lib/junit-3.8.1.jar:lib/log4j-1.2.16.jar:lib/netty-3.2.2.Final.jar:lib/org.linkedin.util-core-1.8.glu47.0.jar:lib/org.linkedin.util-groovy-1.8.glu47.0.jar:lib/org.linkedin.zookeeper-cli-impl-1.5.glu47.0-SNAPSHOT.jar:lib/org.linkedin.zookeeper-impl-1.5.glu47.0-SNAPSHOT.jar:lib/slf4j-api-1.6.2.jar:lib/slf4j-log4j12-1.6.2.jar:lib/zookeeper-3.4.5.jar\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.library.path=/local/instantclient10:.:/Users/ypujante/Library/Java/Extensions:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.io.tmpdir=/var/folders/dj/qmkmx5648xjf2n006s7hc1v80000gq/T/\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:java.compiler=<NA>\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:os.name=Mac OS X\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:os.arch=x86_64\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:os.version=10.8.2\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:user.name=ypujante\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:user.home=/Users/ypujante\n2013/03/07 10:53:48.730 INFO [org.apache.zookeeper.ZooKeeper] Client environment:user.dir=/export/content/linkedin-zookeeper/org.linkedin.zookeeper-cli-1.5.glu47.0-SNAPSHOT\n2013/03/07 10:53:48.731 INFO [org.apache.zookeeper.ZooKeeper] Initiating client connection, connectString=localhost:2181 sessionTimeout=100 watcher=org.linkedin.zookeeper.client.ZKClient@3823bdd1\n2013/03/07 10:53:48.737 DEBUG [org.apache.zookeeper.ClientCnxn] zookeeper.disableAutoWatchReset is false\n2013/03/07 10:53:48.756 DEBUG [org.linkedin.zookeeper.cli.ClientMain] Talking to zookeeper on localhost:2181\n2013/03/07 10:53:53.763 INFO [org.apache.zookeeper.ClientCnxn] Opening socket connection to server fe80:0:0:0:0:0:0:1%1/fe80:0:0:0:0:0:0:1%1:2181. Will not attempt to authenticate using SASL (Unable to locate a login configuration)\n{noformat}\n\nFrom this output you can see the line at 10:53:48 => Initiating client connection\nAnd then 5s later, at 10:53:53 => opening socket connection\n\nNote that I did not see this delay/problem prior to upgrading to 3.4.5 (from 3.3.3)\n\nAlso note that sometimes there is no delay as in the following output!\n\n{noformat}\n2013/03/07 11:04:06.084 INFO [org.apache.zookeeper.ZooKeeper] Initiating client connection, connectString=localhost:2181 sessionTimeout=100 watcher=org.linkedin.zookeeper.client.ZKClient@1e670479\n2013/03/07 11:04:06.089 DEBUG [org.apache.zookeeper.ClientCnxn] zookeeper.disableAutoWatchReset is false\n2013/03/07 11:04:06.109 DEBUG [org.linkedin.zookeeper.cli.ClientMain] Talking to zookeeper on localhost:2181\n2013/03/07 11:04:06.116 INFO [org.apache.zookeeper.ClientCnxn] Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181. Will not attempt to authenticate using SASL (Unable to locate a login configuration)\n{noformat}\n\nI will be more than happy to provide more details if necessary. The client code is open source and hosted on github @ https://github.com/linkedin/linkedin-zookeeper/blob/master/org.linkedin.zookeeper-cli-impl/src/main/groovy/org/linkedin/zookeeper/cli/ClientMain.groovy#L65\n\nand is not doing mech but (under the cover)\n\nnew ZooKeeper(\"localhost:2181\", 100, watcher)\n\nand then wait until the SyncConnected even is received...\n\nThanks\nYan\n", "created_at" : { "$date" : "2013-03-07T21:11:58.051+0000" }, "updated_at" : { "$date" : "2013-03-12T10:41:09.840+0000" }, "creator_id" : { "$oid" : "5b7d5295e9214a0d1608d99e" }, "reporter_id" : { "$oid" : "5b7d5295e9214a0d1608d99e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52955f627d6b0586d322" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52955f627d6b0586d321" }, "effect" : "is cloned by", "type" : "Cloners" } ] },
{ "_id" : { "$oid" : "5b7d52955f627d6b0586d32a" }, "external_id" : "ZOOKEEPER-1671", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Remove dependency on log4j 1.2.15", "desc" : "The zookeeper dependency 3.4.5 (latest) depends explicitly on log4j 1.2.15, which has dependencies on com.sun.jmx which can't be resolved from Maven central.\n\nPlease change the dependency to either 1.2.16, which declares these as optional, or 1.2.14, which doesn't have them at all.\n\nhttp://search.maven.org/remotecontent?filepath=org/apache/zookeeper/zookeeper/3.4.5/zookeeper-3.4.5.pom\n\n<dependency>\n<groupId>log4j</groupId>\n<artifactId>log4j</artifactId>\n<version>1.2.15</version>\n<scope>compile</scope>\n</dependency>\n\nThis should be modified to 1.2.14 or 1.2.16 as above.\n\nIt's also not clear why this is used at all; it would be better for ZooKeeper to depend only on slf4j-api, and let users determine what the right slf4j logging implementation is. With this approach, it's not possible to swap out log4j for something else.", "created_at" : { "$date" : "2013-03-18T13:22:35.763+0000" }, "updated_at" : { "$date" : "2013-03-18T13:22:35.763+0000" }, "creator_id" : { "$oid" : "5b7d5295e9214a0d1608d9a0" }, "reporter_id" : { "$oid" : "5b7d5295e9214a0d1608d9a0" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52965f627d6b0586d32b" }, "external_id" : "ZOOKEEPER-1672", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper client does not accept \"-members\" option in reconfig command", "desc" : "Without the modification to src/java/main/org/apache/zookeeper/cli/ReconfigCommand.java line 88, the reconfig command will not accept \"-member\" options by complaining not using the right usage.", "created_at" : { "$date" : "2013-03-19T00:40:09.643+0000" }, "updated_at" : { "$date" : "2013-03-20T11:30:58.168+0000" }, "creator_id" : { "$oid" : "5b7d5296e9214a0d1608d9a1" }, "reporter_id" : { "$oid" : "5b7d5296e9214a0d1608d9a1" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "java client" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5296e9214a0d1608d9a1" }, "issue_links" : [  ], "original_time_estimate" : 0, "environment" : "Zookeeper trunk" },
{ "_id" : { "$oid" : "5b7d52975f627d6b0586d339" }, "external_id" : "ZOOKEEPER-1675", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make sync a quorum operation", "desc" : "sync + read is supposed to return at least the latest write that completes before the sync starts. This is true if the leader doesn't change, but when it does it may not work. The problem happens when the old leader L1 still thinks that it is the leader but some other leader L2 was already elected and committed some operations. Suppose that follower F is connected to L1 and invokes a sync. Even though L1 responds to the sync, the recent operations committed by L2 will not be flushed to F so a subsequent read on F will not see these operations. \n\nTo prevent this we should broadcast the sync like updates.\n\nThis problem is also mentioned in Section 4.4 of the ZooKeeper peper (but the proposed solution there is insufficient to solve the issue).", "created_at" : { "$date" : "2013-03-26T20:49:38.135+0000" }, "updated_at" : { "$date" : "2013-04-01T10:56:33.895+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52975f627d6b0586d340" }, "external_id" : "ZOOKEEPER-1682", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Method to request all zookeepers in cluster", "desc" : "I would like to see an API feature to request the list of all servers in the cluster. The idea here is that a client doesn't have to know about all servers to benefit from the distributed nature of Zookeeper. If they can connect to one, they can have their bases covered from there on out.", "created_at" : { "$date" : "2013-04-02T14:57:16.411+0000" }, "updated_at" : { "$date" : "2013-04-02T18:01:05.979+0000" }, "creator_id" : { "$oid" : "5b7d5297e9214a0d1608d9a2" }, "reporter_id" : { "$oid" : "5b7d5297e9214a0d1608d9a2" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "duplicates", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d52985f627d6b0586d346" }, "external_id" : "CURATOR-13", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52985f627d6b0586d347" }, "external_id" : "CURATOR-7", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52985f627d6b0586d348" }, "external_id" : "ZOOKEEPER-1680", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Cannot connect with a given sessionId - it is discarded", "desc" : "While the API permits construction of a ZooKeeper client object with a given sessionId, the sessionId can never be used:\n\nClientCnxn line 850: long sessId = (seenRwServerBefore) ? sessionId : 0;\n\nThe only person who sets seenRwServerBefore is onConnected().\n\nTherefore, it appears that passing a sessionId into a ZooKeeper constructor has no effect, as the ClientCnxn has never seen an RW server before, so it discards it anyway.", "created_at" : { "$date" : "2013-03-29T23:39:26.802+0000" }, "updated_at" : { "$date" : "2013-04-02T21:33:05.759+0000" }, "creator_id" : { "$oid" : "5b7d5298e9214a0d1608d9a3" }, "reporter_id" : { "$oid" : "5b7d5298e9214a0d1608d9a3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52985f627d6b0586d347" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52985f627d6b0586d346" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52995f627d6b0586d34b" }, "external_id" : "ZOOKEEPER-1685", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper client hard codes the server principal to zookeeper", "desc" : "Noticed this while debugging a secure deploy. The server was started with the principal zk/_HOST\n\nWhen a client tried to connect to this it tried to setup a secure connection to server zookeeper/_HOST and failed authentication.\n\nIn ClientCnxn.java\n\n{code}\ntry {\n                zooKeeperSaslClient = new ZooKeeperSaslClient(\"zookeeper/\"+addr.getHostName());\n            } catch (LoginException e) {\n{code}", "created_at" : { "$date" : "2013-04-05T21:03:09.422+0000" }, "updated_at" : { "$date" : "2013-04-05T21:04:29.369+0000" }, "creator_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "reporter_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52995f627d6b0586d34d" }, "external_id" : "ZOOKEEPER-30", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Hooks for atomic broadcast protocol", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1938788&group_id=209147&atid=1008547", "created_at" : { "$date" : "2008-06-10T22:15:16.509+0000" }, "updated_at" : { "$date" : "2013-04-11T21:36:24.150+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d529a5f627d6b0586d36b" }, "external_id" : "ZOOKEEPER-1687", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Number of past transactions retains in ZKDatabase.committedLog should be configurable", "desc" : "ZKDatabase.committedLog retains the past 500 transactions. In case of memory usage is more important than speed and vice versa, this should be configurable.", "created_at" : { "$date" : "2013-04-08T16:55:31.095+0000" }, "updated_at" : { "$date" : "2013-04-15T11:57:55.847+0000" }, "creator_id" : { "$oid" : "5b7d529ae9214a0d1608d9a7" }, "reporter_id" : { "$oid" : "5b7d529ae9214a0d1608d9a7" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d529b5f627d6b0586d36e" }, "external_id" : "ZOOKEEPER-1690", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Race condition when close sock may cause a NPE in sendBuffer ", "desc" : "In NIOServerCnxn.java\n     public void close() {\n            closeSock();\n            ...\n            sk.cancel();\n\nClose sock first, then cancel the channel.\n    \n    public void sendBuffer(ByteBuffer bb) {\n                if ((sk.interestOps() & SelectionKey.OP_WRITE) == 0) {\n                        ...\n                        sock.write(bb);\n\nGet ops of the channel, then read sock (may be null)\n\nI have noticed that the 3.5.0-branch has fixed the problem.", "created_at" : { "$date" : "2013-04-15T11:53:33.922+0000" }, "updated_at" : { "$date" : "2013-04-15T11:59:25.740+0000" }, "creator_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "reporter_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.6" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d529b5f627d6b0586d370" }, "external_id" : "ZOOKEEPER-1342", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "quorum Listener & LearnerCnxAcceptor are missing thread names", "created_at" : { "$date" : "2011-12-23T05:15:15.517+0000" }, "updated_at" : { "$date" : "2013-04-22T20:02:22.295+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [ "derby_triage10_5_2" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d529c5f627d6b0586d385" }, "external_id" : "ZOOKEEPER-1324", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d529b5f627d6b0586d371" }, "external_id" : "ZOOKEEPER-1694", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [ "quorum" ], "labels" : [ "patch" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d529c5f627d6b0586d385" }, "effect" : "duplicates", "type" : "Duplicate" } ], "created_at" : { "$date" : "2013-04-22T10:08:25.228+0000" }, "priority" : "Minor", "desc" : "This is at least what it seems in the logs. This also seems to cause a second snapshot in the follower.", "reporter_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "resolution" : "Duplicate", "creator_id" : { "$oid" : "5b7d529be9214a0d1608d9a8" }, "updated_at" : { "$date" : "2013-04-22T20:02:50.155+0000" }, "title" : "ZooKeeper Leader sends a repeated NEWLEADER quorum packet to followers", "issue_type" : "Bug", "environment" : "Windows, Linux, MacOSX", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d529d5f627d6b0586d39d" }, "external_id" : "ZOOKEEPER-49", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SetACL does not work", "desc" : "As reported by Shane:\n\nStill exploring the ACL stuff in Zookeeper.  Tried using setACL for a  \npath but get InvalidACL error thrown .... looking at pRequest in  \nPrepRequestProcessor ... and in particular these lines ...\n\n\n                 SetACLRequest setAclRequest = new SetACLRequest();\n                 if (!fixupACL(request.authInfo,  \nsetAclRequest.getAcl())) {\n                     throw new KeeperException(Code.InvalidACL);\n                 }\n\na new SetACLRequest will return a null when called in fixupACL  \nreturning false and throwing the exception .... as far as I can see.", "created_at" : { "$date" : "2008-06-20T07:23:28.753+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:14.426+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d529d5f627d6b0586d39c" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d529d5f627d6b0586d39c" }, "external_id" : "ZOOKEEPER-48", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d529d5f627d6b0586d39d" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-06-20T06:02:47.685+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2013-05-02T02:29:14.431+0000" }, "title" : "AUTH_ID not handled correctly when no auth ids are present", "issue_type" : "Bug", "desc" : "AUTH_ID is used (usually done using Ids.CREATOR_ALL_ACL ) to represent the id that was used to authenticate with ZooKeeper. Thus, an exception should be raised if there are no authenticated ids present. Currently, the exception is not being raised.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f3b5f627d6b0586805e" }, "external_id" : "ZOOKEEPER-50", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f745f627d6b05868520" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d4f3b5f627d6b0586805f" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-06-20T20:36:38.538+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2013-05-02T02:29:16.514+0000" }, "title" : "Watch event delivery rules", "issue_type" : "Bug", "desc" : "We need to make clear in the documentation and enforce in the code the following watch event rules:\n\n# A watch event will be delivered once to each watcher, even if it is registered multiple times. For example, if the same watch object is used for getChildren(\"/foo\", watchObj) and getData(\"/foo\", watchObj, stat) and foo is deleted, watchObj will be called once to processed the NodeDeleted event.\n# Session events will be delivered to all watchers.\n\n*Note: a watcher is a Watcher object in Java or a (watch function, context) pair in C.*\n\nThere is currently a bug in the Java client that causes the session disconnected event to be delivered twice to the default watcher if the default watcher is also used to watch a path. This violates rule 1.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d4f745f627d6b05868520" }, "external_id" : "ZOOKEEPER-23", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "fix_versions" : [ "3.0.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4f985f627d6b0586883f" }, "effect" : "duplicates", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d4f745f627d6b05868521" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d4f3b5f627d6b0586805e" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2008-06-10T21:29:10.281+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2013-05-02T02:29:16.519+0000" }, "title" : "Auto reset of watches on reconnect", "issue_type" : "New Feature", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1831413&group_id=209147&atid=1008547", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52a05f627d6b0586d3f2" }, "external_id" : "ZOOKEEPER-217", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "handle errors when parsing config file, throw illegalargumentexception rather than exit()", "desc" : "Discussing 209 with Ben today, we thought that it would be better to have the parse method of QuorumPeerConfig returning a boolean that indicates whether the configuration is good or not, and let the caller decide whether to exit or not. Currently we execute a System.exit() on QuorumPeerConfig.parse when we have a critical configuration error.", "created_at" : { "$date" : "2008-11-05T17:50:59.327+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:17.576+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.0.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.0.1", "3.1.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a05f627d6b0586d3f1" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52a05f627d6b0586d3f1" }, "external_id" : "ZOOKEEPER-209", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "fix_versions" : [ "3.0.1", "3.1.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a05f627d6b0586d3f2" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2008-10-27T23:22:00.361+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2013-05-02T02:29:17.572+0000" }, "title" : "nullpointerexception if election port is not specified.", "issue_type" : "Bug", "desc" : "The quoruom servers throw a nullpointer exception and still keep running. We should atleast have a nice debug message and quit... ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52a15f627d6b0586d42f" }, "external_id" : "ZOOKEEPER-577", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "LeaderElection code hardcodes majority quorums in at least two places", "desc" : "See e.g. lookForLeader in LeaderElection.java and termPredicate in AuthFastLeaderElection.java\n\nShould use containsQuorum. ", "created_at" : { "$date" : "2009-11-11T18:30:49.035+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:21.502+0000" }, "creator_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "reporter_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.2.1" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4ff5e9214a0d1608d88f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a15f627d6b0586d42e" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52a15f627d6b0586d42e" }, "external_id" : "ZOOKEEPER-372", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "leaderElection" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a15f627d6b0586d42f" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "created_at" : { "$date" : "2009-04-09T15:18:45.491+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:21.506+0000" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "priority" : "Minor", "title" : "Use ZooKeeper server identifier with AuthFastLeaderElection ", "issue_type" : "Improvement", "desc" : "Currently, we use InetSocketAddress objects to identify peers in AuthFastLeaderElection. We should change it to be consistent with the TCP version and to enable us to use with the feature of ZOOKEEPER-29.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d506d5f627d6b05869bda" }, "external_id" : "ZOOKEEPER-461", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-07-11T07:36:17.293+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2013-05-02T02:29:21.213+0000" }, "title" : "Condense ledger configuration in ZooKeeper", "issue_type" : "Improvement", "desc" : "We currently use several znodes to represent the configuration and state of a ledger in ZooKeeper. Although this is good for readability, it makes operations such as create, close, and open more complex, in particular the asynchronous versions of these operations. The main idea of this jira is to store as much as possible of the configuration of a ledger as data of a single znode.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d50625f627d6b05869a98" }, "external_id" : "ZOOKEEPER-503", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a99" }, "effect" : "is part of", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bda" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d50645f627d6b05869adf" }, "effect" : "incorporates", "type" : "Incorporates" }, { "issue_id" : { "$oid" : "5b7d506d5f627d6b05869bda" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d50625f627d6b05869a9a" }, "effect" : "incorporates", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "created_at" : { "$date" : "2009-08-07T01:06:12.307+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2013-05-02T02:29:21.209+0000" }, "title" : "race condition in asynchronous create", "issue_type" : "Bug", "desc" : "there is a race condition between the zookeeper completion thread and the bookeeper processing queue during create. if the zookeeper completion thread falls behind due to scheduling, the action counter of the create operation may go backwards.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52a45f627d6b0586d461" }, "external_id" : "ZOOKEEPER-623", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClientBase in bookkeeper.util requires junit", "desc" : "Class org.apache.bookkeeper.util.ClientBase requires junit, and when I tried to just compile bookkeeper, no test, with the patch of ZOOKEEPER-534, compilation failed. ", "created_at" : { "$date" : "2009-12-14T08:49:23.292+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:22.130+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a45f627d6b0586d460" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52a55f627d6b0586d483" }, "external_id" : "ZOOKEEPER-584", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooKeeper service instance should be registered in the OSGi registry", "desc" : "When Zookeeper is booted in an OSGi framework by {{ManagedService}} it would be quite handy to have {{ManagedService}} register a management interface for that ZooKeeper instance into the OSGi service registry.", "created_at" : { "$date" : "2009-11-19T15:16:46.408+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:22.793+0000" }, "creator_id" : { "$oid" : "5b7d51b3e9214a0d1608d927" }, "reporter_id" : { "$oid" : "5b7d51b3e9214a0d1608d927" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51965f627d6b0586b87e" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d51965f627d6b0586b87e" }, "external_id" : "ZOOKEEPER-425", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "build" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a55f627d6b0586d483" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d51965f627d6b0586b87f" }, "effect" : "relates to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "created_at" : { "$date" : "2009-06-02T14:28:22.576+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d505de9214a0d1608d8a2" }, "updated_at" : { "$date" : "2013-05-02T02:29:22.799+0000" }, "title" : "Add OSGi metadata to zookeeper.jar", "issue_type" : "Improvement", "desc" : "After adding OSGi metadata to zookeeper.jar it can be used as both an OSGi bundle as well as an ordinary jar file. \nIn the CXF/DOSGi project the buildsystem does this using the maven-bundle-plugin: http://svn.apache.org/repos/asf/cxf/dosgi/trunk/discovery/distributed/zookeeper-wrapper/pom.xml\n\nThe MANIFEST.MF generated by maven-bundle-plugin is attached to this bug, this works for the CXF/DOSGi project.\nIf your buildsystem isn't using maven, I would advise to use bnd (http://www.aqute.biz/Code/Bnd). BND defines its own ant task in which you should be able to use more or less the same instructions as were used in maven:\n<instructions>\n  <Bundle-Name>ZooKeeper bundle</Bundle-Name>\n  <Bundle-Description>This bundle contains the ZooKeeper library</Bundle-Description>\n  <Bundle-SymbolicName>org.apache.hadoop.zookeeper</Bundle-SymbolicName>\n  <Bundle-Version>3.1.1</Bundle-Version>\n  <Import-Package>*</Import-Package>\n  <Export-Package>*;version=3.1.1</Export-Package>\n</instructions>\n\nOh and one other thing. Is it really necessary to put the source code in the Jar file too? I would put that in a separate source distribution :)\n\nSee also: http://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/200905.mbox/%3c4A2009B1.3030603@yahoo-inc.com%3e", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52a45f627d6b0586d460" }, "external_id" : "ZOOKEEPER-534", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0", "3.2.1" ], "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a45f627d6b0586d461" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2009-09-23T18:46:40.469+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2013-05-02T02:29:22.126+0000" }, "title" : "The test target in contib/bookkeeper does not depend on jar target.", "issue_type" : "Bug", "desc" : "The test target in contib/bookkeeper does not depend on jar target. So the ant test target gives compilation errors if the main is not compiled which can be prevented if it depends on jar. It can then check if main has been compiled or not and throw out a reasonable error.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52a75f627d6b0586d4d0" }, "external_id" : "ZOOKEEPER-629", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLELostMessageTest assumes that the first zxid on a startup of quorum is -1.", "desc" : "FLELostMessageTest assumes that the first zxid exchange will be -1 zxid. WIth ZOOKEEPER-596 the zxid would be 0 and not -1. So the corresponding change needs to be made to this test.", "created_at" : { "$date" : "2009-12-16T05:00:56.204+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:23.620+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a75f627d6b0586d4cf" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52a75f627d6b0586d4cf" }, "external_id" : "ZOOKEEPER-596", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.1" ], "fix_versions" : [ "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52a75f627d6b0586d4d0" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "created_at" : { "$date" : "2009-11-24T22:51:29.258+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2013-05-02T02:29:23.616+0000" }, "title" : "The last logged zxid calculated by zookeeper servers could cause problems in leader election if data gets corrupted.", "issue_type" : "Bug", "desc" : "It is possible that the last loggged zxid as reported by all the servers during leader election is not the last zxid that the server can upload data to. It is very much possible that some transaction or snapshot gets corrupted and the servers actually do not have valid data till last logged zxid. We need to make sure that what the servers report as there last logged zxid, they are able to load data till that zxid.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52aa5f627d6b0586d504" }, "external_id" : "ZOOKEEPER-383", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Asynchronous version of createLedger()", "desc" : "While there are async versions for read and write, there is no async version for creating a ledger. This can cause applications to have to change their whole thread design. \n\nIt should be easier and more consistent to add an async version of createLedger().", "created_at" : { "$date" : "2009-04-27T20:35:44.517+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:24.354+0000" }, "creator_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "reporter_id" : { "$oid" : "5b7d5061e9214a0d1608d8a5" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52aa5f627d6b0586d503" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52aa5f627d6b0586d503" }, "external_id" : "ZOOKEEPER-400", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper" ], "fix_versions" : [ "3.2.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52aa5f627d6b0586d504" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-05-12T21:26:25.814+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2013-05-02T02:29:24.357+0000" }, "title" : "Issues with procedure to close ledger", "issue_type" : "Bug", "desc" : "When running a few experiments with BookKeeper, I found a couple of issues with closing a ledger:\n\n* On ClientCBWorker::run(), we should call setAddConfirmed before invoking the callback method. Otherwise, it is possible that an application closes a ledger before ClientCBWorker modifies the last confirmed operation, and the value written to ZooKeeper won't be the last one written;\n* LedgerHandle should write the last add confirmed instead of the last counter. The last attribute counts the operations issued, and we use it to determine the id of the next entry. If an application calls close upon receiving all callbacks, then with the previous modification, the last confirmed add must be equal to (last-1). However, if an application invokes close before receiving all callbacks, the ledger may be left in an inconsistent state because the last entry written to ZooKeeper may be an operation that hasn't completed yet. \n\nAlthough the modifications required are simple, they are important.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52ab5f627d6b0586d541" }, "external_id" : "ZOOKEEPER-481", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add lastMessageSent to QuorumCnxManager", "desc" : "Currently we rely on TCP for reliable delivery of FLE messages. However, as we concurrently drop and create new connections, it is possible that a message is sent but never received. With this patch, cnx manager keeps a list of last messages sent, and resends the last one sent. Receiving multiples copies is harmless. ", "created_at" : { "$date" : "2009-07-20T13:43:29.024+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.976+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0", "3.1.1" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d540" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53f" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53e" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52ac5f627d6b0586d56e" }, "external_id" : "ZOOKEEPER-480", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLE should perform leader check when node is not leading and add vote of follower", "desc" : "As a server may join leader election while others have already elected a leader, it is necessary that a server handles some special cases of leader election when notifications are from servers that are either LEADING or FOLLOWING. In such special cases, we check if we have received a message from the leader to declare a leader elected. This check does not consider the case that the process performing the check might be a recently elected leader, and consequently the check fails.\n\nThis patch also adds a new case, which corresponds to adding a vote to recvset when the notification is from a process LEADING or FOLLOWING. This fixes the case raised in ZOOKEEPER-475.", "created_at" : { "$date" : "2009-07-20T13:33:29.116+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.724+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53e" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52ab5f627d6b0586d53f" }, "external_id" : "ZOOKEEPER-479", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum" ], "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d540" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53e" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d541" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-07-20T13:00:17.084+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.953+0000" }, "title" : "QuorumHierarchical does not count groups correctly", "issue_type" : "Bug", "desc" : "QuorumHierarchical::containsQuorum should not verify if all groups represented in the input set have more than half of the total weight. Instead, it should check only for an overall majority of groups. ", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52ab5f627d6b0586d53e" }, "external_id" : "ZOOKEEPER-475", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "quorum" ], "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ac5f627d6b0586d56e" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d541" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53f" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-07-16T21:39:26.859+0000" }, "priority" : "Blocker", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.742+0000" }, "title" : "FLENewEpochTest failed on nightly builds.", "issue_type" : "Bug", "desc" : "THe flenewepochtest failed on one of the nightly builds -\nhttp://hudson.zones.apache.org/hudson/view/ZooKeeper/job/ZooKeeper-trunk/377.\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52af5f627d6b0586d5cc" }, "external_id" : "ZOOKEEPER-471", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "update zkperl for 3.2.x branch", "desc" : "Update the documentation, version number, and one test in the zkperl contrib module to match 3.2.0.  The only code change here involves changing one authorization test to use the 'ip' instead of the now-removed 'host' scheme.", "created_at" : { "$date" : "2009-07-14T19:05:41.695+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.319+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "contrib" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52af5f627d6b0586d5cb" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52af5f627d6b0586d5de" }, "external_id" : "ZOOKEEPER-466", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "crash on zookeeper_close() when using auth with empty cert", "desc" : "The free_auth_info() function calls deallocate_Buffer(&auth->auth) on every element in the auth list; that function frees any memory pointed to by auth->auth.buff if that field is non-NULL.\n\nIn zoo_add_auth(), when certLen is zero (or cert is NULL), auth.buff is set to 0, but then not assigned to authinfo->auth when auth.buff is NULL.  The result is uninitialized data in auth->auth.buff in free_auth_info(), and potential crashes.\n\nThe attached patch adds a test which attempts to duplicate this error; it works for me but may not always on all systems as it depends on the uninitialized data being non-zero; there's not really a simple way I can see to trigger this in the current test framework.  The patch also fixes the problem, I believe.", "created_at" : { "$date" : "2009-07-14T03:25:12.925+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.344+0000" }, "creator_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "reporter_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.1", "3.3.0" ], "assignee_id" : { "$oid" : "5b7d4f93e9214a0d1608d87b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52af5f627d6b0586d5cb" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52ab5f627d6b0586d540" }, "external_id" : "ZOOKEEPER-491", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.2.0" ], "components" : [ "leaderElection" ], "fix_versions" : [ "3.2.1", "3.3.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d541" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52ab5f627d6b0586d53f" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "created_at" : { "$date" : "2009-07-29T18:51:10.921+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "updated_at" : { "$date" : "2013-05-02T02:29:26.972+0000" }, "title" : "Prevent zero-weight servers from being elected", "issue_type" : "Bug", "desc" : "This is a fix to prevent zero-weight servers from being elected leaders. This will allow in wide-area scenarios to restrict the set of servers that can lead the ensemble.", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52b15f627d6b0586d60b" }, "external_id" : "ZOOKEEPER-831", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "BookKeeper: Throttling improved for reads", "desc" : "Reads and writes in BookKeeper are asymmetric: a write request writes one entry, whereas a read request may read multiple requests. The current implementation of throttling only counts the number of read requests instead of counting the number of entries being read. Consequently, a few read requests reading a large number of entries each will spawn a large number of read-entry requests. ", "created_at" : { "$date" : "2010-08-04T21:25:16.857+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:29.747+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "contrib-bookkeeper" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52b15f627d6b0586d60a" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52b15f627d6b0586d618" }, "external_id" : "ZOOKEEPER-828", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52b25f627d6b0586d62a" }, "external_id" : "ZOOKEEPER-874", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FileTxnSnapLog.restore does not call listener", "desc" : "FileTxnSnapLog.restore() does not call listener passed as parameter. The result is that the commitLogs list is empty. When a follower connects to the leader, the leader is forced to send a snapshot to the follower instead of a couple of requests and commits.", "created_at" : { "$date" : "2010-09-17T16:01:03.667+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:33.975+0000" }, "creator_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "reporter_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52b25f627d6b0586d629" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52b35f627d6b0586d643" }, "external_id" : "ZOOKEEPER-12", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "getChildren doesn't return a list of paths", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1941120&group_id=209147&atid=1008544", "created_at" : { "$date" : "2008-06-10T21:11:36.890+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:34.720+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "java client", "documentation" ], "labels" : [ "api" ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a774" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52b35f627d6b0586d64d" }, "external_id" : "ZOOKEEPER-1164", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Support encryption for C binding", "desc" : "If ZooKeeper is going to switch to netty for connections to support encryption, then C binding library and other language bindings should be updated to support communication through netty to support encryption.", "created_at" : { "$date" : "2011-08-29T17:59:43.008+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:43.845+0000" }, "creator_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "reporter_id" : { "$oid" : "5b7d5168e9214a0d1608d90c" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.5.0" ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50e95f627d6b0586a6f9" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d51285f627d6b0586aade" }, "external_id" : "ZOOKEEPER-1195", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d51285f627d6b0586aadf" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d517c5f627d6b0586b4d0" }, "effect" : "is part of", "type" : "Incorporates" } ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "created_at" : { "$date" : "2011-09-20T15:15:41.063+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "updated_at" : { "$date" : "2013-05-02T02:29:44.982+0000" }, "title" : "SASL authorizedID being incorrectly set: should use getHostName() rather than getServiceName()", "issue_type" : "Bug", "desc" : "Tom Klonikowski writes:\n\n    Hello developers,\n\n    the SaslServerCallbackHandler in trunk changes the principal name\n    service/host@REALM to service/service@REALM (i guess unintentionally).\n\n    lines 131-133:\n    if (!removeHost() && (kerberosName.getHostName() != null)) {\n      userName += \"/\" + kerberosName.getServiceName();\n    }\n\n    Server Log:\n\n    SaslServerCallbackHandler@115] - Successfully authenticated client:\n    authenticationID=fetcher/ubook@QUINZOO;\n    authorizationID=fetcher/ubook@QUINZOO.\n\n    SaslServerCallbackHandler@137] - Setting authorizedID:\n    fetcher/fetcher@QUINZOO\n\n", "status" : "Closed" },
{ "_id" : { "$oid" : "5b7d52b55f627d6b0586d66c" }, "external_id" : "ZOOKEEPER-1185", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Send AuthFailed event to client if SASL authentication fails", "desc" : "There are 3 places where ClientCnxn should queue a AuthFailed event if client fails to authenticate. Without sending this event, clients may be stuck watching for a SaslAuthenticated event that will never come (since the client failed to authenticate).\n\n", "created_at" : { "$date" : "2011-09-15T01:11:09.719+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:44.761+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "java client" ], "labels" : [ "kerberos", "security" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52b65f627d6b0586d684" }, "external_id" : "ZOOKEEPER-1181", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Fix problems with Kerberos TGT renewal", "desc" : "Currently, in Zookeeper trunk, there are two problems with Kerberos TGT renewal:\n\n1. TGTs obtained from a keytab are not refreshed periodically. They should be, just as those from ticket cache are refreshed.\n\n2. Ticket renewal should be retried if it fails. Ticket renewal might fail if two or more separate processes (different JVMs) running as the same user try to renew Kerberos credentials at the same time. \n", "created_at" : { "$date" : "2011-09-13T23:38:55.229+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:44.696+0000" }, "creator_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "reporter_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Closed", "affects_versions" : [ "3.4.0" ], "components" : [ "server", "java client" ], "labels" : [ "kerberos", "security" ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d51ea5f627d6b0586c3d5" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52b65f627d6b0586d6a7" }, "external_id" : "ZOOKEEPER-1255", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "unused fields in DataTree.ProcessTxnResult", "desc" : "The fields zxid, cxid and clientId in ProcessTxnResult are never used. cxid and clientId are used in equals() and hashCode() but the class is never ever used as a key or compared.\n\nKeeping equals() and hashCode() \"just in case\" is a bad idea:\nhttp://www.infoq.com/news/2011/05/less-code-is-better", "created_at" : { "$date" : "2011-10-27T07:38:21.591+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.320+0000" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" } },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b3" }, "external_id" : "ZOOKEEPER-1259", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "external_id" : "ZOOKEEPER-1285", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad19" }, "effect" : "supercedes", "type" : "Supercedes" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b3" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b4" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b1" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b5" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b65f627d6b0586d6a7" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b6" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b7" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52b75f627d6b0586d6b2" }, "effect" : "depends upon", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "created_at" : { "$date" : "2011-11-03T14:38:55.221+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.381+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "priority" : "Major", "title" : "make DataTree immutable", "issue_type" : "Improvement", "desc" : "Having an immutable DataTree structure in the ZooKeeper server is an ambitious goal but is possible. Advantages would be:\n\n- No synchronization needed when accessing the DataTree.\n- The snapshotter thread gets an immutable datatree and will write a consistent DataTree to the disk.\n- No headaches whether multi transactions could lead to issues with (de)serialization.\n- Much better testability.\n- No concurrency - No headaches.\n- I hope for considerable speed improvements. Maybe also some memory savings, at least from refactorings possible after this step.\n- Statistical Data about the tree can be updated on every tree modification and is always consistent. The need to save statistical data in extra nodes for the quota feature goes away.\n\nPossible further improvements:\n\nRead requests actually don't need to enter the processor pipeline. Instead each server connection could get a reference to a (zxid, tree) tuple. Updates \nare delivered as (zxid, newTree, triggerWatchesCallback) to the server connections.\nThe watches could be managed at each server connection instead of centrally at the DataTree.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b2" }, "external_id" : "ZOOKEEPER-1230", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "priority" : "Major", "created_at" : { "$date" : "2011-10-15T17:15:18.870+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.363+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "title" : "Cleanup FileTxnLog", "desc" : "- remove Interface TxnLog. The discussion on the mailing list (subject: \"Get rid of unnecessary Interfaces\") didn't give a definite No...?\n- make things private where possible\n- does preAllocSize need to be static and therefor global?\n- the append method has one big if statement from begin to end. make this a fast return\n- new private method to initialize a new logStream if logSTream == null\n- move the check for a faulty transaction in the method o.a.z.s.persistence.Util.marshallTxnEntry\n- mashallTxnEntry is only ever used from the append method of FileTxnLog. However I've seen the same code somewhere else...\n- new private method that returns a checksum for a given bytebuffer and length\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b4" }, "external_id" : "ZOOKEEPER-1276", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "priority" : "Minor", "created_at" : { "$date" : "2011-11-02T16:38:25.747+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.298+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "title" : "ZKDatabase should not hold reference to FileTxnSnapLog", "desc" : "The ZkDatabase class contains a reference to a FileTxnSnapLog although it doesn't need it. It has four methods that just forward calls to the instance and two methods that could receive an instance of FileTxnSnapLog instead of refering to a member of _this_.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b5" }, "external_id" : "ZOOKEEPER-1279", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "priority" : "Minor", "created_at" : { "$date" : "2011-11-02T17:13:55.550+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.274+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "title" : "Only SessionTracker should hold reference to sessionsWithTimeouts", "desc" : "Currently the ZKDataBase, ZooKeeperServer and SessionTrackers hold references to the same map, called sessionsWithTimeouts everywhere. That's very confusing. It is possible to have the reference only in the SessionTrackers and take it from there if it should ever be needed outside.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b6" }, "external_id" : "ZOOKEEPER-1253", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "created_at" : { "$date" : "2011-10-26T13:30:33.706+0000" }, "priority" : "Trivial", "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.341+0000" }, "title" : "return value of DataTree.createNode is never used", "issue_type" : "Sub-task", "desc" : "createNode returns the unmodified path string which it has received as parameter. Consequently no caller uses the return value.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b1" }, "external_id" : "ZOOKEEPER-1228", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "priority" : "Major", "created_at" : { "$date" : "2011-10-14T15:10:49.962+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:46.385+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "title" : "Cleanup SessionTracker", "desc" : "- fix ordering of class members\n- Remove Interface Session and rename inner class SessionImpl to Session\n- make properties private final where possible\n- rename SessionTrackerImpl to LeaderSessionTracker. There's a LearnerSessionTracker, so it makes sense.\n- make the following code clearer, what does the bitshifting do?\n{code}\n    public static long initializeNextSession(long id) {\n        long nextSid = 0;\n        nextSid = (System.currentTimeMillis() << 24) >> 8;\n        nextSid =  nextSid | (id <<56);\n        return nextSid;\n    }\n{code}\n- replace the inner class SessionSet by a normal Set\n- make SessionTrackerImpl an instance of Runnable\n", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52bb5f627d6b0586d6f5" }, "external_id" : "HBASE-4791", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52725f627d6b0586d056" }, "external_id" : "ZOOKEEPER-1373", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.2" ], "components" : [ "java client" ], "fix_versions" : [ "3.4.3", "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50f05f627d6b0586a77b" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52bb5f627d6b0586d6f4" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52255f627d6b0586ca11" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52685f627d6b0586cf57" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d523f5f627d6b0586cc52" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52bb5f627d6b0586d6f4" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52bb5f627d6b0586d6f5" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d50f0e9214a0d1608d8cd" }, "created_at" : { "$date" : "2012-01-24T03:40:05.681+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "updated_at" : { "$date" : "2013-05-02T02:29:48.954+0000" }, "title" : "Hardcoded SASL login context name clashes with Hadoop security configuration override", "issue_type" : "Bug", "desc" : "I'm trying to configure a process with Hadoop security (Hive metastore server) to talk to ZooKeeper 3.4.2 with Kerberos authentication. In this scenario Hadoop controls the SASL configuration (org.apache.hadoop.security.UserGroupInformation.HadoopConfiguration), instead of setting up the ZooKeeper \"Client\" loginContext via jaas.conf and system property \n\n{{-Djava.security.auth.login.config}}\n\nUsing the Hadoop configuration would work, except that ZooKeeper client code expects the loginContextName to be \"Client\" while Hadoop security will use  \"hadoop-keytab-kerberos\". I verified that by changing the name in the debugger the SASL authentication succeeds while otherwise the login configuration cannot be resolved and the connection to ZooKeeper is unauthenticated. \n\nTo integrate with Hadoop, the following in ZooKeeperSaslClient would need to change to make the name configurable:\n\n     {{login = new Login(\"Client\",new ClientCallbackHandler(null));}}\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52bc5f627d6b0586d743" }, "external_id" : "ZOOKEEPER-1409", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52335f627d6b0586cb32" }, "external_id" : "ZOOKEEPER-271", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.1", "3.0.0" ], "components" : [ "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52bc5f627d6b0586d743" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52335f627d6b0586cb33" }, "effect" : "supercedes", "type" : "Supercedes" }, { "issue_id" : { "$oid" : "5b7d52bc5f627d6b0586d742" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d5225e9214a0d1608d94f" }, "created_at" : { "$date" : "2009-01-09T04:00:06.673+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "updated_at" : { "$date" : "2013-05-02T02:29:50.539+0000" }, "title" : "Better command line parsing in ZookeeperMain.", "issue_type" : "Improvement", "desc" : "The command line parsing in zookeepermain is very basic.We should use some kind of cli parsing (commons-cli?) or something else that is standard and improve our command line parsing. This will remove the scattered code that we have in zookeepermain and we will have much better command line parsing.\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52bd5f627d6b0586d765" }, "external_id" : "ZOOKEEPER-1565", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow ClientTest.java build with IBM Java", "desc" : "The org.apache.zookeeper.test.ClientTest class imports the com.sun.management.UnixOperatingSystemMXBean class, that fail to build when using IBM Java 6 SR 11. This issue is resolved by new class OSMXBean class proposed in JIRA's 1474.\n\nThe class OSMXBean (org.apache.zookeeper.server.util.OSMXBean) is a wrapper for the implementation of com.sun.management.UnixOperatingSystemMXBean, and decides to use the SUN API or its own implementation depending on the runtime (vendor) used.", "created_at" : { "$date" : "2012-10-16T19:56:55.256+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:56.708+0000" }, "creator_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "reporter_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.4" ], "components" : [ "tests" ], "labels" : [ "test" ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdbb" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52bd5f627d6b0586d764" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Linux, RHEL 6.3, IBM Java 6 SR 11" },
{ "_id" : { "$oid" : "5b7d52be5f627d6b0586d770" }, "external_id" : "ZOOKEEPER-1571", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow QuorumUtil.java build with IBM Java", "desc" : "The org.apache.zookeeper.test.QuorumUtil class imports the com.sun.management.UnixOperatingSystemMXBean class, that fail to build when using IBM Java 6 SR 11.  This issue is resolved by new class OSMXBean class proposed in JIRA's 1474.\n\nThe class OSMXBean (org.apache.zookeeper.server.util.OSMXBean) is a wrapper for the implementation of com.sun.management.UnixOperatingSystemMXBean, and decides to use the SUN API or its own implementation depending on the runtime (vendor) used.", "created_at" : { "$date" : "2012-10-30T15:22:26.549+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:57.541+0000" }, "creator_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "reporter_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.4" ], "components" : [ "tests" ], "labels" : [ "test" ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdbb" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52bd5f627d6b0586d764" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Linux (x86_64), RHEL 6.3, IBM Java 6 SR 11" },
{ "_id" : { "$oid" : "5b7d52be5f627d6b0586d77a" }, "external_id" : "ZOOKEEPER-1570", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow QuorumBase.java build with IBM Java", "desc" : "The org.apache.zookeeper.test.QuorumBase class imports the com.sun.management.UnixOperatingSystemMXBean class, that fail to build when using IBM Java 6 SR 11.  This issue is resolved by new class OSMXBean class proposed in JIRA's 1474.\n\nThe class OSMXBean (org.apache.zookeeper.server.util.OSMXBean) is a wrapper for the implementation of com.sun.management.UnixOperatingSystemMXBean, and decides to use the SUN API or its own implementation depending on the runtime (vendor) used.\n", "created_at" : { "$date" : "2012-10-30T15:20:49.610+0000" }, "updated_at" : { "$date" : "2013-05-02T02:29:57.565+0000" }, "creator_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "reporter_id" : { "$oid" : "5b7d52bde9214a0d1608d9ab" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.4" ], "components" : [ "tests" ], "labels" : [ "test" ], "resolution" : "Duplicate", "fix_versions" : [ "3.4.4" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52545f627d6b0586cdbb" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52bd5f627d6b0586d764" }, "effect" : "is duplicated by", "type" : "Duplicate" } ], "environment" : "Linux, RHEL 6.3, IBM Java 6 SR 11" },
{ "_id" : { "$oid" : "5b7d52bf5f627d6b0586d784" }, "external_id" : "ZOOKEEPER-1504", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52bf5f627d6b0586d785" }, "external_id" : "ZOOKEEPER-1620", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "NIOServerCnxnFactory (new code introduced in ZK-1504) opens selectors but never closes them", "desc" : "New code (committed in ZK-1504) opens selectors but doesn't close them.\nSpecifically AbstractSelectThread in its constructor does \n\nthis.selector = Selector.open();\n\nBut possibly also elsewhere. Tests fail for me with the following message:\n\njava.io.IOException: Too many open files\n\tat sun.nio.ch.EPollArrayWrapper.epollCreate(Native Method)\n\tat sun.nio.ch.EPollArrayWrapper.<init>(EPollArrayWrapper.java:69)\n\tat sun.nio.ch.EPollSelectorImpl.<init>(EPollSelectorImpl.java:52)\n\tat sun.nio.ch.EPollSelectorProvider.openSelector(EPollSelectorProvider.java:18)\n\tat java.nio.channels.Selector.open(Selector.java:209)\n\tat org.apache.zookeeper.server.NIOServerCnxnFactory$AbstractSelectThread.<init>(NIOServerCnxnFactory.java:128)\n\tat org.apache.zookeeper.server.NIOServerCnxnFactory$AcceptThread.<init>(NIOServerCnxnFactory.java:177)\n\tat org.apache.zookeeper.server.NIOServerCnxnFactory.configure(NIOServerCnxnFactory.java:663)\n\tat org.apache.zookeeper.server.ServerCnxnFactory.createFactory(ServerCnxnFactory.java:127)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.<init>(QuorumPeer.java:709)\n\tat org.apache.zookeeper.test.QuorumBase.startServers(QuorumBase.java:177)\n\tat org.apache.zookeeper.test.QuorumBase.setUp(QuorumBase.java:113)\n\tat org.apache.zookeeper.test.QuorumBase.setUp(QuorumBase.java:71)\n\tat org.apache.zookeeper.test.ReconfigTest.setUp(ReconfigTest.java:56)\n", "created_at" : { "$date" : "2013-01-15T04:18:52.728+0000" }, "updated_at" : { "$date" : "2013-05-02T02:30:00.257+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52bf5f627d6b0586d784" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52895f627d6b0586d25a" }, "external_id" : "ZOOKEEPER-1411", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "server" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52c05f627d6b0586d7a3" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52c05f627d6b0586d7a2" }, "effect" : "breaks", "type" : "Regression" }, { "issue_id" : { "$oid" : "5b7d52895f627d6b0586d25b" }, "effect" : "breaks", "type" : "Regression" }, { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "parent_issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "created_at" : { "$date" : "2012-03-09T01:02:51.787+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "updated_at" : { "$date" : "2013-05-02T02:30:03.295+0000" }, "title" : "Consolidate membership management, distinguish between static and dynamic configuration parameters", "issue_type" : "Sub-task", "desc" : "Currently every server has a different static configuration file. This patch distinguishes between dynamic parameters, which are now in a separate \"dynamic configuration file\", and static parameters which are in the usual file. The config file points to the dynamic config file by specifying \"dynamicConfigFile=...\". In the first stage (this patch), all cluster membership definitions are in the dynamic config file, but in the future additional parameters may be moved to the dynamic file.\n\nBackward compatibility makes sure that you can still use a single config file if you'd like. Only when the config is changed (once ZK-107 is in) a dynamic file is automatically created and the necessary parameters are moved to it. \n\nThis patch also moves all membership parsing and management into the QuorumVerifier classes, and removes QuorumPeer.quorumPeers.\nThe cluster membership is contained in QuorumPeer.quorumVerifier. QuorumVerifier was expanded and now has methods such as getAllMembers(), getVotingMembers(), getObservingMembers(). \n\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52c25f627d6b0586d800" }, "external_id" : "ZOOKEEPER-1683", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52855f627d6b0586d21b" }, "external_id" : "ZOOKEEPER-1355", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "c client", "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d4fe35f627d6b05868dd1" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52c05f627d6b0586d7a3" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52c25f627d6b0586d800" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d505a5f627d6b0586992c" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a728" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d50ef5f627d6b0586a729" }, "effect" : "supercedes", "type" : "Supercedes" } ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "created_at" : { "$date" : "2012-01-09T22:16:15.307+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "updated_at" : { "$date" : "2013-05-02T02:30:58.801+0000" }, "title" : "Add zk.updateServerList(newServerList) ", "issue_type" : "New Feature", "desc" : "When the set of servers changes, we would like to update the server list stored by clients without restarting the clients.\nMoreover, assuming that the number of clients per server is the same (in expectation) in the old configuration (as guaranteed by the current list shuffling for example), we would like to re-balance client connections across the new set of servers in a way that a) the number of clients per server is the same for all servers (in expectation) and b) there is no excessive/unnecessary client migration.\n\nIt is simple to achieve (a) without (b) - just re-shuffle the new list of servers at every client. But this would create unnecessary migration, which we'd like to avoid.\n\nWe propose a simple probabilistic migration scheme that achieves (a) and (b) - each client locally decides whether and where to migrate when the list of servers changes. The attached document describes the scheme and shows an evaluation of it in Zookeeper. We also implemented re-balancing through a consistent-hashing scheme and show a comparison. We derived the probabilistic migration rules from a simple formula that we can also provide, if someone's interested in the proof.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52c35f627d6b0586d8a7" }, "external_id" : "ZOOKEEPER-1704", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Please add download link for tutorial", "desc" : "There's no obvious way to download the source file other than copy/paste.", "created_at" : { "$date" : "2013-05-09T21:04:22.401+0000" }, "updated_at" : { "$date" : "2013-05-09T21:04:22.401+0000" }, "creator_id" : { "$oid" : "5b7d52c3e9214a0d1608d9ad" }, "reporter_id" : { "$oid" : "5b7d52c3e9214a0d1608d9ad" }, "issue_type" : "New Feature", "priority" : "Trivial", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "http://zookeeper.apache.org/doc/r3.2.2/zookeeperTutorial.html" },
{ "_id" : { "$oid" : "5b7d52c35f627d6b0586d8a8" }, "external_id" : "ZOOKEEPER-1705", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Certain implementations of C's rand() function coupled with the shuffle in libzookeeper_mt's getaddrs() produce a biased distribution of connections.", "desc" : "Using libzookeeper_mt on an unsupported platform (OpenVMS) with a 5 server connection string, the fourth server in the connection string gets selected approximately only 6% of the time. This appears to be due to some strange properties of the LCG used in OpenVMS's C rand() function. Linux does not exhibit this behavior, but I can't speak for Windows, BSD, etc.\n\nIt would be prudent, if libzookeeper_mt's behavior is intended to be the same on every platform it operates on (not that OpenVMS is one of those platforms), to use a PRNG of its own choosing. Integrating a defined PRNG, such as the mersenne twister, would give all platforms the same, correct behavior.", "created_at" : { "$date" : "2013-05-10T18:56:16.867+0000" }, "updated_at" : { "$date" : "2013-05-10T18:56:16.867+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d7" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c45f627d6b0586d8a9" }, "external_id" : "ZOOKEEPER-1593", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add Debian style /etc/default/zookeeper support to init script", "desc" : "In our configuration we use a different data directory for Zookeeper. The problem is that the current Debian init.d script has the default location hardcoded:\n\nZOOPIDDIR=/var/lib/zookeeper/data\nZOOPIDFILE=${ZOOPIDDIR}/zookeeper_server.pid\n\nBy using the standard Debian practice of allowing for a /etc/default/zookeeper we can redefine these variables to point to the correct location:\n\nZOOPIDDIR=/var/lib/zookeeper/data\nZOOPIDFILE=${ZOOPIDDIR}/zookeeper_server.pid\n\n[ -r /etc/default/zookeeper ] && . /etc/default/zookeeper\n\nThis currently can't be done through /usr/libexec/zkEnv.sh, since that is loaded before ZOOPIDDIR and ZOOPIDFILE are set. Any change there would therefore undo the setup made in for example /etc/zookeeper/zookeeper-env.sh.\n\n\n", "created_at" : { "$date" : "2012-11-29T10:55:27.059+0000" }, "updated_at" : { "$date" : "2013-05-10T23:12:26.388+0000" }, "creator_id" : { "$oid" : "5b7d52c4e9214a0d1608d9ae" }, "reporter_id" : { "$oid" : "5b7d52c4e9214a0d1608d9ae" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Debian Linux 6.0" },
{ "_id" : { "$oid" : "5b7d52c55f627d6b0586d8c0" }, "external_id" : "ZOOKEEPER-1700", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "FLETest consistently failing - setLastSeenQuorumVerifier seems to be hanging", "desc" : "I'm consistently seeing a failure on my laptop when running the FLETest \"testJoin\" test. What seems to be happening is that the call to setLastSeenQuorumVerifier is hanging.\n\nSee the following log from the test, notice 17:35:57 for the period in question. Note that I turned on debug logging and added a few log messages around the call to setLastSeenQuorumVerifier (you can see the code enter but never leave)\n\nNote: I've applied ZOOKEEPER-1324 to trunk code and then run this test but that doesn't seem to help. Also note that this test is passing consistently when run against branch-3.4.\n\n{noformat}\n2013-05-07 17:35:57,859 [myid:] - INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:Follower@65] - FOLLOWING - LEADER ELECTION TOOK - 16\n2013-05-07 17:35:57,859 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:Leader@436] - LEADING - LEADER ELECTION TOOK - 17\n2013-05-07 17:35:57,863 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:FileTxnSnapLog@270] - Snapshotting: 0x0 to /home/phunt/dev/zookeeper-trunk/build/test/tmp/test3690487600947307322.junit.dir/version-2/snapshot.0\n2013-05-07 17:35:57,873 [myid:] - INFO  [LearnerHandler-/127.0.0.1:34262:LearnerHandler@269] - Follower sid: 0 : info : 0.0.0.0:11222:11223:participant;0.0.0.0:11221\n2013-05-07 17:35:57,878 [myid:] - INFO  [LearnerHandler-/127.0.0.1:34262:LearnerHandler@328] - Synchronizing with Follower sid: 0 maxCommittedLog=0x0 minCommittedLog=0x0 peerLastZxid=0x0\n2013-05-07 17:35:57,878 [myid:] - DEBUG [LearnerHandler-/127.0.0.1:34262:LearnerHandler@395] - committedLog is empty but leader and follower are in sync, zxid=0x0\n2013-05-07 17:35:57,878 [myid:] - INFO  [LearnerHandler-/127.0.0.1:34262:LearnerHandler@404] - Sending DIFF\n2013-05-07 17:35:57,879 [myid:] - DEBUG [LearnerHandler-/127.0.0.1:34262:LearnerHandler@411] - Sending NEWLEADER message to 0\n2013-05-07 17:35:57,880 [myid:] - INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:Learner@331] - Getting a diff from the leader 0x0\n2013-05-07 17:35:57,885 [myid:] - INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:Learner@457] - Learner received NEWLEADER message\n2013-05-07 17:35:57,885 [myid:] - INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:Learner@460] - NEWLEADER calling configfromstring\n2013-05-07 17:35:57,885 [myid:] - INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:Learner@462] - NEWLEADER setting quorum verifier\n2013-05-07 17:35:57,886 [myid:] - WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:11221:QuorumPeer@1218] - setLastSeenQuorumVerifier called with stale config 0. Current version: 0\n2013-05-07 17:36:01,880 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:Leader@585] - Shutting down\n2013-05-07 17:36:01,881 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:Leader@591] - Shutdown called\njava.lang.Exception: shutdown Leader! reason: Waiting for a quorum of followers, only synced with sids: [ [1] ]\n\tat org.apache.zookeeper.server.quorum.Leader.shutdown(Leader.java:591)\n\tat org.apache.zookeeper.server.quorum.Leader.lead(Leader.java:487)\n\tat org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:949)\n2013-05-07 17:36:01,881 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:ZooKeeperServer@398] - shutting down\n2013-05-07 17:36:01,881 [myid:] - INFO  [LearnerCnxAcceptor-0.0.0.0/0.0.0.0:11225:Leader$LearnerCnxAcceptor@398] - exception while shutting down acceptor: java.net.SocketException: Socket closed\n2013-05-07 17:36:01,882 [myid:] - WARN  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:QuorumPeer@979] - PeerState set to LOOKING\n2013-05-07 17:36:01,882 [myid:] - INFO  [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:QuorumPeer@863] - LOOKING\n2013-05-07 17:36:01,883 [myid:] - DEBUG [QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11224:QuorumPeer@792] - Initializing leader election protocol...\n{noformat}\n", "created_at" : { "$date" : "2013-05-08T00:43:31.978+0000" }, "updated_at" : { "$date" : "2013-05-12T11:09:13.403+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c65f627d6b0586d8db" }, "external_id" : "ZOOKEEPER-767", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Submitting Demo/Recipe Shared / Exclusive Lock Code", "desc" : "Networked Insights would like to share-back some code for shared/exclusive locking that we are using in our labs.", "created_at" : { "$date" : "2010-05-05T20:32:33.168+0000" }, "updated_at" : { "$date" : "2013-05-15T18:20:58.052+0000" }, "creator_id" : { "$oid" : "5b7d52c6e9214a0d1608d9af" }, "reporter_id" : { "$oid" : "5b7d52c6e9214a0d1608d9af" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "recipes" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52c6e9214a0d1608d9af" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c75f627d6b0586d93e" }, "external_id" : "ZOOKEEPER-1709", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Limit the size of txnlog file", "desc" : "The server only create a new log file after ~100k txn. The size of txnlog file can be quite large (> 1GB) if request size is big.\n\nThis will cause the server not to use txnlog to sync with the learner.  \n\nSo we added a parameter so that the server will create a new txnlog file whenever the size exceeded the limit. ", "created_at" : { "$date" : "2013-05-18T01:38:17.446+0000" }, "updated_at" : { "$date" : "2013-05-18T01:40:02.002+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52c75f627d6b0586d93d" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52c85f627d6b0586d940" }, "external_id" : "ZOOKEEPER-1294", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "One of the zookeeper server is not accepting any requests", "desc" : "In zoo.cfg i have configured as\nserver.1 = XX.XX.XX.XX:65175:65173\nserver.2 = XX.XX.XX.XX:65185:65183\nserver.3 = XX.XX.XX.XX:65195:65193\nserver.4 = XX.XX.XX.XX:65205:65203:observer\nserver.5 = XX.XX.XX.XX:65215:65213:observer\nserver.6 = XX.XX.XX.XX:65225:65223:observer\n\nLike above I have configured 3 PARTICIPANTS and 3 OBSERVERS\nin the cluster of 6 zookeepers\n\nSteps to reproduce the defect\n1. Start all the 3 participant zookeeper\n2. Stop all the participant zookeeper\n3. Start zookeeper 1(Participant)\n4. Start zookeeper 2(Participant)\n5. Start zookeeper 4(Observer)\n6. Create a persistent node with external client and close it\n7. Stop the zookeeper 1(Participant neo quorum is unstable)\n8. Create a new client and try to find the node created b4 using exists api (will fail since quorum not statisfied)\n9. Start the Zookeeper 1 (Participant stabilise the quorum)\n\nNow check the observer using 4 letter word (Server.4)\nlinux-216:/home/amith/CI/source/install/zookeeper/zookeeper2/bin # echo stat | netcat localhost 65200\nZookeeper version: 3.3.2-1031432, built on 11/05/2010 05:32 GMT\nClients:\n /127.0.0.1:46370[0](queued=0,recved=1,sent=0)\n\nLatency min/avg/max: 0/0/0\nReceived: 1\nSent: 0\nOutstanding: 0\nZxid: 0x100000003\nMode: observer\nNode count: 5\n\ncheck the participant 2 with 4 letter word\n\nLatency min/avg/max: 22/48/83\nReceived: 39\nSent: 3\nOutstanding: 35\nZxid: 0x100000003\nMode: leader\nNode count: 5\nlinux-216:/home/amith/CI/source/install/zookeeper/zookeeper2/bin #\n\ncheck the participant 1 with 4 letter word\n\nlinux-216:/home/amith/CI/source/install/zookeeper/zookeeper2/bin # echo stat | netcat localhost 65170\nThis ZooKeeper instance is not currently serving requests\n\nWe can see the participant1 logs filled with\n2011-11-08 15:49:51,360 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:65170:NIOServerCnxn@642] - Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running\n\n\nProblem here is participent1 is not responding / accepting any requests", "created_at" : { "$date" : "2011-11-09T09:54:27.642+0000" }, "updated_at" : { "$date" : "2013-05-25T00:17:40.910+0000" }, "creator_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "reporter_id" : { "$oid" : "5b7d512ce9214a0d1608d8f7" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "issue_links" : [  ], "environment" : "3 Zookeeper + 3 Observer with SuSe-11" },
{ "_id" : { "$oid" : "5b7d52c85f627d6b0586d963" }, "external_id" : "ZOOKEEPER-369", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c85f627d6b0586d964" }, "external_id" : "ZOOKEEPER-279", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow specialization of quorum config parsing (e.g. variable expansion in zoo.cfg)", "desc" : "We would like to define certain parts of ZooKeeper's configuration using variables that get substituted. For example, we want the ZooKeeper quorum to be able to use a dataDir configured per user. In other words, something like:\n\ntickTime=2000\ndataDir=/tmp/zookeeper-${user.name}\nclientPort=2181\ninitLimit=5\nsyncLimit=2\nserver.1=zoo1:2888:3888\nserver.2=zoo2:2888:3888\nserver.3=zoo3:2888:3888\n\nI think Java already has a system for configuration that allows something like this using Properties?", "created_at" : { "$date" : "2009-01-26T19:16:04.560+0000" }, "updated_at" : { "$date" : "2013-05-25T03:11:31.810+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Closed", "affects_versions" : [ "3.1.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0", "3.1.1" ], "assignee_id" : { "$oid" : "5b7d502be9214a0d1608d893" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52c85f627d6b0586d963" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52c95f627d6b0586d97f" }, "external_id" : "ZOOKEEPER-974", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Configurable listen socket backlog for the client port", "desc" : "We're running ZooKeeper ensemble(3-node configuration) for production use for months.\nDays ago, we suffered temporary network? problems that caused many reconnections(about 300) of ephemeral nodes in one ZooKeeper server.\n\nThe almost all clients successfully reconnected to the other ZooKeeper servers,\nbut one client failed to reconnect in time and got a session expired message from the server.\n(The problem is that our clients died when they got SessionExpired message.)\n\nThere were many listenQ overflows/drops and out resets in a minute just before the problem situation.\n\n---\n\nSo we patched ZooKeeper to increase the backlog size for the client port socket to avoid unhappy cases like this.\nAs ZooKeeper uses default backlog size(50) to bind(), we added \"clientPortBacklog\" option.\n\nThough the default backlog should be good for common environment,\nwe believe that configuring the size is also meaningful.\n\n[Note]\nOn linux, below parameter :\n\n    net.core.somaxconn\n\nneeds to be larger than above \"clientPortBacklog\"  to correctly configure listen socket backlog", "created_at" : { "$date" : "2011-01-10T08:35:35.169+0000" }, "updated_at" : { "$date" : "2013-05-29T22:00:04.667+0000" }, "creator_id" : { "$oid" : "5b7d52c9e9214a0d1608d9b3" }, "reporter_id" : { "$oid" : "5b7d52c9e9214a0d1608d9b3" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.2" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ca5f627d6b0586d985" }, "external_id" : "ZOOKEEPER-1710", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Leader should not use txnlog for synchronization if txnlog is corrupted or missing", "desc" : "It is possible that a human error caused some txnlog files to be remove from the log dir. \n\nThe leader should not use txnlog to synchronize with the learner if it found that there is a missing log or the file is corrupted. Since this can cause data inconsistency. ", "created_at" : { "$date" : "2013-05-18T01:45:50.738+0000" }, "updated_at" : { "$date" : "2013-05-31T22:52:13.651+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52c75f627d6b0586d93d" }, "effect" : "depends upon", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d52455f627d6b0586ccc2" }, "external_id" : "ZOOKEEPER-1417", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "components" : [ "c client", "java client" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52455f627d6b0586ccc3" }, "effect" : "is related to", "type" : "Reference" } ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "created_at" : { "$date" : "2012-03-15T17:05:23.170+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2013-06-06T17:21:47.463+0000" }, "title" : "investigate differences in client last zxid handling btw c and java clients", "issue_type" : "Bug", "desc" : "In ZOOKEEPER-1412 it was identified that the c and java clients handle updating the last zxid seen a bit differently. ZOOKEEPER-1412 fixed a bug associated with this, however there are still some differences that should be investigated.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52cb5f627d6b0586d99a" }, "external_id" : "ZOOKEEPER-795", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "eventThread isn't shutdown after a connection \"session expired\" event coming", "desc" : "Hi,\n\nI notice a problem with the eventThread located in ClientCnxn.java file.\nThe eventThread isn't shutdown after a connection \"session expired\" event coming (i.e. never receive EventOfDeath).\n\nWhen a session timeout occurs and the session is marked as expired, the connexion is fully closed (socket, SendThread...) expect for the eventThread.\nAs a result, if i create a new zookeeper object and connect through it, I got a zombi thread which will never be kill (as for the previous zookeeper object, the state is already close, calling close again don't do anything).\n\nSo everytime I will create a new zookeeper connection after a expired session, I will have a one more zombi EventThread.\n\nHow to reproduce :\n- Start a zookeeper client connection in debug mode\n- Pause the jvm enough time to the expired event occur\n- Watch for example with jvisualvm the list of threads, the sendThread is succesfully killed, but the EventThread go to wait state for a infinity of time\n- if you reopen a new zookeeper connection, and do again the previous steps, another EventThread will be present in infinite wait state\n\n\n\n\n", "created_at" : { "$date" : "2010-06-28T10:12:26.211+0000" }, "updated_at" : { "$date" : "2013-06-13T18:28:19.759+0000" }, "creator_id" : { "$oid" : "5b7d52cbe9214a0d1608d9b5" }, "reporter_id" : { "$oid" : "5b7d52cbe9214a0d1608d9b5" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.3.2", "3.4.0" ], "assignee_id" : { "$oid" : "5b7d50d0e9214a0d1608d8bd" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52cb5f627d6b0586d999" }, "effect" : "is related to", "type" : "Reference" } ], "environment" : "ubuntu 10.04" },
{ "_id" : { "$oid" : "5b7d52cc5f627d6b0586d9b2" }, "external_id" : "ZOOKEEPER-1538", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Improve space handling in zkServer.sh and zkEnv.sh", "desc" : "Running `bin/zkServer.sh start` from a freshly-built copy of trunk fails if the source code is checked-out to a directory with spaces in the name. I'll include a small fix to fix this problem.\n\nthanks!", "created_at" : { "$date" : "2012-08-22T00:00:11.275+0000" }, "updated_at" : { "$date" : "2013-06-25T18:07:24.546+0000" }, "creator_id" : { "$oid" : "5b7d52c0e9214a0d1608d9ac" }, "reporter_id" : { "$oid" : "5b7d52c0e9214a0d1608d9ac" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52c0e9214a0d1608d9ac" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52b25f627d6b0586d629" }, "external_id" : "ZOOKEEPER-876", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.0" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52b25f627d6b0586d62a" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52c75f627d6b0586d93d" }, "effect" : "is contained by", "type" : "Container" } ], "assignee_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "created_at" : { "$date" : "2010-09-21T13:37:41.281+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d50e0e9214a0d1608d8c4" }, "updated_at" : { "$date" : "2013-07-01T17:28:50.756+0000" }, "title" : "Unnecessary snapshot transfers between new leader and followers", "issue_type" : "Bug", "desc" : "When starting a new leadership, unnecessary snapshot transfers happen between new leader and followers. This is so because of multiple small bugs. \n\n1) the comparison of zxids is done based on a new proposal, instead of the last logged zxid. (LearnerHandler.java ~ 297)\n2) if follower is one zxid behind, the check of the interval of committed logs excludes the follower. (LearnerHandler.java ~ 277)\n3) the bug reported in ZOOKEEPER-874 (commitLogs are empty after recover).", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52ce5f627d6b0586d9f5" }, "external_id" : "ZOOKEEPER-1359", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZkCli create command data and acl parts should be optional.", "desc" : "In zkCli if we create a node without data then also node is getting created but if we will see in the commandMap \nit shows that\n{noformat}\n commandMap.put(\"create\", \"[-s] [-e] path data acl\");\n{noformat}\nthat means data and acl parts are not optional .we need to change these parts as optional.", "created_at" : { "$date" : "2012-01-10T08:46:09.097+0000" }, "updated_at" : { "$date" : "2013-07-01T21:37:13.090+0000" }, "creator_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "reporter_id" : { "$oid" : "5b7d51f7e9214a0d1608d938" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [ "new" ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ce5f627d6b0586da0c" }, "external_id" : "ZOOKEEPER-1428", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create command line tool to utilize the new classes introduced in ZOOKEEPER-271", "desc" : "See discussion entitled 'ZOOKEEPER-1059 Was: Does the rolling-restart.sh script work?' on zookeerper-dev\n\nHBase bin/rolling-restart.sh depends on zkcli returning non-zero exit code for non-existing znode.\nJonathan Hsieh found that rolling-restart.sh no longer works using zookeeper 3.4.x\n\nFrom Patrick Hunt:\n\nI think what we need is to have a tool that's intended for use both\nprogrammatically and by humans, with more strict requirements about\ninput, output formatting and command handling, etc... Please see the\nwork Hartmut has been doing as part of 271 on trunk (3.5.0). Perhaps\nwe can augment these new classes to also support such a tool. However\nit should instead be a true command line tool, rather than a shell.", "created_at" : { "$date" : "2012-03-20T17:01:48.089+0000" }, "updated_at" : { "$date" : "2013-07-08T17:27:23.656+0000" }, "creator_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "reporter_id" : { "$oid" : "5b7d5180e9214a0d1608d912" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "scripts", "java client" ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52cf5f627d6b0586da13" }, "external_id" : "ZOOKEEPER-1723", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "unique ensemble identifier", "desc" : "Zookeeper ensembles need an identifier that would prevent misconfigured zookeeper server from clobbering the configuration of a zookeeper ensemble.\n\nUse case:\n\n- A zookeeper based distributed system that grows its zookeeper ensemble incrementally.\n- The system is reset, where the new zookeeper ensemble is a subset of the old zookeeper ensemble (the history of the new ensemble have been reset too).\n- The old zookeeper servers will attempt to communicate with the new servers (assuming the network end-points remain the same).\n- The new zookeeper servers will notice that the old zookeeper servers have a higher configuration version and will attempt to reconfigure based on the old ensemble configuration info.\n\nNote that this can be solved if the reset process would stop every zookeeper server in the old deployment and delete its history. However, some of these servers might be down at the time of reset, therefore this solution is not reliable.\n\nI am sure this is not the most generic description of the problem of not having ensemble identifiers, but it presents a use case for introducing them to prevent servers from cross-talking across different ensembles. Otherwise they will automatically join in to form a single ensemble.", "created_at" : { "$date" : "2013-07-08T20:46:18.905+0000" }, "updated_at" : { "$date" : "2013-07-08T20:46:18.905+0000" }, "creator_id" : { "$oid" : "5b7d52cfe9214a0d1608d9b9" }, "reporter_id" : { "$oid" : "5b7d52cfe9214a0d1608d9b9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d05f627d6b0586da14" }, "external_id" : "ZOOKEEPER-1678", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Server fails to join quorum when a peer is unreachable (5 ZK server setup)", "desc" : "In a 5-node ZK cluster setup, in the following state:\n* 1 host is down / not reachable.\n* 4 hosts are up.\n* 3 ZK servers are in quorum.\n* a 4th ZK server was restarted and is trying to re-join the quorum.\n\nThe 4th server is not able to rejoin the quorum because the connection to the host that is not established, and apparently takes to long to timeout.\n\nStack traces and additional information coming.", "created_at" : { "$date" : "2013-03-29T00:19:02.671+0000" }, "updated_at" : { "$date" : "2013-07-09T09:43:18.630+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9ba" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9ba" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "leaderElection" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51505f627d6b0586add3" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "java version \"1.6.0_32\"\nJava(TM) SE Runtime Environment (build 1.6.0_32-b05)\nJava HotSpot(TM) 64-Bit Server VM (build 20.7-b02, mixed mode)\n\nDistributor ID:\tUbuntu\nDescription:\tUbuntu 12.04.1 LTS\nRelease:\t12.04\nCodename:\tprecise\n\nuname -a Linux ha-vani3-0 3.2.0-23-virtual #36-Ubuntu SMP Tue Apr 10 22:29:03 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux" },
{ "_id" : { "$oid" : "5b7d52d05f627d6b0586da1e" }, "external_id" : "ZOOKEEPER-1721", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ability to run without writing to disk", "desc" : "I use zookeeper for cluster synchronization. We have no need for keeping persistent state across zookeeper restarts. For performance enhancement would be good to have possibility to run without writing snapshots and logs.", "created_at" : { "$date" : "2013-07-06T15:51:01.349+0000" }, "updated_at" : { "$date" : "2013-07-09T15:46:42.762+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bb" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bb" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d25f627d6b0586da20" }, "external_id" : "ZOOKEEPER-1726", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "No way to dynamically go from 1 ZK server -> 2 ZK servers?", "desc" : "The dynamic reconfiguration feature is great.  But it doesn't seem to be possible to go from 1 server to 2 servers (1 server + 1 observer).  When there's only one server, ZK automatically starts in single server mode; when in single server mode trying to add a server causes a class cast exception because the server is a ZooKeeperServer, not a LeaderZooKeeperServer.", "created_at" : { "$date" : "2013-07-13T00:45:39.630+0000" }, "updated_at" : { "$date" : "2013-07-13T00:53:51.058+0000" }, "creator_id" : { "$oid" : "5b7d52d2e9214a0d1608d9bd" }, "reporter_id" : { "$oid" : "5b7d52d2e9214a0d1608d9bd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d25f627d6b0586da24" }, "external_id" : "ZOOKEEPER-1727", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Doc request: The right way to expand a cluster", "desc" : "When expanding a cluster from 2->3, if ZK server #3 isn't up yet, then it seems that the reconfig request times out with a connection-loss error.  The configuration is updated though.  So we could wait, reconnect, and then refetch the config to make sure we did join the quorum, though that seems a little bit hacky!\n\nWhat is correct way to do this (and cluster growth in general)?  Should we bring up new ZK servers before issuing the reconfig command?  What is the right way to bring up new ZK servers (connect as a client, request the config, save the config to the zk.conf.dynamic file, add our new server line to the new zk.conf.dynamic file, start the new server, call reconfig as a client to the existing cluster)?\n\nIs this documented anywhere? (Just the steps to do it \"the right way\" would be great, no need for actual code) :-)", "created_at" : { "$date" : "2013-07-13T01:31:25.607+0000" }, "updated_at" : { "$date" : "2013-07-13T19:58:10.013+0000" }, "creator_id" : { "$oid" : "5b7d52d2e9214a0d1608d9bd" }, "reporter_id" : { "$oid" : "5b7d52d2e9214a0d1608d9bd" }, "issue_type" : "Wish", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52c05f627d6b0586d7a3" }, "effect" : "is contained by", "type" : "Container" } ] },
{ "_id" : { "$oid" : "5b7d52d35f627d6b0586da2d" }, "external_id" : "ZOOKEEPER-1722", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make ZooKeeper clients more test friendly", "desc" : "We should be able to expose a few more API calls that allow user write unit tests that cover various failure scenarios (similar to the TestableZookeer in zookeeper test). This should also minimize the effort on setting the test framework for application developer\n\nHere is some example calls that we should provide.\n1. zookeeper_close() that don't actually send close request to the server:     This can be used to simulate a client crash without actually crashing the test program.\n2. Allow client to trigger CONNECTION_LOSS or SESSSION_EXPIRE event: This will allow the user to test their watchers and callback (and possible race condition)", "created_at" : { "$date" : "2013-07-08T17:57:01.348+0000" }, "updated_at" : { "$date" : "2013-07-16T03:45:39.671+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client", "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d45f627d6b0586da35" }, "external_id" : "ZOOKEEPER-1314", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve zkpython synchronous api implementation", "desc" : "Improves the following items in zkpython which are related to the Zookeeper synchronous API:\n\n# For pyzoo_create, no longer limit the returned znode name to 256 bytes; dynamically allocate memory on the heap.\n# For all the synchronous api calls, release the Python Global Interpreter Lock just before doing the synchronous call.\n\nI will attach the patch shortly.\n", "created_at" : { "$date" : "2011-12-01T21:53:24.657+0000" }, "updated_at" : { "$date" : "2013-07-26T18:21:30.981+0000" }, "creator_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "reporter_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.3.3" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d523ae9214a0d1608d958" }, "issue_links" : [  ], "original_time_estimate" : 1800 },
{ "_id" : { "$oid" : "5b7d52d45f627d6b0586da44" }, "external_id" : "ZOOKEEPER-1392", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Should not allow to read ACL when not authorized to read node", "desc" : "Not authorized to read, yet still able to list ACL:\n\n[zk: localhost:2181(CONNECTED) 0] getAcl /sasltest/n4\n'sasl,'notme@EXAMPLE.COM\n: cdrwa\n[zk: localhost:2181(CONNECTED) 1] get /sasltest/n4\nException in thread \"main\" org.apache.zookeeper.KeeperException$NoAuthException: KeeperErrorCode = NoAuth for /sasltest/n4\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:113)\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n\tat org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:1131)\n\tat org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:1160)\n\tat org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:711)\n\tat org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:593)\n\tat org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:365)\n\tat org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:323)\n\tat org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:282)\n", "created_at" : { "$date" : "2012-02-13T01:45:05.093+0000" }, "updated_at" : { "$date" : "2013-08-06T06:19:15.056+0000" }, "creator_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "reporter_id" : { "$oid" : "5b7d5225e9214a0d1608d94e" }, "issue_type" : "Bug", "priority" : "Major", "status" : "In Progress", "affects_versions" : [ "3.4.2" ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d52d4e9214a0d1608d9be" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d55f627d6b0586da55" }, "external_id" : "ZOOKEEPER-1739", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "thread safe bug in FastLeaderElection: instance of WorkerSender is not safe published, WorkerSender thread may see that WorkerSender.manager is the default value null", "desc" : "I am reading the trunk source code recently and find a thread-safe problem, but i'm not quite sure.\n\nin FastLeaderElection:\n\n{code}\nclass WorkerSender implements Runnable { \n    volatile boolean stop; \n    QuorumCnxManager manager; \n\n    WorkerSender(QuorumCnxManager manager){ \n        this.stop = false; \n        this.manager = manager; \n    } \n\n    public void run() {\n ...\n    }\n}\n\n...\n\nMessenger(QuorumCnxManager manager) {\n\n    this.ws = new WorkerSender(manager);\n\n    Thread t = new Thread(this.ws,\n            \"WorkerSender[myid=\" + self.getId() + \"]\");\n    t.setDaemon(true);\n    t.start();\n\n    this.wr = new WorkerReceiver(manager);\n\n    t = new Thread(this.wr,\n            \"WorkerReceiver[myid=\" + self.getId() + \"]\");\n    t.setDaemon(true);\n    t.start();\n}\n...\n{code}\n\nThe instance of WorkerSender is constructed in main thread, and its field manager is assigned , and it is used in another thread. The later thread may see that WorkerSender.manager is the default value null. The solution may be:\n(1) change\n{code} \nWorkerSender(QuorumCnxManager manager){ \n        this.stop = false; \n        this.manager = manager; \n} \n{code}\n\nto \n\n{code}\nWorkerSender(QuorumCnxManager manager){ \n\tthis.manager = manager; \n\tthis.stop = false; \n} \n{code}\n\nor(2)\nchange \n\n{code}\nQuorumCnxManager manager; \n{code}\n\nto \n\n{code}\nfinal QuorumCnxManager manager;\n{code}", "created_at" : { "$date" : "2013-08-09T04:29:19.800+0000" }, "updated_at" : { "$date" : "2013-08-11T03:01:38.096+0000" }, "creator_id" : { "$oid" : "5b7d52d5e9214a0d1608d9c1" }, "reporter_id" : { "$oid" : "5b7d52d5e9214a0d1608d9c1" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [ "leaderElection" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d52d5e9214a0d1608d9c1" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d65f627d6b0586da5c" }, "external_id" : "ZOOKEEPER-1735", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Make ZooKeeper easier to test - support simulating a connection loss", "desc" : "As part of making ZooKeeper clients more test friendly, it would be useful to easily simulate a connection loss event", "created_at" : { "$date" : "2013-07-22T21:51:21.113+0000" }, "updated_at" : { "$date" : "2013-08-13T07:28:07.559+0000" }, "creator_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "reporter_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52d65f627d6b0586da5b" }, "effect" : "depends upon", "type" : "Dependent" } ], "parent_issue_id" : { "$oid" : "5b7d52d35f627d6b0586da2d" } },
{ "_id" : { "$oid" : "5b7d52d75f627d6b0586da62" }, "external_id" : "ZOOKEEPER-1400", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Allow logging via callback instead of raw FILE pointer", "desc" : "The existing logging framework inside the C client uses a raw FILE*. Using a FILE* is very limiting and potentially dangerous. A safer alternative is to just provide a callback that the C client will call for each message. In our environment, we saw some really nasty issues with multiple threads all connecting to zookeeper via the C Client related to the use of a raw FILE*. Specifically, if the FILE * is closed and that file descriptor is reused by the kernel before the C client is notified then the C client will use it's static global logStream pointer for subsequent logging messages. That FILE* is now a loose cannon! In our environment, we saw zookeeper log messages ending up in other sockets and even in our core data path. Clearly this is dangerous. In our particular case, we'd omitted a call to zoo_set_log_stream(NULL) to notify C client that the FILE* has been closed. However, even with that bug fixed, there's still a race condition where log messages in flight may be sent before the C client is notified of the FILE closure, and the same problem can happen.\n\nOther issues we've seen involved multiple threads, wherein one would close the FILE*, and that's a global change that affects all threads connected within that process. That's a pretty nasty limitation as well.\n\nMy proposed change is to allow setting a callback for log messages. A callback is used in preference to a raw FILE*. If no callback is set, then it will fallback to the existing FILE*. If that's not set, then it falls back to stderr as it always has.\n\nWhile refactoring this code, I removed the need for the double parens in all the LOG macros as that wasn't necessary and didn't fit with my new approach.\n", "created_at" : { "$date" : "2012-02-23T22:18:34.308+0000" }, "updated_at" : { "$date" : "2013-08-21T11:06:45.431+0000" }, "creator_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "reporter_id" : { "$oid" : "5b7d5140e9214a0d1608d8fb" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ], "environment" : "Linux" },
{ "_id" : { "$oid" : "5b7d52d85f627d6b0586dabb" }, "external_id" : "ZOOKEEPER-1679", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "c client: use -Wdeclaration-after-statement", "desc" : "Visual studio still doesn't support c99.\n\n--Michi", "created_at" : { "$date" : "2013-03-29T19:34:51.509+0000" }, "updated_at" : { "$date" : "2013-08-21T11:06:45.642+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d85f627d6b0586daca" }, "external_id" : "ZOOKEEPER-580", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Document reasonable limits on the size and shape of data for a zookeeper ensemble.", "desc" : "I would like to have documentation which clarifies the reasonable limits on the size and shape of data in a zookeeper ensemble.  Since all zookeeper nodes and their data are replicated on each peer in an ensemble, there will be a machine limit on the amount of data in a zookeeper instance, but I have not seen any guidance on the estimation of that machine limit.  Presumably the machine limits are primarily determined by the amount of heap available to the JVM before swapping sets in, however there might well be other limits which are less obvious in terms of the #of children per node and the depth of the node hierarchy (in addition to the already documented limit on the amount of data in a node).  There may also be interactions with the hierarchy depth and performance, which I have not seen detailed anywhere.\n\nGuidance regarding pragmatic and machine limits would be helpful is choosing designs using zookeeper which can scale.  For example, if metadata about each shard of a partitioned database architecture is mapped onto a distinct znode in zookeeper, then there could be an very large number of znodes for a large database deployment.   While this would make it easy to reassign shards to services dynamically, the design might impose an unforeseen limit on the #of shards in the database.  A similar concern would apply to an attempt to maintain metadata about each file in a distributed file system.\n\nIssue [ZOOKEEPER-272] described some problems when nodes have a large number #of children.  However, it did not elaborate on whether the change to an Iterator model would break the atomic semantics of the List<String> of children or if the Iterator would be backed by a snapshot of the children as it existed at the time the iterator was requested, which would put a memory burden on the ensemble.  This raises the related question of when designs which work around scaling limits in zookeeper might break desirable semantics, primarily the ability to have a consistent view of the distributed state.\n\nPut another way, are there anti-patterns for zookeeper relating to scalability?  Too many children?  Too much depth?  Avoid decomposing large numbers of children into hierarchies?  Etc.", "created_at" : { "$date" : "2009-11-17T15:54:03.710+0000" }, "updated_at" : { "$date" : "2013-08-21T16:55:00.771+0000" }, "creator_id" : { "$oid" : "5b7d4fe8e9214a0d1608d88e" }, "reporter_id" : { "$oid" : "5b7d4fe8e9214a0d1608d88e" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52d95f627d6b0586dacd" }, "external_id" : "ZOOKEEPER-1367", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Data inconsistencies and unexpired ephemeral nodes after cluster restart", "desc" : "In one of our tests, we have a cluster of three ZooKeeper servers.  We kill all three, and then restart just two of them.  Sometimes we notice that on one of the restarted servers, ephemeral nodes from previous sessions do not get deleted, while on the other server they do.  We are effectively running 3.4.2, though technically we are running 3.4.1 with the patch manually applied for ZOOKEEPER-1333 and a C client for 3.4.1 with the patches for ZOOKEEPER-1163.\n\nI noticed that when I connected using zkCli.sh to the first node (90.0.0.221, zkid 84), I saw only one znode in a particular path:\n\n{quote}\n[zk: 90.0.0.221:2888(CONNECTED) 0] ls /election/zkrsm\n[nominee0000000011]\n[zk: 90.0.0.221:2888(CONNECTED) 1] get /election/zkrsm/nominee0000000011\n90.0.0.222:7777 \ncZxid = 0x400000027\nctime = Thu Jan 19 08:18:24 UTC 2012\nmZxid = 0x400000027\nmtime = Thu Jan 19 08:18:24 UTC 2012\npZxid = 0x400000027\ncversion = 0\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0xa234f4f3bc220001\ndataLength = 16\nnumChildren = 0\n{quote}\n\nHowever, when I connect zkCli.sh to the second server (90.0.0.222, zkid 251), I saw three znodes under that same path:\n\n{quote}\n[zk: 90.0.0.222:2888(CONNECTED) 2] ls /election/zkrsm\nnominee0000000006   nominee0000000010   nominee0000000011\n[zk: 90.0.0.222:2888(CONNECTED) 2] get /election/zkrsm/nominee0000000011\n90.0.0.222:7777 \ncZxid = 0x400000027\nctime = Thu Jan 19 08:18:24 UTC 2012\nmZxid = 0x400000027\nmtime = Thu Jan 19 08:18:24 UTC 2012\npZxid = 0x400000027\ncversion = 0\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0xa234f4f3bc220001\ndataLength = 16\nnumChildren = 0\n[zk: 90.0.0.222:2888(CONNECTED) 3] get /election/zkrsm/nominee0000000010\n90.0.0.221:7777 \ncZxid = 0x30000014c\nctime = Thu Jan 19 07:53:42 UTC 2012\nmZxid = 0x30000014c\nmtime = Thu Jan 19 07:53:42 UTC 2012\npZxid = 0x30000014c\ncversion = 0\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0xa234f4f3bc220000\ndataLength = 16\nnumChildren = 0\n[zk: 90.0.0.222:2888(CONNECTED) 4] get /election/zkrsm/nominee0000000006\n90.0.0.223:7777 \ncZxid = 0x200000cab\nctime = Thu Jan 19 08:00:30 UTC 2012\nmZxid = 0x200000cab\nmtime = Thu Jan 19 08:00:30 UTC 2012\npZxid = 0x200000cab\ncversion = 0\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0x5434f5074e040002\ndataLength = 16\nnumChildren = 0\n{quote}\n\nThese never went away for the lifetime of the server, for any clients connected directly to that server.  Note that this cluster is configured to have all three servers still, the third one being down (90.0.0.223, zkid 162).\n\nI captured the data/snapshot directories for the the two live servers.  When I start single-node servers using each directory, I can briefly see that the inconsistent data is present in those logs, though the ephemeral nodes seem to get (correctly) cleaned up pretty soon after I start the server.\n\nI will upload a tar containing the debug logs and data directories from the failure.  I think we can reproduce it regularly if you need more info.", "created_at" : { "$date" : "2012-01-20T18:48:01.113+0000" }, "updated_at" : { "$date" : "2013-08-28T22:20:04.065+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.4.2" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.3", "3.3.5", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ], "environment" : "Debian Squeeze, 64-bit" },
{ "_id" : { "$oid" : "5b7d52da5f627d6b0586db3d" }, "external_id" : "ZOOKEEPER-1717", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Flex code works in debug mode , not in run mode", "desc" : "In my flex application , when i debug the code it's giving the correct result. but , if i run in run mode it's not giving correct result. I tried to know what's happening .but , i didn't get anything.  Could you please give me some suggestions ?\n", "created_at" : { "$date" : "2013-06-14T15:22:14.207+0000" }, "updated_at" : { "$date" : "2013-09-01T13:27:08.822+0000" }, "creator_id" : { "$oid" : "5b7d52dae9214a0d1608d9c5" }, "reporter_id" : { "$oid" : "5b7d52dae9214a0d1608d9c5" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "4.0.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [ "4.0.0" ], "issue_links" : [  ], "original_time_estimate" : 43200 },
{ "_id" : { "$oid" : "5b7d52db5f627d6b0586db3f" }, "external_id" : "ZOOKEEPER-1531", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc.", "desc" : "Small doc fix.", "created_at" : { "$date" : "2012-08-09T23:13:19.898+0000" }, "updated_at" : { "$date" : "2013-09-03T06:53:56.089+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52db5f627d6b0586db44" }, "external_id" : "ZOOKEEPER-1530", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc.", "desc" : "Small doc fix.", "created_at" : { "$date" : "2012-08-09T23:13:00.671+0000" }, "updated_at" : { "$date" : "2013-09-03T06:54:15.060+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52dc5f627d6b0586db47" }, "external_id" : "ZOOKEEPER-1529", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc.", "desc" : "Correct the documentation of the args for the JavaExample doc.", "created_at" : { "$date" : "2012-08-09T20:51:59.865+0000" }, "updated_at" : { "$date" : "2013-09-03T06:54:38.690+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52dc5f627d6b0586db4a" }, "external_id" : "ZOOKEEPER-1528", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc.", "desc" : "I added another listitem documenting the filename arg of the JavaExample code.", "created_at" : { "$date" : "2012-08-09T20:50:55.269+0000" }, "updated_at" : { "$date" : "2013-09-03T06:55:01.282+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52dd5f627d6b0586db4d" }, "external_id" : "SOLR-2369", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52dd5f627d6b0586db4e" }, "external_id" : "ZOOKEEPER-1371", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52355f627d6b0586cb64" }, "external_id" : "ZOOKEEPER-850", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "java client" ], "fix_versions" : [ "3.4.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52dd5f627d6b0586db4e" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52dd5f627d6b0586db4d" }, "effect" : "blocks", "type" : "Blocker" } ], "assignee_id" : { "$oid" : "5b7d5187e9214a0d1608d916" }, "created_at" : { "$date" : "2010-08-16T12:49:18.039+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5187e9214a0d1608d916" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d5187e9214a0d1608d916" }, "updated_at" : { "$date" : "2013-09-10T20:10:16.246+0000" }, "title" : "Switch from log4j to slf4j", "issue_type" : "Improvement", "desc" : "Hello,\n\ni would like to see slf4j integrated into the zookeeper instead of relying explicitly on log4j.\n\nslf4j is an abstract logging framework. There are adapters from slf4j to many logger implementations, one of them is log4j.\n\nThe decision which log engine to use i dont like to make so early.\n\nThis would help me to embed zookeeper in my own applications (which use a different logger implemenation, but slf4j is the basis)\n\nWhat do you think?\n\n(as i can see, those slf4j request flood all other projects on apache as well :-)\n\nMaybe for 3.4 or 4.0?\n\nI can offer a patchset, i have experience in such an migration already. :-)", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52de5f627d6b0586dbb4" }, "external_id" : "ZOOKEEPER-1664", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Kerberos auth doesn't work with native platform GSS integration", "desc" : "Java on Linux/Solaris can be set up to use the native (via C library)\nGSS implementation. This is configured by setting the system property\n   sun.security.jgss.native=true\nWhen using this feature, ZooKeeper Sasl/JGSS authentication doesn't work.\nThe reason is explained in\nhttp://docs.oracle.com/javase/6/docs/technotes/guides/security/jgss/jgss-features.html\n\n\"\"\"\n[when using native GSS...]\nIn addition, when performing operations as a particular Subject, e.g. \nSubject.doAs(...) or Subject.doAsPrivileged(...), the to-be-used \nGSSCredential should be added to Subject's private credential set. \nOtherwise, the GSS operations will fail since no credential is found.\n\"\"\"", "created_at" : { "$date" : "2013-03-13T18:58:01.080+0000" }, "updated_at" : { "$date" : "2013-09-11T22:00:36.716+0000" }, "creator_id" : { "$oid" : "5b7d52dee9214a0d1608d9c9" }, "reporter_id" : { "$oid" : "5b7d52dee9214a0d1608d9c9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [ "server", "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux (and likely also Solaris)." },
{ "_id" : { "$oid" : "5b7d52df5f627d6b0586dbc8" }, "external_id" : "ZOOKEEPER-1747", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper server fails to start if transaction log file is corrupted", "desc" : "On multiple occasions when ZK was not able to write out a transaction log or a snapshot file, the consequent attempt to restart the server fails. Usually it happens when the underlying file system filled up; thus, preventing ZK server from writing out consistent data file.\n\nUpon start-up, the server reads in the snapshot and the transaction log. If the deserializer fails and throws an exception, server terminates. Please see the stack trace below.\n\nServer not coming up for whatever reason is often an undesirable condition. It would be nice to have an option to force-ignore parsing errors, especially, in the transaction log. A check sum on the data could be a possible solution to ensure the integrity and \"parsability\".\n\nAnother robustness enhancement could be via proper handling of the condition when snapshot or transaction log cannot be completely written to disk. Basically, better handling of write errors.\n\n\n{noformat}\n2013-08-28 12:05:30,732 ERROR [ZooKeeperServerMain] Unexpected exception, exiting abnormally\njava.io.EOFException\n        at java.io.DataInputStream.readInt(DataInputStream.java:375)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.persistence.FileHeader.deserialize(FileHeader.java:64)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.inStreamCreated(FileTxnLog.java:558)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.createInputArchive(FileTxnLog.java:577)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.goToNextLog(FileTxnLog.java:543)\n        at org.apache.zookeeper.server.persistence.FileTxnLog$FileTxnIterator.next(FileTxnLog.java:625)\n        at org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:160)\n        at org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:223)\n        at org.apache.zookeeper.server.ZooKeeperServer.loadData(ZooKeeperServer.java:250)\n        at org.apache.zookeeper.server.ZooKeeperServer.startdata(ZooKeeperServer.java:383)\n        at org.apache.zookeeper.server.NIOServerCnxnFactory.startup(NIOServerCnxnFactory.java:122)\n        at org.apache.zookeeper.server.ZooKeeperServerMain.runFromConfig(ZooKeeperServerMain.java:112)\n        at org.apache.zookeeper.server.ZooKeeperServerMain.initializeAndRun(ZooKeeperServerMain.java:86)\n        at org.apache.zookeeper.server.ZooKeeperServerMain.main(ZooKeeperServerMain.java:52)\n        at org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:129)\n        at org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)\n{noformat}", "created_at" : { "$date" : "2013-08-29T14:04:29.941+0000" }, "updated_at" : { "$date" : "2013-09-12T15:06:54.122+0000" }, "creator_id" : { "$oid" : "5b7d52dfe9214a0d1608d9ca" }, "reporter_id" : { "$oid" : "5b7d52dfe9214a0d1608d9ca" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Solaris10/x86, Java 1.6" },
{ "_id" : { "$oid" : "5b7d52df5f627d6b0586dbcf" }, "external_id" : "ZOOKEEPER-1375", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "SendThread is exiting after OOMError", "desc" : "After reviewing the ClientCnxn code, there is still chances of exiting the SendThread without intimating the users. Say if client throws OOMError and entered into the throwable block. Here again while sending the Disconnected event, its creating \"new WatchedEvent()\" object.This will throw OOMError and leads to exit the SendThread without any Disconnected event notification.\n\n{noformat}\ntry{\n    //...\n} catch (Throwable e)\n{\n    //..\n    cleanup();\n   if(state.isAlive()){\n        eventThread.queueEvent(\n        new WatchedEvent(Event.EventType.None, Event.KeeperState.Disconnected, null) )\n   }\n   //....\n}\n{noformat}", "created_at" : { "$date" : "2012-01-25T08:43:26.069+0000" }, "updated_at" : { "$date" : "2013-09-12T22:47:57.367+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e05f627d6b0586dbd9" }, "external_id" : "ZOOKEEPER-1757", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Adler32 may not be sufficient to protect against data corruption", "desc" : "I was investigating data inconsistency bug in our internal branch. One possible area is snapshot/txnlog corruption. So I wrote a more robust corruption test and found that it is easy to break our checksum algorithm which is Adler32.\n\nWhen this happen, it is more likely that corrupted data will fail other sanity check during deserialization phase, but it is still scary that it can pass the checksum.", "created_at" : { "$date" : "2013-09-12T23:57:15.995+0000" }, "updated_at" : { "$date" : "2013-09-14T02:04:25.973+0000" }, "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux.  Oracle JDK6/7" },
{ "_id" : { "$oid" : "5b7d52e15f627d6b0586dbea" }, "external_id" : "ZOOKEEPER-1761", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Expose 'check' version api in ZooKeeper client", "desc" : "Implement ZooKeeper#check api", "created_at" : { "$date" : "2013-09-22T23:05:48.852+0000" }, "updated_at" : { "$date" : "2013-09-25T09:42:24.086+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d52e15f627d6b0586dbe9" } },
{ "_id" : { "$oid" : "5b7d52e25f627d6b0586dbf0" }, "external_id" : "ZOOKEEPER-1762", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Implement 'check' version cli command", "created_at" : { "$date" : "2013-09-23T00:01:17.044+0000" }, "updated_at" : { "$date" : "2013-09-25T09:43:03.610+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Won't Fix", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d52e15f627d6b0586dbe9" } },
{ "_id" : { "$oid" : "5b7d52e15f627d6b0586dbe9" }, "external_id" : "ZOOKEEPER-1760", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "java client" ], "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "created_at" : { "$date" : "2013-09-22T23:02:04.471+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "resolution" : "Won't Fix", "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "updated_at" : { "$date" : "2013-09-25T09:44:09.389+0000" }, "title" : "Provide an interface for check version of a node", "issue_type" : "New Feature", "desc" : "The idea of this JIRA is to discuss the check version interface which is used to see the existence of a node for the specified version. Presently only multi transaction api has this interface, this umbrella JIRA is to make 'check version' api part of ZooKeeper# main apis and cli command.\n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52e35f627d6b0586dc08" }, "external_id" : "ZOOKEEPER-1764", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52385f627d6b0586cba4" }, "external_id" : "ZOOKEEPER-1455", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52385f627d6b0586cba5" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52755f627d6b0586d0fc" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52e35f627d6b0586dc07" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52685f627d6b0586cf57" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d524d5f627d6b0586cd41" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52e35f627d6b0586dc08" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "created_at" : { "$date" : "2012-04-26T17:12:58.223+0000" }, "updated_at" : { "$date" : "2013-09-25T09:53:51.662+0000" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "priority" : "Critical", "title" : "there is no way to determine if a session is sasl authenticated or not", "issue_type" : "Bug", "desc" : "The ZooKeeper interface provides no way to determine if the session is sasl authenticated or not. There is an event sent to the watcher when the sasl authentication completes, however there no way to determine if there is intent to negotiate via sasl. As a result the event cannot be used to wait to send messages until the authentication has completed. see HADOOP-8315", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d52e45f627d6b0586dc12" }, "external_id" : "ZOOKEEPER-1510", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Should not log SASL errors for non-secure usage", "desc" : "Since SASL support was added, all connections with non-secure clients have started logging messages like:\n\n2012-07-01 02:13:34,986 WARN org.apache.zookeeper.client.ZooKeeperSaslClient: SecurityException: java.lang.SecurityException: Unable to locate a login configuration occurred when trying to find JAAS configuration.\n2012-07-01 02:13:34,986 INFO org.apache.zookeeper.client.ZooKeeperSaslClient: Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.\n\nDespite the \"you may ignore this\" qualifier, I've seen a lot of users confused by this message. Instead, it would be better to either log at DEBUG level, or piggy back the SASL information onto the \"Opening socket connection\" message (eg \"Opening socket connection to X:2181. Will not use SASL because no configuration was located.\")", "created_at" : { "$date" : "2012-07-16T19:45:23.639+0000" }, "updated_at" : { "$date" : "2013-09-25T16:00:02.143+0000" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.3" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52e45f627d6b0586dc11" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d237" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52e45f627d6b0586dc26" }, "external_id" : "ZOOKEEPER-337", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "improve logging in leader election lookForLeader method when address resolution fails", "desc" : "leader election has the following code:\n\n                requestPacket.setSocketAddress(server.addr);\n                LOG.info(\"Server address: \" + server.addr);\n\nthis should be switched to have the info log first, set sock addr second.\n\nThe reason for this is that if the setSocketAddress fails SUN is not printing the address used. As a result it's verify difficult to debug this issue.\n\nIf we log the server address first, then if the setSockAddress fails we'll see both the address of the server and the exception detail (right now we just see the exception detail which does not include the invlaid address in invalidAddressException).\n", "created_at" : { "$date" : "2009-03-17T17:11:03.564+0000" }, "updated_at" : { "$date" : "2013-09-26T22:34:46.022+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Closed", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.2.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e55f627d6b0586dc45" }, "external_id" : "ZOOKEEPER-1737", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zk scripts no longer work when symlinked", "desc" : "At some point since 3.3, the shell scripts were updated to move away from using readlink to using BASH_SOURCE.  The problem is that BASH_SOURCE doesn't resolve symlinks so when /usr/bin/zookeeper-cli is symlinked to /usr/lib/zookeeper/bin/zkCli.sh it fails every single time.\n\n", "created_at" : { "$date" : "2013-08-05T19:12:28.975+0000" }, "updated_at" : { "$date" : "2013-10-01T00:14:52.051+0000" }, "creator_id" : { "$oid" : "5b7d52e5e9214a0d1608d9cf" }, "reporter_id" : { "$oid" : "5b7d52e5e9214a0d1608d9cf" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Patch Available", "affects_versions" : [ "3.4.5" ], "components" : [ "scripts" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d52e5e9214a0d1608d9cf" }, "issue_links" : [  ], "environment" : "RHEL6.4" },
{ "_id" : { "$oid" : "5b7d52e65f627d6b0586dc4d" }, "external_id" : "ZOOKEEPER-1769", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZooInspector can't display node data/metadata/ACLs", "desc" : "There seem to be a few bugs in the trunk that prevent ZooInspector to load the node viewers ( the 3 tabs in the main windows when you select a ZK node in the tree don't show up any more ).\nApparently it has been introduced 2 years ago after a refactoring about icons and another about partially fixing a typo (\"veiwer\" -> \"viewer\").\n\nNote: the bug is only in trunk, 3.4 is fine.", "created_at" : { "$date" : "2013-09-29T17:12:17.041+0000" }, "updated_at" : { "$date" : "2013-10-01T11:11:23.511+0000" }, "creator_id" : { "$oid" : "5b7d52e6e9214a0d1608d9d0" }, "reporter_id" : { "$oid" : "5b7d52e6e9214a0d1608d9d0" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "contrib" ], "labels" : [ "patch" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52e6e9214a0d1608d9d0" }, "issue_links" : [  ], "environment" : "Ubuntu" },
{ "_id" : { "$oid" : "5b7d52e75f627d6b0586dc59" }, "external_id" : "ZOOKEEPER-1670", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper should set a default value for SERVER_JVMFLAGS and CLIENT_JVMFLAGS so that memory usage is controlled", "desc" : "We noticed this with jdk 1.6 where if no heap size is set the process takes up to 1/4 of mem available on the machine.\n\nMore info http://stackoverflow.com/questions/3428251/is-there-a-default-xmx-setting-for-java-1-5\n\nYou can run the following command to see what are the defaults for your machine\n\n{code}\njava -XX:+PrintFlagsFinal -version 2>&1 | grep -i -E 'heapsize|permsize|version'\n{code}\n\nAnd we noticed on two different class of machines that this was 1/4th of total memory on the machine.", "created_at" : { "$date" : "2013-03-15T21:36:54.765+0000" }, "updated_at" : { "$date" : "2013-10-01T21:32:01.867+0000" }, "creator_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "reporter_id" : { "$oid" : "5b7d5280e9214a0d1608d98d" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e75f627d6b0586dc8c" }, "external_id" : "ZOOKEEPER-1772", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "config.guess downgraded from timestamp='2012-02-10' in 3.3.x to timestamp='2005-07-08' in 3.4.x", "desc" : "Was this intentional?  If so, why?", "created_at" : { "$date" : "2013-10-01T13:43:13.925+0000" }, "updated_at" : { "$date" : "2013-10-01T21:57:11.306+0000" }, "creator_id" : { "$oid" : "5b7d52e7e9214a0d1608d9d2" }, "reporter_id" : { "$oid" : "5b7d52e7e9214a0d1608d9d2" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d510b5f627d6b0586a8d8" }, "external_id" : "ZOOKEEPER-1085", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.0.0" ], "components" : [ "build" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d50665f627d6b05869b19" }, "effect" : "is cloned by", "type" : "Cloners" } ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2011-06-01T07:22:30.205+0000" }, "priority" : "Critical", "reporter_id" : { "$oid" : "5b7d510be9214a0d1608d8dd" }, "resolution" : "Not A Problem", "creator_id" : { "$oid" : "5b7d510be9214a0d1608d8dd" }, "updated_at" : { "$date" : "2013-10-02T00:10:46.785+0000" }, "title" : "CLONE - Deploy ZooKeeper jars/artifacts to a Maven Repository", "issue_type" : "Task", "desc" : "Looks like 3.3.2 and 3.3.3 didn't get deployed on the Apache Maven Repository", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52e95f627d6b0586dc97" }, "external_id" : "ZOOKEEPER-1523", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Better logging during instance loading/syncing", "desc" : "When an instance is coming up and loading from snapshot, better logging is needed so an operator knows how long until completion. Also, when syncing with the leader, better logging is needed to know how long until success.", "created_at" : { "$date" : "2012-07-31T21:26:47.799+0000" }, "updated_at" : { "$date" : "2013-10-02T00:14:14.102+0000" }, "creator_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "reporter_id" : { "$oid" : "5b7d5205e9214a0d1608d93c" }, "issue_type" : "Improvement", "priority" : "Critical", "status" : "Open", "affects_versions" : [ "3.3.5" ], "components" : [ "quorum", "server" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52e95f627d6b0586dca4" }, "external_id" : "ZOOKEEPER-1449", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Ephemeral znode not deleted after session has expired on one follower (quorum is in an inconsistent state) ", "desc" : "I've been running in to this situation in our labs fairly regularly where we'll get a single follower that will be in an inconsistent state with dangling ephemeral znodes.  Here is all of the information that I have right now.  Please ask if there is anything else that is useful.\n\nHere is a quick snapshot of the state of the ensemble where you can see it is out of sync across several znodes: \n\n-bash-3.2$ echo srvr | nc il23n04sa-zk001 2181\nZookeeper version: 3.3.3-cdh3u2--1, built on 10/14/2011 05:17 GMT\nLatency min/avg/max: 0/7/25802\nReceived: 64002\nSent: 63985\nOutstanding: 0\nZxid: 0x500000a41\nMode: follower\nNode count: 497\n\n-bash-3.2$ echo srvr | nc il23n04sa-zk002 2181\nZookeeper version: 3.3.3-cdh3u2--1, built on 10/14/2011 05:17 GMT\nLatency min/avg/max: 0/13/79032\nReceived: 74320\nSent: 74276\nOutstanding: 0\nZxid: 0x500000a41\nMode: leader\nNode count: 493\n\n-bash-3.2$ echo srvr | nc il23n04sa-zk003 2181\nZookeeper version: 3.3.3-cdh3u2--1, built on 10/14/2011 05:17 GMT\nLatency min/avg/max: 0/2/25234\nReceived: 187310\nSent: 187320\nOutstanding: 0\nZxid: 0x500000a41\nMode: follower\nNode count: 493\n\nAll of the zxids match up just fine but zk001 has 4 more nodes in its node count than the other two (including the leader..).  When I use a zookeeper client connect to connect directly to zk001 I can see the following znode that should no longer exist: \n\n[zk: localhost:2181(CONNECTED) 0] stat /siri/Douroucouli/clients/il23n04sa-app004.siri.apple.com:38096\ncZxid = 0x40000001a\nctime = Mon Apr 16 11:00:47 PDT 2012\nmZxid = 0x40000001a\nmtime = Mon Apr 16 11:00:47 PDT 2012\npZxid = 0x40000001a\ncversion = 0\ndataVersion = 0\naclVersion = 0\nephemeralOwner = 0x236bc504cb50002\ndataLength = 0\nnumChildren = 0\n\nThis node does not exist using the client to connect to either of the other two members of the ensemble.\n\nI searched through the logs for that session id and it looks like it was established and closed cleanly.  There were several leadership/quorum problems during the course of the session but it looks like it should have been shut down properly.  Neither the session nor the znode show up in the \"dump\" on the leader but the problem znode does show up in the \"dump\" on zk001.\n\n2012-04-16 11:00:47,637 - INFO  [CommitProcessor:2:NIOServerCnxn@1580] - Established session 0x236bc504cb50002 with negotiated timeout 15000 for client /17.202.71.201:38971\n2012-04-16 11:20:59,341 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@770] - Client attempting to renew session 0x236bc504cb50002 at /17.202.71.201:50841\n2012-04-16 11:20:59,342 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1580] - Established session 0x236bc504cb50002 with negotiated timeout 15000 for client /17.202.71.201:50841\n2012-04-16 11:21:09,343 - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@634] - EndOfStreamException: Unable to read additional data from client sessionid 0x236bc504cb50002, likely client has closed socket\n2012-04-16 11:21:09,343 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1435] - Closed socket connection for client /17.202.71.201:50841 which had sessionid 0x236bc504cb50002\n2012-04-16 11:21:20,352 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:NIOServerCnxn@1435] - Closed socket connection for client /17.202.71.201:38971 which had sessionid 0x236bc504cb50002\n2012-04-16 11:21:22,151 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@770] - Client attempting to renew session 0x236bc504cb50002 at /17.202.71.201:38166\n2012-04-16 11:21:22,152 - INFO  [QuorumPeer:/0:0:0:0:0:0:0:0:2181:NIOServerCnxn@1580] - Established session 0x236bc504cb50002 with negotiated timeout 15000 for client /17.202.71.201:38166\n2012-04-16 11:27:17,902 - INFO  [ProcessThread:-1:PrepRequestProcessor@387] - Processed session termination for sessionid: 0x236bc504cb50002\n2012-04-16 11:27:17,904 - INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@1435] - Closed socket connection for client /17.202.71.201:38166 which had sessionid 0x236bc504cb50002\n\nThe only way I've been able to recover from this situation is to shut down the problem follower, delete its snapshots and let it resync with the leader.\n\nI'll attach the full log4j logs, the txn logs, the snapshots and the conf files for each member of the ensemble.  Please let me know what other information is useful.", "created_at" : { "$date" : "2012-04-17T18:26:34.334+0000" }, "updated_at" : { "$date" : "2013-10-02T16:16:46.096+0000" }, "creator_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "reporter_id" : { "$oid" : "5b7d5145e9214a0d1608d8fe" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52e95f627d6b0586dca3" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d52ea5f627d6b0586dcbf" }, "external_id" : "ZOOKEEPER-1741", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "bin scripts don't dereference symlinks", "desc" : "Symlinks on bin scripts are not dereferenced correctly (\"set -x\" added):\n{noformat}\n[root@tsthdp1 noarch]# which zookeeper-client\n/usr/local/bin/zookeeper-client\n[root@tsthdp1 noarch]# ls -la /usr/local/bin/zookeeper-client\nlrwxrwxrwx 1 root root 40  16 15:56 /usr/local/bin/zookeeper-client -> /usr/local/hadoop/zookeeper/bin/zkCli.sh\n[root@tsthdp1 noarch]# ls -la /usr/local/hadoop/zookeeper/bin\n 36\ndrwxr-xr-x 2 root root 4096  16 16:24 .\ndrwxr-xr-x 5 root root 4096  16 15:56 ..\n-rwxr-xr-x 1 root root 1909  16 15:56 zkCleanup.sh\n-rwxr-xr-x 1 root root 1536  16 16:22 zkCli.sh\n-rwxr-xr-x 1 root root 2599  16 15:56 zkEnv.sh\n-rwxr-xr-x 1 root root 4559  16 15:56 zkServer-initialize.sh\n-rwxr-xr-x 1 root root 6246  16 15:56 zkServer.sh\n[root@tsthdp1 noarch]# zookeeper-client\n+ ZOOBIN=/usr/local/bin/zookeeper-client\n++ dirname /usr/local/bin/zookeeper-client\n+ ZOOBIN=/usr/local/bin\n++ cd /usr/local/bin\n++ pwd\n+ ZOOBINDIR=/usr/local/bin\n+ '[' -e /usr/local/bin/../libexec/zkEnv.sh ']'\n+ . /usr/local/bin/zkEnv.sh\n/usr/local/bin/zookeeper-client: line 37: /usr/local/bin/zkEnv.sh: no such file or directory\n{noformat}", "created_at" : { "$date" : "2013-08-16T12:46:01.732+0000" }, "updated_at" : { "$date" : "2013-10-02T17:02:37.074+0000" }, "creator_id" : { "$oid" : "5b7d52eae9214a0d1608d9d3" }, "reporter_id" : { "$oid" : "5b7d52eae9214a0d1608d9d3" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "scripts" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d52eae9214a0d1608d9d3" }, "issue_links" : [  ], "environment" : "Centos 5.8" },
{ "_id" : { "$oid" : "5b7d52eb5f627d6b0586dcd6" }, "external_id" : "ZOOKEEPER-1780", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add a FAQ for why myid file is required", "desc" : "This comes up every so often, would be good for us to document on the FAQ.\n\nhttps://cwiki.apache.org/confluence/display/ZOOKEEPER/FAQ\n\nhere's one such discussion: http://markmail.org/message/cvzz3tq3gievicqe\n", "created_at" : { "$date" : "2013-10-02T18:56:10.412+0000" }, "updated_at" : { "$date" : "2013-10-02T18:56:10.412+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ec5f627d6b0586dcd7" }, "external_id" : "ZOOKEEPER-1430", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ec5f627d6b0586dcd8" }, "external_id" : "ZOOKEEPER-1686", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Publish ZK 3.4.5 test jar", "desc" : "ZooKeeper 3.4.2 used to publish a jar with the tests classifier for use by downstream project tests. It seems this didn't get published for 3.4.4 or 3.4.5 (see https://repository.apache.org/index.html#nexus-search;quick~org.apache.zookeeper). Would someone mind please publishing these artifacts?", "created_at" : { "$date" : "2013-04-05T22:17:31.504+0000" }, "updated_at" : { "$date" : "2013-10-03T23:54:02.701+0000" }, "creator_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "reporter_id" : { "$oid" : "5b7d5052e9214a0d1608d89f" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "build", "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.5", "3.4.4" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ec5f627d6b0586dcd7" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52e35f627d6b0586dc07" }, "effect" : "blocks", "type" : "Blocker" } ] },
{ "_id" : { "$oid" : "5b7d52ed5f627d6b0586dcec" }, "external_id" : "ZOOKEEPER-1718", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ed5f627d6b0586dced" }, "external_id" : "ZOOKEEPER-1773", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "incorrect reference to jline version/lib in docs", "desc" : "The docs refer to an old version of jline\n\n{noformat}\nsrc/docs/src/documentation/content/xdocs/zookeeperAdmin.xml\n227:              <para><computeroutput>$ java -cp zookeeper.jar:lib/slf4j-api-1.6.1.jar:lib/slf4j-log4j12-1.6.1.jar:lib/log4j-1.2.15.jar:conf:src/java/lib/jline-0.9.94.jar \\\n\nsrc/docs/src/documentation/content/xdocs/zookeeperQuotas.xml\n46:\t<para><computeroutput>$java -cp zookeeper.jar:src/java/lib/log4j-1.2.15.jar/conf:src/java/lib/jline-0.9.94.jar \\\n{noformat}\n", "created_at" : { "$date" : "2013-10-01T21:20:56.748+0000" }, "updated_at" : { "$date" : "2013-10-04T11:07:31.442+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52ede9214a0d1608d9d4" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52ed5f627d6b0586dcec" }, "effect" : "is broken by", "type" : "Regression" } ] },
{ "_id" : { "$oid" : "5b7d52ee5f627d6b0586dcfa" }, "external_id" : "ZOOKEEPER-1778", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Use static final Logger objects", "desc" : "Logger is not declared as 'private static final' in few classes", "created_at" : { "$date" : "2013-10-02T17:36:16.561+0000" }, "updated_at" : { "$date" : "2013-10-05T11:10:19.962+0000" }, "creator_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "reporter_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52b75f627d6b0586d6b7" }, "external_id" : "ZOOKEEPER-1258", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51475f627d6b0586ad18" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "parent_issue_id" : { "$oid" : "5b7d512b5f627d6b0586ab0d" }, "priority" : "Major", "created_at" : { "$date" : "2011-10-27T11:08:07.668+0000" }, "updated_at" : { "$date" : "2013-10-08T01:22:46.056+0000" }, "reporter_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "creator_id" : { "$oid" : "5b7d50a5e9214a0d1608d8b2" }, "issue_type" : "Sub-task", "title" : "Move MultiResponse creation out of FinalRequestProcessor", "desc" : "There is a longish code block in the switch case of the FinalRequestProcessor iterating over rc.multiResult and building a MultiResponse. Moved the code where it belongs, to MultiResponse and OpResult.", "status" : "Patch Available" },
{ "_id" : { "$oid" : "5b7d52ef5f627d6b0586dd0b" }, "external_id" : "GIRAPH-344", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52885f627d6b0586d238" }, "external_id" : "ZOOKEEPER-1477", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3" ], "components" : [ "server", "tests" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d23a" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52ef5f627d6b0586dd0b" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2012-06-01T19:52:19.280+0000" }, "priority" : "Major", "desc" : "I downloaded ZK 3.4.3 sources and ran {{ant test}}. Many of the tests failed, including ZooKeeperTest. A common symptom was spurious {{ConnectionLossException}}:\n\n{code}\n2012-06-01 12:01:23,420 [myid:] - INFO  [main:JUnit4ZKTestRunner$LoggedInvokeMethod@54] - TEST METHOD FAILED testDeleteRecursiveAsync\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n        at org.apache.zookeeper.ZooKeeper.setData(ZooKeeper.java:1246)\n        at org.apache.zookeeper.ZooKeeperTest.testDeleteRecursiveAsync(ZooKeeperTest.java:77)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n... (snipped)\n{code}\n\nAs background, I was actually investigating some non-deterministic failures when using Netflix's Curator with Java 7 (see https://github.com/Netflix/curator/issues/79). After a while, I figured I should establish a clean ZK baseline first and realized it is actually a ZK issue, not a Curator issue.\n\nWe are trying to migrate to Java 7 but this is a blocking issue for us right now.", "reporter_id" : { "$oid" : "5b7d52efe9214a0d1608d9d5" }, "resolution" : "Not A Problem", "creator_id" : { "$oid" : "5b7d52efe9214a0d1608d9d5" }, "updated_at" : { "$date" : "2013-10-08T16:10:18.820+0000" }, "title" : "Test failures with Java 7 on Mac OS X", "issue_type" : "Bug", "environment" : "Mac OS X Lion (10.7.4)\nJava version:\njava version \"1.7.0_04\"\nJava(TM) SE Runtime Environment (build 1.7.0_04-b21)\nJava HotSpot(TM) 64-Bit Server VM (build 23.0-b21, mixed mode)", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52f05f627d6b0586dd49" }, "external_id" : "ZOOKEEPER-1639", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zk.getZKDatabase().deserializeSnapshot adds new system znodes instead of replacing existing ones", "desc" : "Before the call to zk.getZKDatabase().deserializeSnapshot in Learner.java, \nzk.getZKDatabase().getDataTree().getNode(\"/zookeeper\") == zk.getZKDatabase().getDataTree().procDataNode, which means that this is the same znode, as it should be. \n\nHowever, after this call, they are not equal. The node actually being used in client operations is zk.getZKDatabase().getDataTree().getNode(\"/zookeeper\"), but the other old node procDataNode is still there and not replaced (in fact it is a final field).", "created_at" : { "$date" : "2013-02-03T03:05:41.871+0000" }, "updated_at" : { "$date" : "2013-10-08T20:31:48.969+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f15f627d6b0586dd4d" }, "external_id" : "ZOOKEEPER-951", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "monthly board reports for first 3 months (then quarterly reports)", "desc" : "Board reporting guidelines can be found here:\nhttp://apache.org/foundation/board/reporting\nnote that ZOOKEEPER-953 should also be addressed (branding checklist)", "created_at" : { "$date" : "2010-11-24T23:01:23.284+0000" }, "updated_at" : { "$date" : "2013-10-08T21:55:05.480+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d52f15f627d6b0586dd51" }, "external_id" : "ZOOKEEPER-952", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "scrub codebase for references to pre-TLP locations.", "desc" : "The codebase needs to be scrubbed of references to hadoop and old locations (web site, wiki, svn, mailing lists, etc...)\n", "created_at" : { "$date" : "2010-11-24T23:06:49.700+0000" }, "updated_at" : { "$date" : "2013-10-08T21:55:17.292+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" } },
{ "_id" : { "$oid" : "5b7d50ea5f627d6b0586a6ff" }, "external_id" : "ZOOKEEPER-940", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "created_at" : { "$date" : "2010-11-24T17:42:54.455+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "resolution" : "Implemented", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "updated_at" : { "$date" : "2013-10-08T21:55:33.162+0000" }, "title" : "Umbrella JIRA for move to TLP", "issue_type" : "Task", "desc" : "This is an umbrella jira for our move to TLP status. \n\nPlease create subtasks for any issues you find related to the move. Note that INFRA-3228 is now closed, so a number of infra related issues have already been closed. This jira (subs) is for additional issues we need to address.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52f35f627d6b0586dd59" }, "external_id" : "ZOOKEEPER-929", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "hudson qabot incorrectly reporting issues as number 909 when the patch from 908 is the one being tested", "desc" : "Hi Nigel can you take a look at this?\n\nFollowing you'll see the email I got, notice that the patch is patch 908, however if you look at the hudson page it's linked to the change is documented as 909 patch file applied\nhttps://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/25/changes\n\nI looked at both jiras ZOOKEEPER-908 and ZOOKEEPER-909 both of these look good (the right names on patches) and qabot actually updated 908 with the comment (failure). However the \"change\" is listed as 909 which is wrong.\n\n\n    [exec] -1 overall.  Here are the results of testing the latest attachment\n    [exec]   http://issues.apache.org/jira/secure/attachment/12459361/ZOOKEEPER-908.patch\n    [exec]   against trunk revision 1033770.\n    [exec]\n    [exec]     +1 @author.  The patch does not contain any @author tags.\n    [exec]\n    [exec]     -1 tests included.  The patch doesn't appear to include any new or modified tests.\n    [exec]                         Please justify why no new tests are needed for this patch.\n    [exec]                         Also please list what manual steps were performed to verify this patch.\n    [exec]\n    [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.\n    [exec]\n    [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.\n    [exec]\n    [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.\n    [exec]\n    [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.\n    [exec]\n    [exec]     +1 core tests.  The patch passed core unit tests.\n    [exec]\n    [exec]     +1 contrib tests.  The patch passed contrib unit tests.\n    [exec]\n    [exec] Test results: https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/25//testReport/\n    [exec] Findbugs warnings: https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/25//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html\n    [exec] Console output: https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/25//console\n    [exec]\n    [exec] This message is automatically generated.\n    [exec]", "created_at" : { "$date" : "2010-11-11T17:03:15.768+0000" }, "updated_at" : { "$date" : "2013-10-08T21:56:03.702+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "build" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51025f627d6b0586a87a" }, "external_id" : "ZOOKEEPER-1037", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "created_at" : { "$date" : "2011-03-30T05:27:45.377+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "resolution" : "Implemented", "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "updated_at" : { "$date" : "2013-10-08T22:45:01.783+0000" }, "title" : "Create BookKeeper subproject", "issue_type" : "Task", "desc" : "move the hedwig and bookkeeper code to the bookkeeper subproject", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52f45f627d6b0586dd60" }, "external_id" : "ZOOKEEPER-1041", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "get hudson running on bookkeeper", "desc" : "setup hudson to run on bookkeeper code", "created_at" : { "$date" : "2011-03-30T05:32:01.395+0000" }, "updated_at" : { "$date" : "2013-10-08T22:45:14.070+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "contrib-bookkeeper", "contrib-hedwig" ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "issue_links" : [  ], "parent_issue_id" : { "$oid" : "5b7d51025f627d6b0586a87a" } },
{ "_id" : { "$oid" : "5b7d52f45f627d6b0586dd65" }, "external_id" : "ZOOKEEPER-871", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ClientTest testClientCleanup is failing due to high fd count.", "desc" : "The fd counts has increased. The tests are repeatedly failing on hudson machines. I probably think this is related to netty server changes. We have to fix this before we release 3.4", "created_at" : { "$date" : "2010-09-14T22:39:54.468+0000" }, "updated_at" : { "$date" : "2013-10-08T22:55:30.680+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f55f627d6b0586dd6d" }, "external_id" : "ZOOKEEPER-1541", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper distributions are not available.", "desc" : "I can't download zookeeper distribution because of \"404 Not Found\".\n\nhttp://www.apache.org/dist/zookeeper/\n", "created_at" : { "$date" : "2012-08-24T05:09:46.212+0000" }, "updated_at" : { "$date" : "2013-10-09T06:19:13.422+0000" }, "creator_id" : { "$oid" : "5b7d52f5e9214a0d1608d9de" }, "reporter_id" : { "$oid" : "5b7d52f5e9214a0d1608d9de" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f65f627d6b0586dd76" }, "external_id" : "ZOOKEEPER-697", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "TestQuotaQuorum is failing on Hudson", "desc" : "The hudson test build failed \n\nhttp://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/729/testReport/junit/org.apache.zookeeper.test/QuorumQuotaTest/testQuotaWithQuorum/\n\n", "created_at" : { "$date" : "2010-03-10T16:20:35.632+0000" }, "updated_at" : { "$date" : "2013-10-09T06:23:16.234+0000" }, "creator_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "reporter_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f3ae9214a0d1608d86d" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f75f627d6b0586dd87" }, "external_id" : "ZOOKEEPER-1656", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "OSGI - Missing import package - ClassNotFoundException", "desc" : "\"Import package\" are missing for bundle org.apache.hadoop.zookeeper.\n\nI am getting an exception running the Zookeeper server in an OSGi environment.\n\nZookeeperServerMain uses\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nBut there is no import in MANIFEST.mf:\nImport-Package: javax.management,org.apache.log4j,org.osgi.framework;v\n ersion=\"[1.4,2.0)\",org.osgi.util.tracker;version=\"[1.1,2.0)\"\n\n\nI am sure that another missing package would be the subpackage of org.apache.log4j like org.apache.log4j.jmx.\n\n\nBest, Florian\n\n\n\n\n", "created_at" : { "$date" : "2013-03-01T16:20:39.151+0000" }, "updated_at" : { "$date" : "2013-10-09T06:33:24.346+0000" }, "creator_id" : { "$oid" : "5b7d52f7e9214a0d1608d9df" }, "reporter_id" : { "$oid" : "5b7d52f7e9214a0d1608d9df" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "OSGi" },
{ "_id" : { "$oid" : "5b7d52f85f627d6b0586dd8a" }, "external_id" : "ZOOKEEPER-1693", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "process may core or hang when xid is overflowed", "desc" : "The xid will be confused with AUTHXID(-4) when it is overflowed.\n\nIf the process send 4000 requests per second, it may core or hang after about ten days.", "created_at" : { "$date" : "2013-04-19T12:14:21.906+0000" }, "updated_at" : { "$date" : "2013-10-09T06:38:48.967+0000" }, "creator_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "reporter_id" : { "$oid" : "5b7d5275e9214a0d1608d987" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [ "c client", "java client" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f85f627d6b0586dd92" }, "external_id" : "ZOOKEEPER-1586", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "tarballs for zkfuse don't compile out of tree", "created_at" : { "$date" : "2012-11-19T07:14:34.733+0000" }, "updated_at" : { "$date" : "2013-10-09T06:41:11.798+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Patch Available", "affects_versions" : [ "3.5.0" ], "components" : [ "contrib-zkfuse" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52f95f627d6b0586dd9c" }, "external_id" : "ZOOKEEPER-1385", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper.apache.org/doc/trunk/ has broken pointers", "desc" : "API Docs gives a \"Not found\" message.", "created_at" : { "$date" : "2012-02-01T17:27:52.522+0000" }, "updated_at" : { "$date" : "2013-10-09T06:44:26.390+0000" }, "creator_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "reporter_id" : { "$oid" : "5b7d4f39e9214a0d1608d86b" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52fa5f627d6b0586dd9e" }, "external_id" : "ZOOKEEPER-1443", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "API docs for trunk returns 404", "desc" : "The \"API Docs\" link is broken in trunk.\n\nhttp://zookeeper.apache.org/doc/trunk/\nhttp://zookeeper.apache.org/doc/trunk/api/index.html", "created_at" : { "$date" : "2012-04-04T23:05:36.031+0000" }, "updated_at" : { "$date" : "2013-10-09T06:46:42.886+0000" }, "creator_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "reporter_id" : { "$oid" : "5b7d50cde9214a0d1608d8bb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "documentation" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52fa5f627d6b0586dda3" }, "external_id" : "ZOOKEEPER-1788", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Support clientID field on connection requests ", "desc" : "I suspect it's very common for deployments to have a wide variety of client libraries (different versions/languages) connecting to a given cluster.\n\nIt would be handy to have a way to identify clients via a clientID (akin to HTTP's User-Agent header). This could be implemented in ZooKeeperServer#processConnectRequest [1] and be fully backwards compatible.\n\nThe clientID could then be kept with the corresponding ServerCnxn instance and be used for better logging (or stats expose through 4-letter commands). \n\nThe corresponding client side change would be to expose API to set the clientID on each connection handler (and by default it could be something like \"zk java $version\", \"zk c $version\", etc).\n\nThoughts?\n\n[1] https://github.com/apache/zookeeper/blob/trunk/src/java/main/org/apache/zookeeper/server/ZooKeeperServer.java#L797", "created_at" : { "$date" : "2013-10-09T19:43:33.073+0000" }, "updated_at" : { "$date" : "2013-10-09T19:43:33.073+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52fb5f627d6b0586dda4" }, "external_id" : "ZOOKEEPER-1304", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "[IGNORE THIS --- MOVING TO BOOKKEEPER JIRA] publish and subscribe methods get ServiceDownException even when the hubs, bookies, and zookeepers are running", "desc" : "**[Sorry. I don't know how to delete an issue that is already submitted. I just learned of the Bookkeeper jira, and I will submit this issue there instead. You can all ignore this issue.]\n\n\nSince I couldn't finish building all hedwig components in CentOS, I built it successfully in Ubuntu, then I deployed it to CentOS (no ubuntu image in my company's cloud). I configured zookeeper, bookies and hubs as they were described in the documentations. First, I copied TestPubSubClient.java's publish and subscribe tests into my own test code. I also had to create another object that extends ClientConfiguration. I named it \"HedwigConf\", and overwrote getDefaultServerHedwigSocketAddress() method because the server was not on the same machine as the workstation. I targetted the right host and publish seemed to work. However, it throws me ServiceDownException for publish sometimes. I checked the logs of the hubs. They seem to have connected ok with the bookies. There was no error or warning there. However, the problem seemed to exist in bookies and zookeeper. This was found in the zookeeper log: \"Got user-level KeeperException when processing sessionid:0x----------- type:create cxid:0x5 zxid:0x29 txntype:-1 reqpath:n/a Error Path:/hedwig/standalone/topics Error:KeeperErrorCode = NoNode for /hedwig/standalone/topics\". Normally this znode path is created automatically. Also, some bookies complained this: \"WARN [NIOServerFactory] org.apache.bookkeeper.proto.NIOServerFactory - Exception in server socket loop: /0:0:0:0:0:0:0:0\njava.lang.NullPointerException\". For some reason, this problem comes and goes. Sometimes everything just works and the new topic is saved in a new znode, and the message is saved in bookie(s). I spent hours trying to recreate this yesterday, but I couldn't. Now it is back again. Subscribe seems to have the similar issue.\n", "created_at" : { "$date" : "2011-11-17T23:37:26.304+0000" }, "updated_at" : { "$date" : "2013-10-10T00:09:16.419+0000" }, "creator_id" : { "$oid" : "5b7d52fbe9214a0d1608d9e1" }, "reporter_id" : { "$oid" : "5b7d52fbe9214a0d1608d9e1" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ], "original_time_estimate" : 1209600, "environment" : "CentOS 5.5 for all servers and workstations (however zookeeper, bookies, and hubs are all built in Ubuntu 11);\nOpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386);\nOpenJDK Client VM (build 19.0-b09, mixed mode);\n\n" },
{ "_id" : { "$oid" : "5b7d52fb5f627d6b0586ddab" }, "external_id" : "ZOOKEEPER-903", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create a testing jar with useful classes from ZK test source", "desc" : "From mailing list:\n-----Original Message-----\nFrom: Benjamin Reed \nSent: Monday, October 18, 2010 11:12 AM\nTo: zookeeper-user@hadoop.apache.org\nSubject: Re: Testing zookeeper outside the source distribution?\n\n  we should be exposing those classes and releasing them as a testing \njar. do you want to open up a jira to track this issue?\n\nben\n\nOn 10/18/2010 05:17 AM, Anthony Urso wrote:\n> Anyone have any pointers on how to test against ZK outside of the\n> source distribution? All the fun classes (e.g. ClientBase) do not make\n> it into the ZK release jar.\n>\n> Right now I am manually running a ZK node for the unit tests to\n> connect to prior to running my test, but I would rather have something\n> that ant could reliably\n> automate starting and stopping for CI.\n>\n> Thanks,\n> Anthony\n", "created_at" : { "$date" : "2010-10-18T18:25:27.417+0000" }, "updated_at" : { "$date" : "2013-10-10T00:30:46.898+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d51585f627d6b0586af1d" }, "external_id" : "ZOOKEEPER-883", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.1" ], "components" : [ "server" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d511a5f627d6b0586a9dc" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d51585f627d6b0586af1c" }, "effect" : "relates to", "type" : "Reference" } ], "created_at" : { "$date" : "2010-09-30T08:38:29.608+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d52fce9214a0d1608d9e2" }, "resolution" : "Implemented", "creator_id" : { "$oid" : "5b7d52fce9214a0d1608d9e2" }, "updated_at" : { "$date" : "2013-10-10T00:33:16.387+0000" }, "title" : "Idle cluster increasingly consumes CPU resources", "issue_type" : "Bug", "desc" : "Monitoring the ZooKeeper nodes by polling the various ports using Nagios' open port checks seems to cause a substantial raise of CPU being used by the ZooKeeper daemons. Over the course of a week an idle cluster grew from a baseline 2% to >10% CPU usage. Attached is a stack dump and logs showing the occupied threads. At the end the daemon starts failing on \"too many open files\" errors as all handles are used up.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc3" }, "external_id" : "ZOOKEEPER-1572", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc5" }, "external_id" : "ZOOKEEPER-1066", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Multi should have an async version", "desc" : "per the code review on ZOOKEEPER-965 it seems that multi should have an asynchronous version.\n\nThe semantics should be essentially identical.  The only difference is that the original caller shouldn't wait for the result.  Cloning existing multi-operations should be a decent implementation strategy.", "created_at" : { "$date" : "2011-05-21T21:09:14.139+0000" }, "updated_at" : { "$date" : "2013-10-10T17:24:12.298+0000" }, "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc3" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc4" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d51685f627d6b0586b1fe" }, "external_id" : "ZOOKEEPER-1064", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.3.2" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51685f627d6b0586b201" }, "effect" : "is related to", "type" : "Reference" } ], "created_at" : { "$date" : "2011-05-19T00:36:45.264+0000" }, "priority" : "Major", "reporter_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "resolution" : "Implemented", "creator_id" : { "$oid" : "5b7d5117e9214a0d1608d8ee" }, "updated_at" : { "$date" : "2013-10-10T17:25:41.955+0000" }, "title" : "Startup script needs more LSB compatability", "issue_type" : "Bug", "desc" : "The zkServer.sh script kind of sort of implements the standard init.d style of interaction.\n\nIt lacks\n\n- nice return codes\n\n- status method\n\n- standard output messages\n\nSee \n\nhttp://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html\n\nand\n\nhttp://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptfunc.html\n\nand\n\nhttp://wiki.debian.org/LSBInitScripts\n\nIt is an open question how much zkServer should use these LSB scripts because that may impair portability.  I\nthink it should produce similar messages, however, and should return standardized error codes.  If lsb functions\nare available, I think that they should be used so that ZK works as a first class citizen.\n\n\nI will produce a proposed patch.", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d52fe5f627d6b0586dddc" }, "external_id" : "ZOOKEEPER-559", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "valgrind warnings running zkpython bindings", "desc" : "I'm seeing some weird behavior running zk-latencies.py\nhttp://github.com/phunt/zk-smoketest\n\ndon't know if it's related to zkbindings itself, but I ran valgrind to see if it noticed any issues. see attached.\n\nafaict these issues are related to zkpython binding, however I'm not sure. I did run valgrind against the\nzookeeper c library tests and these issues were not highlighted. So I'm thinking this is zkpython errors, however\nI'm not 100% sure. \n\nHenry can you take a look?\n ", "created_at" : { "$date" : "2009-10-26T17:11:27.075+0000" }, "updated_at" : { "$date" : "2013-10-10T17:32:18.313+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.0" ], "components" : [ "contrib-bindings" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d5183e9214a0d1608d913" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52ff5f627d6b0586ddeb" }, "external_id" : "ZOOKEEPER-513", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "C client disconnect with stand-alone server abnormally", "desc" : "The client which created an ephemeral node at the zookeeper server, printed the following log\n\nWARNING: 08-20 03:09:20:  auto * 182894118176 [logid:][reqip:][auto_exchanger_zk_basic.cpp:605]get children fail.[/forum/elect_nodes][-7][operation timeout]\n\nand the Zookeeper client printed the following log (the log level is INFO)\n\n2009-08-19 21:36:18,067:3813(0x9556c520):ZOO_INFO@log_env@545: Client environment:zookeeper.version=zookeeper C client 3.2.0\n    606 2009-08-19 21:36:18,067:3813(0x9556c520):ZOO_INFO@log_env@549: Client environment:host.name=jx-ziyuan-test00.jx.baidu.com\n    607 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@557: Client environments.name=Linux\n    608 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@558: Client environments.arch=2.6.9-52bs\n    609 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@559: Client environments.version=#2 SMP Fri Jan 26 13:34:38 CST 2007\n    610 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@567: Client environment:user.name=club\n    611 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@577: Client environment:user.home=/home/club\n    612 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@log_env@589: Client environment:user.dir=/home/club/user/luhongbo/auto-exchanger\n    613 2009-08-19 21:36:18,068:3813(0x9556c520):ZOO_INFO@zookeeper_init@613: Initiating client connection, host=127.0.0.1:2181,127.0.0.1:2182 sessionTimeout=2000 wa        tcher=0x408c56 sessionId=0x0 sessionPasswd=<null> context=(nil) flags=0\n    614 2009-08-19 21:36:18,069:3813(0x41401960):ZOO_INFO@check_events@1439: initiated connection to server [127.0.0.1:2181]\n    615 2009-08-19 21:36:18,070:3813(0x41401960):ZOO_INFO@check_events@1484: connected to server [127.0.0.1:2181] with session id=1232c1688a20093\n    616 2009-08-20 02:48:01,780:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 520ms\n    617 2009-08-20 03:08:52,332:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 14ms\n    618 2009-08-20 03:09:04,666:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 48ms\n    619 2009-08-20 03:09:09,733:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 24ms\n    620 2009-08-20 03:09:20,289:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 264ms\n    621 2009-08-20 03:09:20,295:3813(0x41401960):ZOO_ERROR@handle_socket_error_msg@1388: Socket [127.0.0.1:2181] zk retcode=-7, errno=110(Connection timed out): conn        ection timed out (exceeded timeout by 264ms)\n    622 2009-08-20 03:09:20,309:3813(0x41401960):ZOO_WARN@zookeeper_interest@1335: Exceeded deadline by 284ms\n    623 2009-08-20 03:09:20,309:3813(0x41401960):ZOO_ERROR@handle_socket_error_msg@1433: Socket [127.0.0.1:2182] zk retcode=-4, errno=111(Connection refused): server         refused to accept the client\n    624 2009-08-20 03:09:20,353:3813(0x41401960):ZOO_INFO@check_events@1439: initiated connection to server [127.0.0.1:2181]\n    625 2009-08-20 03:09:20,552:3813(0x41401960):ZOO_INFO@check_events@1484: connected to server [127.0.0.1:2181] with session id=1232c1688a20093\n\nThe problem happened at 03:09:20, it seems that the zookeeper refused to accept the client, and I don't know why.\n\nthe zoo.cfg is like:\n# The number of milliseconds of each tick\ntickTime=500\n# The number of ticks that the initial \n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between \n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\ndataDir=./data/\n# the port at which the clients will connect\nclientPort=2181\n\nthe C client used multi-thread library, and the session timeout is set to 2000 when the zookeeper handler was initialized.\n", "created_at" : { "$date" : "2009-08-22T12:12:03.551+0000" }, "updated_at" : { "$date" : "2013-10-10T17:33:16.099+0000" }, "creator_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "reporter_id" : { "$oid" : "5b7d508be9214a0d1608d8af" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.2.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Cannot Reproduce", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ], "environment" : "Linux 2.6.9-52bs #2 SMP Fri Jan 26 13:34:38 CST 2007 x86_64 x86_64 x86_64 GNU/Linux\nJdk: 1.6.0_14" },
{ "_id" : { "$oid" : "5b7d52ff5f627d6b0586ddf7" }, "external_id" : "ZOOKEEPER-536", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "the initial size of the hashsets for the watcher is too large", "desc" : "setting a watches on a lot of different nodes can be expensive if there is only one watch set on each node. by default the hashset we use to track watches has 16 entries and takes up about 160 bytes. we should probably make the initial size much lower.", "created_at" : { "$date" : "2009-09-25T21:56:13.565+0000" }, "updated_at" : { "$date" : "2013-10-10T17:33:34.681+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [ "newbie" ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53005f627d6b0586ddfa" }, "external_id" : "ZOOKEEPER-1668", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Memory leak about permgen", "desc" : "For each connection, a ConnectionBean will be created to represent this connection at finishSessionInit:\n  | ... \n  | jmxConnectionBean = new ConnectionBean(this, zk);\n  | MBeanRegistry.getInstance().register(jmxConnectionBean, zk.jmxServerBean);\n  || ...\n  || ObjectName oname = makeObjectName(path, bean);\n  ||| ...\n  |||  return new ObjectName(beanName.toString());\n  |||| ...\n  |||| _canonicalName = (new String(canonical_chars, 0, prop_index)).intern();\n\nSo, for every connection, it takes dozens of bytes at permgen. With connection established constantly, the usage of permgen will increase continuously.\n\nIs it reasonable or necessary to manage each connection with ConnectionBean?", "created_at" : { "$date" : "2013-03-15T07:24:52.295+0000" }, "updated_at" : { "$date" : "2013-10-10T17:46:27.943+0000" }, "creator_id" : { "$oid" : "5b7d5300e9214a0d1608d9e4" }, "reporter_id" : { "$oid" : "5b7d5300e9214a0d1608d9e4" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [ "server", "jmx" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53005f627d6b0586ddfe" }, "external_id" : "ZOOKEEPER-639", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Performance improvements for ZooKeeper", "desc" : "here are some more improvements to Zab. the patch is a bit stale, but i don't want to lose track of it. there are two big improvements:\n\n1) transaction logs are reused. this saves time over growing the log files and if you preallocate a bunch of log files on an empty partition, you will see a nice performance boost\n2) acks and commits are always sent in order, so if there is a bunch to send, they will get merged into a single ack or commit.", "created_at" : { "$date" : "2010-01-07T18:09:07.044+0000" }, "updated_at" : { "$date" : "2013-10-10T23:23:26.452+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "server" ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53015f627d6b0586de01" }, "external_id" : "ZOOKEEPER-1183", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Enhance LogFormatter to output additional detail from transaction log", "desc" : "Current LogFormatter prints the following information\nZooKeeper Transactional Log File with dbid 0 txnlog format version 2\n8/15/11 1:55:36 PM PDT session 0x131cf1a236f0014 cxid 0x0 zxid 0xf01 createSession\n8/15/11 1:55:57 PM PDT session 0x131cf1a236f0000 cxid 0x55f zxid 0xf02 setData\n8/15/11 1:56:00 PM PDT session 0x131cf1a236f0015 cxid 0x0 zxid 0xf03 createSession\n...\n..\n8/15/11 2:00:33 PM PDT session 0x131cf1a236f001c cxid 0x36 zxid 0xf6b setData\n8/15/11 2:00:33 PM PDT session 0x131cf1a236f0021 cxid 0xa1 zxid 0xf6c create\n8/15/11 2:00:33 PM PDT session 0x131cf1a236f001b cxid 0x3e zxid 0xf6d setData\n8/15/11 2:00:33 PM PDT session 0x131cf1a236f001e cxid 0x3e zxid 0xf6e setData\n8/15/11 2:00:33 PM PDT session 0x131cf1a236f001d cxid 0x41 zxid 0xf6f setData\n\nThough this is good information, it does not provide additional information like \ncreateSession: which ip created the session and its time out\nset|get|delete: the path and data \ncreate: path created and createmode along with data\n\nWe can add additional parameter -detail and provide detailed output of the transaction.\n\nOutputting data is slightly tricky since we cant print data without understanding the format. We need not print this for now. \n\n\n", "created_at" : { "$date" : "2011-09-14T18:57:25.350+0000" }, "updated_at" : { "$date" : "2013-10-10T23:32:46.485+0000" }, "creator_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "reporter_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Patch Available", "affects_versions" : [ "3.4.0" ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d50e6e9214a0d1608d8ca" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53025f627d6b0586de0e" }, "external_id" : "ZOOKEEPER-278", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Create a test jar", "desc" : "I am working on integrating ZooKeeper into HBase. I've found myself copying a lot of the test infrastructure code from places like zk.t.QuorumTest to create classes like MiniZooKeeper so that I can test my new additions in HBase. I think things would be a lot easier if we shipped a ZooKeeper test jar for others to use. Additionally, I think we should clean up the test code a bit so that the tests use some common infrastructure rather than each doing its own setup/teardown of a ZK cluster. I believe this is how things are done for testing Hadoop things HBase.\n\nFor more context, see hbase-1144.patch in https://issues.apache.org/jira/browse/HBASE-1144\n\nI would do this myself but I can't currently contribute to Apache projects other than HBase because of company issues. ", "created_at" : { "$date" : "2009-01-26T19:10:15.684+0000" }, "updated_at" : { "$date" : "2013-10-11T16:33:08.835+0000" }, "creator_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "reporter_id" : { "$oid" : "5b7d4fbde9214a0d1608d87f" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d51415f627d6b0586ac74" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d53025f627d6b0586de15" }, "external_id" : "ZOOKEEPER-1527", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Correct the documentation of the args for the JavaExample doc", "desc" : "I added another listitem documenting the filename arg of the JavaExample code.", "created_at" : { "$date" : "2012-08-09T20:50:33.655+0000" }, "updated_at" : { "$date" : "2013-10-11T16:39:56.880+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Bug", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53035f627d6b0586de19" }, "external_id" : "ZOOKEEPER-1715", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53035f627d6b0586de1b" }, "external_id" : "ZOOKEEPER-1763", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Upgrade the netty version", "desc" : "2 years ago (in https://github.com/netty/netty/issues/103), Netty changed their group-id from org.jboss.netty to io.netty. ZooKeeper is still on the 3.2.5, so applications using 3.3 cannot use the maven \"dependencyManagement\" feature, as the group id differ. HBase & Hadoop 2 are on the branch 3.3+, with the new group id.\n\nNote that the netty 4 changes the package name as well. That's not the case for Netty 3.3+.", "created_at" : { "$date" : "2013-09-23T12:14:48.962+0000" }, "updated_at" : { "$date" : "2013-10-11T21:32:00.387+0000" }, "creator_id" : { "$oid" : "5b7d524de9214a0d1608d968" }, "reporter_id" : { "$oid" : "5b7d524de9214a0d1608d968" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d524de9214a0d1608d968" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53035f627d6b0586de19" }, "effect" : "is duplicated by", "type" : "Duplicate" }, { "issue_id" : { "$oid" : "5b7d53035f627d6b0586de1a" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d53045f627d6b0586de26" }, "external_id" : "ZOOKEEPER-1149", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "users cannot migrate from 3.4->3.3->3.4 server code against a single datadir", "desc" : "3.4 is checking acceptedEpoch/currentEpoch files against the snap/log files in datadir. These files are new in 3.4. If they don't exist the server will create them, however if they do exist the server will validate them.\n\nAs a result if a user \n1) upgrades from 3.3 to 3.4 this is fine\n2) downgrades from 3.4 to 3.3 this is also fine (3.3 ignores these files)\n3) however, 3.4->3.3->3.4 fails because 3.4 will see invalid *Epoch files in the datadir (as 3.3 would have ignored them, applying changes to snap/log w/o updating them)\n\n", "created_at" : { "$date" : "2011-08-04T22:15:44.983+0000" }, "updated_at" : { "$date" : "2013-10-11T21:49:58.756+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Task", "priority" : "Blocker", "status" : "Closed", "affects_versions" : [ "3.4.0", "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.4.0", "3.5.0" ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52c75f627d6b0586d93d" }, "external_id" : "ZOOKEEPER-1413", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.3" ], "components" : [ "server" ], "labels" : [ "quorum", "performance" ], "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52b25f627d6b0586d629" }, "effect" : "contains", "type" : "Container" }, { "issue_id" : { "$oid" : "5b7d52e95f627d6b0586dca3" }, "effect" : "is required by", "type" : "Required" }, { "issue_id" : { "$oid" : "5b7d52ca5f627d6b0586d985" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d52c75f627d6b0586d93e" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "created_at" : { "$date" : "2012-03-13T21:42:20.339+0000" }, "priority" : "Minor", "reporter_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "resolution" : "Fixed", "creator_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "updated_at" : { "$date" : "2013-10-14T15:55:30.070+0000" }, "title" : "Use on-disk transaction log for learner sync up", "issue_type" : "Improvement", "desc" : "Motivation:\nThe learner syncs up with leader by retrieving committed log from the leader. Currently, the leader only keeps 500 entries of recently committed log in memory. If the learner falls behind more than 500 updates, the leader will send the entire snapshot to the learner. \n\nWith the size of the snapshot for some of our Zookeeper deployments (~10G), it is prohibitively expensive to send the entire snapshot over network. Additionally, our Zookeeper may serve more than 4K updates per seconds. As a result, a network hiccups for less than a second will cause the learner to use snapshot transfer.\n\nDesign:\nInstead of looking only at committed log in memory, the leader will also look at transaction log on disk. The amount of transaction log kept on disk is configurable and the current default is 100k. This will allow Zookeeper to tolerate longer temporal network failure before initiating the snapshot transfer.  \n\nImplementation:\nWe plan to add interface to the persistence layer will can be use to retrieve proposals from on-disk transaction log. These proposals can then be used to send to the learner using existing protocol. \n", "status" : "Resolved" },
{ "_id" : { "$oid" : "5b7d53055f627d6b0586de7c" }, "external_id" : "ZOOKEEPER-988", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ZK server hang on leader election", "desc" : "org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run thread exited unexpected, so the server hang on leader election.\n\nQuorumPeer:/0.0.0.0:2181:\n [1] sun.misc.Unsafe.park (native method)\n [2] java.util.concurrent.locks.LockSupport.parkNanos (LockSupport.java:198)\n [3] java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos (AbstractQueuedSynchronizer.java:1,963)\n [4] java.util.concurrent.LinkedBlockingQueue.poll (LinkedBlockingQueue.java:395)\n [5] org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader (FastLeaderElection.java:677)\n [6] org.apache.zookeeper.server.quorum.QuorumPeer.run (QuorumPeer.java:621)", "created_at" : { "$date" : "2011-02-14T00:13:15.352+0000" }, "updated_at" : { "$date" : "2013-10-14T23:52:41.244+0000" }, "creator_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "reporter_id" : { "$oid" : "5b7d50fae9214a0d1608d8d0" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.2" ], "components" : [ "leaderElection" ], "labels" : [  ], "resolution" : "Incomplete", "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53065f627d6b0586de82" }, "external_id" : "ZOOKEEPER-1115", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "follower can not sync with leader", "desc" : "exception causing shutdownthere are 5 members in the quorum. one follower can not sync with leader after restart. it seems leader has close the data connection with this follower because of read timeout. here is the key log in follower:\n{noformat}\n2011-06-30 22:14:45,069 - WARN  [Thread-17:QuorumCnxManager$RecvWorker@658] - Connection broken: \njava.nio.channels.ClosedChannelException\n        at sun.nio.ch.SocketChannelImpl.ensureReadOpen(SocketChannelImpl.java:113)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:156)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:629)\n2011-06-30 22:14:45,069 - INFO  [QuorumPeer:/0.0.0.0:2181:FastLeaderElection@689] - Notification: 3, 17198470148, 3, 3, LOOKING, LOOKING, 3\n2011-06-30 22:14:45,070 - ERROR [Thread-16:QuorumCnxManager$SendWorker@559] - Failed to send last message. Shutting down thread.\njava.nio.channels.ClosedChannelException\n        at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:126)\n        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:324)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.send(QuorumCnxManager.java:548)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:557)\n2011-06-30 22:14:45,082 - INFO  [QuorumPeer:/0.0.0.0:2181:Learner@282] - Getting a diff from the leader 0x4011bd462\n2011-06-30 22:14:45,083 - WARN  [Thread-18:QuorumCnxManager$SendWorker@589] - Send worker leaving thread\n2011-06-30 22:14:45,085 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@116] - Got zxid 0x4011bd405 expected 0x1\n2011-06-30 22:14:45,090 - INFO  [QuorumPeer:/0.0.0.0:2181:FileTxnSnapLog@208] - Snapshotting: 4011bd462\n2011-06-30 22:14:53,397 - WARN  [SyncThread:3:SendAckRequestProcessor@63] - Closing connection to leader, exception during packet send\njava.net.SocketException: Broken pipe\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n        at org.apache.zookeeper.server.quorum.Learner.writePacket(Learner.java:126)\n        at org.apache.zookeeper.server.quorum.SendAckRequestProcessor.flush(SendAckRequestProcessor.java:61)\n        at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:164)\n        at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:98)\n2011-06-30 22:14:53,398 - WARN  [QuorumPeer:/0.0.0.0:2181:Follower@82] - Exception when following the leader\njava.net.SocketException: Socket closed\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n        at org.apache.zookeeper.server.quorum.Learner.writePacket(Learner.java:126)\n        at org.apache.zookeeper.server.quorum.Learner.ping(Learner.java:358)\n        at org.apache.zookeeper.server.quorum.Follower.processPacket(Follower.java:108)\n        at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:79)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:634)\n2011-06-30 22:14:53,398 - WARN  [SyncThread:3:SendAckRequestProcessor@63] - Closing connection to leader, exception during packet send\njava.net.SocketException: Socket closed\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)\n        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)\n        at org.apache.zookeeper.server.quorum.Learner.writePacket(Learner.java:126)\n        at org.apache.zookeeper.server.quorum.SendAckRequestProcessor.flush(SendAckRequestProcessor.java:61)\n        at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:164)\n        at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:98)\n2011-06-30 22:14:53,399 - INFO  [QuorumPeer:/0.0.0.0:2181:Follower@166] - shutdown called\njava.lang.Exception: shutdown Follower\n        at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:638)\nand these are the leader's:\n2011-06-30 22:14:35,943 - ERROR [LearnerHandler-/10.23.247.163:14975:LearnerHandler@444] - Unexpected exception causing shutdown while sock still open\njava.net.SocketTimeoutException: Read timed out\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:129)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:237)\n        at java.io.DataInputStream.readInt(DataInputStream.java:370)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:84)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n        at org.apache.zookeeper.server.quorum.LearnerHandler.run(LearnerHandler.java:358)\n2011-06-30 22:14:35,943 - WARN  [LearnerHandler-/10.23.247.163:14975:LearnerHandler@457] - ******* GOODBYE /10.23.247.163:14975 ********\n2011-06-30 22:14:48,943 - ERROR [CommitProcessor:4:NIOServerCnxn@422] - Unexpected Exception: \njava.nio.channels.CancelledKeyException\n        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:55)\n        at sun.nio.ch.SelectionKeyImpl.interestOps(SelectionKeyImpl.java:59)\n        at org.apache.zookeeper.server.NIOServerCnxn.sendBuffer(NIOServerCnxn.java:395)\n        at org.apache.zookeeper.server.NIOServerCnxn.sendResponse(NIOServerCnxn.java:1360)\n        at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:367)\n        at org.apache.zookeeper.server.quorum.Leader$ToBeAppliedRequestProcessor.processRequest(Leader.java:535)\n        at org.apache.zookeeper.server.quorum.CommitProcessor.run(CommitProcessor.java:73)\n2011-06-30 22:14:49,084 - ERROR [LearnerHandler-/10.23.247.163:14998:LearnerHandler@444] - Unexpected exception causing shutdown while sock still open\njava.net.SocketTimeoutException: Read timed out\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:129)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:237)\n        at java.io.DataInputStream.readInt(DataInputStream.java:370)\n        at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n        at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:84)\n        at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)\n        at org.apache.zookeeper.server.quorum.LearnerHandler.run(LearnerHandler.java:358)\n2011-06-30 22:14:49,084 - WARN  [LearnerHandler-/10.23.247.163:14998:LearnerHandler@457] - ******* GOODBYE /10.23.247.163:14998 ********\n{noformat}", "created_at" : { "$date" : "2011-07-01T07:20:06.872+0000" }, "updated_at" : { "$date" : "2013-10-22T03:06:06.308+0000" }, "creator_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "reporter_id" : { "$oid" : "5b7d5122e9214a0d1608d8f3" }, "issue_type" : "Bug", "priority" : "Critical", "status" : "Resolved", "affects_versions" : [ "3.3.3", "3.3.0" ], "components" : [ "quorum" ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53065f627d6b0586de81" }, "effect" : "relates to", "type" : "Reference" } ], "environment" : "linux rhel 4, x64, java version 1.4.2" },
{ "_id" : { "$oid" : "5b7d53075f627d6b0586de92" }, "external_id" : "ZOOKEEPER-1657", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d52885f627d6b0586d237" }, "external_id" : "ZOOKEEPER-1623", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [ "3.4.5" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52e45f627d6b0586dc11" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d53075f627d6b0586de92" }, "effect" : "is contained by", "type" : "Container" }, { "issue_id" : { "$oid" : "5b7d52e45f627d6b0586dc12" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d52885f627d6b0586d23a" }, "effect" : "relates to", "type" : "Reference" } ], "created_at" : { "$date" : "2013-01-16T16:46:51.561+0000" }, "updated_at" : { "$date" : "2013-10-22T18:39:03.877+0000" }, "reporter_id" : { "$oid" : "5b7d5307e9214a0d1608d9e7" }, "creator_id" : { "$oid" : "5b7d5307e9214a0d1608d9e7" }, "priority" : "Major", "title" : "Authentication using SASL", "issue_type" : "Bug", "desc" : "First of all, I'm just running some test and thus I don't wan't/need any authentication at all. So I didn't configured any. But running my Java client with an Oracle JVM (1.6.38) I run into the following problem:\n\n`2013-01-16 17:40:30,659 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=192.168.2.28:2181 sessionTimeout=5000 watcher=master.Master@eb42cbf\n2013-01-16 17:40:30,674 [main] DEBUG org.apache.zookeeper.ClientCnxn - zookeeper.disableAutoWatchReset is false\n2013-01-16 17:40:30,698 [Thread-0] DEBUG master.Master - Master waits...\n2013-01-16 17:40:30,701 [main-SendThread(Teots-PC:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server Teots-PC/192.168.2.28:2181. Will not attempt to authenticate using SASL (Unable to locate a login configuration)\n2013-01-16 17:40:30,706 [main-SendThread(Teots-PC:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established to Teots-PC/192.168.2.28:2181, initiating session\n2013-01-16 17:40:30,708 [main-SendThread(Teots-PC:2181)] DEBUG org.apache.zookeeper.ClientCnxn - Session establishment request sent on Teots-PC/192.168.2.28:2181\n2013-01-16 17:40:30,709 [main-SendThread(Teots-PC:2181)] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient - Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\n2013-01-16 17:40:30,730 [main-SendThread(Teots-PC:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server Teots-PC/192.168.2.28:2181, sessionid = 0x13c44254fd70003, negotiated timeout = 5000\n2013-01-16 17:40:30,732 [main-EventThread] DEBUG master.Master - Master recieved an event: None\n2013-01-16 17:40:30,732 [main-SendThread(Teots-PC:2181)] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient - Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration\n2013-01-16 17:40:30,732 [main-EventThread] DEBUG master.Master - Master's state: SyncConnected\n2013-01-16 17:40:30,732 [main-SendThread(Teots-PC:2181)] DEBUG org.apache.zookeeper.client.ZooKeeperSaslClient - Could not retrieve login configuration: java.lang.SecurityException: Unable to locate a login configuration`\n\nThis does not happen with an OpenJDK JVM.", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d53085f627d6b0586dea7" }, "external_id" : "ZOOKEEPER-1180", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "New entry for files ignored by svn.", "desc" : "The following entry needs to be added to the svn:ignore property for src/java/lib:\nant-eclipse-*.jar\n\nThis will ignore the ant-eclipse-*.jar file which is downloaded when running the ant \"eclipse\" target.", "created_at" : { "$date" : "2011-09-13T23:32:56.357+0000" }, "updated_at" : { "$date" : "2013-10-23T11:09:25.270+0000" }, "creator_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "reporter_id" : { "$oid" : "5b7d5153e9214a0d1608d904" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "resolution" : "Implemented", "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_links" : [  ], "original_time_estimate" : 900 },
{ "_id" : { "$oid" : "5b7d53085f627d6b0586deac" }, "external_id" : "ZOOKEEPER-1738", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Xid out of order from a 3.4.5 client to a 3.3.5 cluster", "desc" : "This happens in the context of HBase master nodes getting connections from HBase region server. Once an HBase region server joins the cluster, I get the following error:\n\n{code}\n2013-08-07 13:35:18,676 WARN org.apache.zookeeper.ClientCnxn: Session 0xd4058c4d7940003 for server zk-01.dev.dailymotion.com/10.194.60.13:2181, unexpected error, closing socket connection and attempting reconnect\njava.io.IOException: Xid out of order. Got Xid 56 with err -101 expected Xid 55 for a packet with details: clientPath:null serverPath:null finished:false header:: 55,14  replyHeader:: 0,0,-4  request:: org.apache.zookeeper.MultiTransactionRecord@360193e5 response:: org.apache.zookeeper.MultiResponse@0\n        at org.apache.zookeeper.ClientCnxn$SendThread.readResponse(ClientCnxn.java:795)\n        at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:94)\n        at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:355)\n        at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1068)\n2013-08-07 13:35:18,676 WARN org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Possibly transient ZooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss\n2013-08-07 13:35:18,676 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: ZooKeeper multi failed after 3 retries\n2013-08-07 13:35:18,677 ERROR org.apache.hadoop.hbase.master.AssignmentManager: Unable to ensure that the table -ROOT- will be enabled because of a ZooKeeper issue\n2013-08-07 13:35:18,677 FATAL org.apache.hadoop.hbase.master.HMaster: Master server abort: loaded coprocessors are: []\n2013-08-07 13:35:18,677 FATAL org.apache.hadoop.hbase.master.HMaster: Unable to ensure that the table -ROOT- will be enabled because of a ZooKeeper issue\norg.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss\n        at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)\n        at org.apache.zookeeper.ZooKeeper.multiInternal(ZooKeeper.java:931)\n        at org.apache.zookeeper.ZooKeeper.multi(ZooKeeper.java:911)\n        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.multi(RecoverableZooKeeper.java:531)\n        at org.apache.hadoop.hbase.zookeeper.ZKUtil.multiOrSequential(ZKUtil.java:1440)\n        at org.apache.hadoop.hbase.zookeeper.ZKTable.setTableState(ZKTable.java:245)\n        at org.apache.hadoop.hbase.zookeeper.ZKTable.setEnabledTable(ZKTable.java:325)\n        at org.apache.hadoop.hbase.master.AssignmentManager.setEnabledTable(AssignmentManager.java:3576)\n        at org.apache.hadoop.hbase.master.AssignmentManager.setEnabledTable(AssignmentManager.java:2340)\n        at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1674)\n        at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1424)\n        at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1399)\n        at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1394)\n        at org.apache.hadoop.hbase.master.handler.ClosedRegionHandler.process(ClosedRegionHandler.java:105)\n        at org.apache.hadoop.hbase.master.AssignmentManager.addToRITandCallClose(AssignmentManager.java:675)\n        at org.apache.hadoop.hbase.master.AssignmentManager.processRegionsInTransition(AssignmentManager.java:586)\n        at org.apache.hadoop.hbase.master.AssignmentManager.processRegionInTransition(AssignmentManager.java:525)\n        at org.apache.hadoop.hbase.master.AssignmentManager.processRegionInTransitionAndBlockUntilAssigned(AssignmentManager.java:489)\n        at org.apache.hadoop.hbase.master.HMaster.assignRootAndMeta(HMaster.java:679)\n        at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:583)\n        at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:395)\n        at java.lang.Thread.run(Thread.java:722)\n2013-08-07 13:35:18,678 INFO org.apache.hadoop.hbase.master.HMaster: Aborting\n2013-08-07 13:35:18,678 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Server stopped; skipping assign of -ROOT-,,0.70236052 state=OFFLINE, ts=1375881792131, server=null\n2013-08-07 13:35:18,678 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Waiting on 70236052/-ROOT-\n2013-08-07 13:35:18,678 INFO org.apache.hadoop.hbase.master.AssignmentManager$TimeoutMonitor: masternode-01.dev.dailymotion.com,60000,1375880747185.timeoutMonitor exiting\n2013-08-07 13:35:18,679 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=M_ZK_REGION_OFFLINE, server=masternode-01.dev.dailymotion.com,60000,1375880747185, region=70236052/-ROOT-, which is more than 15 seconds late\n2013-08-07 13:35:18,776 WARN org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Possibly transient ZooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase/root-region-server\n2013-08-07 13:35:18,776 WARN org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Possibly transient ZooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase\n2013-08-07 13:35:18,776 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: ZooKeeper getData failed after 3 retries\n2013-08-07 13:35:18,777 INFO org.apache.hadoop.hbase.util.RetryCounter: Sleeping 2000ms before retry #1...\n{code}", "created_at" : { "$date" : "2013-08-07T14:43:38.703+0000" }, "updated_at" : { "$date" : "2013-10-24T05:41:20.026+0000" }, "creator_id" : { "$oid" : "5b7d5308e9214a0d1608d9e8" }, "reporter_id" : { "$oid" : "5b7d5308e9214a0d1608d9e8" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.5" ], "components" : [  ], "labels" : [  ], "resolution" : "Invalid", "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Server: zookeeper 3.3.5+dfsg1-1ubuntu1\nClient: zookeeper 3.4.5 from Cloudera 4.3.0" },
{ "_id" : { "$oid" : "5b7d53095f627d6b0586deb1" }, "external_id" : "ZOOKEEPER-1499", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "clientPort config changes not backwards-compatible", "desc" : "With the new reconfig logic, clientPort=2181 in the zoo.cfg file no longer gets read, and clients can't connect without adding ;2181 to the end of their server lines. ", "created_at" : { "$date" : "2012-07-03T22:33:02.546+0000" }, "updated_at" : { "$date" : "2013-10-24T11:08:33.673+0000" }, "creator_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "reporter_id" : { "$oid" : "5b7d50efe9214a0d1608d8cc" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "server" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530a5f627d6b0586ded5" }, "external_id" : "ZOOKEEPER-1579", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Compile error of UnixOperationSystemMXBean with open JDK", "desc" : "zookeeper invokes getOpenFileDescriptorCount() function in  com.sun.management.UnixOperatingSystemMXBean, which only exists in SUN JDK, and open JDK did not implement this function.\n\n    [javac] /root/zookeeper-3.3.4/src/java/test/org/apache/zookeeper/test/ClientBase.java:57: package com.sun.management does not exist\n    [javac] import com.sun.management.UnixOperatingSystemMXBean;\n    [javac]                          ^\n    [javac] /root/zookeeper-3.3.4/src/java/test/org/apache/zookeeper/test/QuorumBase.java:39: package com.sun.management does not exist\n    [javac] import com.sun.management.UnixOperatingSystemMXBean;\n    [javac]                          ^\n    [javac] /root/zookeeper-3.3.4/src/java/test/org/apache/zookeeper/test/ClientTest.java:48: package com.sun.management does not exist\n    [javac] import com.sun.management.UnixOperatingSystemMXBean;\n    [javac]                          ^\n    [javac] /root/zookeeper-3.3.4/src/java/test/org/apache/zookeeper/test/QuorumUtil.java:39: package com.sun.management does not exist\n    [javac] import com.sun.management.UnixOperatingSystemMXBean;", "created_at" : { "$date" : "2012-11-08T04:06:09.309+0000" }, "updated_at" : { "$date" : "2013-10-31T16:22:35.082+0000" }, "creator_id" : { "$oid" : "5b7d530ae9214a0d1608d9e9" }, "reporter_id" : { "$oid" : "5b7d530ae9214a0d1608d9e9" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [ "3.3.4", "3.4.3" ], "components" : [  ], "labels" : [ "patch" ], "fix_versions" : [  ], "assignee_id" : { "$oid" : "5b7d530ae9214a0d1608d9e9" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d530a5f627d6b0586ded4" }, "effect" : "relates to", "type" : "Reference" } ], "original_time_estimate" : 604800 },
{ "_id" : { "$oid" : "5b7d530a5f627d6b0586dee3" }, "external_id" : "ZOOKEEPER-1815", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Tolerate incorrectly set system hostname in tests", "desc" : "A bunch of tests will fail with UnknownHostException errors when the hostname is incorrectly set on the system that you are running tests on.", "created_at" : { "$date" : "2013-11-15T21:14:25.480+0000" }, "updated_at" : { "$date" : "2013-11-19T02:12:39.380+0000" }, "creator_id" : { "$oid" : "5b7d530ae9214a0d1608d9ec" }, "reporter_id" : { "$oid" : "5b7d530ae9214a0d1608d9ec" }, "issue_type" : "Improvement", "priority" : "Trivial", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530b5f627d6b0586def7" }, "external_id" : "ZOOKEEPER-1820", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "The artifact org.apache.zookeeper:zookeeper:pom:3.4.5 has no license specified.", "desc" : "We are using maven licensing pluging (org.linuxstuff.maven:licensing-maven-plugin) to check/enforce licensing requirements for our dependencies and noticed that zookeper doesn't include licensing terms in pom.xml which causes the plugin to report the above mentioned warning (see the summary). \n\nIs there any plan to add the license to pom.xml as well?", "created_at" : { "$date" : "2013-11-22T00:14:52.803+0000" }, "updated_at" : { "$date" : "2013-11-22T00:14:52.803+0000" }, "creator_id" : { "$oid" : "5b7d530be9214a0d1608d9ed" }, "reporter_id" : { "$oid" : "5b7d530be9214a0d1608d9ed" }, "issue_type" : "Improvement", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530c5f627d6b0586def8" }, "external_id" : "ZOOKEEPER-1825", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "In ClientBase, if not set \"build.test.dir\" will throw IOException", "desc" : "{code}\n    static final File BASETEST = new File(System.getProperty(\"build.test.dir\", \"build\"));\n{code}\n\n{code}\n    public static File createTmpDir() throws IOException {\n        return createTmpDir(BASETEST);\n    }\n    static File createTmpDir(File parentDir) throws IOException {\n        File tmpFile = File.createTempFile(\"test\", \".junit\", parentDir);\n        // don't delete tmpFile - this ensures we don't attempt to create\n        // a tmpDir with a duplicate name\n        File tmpDir = new File(tmpFile + \".dir\");\n        Assert.assertFalse(tmpDir.exists()); // never true if tmpfile does it's job\n        Assert.assertTrue(tmpDir.mkdirs());\n\n        return tmpDir;\n    }\n{code}\n\nBecause the default directory \"build\" may not exist, createTmpDir() will throws IOException and show  \"No such file or directory\". I think replace \"build\" as \".\" is more reasonable.", "created_at" : { "$date" : "2013-12-02T13:01:38.614+0000" }, "updated_at" : { "$date" : "2013-12-03T02:19:36.367+0000" }, "creator_id" : { "$oid" : "5b7d530ce9214a0d1608d9ee" }, "reporter_id" : { "$oid" : "5b7d530ce9214a0d1608d9ee" }, "issue_type" : "Test", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "tests" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530d5f627d6b0586defa" }, "external_id" : "ZOOKEEPER-1827", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Reduce the number of mntr calls in zookeeper ganglia plugin", "desc" : "The zookeeper ganglia plugin script makes number of mntr calls to the zookeeper node for each of the metric, which seems to be an overhead to the zookeeper. I think it could be improvised to make a single mntr call and collect the metric data and send all the metrics information collected from a single mntr command (that is run every 60s interval) to the ganglia.\n\nThe change and github pull request is at https://github.com/apache/zookeeper/pull/8\n\nPlease let me know if there are any other changes required here.\n\nthanks,\n\nNikhil ", "created_at" : { "$date" : "2013-12-03T21:08:21.171+0000" }, "updated_at" : { "$date" : "2013-12-03T21:08:21.171+0000" }, "creator_id" : { "$oid" : "5b7d530de9214a0d1608d9ef" }, "reporter_id" : { "$oid" : "5b7d530de9214a0d1608d9ef" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "contrib" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530e5f627d6b0586defb" }, "external_id" : "ZOOKEEPER-1798", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530e5f627d6b0586defc" }, "external_id" : "ZOOKEEPER-1793", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zab1_0Test.testNormalObserverRun() is flaky", "desc" : "not sure if this is due to a known issue or not.\n\n// check and make sure the change is persisted\nzkDb2 = new ZKDatabase(new FileTxnSnapLog(logDir, snapDir));\nlastZxid = zkDb2.loadDataBase();\nAssert.assertEquals(\"data2\", new String(zkDb2.getData(\"/foo\", stat, null)));\n\nthis assert periodically (once every 3 runs of the test or so) fails saying that  getData returns data1 and not data2.", "created_at" : { "$date" : "2013-10-11T04:43:59.479+0000" }, "updated_at" : { "$date" : "2013-12-06T21:30:17.535+0000" }, "creator_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "reporter_id" : { "$oid" : "5b7d5116e9214a0d1608d8ec" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [  ], "components" : [ "quorum", "server", "tests" ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d530e5f627d6b0586defb" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d530e5f627d6b0586df0e" }, "external_id" : "ZOOKEEPER-1646", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530e5f627d6b0586df0f" }, "external_id" : "ZOOKEEPER-1742", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530e5f627d6b0586df10" }, "external_id" : "ZOOKEEPER-1795", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "unable to build c client on ubuntu", "desc" : "Seems there is an issue for Ubuntu (I'm on 13.04), however I'm only seeing it on trunk and not branch 34\n\n{noformat}\nmake check\nmake  zktest-st zktest-mt\nmake[1]: Entering directory `/home/phunt/dev/svn/svn-zookeeper/src/c'\ng++ -DHAVE_CONFIG_H -I.  -I./include -I./tests -I./generated  -DUSE_STATIC_LIB -DZKSERVER_CMD=\"\\\"./tests/zkServer.sh\\\"\" -DZOO_IPV6_ENABLED -g -O2 -MT zktest_st-TestReconfigServer.o -MD -MP -MF .deps/zktest_st-TestReconfigServer.Tpo -c -o zktest_st-TestReconfigServer.o `test -f 'tests/TestReconfigServer.cc' || echo './'`tests/TestReconfigServer.cc\ntests/TestReconfigServer.cc: In member function 'bool TestReconfigServer::waitForConnected(zhandle_t*, uint32_t)':\ntests/TestReconfigServer.cc:128:16: error: 'sleep' was not declared in this scope\nmake[1]: *** [zktest_st-TestReconfigServer.o] Error 1\nmake[1]: Leaving directory `/home/phunt/dev/svn/svn-zookeeper/src/c'\nmake: *** [check-am] Error 2\n{noformat}\n\nI have \n\n{noformat}\ng++ --version\ng++ (Ubuntu/Linaro 4.7.3-1ubuntu1) 4.7.3\nCopyright (C) 2012 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n{noformat}", "created_at" : { "$date" : "2013-10-14T19:38:51.644+0000" }, "updated_at" : { "$date" : "2013-12-06T21:30:52.310+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "Bug", "priority" : "Blocker", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "c client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d530e5f627d6b0586df0f" }, "effect" : "is related to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d530e5f627d6b0586df0e" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d530f5f627d6b0586df25" }, "external_id" : "ZOOKEEPER-1740", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d530f5f627d6b0586df26" }, "external_id" : "ZOOKEEPER-1809", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "ephemeral node not deleted (or recreated?) after session expiry", "desc" : "We have been running into a situation where we attempt to recreate our ephemeral nodes after a session expiry, only to find that the node already exists.   Admittedly, this is only happening when we are aggresively killing and recreating sessions in a tight loop, but I thought it might point to a larger issue which may need to be addressed.\n\nAttached is a small app which demonstrates the issue, and a log file (client and server in the same log) which shows the issue as it occured.  Reproducing the bug is a tedious process of rerunning the test over and over again, but I have typically been able to reproduce it within 15mins of trying.  The test app is using Curator, however, I think the issue is occuring at the ZK level since the logs clearly indicate the ephermal node is deleted after the session expiry.\n\nInteresting bits from the log\n{noformat}\n...\n2013/11/06 13:46:03,065 INFO  [ConnectionStateManager-0] Recreating node: /test\n...\n2013/11/06 13:46:03,070 DEBUG [SyncThread:0] Processing request:: sessionid:0x1422bbb36d10002 type:create cxid:0x2 zxid:0x8 txntype:1 reqpath:n/a\n...\n2013/11/06 13:46:03,071 DEBUG [main] Closing client for session: 0x1422bbb36d10002\n2013/11/06 13:46:03,075 INFO  [ProcessThread(sid:0 cport:-1):] Processed session termination for sessionid: 0x1422bbb36d10002\n2013/11/06 13:46:03,079 DEBUG [SyncThread:0] Processing request:: sessionid:0x1422bbb36d10002 type:closeSession cxid:0x1 zxid:0x9 txntype:-11 reqpath:n/a\n2013/11/06 13:46:03,080 DEBUG [SyncThread:0] Deleting ephemeral node /test for session 0x1422bbb36d10002\n2013/11/06 13:46:03,080 DEBUG [SyncThread:0] sessionid:0x1422bbb36d10002 type:closeSession cxid:0x1 zxid:0x9 txntype:-11 reqpath:n/a\n...\n2013/11/06 13:46:04,459 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:43462] Client attempting to renew session 0x1422bbb36d10002 at /127.0.0.1:59559\n2013/11/06 13:46:04,459 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:43462] Invalid session 0x1422bbb36d10002 for client /127.0.0.1:59559, probably expired\n2013/11/06 13:46:04,460 INFO  [main-SendThread(localhost:43462)] Unable to reconnect to ZooKeeper service, session 0x1422bbb36d10002 has expired, closing socket connection\n2013/11/06 13:46:04,460 DEBUG [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:43462] Dropping request: No session with sessionid 0x1422bbb36d10002 exists, probably expired and removed\n...\n2013/11/06 13:46:04,463 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:43462] Client attempting to establish new session at /127.0.0.1:59560\n2013/11/06 13:46:04,466 DEBUG [SyncThread:0] Processing request:: sessionid:0x1422bbb36d10003 type:createSession cxid:0x0 zxid:0xa txntype:-10 reqpath:n/a\n2013/11/06 13:46:04,466 DEBUG [SyncThread:0] sessionid:0x1422bbb36d10003 type:createSession cxid:0x0 zxid:0xa txntype:-10 reqpath:n/a\n2013/11/06 13:46:04,467 INFO  [SyncThread:0] Established session 0x1422bbb36d10003 with negotiated timeout 30000 for client /127.0.0.1:59560\n...\n2013/11/06 13:46:04,473 INFO  [ConnectionStateManager-0] Recreating node: /test\n2013/11/06 13:46:04,474 DEBUG [SyncThread:0] Processing request:: sessionid:0x1422bbb36d10003 type:exists cxid:0x2 zxid:0xfffffffffffffffe txntype:unknown reqpath:/___CURATOR_KILL_SESSION___15970538640754\n2013/11/06 13:46:04,474 DEBUG [SyncThread:0] sessionid:0x1422bbb36d10003 type:exists cxid:0x2 zxid:0xfffffffffffffffe txntype:unknown reqpath:/___CURATOR_KILL_SESSION___15970538640754\n2013/11/06 13:46:04,475 INFO  [ProcessThread(sid:0 cport:-1):] Got user-level KeeperException when processing sessionid:0x1422bbb36d10003 type:create cxid:0x3 zxid:0xc txntype:-1 reqpath:n/a Error Path:/test Error:KeeperErrorCode = NodeExists for /test\n2013/11/06 13:46:04,475 DEBUG [main-SendThread(localhost:43462)] Reading reply sessionid:0x1422bbb36d10003, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,11,-101  request:: '/___CURATOR_KILL_SESSION___15970538640754,T  response::  \n2013/11/06 13:46:04,476 INFO  [main] Initiating client connection, connectString=127.0.0.1:43462 sessionTimeout=10000 watcher=com.netflix.curator.test.KillSession$2@4067d00a sessionId=1422bbb36d10003 sessionPasswd=<hidden>\n...\n2013/11/06 13:46:04,479 ERROR [ConnectionStateManager-0] Failed to recreate ephemeral node\norg.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /test\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:119)\n\tat org.apache.zookeeper.KeeperException.create(KeeperException.java:51)\n\tat org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:783)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl$10.call(CreateBuilderImpl.java:625)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl$10.call(CreateBuilderImpl.java:609)\n\tat com.netflix.curator.RetryLoop.callWithRetry(RetryLoop.java:106)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:605)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:428)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:408)\n\tat com.netflix.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:41)\n\tat com.rakuten.sandbox.sessionexpiry.nodeexists.SessionExpiryTest$2.stateChanged(SessionExpiryTest.java:72)\n\tat com.netflix.curator.framework.state.ConnectionStateManager$2.apply(ConnectionStateManager.java:184)\n\tat com.netflix.curator.framework.state.ConnectionStateManager$2.apply(ConnectionStateManager.java:180)\n\tat com.netflix.curator.framework.listen.ListenerContainer$1.run(ListenerContainer.java:92)\n\tat com.google.common.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:262)\n\tat com.netflix.curator.framework.listen.ListenerContainer.forEach(ListenerContainer.java:83)\n\tat com.netflix.curator.framework.state.ConnectionStateManager.processEvents(ConnectionStateManager.java:177)\n\tat com.netflix.curator.framework.state.ConnectionStateManager.access$000(ConnectionStateManager.java:40)\n\tat com.netflix.curator.framework.state.ConnectionStateManager$1.call(ConnectionStateManager.java:104)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\n...\n{noformat}", "created_at" : { "$date" : "2013-11-06T05:06:42.062+0000" }, "updated_at" : { "$date" : "2013-12-06T21:32:15.518+0000" }, "creator_id" : { "$oid" : "5b7d530fe9214a0d1608d9f1" }, "reporter_id" : { "$oid" : "5b7d530fe9214a0d1608d9f1" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Resolved", "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Not A Problem", "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d530f5f627d6b0586df25" }, "effect" : "is related to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d53105f627d6b0586df3b" }, "external_id" : "ZOOKEEPER-1573", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53105f627d6b0586df3c" }, "external_id" : "ZOOKEEPER-1813", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Zookeeper restart fails due to missing node from snapshot", "desc" : "Due to following exception Zookeeper restart is failing\n\n{noformat}java.io.IOException: Failed to process transaction type: 1 error: KeeperErrorCode = NoNode for /test/subdir2/subdir2/subdir\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:183)\n\tat org.apache.zookeeper.server.ZKDatabase.loadDataBase(ZKDatabase.java:222)\n\tat org.apache.zookeeper.server.ZooKeeperServer.loadData(ZooKeeperServer.java:255)\n\tat org.apache.zookeeper.server.ZooKeeperServer.startdata(ZooKeeperServer.java:380)\n\tat org.apache.zookeeper.server.NIOServerCnxnFactory.startup(NIOServerCnxnFactory.java:748)\n\tat org.apache.zookeeper.server.ZooKeeperServerMain.runFromConfig(ZooKeeperServerMain.java:111)\n\tat org.apache.zookeeper.server.ZooKeeperServerMain.initializeAndRun(ZooKeeperServerMain.java:90)\n\tat org.apache.zookeeper.server.ZooKeeperServerMainTest$2.run(ZooKeeperServerMainTest.java:218)\nCaused by: org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /test/subdir2/subdir2/subdir\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.processTransaction(FileTxnSnapLog.java:268)\n\tat org.apache.zookeeper.server.persistence.FileTxnSnapLog.restore(FileTxnSnapLog.java:181)\n\t... 7 more{noformat}", "created_at" : { "$date" : "2013-11-15T06:40:25.804+0000" }, "updated_at" : { "$date" : "2013-12-06T21:33:03.728+0000" }, "creator_id" : { "$oid" : "5b7d52dfe9214a0d1608d9cb" }, "reporter_id" : { "$oid" : "5b7d52dfe9214a0d1608d9cb" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.4.5", "3.5.0" ], "components" : [  ], "labels" : [  ], "resolution" : "Duplicate", "fix_versions" : [ "3.5.0" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53105f627d6b0586df3b" }, "effect" : "is duplicated by", "type" : "Duplicate" } ] },
{ "_id" : { "$oid" : "5b7d53115f627d6b0586df4c" }, "external_id" : "ZOOKEEPER-1826", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "zookeeper ganglia module fails to read the output of stat when too many clients are connected", "desc" : "The ganglia zookeeper module uses a single 2048 byte socket.recv to get the response from the 'stat' command.  When there are more than a few clients connected, the list of connected clients fills the buffer before the script gets to the actual metrics its trying to report.\n\nThis bug is fixed in https://github.com/maplebed/zookeeper-monitoring/tree/ben.fetch_more_data", "created_at" : { "$date" : "2013-12-03T19:41:16.258+0000" }, "updated_at" : { "$date" : "2013-12-06T21:34:25.705+0000" }, "creator_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "reporter_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53115f627d6b0586df50" }, "external_id" : "ZOOKEEPER-1828", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Audit src/c/src/zookeeper.c for missing error checking & early returns", "desc" : "After discussing the patch for ZOOKEEPER-1632 we came to realize that many methods in the c client don't honor the internal error checking that they do (i.e.: they don't return early on error). This is bad because you might return with an error but your call (in case of the async ones) might still have been called.\n\nSo at that point it's unclear how the caller should deal with resource deallocation.  ", "created_at" : { "$date" : "2013-12-04T00:29:59.471+0000" }, "updated_at" : { "$date" : "2013-12-06T21:34:45.531+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "c client" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53125f627d6b0586df55" }, "external_id" : "ZOOKEEPER-1832", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add count of connected clients to submitted ganglia metrics", "desc" : "The ganglia zookeeper plugin does not report the number of connected clients, though this information is available from the 'stat' command. ", "created_at" : { "$date" : "2013-12-05T18:21:27.724+0000" }, "updated_at" : { "$date" : "2013-12-06T21:55:50.458+0000" }, "creator_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "reporter_id" : { "$oid" : "5b7d5290e9214a0d1608d999" }, "issue_type" : "Bug", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53135f627d6b0586df5d" }, "external_id" : "ZOOKEEPER-1842", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Election listening thread not shutdown for leaders or followers", "desc" : "When I was testing the patch for https://issues.apache.org/jira/browse/ZOOKEEPER-1691, the test included with that patch was failing for me.  The problem happened when the tests shuts down some followers and then attempts to bring them back up:\n\n{quote}\n2013-12-13 17:31:03,976 [myid:1] - INFO [QuorumPeer[myid=1]/127.0.0.1:11227:Follower@194] - shutdown called\njava.lang.Exception: shutdown Follower\n        at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:194)\n        at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:971)\n...\n2013-12-13 17:31:03,992 [myid:1] - INFO [QuorumPeerListener:QuorumCnxManager$Listener@544] - My election bind port: localhost/127.0.0.1:11229\n2013-12-13 17:31:03,992 [myid:1] - ERROR [localhost/127.0.0.1:11229:QuorumCnxManager$Listener@557] - Exception while listening\njava.net.BindException: Address already in use\n        at java.net.PlainSocketImpl.socketBind(Native Method)\n        at java.net.AbstractPlainSocketImpl.bind(AbstractPlainSocketImpl.java:376)\n        at java.net.ServerSocket.bind(ServerSocket.java:376)\n        at java.net.ServerSocket.bind(ServerSocket.java:330)\n        at org.apache.zookeeper.server.quorum.QuorumCnxManager$Listener.run(QuorumCnxManager.java:546) \n{quote}\n\nThe problem appears to be that the when follower.shutdown() is called in QuorumPeer.run(), the election algorithm is never shut down, so when the node restarts it can't bind back to the same port.\n\nI will upload a patch that calls shutdown() for both the leader and the follower in this case, but I'm not positive its the right place or fix for this issue, so feedback would be appreciated.", "created_at" : { "$date" : "2013-12-16T20:35:02.175+0000" }, "updated_at" : { "$date" : "2013-12-16T21:10:49.365+0000" }, "creator_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "reporter_id" : { "$oid" : "5b7d5100e9214a0d1608d8d3" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [ "quorum" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ], "environment" : "Linux, ZK trunk" },
{ "_id" : { "$oid" : "5b7d53135f627d6b0586df62" }, "external_id" : "ZOOKEEPER-1592", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "support deleting a node silently", "desc" : "Sometimes, we want to delete a node.  But we are not sure if the node exists or not.  In this case, we want the delete method succeed instead of throwing a NoNodeException.  Although we can have a wrapper method to do it, it should be better to build this in to ZK.", "created_at" : { "$date" : "2012-11-28T03:52:35.906+0000" }, "updated_at" : { "$date" : "2013-12-20T20:03:47.072+0000" }, "creator_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "reporter_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53145f627d6b0586df68" }, "external_id" : "ZOOKEEPER-1569", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "support upsert: setData if the node exists, otherwise, create a new node", "desc" : "Currently, ZooKeeper supports setData and create.  If it can support upsert like in SQL, it will be great.", "created_at" : { "$date" : "2012-10-23T17:47:47.657+0000" }, "updated_at" : { "$date" : "2013-12-20T20:03:57.493+0000" }, "creator_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "reporter_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc4" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d53155f627d6b0586df7f" }, "external_id" : "ZOOKEEPER-1568", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "multi should have a non-transaction version", "desc" : "Currently multi is transactional, i.e. all or none.  However, sometimes, we don't want that.  We want all operations to be executed.  Even some operation(s) fails, it is ok. We just need to know the result of each operation.", "created_at" : { "$date" : "2012-10-23T17:43:55.795+0000" }, "updated_at" : { "$date" : "2013-12-20T20:04:06.129+0000" }, "creator_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "reporter_id" : { "$oid" : "5b7d52fde9214a0d1608d9e3" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Open", "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d52fd5f627d6b0586ddc4" }, "effect" : "is depended upon by", "type" : "Dependent" } ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df97" }, "external_id" : "ZOOKEEPER-1851", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df98" }, "external_id" : "HBASE-5843", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df99" }, "external_id" : "ZOOKEEPER-1648", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df9a" }, "external_id" : "ZOOKEEPER-1787", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df9b" }, "external_id" : "ZOOKEEPER-1607", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "affects_versions" : [  ], "components" : [  ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53165f627d6b0586df9c" }, "external_id" : "ZOOKEEPER-1147", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add support for local sessions", "desc" : "This improvement is in the bucket of making ZooKeeper work at a large scale. We are planning on having about a 1 million clients connect to a ZooKeeper ensemble through a set of 50-100 observers. Majority of these clients are read only - ie they do not do any updates or create ephemeral nodes.\n\nIn ZooKeeper today, the client creates a session and the session creation is handled like any other update. In the above use case, the session create/drop workload can easily overwhelm an ensemble. The following is a proposal for a \"local session\", to support a larger number of connections.\n\n1.       The idea is to introduce a new type of session - \"local\" session. A \"local\" session doesn't have a full functionality of a normal session.\n2.       Local sessions cannot create ephemeral nodes.\n3.       Once a local session is lost, you cannot re-establish it using the session-id/password. The session and its watches are gone for good.\n4.       When a local session connects, the session info is only maintained on the zookeeper server (in this case, an observer) that it is connected to. The leader is not aware of the creation of such a session and there is no state written to disk.\n5.       The pings and expiration is handled by the server that the session is connected to.\n\nWith the above changes, we can make ZooKeeper scale to a much larger number of clients without making the core ensemble a bottleneck.\n\nIn terms of API, there are two options that are being considered\n1. Let the client specify at the connect time which kind of session do they want.\n2. All sessions connect as local sessions and automatically get promoted to global sessions when they do an operation that requires a global session (e.g. creating an ephemeral node)\n\nChubby took the approach of lazily promoting all sessions to global, but I don't think that would work in our case, where we want to keep sessions which never create ephemeral nodes as always local. Option 2 would make it more broadly usable but option 1 would be easier to implement.\n\nWe are thinking of implementing option 1 as the first cut. There would be a client flag, IsLocalSession (much like the current readOnly flag) that would be used to determine whether to create a local session or a global session.\n\n\n", "created_at" : { "$date" : "2011-08-04T19:06:30.094+0000" }, "updated_at" : { "$date" : "2013-12-24T00:10:40.791+0000" }, "creator_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "reporter_id" : { "$oid" : "5b7d510ae9214a0d1608d8db" }, "issue_type" : "Improvement", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "server" ], "labels" : [ "scaling", "api-change" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d522ce9214a0d1608d952" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df97" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df98" }, "effect" : "relates to", "type" : "Reference" }, { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df99" }, "effect" : "depends upon", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df9b" }, "effect" : "is depended upon by", "type" : "Dependent" }, { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df9a" }, "effect" : "is depended upon by", "type" : "Dependent" } ], "original_time_estimate" : 3024000 },
{ "_id" : { "$oid" : "5b7d53175f627d6b0586dfec" }, "external_id" : "ZOOKEEPER-1297", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Add stat information to create() call", "desc" : "In order to get a Stat object after creation one has to do another exists() call. This leaves client code vulnerable to a possible update window by another writer. All synchronous methods but the create() method allow to pass in a Stat object for population. It would be nice if the create() method would also allow this.", "created_at" : { "$date" : "2011-11-11T12:51:38.494+0000" }, "updated_at" : { "$date" : "2013-12-24T00:10:41.586+0000" }, "creator_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "reporter_id" : { "$oid" : "5b7d5103e9214a0d1608d8d6" }, "issue_type" : "New Feature", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.3.3" ], "components" : [ "java client" ], "labels" : [ "newbie" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5317e9214a0d1608d9f2" }, "issue_links" : [ { "issue_id" : { "$oid" : "5b7d53165f627d6b0586df97" }, "effect" : "relates to", "type" : "Reference" } ] },
{ "_id" : { "$oid" : "5b7d504d5f627d6b058697e8" }, "external_id" : "ZOOKEEPER-40", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "components" : [ "quorum" ], "issue_links" : [ { "issue_id" : { "$oid" : "5b7d504d5f627d6b058697e9" }, "effect" : "relates to", "type" : "Reference" } ], "created_at" : { "$date" : "2008-06-10T22:47:13.028+0000" }, "updated_at" : { "$date" : "2013-12-24T23:42:23.730+0000" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "priority" : "Major", "title" : "Go read-only on loss of quorum", "issue_type" : "New Feature", "desc" : "Moved from SourceForge to Apache.\nhttp://sourceforge.net/tracker/index.php?func=detail&aid=1962503&group_id=209147&atid=1008547", "status" : "Open" },
{ "_id" : { "$oid" : "5b7d53185f627d6b0586e007" }, "external_id" : "ZOOKEEPER-1860", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "Async versions of reconfig don't actually throw KeeperException nor InterruptedException", "desc" : "This was caught by [~fournc], the async versions of reconfig in the Java client don't actually throw KeeperException nor InterruptedException. Since this is unreleased code (i.e.: for 3.5.0) I don't think there are issues with changing the API (that is, considering what exceptions are thrown part of the API). ", "created_at" : { "$date" : "2014-01-11T20:54:28.396+0000" }, "updated_at" : { "$date" : "2014-01-14T11:05:48.372+0000" }, "creator_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "reporter_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_type" : "Bug", "priority" : "Major", "status" : "Resolved", "affects_versions" : [ "3.5.0" ], "components" : [ "java client" ], "labels" : [  ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d52d0e9214a0d1608d9bc" }, "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d53185f627d6b0586e013" }, "external_id" : "ZOOKEEPER-153", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "add api support for \"subscribe\" method", "desc" : "Subscribe Method\n(note, this was moved from http://zookeeper.wiki.sourceforge.net/SubscribeMethod)\n\nOutline of the semantics and the requirements of a yet-to-be-implemented subscribe() method.\n\nBackground\n\nZooKeeper uses a very light weight one-time notification method for notifying interested clients of changes to ZooKeeper data nodes (znode). Clients can set a watch on a node when they request information about a znode. The watch is atomically set and the data returned, so that any subsequent changes to the znode that affect the data returned will trigger a watch event. The watch stays in place until triggered or the client is disconnected from a ZooKeeper server. A disconnect watch event implicitly triggers all watches.\n\nZooKeeper users have wondered if they can set permanent watches rather than one time watches. In reality such permanent watches do not provide any extra benefit over one time watches. Specifically, no data is included in a watch event, so the client still needs to do a query operation to get the data corresponding to a change; even then, the znode can change yet again after the event is received and before the client sends the query operation. Even the number of of changes to a znode can be found using one time watches and checking the mzxid in the stat structure of the znode. And the client will still miss events that happen when the client switches ZooKeeper servers.\n\nThere are use cases that require clients to see every change to a ZooKeeper node. The most general case is when a client behaves like a state machine and each change to the znode changes the state of the client. In these cases ZooKeeper is much more like a publish/subscribe system than a distributed register. To support this case we need not only reliable permanent watches (we even get the events that happen while switching servers) but also the data that caused the change, so that the client doesn't miss data that occurs between rapid fire changes.\n\nSemantics\n\nThe subscribe(String path) causes ZooKeeper to register a subscription for a znode. The initial value of the znode and any subsequent changes to that znode will cause a watch event with the data to be sent to the client. The client will see all changes in order. If a client switches servers, any missed events with the corresponding data will be sent to the client when the client reconnects to a server.\n\nThere are three ways to cancel a subscription:\n\n   1. Calling unsubscribe(String path)\n   2. Closing the ZooKeeper session or letting it expire\n   3. Falling too far behind. If the server decides that a client is not processing the watch events fast enough, it will cancel the subscription and send a SUBSCRIPTION_CANCELLED watch event.\n\n\nRequirements\n\nThere are a couple of things that make it hard to implement the subscribe() method:\n\n   1. Servers must have complete transaction logs - Currently ZooKeeper servers just need to have their data trees and in flight transaction logs in sync. When a follower syncs to a leader, the leader can just blast down a new snapshot of its data tree; it does not need to send past transactions that the follower might have missed. However in order to send changes that might have been missed by a client, the ZooKeeper server must be able to look into the past to send missed changes.\n   2. Servers must be able to send clients information about past changes - Currenly ZooKeeper servers just send clients information about the current state of the system. However, to implement subscribe clients must be able to go back into the log and send watches for past changes.\n\n\nImplementation Hints\n\nThere are things that work in our favor. ZooKeeper does have a bound on the amount of time it needs to look into the past. A ZooKeeper server bounds the session expiration time. The server does not need to keep a record of transactions older than this bound.\n\nZooKeeper also keeps a log of transactions. As long as the log is complete enough (as all the transaction back to the longest expiration time) the server has the information it needs and it isn't hard to process.\n\nWe do not want to cause the log disk to seek while looking at past transactions. There are two complimentary approaches to handling this problems: keep a few of the transactions from the recent past in memory and log to two disks. The first log disk will be synced before letting requests proceed and the second disk will not be synced. Recovery uses the first log disk and ensures that the second log disk has the same log at recovery time. The second log disk is to look into the past. Using the two disks in this way allows synchronous logging to be fast because seeks are avoided on the disk with the synchronous log.", "created_at" : { "$date" : "2008-10-01T22:42:26.921+0000" }, "updated_at" : { "$date" : "2014-01-15T19:37:53.397+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d867" }, "issue_type" : "New Feature", "priority" : "Minor", "status" : "Open", "affects_versions" : [  ], "components" : [ "tests", "c client", "server", "java client", "documentation" ], "labels" : [  ], "fix_versions" : [  ], "issue_links" : [  ] },
{ "_id" : { "$oid" : "5b7d531a5f627d6b0586e016" }, "external_id" : "ZOOKEEPER-442", "issue_system_id" : { "$oid" : "5b7d4f335f627d6b05868016" }, "title" : "need a way to remove watches that are no longer of interest", "desc" : "currently the only way a watch cleared is to trigger it. we need a way to enumerate the outstanding watch objects, find watch events the objects are watching for, and remove interests in an event.", "created_at" : { "$date" : "2009-06-11T14:04:28.297+0000" }, "updated_at" : { "$date" : "2014-01-25T11:09:53.488+0000" }, "creator_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "reporter_id" : { "$oid" : "5b7d4f35e9214a0d1608d868" }, "issue_type" : "Sub-task", "priority" : "Critical", "status" : "Resolved", "components" : [ "java client", "server" ], "resolution" : "Fixed", "fix_versions" : [ "3.5.0" ], "assignee_id" : { "$oid" : "5b7d5143e9214a0d1608d8fd" }, "parent_issue_id" : { "$oid" : "5b7d531a5f627d6b0586e015" } }
]
